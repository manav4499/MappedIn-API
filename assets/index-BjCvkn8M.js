var Vte=Object.defineProperty;var jte=(i,e,t)=>e in i?Vte(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var Z=(i,e,t)=>jte(i,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerPolicy&&(a.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?a.credentials="include":n.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(n){if(n.ep)return;n.ep=!0;const a=t(n);fetch(n.href,a)}})();function Hte(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var FI={exports:{}},Bv={},zI={exports:{}},ni={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Lm=Symbol.for("react.element"),Gte=Symbol.for("react.portal"),Wte=Symbol.for("react.fragment"),Xte=Symbol.for("react.strict_mode"),qte=Symbol.for("react.profiler"),Zte=Symbol.for("react.provider"),Yte=Symbol.for("react.context"),Jte=Symbol.for("react.forward_ref"),Kte=Symbol.for("react.suspense"),Qte=Symbol.for("react.memo"),eie=Symbol.for("react.lazy"),fT=Symbol.iterator;function tie(i){return i===null||typeof i!="object"?null:(i=fT&&i[fT]||i["@@iterator"],typeof i=="function"?i:null)}var BI={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},OI=Object.assign,NI={};function Yp(i,e,t){this.props=i,this.context=e,this.refs=NI,this.updater=t||BI}Yp.prototype.isReactComponent={};Yp.prototype.setState=function(i,e){if(typeof i!="object"&&typeof i!="function"&&i!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,i,e,"setState")};Yp.prototype.forceUpdate=function(i){this.updater.enqueueForceUpdate(this,i,"forceUpdate")};function $I(){}$I.prototype=Yp.prototype;function FM(i,e,t){this.props=i,this.context=e,this.refs=NI,this.updater=t||BI}var zM=FM.prototype=new $I;zM.constructor=FM;OI(zM,Yp.prototype);zM.isPureReactComponent=!0;var mT=Array.isArray,UI=Object.prototype.hasOwnProperty,BM={current:null},VI={key:!0,ref:!0,__self:!0,__source:!0};function jI(i,e,t){var r,n={},a=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(a=""+e.key),e)UI.call(e,r)&&!VI.hasOwnProperty(r)&&(n[r]=e[r]);var s=arguments.length-2;if(s===1)n.children=t;else if(1<s){for(var l=Array(s),u=0;u<s;u++)l[u]=arguments[u+2];n.children=l}if(i&&i.defaultProps)for(r in s=i.defaultProps,s)n[r]===void 0&&(n[r]=s[r]);return{$$typeof:Lm,type:i,key:a,ref:o,props:n,_owner:BM.current}}function iie(i,e){return{$$typeof:Lm,type:i.type,key:e,ref:i.ref,props:i.props,_owner:i._owner}}function OM(i){return typeof i=="object"&&i!==null&&i.$$typeof===Lm}function rie(i){var e={"=":"=0",":":"=2"};return"$"+i.replace(/[=:]/g,function(t){return e[t]})}var gT=/\/+/g;function c_(i,e){return typeof i=="object"&&i!==null&&i.key!=null?rie(""+i.key):e.toString(36)}function z1(i,e,t,r,n){var a=typeof i;(a==="undefined"||a==="boolean")&&(i=null);var o=!1;if(i===null)o=!0;else switch(a){case"string":case"number":o=!0;break;case"object":switch(i.$$typeof){case Lm:case Gte:o=!0}}if(o)return o=i,n=n(o),i=r===""?"."+c_(o,0):r,mT(n)?(t="",i!=null&&(t=i.replace(gT,"$&/")+"/"),z1(n,e,t,"",function(u){return u})):n!=null&&(OM(n)&&(n=iie(n,t+(!n.key||o&&o.key===n.key?"":(""+n.key).replace(gT,"$&/")+"/")+i)),e.push(n)),1;if(o=0,r=r===""?".":r+":",mT(i))for(var s=0;s<i.length;s++){a=i[s];var l=r+c_(a,s);o+=z1(a,e,t,l,n)}else if(l=tie(i),typeof l=="function")for(i=l.call(i),s=0;!(a=i.next()).done;)a=a.value,l=r+c_(a,s++),o+=z1(a,e,t,l,n);else if(a==="object")throw e=String(i),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function fg(i,e,t){if(i==null)return i;var r=[],n=0;return z1(i,r,"","",function(a){return e.call(t,a,n++)}),r}function nie(i){if(i._status===-1){var e=i._result;e=e(),e.then(function(t){(i._status===0||i._status===-1)&&(i._status=1,i._result=t)},function(t){(i._status===0||i._status===-1)&&(i._status=2,i._result=t)}),i._status===-1&&(i._status=0,i._result=e)}if(i._status===1)return i._result.default;throw i._result}var Mn={current:null},B1={transition:null},aie={ReactCurrentDispatcher:Mn,ReactCurrentBatchConfig:B1,ReactCurrentOwner:BM};function HI(){throw Error("act(...) is not supported in production builds of React.")}ni.Children={map:fg,forEach:function(i,e,t){fg(i,function(){e.apply(this,arguments)},t)},count:function(i){var e=0;return fg(i,function(){e++}),e},toArray:function(i){return fg(i,function(e){return e})||[]},only:function(i){if(!OM(i))throw Error("React.Children.only expected to receive a single React element child.");return i}};ni.Component=Yp;ni.Fragment=Wte;ni.Profiler=qte;ni.PureComponent=FM;ni.StrictMode=Xte;ni.Suspense=Kte;ni.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=aie;ni.act=HI;ni.cloneElement=function(i,e,t){if(i==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+i+".");var r=OI({},i.props),n=i.key,a=i.ref,o=i._owner;if(e!=null){if(e.ref!==void 0&&(a=e.ref,o=BM.current),e.key!==void 0&&(n=""+e.key),i.type&&i.type.defaultProps)var s=i.type.defaultProps;for(l in e)UI.call(e,l)&&!VI.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&s!==void 0?s[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=t;else if(1<l){s=Array(l);for(var u=0;u<l;u++)s[u]=arguments[u+2];r.children=s}return{$$typeof:Lm,type:i.type,key:n,ref:a,props:r,_owner:o}};ni.createContext=function(i){return i={$$typeof:Yte,_currentValue:i,_currentValue2:i,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},i.Provider={$$typeof:Zte,_context:i},i.Consumer=i};ni.createElement=jI;ni.createFactory=function(i){var e=jI.bind(null,i);return e.type=i,e};ni.createRef=function(){return{current:null}};ni.forwardRef=function(i){return{$$typeof:Jte,render:i}};ni.isValidElement=OM;ni.lazy=function(i){return{$$typeof:eie,_payload:{_status:-1,_result:i},_init:nie}};ni.memo=function(i,e){return{$$typeof:Qte,type:i,compare:e===void 0?null:e}};ni.startTransition=function(i){var e=B1.transition;B1.transition={};try{i()}finally{B1.transition=e}};ni.unstable_act=HI;ni.useCallback=function(i,e){return Mn.current.useCallback(i,e)};ni.useContext=function(i){return Mn.current.useContext(i)};ni.useDebugValue=function(){};ni.useDeferredValue=function(i){return Mn.current.useDeferredValue(i)};ni.useEffect=function(i,e){return Mn.current.useEffect(i,e)};ni.useId=function(){return Mn.current.useId()};ni.useImperativeHandle=function(i,e,t){return Mn.current.useImperativeHandle(i,e,t)};ni.useInsertionEffect=function(i,e){return Mn.current.useInsertionEffect(i,e)};ni.useLayoutEffect=function(i,e){return Mn.current.useLayoutEffect(i,e)};ni.useMemo=function(i,e){return Mn.current.useMemo(i,e)};ni.useReducer=function(i,e,t){return Mn.current.useReducer(i,e,t)};ni.useRef=function(i){return Mn.current.useRef(i)};ni.useState=function(i){return Mn.current.useState(i)};ni.useSyncExternalStore=function(i,e,t){return Mn.current.useSyncExternalStore(i,e,t)};ni.useTransition=function(){return Mn.current.useTransition()};ni.version="18.3.1";zI.exports=ni;var kt=zI.exports;const mg=Hte(kt);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var oie=kt,sie=Symbol.for("react.element"),lie=Symbol.for("react.fragment"),uie=Object.prototype.hasOwnProperty,hie=oie.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,cie={key:!0,ref:!0,__self:!0,__source:!0};function GI(i,e,t){var r,n={},a=null,o=null;t!==void 0&&(a=""+t),e.key!==void 0&&(a=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)uie.call(e,r)&&!cie.hasOwnProperty(r)&&(n[r]=e[r]);if(i&&i.defaultProps)for(r in e=i.defaultProps,e)n[r]===void 0&&(n[r]=e[r]);return{$$typeof:sie,type:i,key:a,ref:o,props:n,_owner:hie.current}}Bv.Fragment=lie;Bv.jsx=GI;Bv.jsxs=GI;FI.exports=Bv;var La=FI.exports,WI={exports:{}},da={},XI={exports:{}},qI={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(i){function e(z,V){var j=z.length;z.push(V);e:for(;0<j;){var q=j-1>>>1,ee=z[q];if(0<n(ee,V))z[q]=V,z[j]=ee,j=q;else break e}}function t(z){return z.length===0?null:z[0]}function r(z){if(z.length===0)return null;var V=z[0],j=z.pop();if(j!==V){z[0]=j;e:for(var q=0,ee=z.length,ae=ee>>>1;q<ae;){var N=2*(q+1)-1,J=z[N],Y=N+1,oe=z[Y];if(0>n(J,j))Y<ee&&0>n(oe,J)?(z[q]=oe,z[Y]=j,q=Y):(z[q]=J,z[N]=j,q=N);else if(Y<ee&&0>n(oe,j))z[q]=oe,z[Y]=j,q=Y;else break e}}return V}function n(z,V){var j=z.sortIndex-V.sortIndex;return j!==0?j:z.id-V.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;i.unstable_now=function(){return a.now()}}else{var o=Date,s=o.now();i.unstable_now=function(){return o.now()-s}}var l=[],u=[],c=1,p=null,d=3,m=!1,g=!1,b=!1,x=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function _(z){for(var V=t(u);V!==null;){if(V.callback===null)r(u);else if(V.startTime<=z)r(u),V.sortIndex=V.expirationTime,e(l,V);else break;V=t(u)}}function C(z){if(b=!1,_(z),!g)if(t(l)!==null)g=!0,G(E);else{var V=t(u);V!==null&&K(C,V.startTime-z)}}function E(z,V){g=!1,b&&(b=!1,v(D),D=-1),m=!0;var j=d;try{for(_(V),p=t(l);p!==null&&(!(p.expirationTime>V)||z&&!k());){var q=p.callback;if(typeof q=="function"){p.callback=null,d=p.priorityLevel;var ee=q(p.expirationTime<=V);V=i.unstable_now(),typeof ee=="function"?p.callback=ee:p===t(l)&&r(l),_(V)}else r(l);p=t(l)}if(p!==null)var ae=!0;else{var N=t(u);N!==null&&K(C,N.startTime-V),ae=!1}return ae}finally{p=null,d=j,m=!1}}var T=!1,L=null,D=-1,B=5,A=-1;function k(){return!(i.unstable_now()-A<B)}function $(){if(L!==null){var z=i.unstable_now();A=z;var V=!0;try{V=L(!0,z)}finally{V?O():(T=!1,L=null)}}else T=!1}var O;if(typeof w=="function")O=function(){w($)};else if(typeof MessageChannel<"u"){var P=new MessageChannel,U=P.port2;P.port1.onmessage=$,O=function(){U.postMessage(null)}}else O=function(){x($,0)};function G(z){L=z,T||(T=!0,O())}function K(z,V){D=x(function(){z(i.unstable_now())},V)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(z){z.callback=null},i.unstable_continueExecution=function(){g||m||(g=!0,G(E))},i.unstable_forceFrameRate=function(z){0>z||125<z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):B=0<z?Math.floor(1e3/z):5},i.unstable_getCurrentPriorityLevel=function(){return d},i.unstable_getFirstCallbackNode=function(){return t(l)},i.unstable_next=function(z){switch(d){case 1:case 2:case 3:var V=3;break;default:V=d}var j=d;d=V;try{return z()}finally{d=j}},i.unstable_pauseExecution=function(){},i.unstable_requestPaint=function(){},i.unstable_runWithPriority=function(z,V){switch(z){case 1:case 2:case 3:case 4:case 5:break;default:z=3}var j=d;d=z;try{return V()}finally{d=j}},i.unstable_scheduleCallback=function(z,V,j){var q=i.unstable_now();switch(typeof j=="object"&&j!==null?(j=j.delay,j=typeof j=="number"&&0<j?q+j:q):j=q,z){case 1:var ee=-1;break;case 2:ee=250;break;case 5:ee=1073741823;break;case 4:ee=1e4;break;default:ee=5e3}return ee=j+ee,z={id:c++,callback:V,priorityLevel:z,startTime:j,expirationTime:ee,sortIndex:-1},j>q?(z.sortIndex=j,e(u,z),t(l)===null&&z===t(u)&&(b?(v(D),D=-1):b=!0,K(C,j-q))):(z.sortIndex=ee,e(l,z),g||m||(g=!0,G(E))),z},i.unstable_shouldYield=k,i.unstable_wrapCallback=function(z){var V=d;return function(){var j=d;d=V;try{return z.apply(this,arguments)}finally{d=j}}}})(qI);XI.exports=qI;var pie=XI.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var die=kt,pa=pie;function Ke(i){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+i,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+i+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var ZI=new Set,Zf={};function nh(i,e){wp(i,e),wp(i+"Capture",e)}function wp(i,e){for(Zf[i]=e,i=0;i<e.length;i++)ZI.add(e[i])}var Ts=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),J2=Object.prototype.hasOwnProperty,fie=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,yT={},vT={};function mie(i){return J2.call(vT,i)?!0:J2.call(yT,i)?!1:fie.test(i)?vT[i]=!0:(yT[i]=!0,!1)}function gie(i,e,t,r){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:t!==null?!t.acceptsBooleans:(i=i.toLowerCase().slice(0,5),i!=="data-"&&i!=="aria-");default:return!1}}function yie(i,e,t,r){if(e===null||typeof e>"u"||gie(i,e,t,r))return!0;if(r)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Cn(i,e,t,r,n,a,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=n,this.mustUseProperty=t,this.propertyName=i,this.type=e,this.sanitizeURL=a,this.removeEmptyString=o}var Jr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(i){Jr[i]=new Cn(i,0,!1,i,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(i){var e=i[0];Jr[e]=new Cn(e,1,!1,i[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(i){Jr[i]=new Cn(i,2,!1,i.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(i){Jr[i]=new Cn(i,2,!1,i,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(i){Jr[i]=new Cn(i,3,!1,i.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(i){Jr[i]=new Cn(i,3,!0,i,null,!1,!1)});["capture","download"].forEach(function(i){Jr[i]=new Cn(i,4,!1,i,null,!1,!1)});["cols","rows","size","span"].forEach(function(i){Jr[i]=new Cn(i,6,!1,i,null,!1,!1)});["rowSpan","start"].forEach(function(i){Jr[i]=new Cn(i,5,!1,i.toLowerCase(),null,!1,!1)});var NM=/[\-:]([a-z])/g;function $M(i){return i[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(i){var e=i.replace(NM,$M);Jr[e]=new Cn(e,1,!1,i,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(i){var e=i.replace(NM,$M);Jr[e]=new Cn(e,1,!1,i,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(i){var e=i.replace(NM,$M);Jr[e]=new Cn(e,1,!1,i,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(i){Jr[i]=new Cn(i,1,!1,i.toLowerCase(),null,!1,!1)});Jr.xlinkHref=new Cn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(i){Jr[i]=new Cn(i,1,!1,i.toLowerCase(),null,!0,!0)});function UM(i,e,t,r){var n=Jr.hasOwnProperty(e)?Jr[e]:null;(n!==null?n.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(yie(e,t,n,r)&&(t=null),r||n===null?mie(e)&&(t===null?i.removeAttribute(e):i.setAttribute(e,""+t)):n.mustUseProperty?i[n.propertyName]=t===null?n.type===3?!1:"":t:(e=n.attributeName,r=n.attributeNamespace,t===null?i.removeAttribute(e):(n=n.type,t=n===3||n===4&&t===!0?"":""+t,r?i.setAttributeNS(r,e,t):i.setAttribute(e,t))))}var Rs=die.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,gg=Symbol.for("react.element"),Ac=Symbol.for("react.portal"),Ic=Symbol.for("react.fragment"),VM=Symbol.for("react.strict_mode"),K2=Symbol.for("react.profiler"),YI=Symbol.for("react.provider"),JI=Symbol.for("react.context"),jM=Symbol.for("react.forward_ref"),Q2=Symbol.for("react.suspense"),eb=Symbol.for("react.suspense_list"),HM=Symbol.for("react.memo"),ll=Symbol.for("react.lazy"),KI=Symbol.for("react.offscreen"),xT=Symbol.iterator;function cd(i){return i===null||typeof i!="object"?null:(i=xT&&i[xT]||i["@@iterator"],typeof i=="function"?i:null)}var tr=Object.assign,p_;function zd(i){if(p_===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);p_=e&&e[1]||""}return`
`+p_+i}var d_=!1;function f_(i,e){if(!i||d_)return"";d_=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(i,[],e)}else{try{e.call()}catch(u){r=u}i.call(e.prototype)}else{try{throw Error()}catch(u){r=u}i()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var n=u.stack.split(`
`),a=r.stack.split(`
`),o=n.length-1,s=a.length-1;1<=o&&0<=s&&n[o]!==a[s];)s--;for(;1<=o&&0<=s;o--,s--)if(n[o]!==a[s]){if(o!==1||s!==1)do if(o--,s--,0>s||n[o]!==a[s]){var l=`
`+n[o].replace(" at new "," at ");return i.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",i.displayName)),l}while(1<=o&&0<=s);break}}}finally{d_=!1,Error.prepareStackTrace=t}return(i=i?i.displayName||i.name:"")?zd(i):""}function vie(i){switch(i.tag){case 5:return zd(i.type);case 16:return zd("Lazy");case 13:return zd("Suspense");case 19:return zd("SuspenseList");case 0:case 2:case 15:return i=f_(i.type,!1),i;case 11:return i=f_(i.type.render,!1),i;case 1:return i=f_(i.type,!0),i;default:return""}}function tb(i){if(i==null)return null;if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case Ic:return"Fragment";case Ac:return"Portal";case K2:return"Profiler";case VM:return"StrictMode";case Q2:return"Suspense";case eb:return"SuspenseList"}if(typeof i=="object")switch(i.$$typeof){case JI:return(i.displayName||"Context")+".Consumer";case YI:return(i._context.displayName||"Context")+".Provider";case jM:var e=i.render;return i=i.displayName,i||(i=e.displayName||e.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case HM:return e=i.displayName||null,e!==null?e:tb(i.type)||"Memo";case ll:e=i._payload,i=i._init;try{return tb(i(e))}catch{}}return null}function xie(i){var e=i.type;switch(i.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return i=e.render,i=i.displayName||i.name||"",e.displayName||(i!==""?"ForwardRef("+i+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return tb(e);case 8:return e===VM?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Dl(i){switch(typeof i){case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function QI(i){var e=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function _ie(i){var e=QI(i)?"checked":"value",t=Object.getOwnPropertyDescriptor(i.constructor.prototype,e),r=""+i[e];if(!i.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var n=t.get,a=t.set;return Object.defineProperty(i,e,{configurable:!0,get:function(){return n.call(this)},set:function(o){r=""+o,a.call(this,o)}}),Object.defineProperty(i,e,{enumerable:t.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){i._valueTracker=null,delete i[e]}}}}function yg(i){i._valueTracker||(i._valueTracker=_ie(i))}function e8(i){if(!i)return!1;var e=i._valueTracker;if(!e)return!0;var t=e.getValue(),r="";return i&&(r=QI(i)?i.checked?"true":"false":i.value),i=r,i!==t?(e.setValue(i),!0):!1}function P0(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}function ib(i,e){var t=e.checked;return tr({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??i._wrapperState.initialChecked})}function _T(i,e){var t=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;t=Dl(e.value!=null?e.value:t),i._wrapperState={initialChecked:r,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function t8(i,e){e=e.checked,e!=null&&UM(i,"checked",e,!1)}function rb(i,e){t8(i,e);var t=Dl(e.value),r=e.type;if(t!=null)r==="number"?(t===0&&i.value===""||i.value!=t)&&(i.value=""+t):i.value!==""+t&&(i.value=""+t);else if(r==="submit"||r==="reset"){i.removeAttribute("value");return}e.hasOwnProperty("value")?nb(i,e.type,t):e.hasOwnProperty("defaultValue")&&nb(i,e.type,Dl(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(i.defaultChecked=!!e.defaultChecked)}function bT(i,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+i._wrapperState.initialValue,t||e===i.value||(i.value=e),i.defaultValue=e}t=i.name,t!==""&&(i.name=""),i.defaultChecked=!!i._wrapperState.initialChecked,t!==""&&(i.name=t)}function nb(i,e,t){(e!=="number"||P0(i.ownerDocument)!==i)&&(t==null?i.defaultValue=""+i._wrapperState.initialValue:i.defaultValue!==""+t&&(i.defaultValue=""+t))}var Bd=Array.isArray;function Yc(i,e,t,r){if(i=i.options,e){e={};for(var n=0;n<t.length;n++)e["$"+t[n]]=!0;for(t=0;t<i.length;t++)n=e.hasOwnProperty("$"+i[t].value),i[t].selected!==n&&(i[t].selected=n),n&&r&&(i[t].defaultSelected=!0)}else{for(t=""+Dl(t),e=null,n=0;n<i.length;n++){if(i[n].value===t){i[n].selected=!0,r&&(i[n].defaultSelected=!0);return}e!==null||i[n].disabled||(e=i[n])}e!==null&&(e.selected=!0)}}function ab(i,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Ke(91));return tr({},e,{value:void 0,defaultValue:void 0,children:""+i._wrapperState.initialValue})}function wT(i,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(Ke(92));if(Bd(t)){if(1<t.length)throw Error(Ke(93));t=t[0]}e=t}e==null&&(e=""),t=e}i._wrapperState={initialValue:Dl(t)}}function i8(i,e){var t=Dl(e.value),r=Dl(e.defaultValue);t!=null&&(t=""+t,t!==i.value&&(i.value=t),e.defaultValue==null&&i.defaultValue!==t&&(i.defaultValue=t)),r!=null&&(i.defaultValue=""+r)}function ST(i){var e=i.textContent;e===i._wrapperState.initialValue&&e!==""&&e!==null&&(i.value=e)}function r8(i){switch(i){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ob(i,e){return i==null||i==="http://www.w3.org/1999/xhtml"?r8(e):i==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":i}var vg,n8=function(i){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,r,n){MSApp.execUnsafeLocalFunction(function(){return i(e,t,r,n)})}:i}(function(i,e){if(i.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in i)i.innerHTML=e;else{for(vg=vg||document.createElement("div"),vg.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=vg.firstChild;i.firstChild;)i.removeChild(i.firstChild);for(;e.firstChild;)i.appendChild(e.firstChild)}});function Yf(i,e){if(e){var t=i.firstChild;if(t&&t===i.lastChild&&t.nodeType===3){t.nodeValue=e;return}}i.textContent=e}var Ff={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},bie=["Webkit","ms","Moz","O"];Object.keys(Ff).forEach(function(i){bie.forEach(function(e){e=e+i.charAt(0).toUpperCase()+i.substring(1),Ff[e]=Ff[i]})});function a8(i,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||Ff.hasOwnProperty(i)&&Ff[i]?(""+e).trim():e+"px"}function o8(i,e){i=i.style;for(var t in e)if(e.hasOwnProperty(t)){var r=t.indexOf("--")===0,n=a8(t,e[t],r);t==="float"&&(t="cssFloat"),r?i.setProperty(t,n):i[t]=n}}var wie=tr({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function sb(i,e){if(e){if(wie[i]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Ke(137,i));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Ke(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Ke(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Ke(62))}}function lb(i,e){if(i.indexOf("-")===-1)return typeof e.is=="string";switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ub=null;function GM(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var hb=null,Jc=null,Kc=null;function MT(i){if(i=Rm(i)){if(typeof hb!="function")throw Error(Ke(280));var e=i.stateNode;e&&(e=Vv(e),hb(i.stateNode,i.type,e))}}function s8(i){Jc?Kc?Kc.push(i):Kc=[i]:Jc=i}function l8(){if(Jc){var i=Jc,e=Kc;if(Kc=Jc=null,MT(i),e)for(i=0;i<e.length;i++)MT(e[i])}}function u8(i,e){return i(e)}function h8(){}var m_=!1;function c8(i,e,t){if(m_)return i(e,t);m_=!0;try{return u8(i,e,t)}finally{m_=!1,(Jc!==null||Kc!==null)&&(h8(),l8())}}function Jf(i,e){var t=i.stateNode;if(t===null)return null;var r=Vv(t);if(r===null)return null;t=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(i=i.type,r=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!r;break e;default:i=!1}if(i)return null;if(t&&typeof t!="function")throw Error(Ke(231,e,typeof t));return t}var cb=!1;if(Ts)try{var pd={};Object.defineProperty(pd,"passive",{get:function(){cb=!0}}),window.addEventListener("test",pd,pd),window.removeEventListener("test",pd,pd)}catch{cb=!1}function Sie(i,e,t,r,n,a,o,s,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(t,u)}catch(c){this.onError(c)}}var zf=!1,A0=null,I0=!1,pb=null,Mie={onError:function(i){zf=!0,A0=i}};function Cie(i,e,t,r,n,a,o,s,l){zf=!1,A0=null,Sie.apply(Mie,arguments)}function Eie(i,e,t,r,n,a,o,s,l){if(Cie.apply(this,arguments),zf){if(zf){var u=A0;zf=!1,A0=null}else throw Error(Ke(198));I0||(I0=!0,pb=u)}}function ah(i){var e=i,t=i;if(i.alternate)for(;e.return;)e=e.return;else{i=e;do e=i,e.flags&4098&&(t=e.return),i=e.return;while(i)}return e.tag===3?t:null}function p8(i){if(i.tag===13){var e=i.memoizedState;if(e===null&&(i=i.alternate,i!==null&&(e=i.memoizedState)),e!==null)return e.dehydrated}return null}function CT(i){if(ah(i)!==i)throw Error(Ke(188))}function Tie(i){var e=i.alternate;if(!e){if(e=ah(i),e===null)throw Error(Ke(188));return e!==i?null:i}for(var t=i,r=e;;){var n=t.return;if(n===null)break;var a=n.alternate;if(a===null){if(r=n.return,r!==null){t=r;continue}break}if(n.child===a.child){for(a=n.child;a;){if(a===t)return CT(n),i;if(a===r)return CT(n),e;a=a.sibling}throw Error(Ke(188))}if(t.return!==r.return)t=n,r=a;else{for(var o=!1,s=n.child;s;){if(s===t){o=!0,t=n,r=a;break}if(s===r){o=!0,r=n,t=a;break}s=s.sibling}if(!o){for(s=a.child;s;){if(s===t){o=!0,t=a,r=n;break}if(s===r){o=!0,r=a,t=n;break}s=s.sibling}if(!o)throw Error(Ke(189))}}if(t.alternate!==r)throw Error(Ke(190))}if(t.tag!==3)throw Error(Ke(188));return t.stateNode.current===t?i:e}function d8(i){return i=Tie(i),i!==null?f8(i):null}function f8(i){if(i.tag===5||i.tag===6)return i;for(i=i.child;i!==null;){var e=f8(i);if(e!==null)return e;i=i.sibling}return null}var m8=pa.unstable_scheduleCallback,ET=pa.unstable_cancelCallback,Pie=pa.unstable_shouldYield,Aie=pa.unstable_requestPaint,gr=pa.unstable_now,Iie=pa.unstable_getCurrentPriorityLevel,WM=pa.unstable_ImmediatePriority,g8=pa.unstable_UserBlockingPriority,L0=pa.unstable_NormalPriority,Lie=pa.unstable_LowPriority,y8=pa.unstable_IdlePriority,Ov=null,Oo=null;function Die(i){if(Oo&&typeof Oo.onCommitFiberRoot=="function")try{Oo.onCommitFiberRoot(Ov,i,void 0,(i.current.flags&128)===128)}catch{}}var fo=Math.clz32?Math.clz32:Fie,kie=Math.log,Rie=Math.LN2;function Fie(i){return i>>>=0,i===0?32:31-(kie(i)/Rie|0)|0}var xg=64,_g=4194304;function Od(i){switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return i&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return i}}function D0(i,e){var t=i.pendingLanes;if(t===0)return 0;var r=0,n=i.suspendedLanes,a=i.pingedLanes,o=t&268435455;if(o!==0){var s=o&~n;s!==0?r=Od(s):(a&=o,a!==0&&(r=Od(a)))}else o=t&~n,o!==0?r=Od(o):a!==0&&(r=Od(a));if(r===0)return 0;if(e!==0&&e!==r&&!(e&n)&&(n=r&-r,a=e&-e,n>=a||n===16&&(a&4194240)!==0))return e;if(r&4&&(r|=t&16),e=i.entangledLanes,e!==0)for(i=i.entanglements,e&=r;0<e;)t=31-fo(e),n=1<<t,r|=i[t],e&=~n;return r}function zie(i,e){switch(i){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Bie(i,e){for(var t=i.suspendedLanes,r=i.pingedLanes,n=i.expirationTimes,a=i.pendingLanes;0<a;){var o=31-fo(a),s=1<<o,l=n[o];l===-1?(!(s&t)||s&r)&&(n[o]=zie(s,e)):l<=e&&(i.expiredLanes|=s),a&=~s}}function db(i){return i=i.pendingLanes&-1073741825,i!==0?i:i&1073741824?1073741824:0}function v8(){var i=xg;return xg<<=1,!(xg&4194240)&&(xg=64),i}function g_(i){for(var e=[],t=0;31>t;t++)e.push(i);return e}function Dm(i,e,t){i.pendingLanes|=e,e!==536870912&&(i.suspendedLanes=0,i.pingedLanes=0),i=i.eventTimes,e=31-fo(e),i[e]=t}function Oie(i,e){var t=i.pendingLanes&~e;i.pendingLanes=e,i.suspendedLanes=0,i.pingedLanes=0,i.expiredLanes&=e,i.mutableReadLanes&=e,i.entangledLanes&=e,e=i.entanglements;var r=i.eventTimes;for(i=i.expirationTimes;0<t;){var n=31-fo(t),a=1<<n;e[n]=0,r[n]=-1,i[n]=-1,t&=~a}}function XM(i,e){var t=i.entangledLanes|=e;for(i=i.entanglements;t;){var r=31-fo(t),n=1<<r;n&e|i[r]&e&&(i[r]|=e),t&=~n}}var _i=0;function x8(i){return i&=-i,1<i?4<i?i&268435455?16:536870912:4:1}var _8,qM,b8,w8,S8,fb=!1,bg=[],xl=null,_l=null,bl=null,Kf=new Map,Qf=new Map,hl=[],Nie="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function TT(i,e){switch(i){case"focusin":case"focusout":xl=null;break;case"dragenter":case"dragleave":_l=null;break;case"mouseover":case"mouseout":bl=null;break;case"pointerover":case"pointerout":Kf.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Qf.delete(e.pointerId)}}function dd(i,e,t,r,n,a){return i===null||i.nativeEvent!==a?(i={blockedOn:e,domEventName:t,eventSystemFlags:r,nativeEvent:a,targetContainers:[n]},e!==null&&(e=Rm(e),e!==null&&qM(e)),i):(i.eventSystemFlags|=r,e=i.targetContainers,n!==null&&e.indexOf(n)===-1&&e.push(n),i)}function $ie(i,e,t,r,n){switch(e){case"focusin":return xl=dd(xl,i,e,t,r,n),!0;case"dragenter":return _l=dd(_l,i,e,t,r,n),!0;case"mouseover":return bl=dd(bl,i,e,t,r,n),!0;case"pointerover":var a=n.pointerId;return Kf.set(a,dd(Kf.get(a)||null,i,e,t,r,n)),!0;case"gotpointercapture":return a=n.pointerId,Qf.set(a,dd(Qf.get(a)||null,i,e,t,r,n)),!0}return!1}function M8(i){var e=Su(i.target);if(e!==null){var t=ah(e);if(t!==null){if(e=t.tag,e===13){if(e=p8(t),e!==null){i.blockedOn=e,S8(i.priority,function(){b8(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){i.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}i.blockedOn=null}function O1(i){if(i.blockedOn!==null)return!1;for(var e=i.targetContainers;0<e.length;){var t=mb(i.domEventName,i.eventSystemFlags,e[0],i.nativeEvent);if(t===null){t=i.nativeEvent;var r=new t.constructor(t.type,t);ub=r,t.target.dispatchEvent(r),ub=null}else return e=Rm(t),e!==null&&qM(e),i.blockedOn=t,!1;e.shift()}return!0}function PT(i,e,t){O1(i)&&t.delete(e)}function Uie(){fb=!1,xl!==null&&O1(xl)&&(xl=null),_l!==null&&O1(_l)&&(_l=null),bl!==null&&O1(bl)&&(bl=null),Kf.forEach(PT),Qf.forEach(PT)}function fd(i,e){i.blockedOn===e&&(i.blockedOn=null,fb||(fb=!0,pa.unstable_scheduleCallback(pa.unstable_NormalPriority,Uie)))}function em(i){function e(n){return fd(n,i)}if(0<bg.length){fd(bg[0],i);for(var t=1;t<bg.length;t++){var r=bg[t];r.blockedOn===i&&(r.blockedOn=null)}}for(xl!==null&&fd(xl,i),_l!==null&&fd(_l,i),bl!==null&&fd(bl,i),Kf.forEach(e),Qf.forEach(e),t=0;t<hl.length;t++)r=hl[t],r.blockedOn===i&&(r.blockedOn=null);for(;0<hl.length&&(t=hl[0],t.blockedOn===null);)M8(t),t.blockedOn===null&&hl.shift()}var Qc=Rs.ReactCurrentBatchConfig,k0=!0;function Vie(i,e,t,r){var n=_i,a=Qc.transition;Qc.transition=null;try{_i=1,ZM(i,e,t,r)}finally{_i=n,Qc.transition=a}}function jie(i,e,t,r){var n=_i,a=Qc.transition;Qc.transition=null;try{_i=4,ZM(i,e,t,r)}finally{_i=n,Qc.transition=a}}function ZM(i,e,t,r){if(k0){var n=mb(i,e,t,r);if(n===null)E_(i,e,r,R0,t),TT(i,r);else if($ie(n,i,e,t,r))r.stopPropagation();else if(TT(i,r),e&4&&-1<Nie.indexOf(i)){for(;n!==null;){var a=Rm(n);if(a!==null&&_8(a),a=mb(i,e,t,r),a===null&&E_(i,e,r,R0,t),a===n)break;n=a}n!==null&&r.stopPropagation()}else E_(i,e,r,null,t)}}var R0=null;function mb(i,e,t,r){if(R0=null,i=GM(r),i=Su(i),i!==null)if(e=ah(i),e===null)i=null;else if(t=e.tag,t===13){if(i=p8(e),i!==null)return i;i=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;i=null}else e!==i&&(i=null);return R0=i,null}function C8(i){switch(i){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Iie()){case WM:return 1;case g8:return 4;case L0:case Lie:return 16;case y8:return 536870912;default:return 16}default:return 16}}var dl=null,YM=null,N1=null;function E8(){if(N1)return N1;var i,e=YM,t=e.length,r,n="value"in dl?dl.value:dl.textContent,a=n.length;for(i=0;i<t&&e[i]===n[i];i++);var o=t-i;for(r=1;r<=o&&e[t-r]===n[a-r];r++);return N1=n.slice(i,1<r?1-r:void 0)}function $1(i){var e=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&e===13&&(i=13)):i=e,i===10&&(i=13),32<=i||i===13?i:0}function wg(){return!0}function AT(){return!1}function fa(i){function e(t,r,n,a,o){this._reactName=t,this._targetInst=n,this.type=r,this.nativeEvent=a,this.target=o,this.currentTarget=null;for(var s in i)i.hasOwnProperty(s)&&(t=i[s],this[s]=t?t(a):a[s]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?wg:AT,this.isPropagationStopped=AT,this}return tr(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=wg)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=wg)},persist:function(){},isPersistent:wg}),e}var Jp={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},JM=fa(Jp),km=tr({},Jp,{view:0,detail:0}),Hie=fa(km),y_,v_,md,Nv=tr({},km,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:KM,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==md&&(md&&i.type==="mousemove"?(y_=i.screenX-md.screenX,v_=i.screenY-md.screenY):v_=y_=0,md=i),y_)},movementY:function(i){return"movementY"in i?i.movementY:v_}}),IT=fa(Nv),Gie=tr({},Nv,{dataTransfer:0}),Wie=fa(Gie),Xie=tr({},km,{relatedTarget:0}),x_=fa(Xie),qie=tr({},Jp,{animationName:0,elapsedTime:0,pseudoElement:0}),Zie=fa(qie),Yie=tr({},Jp,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),Jie=fa(Yie),Kie=tr({},Jp,{data:0}),LT=fa(Kie),Qie={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ere={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},tre={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ire(i){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(i):(i=tre[i])?!!e[i]:!1}function KM(){return ire}var rre=tr({},km,{key:function(i){if(i.key){var e=Qie[i.key]||i.key;if(e!=="Unidentified")return e}return i.type==="keypress"?(i=$1(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?ere[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:KM,charCode:function(i){return i.type==="keypress"?$1(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?$1(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),nre=fa(rre),are=tr({},Nv,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),DT=fa(are),ore=tr({},km,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:KM}),sre=fa(ore),lre=tr({},Jp,{propertyName:0,elapsedTime:0,pseudoElement:0}),ure=fa(lre),hre=tr({},Nv,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),cre=fa(hre),pre=[9,13,27,32],QM=Ts&&"CompositionEvent"in window,Bf=null;Ts&&"documentMode"in document&&(Bf=document.documentMode);var dre=Ts&&"TextEvent"in window&&!Bf,T8=Ts&&(!QM||Bf&&8<Bf&&11>=Bf),kT=" ",RT=!1;function P8(i,e){switch(i){case"keyup":return pre.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function A8(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var Lc=!1;function fre(i,e){switch(i){case"compositionend":return A8(e);case"keypress":return e.which!==32?null:(RT=!0,kT);case"textInput":return i=e.data,i===kT&&RT?null:i;default:return null}}function mre(i,e){if(Lc)return i==="compositionend"||!QM&&P8(i,e)?(i=E8(),N1=YM=dl=null,Lc=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return T8&&e.locale!=="ko"?null:e.data;default:return null}}var gre={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function FT(i){var e=i&&i.nodeName&&i.nodeName.toLowerCase();return e==="input"?!!gre[i.type]:e==="textarea"}function I8(i,e,t,r){s8(r),e=F0(e,"onChange"),0<e.length&&(t=new JM("onChange","change",null,t,r),i.push({event:t,listeners:e}))}var Of=null,tm=null;function yre(i){U8(i,0)}function $v(i){var e=Rc(i);if(e8(e))return i}function vre(i,e){if(i==="change")return e}var L8=!1;if(Ts){var __;if(Ts){var b_="oninput"in document;if(!b_){var zT=document.createElement("div");zT.setAttribute("oninput","return;"),b_=typeof zT.oninput=="function"}__=b_}else __=!1;L8=__&&(!document.documentMode||9<document.documentMode)}function BT(){Of&&(Of.detachEvent("onpropertychange",D8),tm=Of=null)}function D8(i){if(i.propertyName==="value"&&$v(tm)){var e=[];I8(e,tm,i,GM(i)),c8(yre,e)}}function xre(i,e,t){i==="focusin"?(BT(),Of=e,tm=t,Of.attachEvent("onpropertychange",D8)):i==="focusout"&&BT()}function _re(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return $v(tm)}function bre(i,e){if(i==="click")return $v(e)}function wre(i,e){if(i==="input"||i==="change")return $v(e)}function Sre(i,e){return i===e&&(i!==0||1/i===1/e)||i!==i&&e!==e}var yo=typeof Object.is=="function"?Object.is:Sre;function im(i,e){if(yo(i,e))return!0;if(typeof i!="object"||i===null||typeof e!="object"||e===null)return!1;var t=Object.keys(i),r=Object.keys(e);if(t.length!==r.length)return!1;for(r=0;r<t.length;r++){var n=t[r];if(!J2.call(e,n)||!yo(i[n],e[n]))return!1}return!0}function OT(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function NT(i,e){var t=OT(i);i=0;for(var r;t;){if(t.nodeType===3){if(r=i+t.textContent.length,i<=e&&r>=e)return{node:t,offset:e-i};i=r}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=OT(t)}}function k8(i,e){return i&&e?i===e?!0:i&&i.nodeType===3?!1:e&&e.nodeType===3?k8(i,e.parentNode):"contains"in i?i.contains(e):i.compareDocumentPosition?!!(i.compareDocumentPosition(e)&16):!1:!1}function R8(){for(var i=window,e=P0();e instanceof i.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)i=e.contentWindow;else break;e=P0(i.document)}return e}function eC(i){var e=i&&i.nodeName&&i.nodeName.toLowerCase();return e&&(e==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||e==="textarea"||i.contentEditable==="true")}function Mre(i){var e=R8(),t=i.focusedElem,r=i.selectionRange;if(e!==t&&t&&t.ownerDocument&&k8(t.ownerDocument.documentElement,t)){if(r!==null&&eC(t)){if(e=r.start,i=r.end,i===void 0&&(i=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(i,t.value.length);else if(i=(e=t.ownerDocument||document)&&e.defaultView||window,i.getSelection){i=i.getSelection();var n=t.textContent.length,a=Math.min(r.start,n);r=r.end===void 0?a:Math.min(r.end,n),!i.extend&&a>r&&(n=r,r=a,a=n),n=NT(t,a);var o=NT(t,r);n&&o&&(i.rangeCount!==1||i.anchorNode!==n.node||i.anchorOffset!==n.offset||i.focusNode!==o.node||i.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(n.node,n.offset),i.removeAllRanges(),a>r?(i.addRange(e),i.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),i.addRange(e)))}}for(e=[],i=t;i=i.parentNode;)i.nodeType===1&&e.push({element:i,left:i.scrollLeft,top:i.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)i=e[t],i.element.scrollLeft=i.left,i.element.scrollTop=i.top}}var Cre=Ts&&"documentMode"in document&&11>=document.documentMode,Dc=null,gb=null,Nf=null,yb=!1;function $T(i,e,t){var r=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;yb||Dc==null||Dc!==P0(r)||(r=Dc,"selectionStart"in r&&eC(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Nf&&im(Nf,r)||(Nf=r,r=F0(gb,"onSelect"),0<r.length&&(e=new JM("onSelect","select",null,e,t),i.push({event:e,listeners:r}),e.target=Dc)))}function Sg(i,e){var t={};return t[i.toLowerCase()]=e.toLowerCase(),t["Webkit"+i]="webkit"+e,t["Moz"+i]="moz"+e,t}var kc={animationend:Sg("Animation","AnimationEnd"),animationiteration:Sg("Animation","AnimationIteration"),animationstart:Sg("Animation","AnimationStart"),transitionend:Sg("Transition","TransitionEnd")},w_={},F8={};Ts&&(F8=document.createElement("div").style,"AnimationEvent"in window||(delete kc.animationend.animation,delete kc.animationiteration.animation,delete kc.animationstart.animation),"TransitionEvent"in window||delete kc.transitionend.transition);function Uv(i){if(w_[i])return w_[i];if(!kc[i])return i;var e=kc[i],t;for(t in e)if(e.hasOwnProperty(t)&&t in F8)return w_[i]=e[t];return i}var z8=Uv("animationend"),B8=Uv("animationiteration"),O8=Uv("animationstart"),N8=Uv("transitionend"),$8=new Map,UT="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function $l(i,e){$8.set(i,e),nh(e,[i])}for(var S_=0;S_<UT.length;S_++){var M_=UT[S_],Ere=M_.toLowerCase(),Tre=M_[0].toUpperCase()+M_.slice(1);$l(Ere,"on"+Tre)}$l(z8,"onAnimationEnd");$l(B8,"onAnimationIteration");$l(O8,"onAnimationStart");$l("dblclick","onDoubleClick");$l("focusin","onFocus");$l("focusout","onBlur");$l(N8,"onTransitionEnd");wp("onMouseEnter",["mouseout","mouseover"]);wp("onMouseLeave",["mouseout","mouseover"]);wp("onPointerEnter",["pointerout","pointerover"]);wp("onPointerLeave",["pointerout","pointerover"]);nh("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));nh("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));nh("onBeforeInput",["compositionend","keypress","textInput","paste"]);nh("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));nh("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));nh("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Nd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Pre=new Set("cancel close invalid load scroll toggle".split(" ").concat(Nd));function VT(i,e,t){var r=i.type||"unknown-event";i.currentTarget=t,Eie(r,e,void 0,i),i.currentTarget=null}function U8(i,e){e=(e&4)!==0;for(var t=0;t<i.length;t++){var r=i[t],n=r.event;r=r.listeners;e:{var a=void 0;if(e)for(var o=r.length-1;0<=o;o--){var s=r[o],l=s.instance,u=s.currentTarget;if(s=s.listener,l!==a&&n.isPropagationStopped())break e;VT(n,s,u),a=l}else for(o=0;o<r.length;o++){if(s=r[o],l=s.instance,u=s.currentTarget,s=s.listener,l!==a&&n.isPropagationStopped())break e;VT(n,s,u),a=l}}}if(I0)throw i=pb,I0=!1,pb=null,i}function Li(i,e){var t=e[wb];t===void 0&&(t=e[wb]=new Set);var r=i+"__bubble";t.has(r)||(V8(e,i,2,!1),t.add(r))}function C_(i,e,t){var r=0;e&&(r|=4),V8(t,i,r,e)}var Mg="_reactListening"+Math.random().toString(36).slice(2);function rm(i){if(!i[Mg]){i[Mg]=!0,ZI.forEach(function(t){t!=="selectionchange"&&(Pre.has(t)||C_(t,!1,i),C_(t,!0,i))});var e=i.nodeType===9?i:i.ownerDocument;e===null||e[Mg]||(e[Mg]=!0,C_("selectionchange",!1,e))}}function V8(i,e,t,r){switch(C8(e)){case 1:var n=Vie;break;case 4:n=jie;break;default:n=ZM}t=n.bind(null,e,t,i),n=void 0,!cb||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(n=!0),r?n!==void 0?i.addEventListener(e,t,{capture:!0,passive:n}):i.addEventListener(e,t,!0):n!==void 0?i.addEventListener(e,t,{passive:n}):i.addEventListener(e,t,!1)}function E_(i,e,t,r,n){var a=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var s=r.stateNode.containerInfo;if(s===n||s.nodeType===8&&s.parentNode===n)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===n||l.nodeType===8&&l.parentNode===n))return;o=o.return}for(;s!==null;){if(o=Su(s),o===null)return;if(l=o.tag,l===5||l===6){r=a=o;continue e}s=s.parentNode}}r=r.return}c8(function(){var u=a,c=GM(t),p=[];e:{var d=$8.get(i);if(d!==void 0){var m=JM,g=i;switch(i){case"keypress":if($1(t)===0)break e;case"keydown":case"keyup":m=nre;break;case"focusin":g="focus",m=x_;break;case"focusout":g="blur",m=x_;break;case"beforeblur":case"afterblur":m=x_;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=IT;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=Wie;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=sre;break;case z8:case B8:case O8:m=Zie;break;case N8:m=ure;break;case"scroll":m=Hie;break;case"wheel":m=cre;break;case"copy":case"cut":case"paste":m=Jie;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=DT}var b=(e&4)!==0,x=!b&&i==="scroll",v=b?d!==null?d+"Capture":null:d;b=[];for(var w=u,_;w!==null;){_=w;var C=_.stateNode;if(_.tag===5&&C!==null&&(_=C,v!==null&&(C=Jf(w,v),C!=null&&b.push(nm(w,C,_)))),x)break;w=w.return}0<b.length&&(d=new m(d,g,null,t,c),p.push({event:d,listeners:b}))}}if(!(e&7)){e:{if(d=i==="mouseover"||i==="pointerover",m=i==="mouseout"||i==="pointerout",d&&t!==ub&&(g=t.relatedTarget||t.fromElement)&&(Su(g)||g[Ps]))break e;if((m||d)&&(d=c.window===c?c:(d=c.ownerDocument)?d.defaultView||d.parentWindow:window,m?(g=t.relatedTarget||t.toElement,m=u,g=g?Su(g):null,g!==null&&(x=ah(g),g!==x||g.tag!==5&&g.tag!==6)&&(g=null)):(m=null,g=u),m!==g)){if(b=IT,C="onMouseLeave",v="onMouseEnter",w="mouse",(i==="pointerout"||i==="pointerover")&&(b=DT,C="onPointerLeave",v="onPointerEnter",w="pointer"),x=m==null?d:Rc(m),_=g==null?d:Rc(g),d=new b(C,w+"leave",m,t,c),d.target=x,d.relatedTarget=_,C=null,Su(c)===u&&(b=new b(v,w+"enter",g,t,c),b.target=_,b.relatedTarget=x,C=b),x=C,m&&g)t:{for(b=m,v=g,w=0,_=b;_;_=bh(_))w++;for(_=0,C=v;C;C=bh(C))_++;for(;0<w-_;)b=bh(b),w--;for(;0<_-w;)v=bh(v),_--;for(;w--;){if(b===v||v!==null&&b===v.alternate)break t;b=bh(b),v=bh(v)}b=null}else b=null;m!==null&&jT(p,d,m,b,!1),g!==null&&x!==null&&jT(p,x,g,b,!0)}}e:{if(d=u?Rc(u):window,m=d.nodeName&&d.nodeName.toLowerCase(),m==="select"||m==="input"&&d.type==="file")var E=vre;else if(FT(d))if(L8)E=wre;else{E=_re;var T=xre}else(m=d.nodeName)&&m.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(E=bre);if(E&&(E=E(i,u))){I8(p,E,t,c);break e}T&&T(i,d,u),i==="focusout"&&(T=d._wrapperState)&&T.controlled&&d.type==="number"&&nb(d,"number",d.value)}switch(T=u?Rc(u):window,i){case"focusin":(FT(T)||T.contentEditable==="true")&&(Dc=T,gb=u,Nf=null);break;case"focusout":Nf=gb=Dc=null;break;case"mousedown":yb=!0;break;case"contextmenu":case"mouseup":case"dragend":yb=!1,$T(p,t,c);break;case"selectionchange":if(Cre)break;case"keydown":case"keyup":$T(p,t,c)}var L;if(QM)e:{switch(i){case"compositionstart":var D="onCompositionStart";break e;case"compositionend":D="onCompositionEnd";break e;case"compositionupdate":D="onCompositionUpdate";break e}D=void 0}else Lc?P8(i,t)&&(D="onCompositionEnd"):i==="keydown"&&t.keyCode===229&&(D="onCompositionStart");D&&(T8&&t.locale!=="ko"&&(Lc||D!=="onCompositionStart"?D==="onCompositionEnd"&&Lc&&(L=E8()):(dl=c,YM="value"in dl?dl.value:dl.textContent,Lc=!0)),T=F0(u,D),0<T.length&&(D=new LT(D,i,null,t,c),p.push({event:D,listeners:T}),L?D.data=L:(L=A8(t),L!==null&&(D.data=L)))),(L=dre?fre(i,t):mre(i,t))&&(u=F0(u,"onBeforeInput"),0<u.length&&(c=new LT("onBeforeInput","beforeinput",null,t,c),p.push({event:c,listeners:u}),c.data=L))}U8(p,e)})}function nm(i,e,t){return{instance:i,listener:e,currentTarget:t}}function F0(i,e){for(var t=e+"Capture",r=[];i!==null;){var n=i,a=n.stateNode;n.tag===5&&a!==null&&(n=a,a=Jf(i,t),a!=null&&r.unshift(nm(i,a,n)),a=Jf(i,e),a!=null&&r.push(nm(i,a,n))),i=i.return}return r}function bh(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5);return i||null}function jT(i,e,t,r,n){for(var a=e._reactName,o=[];t!==null&&t!==r;){var s=t,l=s.alternate,u=s.stateNode;if(l!==null&&l===r)break;s.tag===5&&u!==null&&(s=u,n?(l=Jf(t,a),l!=null&&o.unshift(nm(t,l,s))):n||(l=Jf(t,a),l!=null&&o.push(nm(t,l,s)))),t=t.return}o.length!==0&&i.push({event:e,listeners:o})}var Are=/\r\n?/g,Ire=/\u0000|\uFFFD/g;function HT(i){return(typeof i=="string"?i:""+i).replace(Are,`
`).replace(Ire,"")}function Cg(i,e,t){if(e=HT(e),HT(i)!==e&&t)throw Error(Ke(425))}function z0(){}var vb=null,xb=null;function _b(i,e){return i==="textarea"||i==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var bb=typeof setTimeout=="function"?setTimeout:void 0,Lre=typeof clearTimeout=="function"?clearTimeout:void 0,GT=typeof Promise=="function"?Promise:void 0,Dre=typeof queueMicrotask=="function"?queueMicrotask:typeof GT<"u"?function(i){return GT.resolve(null).then(i).catch(kre)}:bb;function kre(i){setTimeout(function(){throw i})}function T_(i,e){var t=e,r=0;do{var n=t.nextSibling;if(i.removeChild(t),n&&n.nodeType===8)if(t=n.data,t==="/$"){if(r===0){i.removeChild(n),em(e);return}r--}else t!=="$"&&t!=="$?"&&t!=="$!"||r++;t=n}while(t);em(e)}function wl(i){for(;i!=null;i=i.nextSibling){var e=i.nodeType;if(e===1||e===3)break;if(e===8){if(e=i.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return i}function WT(i){i=i.previousSibling;for(var e=0;i;){if(i.nodeType===8){var t=i.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return i;e--}else t==="/$"&&e++}i=i.previousSibling}return null}var Kp=Math.random().toString(36).slice(2),zo="__reactFiber$"+Kp,am="__reactProps$"+Kp,Ps="__reactContainer$"+Kp,wb="__reactEvents$"+Kp,Rre="__reactListeners$"+Kp,Fre="__reactHandles$"+Kp;function Su(i){var e=i[zo];if(e)return e;for(var t=i.parentNode;t;){if(e=t[Ps]||t[zo]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(i=WT(i);i!==null;){if(t=i[zo])return t;i=WT(i)}return e}i=t,t=i.parentNode}return null}function Rm(i){return i=i[zo]||i[Ps],!i||i.tag!==5&&i.tag!==6&&i.tag!==13&&i.tag!==3?null:i}function Rc(i){if(i.tag===5||i.tag===6)return i.stateNode;throw Error(Ke(33))}function Vv(i){return i[am]||null}var Sb=[],Fc=-1;function Ul(i){return{current:i}}function Fi(i){0>Fc||(i.current=Sb[Fc],Sb[Fc]=null,Fc--)}function Ti(i,e){Fc++,Sb[Fc]=i.current,i.current=e}var kl={},un=Ul(kl),jn=Ul(!1),Vu=kl;function Sp(i,e){var t=i.type.contextTypes;if(!t)return kl;var r=i.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var n={},a;for(a in t)n[a]=e[a];return r&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=e,i.__reactInternalMemoizedMaskedChildContext=n),n}function Hn(i){return i=i.childContextTypes,i!=null}function B0(){Fi(jn),Fi(un)}function XT(i,e,t){if(un.current!==kl)throw Error(Ke(168));Ti(un,e),Ti(jn,t)}function j8(i,e,t){var r=i.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return t;r=r.getChildContext();for(var n in r)if(!(n in e))throw Error(Ke(108,xie(i)||"Unknown",n));return tr({},t,r)}function O0(i){return i=(i=i.stateNode)&&i.__reactInternalMemoizedMergedChildContext||kl,Vu=un.current,Ti(un,i),Ti(jn,jn.current),!0}function qT(i,e,t){var r=i.stateNode;if(!r)throw Error(Ke(169));t?(i=j8(i,e,Vu),r.__reactInternalMemoizedMergedChildContext=i,Fi(jn),Fi(un),Ti(un,i)):Fi(jn),Ti(jn,t)}var gs=null,jv=!1,P_=!1;function H8(i){gs===null?gs=[i]:gs.push(i)}function zre(i){jv=!0,H8(i)}function Vl(){if(!P_&&gs!==null){P_=!0;var i=0,e=_i;try{var t=gs;for(_i=1;i<t.length;i++){var r=t[i];do r=r(!0);while(r!==null)}gs=null,jv=!1}catch(n){throw gs!==null&&(gs=gs.slice(i+1)),m8(WM,Vl),n}finally{_i=e,P_=!1}}return null}var zc=[],Bc=0,N0=null,$0=0,Ea=[],Ta=0,ju=null,bs=1,ws="";function nu(i,e){zc[Bc++]=$0,zc[Bc++]=N0,N0=i,$0=e}function G8(i,e,t){Ea[Ta++]=bs,Ea[Ta++]=ws,Ea[Ta++]=ju,ju=i;var r=bs;i=ws;var n=32-fo(r)-1;r&=~(1<<n),t+=1;var a=32-fo(e)+n;if(30<a){var o=n-n%5;a=(r&(1<<o)-1).toString(32),r>>=o,n-=o,bs=1<<32-fo(e)+n|t<<n|r,ws=a+i}else bs=1<<a|t<<n|r,ws=i}function tC(i){i.return!==null&&(nu(i,1),G8(i,1,0))}function iC(i){for(;i===N0;)N0=zc[--Bc],zc[Bc]=null,$0=zc[--Bc],zc[Bc]=null;for(;i===ju;)ju=Ea[--Ta],Ea[Ta]=null,ws=Ea[--Ta],Ea[Ta]=null,bs=Ea[--Ta],Ea[Ta]=null}var ua=null,aa=null,Vi=!1,lo=null;function W8(i,e){var t=Ra(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=i,e=i.deletions,e===null?(i.deletions=[t],i.flags|=16):e.push(t)}function ZT(i,e){switch(i.tag){case 5:var t=i.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(i.stateNode=e,ua=i,aa=wl(e.firstChild),!0):!1;case 6:return e=i.pendingProps===""||e.nodeType!==3?null:e,e!==null?(i.stateNode=e,ua=i,aa=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=ju!==null?{id:bs,overflow:ws}:null,i.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=Ra(18,null,null,0),t.stateNode=e,t.return=i,i.child=t,ua=i,aa=null,!0):!1;default:return!1}}function Mb(i){return(i.mode&1)!==0&&(i.flags&128)===0}function Cb(i){if(Vi){var e=aa;if(e){var t=e;if(!ZT(i,e)){if(Mb(i))throw Error(Ke(418));e=wl(t.nextSibling);var r=ua;e&&ZT(i,e)?W8(r,t):(i.flags=i.flags&-4097|2,Vi=!1,ua=i)}}else{if(Mb(i))throw Error(Ke(418));i.flags=i.flags&-4097|2,Vi=!1,ua=i}}}function YT(i){for(i=i.return;i!==null&&i.tag!==5&&i.tag!==3&&i.tag!==13;)i=i.return;ua=i}function Eg(i){if(i!==ua)return!1;if(!Vi)return YT(i),Vi=!0,!1;var e;if((e=i.tag!==3)&&!(e=i.tag!==5)&&(e=i.type,e=e!=="head"&&e!=="body"&&!_b(i.type,i.memoizedProps)),e&&(e=aa)){if(Mb(i))throw X8(),Error(Ke(418));for(;e;)W8(i,e),e=wl(e.nextSibling)}if(YT(i),i.tag===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(Ke(317));e:{for(i=i.nextSibling,e=0;i;){if(i.nodeType===8){var t=i.data;if(t==="/$"){if(e===0){aa=wl(i.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}i=i.nextSibling}aa=null}}else aa=ua?wl(i.stateNode.nextSibling):null;return!0}function X8(){for(var i=aa;i;)i=wl(i.nextSibling)}function Mp(){aa=ua=null,Vi=!1}function rC(i){lo===null?lo=[i]:lo.push(i)}var Bre=Rs.ReactCurrentBatchConfig;function gd(i,e,t){if(i=t.ref,i!==null&&typeof i!="function"&&typeof i!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(Ke(309));var r=t.stateNode}if(!r)throw Error(Ke(147,i));var n=r,a=""+i;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===a?e.ref:(e=function(o){var s=n.refs;o===null?delete s[a]:s[a]=o},e._stringRef=a,e)}if(typeof i!="string")throw Error(Ke(284));if(!t._owner)throw Error(Ke(290,i))}return i}function Tg(i,e){throw i=Object.prototype.toString.call(e),Error(Ke(31,i==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":i))}function JT(i){var e=i._init;return e(i._payload)}function q8(i){function e(v,w){if(i){var _=v.deletions;_===null?(v.deletions=[w],v.flags|=16):_.push(w)}}function t(v,w){if(!i)return null;for(;w!==null;)e(v,w),w=w.sibling;return null}function r(v,w){for(v=new Map;w!==null;)w.key!==null?v.set(w.key,w):v.set(w.index,w),w=w.sibling;return v}function n(v,w){return v=El(v,w),v.index=0,v.sibling=null,v}function a(v,w,_){return v.index=_,i?(_=v.alternate,_!==null?(_=_.index,_<w?(v.flags|=2,w):_):(v.flags|=2,w)):(v.flags|=1048576,w)}function o(v){return i&&v.alternate===null&&(v.flags|=2),v}function s(v,w,_,C){return w===null||w.tag!==6?(w=F_(_,v.mode,C),w.return=v,w):(w=n(w,_),w.return=v,w)}function l(v,w,_,C){var E=_.type;return E===Ic?c(v,w,_.props.children,C,_.key):w!==null&&(w.elementType===E||typeof E=="object"&&E!==null&&E.$$typeof===ll&&JT(E)===w.type)?(C=n(w,_.props),C.ref=gd(v,w,_),C.return=v,C):(C=X1(_.type,_.key,_.props,null,v.mode,C),C.ref=gd(v,w,_),C.return=v,C)}function u(v,w,_,C){return w===null||w.tag!==4||w.stateNode.containerInfo!==_.containerInfo||w.stateNode.implementation!==_.implementation?(w=z_(_,v.mode,C),w.return=v,w):(w=n(w,_.children||[]),w.return=v,w)}function c(v,w,_,C,E){return w===null||w.tag!==7?(w=Du(_,v.mode,C,E),w.return=v,w):(w=n(w,_),w.return=v,w)}function p(v,w,_){if(typeof w=="string"&&w!==""||typeof w=="number")return w=F_(""+w,v.mode,_),w.return=v,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case gg:return _=X1(w.type,w.key,w.props,null,v.mode,_),_.ref=gd(v,null,w),_.return=v,_;case Ac:return w=z_(w,v.mode,_),w.return=v,w;case ll:var C=w._init;return p(v,C(w._payload),_)}if(Bd(w)||cd(w))return w=Du(w,v.mode,_,null),w.return=v,w;Tg(v,w)}return null}function d(v,w,_,C){var E=w!==null?w.key:null;if(typeof _=="string"&&_!==""||typeof _=="number")return E!==null?null:s(v,w,""+_,C);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case gg:return _.key===E?l(v,w,_,C):null;case Ac:return _.key===E?u(v,w,_,C):null;case ll:return E=_._init,d(v,w,E(_._payload),C)}if(Bd(_)||cd(_))return E!==null?null:c(v,w,_,C,null);Tg(v,_)}return null}function m(v,w,_,C,E){if(typeof C=="string"&&C!==""||typeof C=="number")return v=v.get(_)||null,s(w,v,""+C,E);if(typeof C=="object"&&C!==null){switch(C.$$typeof){case gg:return v=v.get(C.key===null?_:C.key)||null,l(w,v,C,E);case Ac:return v=v.get(C.key===null?_:C.key)||null,u(w,v,C,E);case ll:var T=C._init;return m(v,w,_,T(C._payload),E)}if(Bd(C)||cd(C))return v=v.get(_)||null,c(w,v,C,E,null);Tg(w,C)}return null}function g(v,w,_,C){for(var E=null,T=null,L=w,D=w=0,B=null;L!==null&&D<_.length;D++){L.index>D?(B=L,L=null):B=L.sibling;var A=d(v,L,_[D],C);if(A===null){L===null&&(L=B);break}i&&L&&A.alternate===null&&e(v,L),w=a(A,w,D),T===null?E=A:T.sibling=A,T=A,L=B}if(D===_.length)return t(v,L),Vi&&nu(v,D),E;if(L===null){for(;D<_.length;D++)L=p(v,_[D],C),L!==null&&(w=a(L,w,D),T===null?E=L:T.sibling=L,T=L);return Vi&&nu(v,D),E}for(L=r(v,L);D<_.length;D++)B=m(L,v,D,_[D],C),B!==null&&(i&&B.alternate!==null&&L.delete(B.key===null?D:B.key),w=a(B,w,D),T===null?E=B:T.sibling=B,T=B);return i&&L.forEach(function(k){return e(v,k)}),Vi&&nu(v,D),E}function b(v,w,_,C){var E=cd(_);if(typeof E!="function")throw Error(Ke(150));if(_=E.call(_),_==null)throw Error(Ke(151));for(var T=E=null,L=w,D=w=0,B=null,A=_.next();L!==null&&!A.done;D++,A=_.next()){L.index>D?(B=L,L=null):B=L.sibling;var k=d(v,L,A.value,C);if(k===null){L===null&&(L=B);break}i&&L&&k.alternate===null&&e(v,L),w=a(k,w,D),T===null?E=k:T.sibling=k,T=k,L=B}if(A.done)return t(v,L),Vi&&nu(v,D),E;if(L===null){for(;!A.done;D++,A=_.next())A=p(v,A.value,C),A!==null&&(w=a(A,w,D),T===null?E=A:T.sibling=A,T=A);return Vi&&nu(v,D),E}for(L=r(v,L);!A.done;D++,A=_.next())A=m(L,v,D,A.value,C),A!==null&&(i&&A.alternate!==null&&L.delete(A.key===null?D:A.key),w=a(A,w,D),T===null?E=A:T.sibling=A,T=A);return i&&L.forEach(function($){return e(v,$)}),Vi&&nu(v,D),E}function x(v,w,_,C){if(typeof _=="object"&&_!==null&&_.type===Ic&&_.key===null&&(_=_.props.children),typeof _=="object"&&_!==null){switch(_.$$typeof){case gg:e:{for(var E=_.key,T=w;T!==null;){if(T.key===E){if(E=_.type,E===Ic){if(T.tag===7){t(v,T.sibling),w=n(T,_.props.children),w.return=v,v=w;break e}}else if(T.elementType===E||typeof E=="object"&&E!==null&&E.$$typeof===ll&&JT(E)===T.type){t(v,T.sibling),w=n(T,_.props),w.ref=gd(v,T,_),w.return=v,v=w;break e}t(v,T);break}else e(v,T);T=T.sibling}_.type===Ic?(w=Du(_.props.children,v.mode,C,_.key),w.return=v,v=w):(C=X1(_.type,_.key,_.props,null,v.mode,C),C.ref=gd(v,w,_),C.return=v,v=C)}return o(v);case Ac:e:{for(T=_.key;w!==null;){if(w.key===T)if(w.tag===4&&w.stateNode.containerInfo===_.containerInfo&&w.stateNode.implementation===_.implementation){t(v,w.sibling),w=n(w,_.children||[]),w.return=v,v=w;break e}else{t(v,w);break}else e(v,w);w=w.sibling}w=z_(_,v.mode,C),w.return=v,v=w}return o(v);case ll:return T=_._init,x(v,w,T(_._payload),C)}if(Bd(_))return g(v,w,_,C);if(cd(_))return b(v,w,_,C);Tg(v,_)}return typeof _=="string"&&_!==""||typeof _=="number"?(_=""+_,w!==null&&w.tag===6?(t(v,w.sibling),w=n(w,_),w.return=v,v=w):(t(v,w),w=F_(_,v.mode,C),w.return=v,v=w),o(v)):t(v,w)}return x}var Cp=q8(!0),Z8=q8(!1),U0=Ul(null),V0=null,Oc=null,nC=null;function aC(){nC=Oc=V0=null}function oC(i){var e=U0.current;Fi(U0),i._currentValue=e}function Eb(i,e,t){for(;i!==null;){var r=i.alternate;if((i.childLanes&e)!==e?(i.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),i===t)break;i=i.return}}function ep(i,e){V0=i,nC=Oc=null,i=i.dependencies,i!==null&&i.firstContext!==null&&(i.lanes&e&&(Un=!0),i.firstContext=null)}function Oa(i){var e=i._currentValue;if(nC!==i)if(i={context:i,memoizedValue:e,next:null},Oc===null){if(V0===null)throw Error(Ke(308));Oc=i,V0.dependencies={lanes:0,firstContext:i}}else Oc=Oc.next=i;return e}var Mu=null;function sC(i){Mu===null?Mu=[i]:Mu.push(i)}function Y8(i,e,t,r){var n=e.interleaved;return n===null?(t.next=t,sC(e)):(t.next=n.next,n.next=t),e.interleaved=t,As(i,r)}function As(i,e){i.lanes|=e;var t=i.alternate;for(t!==null&&(t.lanes|=e),t=i,i=i.return;i!==null;)i.childLanes|=e,t=i.alternate,t!==null&&(t.childLanes|=e),t=i,i=i.return;return t.tag===3?t.stateNode:null}var ul=!1;function lC(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function J8(i,e){i=i.updateQueue,e.updateQueue===i&&(e.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,effects:i.effects})}function Cs(i,e){return{eventTime:i,lane:e,tag:0,payload:null,callback:null,next:null}}function Sl(i,e,t){var r=i.updateQueue;if(r===null)return null;if(r=r.shared,pi&2){var n=r.pending;return n===null?e.next=e:(e.next=n.next,n.next=e),r.pending=e,As(i,t)}return n=r.interleaved,n===null?(e.next=e,sC(r)):(e.next=n.next,n.next=e),r.interleaved=e,As(i,t)}function U1(i,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var r=e.lanes;r&=i.pendingLanes,t|=r,e.lanes=t,XM(i,t)}}function KT(i,e){var t=i.updateQueue,r=i.alternate;if(r!==null&&(r=r.updateQueue,t===r)){var n=null,a=null;if(t=t.firstBaseUpdate,t!==null){do{var o={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};a===null?n=a=o:a=a.next=o,t=t.next}while(t!==null);a===null?n=a=e:a=a.next=e}else n=a=e;t={baseState:r.baseState,firstBaseUpdate:n,lastBaseUpdate:a,shared:r.shared,effects:r.effects},i.updateQueue=t;return}i=t.lastBaseUpdate,i===null?t.firstBaseUpdate=e:i.next=e,t.lastBaseUpdate=e}function j0(i,e,t,r){var n=i.updateQueue;ul=!1;var a=n.firstBaseUpdate,o=n.lastBaseUpdate,s=n.shared.pending;if(s!==null){n.shared.pending=null;var l=s,u=l.next;l.next=null,o===null?a=u:o.next=u,o=l;var c=i.alternate;c!==null&&(c=c.updateQueue,s=c.lastBaseUpdate,s!==o&&(s===null?c.firstBaseUpdate=u:s.next=u,c.lastBaseUpdate=l))}if(a!==null){var p=n.baseState;o=0,c=u=l=null,s=a;do{var d=s.lane,m=s.eventTime;if((r&d)===d){c!==null&&(c=c.next={eventTime:m,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var g=i,b=s;switch(d=e,m=t,b.tag){case 1:if(g=b.payload,typeof g=="function"){p=g.call(m,p,d);break e}p=g;break e;case 3:g.flags=g.flags&-65537|128;case 0:if(g=b.payload,d=typeof g=="function"?g.call(m,p,d):g,d==null)break e;p=tr({},p,d);break e;case 2:ul=!0}}s.callback!==null&&s.lane!==0&&(i.flags|=64,d=n.effects,d===null?n.effects=[s]:d.push(s))}else m={eventTime:m,lane:d,tag:s.tag,payload:s.payload,callback:s.callback,next:null},c===null?(u=c=m,l=p):c=c.next=m,o|=d;if(s=s.next,s===null){if(s=n.shared.pending,s===null)break;d=s,s=d.next,d.next=null,n.lastBaseUpdate=d,n.shared.pending=null}}while(!0);if(c===null&&(l=p),n.baseState=l,n.firstBaseUpdate=u,n.lastBaseUpdate=c,e=n.shared.interleaved,e!==null){n=e;do o|=n.lane,n=n.next;while(n!==e)}else a===null&&(n.shared.lanes=0);Gu|=o,i.lanes=o,i.memoizedState=p}}function QT(i,e,t){if(i=e.effects,e.effects=null,i!==null)for(e=0;e<i.length;e++){var r=i[e],n=r.callback;if(n!==null){if(r.callback=null,r=t,typeof n!="function")throw Error(Ke(191,n));n.call(r)}}}var Fm={},No=Ul(Fm),om=Ul(Fm),sm=Ul(Fm);function Cu(i){if(i===Fm)throw Error(Ke(174));return i}function uC(i,e){switch(Ti(sm,e),Ti(om,i),Ti(No,Fm),i=e.nodeType,i){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:ob(null,"");break;default:i=i===8?e.parentNode:e,e=i.namespaceURI||null,i=i.tagName,e=ob(e,i)}Fi(No),Ti(No,e)}function Ep(){Fi(No),Fi(om),Fi(sm)}function K8(i){Cu(sm.current);var e=Cu(No.current),t=ob(e,i.type);e!==t&&(Ti(om,i),Ti(No,t))}function hC(i){om.current===i&&(Fi(No),Fi(om))}var Ji=Ul(0);function H0(i){for(var e=i;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===i)break;for(;e.sibling===null;){if(e.return===null||e.return===i)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var A_=[];function cC(){for(var i=0;i<A_.length;i++)A_[i]._workInProgressVersionPrimary=null;A_.length=0}var V1=Rs.ReactCurrentDispatcher,I_=Rs.ReactCurrentBatchConfig,Hu=0,er=null,kr=null,Ur=null,G0=!1,$f=!1,lm=0,Ore=0;function Kr(){throw Error(Ke(321))}function pC(i,e){if(e===null)return!1;for(var t=0;t<e.length&&t<i.length;t++)if(!yo(i[t],e[t]))return!1;return!0}function dC(i,e,t,r,n,a){if(Hu=a,er=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,V1.current=i===null||i.memoizedState===null?Vre:jre,i=t(r,n),$f){a=0;do{if($f=!1,lm=0,25<=a)throw Error(Ke(301));a+=1,Ur=kr=null,e.updateQueue=null,V1.current=Hre,i=t(r,n)}while($f)}if(V1.current=W0,e=kr!==null&&kr.next!==null,Hu=0,Ur=kr=er=null,G0=!1,e)throw Error(Ke(300));return i}function fC(){var i=lm!==0;return lm=0,i}function ko(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ur===null?er.memoizedState=Ur=i:Ur=Ur.next=i,Ur}function Na(){if(kr===null){var i=er.alternate;i=i!==null?i.memoizedState:null}else i=kr.next;var e=Ur===null?er.memoizedState:Ur.next;if(e!==null)Ur=e,kr=i;else{if(i===null)throw Error(Ke(310));kr=i,i={memoizedState:kr.memoizedState,baseState:kr.baseState,baseQueue:kr.baseQueue,queue:kr.queue,next:null},Ur===null?er.memoizedState=Ur=i:Ur=Ur.next=i}return Ur}function um(i,e){return typeof e=="function"?e(i):e}function L_(i){var e=Na(),t=e.queue;if(t===null)throw Error(Ke(311));t.lastRenderedReducer=i;var r=kr,n=r.baseQueue,a=t.pending;if(a!==null){if(n!==null){var o=n.next;n.next=a.next,a.next=o}r.baseQueue=n=a,t.pending=null}if(n!==null){a=n.next,r=r.baseState;var s=o=null,l=null,u=a;do{var c=u.lane;if((Hu&c)===c)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:i(r,u.action);else{var p={lane:c,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(s=l=p,o=r):l=l.next=p,er.lanes|=c,Gu|=c}u=u.next}while(u!==null&&u!==a);l===null?o=r:l.next=s,yo(r,e.memoizedState)||(Un=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,t.lastRenderedState=r}if(i=t.interleaved,i!==null){n=i;do a=n.lane,er.lanes|=a,Gu|=a,n=n.next;while(n!==i)}else n===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function D_(i){var e=Na(),t=e.queue;if(t===null)throw Error(Ke(311));t.lastRenderedReducer=i;var r=t.dispatch,n=t.pending,a=e.memoizedState;if(n!==null){t.pending=null;var o=n=n.next;do a=i(a,o.action),o=o.next;while(o!==n);yo(a,e.memoizedState)||(Un=!0),e.memoizedState=a,e.baseQueue===null&&(e.baseState=a),t.lastRenderedState=a}return[a,r]}function Q8(){}function e7(i,e){var t=er,r=Na(),n=e(),a=!yo(r.memoizedState,n);if(a&&(r.memoizedState=n,Un=!0),r=r.queue,mC(r7.bind(null,t,r,i),[i]),r.getSnapshot!==e||a||Ur!==null&&Ur.memoizedState.tag&1){if(t.flags|=2048,hm(9,i7.bind(null,t,r,n,e),void 0,null),Vr===null)throw Error(Ke(349));Hu&30||t7(t,e,n)}return n}function t7(i,e,t){i.flags|=16384,i={getSnapshot:e,value:t},e=er.updateQueue,e===null?(e={lastEffect:null,stores:null},er.updateQueue=e,e.stores=[i]):(t=e.stores,t===null?e.stores=[i]:t.push(i))}function i7(i,e,t,r){e.value=t,e.getSnapshot=r,n7(e)&&a7(i)}function r7(i,e,t){return t(function(){n7(e)&&a7(i)})}function n7(i){var e=i.getSnapshot;i=i.value;try{var t=e();return!yo(i,t)}catch{return!0}}function a7(i){var e=As(i,1);e!==null&&mo(e,i,1,-1)}function eP(i){var e=ko();return typeof i=="function"&&(i=i()),e.memoizedState=e.baseState=i,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:um,lastRenderedState:i},e.queue=i,i=i.dispatch=Ure.bind(null,er,i),[e.memoizedState,i]}function hm(i,e,t,r){return i={tag:i,create:e,destroy:t,deps:r,next:null},e=er.updateQueue,e===null?(e={lastEffect:null,stores:null},er.updateQueue=e,e.lastEffect=i.next=i):(t=e.lastEffect,t===null?e.lastEffect=i.next=i:(r=t.next,t.next=i,i.next=r,e.lastEffect=i)),i}function o7(){return Na().memoizedState}function j1(i,e,t,r){var n=ko();er.flags|=i,n.memoizedState=hm(1|e,t,void 0,r===void 0?null:r)}function Hv(i,e,t,r){var n=Na();r=r===void 0?null:r;var a=void 0;if(kr!==null){var o=kr.memoizedState;if(a=o.destroy,r!==null&&pC(r,o.deps)){n.memoizedState=hm(e,t,a,r);return}}er.flags|=i,n.memoizedState=hm(1|e,t,a,r)}function tP(i,e){return j1(8390656,8,i,e)}function mC(i,e){return Hv(2048,8,i,e)}function s7(i,e){return Hv(4,2,i,e)}function l7(i,e){return Hv(4,4,i,e)}function u7(i,e){if(typeof e=="function")return i=i(),e(i),function(){e(null)};if(e!=null)return i=i(),e.current=i,function(){e.current=null}}function h7(i,e,t){return t=t!=null?t.concat([i]):null,Hv(4,4,u7.bind(null,e,i),t)}function gC(){}function c7(i,e){var t=Na();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&pC(e,r[1])?r[0]:(t.memoizedState=[i,e],i)}function p7(i,e){var t=Na();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&pC(e,r[1])?r[0]:(i=i(),t.memoizedState=[i,e],i)}function d7(i,e,t){return Hu&21?(yo(t,e)||(t=v8(),er.lanes|=t,Gu|=t,i.baseState=!0),e):(i.baseState&&(i.baseState=!1,Un=!0),i.memoizedState=t)}function Nre(i,e){var t=_i;_i=t!==0&&4>t?t:4,i(!0);var r=I_.transition;I_.transition={};try{i(!1),e()}finally{_i=t,I_.transition=r}}function f7(){return Na().memoizedState}function $re(i,e,t){var r=Cl(i);if(t={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null},m7(i))g7(e,t);else if(t=Y8(i,e,t,r),t!==null){var n=Sn();mo(t,i,r,n),y7(t,e,r)}}function Ure(i,e,t){var r=Cl(i),n={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null};if(m7(i))g7(e,n);else{var a=i.alternate;if(i.lanes===0&&(a===null||a.lanes===0)&&(a=e.lastRenderedReducer,a!==null))try{var o=e.lastRenderedState,s=a(o,t);if(n.hasEagerState=!0,n.eagerState=s,yo(s,o)){var l=e.interleaved;l===null?(n.next=n,sC(e)):(n.next=l.next,l.next=n),e.interleaved=n;return}}catch{}finally{}t=Y8(i,e,n,r),t!==null&&(n=Sn(),mo(t,i,r,n),y7(t,e,r))}}function m7(i){var e=i.alternate;return i===er||e!==null&&e===er}function g7(i,e){$f=G0=!0;var t=i.pending;t===null?e.next=e:(e.next=t.next,t.next=e),i.pending=e}function y7(i,e,t){if(t&4194240){var r=e.lanes;r&=i.pendingLanes,t|=r,e.lanes=t,XM(i,t)}}var W0={readContext:Oa,useCallback:Kr,useContext:Kr,useEffect:Kr,useImperativeHandle:Kr,useInsertionEffect:Kr,useLayoutEffect:Kr,useMemo:Kr,useReducer:Kr,useRef:Kr,useState:Kr,useDebugValue:Kr,useDeferredValue:Kr,useTransition:Kr,useMutableSource:Kr,useSyncExternalStore:Kr,useId:Kr,unstable_isNewReconciler:!1},Vre={readContext:Oa,useCallback:function(i,e){return ko().memoizedState=[i,e===void 0?null:e],i},useContext:Oa,useEffect:tP,useImperativeHandle:function(i,e,t){return t=t!=null?t.concat([i]):null,j1(4194308,4,u7.bind(null,e,i),t)},useLayoutEffect:function(i,e){return j1(4194308,4,i,e)},useInsertionEffect:function(i,e){return j1(4,2,i,e)},useMemo:function(i,e){var t=ko();return e=e===void 0?null:e,i=i(),t.memoizedState=[i,e],i},useReducer:function(i,e,t){var r=ko();return e=t!==void 0?t(e):e,r.memoizedState=r.baseState=e,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:e},r.queue=i,i=i.dispatch=$re.bind(null,er,i),[r.memoizedState,i]},useRef:function(i){var e=ko();return i={current:i},e.memoizedState=i},useState:eP,useDebugValue:gC,useDeferredValue:function(i){return ko().memoizedState=i},useTransition:function(){var i=eP(!1),e=i[0];return i=Nre.bind(null,i[1]),ko().memoizedState=i,[e,i]},useMutableSource:function(){},useSyncExternalStore:function(i,e,t){var r=er,n=ko();if(Vi){if(t===void 0)throw Error(Ke(407));t=t()}else{if(t=e(),Vr===null)throw Error(Ke(349));Hu&30||t7(r,e,t)}n.memoizedState=t;var a={value:t,getSnapshot:e};return n.queue=a,tP(r7.bind(null,r,a,i),[i]),r.flags|=2048,hm(9,i7.bind(null,r,a,t,e),void 0,null),t},useId:function(){var i=ko(),e=Vr.identifierPrefix;if(Vi){var t=ws,r=bs;t=(r&~(1<<32-fo(r)-1)).toString(32)+t,e=":"+e+"R"+t,t=lm++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=Ore++,e=":"+e+"r"+t.toString(32)+":";return i.memoizedState=e},unstable_isNewReconciler:!1},jre={readContext:Oa,useCallback:c7,useContext:Oa,useEffect:mC,useImperativeHandle:h7,useInsertionEffect:s7,useLayoutEffect:l7,useMemo:p7,useReducer:L_,useRef:o7,useState:function(){return L_(um)},useDebugValue:gC,useDeferredValue:function(i){var e=Na();return d7(e,kr.memoizedState,i)},useTransition:function(){var i=L_(um)[0],e=Na().memoizedState;return[i,e]},useMutableSource:Q8,useSyncExternalStore:e7,useId:f7,unstable_isNewReconciler:!1},Hre={readContext:Oa,useCallback:c7,useContext:Oa,useEffect:mC,useImperativeHandle:h7,useInsertionEffect:s7,useLayoutEffect:l7,useMemo:p7,useReducer:D_,useRef:o7,useState:function(){return D_(um)},useDebugValue:gC,useDeferredValue:function(i){var e=Na();return kr===null?e.memoizedState=i:d7(e,kr.memoizedState,i)},useTransition:function(){var i=D_(um)[0],e=Na().memoizedState;return[i,e]},useMutableSource:Q8,useSyncExternalStore:e7,useId:f7,unstable_isNewReconciler:!1};function ao(i,e){if(i&&i.defaultProps){e=tr({},e),i=i.defaultProps;for(var t in i)e[t]===void 0&&(e[t]=i[t]);return e}return e}function Tb(i,e,t,r){e=i.memoizedState,t=t(r,e),t=t==null?e:tr({},e,t),i.memoizedState=t,i.lanes===0&&(i.updateQueue.baseState=t)}var Gv={isMounted:function(i){return(i=i._reactInternals)?ah(i)===i:!1},enqueueSetState:function(i,e,t){i=i._reactInternals;var r=Sn(),n=Cl(i),a=Cs(r,n);a.payload=e,t!=null&&(a.callback=t),e=Sl(i,a,n),e!==null&&(mo(e,i,n,r),U1(e,i,n))},enqueueReplaceState:function(i,e,t){i=i._reactInternals;var r=Sn(),n=Cl(i),a=Cs(r,n);a.tag=1,a.payload=e,t!=null&&(a.callback=t),e=Sl(i,a,n),e!==null&&(mo(e,i,n,r),U1(e,i,n))},enqueueForceUpdate:function(i,e){i=i._reactInternals;var t=Sn(),r=Cl(i),n=Cs(t,r);n.tag=2,e!=null&&(n.callback=e),e=Sl(i,n,r),e!==null&&(mo(e,i,r,t),U1(e,i,r))}};function iP(i,e,t,r,n,a,o){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(r,a,o):e.prototype&&e.prototype.isPureReactComponent?!im(t,r)||!im(n,a):!0}function v7(i,e,t){var r=!1,n=kl,a=e.contextType;return typeof a=="object"&&a!==null?a=Oa(a):(n=Hn(e)?Vu:un.current,r=e.contextTypes,a=(r=r!=null)?Sp(i,n):kl),e=new e(t,a),i.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Gv,i.stateNode=e,e._reactInternals=i,r&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=n,i.__reactInternalMemoizedMaskedChildContext=a),e}function rP(i,e,t,r){i=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,r),e.state!==i&&Gv.enqueueReplaceState(e,e.state,null)}function Pb(i,e,t,r){var n=i.stateNode;n.props=t,n.state=i.memoizedState,n.refs={},lC(i);var a=e.contextType;typeof a=="object"&&a!==null?n.context=Oa(a):(a=Hn(e)?Vu:un.current,n.context=Sp(i,a)),n.state=i.memoizedState,a=e.getDerivedStateFromProps,typeof a=="function"&&(Tb(i,e,a,t),n.state=i.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof n.getSnapshotBeforeUpdate=="function"||typeof n.UNSAFE_componentWillMount!="function"&&typeof n.componentWillMount!="function"||(e=n.state,typeof n.componentWillMount=="function"&&n.componentWillMount(),typeof n.UNSAFE_componentWillMount=="function"&&n.UNSAFE_componentWillMount(),e!==n.state&&Gv.enqueueReplaceState(n,n.state,null),j0(i,t,n,r),n.state=i.memoizedState),typeof n.componentDidMount=="function"&&(i.flags|=4194308)}function Tp(i,e){try{var t="",r=e;do t+=vie(r),r=r.return;while(r);var n=t}catch(a){n=`
Error generating stack: `+a.message+`
`+a.stack}return{value:i,source:e,stack:n,digest:null}}function k_(i,e,t){return{value:i,source:null,stack:t??null,digest:e??null}}function Ab(i,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var Gre=typeof WeakMap=="function"?WeakMap:Map;function x7(i,e,t){t=Cs(-1,t),t.tag=3,t.payload={element:null};var r=e.value;return t.callback=function(){q0||(q0=!0,Nb=r),Ab(i,e)},t}function _7(i,e,t){t=Cs(-1,t),t.tag=3;var r=i.type.getDerivedStateFromError;if(typeof r=="function"){var n=e.value;t.payload=function(){return r(n)},t.callback=function(){Ab(i,e)}}var a=i.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(t.callback=function(){Ab(i,e),typeof r!="function"&&(Ml===null?Ml=new Set([this]):Ml.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),t}function nP(i,e,t){var r=i.pingCache;if(r===null){r=i.pingCache=new Gre;var n=new Set;r.set(e,n)}else n=r.get(e),n===void 0&&(n=new Set,r.set(e,n));n.has(t)||(n.add(t),i=ane.bind(null,i,e,t),e.then(i,i))}function aP(i){do{var e;if((e=i.tag===13)&&(e=i.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return i;i=i.return}while(i!==null);return null}function oP(i,e,t,r,n){return i.mode&1?(i.flags|=65536,i.lanes=n,i):(i===e?i.flags|=65536:(i.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=Cs(-1,1),e.tag=2,Sl(t,e,1))),t.lanes|=1),i)}var Wre=Rs.ReactCurrentOwner,Un=!1;function bn(i,e,t,r){e.child=i===null?Z8(e,null,t,r):Cp(e,i.child,t,r)}function sP(i,e,t,r,n){t=t.render;var a=e.ref;return ep(e,n),r=dC(i,e,t,r,a,n),t=fC(),i!==null&&!Un?(e.updateQueue=i.updateQueue,e.flags&=-2053,i.lanes&=~n,Is(i,e,n)):(Vi&&t&&tC(e),e.flags|=1,bn(i,e,r,n),e.child)}function lP(i,e,t,r,n){if(i===null){var a=t.type;return typeof a=="function"&&!MC(a)&&a.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=a,b7(i,e,a,r,n)):(i=X1(t.type,null,r,e,e.mode,n),i.ref=e.ref,i.return=e,e.child=i)}if(a=i.child,!(i.lanes&n)){var o=a.memoizedProps;if(t=t.compare,t=t!==null?t:im,t(o,r)&&i.ref===e.ref)return Is(i,e,n)}return e.flags|=1,i=El(a,r),i.ref=e.ref,i.return=e,e.child=i}function b7(i,e,t,r,n){if(i!==null){var a=i.memoizedProps;if(im(a,r)&&i.ref===e.ref)if(Un=!1,e.pendingProps=r=a,(i.lanes&n)!==0)i.flags&131072&&(Un=!0);else return e.lanes=i.lanes,Is(i,e,n)}return Ib(i,e,t,r,n)}function w7(i,e,t){var r=e.pendingProps,n=r.children,a=i!==null?i.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ti($c,ia),ia|=t;else{if(!(t&1073741824))return i=a!==null?a.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:i,cachePool:null,transitions:null},e.updateQueue=null,Ti($c,ia),ia|=i,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=a!==null?a.baseLanes:t,Ti($c,ia),ia|=r}else a!==null?(r=a.baseLanes|t,e.memoizedState=null):r=t,Ti($c,ia),ia|=r;return bn(i,e,n,t),e.child}function S7(i,e){var t=e.ref;(i===null&&t!==null||i!==null&&i.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function Ib(i,e,t,r,n){var a=Hn(t)?Vu:un.current;return a=Sp(e,a),ep(e,n),t=dC(i,e,t,r,a,n),r=fC(),i!==null&&!Un?(e.updateQueue=i.updateQueue,e.flags&=-2053,i.lanes&=~n,Is(i,e,n)):(Vi&&r&&tC(e),e.flags|=1,bn(i,e,t,n),e.child)}function uP(i,e,t,r,n){if(Hn(t)){var a=!0;O0(e)}else a=!1;if(ep(e,n),e.stateNode===null)H1(i,e),v7(e,t,r),Pb(e,t,r,n),r=!0;else if(i===null){var o=e.stateNode,s=e.memoizedProps;o.props=s;var l=o.context,u=t.contextType;typeof u=="object"&&u!==null?u=Oa(u):(u=Hn(t)?Vu:un.current,u=Sp(e,u));var c=t.getDerivedStateFromProps,p=typeof c=="function"||typeof o.getSnapshotBeforeUpdate=="function";p||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(s!==r||l!==u)&&rP(e,o,r,u),ul=!1;var d=e.memoizedState;o.state=d,j0(e,r,o,n),l=e.memoizedState,s!==r||d!==l||jn.current||ul?(typeof c=="function"&&(Tb(e,t,c,r),l=e.memoizedState),(s=ul||iP(e,t,s,r,d,l,u))?(p||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=u,r=s):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,J8(i,e),s=e.memoizedProps,u=e.type===e.elementType?s:ao(e.type,s),o.props=u,p=e.pendingProps,d=o.context,l=t.contextType,typeof l=="object"&&l!==null?l=Oa(l):(l=Hn(t)?Vu:un.current,l=Sp(e,l));var m=t.getDerivedStateFromProps;(c=typeof m=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(s!==p||d!==l)&&rP(e,o,r,l),ul=!1,d=e.memoizedState,o.state=d,j0(e,r,o,n);var g=e.memoizedState;s!==p||d!==g||jn.current||ul?(typeof m=="function"&&(Tb(e,t,m,r),g=e.memoizedState),(u=ul||iP(e,t,u,r,d,g,l)||!1)?(c||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,g,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,g,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||s===i.memoizedProps&&d===i.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||s===i.memoizedProps&&d===i.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=g),o.props=r,o.state=g,o.context=l,r=u):(typeof o.componentDidUpdate!="function"||s===i.memoizedProps&&d===i.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||s===i.memoizedProps&&d===i.memoizedState||(e.flags|=1024),r=!1)}return Lb(i,e,t,r,a,n)}function Lb(i,e,t,r,n,a){S7(i,e);var o=(e.flags&128)!==0;if(!r&&!o)return n&&qT(e,t,!1),Is(i,e,a);r=e.stateNode,Wre.current=e;var s=o&&typeof t.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,i!==null&&o?(e.child=Cp(e,i.child,null,a),e.child=Cp(e,null,s,a)):bn(i,e,s,a),e.memoizedState=r.state,n&&qT(e,t,!0),e.child}function M7(i){var e=i.stateNode;e.pendingContext?XT(i,e.pendingContext,e.pendingContext!==e.context):e.context&&XT(i,e.context,!1),uC(i,e.containerInfo)}function hP(i,e,t,r,n){return Mp(),rC(n),e.flags|=256,bn(i,e,t,r),e.child}var Db={dehydrated:null,treeContext:null,retryLane:0};function kb(i){return{baseLanes:i,cachePool:null,transitions:null}}function C7(i,e,t){var r=e.pendingProps,n=Ji.current,a=!1,o=(e.flags&128)!==0,s;if((s=o)||(s=i!==null&&i.memoizedState===null?!1:(n&2)!==0),s?(a=!0,e.flags&=-129):(i===null||i.memoizedState!==null)&&(n|=1),Ti(Ji,n&1),i===null)return Cb(e),i=e.memoizedState,i!==null&&(i=i.dehydrated,i!==null)?(e.mode&1?i.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,i=r.fallback,a?(r=e.mode,a=e.child,o={mode:"hidden",children:o},!(r&1)&&a!==null?(a.childLanes=0,a.pendingProps=o):a=qv(o,r,0,null),i=Du(i,r,t,null),a.return=e,i.return=e,a.sibling=i,e.child=a,e.child.memoizedState=kb(t),e.memoizedState=Db,i):yC(e,o));if(n=i.memoizedState,n!==null&&(s=n.dehydrated,s!==null))return Xre(i,e,o,r,s,n,t);if(a){a=r.fallback,o=e.mode,n=i.child,s=n.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&e.child!==n?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=El(n,l),r.subtreeFlags=n.subtreeFlags&14680064),s!==null?a=El(s,a):(a=Du(a,o,t,null),a.flags|=2),a.return=e,r.return=e,r.sibling=a,e.child=r,r=a,a=e.child,o=i.child.memoizedState,o=o===null?kb(t):{baseLanes:o.baseLanes|t,cachePool:null,transitions:o.transitions},a.memoizedState=o,a.childLanes=i.childLanes&~t,e.memoizedState=Db,r}return a=i.child,i=a.sibling,r=El(a,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=t),r.return=e,r.sibling=null,i!==null&&(t=e.deletions,t===null?(e.deletions=[i],e.flags|=16):t.push(i)),e.child=r,e.memoizedState=null,r}function yC(i,e){return e=qv({mode:"visible",children:e},i.mode,0,null),e.return=i,i.child=e}function Pg(i,e,t,r){return r!==null&&rC(r),Cp(e,i.child,null,t),i=yC(e,e.pendingProps.children),i.flags|=2,e.memoizedState=null,i}function Xre(i,e,t,r,n,a,o){if(t)return e.flags&256?(e.flags&=-257,r=k_(Error(Ke(422))),Pg(i,e,o,r)):e.memoizedState!==null?(e.child=i.child,e.flags|=128,null):(a=r.fallback,n=e.mode,r=qv({mode:"visible",children:r.children},n,0,null),a=Du(a,n,o,null),a.flags|=2,r.return=e,a.return=e,r.sibling=a,e.child=r,e.mode&1&&Cp(e,i.child,null,o),e.child.memoizedState=kb(o),e.memoizedState=Db,a);if(!(e.mode&1))return Pg(i,e,o,null);if(n.data==="$!"){if(r=n.nextSibling&&n.nextSibling.dataset,r)var s=r.dgst;return r=s,a=Error(Ke(419)),r=k_(a,r,void 0),Pg(i,e,o,r)}if(s=(o&i.childLanes)!==0,Un||s){if(r=Vr,r!==null){switch(o&-o){case 4:n=2;break;case 16:n=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:n=32;break;case 536870912:n=268435456;break;default:n=0}n=n&(r.suspendedLanes|o)?0:n,n!==0&&n!==a.retryLane&&(a.retryLane=n,As(i,n),mo(r,i,n,-1))}return SC(),r=k_(Error(Ke(421))),Pg(i,e,o,r)}return n.data==="$?"?(e.flags|=128,e.child=i.child,e=one.bind(null,i),n._reactRetry=e,null):(i=a.treeContext,aa=wl(n.nextSibling),ua=e,Vi=!0,lo=null,i!==null&&(Ea[Ta++]=bs,Ea[Ta++]=ws,Ea[Ta++]=ju,bs=i.id,ws=i.overflow,ju=e),e=yC(e,r.children),e.flags|=4096,e)}function cP(i,e,t){i.lanes|=e;var r=i.alternate;r!==null&&(r.lanes|=e),Eb(i.return,e,t)}function R_(i,e,t,r,n){var a=i.memoizedState;a===null?i.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:t,tailMode:n}:(a.isBackwards=e,a.rendering=null,a.renderingStartTime=0,a.last=r,a.tail=t,a.tailMode=n)}function E7(i,e,t){var r=e.pendingProps,n=r.revealOrder,a=r.tail;if(bn(i,e,r.children,t),r=Ji.current,r&2)r=r&1|2,e.flags|=128;else{if(i!==null&&i.flags&128)e:for(i=e.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&cP(i,t,e);else if(i.tag===19)cP(i,t,e);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===e)break e;for(;i.sibling===null;){if(i.return===null||i.return===e)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}r&=1}if(Ti(Ji,r),!(e.mode&1))e.memoizedState=null;else switch(n){case"forwards":for(t=e.child,n=null;t!==null;)i=t.alternate,i!==null&&H0(i)===null&&(n=t),t=t.sibling;t=n,t===null?(n=e.child,e.child=null):(n=t.sibling,t.sibling=null),R_(e,!1,n,t,a);break;case"backwards":for(t=null,n=e.child,e.child=null;n!==null;){if(i=n.alternate,i!==null&&H0(i)===null){e.child=n;break}i=n.sibling,n.sibling=t,t=n,n=i}R_(e,!0,t,null,a);break;case"together":R_(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function H1(i,e){!(e.mode&1)&&i!==null&&(i.alternate=null,e.alternate=null,e.flags|=2)}function Is(i,e,t){if(i!==null&&(e.dependencies=i.dependencies),Gu|=e.lanes,!(t&e.childLanes))return null;if(i!==null&&e.child!==i.child)throw Error(Ke(153));if(e.child!==null){for(i=e.child,t=El(i,i.pendingProps),e.child=t,t.return=e;i.sibling!==null;)i=i.sibling,t=t.sibling=El(i,i.pendingProps),t.return=e;t.sibling=null}return e.child}function qre(i,e,t){switch(e.tag){case 3:M7(e),Mp();break;case 5:K8(e);break;case 1:Hn(e.type)&&O0(e);break;case 4:uC(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,n=e.memoizedProps.value;Ti(U0,r._currentValue),r._currentValue=n;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Ti(Ji,Ji.current&1),e.flags|=128,null):t&e.child.childLanes?C7(i,e,t):(Ti(Ji,Ji.current&1),i=Is(i,e,t),i!==null?i.sibling:null);Ti(Ji,Ji.current&1);break;case 19:if(r=(t&e.childLanes)!==0,i.flags&128){if(r)return E7(i,e,t);e.flags|=128}if(n=e.memoizedState,n!==null&&(n.rendering=null,n.tail=null,n.lastEffect=null),Ti(Ji,Ji.current),r)break;return null;case 22:case 23:return e.lanes=0,w7(i,e,t)}return Is(i,e,t)}var T7,Rb,P7,A7;T7=function(i,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)i.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};Rb=function(){};P7=function(i,e,t,r){var n=i.memoizedProps;if(n!==r){i=e.stateNode,Cu(No.current);var a=null;switch(t){case"input":n=ib(i,n),r=ib(i,r),a=[];break;case"select":n=tr({},n,{value:void 0}),r=tr({},r,{value:void 0}),a=[];break;case"textarea":n=ab(i,n),r=ab(i,r),a=[];break;default:typeof n.onClick!="function"&&typeof r.onClick=="function"&&(i.onclick=z0)}sb(t,r);var o;t=null;for(u in n)if(!r.hasOwnProperty(u)&&n.hasOwnProperty(u)&&n[u]!=null)if(u==="style"){var s=n[u];for(o in s)s.hasOwnProperty(o)&&(t||(t={}),t[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Zf.hasOwnProperty(u)?a||(a=[]):(a=a||[]).push(u,null));for(u in r){var l=r[u];if(s=n!=null?n[u]:void 0,r.hasOwnProperty(u)&&l!==s&&(l!=null||s!=null))if(u==="style")if(s){for(o in s)!s.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(t||(t={}),t[o]="");for(o in l)l.hasOwnProperty(o)&&s[o]!==l[o]&&(t||(t={}),t[o]=l[o])}else t||(a||(a=[]),a.push(u,t)),t=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,s=s?s.__html:void 0,l!=null&&s!==l&&(a=a||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(a=a||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Zf.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&Li("scroll",i),a||s===l||(a=[])):(a=a||[]).push(u,l))}t&&(a=a||[]).push("style",t);var u=a;(e.updateQueue=u)&&(e.flags|=4)}};A7=function(i,e,t,r){t!==r&&(e.flags|=4)};function yd(i,e){if(!Vi)switch(i.tailMode){case"hidden":e=i.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?i.tail=null:t.sibling=null;break;case"collapsed":t=i.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e||i.tail===null?i.tail=null:i.tail.sibling=null:r.sibling=null}}function Qr(i){var e=i.alternate!==null&&i.alternate.child===i.child,t=0,r=0;if(e)for(var n=i.child;n!==null;)t|=n.lanes|n.childLanes,r|=n.subtreeFlags&14680064,r|=n.flags&14680064,n.return=i,n=n.sibling;else for(n=i.child;n!==null;)t|=n.lanes|n.childLanes,r|=n.subtreeFlags,r|=n.flags,n.return=i,n=n.sibling;return i.subtreeFlags|=r,i.childLanes=t,e}function Zre(i,e,t){var r=e.pendingProps;switch(iC(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Qr(e),null;case 1:return Hn(e.type)&&B0(),Qr(e),null;case 3:return r=e.stateNode,Ep(),Fi(jn),Fi(un),cC(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(i===null||i.child===null)&&(Eg(e)?e.flags|=4:i===null||i.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,lo!==null&&(Vb(lo),lo=null))),Rb(i,e),Qr(e),null;case 5:hC(e);var n=Cu(sm.current);if(t=e.type,i!==null&&e.stateNode!=null)P7(i,e,t,r,n),i.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(Ke(166));return Qr(e),null}if(i=Cu(No.current),Eg(e)){r=e.stateNode,t=e.type;var a=e.memoizedProps;switch(r[zo]=e,r[am]=a,i=(e.mode&1)!==0,t){case"dialog":Li("cancel",r),Li("close",r);break;case"iframe":case"object":case"embed":Li("load",r);break;case"video":case"audio":for(n=0;n<Nd.length;n++)Li(Nd[n],r);break;case"source":Li("error",r);break;case"img":case"image":case"link":Li("error",r),Li("load",r);break;case"details":Li("toggle",r);break;case"input":_T(r,a),Li("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!a.multiple},Li("invalid",r);break;case"textarea":wT(r,a),Li("invalid",r)}sb(t,a),n=null;for(var o in a)if(a.hasOwnProperty(o)){var s=a[o];o==="children"?typeof s=="string"?r.textContent!==s&&(a.suppressHydrationWarning!==!0&&Cg(r.textContent,s,i),n=["children",s]):typeof s=="number"&&r.textContent!==""+s&&(a.suppressHydrationWarning!==!0&&Cg(r.textContent,s,i),n=["children",""+s]):Zf.hasOwnProperty(o)&&s!=null&&o==="onScroll"&&Li("scroll",r)}switch(t){case"input":yg(r),bT(r,a,!0);break;case"textarea":yg(r),ST(r);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(r.onclick=z0)}r=n,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=n.nodeType===9?n:n.ownerDocument,i==="http://www.w3.org/1999/xhtml"&&(i=r8(t)),i==="http://www.w3.org/1999/xhtml"?t==="script"?(i=o.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild)):typeof r.is=="string"?i=o.createElement(t,{is:r.is}):(i=o.createElement(t),t==="select"&&(o=i,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):i=o.createElementNS(i,t),i[zo]=e,i[am]=r,T7(i,e,!1,!1),e.stateNode=i;e:{switch(o=lb(t,r),t){case"dialog":Li("cancel",i),Li("close",i),n=r;break;case"iframe":case"object":case"embed":Li("load",i),n=r;break;case"video":case"audio":for(n=0;n<Nd.length;n++)Li(Nd[n],i);n=r;break;case"source":Li("error",i),n=r;break;case"img":case"image":case"link":Li("error",i),Li("load",i),n=r;break;case"details":Li("toggle",i),n=r;break;case"input":_T(i,r),n=ib(i,r),Li("invalid",i);break;case"option":n=r;break;case"select":i._wrapperState={wasMultiple:!!r.multiple},n=tr({},r,{value:void 0}),Li("invalid",i);break;case"textarea":wT(i,r),n=ab(i,r),Li("invalid",i);break;default:n=r}sb(t,n),s=n;for(a in s)if(s.hasOwnProperty(a)){var l=s[a];a==="style"?o8(i,l):a==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&n8(i,l)):a==="children"?typeof l=="string"?(t!=="textarea"||l!=="")&&Yf(i,l):typeof l=="number"&&Yf(i,""+l):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(Zf.hasOwnProperty(a)?l!=null&&a==="onScroll"&&Li("scroll",i):l!=null&&UM(i,a,l,o))}switch(t){case"input":yg(i),bT(i,r,!1);break;case"textarea":yg(i),ST(i);break;case"option":r.value!=null&&i.setAttribute("value",""+Dl(r.value));break;case"select":i.multiple=!!r.multiple,a=r.value,a!=null?Yc(i,!!r.multiple,a,!1):r.defaultValue!=null&&Yc(i,!!r.multiple,r.defaultValue,!0);break;default:typeof n.onClick=="function"&&(i.onclick=z0)}switch(t){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Qr(e),null;case 6:if(i&&e.stateNode!=null)A7(i,e,i.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(Ke(166));if(t=Cu(sm.current),Cu(No.current),Eg(e)){if(r=e.stateNode,t=e.memoizedProps,r[zo]=e,(a=r.nodeValue!==t)&&(i=ua,i!==null))switch(i.tag){case 3:Cg(r.nodeValue,t,(i.mode&1)!==0);break;case 5:i.memoizedProps.suppressHydrationWarning!==!0&&Cg(r.nodeValue,t,(i.mode&1)!==0)}a&&(e.flags|=4)}else r=(t.nodeType===9?t:t.ownerDocument).createTextNode(r),r[zo]=e,e.stateNode=r}return Qr(e),null;case 13:if(Fi(Ji),r=e.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(Vi&&aa!==null&&e.mode&1&&!(e.flags&128))X8(),Mp(),e.flags|=98560,a=!1;else if(a=Eg(e),r!==null&&r.dehydrated!==null){if(i===null){if(!a)throw Error(Ke(318));if(a=e.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(Ke(317));a[zo]=e}else Mp(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Qr(e),a=!1}else lo!==null&&(Vb(lo),lo=null),a=!0;if(!a)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(r=r!==null,r!==(i!==null&&i.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(i===null||Ji.current&1?zr===0&&(zr=3):SC())),e.updateQueue!==null&&(e.flags|=4),Qr(e),null);case 4:return Ep(),Rb(i,e),i===null&&rm(e.stateNode.containerInfo),Qr(e),null;case 10:return oC(e.type._context),Qr(e),null;case 17:return Hn(e.type)&&B0(),Qr(e),null;case 19:if(Fi(Ji),a=e.memoizedState,a===null)return Qr(e),null;if(r=(e.flags&128)!==0,o=a.rendering,o===null)if(r)yd(a,!1);else{if(zr!==0||i!==null&&i.flags&128)for(i=e.child;i!==null;){if(o=H0(i),o!==null){for(e.flags|=128,yd(a,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=t,t=e.child;t!==null;)a=t,i=r,a.flags&=14680066,o=a.alternate,o===null?(a.childLanes=0,a.lanes=i,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=o.childLanes,a.lanes=o.lanes,a.child=o.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=o.memoizedProps,a.memoizedState=o.memoizedState,a.updateQueue=o.updateQueue,a.type=o.type,i=o.dependencies,a.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),t=t.sibling;return Ti(Ji,Ji.current&1|2),e.child}i=i.sibling}a.tail!==null&&gr()>Pp&&(e.flags|=128,r=!0,yd(a,!1),e.lanes=4194304)}else{if(!r)if(i=H0(o),i!==null){if(e.flags|=128,r=!0,t=i.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),yd(a,!0),a.tail===null&&a.tailMode==="hidden"&&!o.alternate&&!Vi)return Qr(e),null}else 2*gr()-a.renderingStartTime>Pp&&t!==1073741824&&(e.flags|=128,r=!0,yd(a,!1),e.lanes=4194304);a.isBackwards?(o.sibling=e.child,e.child=o):(t=a.last,t!==null?t.sibling=o:e.child=o,a.last=o)}return a.tail!==null?(e=a.tail,a.rendering=e,a.tail=e.sibling,a.renderingStartTime=gr(),e.sibling=null,t=Ji.current,Ti(Ji,r?t&1|2:t&1),e):(Qr(e),null);case 22:case 23:return wC(),r=e.memoizedState!==null,i!==null&&i.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?ia&1073741824&&(Qr(e),e.subtreeFlags&6&&(e.flags|=8192)):Qr(e),null;case 24:return null;case 25:return null}throw Error(Ke(156,e.tag))}function Yre(i,e){switch(iC(e),e.tag){case 1:return Hn(e.type)&&B0(),i=e.flags,i&65536?(e.flags=i&-65537|128,e):null;case 3:return Ep(),Fi(jn),Fi(un),cC(),i=e.flags,i&65536&&!(i&128)?(e.flags=i&-65537|128,e):null;case 5:return hC(e),null;case 13:if(Fi(Ji),i=e.memoizedState,i!==null&&i.dehydrated!==null){if(e.alternate===null)throw Error(Ke(340));Mp()}return i=e.flags,i&65536?(e.flags=i&-65537|128,e):null;case 19:return Fi(Ji),null;case 4:return Ep(),null;case 10:return oC(e.type._context),null;case 22:case 23:return wC(),null;case 24:return null;default:return null}}var Ag=!1,on=!1,Jre=typeof WeakSet=="function"?WeakSet:Set,gt=null;function Nc(i,e){var t=i.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(r){ur(i,e,r)}else t.current=null}function Fb(i,e,t){try{t()}catch(r){ur(i,e,r)}}var pP=!1;function Kre(i,e){if(vb=k0,i=R8(),eC(i)){if("selectionStart"in i)var t={start:i.selectionStart,end:i.selectionEnd};else e:{t=(t=i.ownerDocument)&&t.defaultView||window;var r=t.getSelection&&t.getSelection();if(r&&r.rangeCount!==0){t=r.anchorNode;var n=r.anchorOffset,a=r.focusNode;r=r.focusOffset;try{t.nodeType,a.nodeType}catch{t=null;break e}var o=0,s=-1,l=-1,u=0,c=0,p=i,d=null;t:for(;;){for(var m;p!==t||n!==0&&p.nodeType!==3||(s=o+n),p!==a||r!==0&&p.nodeType!==3||(l=o+r),p.nodeType===3&&(o+=p.nodeValue.length),(m=p.firstChild)!==null;)d=p,p=m;for(;;){if(p===i)break t;if(d===t&&++u===n&&(s=o),d===a&&++c===r&&(l=o),(m=p.nextSibling)!==null)break;p=d,d=p.parentNode}p=m}t=s===-1||l===-1?null:{start:s,end:l}}else t=null}t=t||{start:0,end:0}}else t=null;for(xb={focusedElem:i,selectionRange:t},k0=!1,gt=e;gt!==null;)if(e=gt,i=e.child,(e.subtreeFlags&1028)!==0&&i!==null)i.return=e,gt=i;else for(;gt!==null;){e=gt;try{var g=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(g!==null){var b=g.memoizedProps,x=g.memoizedState,v=e.stateNode,w=v.getSnapshotBeforeUpdate(e.elementType===e.type?b:ao(e.type,b),x);v.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var _=e.stateNode.containerInfo;_.nodeType===1?_.textContent="":_.nodeType===9&&_.documentElement&&_.removeChild(_.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Ke(163))}}catch(C){ur(e,e.return,C)}if(i=e.sibling,i!==null){i.return=e.return,gt=i;break}gt=e.return}return g=pP,pP=!1,g}function Uf(i,e,t){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var n=r=r.next;do{if((n.tag&i)===i){var a=n.destroy;n.destroy=void 0,a!==void 0&&Fb(e,t,a)}n=n.next}while(n!==r)}}function Wv(i,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&i)===i){var r=t.create;t.destroy=r()}t=t.next}while(t!==e)}}function zb(i){var e=i.ref;if(e!==null){var t=i.stateNode;switch(i.tag){case 5:i=t;break;default:i=t}typeof e=="function"?e(i):e.current=i}}function I7(i){var e=i.alternate;e!==null&&(i.alternate=null,I7(e)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(e=i.stateNode,e!==null&&(delete e[zo],delete e[am],delete e[wb],delete e[Rre],delete e[Fre])),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}function L7(i){return i.tag===5||i.tag===3||i.tag===4}function dP(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||L7(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function Bb(i,e,t){var r=i.tag;if(r===5||r===6)i=i.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(i,e):t.insertBefore(i,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(i,t)):(e=t,e.appendChild(i)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=z0));else if(r!==4&&(i=i.child,i!==null))for(Bb(i,e,t),i=i.sibling;i!==null;)Bb(i,e,t),i=i.sibling}function Ob(i,e,t){var r=i.tag;if(r===5||r===6)i=i.stateNode,e?t.insertBefore(i,e):t.appendChild(i);else if(r!==4&&(i=i.child,i!==null))for(Ob(i,e,t),i=i.sibling;i!==null;)Ob(i,e,t),i=i.sibling}var Wr=null,so=!1;function Ns(i,e,t){for(t=t.child;t!==null;)D7(i,e,t),t=t.sibling}function D7(i,e,t){if(Oo&&typeof Oo.onCommitFiberUnmount=="function")try{Oo.onCommitFiberUnmount(Ov,t)}catch{}switch(t.tag){case 5:on||Nc(t,e);case 6:var r=Wr,n=so;Wr=null,Ns(i,e,t),Wr=r,so=n,Wr!==null&&(so?(i=Wr,t=t.stateNode,i.nodeType===8?i.parentNode.removeChild(t):i.removeChild(t)):Wr.removeChild(t.stateNode));break;case 18:Wr!==null&&(so?(i=Wr,t=t.stateNode,i.nodeType===8?T_(i.parentNode,t):i.nodeType===1&&T_(i,t),em(i)):T_(Wr,t.stateNode));break;case 4:r=Wr,n=so,Wr=t.stateNode.containerInfo,so=!0,Ns(i,e,t),Wr=r,so=n;break;case 0:case 11:case 14:case 15:if(!on&&(r=t.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){n=r=r.next;do{var a=n,o=a.destroy;a=a.tag,o!==void 0&&(a&2||a&4)&&Fb(t,e,o),n=n.next}while(n!==r)}Ns(i,e,t);break;case 1:if(!on&&(Nc(t,e),r=t.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=t.memoizedProps,r.state=t.memoizedState,r.componentWillUnmount()}catch(s){ur(t,e,s)}Ns(i,e,t);break;case 21:Ns(i,e,t);break;case 22:t.mode&1?(on=(r=on)||t.memoizedState!==null,Ns(i,e,t),on=r):Ns(i,e,t);break;default:Ns(i,e,t)}}function fP(i){var e=i.updateQueue;if(e!==null){i.updateQueue=null;var t=i.stateNode;t===null&&(t=i.stateNode=new Jre),e.forEach(function(r){var n=sne.bind(null,i,r);t.has(r)||(t.add(r),r.then(n,n))})}}function Xa(i,e){var t=e.deletions;if(t!==null)for(var r=0;r<t.length;r++){var n=t[r];try{var a=i,o=e,s=o;e:for(;s!==null;){switch(s.tag){case 5:Wr=s.stateNode,so=!1;break e;case 3:Wr=s.stateNode.containerInfo,so=!0;break e;case 4:Wr=s.stateNode.containerInfo,so=!0;break e}s=s.return}if(Wr===null)throw Error(Ke(160));D7(a,o,n),Wr=null,so=!1;var l=n.alternate;l!==null&&(l.return=null),n.return=null}catch(u){ur(n,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)k7(e,i),e=e.sibling}function k7(i,e){var t=i.alternate,r=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:if(Xa(e,i),Mo(i),r&4){try{Uf(3,i,i.return),Wv(3,i)}catch(b){ur(i,i.return,b)}try{Uf(5,i,i.return)}catch(b){ur(i,i.return,b)}}break;case 1:Xa(e,i),Mo(i),r&512&&t!==null&&Nc(t,t.return);break;case 5:if(Xa(e,i),Mo(i),r&512&&t!==null&&Nc(t,t.return),i.flags&32){var n=i.stateNode;try{Yf(n,"")}catch(b){ur(i,i.return,b)}}if(r&4&&(n=i.stateNode,n!=null)){var a=i.memoizedProps,o=t!==null?t.memoizedProps:a,s=i.type,l=i.updateQueue;if(i.updateQueue=null,l!==null)try{s==="input"&&a.type==="radio"&&a.name!=null&&t8(n,a),lb(s,o);var u=lb(s,a);for(o=0;o<l.length;o+=2){var c=l[o],p=l[o+1];c==="style"?o8(n,p):c==="dangerouslySetInnerHTML"?n8(n,p):c==="children"?Yf(n,p):UM(n,c,p,u)}switch(s){case"input":rb(n,a);break;case"textarea":i8(n,a);break;case"select":var d=n._wrapperState.wasMultiple;n._wrapperState.wasMultiple=!!a.multiple;var m=a.value;m!=null?Yc(n,!!a.multiple,m,!1):d!==!!a.multiple&&(a.defaultValue!=null?Yc(n,!!a.multiple,a.defaultValue,!0):Yc(n,!!a.multiple,a.multiple?[]:"",!1))}n[am]=a}catch(b){ur(i,i.return,b)}}break;case 6:if(Xa(e,i),Mo(i),r&4){if(i.stateNode===null)throw Error(Ke(162));n=i.stateNode,a=i.memoizedProps;try{n.nodeValue=a}catch(b){ur(i,i.return,b)}}break;case 3:if(Xa(e,i),Mo(i),r&4&&t!==null&&t.memoizedState.isDehydrated)try{em(e.containerInfo)}catch(b){ur(i,i.return,b)}break;case 4:Xa(e,i),Mo(i);break;case 13:Xa(e,i),Mo(i),n=i.child,n.flags&8192&&(a=n.memoizedState!==null,n.stateNode.isHidden=a,!a||n.alternate!==null&&n.alternate.memoizedState!==null||(_C=gr())),r&4&&fP(i);break;case 22:if(c=t!==null&&t.memoizedState!==null,i.mode&1?(on=(u=on)||c,Xa(e,i),on=u):Xa(e,i),Mo(i),r&8192){if(u=i.memoizedState!==null,(i.stateNode.isHidden=u)&&!c&&i.mode&1)for(gt=i,c=i.child;c!==null;){for(p=gt=c;gt!==null;){switch(d=gt,m=d.child,d.tag){case 0:case 11:case 14:case 15:Uf(4,d,d.return);break;case 1:Nc(d,d.return);var g=d.stateNode;if(typeof g.componentWillUnmount=="function"){r=d,t=d.return;try{e=r,g.props=e.memoizedProps,g.state=e.memoizedState,g.componentWillUnmount()}catch(b){ur(r,t,b)}}break;case 5:Nc(d,d.return);break;case 22:if(d.memoizedState!==null){gP(p);continue}}m!==null?(m.return=d,gt=m):gP(p)}c=c.sibling}e:for(c=null,p=i;;){if(p.tag===5){if(c===null){c=p;try{n=p.stateNode,u?(a=n.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(s=p.stateNode,l=p.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,s.style.display=a8("display",o))}catch(b){ur(i,i.return,b)}}}else if(p.tag===6){if(c===null)try{p.stateNode.nodeValue=u?"":p.memoizedProps}catch(b){ur(i,i.return,b)}}else if((p.tag!==22&&p.tag!==23||p.memoizedState===null||p===i)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===i)break e;for(;p.sibling===null;){if(p.return===null||p.return===i)break e;c===p&&(c=null),p=p.return}c===p&&(c=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:Xa(e,i),Mo(i),r&4&&fP(i);break;case 21:break;default:Xa(e,i),Mo(i)}}function Mo(i){var e=i.flags;if(e&2){try{e:{for(var t=i.return;t!==null;){if(L7(t)){var r=t;break e}t=t.return}throw Error(Ke(160))}switch(r.tag){case 5:var n=r.stateNode;r.flags&32&&(Yf(n,""),r.flags&=-33);var a=dP(i);Ob(i,a,n);break;case 3:case 4:var o=r.stateNode.containerInfo,s=dP(i);Bb(i,s,o);break;default:throw Error(Ke(161))}}catch(l){ur(i,i.return,l)}i.flags&=-3}e&4096&&(i.flags&=-4097)}function Qre(i,e,t){gt=i,R7(i)}function R7(i,e,t){for(var r=(i.mode&1)!==0;gt!==null;){var n=gt,a=n.child;if(n.tag===22&&r){var o=n.memoizedState!==null||Ag;if(!o){var s=n.alternate,l=s!==null&&s.memoizedState!==null||on;s=Ag;var u=on;if(Ag=o,(on=l)&&!u)for(gt=n;gt!==null;)o=gt,l=o.child,o.tag===22&&o.memoizedState!==null?yP(n):l!==null?(l.return=o,gt=l):yP(n);for(;a!==null;)gt=a,R7(a),a=a.sibling;gt=n,Ag=s,on=u}mP(i)}else n.subtreeFlags&8772&&a!==null?(a.return=n,gt=a):mP(i)}}function mP(i){for(;gt!==null;){var e=gt;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:on||Wv(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!on)if(t===null)r.componentDidMount();else{var n=e.elementType===e.type?t.memoizedProps:ao(e.type,t.memoizedProps);r.componentDidUpdate(n,t.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var a=e.updateQueue;a!==null&&QT(e,a,r);break;case 3:var o=e.updateQueue;if(o!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}QT(e,o,t)}break;case 5:var s=e.stateNode;if(t===null&&e.flags&4){t=s;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&t.focus();break;case"img":l.src&&(t.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var c=u.memoizedState;if(c!==null){var p=c.dehydrated;p!==null&&em(p)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Ke(163))}on||e.flags&512&&zb(e)}catch(d){ur(e,e.return,d)}}if(e===i){gt=null;break}if(t=e.sibling,t!==null){t.return=e.return,gt=t;break}gt=e.return}}function gP(i){for(;gt!==null;){var e=gt;if(e===i){gt=null;break}var t=e.sibling;if(t!==null){t.return=e.return,gt=t;break}gt=e.return}}function yP(i){for(;gt!==null;){var e=gt;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{Wv(4,e)}catch(l){ur(e,t,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var n=e.return;try{r.componentDidMount()}catch(l){ur(e,n,l)}}var a=e.return;try{zb(e)}catch(l){ur(e,a,l)}break;case 5:var o=e.return;try{zb(e)}catch(l){ur(e,o,l)}}}catch(l){ur(e,e.return,l)}if(e===i){gt=null;break}var s=e.sibling;if(s!==null){s.return=e.return,gt=s;break}gt=e.return}}var ene=Math.ceil,X0=Rs.ReactCurrentDispatcher,vC=Rs.ReactCurrentOwner,Ba=Rs.ReactCurrentBatchConfig,pi=0,Vr=null,Er=null,Zr=0,ia=0,$c=Ul(0),zr=0,cm=null,Gu=0,Xv=0,xC=0,Vf=null,Bn=null,_C=0,Pp=1/0,ms=null,q0=!1,Nb=null,Ml=null,Ig=!1,fl=null,Z0=0,jf=0,$b=null,G1=-1,W1=0;function Sn(){return pi&6?gr():G1!==-1?G1:G1=gr()}function Cl(i){return i.mode&1?pi&2&&Zr!==0?Zr&-Zr:Bre.transition!==null?(W1===0&&(W1=v8()),W1):(i=_i,i!==0||(i=window.event,i=i===void 0?16:C8(i.type)),i):1}function mo(i,e,t,r){if(50<jf)throw jf=0,$b=null,Error(Ke(185));Dm(i,t,r),(!(pi&2)||i!==Vr)&&(i===Vr&&(!(pi&2)&&(Xv|=t),zr===4&&cl(i,Zr)),Gn(i,r),t===1&&pi===0&&!(e.mode&1)&&(Pp=gr()+500,jv&&Vl()))}function Gn(i,e){var t=i.callbackNode;Bie(i,e);var r=D0(i,i===Vr?Zr:0);if(r===0)t!==null&&ET(t),i.callbackNode=null,i.callbackPriority=0;else if(e=r&-r,i.callbackPriority!==e){if(t!=null&&ET(t),e===1)i.tag===0?zre(vP.bind(null,i)):H8(vP.bind(null,i)),Dre(function(){!(pi&6)&&Vl()}),t=null;else{switch(x8(r)){case 1:t=WM;break;case 4:t=g8;break;case 16:t=L0;break;case 536870912:t=y8;break;default:t=L0}t=V7(t,F7.bind(null,i))}i.callbackPriority=e,i.callbackNode=t}}function F7(i,e){if(G1=-1,W1=0,pi&6)throw Error(Ke(327));var t=i.callbackNode;if(tp()&&i.callbackNode!==t)return null;var r=D0(i,i===Vr?Zr:0);if(r===0)return null;if(r&30||r&i.expiredLanes||e)e=Y0(i,r);else{e=r;var n=pi;pi|=2;var a=B7();(Vr!==i||Zr!==e)&&(ms=null,Pp=gr()+500,Lu(i,e));do try{rne();break}catch(s){z7(i,s)}while(!0);aC(),X0.current=a,pi=n,Er!==null?e=0:(Vr=null,Zr=0,e=zr)}if(e!==0){if(e===2&&(n=db(i),n!==0&&(r=n,e=Ub(i,n))),e===1)throw t=cm,Lu(i,0),cl(i,r),Gn(i,gr()),t;if(e===6)cl(i,r);else{if(n=i.current.alternate,!(r&30)&&!tne(n)&&(e=Y0(i,r),e===2&&(a=db(i),a!==0&&(r=a,e=Ub(i,a))),e===1))throw t=cm,Lu(i,0),cl(i,r),Gn(i,gr()),t;switch(i.finishedWork=n,i.finishedLanes=r,e){case 0:case 1:throw Error(Ke(345));case 2:au(i,Bn,ms);break;case 3:if(cl(i,r),(r&130023424)===r&&(e=_C+500-gr(),10<e)){if(D0(i,0)!==0)break;if(n=i.suspendedLanes,(n&r)!==r){Sn(),i.pingedLanes|=i.suspendedLanes&n;break}i.timeoutHandle=bb(au.bind(null,i,Bn,ms),e);break}au(i,Bn,ms);break;case 4:if(cl(i,r),(r&4194240)===r)break;for(e=i.eventTimes,n=-1;0<r;){var o=31-fo(r);a=1<<o,o=e[o],o>n&&(n=o),r&=~a}if(r=n,r=gr()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*ene(r/1960))-r,10<r){i.timeoutHandle=bb(au.bind(null,i,Bn,ms),r);break}au(i,Bn,ms);break;case 5:au(i,Bn,ms);break;default:throw Error(Ke(329))}}}return Gn(i,gr()),i.callbackNode===t?F7.bind(null,i):null}function Ub(i,e){var t=Vf;return i.current.memoizedState.isDehydrated&&(Lu(i,e).flags|=256),i=Y0(i,e),i!==2&&(e=Bn,Bn=t,e!==null&&Vb(e)),i}function Vb(i){Bn===null?Bn=i:Bn.push.apply(Bn,i)}function tne(i){for(var e=i;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var r=0;r<t.length;r++){var n=t[r],a=n.getSnapshot;n=n.value;try{if(!yo(a(),n))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===i)break;for(;e.sibling===null;){if(e.return===null||e.return===i)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function cl(i,e){for(e&=~xC,e&=~Xv,i.suspendedLanes|=e,i.pingedLanes&=~e,i=i.expirationTimes;0<e;){var t=31-fo(e),r=1<<t;i[t]=-1,e&=~r}}function vP(i){if(pi&6)throw Error(Ke(327));tp();var e=D0(i,0);if(!(e&1))return Gn(i,gr()),null;var t=Y0(i,e);if(i.tag!==0&&t===2){var r=db(i);r!==0&&(e=r,t=Ub(i,r))}if(t===1)throw t=cm,Lu(i,0),cl(i,e),Gn(i,gr()),t;if(t===6)throw Error(Ke(345));return i.finishedWork=i.current.alternate,i.finishedLanes=e,au(i,Bn,ms),Gn(i,gr()),null}function bC(i,e){var t=pi;pi|=1;try{return i(e)}finally{pi=t,pi===0&&(Pp=gr()+500,jv&&Vl())}}function Wu(i){fl!==null&&fl.tag===0&&!(pi&6)&&tp();var e=pi;pi|=1;var t=Ba.transition,r=_i;try{if(Ba.transition=null,_i=1,i)return i()}finally{_i=r,Ba.transition=t,pi=e,!(pi&6)&&Vl()}}function wC(){ia=$c.current,Fi($c)}function Lu(i,e){i.finishedWork=null,i.finishedLanes=0;var t=i.timeoutHandle;if(t!==-1&&(i.timeoutHandle=-1,Lre(t)),Er!==null)for(t=Er.return;t!==null;){var r=t;switch(iC(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&B0();break;case 3:Ep(),Fi(jn),Fi(un),cC();break;case 5:hC(r);break;case 4:Ep();break;case 13:Fi(Ji);break;case 19:Fi(Ji);break;case 10:oC(r.type._context);break;case 22:case 23:wC()}t=t.return}if(Vr=i,Er=i=El(i.current,null),Zr=ia=e,zr=0,cm=null,xC=Xv=Gu=0,Bn=Vf=null,Mu!==null){for(e=0;e<Mu.length;e++)if(t=Mu[e],r=t.interleaved,r!==null){t.interleaved=null;var n=r.next,a=t.pending;if(a!==null){var o=a.next;a.next=n,r.next=o}t.pending=r}Mu=null}return i}function z7(i,e){do{var t=Er;try{if(aC(),V1.current=W0,G0){for(var r=er.memoizedState;r!==null;){var n=r.queue;n!==null&&(n.pending=null),r=r.next}G0=!1}if(Hu=0,Ur=kr=er=null,$f=!1,lm=0,vC.current=null,t===null||t.return===null){zr=1,cm=e,Er=null;break}e:{var a=i,o=t.return,s=t,l=e;if(e=Zr,s.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,c=s,p=c.tag;if(!(c.mode&1)&&(p===0||p===11||p===15)){var d=c.alternate;d?(c.updateQueue=d.updateQueue,c.memoizedState=d.memoizedState,c.lanes=d.lanes):(c.updateQueue=null,c.memoizedState=null)}var m=aP(o);if(m!==null){m.flags&=-257,oP(m,o,s,a,e),m.mode&1&&nP(a,u,e),e=m,l=u;var g=e.updateQueue;if(g===null){var b=new Set;b.add(l),e.updateQueue=b}else g.add(l);break e}else{if(!(e&1)){nP(a,u,e),SC();break e}l=Error(Ke(426))}}else if(Vi&&s.mode&1){var x=aP(o);if(x!==null){!(x.flags&65536)&&(x.flags|=256),oP(x,o,s,a,e),rC(Tp(l,s));break e}}a=l=Tp(l,s),zr!==4&&(zr=2),Vf===null?Vf=[a]:Vf.push(a),a=o;do{switch(a.tag){case 3:a.flags|=65536,e&=-e,a.lanes|=e;var v=x7(a,l,e);KT(a,v);break e;case 1:s=l;var w=a.type,_=a.stateNode;if(!(a.flags&128)&&(typeof w.getDerivedStateFromError=="function"||_!==null&&typeof _.componentDidCatch=="function"&&(Ml===null||!Ml.has(_)))){a.flags|=65536,e&=-e,a.lanes|=e;var C=_7(a,s,e);KT(a,C);break e}}a=a.return}while(a!==null)}N7(t)}catch(E){e=E,Er===t&&t!==null&&(Er=t=t.return);continue}break}while(!0)}function B7(){var i=X0.current;return X0.current=W0,i===null?W0:i}function SC(){(zr===0||zr===3||zr===2)&&(zr=4),Vr===null||!(Gu&268435455)&&!(Xv&268435455)||cl(Vr,Zr)}function Y0(i,e){var t=pi;pi|=2;var r=B7();(Vr!==i||Zr!==e)&&(ms=null,Lu(i,e));do try{ine();break}catch(n){z7(i,n)}while(!0);if(aC(),pi=t,X0.current=r,Er!==null)throw Error(Ke(261));return Vr=null,Zr=0,zr}function ine(){for(;Er!==null;)O7(Er)}function rne(){for(;Er!==null&&!Pie();)O7(Er)}function O7(i){var e=U7(i.alternate,i,ia);i.memoizedProps=i.pendingProps,e===null?N7(i):Er=e,vC.current=null}function N7(i){var e=i;do{var t=e.alternate;if(i=e.return,e.flags&32768){if(t=Yre(t,e),t!==null){t.flags&=32767,Er=t;return}if(i!==null)i.flags|=32768,i.subtreeFlags=0,i.deletions=null;else{zr=6,Er=null;return}}else if(t=Zre(t,e,ia),t!==null){Er=t;return}if(e=e.sibling,e!==null){Er=e;return}Er=e=i}while(e!==null);zr===0&&(zr=5)}function au(i,e,t){var r=_i,n=Ba.transition;try{Ba.transition=null,_i=1,nne(i,e,t,r)}finally{Ba.transition=n,_i=r}return null}function nne(i,e,t,r){do tp();while(fl!==null);if(pi&6)throw Error(Ke(327));t=i.finishedWork;var n=i.finishedLanes;if(t===null)return null;if(i.finishedWork=null,i.finishedLanes=0,t===i.current)throw Error(Ke(177));i.callbackNode=null,i.callbackPriority=0;var a=t.lanes|t.childLanes;if(Oie(i,a),i===Vr&&(Er=Vr=null,Zr=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||Ig||(Ig=!0,V7(L0,function(){return tp(),null})),a=(t.flags&15990)!==0,t.subtreeFlags&15990||a){a=Ba.transition,Ba.transition=null;var o=_i;_i=1;var s=pi;pi|=4,vC.current=null,Kre(i,t),k7(t,i),Mre(xb),k0=!!vb,xb=vb=null,i.current=t,Qre(t),Aie(),pi=s,_i=o,Ba.transition=a}else i.current=t;if(Ig&&(Ig=!1,fl=i,Z0=n),a=i.pendingLanes,a===0&&(Ml=null),Die(t.stateNode),Gn(i,gr()),e!==null)for(r=i.onRecoverableError,t=0;t<e.length;t++)n=e[t],r(n.value,{componentStack:n.stack,digest:n.digest});if(q0)throw q0=!1,i=Nb,Nb=null,i;return Z0&1&&i.tag!==0&&tp(),a=i.pendingLanes,a&1?i===$b?jf++:(jf=0,$b=i):jf=0,Vl(),null}function tp(){if(fl!==null){var i=x8(Z0),e=Ba.transition,t=_i;try{if(Ba.transition=null,_i=16>i?16:i,fl===null)var r=!1;else{if(i=fl,fl=null,Z0=0,pi&6)throw Error(Ke(331));var n=pi;for(pi|=4,gt=i.current;gt!==null;){var a=gt,o=a.child;if(gt.flags&16){var s=a.deletions;if(s!==null){for(var l=0;l<s.length;l++){var u=s[l];for(gt=u;gt!==null;){var c=gt;switch(c.tag){case 0:case 11:case 15:Uf(8,c,a)}var p=c.child;if(p!==null)p.return=c,gt=p;else for(;gt!==null;){c=gt;var d=c.sibling,m=c.return;if(I7(c),c===u){gt=null;break}if(d!==null){d.return=m,gt=d;break}gt=m}}}var g=a.alternate;if(g!==null){var b=g.child;if(b!==null){g.child=null;do{var x=b.sibling;b.sibling=null,b=x}while(b!==null)}}gt=a}}if(a.subtreeFlags&2064&&o!==null)o.return=a,gt=o;else e:for(;gt!==null;){if(a=gt,a.flags&2048)switch(a.tag){case 0:case 11:case 15:Uf(9,a,a.return)}var v=a.sibling;if(v!==null){v.return=a.return,gt=v;break e}gt=a.return}}var w=i.current;for(gt=w;gt!==null;){o=gt;var _=o.child;if(o.subtreeFlags&2064&&_!==null)_.return=o,gt=_;else e:for(o=w;gt!==null;){if(s=gt,s.flags&2048)try{switch(s.tag){case 0:case 11:case 15:Wv(9,s)}}catch(E){ur(s,s.return,E)}if(s===o){gt=null;break e}var C=s.sibling;if(C!==null){C.return=s.return,gt=C;break e}gt=s.return}}if(pi=n,Vl(),Oo&&typeof Oo.onPostCommitFiberRoot=="function")try{Oo.onPostCommitFiberRoot(Ov,i)}catch{}r=!0}return r}finally{_i=t,Ba.transition=e}}return!1}function xP(i,e,t){e=Tp(t,e),e=x7(i,e,1),i=Sl(i,e,1),e=Sn(),i!==null&&(Dm(i,1,e),Gn(i,e))}function ur(i,e,t){if(i.tag===3)xP(i,i,t);else for(;e!==null;){if(e.tag===3){xP(e,i,t);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Ml===null||!Ml.has(r))){i=Tp(t,i),i=_7(e,i,1),e=Sl(e,i,1),i=Sn(),e!==null&&(Dm(e,1,i),Gn(e,i));break}}e=e.return}}function ane(i,e,t){var r=i.pingCache;r!==null&&r.delete(e),e=Sn(),i.pingedLanes|=i.suspendedLanes&t,Vr===i&&(Zr&t)===t&&(zr===4||zr===3&&(Zr&130023424)===Zr&&500>gr()-_C?Lu(i,0):xC|=t),Gn(i,e)}function $7(i,e){e===0&&(i.mode&1?(e=_g,_g<<=1,!(_g&130023424)&&(_g=4194304)):e=1);var t=Sn();i=As(i,e),i!==null&&(Dm(i,e,t),Gn(i,t))}function one(i){var e=i.memoizedState,t=0;e!==null&&(t=e.retryLane),$7(i,t)}function sne(i,e){var t=0;switch(i.tag){case 13:var r=i.stateNode,n=i.memoizedState;n!==null&&(t=n.retryLane);break;case 19:r=i.stateNode;break;default:throw Error(Ke(314))}r!==null&&r.delete(e),$7(i,t)}var U7;U7=function(i,e,t){if(i!==null)if(i.memoizedProps!==e.pendingProps||jn.current)Un=!0;else{if(!(i.lanes&t)&&!(e.flags&128))return Un=!1,qre(i,e,t);Un=!!(i.flags&131072)}else Un=!1,Vi&&e.flags&1048576&&G8(e,$0,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;H1(i,e),i=e.pendingProps;var n=Sp(e,un.current);ep(e,t),n=dC(null,e,r,i,n,t);var a=fC();return e.flags|=1,typeof n=="object"&&n!==null&&typeof n.render=="function"&&n.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Hn(r)?(a=!0,O0(e)):a=!1,e.memoizedState=n.state!==null&&n.state!==void 0?n.state:null,lC(e),n.updater=Gv,e.stateNode=n,n._reactInternals=e,Pb(e,r,i,t),e=Lb(null,e,r,!0,a,t)):(e.tag=0,Vi&&a&&tC(e),bn(null,e,n,t),e=e.child),e;case 16:r=e.elementType;e:{switch(H1(i,e),i=e.pendingProps,n=r._init,r=n(r._payload),e.type=r,n=e.tag=une(r),i=ao(r,i),n){case 0:e=Ib(null,e,r,i,t);break e;case 1:e=uP(null,e,r,i,t);break e;case 11:e=sP(null,e,r,i,t);break e;case 14:e=lP(null,e,r,ao(r.type,i),t);break e}throw Error(Ke(306,r,""))}return e;case 0:return r=e.type,n=e.pendingProps,n=e.elementType===r?n:ao(r,n),Ib(i,e,r,n,t);case 1:return r=e.type,n=e.pendingProps,n=e.elementType===r?n:ao(r,n),uP(i,e,r,n,t);case 3:e:{if(M7(e),i===null)throw Error(Ke(387));r=e.pendingProps,a=e.memoizedState,n=a.element,J8(i,e),j0(e,r,null,t);var o=e.memoizedState;if(r=o.element,a.isDehydrated)if(a={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=a,e.memoizedState=a,e.flags&256){n=Tp(Error(Ke(423)),e),e=hP(i,e,r,t,n);break e}else if(r!==n){n=Tp(Error(Ke(424)),e),e=hP(i,e,r,t,n);break e}else for(aa=wl(e.stateNode.containerInfo.firstChild),ua=e,Vi=!0,lo=null,t=Z8(e,null,r,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(Mp(),r===n){e=Is(i,e,t);break e}bn(i,e,r,t)}e=e.child}return e;case 5:return K8(e),i===null&&Cb(e),r=e.type,n=e.pendingProps,a=i!==null?i.memoizedProps:null,o=n.children,_b(r,n)?o=null:a!==null&&_b(r,a)&&(e.flags|=32),S7(i,e),bn(i,e,o,t),e.child;case 6:return i===null&&Cb(e),null;case 13:return C7(i,e,t);case 4:return uC(e,e.stateNode.containerInfo),r=e.pendingProps,i===null?e.child=Cp(e,null,r,t):bn(i,e,r,t),e.child;case 11:return r=e.type,n=e.pendingProps,n=e.elementType===r?n:ao(r,n),sP(i,e,r,n,t);case 7:return bn(i,e,e.pendingProps,t),e.child;case 8:return bn(i,e,e.pendingProps.children,t),e.child;case 12:return bn(i,e,e.pendingProps.children,t),e.child;case 10:e:{if(r=e.type._context,n=e.pendingProps,a=e.memoizedProps,o=n.value,Ti(U0,r._currentValue),r._currentValue=o,a!==null)if(yo(a.value,o)){if(a.children===n.children&&!jn.current){e=Is(i,e,t);break e}}else for(a=e.child,a!==null&&(a.return=e);a!==null;){var s=a.dependencies;if(s!==null){o=a.child;for(var l=s.firstContext;l!==null;){if(l.context===r){if(a.tag===1){l=Cs(-1,t&-t),l.tag=2;var u=a.updateQueue;if(u!==null){u=u.shared;var c=u.pending;c===null?l.next=l:(l.next=c.next,c.next=l),u.pending=l}}a.lanes|=t,l=a.alternate,l!==null&&(l.lanes|=t),Eb(a.return,t,e),s.lanes|=t;break}l=l.next}}else if(a.tag===10)o=a.type===e.type?null:a.child;else if(a.tag===18){if(o=a.return,o===null)throw Error(Ke(341));o.lanes|=t,s=o.alternate,s!==null&&(s.lanes|=t),Eb(o,t,e),o=a.sibling}else o=a.child;if(o!==null)o.return=a;else for(o=a;o!==null;){if(o===e){o=null;break}if(a=o.sibling,a!==null){a.return=o.return,o=a;break}o=o.return}a=o}bn(i,e,n.children,t),e=e.child}return e;case 9:return n=e.type,r=e.pendingProps.children,ep(e,t),n=Oa(n),r=r(n),e.flags|=1,bn(i,e,r,t),e.child;case 14:return r=e.type,n=ao(r,e.pendingProps),n=ao(r.type,n),lP(i,e,r,n,t);case 15:return b7(i,e,e.type,e.pendingProps,t);case 17:return r=e.type,n=e.pendingProps,n=e.elementType===r?n:ao(r,n),H1(i,e),e.tag=1,Hn(r)?(i=!0,O0(e)):i=!1,ep(e,t),v7(e,r,n),Pb(e,r,n,t),Lb(null,e,r,!0,i,t);case 19:return E7(i,e,t);case 22:return w7(i,e,t)}throw Error(Ke(156,e.tag))};function V7(i,e){return m8(i,e)}function lne(i,e,t,r){this.tag=i,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ra(i,e,t,r){return new lne(i,e,t,r)}function MC(i){return i=i.prototype,!(!i||!i.isReactComponent)}function une(i){if(typeof i=="function")return MC(i)?1:0;if(i!=null){if(i=i.$$typeof,i===jM)return 11;if(i===HM)return 14}return 2}function El(i,e){var t=i.alternate;return t===null?(t=Ra(i.tag,e,i.key,i.mode),t.elementType=i.elementType,t.type=i.type,t.stateNode=i.stateNode,t.alternate=i,i.alternate=t):(t.pendingProps=e,t.type=i.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=i.flags&14680064,t.childLanes=i.childLanes,t.lanes=i.lanes,t.child=i.child,t.memoizedProps=i.memoizedProps,t.memoizedState=i.memoizedState,t.updateQueue=i.updateQueue,e=i.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=i.sibling,t.index=i.index,t.ref=i.ref,t}function X1(i,e,t,r,n,a){var o=2;if(r=i,typeof i=="function")MC(i)&&(o=1);else if(typeof i=="string")o=5;else e:switch(i){case Ic:return Du(t.children,n,a,e);case VM:o=8,n|=8;break;case K2:return i=Ra(12,t,e,n|2),i.elementType=K2,i.lanes=a,i;case Q2:return i=Ra(13,t,e,n),i.elementType=Q2,i.lanes=a,i;case eb:return i=Ra(19,t,e,n),i.elementType=eb,i.lanes=a,i;case KI:return qv(t,n,a,e);default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case YI:o=10;break e;case JI:o=9;break e;case jM:o=11;break e;case HM:o=14;break e;case ll:o=16,r=null;break e}throw Error(Ke(130,i==null?i:typeof i,""))}return e=Ra(o,t,e,n),e.elementType=i,e.type=r,e.lanes=a,e}function Du(i,e,t,r){return i=Ra(7,i,r,e),i.lanes=t,i}function qv(i,e,t,r){return i=Ra(22,i,r,e),i.elementType=KI,i.lanes=t,i.stateNode={isHidden:!1},i}function F_(i,e,t){return i=Ra(6,i,null,e),i.lanes=t,i}function z_(i,e,t){return e=Ra(4,i.children!==null?i.children:[],i.key,e),e.lanes=t,e.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},e}function hne(i,e,t,r,n){this.tag=e,this.containerInfo=i,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=g_(0),this.expirationTimes=g_(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=g_(0),this.identifierPrefix=r,this.onRecoverableError=n,this.mutableSourceEagerHydrationData=null}function CC(i,e,t,r,n,a,o,s,l){return i=new hne(i,e,t,s,l),e===1?(e=1,a===!0&&(e|=8)):e=0,a=Ra(3,null,null,e),i.current=a,a.stateNode=i,a.memoizedState={element:r,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},lC(a),i}function cne(i,e,t){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ac,key:r==null?null:""+r,children:i,containerInfo:e,implementation:t}}function j7(i){if(!i)return kl;i=i._reactInternals;e:{if(ah(i)!==i||i.tag!==1)throw Error(Ke(170));var e=i;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Hn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Ke(171))}if(i.tag===1){var t=i.type;if(Hn(t))return j8(i,t,e)}return e}function H7(i,e,t,r,n,a,o,s,l){return i=CC(t,r,!0,i,n,a,o,s,l),i.context=j7(null),t=i.current,r=Sn(),n=Cl(t),a=Cs(r,n),a.callback=e??null,Sl(t,a,n),i.current.lanes=n,Dm(i,n,r),Gn(i,r),i}function Zv(i,e,t,r){var n=e.current,a=Sn(),o=Cl(n);return t=j7(t),e.context===null?e.context=t:e.pendingContext=t,e=Cs(a,o),e.payload={element:i},r=r===void 0?null:r,r!==null&&(e.callback=r),i=Sl(n,e,o),i!==null&&(mo(i,n,o,a),U1(i,n,o)),o}function J0(i){if(i=i.current,!i.child)return null;switch(i.child.tag){case 5:return i.child.stateNode;default:return i.child.stateNode}}function _P(i,e){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var t=i.retryLane;i.retryLane=t!==0&&t<e?t:e}}function EC(i,e){_P(i,e),(i=i.alternate)&&_P(i,e)}function pne(){return null}var G7=typeof reportError=="function"?reportError:function(i){console.error(i)};function TC(i){this._internalRoot=i}Yv.prototype.render=TC.prototype.render=function(i){var e=this._internalRoot;if(e===null)throw Error(Ke(409));Zv(i,e,null,null)};Yv.prototype.unmount=TC.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var e=i.containerInfo;Wu(function(){Zv(null,i,null,null)}),e[Ps]=null}};function Yv(i){this._internalRoot=i}Yv.prototype.unstable_scheduleHydration=function(i){if(i){var e=w8();i={blockedOn:null,target:i,priority:e};for(var t=0;t<hl.length&&e!==0&&e<hl[t].priority;t++);hl.splice(t,0,i),t===0&&M8(i)}};function PC(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function Jv(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11&&(i.nodeType!==8||i.nodeValue!==" react-mount-point-unstable "))}function bP(){}function dne(i,e,t,r,n){if(n){if(typeof r=="function"){var a=r;r=function(){var u=J0(o);a.call(u)}}var o=H7(e,r,i,0,null,!1,!1,"",bP);return i._reactRootContainer=o,i[Ps]=o.current,rm(i.nodeType===8?i.parentNode:i),Wu(),o}for(;n=i.lastChild;)i.removeChild(n);if(typeof r=="function"){var s=r;r=function(){var u=J0(l);s.call(u)}}var l=CC(i,0,!1,null,null,!1,!1,"",bP);return i._reactRootContainer=l,i[Ps]=l.current,rm(i.nodeType===8?i.parentNode:i),Wu(function(){Zv(e,l,t,r)}),l}function Kv(i,e,t,r,n){var a=t._reactRootContainer;if(a){var o=a;if(typeof n=="function"){var s=n;n=function(){var l=J0(o);s.call(l)}}Zv(e,o,i,n)}else o=dne(t,e,i,n,r);return J0(o)}_8=function(i){switch(i.tag){case 3:var e=i.stateNode;if(e.current.memoizedState.isDehydrated){var t=Od(e.pendingLanes);t!==0&&(XM(e,t|1),Gn(e,gr()),!(pi&6)&&(Pp=gr()+500,Vl()))}break;case 13:Wu(function(){var r=As(i,1);if(r!==null){var n=Sn();mo(r,i,1,n)}}),EC(i,1)}};qM=function(i){if(i.tag===13){var e=As(i,134217728);if(e!==null){var t=Sn();mo(e,i,134217728,t)}EC(i,134217728)}};b8=function(i){if(i.tag===13){var e=Cl(i),t=As(i,e);if(t!==null){var r=Sn();mo(t,i,e,r)}EC(i,e)}};w8=function(){return _i};S8=function(i,e){var t=_i;try{return _i=i,e()}finally{_i=t}};hb=function(i,e,t){switch(e){case"input":if(rb(i,t),e=t.name,t.type==="radio"&&e!=null){for(t=i;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var r=t[e];if(r!==i&&r.form===i.form){var n=Vv(r);if(!n)throw Error(Ke(90));e8(r),rb(r,n)}}}break;case"textarea":i8(i,t);break;case"select":e=t.value,e!=null&&Yc(i,!!t.multiple,e,!1)}};u8=bC;h8=Wu;var fne={usingClientEntryPoint:!1,Events:[Rm,Rc,Vv,s8,l8,bC]},vd={findFiberByHostInstance:Su,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},mne={bundleType:vd.bundleType,version:vd.version,rendererPackageName:vd.rendererPackageName,rendererConfig:vd.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Rs.ReactCurrentDispatcher,findHostInstanceByFiber:function(i){return i=d8(i),i===null?null:i.stateNode},findFiberByHostInstance:vd.findFiberByHostInstance||pne,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Lg=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Lg.isDisabled&&Lg.supportsFiber)try{Ov=Lg.inject(mne),Oo=Lg}catch{}}da.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=fne;da.createPortal=function(i,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!PC(e))throw Error(Ke(200));return cne(i,e,null,t)};da.createRoot=function(i,e){if(!PC(i))throw Error(Ke(299));var t=!1,r="",n=G7;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(n=e.onRecoverableError)),e=CC(i,1,!1,null,null,t,!1,r,n),i[Ps]=e.current,rm(i.nodeType===8?i.parentNode:i),new TC(e)};da.findDOMNode=function(i){if(i==null)return null;if(i.nodeType===1)return i;var e=i._reactInternals;if(e===void 0)throw typeof i.render=="function"?Error(Ke(188)):(i=Object.keys(i).join(","),Error(Ke(268,i)));return i=d8(e),i=i===null?null:i.stateNode,i};da.flushSync=function(i){return Wu(i)};da.hydrate=function(i,e,t){if(!Jv(e))throw Error(Ke(200));return Kv(null,i,e,!0,t)};da.hydrateRoot=function(i,e,t){if(!PC(i))throw Error(Ke(405));var r=t!=null&&t.hydratedSources||null,n=!1,a="",o=G7;if(t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(a=t.identifierPrefix),t.onRecoverableError!==void 0&&(o=t.onRecoverableError)),e=H7(e,null,i,1,t??null,n,!1,a,o),i[Ps]=e.current,rm(i),r)for(i=0;i<r.length;i++)t=r[i],n=t._getVersion,n=n(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,n]:e.mutableSourceEagerHydrationData.push(t,n);return new Yv(e)};da.render=function(i,e,t){if(!Jv(e))throw Error(Ke(200));return Kv(null,i,e,!1,t)};da.unmountComponentAtNode=function(i){if(!Jv(i))throw Error(Ke(40));return i._reactRootContainer?(Wu(function(){Kv(null,null,i,!1,function(){i._reactRootContainer=null,i[Ps]=null})}),!0):!1};da.unstable_batchedUpdates=bC;da.unstable_renderSubtreeIntoContainer=function(i,e,t,r){if(!Jv(t))throw Error(Ke(200));if(i==null||i._reactInternals===void 0)throw Error(Ke(38));return Kv(i,e,t,!1,r)};da.version="18.3.1-next-f1338f8080-20240426";function W7(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(W7)}catch(i){console.error(i)}}W7(),WI.exports=da;var X7=WI.exports,q7,wP=X7;q7=wP.createRoot,wP.hydrateRoot;const gne="modulepreload",yne=function(i){return"/MappedIn-API/"+i},SP={},zm=function(e,t,r){let n=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),s=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));n=Promise.allSettled(t.map(l=>{if(l=yne(l),l in SP)return;SP[l]=!0;const u=l.endsWith(".css"),c=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${c}`))return;const p=document.createElement("link");if(p.rel=u?"stylesheet":gne,u||(p.as="script"),p.crossOrigin="",p.href=l,s&&p.setAttribute("nonce",s),document.head.appendChild(p),u)return new Promise((d,m)=>{p.addEventListener("load",d),p.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${l}`)))})}))}function a(o){const s=new Event("vite:preloadError",{cancelable:!0});if(s.payload=o,window.dispatchEvent(s),!s.defaultPrevented)throw o}return n.then(o=>{for(const s of o||[])s.status==="rejected"&&a(s.reason);return e().catch(a)})};var vne=Object.create,Bm=Object.defineProperty,xne=Object.getOwnPropertyDescriptor,_ne=Object.getOwnPropertyNames,bne=Object.getPrototypeOf,wne=Object.prototype.hasOwnProperty,Sne=(i,e,t)=>e in i?Bm(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,h=(i,e)=>Bm(i,"name",{value:e,configurable:!0}),Mne=(i,e)=>()=>(i&&(e=i(i=0)),e),Qe=(i,e)=>()=>(e||i((e={exports:{}}).exports,e),e.exports),oh=(i,e)=>{for(var t in e)Bm(i,t,{get:e[t],enumerable:!0})},Cne=(i,e,t,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of _ne(e))!wne.call(i,n)&&n!==t&&Bm(i,n,{get:()=>e[n],enumerable:!(r=xne(e,n))||r.enumerable});return i},It=(i,e,t)=>(t=i!=null?vne(bne(i)):{},Cne(e||!i||!i.__esModule?Bm(t,"default",{value:i,enumerable:!0}):t,i)),ie=(i,e,t)=>(Sne(i,typeof e!="symbol"?e+"":e,t),t),AC=(i,e,t)=>{if(!e.has(i))throw TypeError("Cannot "+t)},M=(i,e,t)=>(AC(i,e,"read from private field"),t?t.call(i):e.get(i)),fe=(i,e,t)=>{if(e.has(i))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(i):e.set(i,t)},ke=(i,e,t,r)=>(AC(i,e,"write to private field"),e.set(i,t),t),Ot=(i,e,t)=>(AC(i,e,"access private method"),t),hr,R=Mne(()=>{hr={env:{NODE_ENV:"production",npm_package_version:"6.0.1-beta.3"}}}),di=Qe((i,e)=>{R(),e.exports=t;function t(r,n){this.x=r,this.y=n}h(t,"Point"),t.prototype={clone:function(){return new t(this.x,this.y)},add:function(r){return this.clone()._add(r)},sub:function(r){return this.clone()._sub(r)},multByPoint:function(r){return this.clone()._multByPoint(r)},divByPoint:function(r){return this.clone()._divByPoint(r)},mult:function(r){return this.clone()._mult(r)},div:function(r){return this.clone()._div(r)},rotate:function(r){return this.clone()._rotate(r)},rotateAround:function(r,n){return this.clone()._rotateAround(r,n)},matMult:function(r){return this.clone()._matMult(r)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(r){return this.x===r.x&&this.y===r.y},dist:function(r){return Math.sqrt(this.distSqr(r))},distSqr:function(r){var n=r.x-this.x,a=r.y-this.y;return n*n+a*a},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(r){return Math.atan2(this.y-r.y,this.x-r.x)},angleWith:function(r){return this.angleWithSep(r.x,r.y)},angleWithSep:function(r,n){return Math.atan2(this.x*n-this.y*r,this.x*r+this.y*n)},_matMult:function(r){var n=r[0]*this.x+r[1]*this.y,a=r[2]*this.x+r[3]*this.y;return this.x=n,this.y=a,this},_add:function(r){return this.x+=r.x,this.y+=r.y,this},_sub:function(r){return this.x-=r.x,this.y-=r.y,this},_mult:function(r){return this.x*=r,this.y*=r,this},_div:function(r){return this.x/=r,this.y/=r,this},_multByPoint:function(r){return this.x*=r.x,this.y*=r.y,this},_divByPoint:function(r){return this.x/=r.x,this.y/=r.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var r=this.y;return this.y=this.x,this.x=-r,this},_rotate:function(r){var n=Math.cos(r),a=Math.sin(r),o=n*this.x-a*this.y,s=a*this.x+n*this.y;return this.x=o,this.y=s,this},_rotateAround:function(r,n){var a=Math.cos(r),o=Math.sin(r),s=n.x+a*(this.x-n.x)-o*(this.y-n.y),l=n.y+o*(this.x-n.x)+a*(this.y-n.y);return this.x=s,this.y=l,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},t.convert=function(r){return r instanceof t?r:Array.isArray(r)?new t(r[0],r[1]):r}}),Ene=Qe((i,e)=>{R(),e.exports=t;function t(r,n,a,o){this.cx=3*r,this.bx=3*(a-r)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*n,this.by=3*(o-n)-this.cy,this.ay=1-this.cy-this.by,this.p1x=r,this.p1y=n,this.p2x=a,this.p2y=o}h(t,"UnitBezier"),t.prototype={sampleCurveX:function(r){return((this.ax*r+this.bx)*r+this.cx)*r},sampleCurveY:function(r){return((this.ay*r+this.by)*r+this.cy)*r},sampleCurveDerivativeX:function(r){return(3*this.ax*r+2*this.bx)*r+this.cx},solveCurveX:function(r,n){if(n===void 0&&(n=1e-6),r<0)return 0;if(r>1)return 1;for(var a=r,o=0;o<8;o++){var s=this.sampleCurveX(a)-r;if(Math.abs(s)<n)return a;var l=this.sampleCurveDerivativeX(a);if(Math.abs(l)<1e-6)break;a=a-s/l}var u=0,c=1;for(a=r,o=0;o<20&&(s=this.sampleCurveX(a),!(Math.abs(s-r)<n));o++)r>s?u=a:c=a,a=(c-u)*.5+u;return a},solve:function(r,n){return this.sampleCurveY(this.solveCurveX(r,n))}}}),Tne=Qe((i,e)=>{R();function t(r,n){var a,o,s,l,u,c,p,d;for(a=r.length&3,o=r.length-a,s=n,u=3432918353,c=461845907,d=0;d<o;)p=r.charCodeAt(d)&255|(r.charCodeAt(++d)&255)<<8|(r.charCodeAt(++d)&255)<<16|(r.charCodeAt(++d)&255)<<24,++d,p=(p&65535)*u+(((p>>>16)*u&65535)<<16)&4294967295,p=p<<15|p>>>17,p=(p&65535)*c+(((p>>>16)*c&65535)<<16)&4294967295,s^=p,s=s<<13|s>>>19,l=(s&65535)*5+(((s>>>16)*5&65535)<<16)&4294967295,s=(l&65535)+27492+(((l>>>16)+58964&65535)<<16);switch(p=0,a){case 3:p^=(r.charCodeAt(d+2)&255)<<16;case 2:p^=(r.charCodeAt(d+1)&255)<<8;case 1:p^=r.charCodeAt(d)&255,p=(p&65535)*u+(((p>>>16)*u&65535)<<16)&4294967295,p=p<<15|p>>>17,p=(p&65535)*c+(((p>>>16)*c&65535)<<16)&4294967295,s^=p}return s^=r.length,s^=s>>>16,s=(s&65535)*2246822507+(((s>>>16)*2246822507&65535)<<16)&4294967295,s^=s>>>13,s=(s&65535)*3266489909+(((s>>>16)*3266489909&65535)<<16)&4294967295,s^=s>>>16,s>>>0}h(t,"murmurhash3_32_gc"),typeof e<"u"&&(e.exports=t)}),Pne=Qe((i,e)=>{R();function t(r,n){for(var a=r.length,o=n^a,s=0,l;a>=4;)l=r.charCodeAt(s)&255|(r.charCodeAt(++s)&255)<<8|(r.charCodeAt(++s)&255)<<16|(r.charCodeAt(++s)&255)<<24,l=(l&65535)*1540483477+(((l>>>16)*1540483477&65535)<<16),l^=l>>>24,l=(l&65535)*1540483477+(((l>>>16)*1540483477&65535)<<16),o=(o&65535)*1540483477+(((o>>>16)*1540483477&65535)<<16)^l,a-=4,++s;switch(a){case 3:o^=(r.charCodeAt(s+2)&255)<<16;case 2:o^=(r.charCodeAt(s+1)&255)<<8;case 1:o^=r.charCodeAt(s)&255,o=(o&65535)*1540483477+(((o>>>16)*1540483477&65535)<<16)}return o^=o>>>13,o=(o&65535)*1540483477+(((o>>>16)*1540483477&65535)<<16),o^=o>>>15,o>>>0}h(t,"murmurhash2_32_gc"),typeof e!==void 0&&(e.exports=t)}),Z7=Qe((i,e)=>{R();var t=Tne(),r=Pne();e.exports=t,e.exports.murmur3=t,e.exports.murmur2=r}),Y7=Qe((i,e)=>{R(),e.exports=t,e.exports.default=t;function t(z,V,j){j=j||2;var q=V&&V.length,ee=q?V[0]*j:z.length,ae=r(z,0,ee,j,!0),N=[];if(!ae||ae.next===ae.prev)return N;var J,Y,oe,xe,ge,Te,me;if(q&&(ae=c(z,V,ae,j)),z.length>80*j){J=oe=z[0],Y=xe=z[1];for(var Q=j;Q<ee;Q+=j)ge=z[Q],Te=z[Q+1],ge<J&&(J=ge),Te<Y&&(Y=Te),ge>oe&&(oe=ge),Te>xe&&(xe=Te);me=Math.max(oe-J,xe-Y),me=me!==0?32767/me:0}return a(ae,N,j,J,Y,me,0),N}h(t,"earcut");function r(z,V,j,q,ee){var ae,N;if(ee===K(z,V,j,q)>0)for(ae=V;ae<j;ae+=q)N=P(ae,z[ae],z[ae+1],N);else for(ae=j-q;ae>=V;ae-=q)N=P(ae,z[ae],z[ae+1],N);return N&&T(N,N.next)&&(U(N),N=N.next),N}h(r,"linkedList");function n(z,V){if(!z)return z;V||(V=z);var j=z,q;do if(q=!1,!j.steiner&&(T(j,j.next)||E(j.prev,j,j.next)===0)){if(U(j),j=V=j.prev,j===j.next)break;q=!0}else j=j.next;while(q||j!==V);return V}h(n,"filterPoints");function a(z,V,j,q,ee,ae,N){if(z){!N&&ae&&b(z,q,ee,ae);for(var J=z,Y,oe;z.prev!==z.next;){if(Y=z.prev,oe=z.next,ae?s(z,q,ee,ae):o(z)){V.push(Y.i/j|0),V.push(z.i/j|0),V.push(oe.i/j|0),U(z),z=oe.next,J=oe.next;continue}if(z=oe,z===J){N?N===1?(z=l(n(z),V,j),a(z,V,j,q,ee,ae,2)):N===2&&u(z,V,j,q,ee,ae):a(n(z),V,j,q,ee,ae,1);break}}}}h(a,"earcutLinked");function o(z){var V=z.prev,j=z,q=z.next;if(E(V,j,q)>=0)return!1;for(var ee=V.x,ae=j.x,N=q.x,J=V.y,Y=j.y,oe=q.y,xe=ee<ae?ee<N?ee:N:ae<N?ae:N,ge=J<Y?J<oe?J:oe:Y<oe?Y:oe,Te=ee>ae?ee>N?ee:N:ae>N?ae:N,me=J>Y?J>oe?J:oe:Y>oe?Y:oe,Q=q.next;Q!==V;){if(Q.x>=xe&&Q.x<=Te&&Q.y>=ge&&Q.y<=me&&_(ee,J,ae,Y,N,oe,Q.x,Q.y)&&E(Q.prev,Q,Q.next)>=0)return!1;Q=Q.next}return!0}h(o,"isEar");function s(z,V,j,q){var ee=z.prev,ae=z,N=z.next;if(E(ee,ae,N)>=0)return!1;for(var J=ee.x,Y=ae.x,oe=N.x,xe=ee.y,ge=ae.y,Te=N.y,me=J<Y?J<oe?J:oe:Y<oe?Y:oe,Q=xe<ge?xe<Te?xe:Te:ge<Te?ge:Te,Me=J>Y?J>oe?J:oe:Y>oe?Y:oe,ve=xe>ge?xe>Te?xe:Te:ge>Te?ge:Te,Ie=v(me,Q,V,j,q),De=v(Me,ve,V,j,q),we=z.prevZ,Fe=z.nextZ;we&&we.z>=Ie&&Fe&&Fe.z<=De;){if(we.x>=me&&we.x<=Me&&we.y>=Q&&we.y<=ve&&we!==ee&&we!==N&&_(J,xe,Y,ge,oe,Te,we.x,we.y)&&E(we.prev,we,we.next)>=0||(we=we.prevZ,Fe.x>=me&&Fe.x<=Me&&Fe.y>=Q&&Fe.y<=ve&&Fe!==ee&&Fe!==N&&_(J,xe,Y,ge,oe,Te,Fe.x,Fe.y)&&E(Fe.prev,Fe,Fe.next)>=0))return!1;Fe=Fe.nextZ}for(;we&&we.z>=Ie;){if(we.x>=me&&we.x<=Me&&we.y>=Q&&we.y<=ve&&we!==ee&&we!==N&&_(J,xe,Y,ge,oe,Te,we.x,we.y)&&E(we.prev,we,we.next)>=0)return!1;we=we.prevZ}for(;Fe&&Fe.z<=De;){if(Fe.x>=me&&Fe.x<=Me&&Fe.y>=Q&&Fe.y<=ve&&Fe!==ee&&Fe!==N&&_(J,xe,Y,ge,oe,Te,Fe.x,Fe.y)&&E(Fe.prev,Fe,Fe.next)>=0)return!1;Fe=Fe.nextZ}return!0}h(s,"isEarHashed");function l(z,V,j){var q=z;do{var ee=q.prev,ae=q.next.next;!T(ee,ae)&&L(ee,q,q.next,ae)&&k(ee,ae)&&k(ae,ee)&&(V.push(ee.i/j|0),V.push(q.i/j|0),V.push(ae.i/j|0),U(q),U(q.next),q=z=ae),q=q.next}while(q!==z);return n(q)}h(l,"cureLocalIntersections");function u(z,V,j,q,ee,ae){var N=z;do{for(var J=N.next.next;J!==N.prev;){if(N.i!==J.i&&C(N,J)){var Y=O(N,J);N=n(N,N.next),Y=n(Y,Y.next),a(N,V,j,q,ee,ae,0),a(Y,V,j,q,ee,ae,0);return}J=J.next}N=N.next}while(N!==z)}h(u,"splitEarcut");function c(z,V,j,q){var ee=[],ae,N,J,Y,oe;for(ae=0,N=V.length;ae<N;ae++)J=V[ae]*q,Y=ae<N-1?V[ae+1]*q:z.length,oe=r(z,J,Y,q,!1),oe===oe.next&&(oe.steiner=!0),ee.push(w(oe));for(ee.sort(p),ae=0;ae<ee.length;ae++)j=d(ee[ae],j);return j}h(c,"eliminateHoles");function p(z,V){return z.x-V.x}h(p,"compareX");function d(z,V){var j=m(z,V);if(!j)return V;var q=O(j,z);return n(q,q.next),n(j,j.next)}h(d,"eliminateHole");function m(z,V){var j=V,q=z.x,ee=z.y,ae=-1/0,N;do{if(ee<=j.y&&ee>=j.next.y&&j.next.y!==j.y){var J=j.x+(ee-j.y)*(j.next.x-j.x)/(j.next.y-j.y);if(J<=q&&J>ae&&(ae=J,N=j.x<j.next.x?j:j.next,J===q))return N}j=j.next}while(j!==V);if(!N)return null;var Y=N,oe=N.x,xe=N.y,ge=1/0,Te;j=N;do q>=j.x&&j.x>=oe&&q!==j.x&&_(ee<xe?q:ae,ee,oe,xe,ee<xe?ae:q,ee,j.x,j.y)&&(Te=Math.abs(ee-j.y)/(q-j.x),k(j,z)&&(Te<ge||Te===ge&&(j.x>N.x||j.x===N.x&&g(N,j)))&&(N=j,ge=Te)),j=j.next;while(j!==Y);return N}h(m,"findHoleBridge");function g(z,V){return E(z.prev,z,V.prev)<0&&E(V.next,z,z.next)<0}h(g,"sectorContainsSector");function b(z,V,j,q){var ee=z;do ee.z===0&&(ee.z=v(ee.x,ee.y,V,j,q)),ee.prevZ=ee.prev,ee.nextZ=ee.next,ee=ee.next;while(ee!==z);ee.prevZ.nextZ=null,ee.prevZ=null,x(ee)}h(b,"indexCurve");function x(z){var V,j,q,ee,ae,N,J,Y,oe=1;do{for(j=z,z=null,ae=null,N=0;j;){for(N++,q=j,J=0,V=0;V<oe&&(J++,q=q.nextZ,!!q);V++);for(Y=oe;J>0||Y>0&&q;)J!==0&&(Y===0||!q||j.z<=q.z)?(ee=j,j=j.nextZ,J--):(ee=q,q=q.nextZ,Y--),ae?ae.nextZ=ee:z=ee,ee.prevZ=ae,ae=ee;j=q}ae.nextZ=null,oe*=2}while(N>1);return z}h(x,"sortLinked");function v(z,V,j,q,ee){return z=(z-j)*ee|0,V=(V-q)*ee|0,z=(z|z<<8)&16711935,z=(z|z<<4)&252645135,z=(z|z<<2)&858993459,z=(z|z<<1)&1431655765,V=(V|V<<8)&16711935,V=(V|V<<4)&252645135,V=(V|V<<2)&858993459,V=(V|V<<1)&1431655765,z|V<<1}h(v,"zOrder");function w(z){var V=z,j=z;do(V.x<j.x||V.x===j.x&&V.y<j.y)&&(j=V),V=V.next;while(V!==z);return j}h(w,"getLeftmost");function _(z,V,j,q,ee,ae,N,J){return(ee-N)*(V-J)>=(z-N)*(ae-J)&&(z-N)*(q-J)>=(j-N)*(V-J)&&(j-N)*(ae-J)>=(ee-N)*(q-J)}h(_,"pointInTriangle");function C(z,V){return z.next.i!==V.i&&z.prev.i!==V.i&&!A(z,V)&&(k(z,V)&&k(V,z)&&$(z,V)&&(E(z.prev,z,V.prev)||E(z,V.prev,V))||T(z,V)&&E(z.prev,z,z.next)>0&&E(V.prev,V,V.next)>0)}h(C,"isValidDiagonal");function E(z,V,j){return(V.y-z.y)*(j.x-V.x)-(V.x-z.x)*(j.y-V.y)}h(E,"area");function T(z,V){return z.x===V.x&&z.y===V.y}h(T,"equals");function L(z,V,j,q){var ee=B(E(z,V,j)),ae=B(E(z,V,q)),N=B(E(j,q,z)),J=B(E(j,q,V));return!!(ee!==ae&&N!==J||ee===0&&D(z,j,V)||ae===0&&D(z,q,V)||N===0&&D(j,z,q)||J===0&&D(j,V,q))}h(L,"intersects");function D(z,V,j){return V.x<=Math.max(z.x,j.x)&&V.x>=Math.min(z.x,j.x)&&V.y<=Math.max(z.y,j.y)&&V.y>=Math.min(z.y,j.y)}h(D,"onSegment");function B(z){return z>0?1:z<0?-1:0}h(B,"sign");function A(z,V){var j=z;do{if(j.i!==z.i&&j.next.i!==z.i&&j.i!==V.i&&j.next.i!==V.i&&L(j,j.next,z,V))return!0;j=j.next}while(j!==z);return!1}h(A,"intersectsPolygon");function k(z,V){return E(z.prev,z,z.next)<0?E(z,V,z.next)>=0&&E(z,z.prev,V)>=0:E(z,V,z.prev)<0||E(z,z.next,V)<0}h(k,"locallyInside");function $(z,V){var j=z,q=!1,ee=(z.x+V.x)/2,ae=(z.y+V.y)/2;do j.y>ae!=j.next.y>ae&&j.next.y!==j.y&&ee<(j.next.x-j.x)*(ae-j.y)/(j.next.y-j.y)+j.x&&(q=!q),j=j.next;while(j!==z);return q}h($,"middleInside");function O(z,V){var j=new G(z.i,z.x,z.y),q=new G(V.i,V.x,V.y),ee=z.next,ae=V.prev;return z.next=V,V.prev=z,j.next=ee,ee.prev=j,q.next=j,j.prev=q,ae.next=q,q.prev=ae,q}h(O,"splitPolygon");function P(z,V,j,q){var ee=new G(z,V,j);return q?(ee.next=q.next,ee.prev=q,q.next.prev=ee,q.next=ee):(ee.prev=ee,ee.next=ee),ee}h(P,"insertNode");function U(z){z.next.prev=z.prev,z.prev.next=z.next,z.prevZ&&(z.prevZ.nextZ=z.nextZ),z.nextZ&&(z.nextZ.prevZ=z.prevZ)}h(U,"removeNode");function G(z,V,j){this.i=z,this.x=V,this.y=j,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}h(G,"Node"),t.deviation=function(z,V,j,q){var ee=V&&V.length,ae=ee?V[0]*j:z.length,N=Math.abs(K(z,0,ae,j));if(ee)for(var J=0,Y=V.length;J<Y;J++){var oe=V[J]*j,xe=J<Y-1?V[J+1]*j:z.length;N-=Math.abs(K(z,oe,xe,j))}var ge=0;for(J=0;J<q.length;J+=3){var Te=q[J]*j,me=q[J+1]*j,Q=q[J+2]*j;ge+=Math.abs((z[Te]-z[Q])*(z[me+1]-z[Te+1])-(z[Te]-z[me])*(z[Q+1]-z[Te+1]))}return N===0&&ge===0?0:Math.abs((ge-N)/N)};function K(z,V,j,q){for(var ee=0,ae=V,N=j-q;ae<j;ae+=q)ee+=(z[N]-z[ae])*(z[ae+1]+z[N+1]),N=ae;return ee}h(K,"signedArea"),t.flatten=function(z){for(var V=z[0][0].length,j={vertices:[],holes:[],dimensions:V},q=0,ee=0;ee<z.length;ee++){for(var ae=0;ae<z[ee].length;ae++)for(var N=0;N<V;N++)j.vertices.push(z[ee][ae][N]);ee>0&&(q+=z[ee-1].length,j.holes.push(q))}return j}}),J7=Qe((i,e)=>{R();var t=di();e.exports=r;function r(l,u,c,p,d){this.properties={},this.extent=c,this.type=0,this._pbf=l,this._geometry=-1,this._keys=p,this._values=d,l.readFields(n,this,u)}h(r,"VectorTileFeature");function n(l,u,c){l==1?u.id=c.readVarint():l==2?a(c,u):l==3?u.type=c.readVarint():l==4&&(u._geometry=c.pos)}h(n,"readFeature");function a(l,u){for(var c=l.readVarint()+l.pos;l.pos<c;){var p=u._keys[l.readVarint()],d=u._values[l.readVarint()];u.properties[p]=d}}h(a,"readTag"),r.types=["Unknown","Point","LineString","Polygon"],r.prototype.loadGeometry=function(){var l=this._pbf;l.pos=this._geometry;for(var u=l.readVarint()+l.pos,c=1,p=0,d=0,m=0,g=[],b;l.pos<u;){if(p<=0){var x=l.readVarint();c=x&7,p=x>>3}if(p--,c===1||c===2)d+=l.readSVarint(),m+=l.readSVarint(),c===1&&(b&&g.push(b),b=[]),b.push(new t(d,m));else if(c===7)b&&b.push(b[0].clone());else throw new Error("unknown command "+c)}return b&&g.push(b),g},r.prototype.bbox=function(){var l=this._pbf;l.pos=this._geometry;for(var u=l.readVarint()+l.pos,c=1,p=0,d=0,m=0,g=1/0,b=-1/0,x=1/0,v=-1/0;l.pos<u;){if(p<=0){var w=l.readVarint();c=w&7,p=w>>3}if(p--,c===1||c===2)d+=l.readSVarint(),m+=l.readSVarint(),d<g&&(g=d),d>b&&(b=d),m<x&&(x=m),m>v&&(v=m);else if(c!==7)throw new Error("unknown command "+c)}return[g,x,b,v]},r.prototype.toGeoJSON=function(l,u,c){var p=this.extent*Math.pow(2,c),d=this.extent*l,m=this.extent*u,g=this.loadGeometry(),b=r.types[this.type],x,v;function w(E){for(var T=0;T<E.length;T++){var L=E[T],D=180-(L.y+m)*360/p;E[T]=[(L.x+d)*360/p-180,360/Math.PI*Math.atan(Math.exp(D*Math.PI/180))-90]}}switch(h(w,"project"),this.type){case 1:var _=[];for(x=0;x<g.length;x++)_[x]=g[x][0];g=_,w(g);break;case 2:for(x=0;x<g.length;x++)w(g[x]);break;case 3:for(g=o(g),x=0;x<g.length;x++)for(v=0;v<g[x].length;v++)w(g[x][v]);break}g.length===1?g=g[0]:b="Multi"+b;var C={type:"Feature",geometry:{type:b,coordinates:g},properties:this.properties};return"id"in this&&(C.id=this.id),C};function o(l){var u=l.length;if(u<=1)return[l];for(var c=[],p,d,m=0;m<u;m++){var g=s(l[m]);g!==0&&(d===void 0&&(d=g<0),d===g<0?(p&&c.push(p),p=[l[m]]):p.push(l[m]))}return p&&c.push(p),c}h(o,"classifyRings");function s(l){for(var u=0,c=0,p=l.length,d=p-1,m,g;c<p;d=c++)m=l[c],g=l[d],u+=(g.x-m.x)*(m.y+g.y);return u}h(s,"signedArea")}),K7=Qe((i,e)=>{R();var t=J7();e.exports=r;function r(o,s){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=o,this._keys=[],this._values=[],this._features=[],o.readFields(n,this,s),this.length=this._features.length}h(r,"VectorTileLayer");function n(o,s,l){o===15?s.version=l.readVarint():o===1?s.name=l.readString():o===5?s.extent=l.readVarint():o===2?s._features.push(l.pos):o===3?s._keys.push(l.readString()):o===4&&s._values.push(a(l))}h(n,"readLayer");function a(o){for(var s=null,l=o.readVarint()+o.pos;o.pos<l;){var u=o.readVarint()>>3;s=u===1?o.readString():u===2?o.readFloat():u===3?o.readDouble():u===4?o.readVarint64():u===5?o.readVarint():u===6?o.readSVarint():u===7?o.readBoolean():null}return s}h(a,"readValueMessage"),r.prototype.feature=function(o){if(o<0||o>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[o];var s=this._pbf.readVarint()+this._pbf.pos;return new t(this._pbf,s,this.extent,this._keys,this._values)}}),Ane=Qe((i,e)=>{R();var t=K7();e.exports=r;function r(a,o){this.layers=a.readFields(n,{},o)}h(r,"VectorTile");function n(a,o,s){if(a===3){var l=new t(s,s.readVarint()+s.pos);l.length&&(o[l.name]=l)}}h(n,"readTile")}),Qv=Qe((i,e)=>{R(),e.exports.VectorTile=Ane(),e.exports.VectorTileFeature=J7(),e.exports.VectorTileLayer=K7()}),Ine=Qe(i=>{R(),i.read=function(e,t,r,n,a){var o,s,l=a*8-n-1,u=(1<<l)-1,c=u>>1,p=-7,d=r?a-1:0,m=r?-1:1,g=e[t+d];for(d+=m,o=g&(1<<-p)-1,g>>=-p,p+=l;p>0;o=o*256+e[t+d],d+=m,p-=8);for(s=o&(1<<-p)-1,o>>=-p,p+=n;p>0;s=s*256+e[t+d],d+=m,p-=8);if(o===0)o=1-c;else{if(o===u)return s?NaN:(g?-1:1)*(1/0);s=s+Math.pow(2,n),o=o-c}return(g?-1:1)*s*Math.pow(2,o-n)},i.write=function(e,t,r,n,a,o){var s,l,u,c=o*8-a-1,p=(1<<c)-1,d=p>>1,m=a===23?Math.pow(2,-24)-Math.pow(2,-77):0,g=n?0:o-1,b=n?1:-1,x=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(l=isNaN(t)?1:0,s=p):(s=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-s))<1&&(s--,u*=2),s+d>=1?t+=m/u:t+=m*Math.pow(2,1-d),t*u>=2&&(s++,u/=2),s+d>=p?(l=0,s=p):s+d>=1?(l=(t*u-1)*Math.pow(2,a),s=s+d):(l=t*Math.pow(2,d-1)*Math.pow(2,a),s=0));a>=8;e[r+g]=l&255,g+=b,l/=256,a-=8);for(s=s<<a|l,c+=a;c>0;e[r+g]=s&255,g+=b,s/=256,c-=8);e[r+g-b]|=x*128}}),Q7=Qe((i,e)=>{R(),e.exports=r;var t=Ine();function r(P){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(P)?P:new Uint8Array(P||0),this.pos=0,this.type=0,this.length=this.buf.length}h(r,"Pbf"),r.Varint=0,r.Fixed64=1,r.Bytes=2,r.Fixed32=5;var n=65536*65536,a=1/n,o=12,s=typeof TextDecoder>"u"?null:new TextDecoder("utf8");r.prototype={destroy:function(){this.buf=null},readFields:function(P,U,G){for(G=G||this.length;this.pos<G;){var K=this.readVarint(),z=K>>3,V=this.pos;this.type=K&7,P(z,U,this),this.pos===V&&this.skip(K)}return U},readMessage:function(P,U){return this.readFields(P,U,this.readVarint()+this.pos)},readFixed32:function(){var P=D(this.buf,this.pos);return this.pos+=4,P},readSFixed32:function(){var P=A(this.buf,this.pos);return this.pos+=4,P},readFixed64:function(){var P=D(this.buf,this.pos)+D(this.buf,this.pos+4)*n;return this.pos+=8,P},readSFixed64:function(){var P=D(this.buf,this.pos)+A(this.buf,this.pos+4)*n;return this.pos+=8,P},readFloat:function(){var P=t.read(this.buf,this.pos,!0,23,4);return this.pos+=4,P},readDouble:function(){var P=t.read(this.buf,this.pos,!0,52,8);return this.pos+=8,P},readVarint:function(P){var U=this.buf,G,K;return K=U[this.pos++],G=K&127,K<128||(K=U[this.pos++],G|=(K&127)<<7,K<128)||(K=U[this.pos++],G|=(K&127)<<14,K<128)||(K=U[this.pos++],G|=(K&127)<<21,K<128)?G:(K=U[this.pos],G|=(K&15)<<28,l(G,P,this))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var P=this.readVarint();return P%2===1?(P+1)/-2:P/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var P=this.readVarint()+this.pos,U=this.pos;return this.pos=P,P-U>=o&&s?$(this.buf,U,P):k(this.buf,U,P)},readBytes:function(){var P=this.readVarint()+this.pos,U=this.buf.subarray(this.pos,P);return this.pos=P,U},readPackedVarint:function(P,U){if(this.type!==r.Bytes)return P.push(this.readVarint(U));var G=u(this);for(P=P||[];this.pos<G;)P.push(this.readVarint(U));return P},readPackedSVarint:function(P){if(this.type!==r.Bytes)return P.push(this.readSVarint());var U=u(this);for(P=P||[];this.pos<U;)P.push(this.readSVarint());return P},readPackedBoolean:function(P){if(this.type!==r.Bytes)return P.push(this.readBoolean());var U=u(this);for(P=P||[];this.pos<U;)P.push(this.readBoolean());return P},readPackedFloat:function(P){if(this.type!==r.Bytes)return P.push(this.readFloat());var U=u(this);for(P=P||[];this.pos<U;)P.push(this.readFloat());return P},readPackedDouble:function(P){if(this.type!==r.Bytes)return P.push(this.readDouble());var U=u(this);for(P=P||[];this.pos<U;)P.push(this.readDouble());return P},readPackedFixed32:function(P){if(this.type!==r.Bytes)return P.push(this.readFixed32());var U=u(this);for(P=P||[];this.pos<U;)P.push(this.readFixed32());return P},readPackedSFixed32:function(P){if(this.type!==r.Bytes)return P.push(this.readSFixed32());var U=u(this);for(P=P||[];this.pos<U;)P.push(this.readSFixed32());return P},readPackedFixed64:function(P){if(this.type!==r.Bytes)return P.push(this.readFixed64());var U=u(this);for(P=P||[];this.pos<U;)P.push(this.readFixed64());return P},readPackedSFixed64:function(P){if(this.type!==r.Bytes)return P.push(this.readSFixed64());var U=u(this);for(P=P||[];this.pos<U;)P.push(this.readSFixed64());return P},skip:function(P){var U=P&7;if(U===r.Varint)for(;this.buf[this.pos++]>127;);else if(U===r.Bytes)this.pos=this.readVarint()+this.pos;else if(U===r.Fixed32)this.pos+=4;else if(U===r.Fixed64)this.pos+=8;else throw new Error("Unimplemented type: "+U)},writeTag:function(P,U){this.writeVarint(P<<3|U)},realloc:function(P){for(var U=this.length||16;U<this.pos+P;)U*=2;if(U!==this.length){var G=new Uint8Array(U);G.set(this.buf),this.buf=G,this.length=U}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(P){this.realloc(4),B(this.buf,P,this.pos),this.pos+=4},writeSFixed32:function(P){this.realloc(4),B(this.buf,P,this.pos),this.pos+=4},writeFixed64:function(P){this.realloc(8),B(this.buf,P&-1,this.pos),B(this.buf,Math.floor(P*a),this.pos+4),this.pos+=8},writeSFixed64:function(P){this.realloc(8),B(this.buf,P&-1,this.pos),B(this.buf,Math.floor(P*a),this.pos+4),this.pos+=8},writeVarint:function(P){if(P=+P||0,P>268435455||P<0){p(P,this);return}this.realloc(4),this.buf[this.pos++]=P&127|(P>127?128:0),!(P<=127)&&(this.buf[this.pos++]=(P>>>=7)&127|(P>127?128:0),!(P<=127)&&(this.buf[this.pos++]=(P>>>=7)&127|(P>127?128:0),!(P<=127)&&(this.buf[this.pos++]=P>>>7&127)))},writeSVarint:function(P){this.writeVarint(P<0?-P*2-1:P*2)},writeBoolean:function(P){this.writeVarint(!!P)},writeString:function(P){P=String(P),this.realloc(P.length*4),this.pos++;var U=this.pos;this.pos=O(this.buf,P,this.pos);var G=this.pos-U;G>=128&&g(U,G,this),this.pos=U-1,this.writeVarint(G),this.pos+=G},writeFloat:function(P){this.realloc(4),t.write(this.buf,P,this.pos,!0,23,4),this.pos+=4},writeDouble:function(P){this.realloc(8),t.write(this.buf,P,this.pos,!0,52,8),this.pos+=8},writeBytes:function(P){var U=P.length;this.writeVarint(U),this.realloc(U);for(var G=0;G<U;G++)this.buf[this.pos++]=P[G]},writeRawMessage:function(P,U){this.pos++;var G=this.pos;P(U,this);var K=this.pos-G;K>=128&&g(G,K,this),this.pos=G-1,this.writeVarint(K),this.pos+=K},writeMessage:function(P,U,G){this.writeTag(P,r.Bytes),this.writeRawMessage(U,G)},writePackedVarint:function(P,U){U.length&&this.writeMessage(P,b,U)},writePackedSVarint:function(P,U){U.length&&this.writeMessage(P,x,U)},writePackedBoolean:function(P,U){U.length&&this.writeMessage(P,_,U)},writePackedFloat:function(P,U){U.length&&this.writeMessage(P,v,U)},writePackedDouble:function(P,U){U.length&&this.writeMessage(P,w,U)},writePackedFixed32:function(P,U){U.length&&this.writeMessage(P,C,U)},writePackedSFixed32:function(P,U){U.length&&this.writeMessage(P,E,U)},writePackedFixed64:function(P,U){U.length&&this.writeMessage(P,T,U)},writePackedSFixed64:function(P,U){U.length&&this.writeMessage(P,L,U)},writeBytesField:function(P,U){this.writeTag(P,r.Bytes),this.writeBytes(U)},writeFixed32Field:function(P,U){this.writeTag(P,r.Fixed32),this.writeFixed32(U)},writeSFixed32Field:function(P,U){this.writeTag(P,r.Fixed32),this.writeSFixed32(U)},writeFixed64Field:function(P,U){this.writeTag(P,r.Fixed64),this.writeFixed64(U)},writeSFixed64Field:function(P,U){this.writeTag(P,r.Fixed64),this.writeSFixed64(U)},writeVarintField:function(P,U){this.writeTag(P,r.Varint),this.writeVarint(U)},writeSVarintField:function(P,U){this.writeTag(P,r.Varint),this.writeSVarint(U)},writeStringField:function(P,U){this.writeTag(P,r.Bytes),this.writeString(U)},writeFloatField:function(P,U){this.writeTag(P,r.Fixed32),this.writeFloat(U)},writeDoubleField:function(P,U){this.writeTag(P,r.Fixed64),this.writeDouble(U)},writeBooleanField:function(P,U){this.writeVarintField(P,!!U)}};function l(P,U,G){var K=G.buf,z,V;if(V=K[G.pos++],z=(V&112)>>4,V<128||(V=K[G.pos++],z|=(V&127)<<3,V<128)||(V=K[G.pos++],z|=(V&127)<<10,V<128)||(V=K[G.pos++],z|=(V&127)<<17,V<128)||(V=K[G.pos++],z|=(V&127)<<24,V<128)||(V=K[G.pos++],z|=(V&1)<<31,V<128))return c(P,z,U);throw new Error("Expected varint not more than 10 bytes")}h(l,"readVarintRemainder");function u(P){return P.type===r.Bytes?P.readVarint()+P.pos:P.pos+1}h(u,"readPackedEnd");function c(P,U,G){return G?U*4294967296+(P>>>0):(U>>>0)*4294967296+(P>>>0)}h(c,"toNum");function p(P,U){var G,K;if(P>=0?(G=P%4294967296|0,K=P/4294967296|0):(G=~(-P%4294967296),K=~(-P/4294967296),G^4294967295?G=G+1|0:(G=0,K=K+1|0)),P>=18446744073709552e3||P<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");U.realloc(10),d(G,K,U),m(K,U)}h(p,"writeBigVarint");function d(P,U,G){G.buf[G.pos++]=P&127|128,P>>>=7,G.buf[G.pos++]=P&127|128,P>>>=7,G.buf[G.pos++]=P&127|128,P>>>=7,G.buf[G.pos++]=P&127|128,P>>>=7,G.buf[G.pos]=P&127}h(d,"writeBigVarintLow");function m(P,U){var G=(P&7)<<4;U.buf[U.pos++]|=G|((P>>>=3)?128:0),P&&(U.buf[U.pos++]=P&127|((P>>>=7)?128:0),P&&(U.buf[U.pos++]=P&127|((P>>>=7)?128:0),P&&(U.buf[U.pos++]=P&127|((P>>>=7)?128:0),P&&(U.buf[U.pos++]=P&127|((P>>>=7)?128:0),P&&(U.buf[U.pos++]=P&127)))))}h(m,"writeBigVarintHigh");function g(P,U,G){var K=U<=16383?1:U<=2097151?2:U<=268435455?3:Math.floor(Math.log(U)/(Math.LN2*7));G.realloc(K);for(var z=G.pos-1;z>=P;z--)G.buf[z+K]=G.buf[z]}h(g,"makeRoomForExtraLength");function b(P,U){for(var G=0;G<P.length;G++)U.writeVarint(P[G])}h(b,"writePackedVarint");function x(P,U){for(var G=0;G<P.length;G++)U.writeSVarint(P[G])}h(x,"writePackedSVarint");function v(P,U){for(var G=0;G<P.length;G++)U.writeFloat(P[G])}h(v,"writePackedFloat");function w(P,U){for(var G=0;G<P.length;G++)U.writeDouble(P[G])}h(w,"writePackedDouble");function _(P,U){for(var G=0;G<P.length;G++)U.writeBoolean(P[G])}h(_,"writePackedBoolean");function C(P,U){for(var G=0;G<P.length;G++)U.writeFixed32(P[G])}h(C,"writePackedFixed32");function E(P,U){for(var G=0;G<P.length;G++)U.writeSFixed32(P[G])}h(E,"writePackedSFixed32");function T(P,U){for(var G=0;G<P.length;G++)U.writeFixed64(P[G])}h(T,"writePackedFixed64");function L(P,U){for(var G=0;G<P.length;G++)U.writeSFixed64(P[G])}h(L,"writePackedSFixed64");function D(P,U){return(P[U]|P[U+1]<<8|P[U+2]<<16)+P[U+3]*16777216}h(D,"readUInt32");function B(P,U,G){P[G]=U,P[G+1]=U>>>8,P[G+2]=U>>>16,P[G+3]=U>>>24}h(B,"writeInt32");function A(P,U){return(P[U]|P[U+1]<<8|P[U+2]<<16)+(P[U+3]<<24)}h(A,"readInt32");function k(P,U,G){for(var K="",z=U;z<G;){var V=P[z],j=null,q=V>239?4:V>223?3:V>191?2:1;if(z+q>G)break;var ee,ae,N;q===1?V<128&&(j=V):q===2?(ee=P[z+1],(ee&192)===128&&(j=(V&31)<<6|ee&63,j<=127&&(j=null))):q===3?(ee=P[z+1],ae=P[z+2],(ee&192)===128&&(ae&192)===128&&(j=(V&15)<<12|(ee&63)<<6|ae&63,(j<=2047||j>=55296&&j<=57343)&&(j=null))):q===4&&(ee=P[z+1],ae=P[z+2],N=P[z+3],(ee&192)===128&&(ae&192)===128&&(N&192)===128&&(j=(V&15)<<18|(ee&63)<<12|(ae&63)<<6|N&63,(j<=65535||j>=1114112)&&(j=null))),j===null?(j=65533,q=1):j>65535&&(j-=65536,K+=String.fromCharCode(j>>>10&1023|55296),j=56320|j&1023),K+=String.fromCharCode(j),z+=q}return K}h(k,"readUtf8");function $(P,U,G){return s.decode(P.subarray(U,G))}h($,"readUtf8TextDecoder");function O(P,U,G){for(var K=0,z,V;K<U.length;K++){if(z=U.charCodeAt(K),z>55295&&z<57344)if(V)if(z<56320){P[G++]=239,P[G++]=191,P[G++]=189,V=z;continue}else z=V-55296<<10|z-56320|65536,V=null;else{z>56319||K+1===U.length?(P[G++]=239,P[G++]=191,P[G++]=189):V=z;continue}else V&&(P[G++]=239,P[G++]=191,P[G++]=189,V=null);z<128?P[G++]=z:(z<2048?P[G++]=z>>6|192:(z<65536?P[G++]=z>>12|224:(P[G++]=z>>18|240,P[G++]=z>>12&63|128),P[G++]=z>>6&63|128),P[G++]=z&63|128)}return G}h(O,"writeUtf8")});R();var eL={name:"@packages/outdoor-context-v4",version:"4.1.3",private:!0,main:"dist/maplibre-gl.js",style:"dist/maplibre-gl.css",license:"BSD-3-Clause",homepage:"https://maplibre.org/",funding:"https://github.com/maplibre/maplibre-gl-js?sponsor=1",bugs:{url:"https://github.com/maplibre/maplibre-gl-js/issues/"},repository:{type:"git",url:"git://github.com/maplibre/maplibre-gl-js.git"},types:"dist/maplibre-gl.d.ts",type:"module",dependencies:{"@mapbox/geojson-rewind":"^0.5.2","@mapbox/jsonlint-lines-primitives":"^2.0.2","@mapbox/point-geometry":"^0.1.0","@mapbox/tiny-sdf":"^2.0.6","@mapbox/unitbezier":"^0.0.1","@mapbox/vector-tile":"^1.3.1","@mapbox/whoots-js":"^3.1.0","@maplibre/maplibre-gl-style-spec":"^20.1.1","@types/geojson":"^7946.0.14","@types/geojson-vt":"3.2.5","@types/junit-report-builder":"^3.0.2","@types/mapbox__point-geometry":"^0.1.4","@types/mapbox__vector-tile":"^1.3.4","@types/pbf":"^3.0.5","@types/supercluster":"^7.1.3",earcut:"^2.2.4","geojson-vt":"^3.2.1","gl-matrix":"^3.4.3","global-prefix":"^3.0.0",kdbush:"^4.0.2","murmurhash-js":"^1.0.0",pbf:"^3.2.1",potpack:"^2.0.0",quickselect:"^2.0.0",supercluster:"^8.0.1",tinyqueue:"^2.0.3","vt-pbf":"^3.1.3"},devDependencies:{"@mapbox/mapbox-gl-rtl-text":"^0.2.3","@mapbox/mvt-fixtures":"^3.10.0","@rollup/plugin-commonjs":"^25.0.7","@rollup/plugin-json":"^6.1.0","@rollup/plugin-node-resolve":"^15.2.3","@rollup/plugin-replace":"^5.0.5","@rollup/plugin-strip":"^3.0.4","@rollup/plugin-terser":"^0.4.4","@rollup/plugin-typescript":"^11.1.6","@types/benchmark":"^2.1.5","@types/cssnano":"^5.0.0","@types/d3":"^7.4.3","@types/diff":"^5.2.0","@types/earcut":"^2.1.4","@types/eslint":"^8.56.7","@types/gl":"^6.0.5","@types/glob":"^8.1.0","@types/jest":"^29.5.12","@types/jsdom":"^21.1.6","@types/minimist":"^1.2.5","@types/murmurhash-js":"^1.0.6","@types/nise":"^1.4.4","@types/node":"^20.12.7","@types/offscreencanvas":"^2019.7.3","@types/pixelmatch":"^5.2.6","@types/pngjs":"^6.0.4","@types/react":"^18.2.79","@types/react-dom":"^18.2.25","@types/request":"^2.48.12","@types/shuffle-seed":"^1.1.3","@types/window-or-global":"^1.0.6","@typescript-eslint/eslint-plugin":"^7.7.1","@typescript-eslint/parser":"^7.7.1",address:"^2.0.2",benchmark:"^2.1.4",canvas:"^2.11.2",cssnano:"^6.1.2",d3:"^7.9.0","d3-queue":"^3.0.7","devtools-protocol":"^0.0.1291694",diff:"^5.2.0","dts-bundle-generator":"^9.5.1",eslint:"^8.57.0","eslint-config-mourner":"^3.0.0","eslint-plugin-html":"^8.1.1","eslint-plugin-import":"^2.29.1","eslint-plugin-jest":"^28.2.0","eslint-plugin-react":"^7.34.1","eslint-plugin-tsdoc":"0.2.17",expect:"^29.7.0",glob:"^10.3.12","is-builtin-module":"^3.2.1",jest:"^29.7.0","jest-environment-jsdom":"^29.7.0","jest-junit":"^16.0.0","jest-monocart-coverage":"^1.1.0","jest-webgl-canvas-mock":"^2.5.3",jsdom:"^24.0.0","json-stringify-pretty-compact":"^4.0.0","junit-report-builder":"^3.2.1",minimist:"^1.2.8","mock-geolocation":"^1.0.11","monocart-coverage-reports":"^2.7.9",nise:"^5.1.9","npm-font-open-sans":"^1.1.0","npm-run-all":"^4.1.5","pdf-merger-js":"^5.1.1",pixelmatch:"^5.3.0",pngjs:"^7.0.0",postcss:"^8.4.38","postcss-cli":"^11.0.0","postcss-inline-svg":"^6.0.0","pretty-bytes":"^6.1.1",puppeteer:"^22.7.0",react:"^18.2.0","react-dom":"^18.2.0",rollup:"^4.16.4","rollup-plugin-sourcemaps":"^0.6.3",rw:"^1.3.3",semver:"^7.6.0","shuffle-seed":"^1.1.6","source-map-explorer":"^2.5.3",st:"^3.0.0",stylelint:"^16.4.0","stylelint-config-standard":"^36.0.0","ts-jest":"^29.1.2","ts-node":"^10.9.2",tslib:"^2.6.2",typedoc:"^0.25.13","typedoc-plugin-markdown":"^3.17.1","typedoc-plugin-missing-exports":"^2.2.0",typescript:"^5.4.5"},overrides:{"postcss-inline-svg":{"css-select":"^5.1.0","dom-serializer":"^2.0.0",htmlparser2:"^8.0.1","postcss-value-parser":"^4.2.0"}},scripts:{"generate-dist-package":"node --no-warnings --loader ts-node/esm build/generate-dist-package.js","generate-shaders":"node --no-warnings --loader ts-node/esm build/generate-shaders.ts","generate-struct-arrays":"node --no-warnings --loader ts-node/esm build/generate-struct-arrays.ts","generate-style-code":"node --no-warnings --loader ts-node/esm build/generate-style-code.ts","generate-typings":"dts-bundle-generator --export-referenced-types --umd-module-name=maplibregl -o ./dist/maplibre-gl.d.ts ./src/index.ts","generate-docs":"typedoc && node --no-warnings --loader ts-node/esm build/generate-docs.ts","generate-images":"node --no-warnings --loader ts-node/esm build/generate-doc-images.ts","build-dist":"npm run build-css && npm run generate-typings && npm run build-dev && npm run build-csp-dev && npm run build-prod && npm run build-csp","build-dev":"rollup --configPlugin @rollup/plugin-typescript -c --environment BUILD:dev","watch-dev":"rollup --configPlugin @rollup/plugin-typescript -c --environment BUILD:dev --watch","build-prod":"rollup --configPlugin @rollup/plugin-typescript -c --environment BUILD:production","build-csp":"rollup --configPlugin @rollup/plugin-typescript -c rollup.config.csp.ts","build-csp-dev":"rollup --configPlugin @rollup/plugin-typescript -c rollup.config.csp.ts --environment BUILD:dev","build-css":"postcss -o dist/maplibre-gl.css src/css/maplibre-gl.css","watch-css":"postcss --watch -o dist/maplibre-gl.css src/css/maplibre-gl.css","build-benchmarks":"npm run build-dev && rollup --configPlugin @rollup/plugin-typescript -c test/bench/rollup_config_benchmarks.ts","watch-benchmarks":"rollup --configPlugin @rollup/plugin-typescript -c test/bench/rollup_config_benchmarks.ts --watch","start-server":"st --no-cache -H 0.0.0.0 --port 9966 .","start-docs":"docker run --rm -it -p 8000:8000 -v ${PWD}:/docs squidfunk/mkdocs-material",start:"run-p watch-css watch-dev start-server","start-bench":"run-p watch-css watch-benchmarks start-server",lint:"eslint --cache --ext .ts,.tsx,.js,.html --ignore-path .gitignore .","lint-css":"stylelint src/css/maplibre-gl.css",test:"run-p lint lint-css test-render jest",jest:"jest","test-build":"jest --selectProjects=build --reporters=default","test-build-ci":"jest --selectProjects=build","test-integration":"jest --selectProjects=integration --reporters=default","test-integration-ci":"jest --selectProjects=integration","test-render":"node --no-warnings --loader ts-node/esm test/integration/render/run_render_tests.ts","test-unit":"jest --selectProjects=unit --reporters=default","test-unit-ci":"jest --coverage --selectProjects unit","test-watch-roots":"jest --watch",codegen:"run-p --print-label generate-dist-package generate-style-code generate-struct-arrays generate-shaders && npm run generate-typings",benchmark:"node --no-warnings --loader ts-node/esm test/bench/run-benchmarks.ts","gl-stats":"node --no-warnings --loader ts-node/esm test/bench/gl-stats.ts",prepare:"npm run codegen",typecheck:"tsc --noEmit && tsc --project tsconfig.dist.json",tsnode:"node --experimental-loader=ts-node/esm --no-warnings"},files:["build/","dist/*","src/"],engines:{npm:">=8.1.0",node:">=16.14.0"}};R();R();var Lne=It(di(),1),Dne=It(Ene(),1);R();R();var B_;function IC(){return B_==null&&(B_=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),B_}h(IC,"offscreenCanvasSupported");var Dg;function tL(){if(Dg==null&&(Dg=!1,IC())){let i=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(i){for(let t=0;t<5*5;t++){let r=t*4;i.fillStyle=`rgb(${r},${r+1},${r+2})`,i.fillRect(t%5,Math.floor(t/5),1,1)}let e=i.getImageData(0,0,5,5).data;for(let t=0;t<5*5*4;t++)if(t%4!==3&&e[t]!==t){Dg=!0;break}}}return Dg||!1}h(tL,"isOffscreenCanvasDistorted");function iL(i){if(i<=0)return 0;if(i>=1)return 1;let e=i*i,t=e*i;return 4*(i<.5?t:3*(i-e)+t-.75)}h(iL,"easeCubicInOut");function ex(i,e,t,r){let n=new Dne.default(i,e,t,r);return function(a){return n.solve(a)}}h(ex,"bezier");var jb=ex(.25,.1,.25,1);function Tr(i,e,t){return Math.min(t,Math.max(e,i))}h(Tr,"clamp");function Eu(i,e,t){let r=t-e,n=((i-e)%r+r)%r+e;return n===e?t:n}h(Eu,"wrap");function rL(i,e){let t=[];for(let r in i)r in e||t.push(r);return t}h(rL,"keysDifference");function ht(i,...e){for(let t of e)for(let r in t)i[r]=t[r];return i}h(ht,"extend");function Om(i,e){let t={};for(let r=0;r<e.length;r++){let n=e[r];n in i&&(t[n]=i[n])}return t}h(Om,"pick");var kne=1;function LC(){return kne++}h(LC,"uniqueId");function nL(i){return Math.log(i)/Math.LN2%1===0}h(nL,"isPowerOfTwo");function aL(i){return i<=1?1:Math.pow(2,Math.ceil(Math.log(i)/Math.LN2))}h(aL,"nextPowerOfTwo");function tx(i,e,t){let r={};for(let n in i)r[n]=e.call(t||this,i[n],n,i);return r}h(tx,"mapObject");function DC(i,e,t){let r={};for(let n in i)e.call(t||this,i[n],n,i)&&(r[n]=i[n]);return r}h(DC,"filterObject");function ml(i,e){if(Array.isArray(i)){if(!Array.isArray(e)||i.length!==e.length)return!1;for(let t=0;t<i.length;t++)if(!ml(i[t],e[t]))return!1;return!0}if(typeof i=="object"&&i!==null&&e!==null){if(typeof e!="object"||Object.keys(i).length!==Object.keys(e).length)return!1;for(let t in i)if(!ml(i[t],e[t]))return!1;return!0}return i===e}h(ml,"deepEqual");function oa(i){return Array.isArray(i)?i.map(oa):typeof i=="object"&&i?tx(i,oa):i}h(oa,"clone");function oL(i,e){for(let t=0;t<i.length;t++)if(e.indexOf(i[t])>=0)return!0;return!1}h(oL,"arraysIntersect");var MP={};function ln(i){MP[i]||(typeof console<"u"&&console.warn(i),MP[i]=!0)}h(ln,"warnOnce");function Ss(i,e,t){return(t.y-i.y)*(e.x-i.x)>(e.y-i.y)*(t.x-i.x)}h(Ss,"isCounterClockwise");function sL(i,e,t,r){let n=e.y-i.y,a=e.x-i.x,o=r.y-t.y,s=r.x-t.x,l=o*a-s*n;if(l===0)return null;let u=i.y-t.y,c=i.x-t.x,p=(s*u-o*c)/l;return new Lne.default(i.x+p*a,i.y+p*n)}h(sL,"findLineIntersection");function lL(i){let e=0;for(let t=0,r=i.length,n=r-1,a,o;t<r;n=t++)a=i[t],o=i[n],e+=(o.x-a.x)*(a.y+o.y);return e}h(lL,"calculateSignedArea");function uL([i,e,t]){return e+=90,e*=Math.PI/180,t*=Math.PI/180,{x:i*Math.cos(e)*Math.sin(t),y:i*Math.sin(e)*Math.sin(t),z:i*Math.cos(t)}}h(uL,"sphericalToCartesian");function Xu(i){return typeof WorkerGlobalScope<"u"&&typeof i<"u"&&i instanceof WorkerGlobalScope}h(Xu,"isWorker");function hL(i){let e=/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,t={};if(i.replace(e,(r,n,a,o)=>{let s=a||o;return t[n]=s?s.toLowerCase():!0,""}),t["max-age"]){let r=parseInt(t["max-age"],10);isNaN(r)?delete t["max-age"]:t["max-age"]=r}return t}h(hL,"parseCacheControl");var O_=null;function cL(i){if(O_==null){let e=i.navigator?i.navigator.userAgent:null;O_=!!i.safari||!!(e&&(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return O_}h(cL,"isSafari");function $o(i){return typeof ImageBitmap<"u"&&i instanceof ImageBitmap}h($o,"isImageBitmap");var Rne=h(async i=>{if(i.byteLength===0)return createImageBitmap(new ImageData(1,1));let e=new Blob([new Uint8Array(i)],{type:"image/png"});try{return createImageBitmap(e)}catch(t){throw new Error(`Could not load image because of ${t.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}},"arrayBufferToImageBitmap"),CP="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=",Fne=h(i=>new Promise((e,t)=>{let r=new Image;r.onload=()=>{e(r),URL.revokeObjectURL(r.src),r.onload=null,window.requestAnimationFrame(()=>{r.src=CP})},r.onerror=()=>t(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));let n=new Blob([new Uint8Array(i)],{type:"image/png"});r.src=i.byteLength?URL.createObjectURL(n):CP}),"arrayBufferToImage");function pL(i,e,t,r,n){let a=Math.max(-e,0)*4,o=(Math.max(0,t)-t)*r*4+a,s=r*4,l=Math.max(0,e),u=Math.max(0,t),c=Math.min(i.width,e+r),p=Math.min(i.height,t+n);return{rect:{x:l,y:u,width:c-l,height:p-u},layout:[{offset:o,stride:s}]}}h(pL,"computeVideoFrameParameters");async function dL(i,e,t,r,n){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");let a=new VideoFrame(i,{timestamp:0});try{let o=a==null?void 0:a.format;if(!o||!(o.startsWith("BGR")||o.startsWith("RGB")))throw new Error(`Unrecognized format ${o}`);let s=o.startsWith("BGR"),l=new Uint8ClampedArray(r*n*4);if(await a.copyTo(l,pL(i,e,t,r,n)),s)for(let u=0;u<l.length;u+=4){let c=l[u];l[u]=l[u+2],l[u+2]=c}return l}finally{a.close()}}h(dL,"readImageUsingVideoFrame");function fL(i,e,t,r){return i.addEventListener(e,t,r),{unsubscribe:()=>{i.removeEventListener(e,t,r)}}}h(fL,"subscribe");function Hb(i){return i*Math.PI/180}h(Hb,"degreesToRadians");R();R();var zne="AbortError";function Nm(){return new Error(zne)}h(Nm,"createAbortError");var Bne=typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),kg,N_,ai={now:Bne,frameAsync(i){return new Promise((e,t)=>{let r=requestAnimationFrame(e);i.signal.addEventListener("abort",()=>{cancelAnimationFrame(r),t(Nm())})})},getImageData(i,e=0){return this.getImageCanvasContext(i).getImageData(-e,-e,i.width+2*e,i.height+2*e)},getImageCanvasContext(i){let e=window.document.createElement("canvas"),t=e.getContext("2d",{willReadFrequently:!0});if(!t)throw new Error("failed to create canvas 2d context");return e.width=i.width,e.height=i.height,t.drawImage(i,0,0,i.width,i.height),t},resolveURL(i){return kg||(kg=document.createElement("a")),kg.href=i,kg.href},hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return matchMedia?(N_==null&&(N_=matchMedia("(prefers-reduced-motion: reduce)")),N_.matches):!1}};R();var One=It(di(),1),ou=class Zi{static testProp(e){if(!Zi.docStyle)return e[0];for(let t=0;t<e.length;t++)if(e[t]in Zi.docStyle)return e[t];return e[0]}static create(e,t,r){let n=window.document.createElement(e);return t!==void 0&&(n.className=t),r&&r.appendChild(n),n}static createNS(e,t){return window.document.createElementNS(e,t)}static disableDrag(){Zi.docStyle&&Zi.selectProp&&(Zi.userSelect=Zi.docStyle[Zi.selectProp],Zi.docStyle[Zi.selectProp]="none")}static enableDrag(){Zi.docStyle&&Zi.selectProp&&(Zi.docStyle[Zi.selectProp]=Zi.userSelect)}static setTransform(e,t){e.style[Zi.transformProp]=t}static addEventListener(e,t,r,n={}){"passive"in n?e.addEventListener(t,r,n):e.addEventListener(t,r,n.capture)}static removeEventListener(e,t,r,n={}){"passive"in n?e.removeEventListener(t,r,n):e.removeEventListener(t,r,n.capture)}static suppressClickInternal(e){e.preventDefault(),e.stopPropagation(),window.removeEventListener("click",Zi.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",Zi.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",Zi.suppressClickInternal,!0)},0)}static getScale(e){let t=e.getBoundingClientRect();return{x:t.width/e.offsetWidth||1,y:t.height/e.offsetHeight||1,boundingClientRect:t}}static getPoint(e,t,r){let n=t.boundingClientRect;return new One.default((r.clientX-n.left)/t.x-e.clientLeft,(r.clientY-n.top)/t.y-e.clientTop)}static mousePos(e,t){let r=Zi.getScale(e);return Zi.getPoint(e,r,t)}static touchPos(e,t){let r=[],n=Zi.getScale(e);for(let a=0;a<t.length;a++)r.push(Zi.getPoint(e,n,t[a]));return r}static mouseButton(e){return e.button}static remove(e){e.parentNode&&e.parentNode.removeChild(e)}};h(ou,"DOM"),ou.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,ou.selectProp=ou.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),ou.transformProp=ou.testProp(["transform","WebkitTransform"]);var Ve=ou;R();R();R();var vo={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function kC(i){return vo.REGISTERED_PROTOCOLS[i.substring(0,i.indexOf("://"))]}h(kC,"getProtocol");function Nne(i,e){vo.REGISTERED_PROTOCOLS[i]=e}h(Nne,"addProtocol");function $ne(i){delete vo.REGISTERED_PROTOCOLS[i]}h($ne,"removeProtocol");R();var Gb="global-dispatcher",mL=class extends Error{constructor(e,t,r,n){super(`AJAXError: ${t} (${e}): ${r}`),this.status=e,this.statusText=t,this.url=r,this.body=n}};h(mL,"AJAXError");var RC=mL,FC=h(()=>Xu(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,"getReferrer"),Une=h(i=>/^file:/.test(i)||/^file:/.test(FC())&&!/^\w+:/.test(i),"isFileURL");async function gL(i,e){let t=new Request(i.url,{method:i.method||"GET",body:i.body,credentials:i.credentials,headers:i.headers,cache:i.cache,referrer:FC(),signal:e.signal});i.type==="json"&&t.headers.set("Accept","application/json");let r=await fetch(t);if(!r.ok){let o=await r.blob();throw new RC(r.status,r.statusText,i.url,o)}let n;i.type==="arrayBuffer"||i.type==="image"?n=r.arrayBuffer():i.type==="json"?n=r.json():n=r.text();let a=await n;if(e.signal.aborted)throw Nm();return{data:a,cacheControl:r.headers.get("Cache-Control"),expires:r.headers.get("Expires")}}h(gL,"makeFetchRequest");function yL(i,e){return new Promise((t,r)=>{let n=new XMLHttpRequest;n.open(i.method||"GET",i.url,!0),(i.type==="arrayBuffer"||i.type==="image")&&(n.responseType="arraybuffer");for(let a in i.headers)n.setRequestHeader(a,i.headers[a]);i.type==="json"&&(n.responseType="text",n.setRequestHeader("Accept","application/json")),n.withCredentials=i.credentials==="include",n.onerror=()=>{r(new Error(n.statusText))},n.onload=()=>{if(!e.signal.aborted)if((n.status>=200&&n.status<300||n.status===0)&&n.response!==null){let a=n.response;if(i.type==="json")try{a=JSON.parse(n.response)}catch(o){r(o);return}t({data:a,cacheControl:n.getResponseHeader("Cache-Control"),expires:n.getResponseHeader("Expires")})}else{let a=new Blob([n.response],{type:n.getResponseHeader("Content-Type")});r(new RC(n.status,n.statusText,i.url,a))}},e.signal.addEventListener("abort",()=>{n.abort(),r(Nm())}),n.send(i.body)})}h(yL,"makeXMLHttpRequest");var ix=h(function(i,e){if(/:\/\//.test(i.url)&&!/^https?:|^file:/.test(i.url)){let t=kC(i.url);if(t)return t(i,e);if(Xu(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:i,targetMapId:Gb},e)}if(!Une(i.url)){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return gL(i,e);if(Xu(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:i,mustQueue:!0,targetMapId:Gb},e)}return yL(i,e)},"makeRequest"),rx=h((i,e)=>ix(ht(i,{type:"json"}),e),"getJSON"),Vne=h((i,e)=>ix(ht(i,{type:"arrayBuffer"}),e),"getArrayBuffer");function zC(i){if(!i||i.indexOf("://")<=0||i.indexOf("data:image/")===0||i.indexOf("blob:")===0)return!0;let e=new URL(i),t=window.location;return e.protocol===t.protocol&&e.host===t.host}h(zC,"sameOrigin");var jne=h(i=>{let e=window.document.createElement("video");return e.muted=!0,new Promise(t=>{e.onloadstart=()=>{t(e)};for(let r of i){let n=window.document.createElement("source");zC(r)||(e.crossOrigin="Anonymous"),n.src=r,e.appendChild(n)}})},"getVideo");R();R();var BC={supported:!1,testSupport:xL},$d,OC=!1,Uc,vL=!1;typeof document<"u"&&(Uc=document.createElement("img"),Uc.onload=function(){$d&&NC($d),$d=null,vL=!0},Uc.onerror=function(){OC=!0,$d=null},Uc.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");function xL(i){OC||!Uc||(vL?NC(i):$d=i)}h(xL,"testSupport");function NC(i){let e=i.createTexture();i.bindTexture(i.TEXTURE_2D,e);try{if(i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,Uc),i.isContextLost())return;BC.supported=!0}catch{}i.deleteTexture(e),OC=!0}h(NC,"testWebpTextureUpload");var Uo;(i=>{let e,t,r,n;i.resetRequestQueue=h(()=>{e=[],t=0,r=0,n={}},"resetRequestQueue"),i.addThrottleControl=h(c=>{let p=r++;return n[p]=c,p},"addThrottleControl"),i.removeThrottleControl=h(c=>{delete n[c],l()},"removeThrottleControl");let a=h(()=>{for(let c of Object.keys(n))if(n[c]())return!0;return!1},"isThrottled");i.getImage=h((c,p,d=!0)=>new Promise((m,g)=>{BC.supported&&(c.headers||(c.headers={}),c.headers.accept="image/webp,*/*"),ht(c,{type:"image"});let b={abortController:p,requestParameters:c,supportImageRefresh:d,state:"queued",onError:x=>{g(x)},onSuccess:x=>{m(x)}};e.push(b),l()}),"getImage");let o=h(c=>typeof createImageBitmap=="function"?Rne(c):Fne(c),"arrayBufferToCanvasImageSource"),s=h(async c=>{c.state="running";let{requestParameters:p,supportImageRefresh:d,onError:m,onSuccess:g,abortController:b}=c,x=d===!1&&!Xu(self)&&!kC(p.url)&&(!p.headers||Object.keys(p.headers).reduce((w,_)=>w&&_==="accept",!0));t++;let v=x?u(p,b):ix(p,b);try{let w=await v;if(delete c.abortController,c.state="completed",w.data instanceof HTMLImageElement||$o(w.data))g(w);else if(w.data){let _=await o(w.data);g({data:_,cacheControl:w.cacheControl,expires:w.expires})}}catch(w){delete c.abortController,m(w)}finally{t--,l()}},"doImageRequest"),l=h(()=>{let c=a()?vo.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:vo.MAX_PARALLEL_IMAGE_REQUESTS;for(let p=t;p<c&&e.length>0;p++){let d=e.shift();if(d.abortController.signal.aborted){p--;continue}s(d)}},"processQueue"),u=h((c,p)=>new Promise((d,m)=>{let g=new Image,b=c.url,x=c.credentials;x&&x==="include"?g.crossOrigin="use-credentials":(x&&x==="same-origin"||!zC(b))&&(g.crossOrigin="anonymous"),p.signal.addEventListener("abort",()=>{g.src="",m(Nm())}),g.fetchPriority="high",g.onload=()=>{g.onerror=g.onload=null,d({data:g})},g.onerror=()=>{g.onerror=g.onload=null,!p.signal.aborted&&m(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},g.src=b}),"getImageUsingHtmlImage")})(Uo||(Uo={}));Uo.resetRequestQueue();R();var _L=class{constructor(e){this._transformRequestFn=e}transformRequest(e,t){return this._transformRequestFn?this._transformRequestFn(e,t)||{url:e}:{url:e}}normalizeSpriteURL(e,t,r){let n=bL(e);return n.path+=`${t}${r}`,wL(n)}setTransformRequest(e){this._transformRequestFn=e}};h(_L,"RequestManager");var Hne=_L,Gne=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function bL(i){let e=i.match(Gne);if(!e)throw new Error(`Unable to parse URL "${i}"`);return{protocol:e[1],authority:e[2],path:e[3]||"/",params:e[4]?e[4].split("&"):[]}}h(bL,"parseUrl");function wL(i){let e=i.params.length?`?${i.params.join("&")}`:"";return`${i.protocol}://${i.authority}${i.path}${e}`}h(wL,"formatUrl");R();R();function Wb(i,e,t){t[i]&&t[i].indexOf(e)!==-1||(t[i]=t[i]||[],t[i].push(e))}h(Wb,"_addEventListener");function q1(i,e,t){if(t&&t[i]){let r=t[i].indexOf(e);r!==-1&&t[i].splice(r,1)}}h(q1,"_removeEventListener");var SL=class{constructor(e,t={}){ht(this,t),this.type=e}};h(SL,"Event");var qe=SL,ML=class extends qe{constructor(e,t={}){super("error",ht({error:e},t))}};h(ML,"ErrorEvent");var Mt=ML,CL=class{on(e,t){return this._listeners=this._listeners||{},Wb(e,t,this._listeners),this}off(e,t){return q1(e,t,this._listeners),q1(e,t,this._oneTimeListeners),this}once(e,t){return t?(this._oneTimeListeners=this._oneTimeListeners||{},Wb(e,t,this._oneTimeListeners),this):new Promise(r=>this.once(e,r))}fire(e,t){typeof e=="string"&&(e=new qe(e,t||{}));let r=e.type;if(this.listens(r)){e.target=this;let n=this._listeners&&this._listeners[r]?this._listeners[r].slice():[];for(let s of n)s.call(this,e);let a=this._oneTimeListeners&&this._oneTimeListeners[r]?this._oneTimeListeners[r].slice():[];for(let s of a)q1(r,s,this._oneTimeListeners),s.call(this,e);let o=this._eventedParent;o&&(ht(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),o.fire(e))}else e instanceof Mt&&console.error(e.error);return this}listens(e){return this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e)}setEventedParent(e,t){return this._eventedParent=e,this._eventedParentData=t,this}};h(CL,"Evented");var hn=CL;R();R();R();R();var Wne=8,Xne={version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},qne={"*":{type:"source"}},Zne=["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],Yne={type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},Jne={type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},Kne={type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},Qne={type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},eae={type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},tae={type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},iae={id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},rae=["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],nae={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},aae={"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},oae={"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},sae={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},lae={"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},uae={"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},hae={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},cae={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},pae={type:"array",value:"*"},dae={type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},fae={type:"enum",values:{Point:{},LineString:{},Polygon:{}}},mae={type:"array",minimum:0,maximum:24,value:["number","color"],length:2},gae={type:"array",value:"*",minimum:1},yae={anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},vae={"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},xae={source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},_ae={type:{type:"enum",default:"mercator",values:{mercator:{},globe:{}}}},bae=["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],wae={"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},Sae={"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},Mae={"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},Cae={"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},Eae={"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},Tae={"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},Pae={"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},Aae={"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},Iae={duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},Lae={"*":{type:"string"}},Le={$version:Wne,$root:Xne,sources:qne,source:Zne,source_vector:Yne,source_raster:Jne,source_raster_dem:Kne,source_geojson:Qne,source_video:eae,source_image:tae,layer:iae,layout:rae,layout_background:nae,layout_fill:aae,layout_circle:oae,layout_heatmap:sae,"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:lae,layout_symbol:uae,layout_raster:hae,layout_hillshade:cae,filter:pae,filter_operator:dae,geometry_type:fae,function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:mae,expression:gae,light:yae,sky:vae,terrain:xae,projection:_ae,paint:bae,paint_fill:wae,"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:Sae,paint_circle:Mae,paint_heatmap:Cae,paint_symbol:Eae,paint_raster:Tae,paint_hillshade:Pae,paint_background:Aae,transition:Iae,"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:Lae},Dae=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function EL(i,e){let t={};for(let r in i)r!=="ref"&&(t[r]=i[r]);return Dae.forEach(r=>{r in e&&(t[r]=e[r])}),t}h(EL,"deref");function Xb(i){i=i.slice();let e=Object.create(null);for(let t=0;t<i.length;t++)e[i[t].id]=i[t];for(let t=0;t<i.length;t++)"ref"in i[t]&&(i[t]=EL(i[t],e[i[t].ref]));return i}h(Xb,"derefLayers");function xi(i,e){if(Array.isArray(i)){if(!Array.isArray(e)||i.length!==e.length)return!1;for(let t=0;t<i.length;t++)if(!xi(i[t],e[t]))return!1;return!0}if(typeof i=="object"&&i!==null&&e!==null){if(typeof e!="object"||Object.keys(i).length!==Object.keys(e).length)return!1;for(let t in i)if(!xi(i[t],e[t]))return!1;return!0}return i===e}h(xi,"deepEqual");function ta(i,e){i.push(e)}h(ta,"addCommand");function $C(i,e,t){ta(t,{command:"addSource",args:[i,e[i]]})}h($C,"addSource");function UC(i,e,t){ta(e,{command:"removeSource",args:[i]}),t[i]=!0}h(UC,"removeSource");function TL(i,e,t,r){UC(i,t,r),$C(i,e,t)}h(TL,"updateSource");function PL(i,e,t){let r;for(r in i[t])if(Object.prototype.hasOwnProperty.call(i[t],r)&&r!=="data"&&!xi(i[t][r],e[t][r]))return!1;for(r in e[t])if(Object.prototype.hasOwnProperty.call(e[t],r)&&r!=="data"&&!xi(i[t][r],e[t][r]))return!1;return!0}h(PL,"canUpdateGeoJSON");function AL(i,e,t,r){i=i||{},e=e||{};let n;for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(Object.prototype.hasOwnProperty.call(e,n)||UC(n,t,r));for(n in e)Object.prototype.hasOwnProperty.call(e,n)&&(Object.prototype.hasOwnProperty.call(i,n)?xi(i[n],e[n])||(i[n].type==="geojson"&&e[n].type==="geojson"&&PL(i,e,n)?ta(t,{command:"setGeoJSONSourceData",args:[n,e[n].data]}):TL(n,e,t,r)):$C(n,e,t))}h(AL,"diffSources");function Ud(i,e,t,r,n,a){i=i||{},e=e||{};for(let o in i)Object.prototype.hasOwnProperty.call(i,o)&&(xi(i[o],e[o])||t.push({command:a,args:[r,o,e[o],n]}));for(let o in e)!Object.prototype.hasOwnProperty.call(e,o)||Object.prototype.hasOwnProperty.call(i,o)||xi(i[o],e[o])||t.push({command:a,args:[r,o,e[o],n]})}h(Ud,"diffLayerPropertyChanges");function qb(i){return i.id}h(qb,"pluckId");function Zb(i,e){return i[e.id]=e,i}h(Zb,"indexById");function IL(i,e,t){i=i||[],e=e||[];let r=i.map(qb),n=e.map(qb),a=i.reduce(Zb,{}),o=e.reduce(Zb,{}),s=r.slice(),l=Object.create(null),u,c,p,d,m;for(let g=0,b=0;g<r.length;g++)u=r[g],Object.prototype.hasOwnProperty.call(o,u)?b++:(ta(t,{command:"removeLayer",args:[u]}),s.splice(s.indexOf(u,b),1));for(let g=0,b=0;g<n.length;g++)u=n[n.length-1-g],s[s.length-1-g]!==u&&(Object.prototype.hasOwnProperty.call(a,u)?(ta(t,{command:"removeLayer",args:[u]}),s.splice(s.lastIndexOf(u,s.length-b),1)):b++,d=s[s.length-g],ta(t,{command:"addLayer",args:[o[u],d]}),s.splice(s.length-g,0,u),l[u]=!0);for(let g=0;g<n.length;g++)if(u=n[g],c=a[u],p=o[u],!(l[u]||xi(c,p))){if(!xi(c.source,p.source)||!xi(c["source-layer"],p["source-layer"])||!xi(c.type,p.type)){ta(t,{command:"removeLayer",args:[u]}),d=s[s.lastIndexOf(u)+1],ta(t,{command:"addLayer",args:[p,d]});continue}Ud(c.layout,p.layout,t,u,null,"setLayoutProperty"),Ud(c.paint,p.paint,t,u,null,"setPaintProperty"),xi(c.filter,p.filter)||ta(t,{command:"setFilter",args:[u,p.filter]}),(!xi(c.minzoom,p.minzoom)||!xi(c.maxzoom,p.maxzoom))&&ta(t,{command:"setLayerZoomRange",args:[u,p.minzoom,p.maxzoom]});for(m in c)Object.prototype.hasOwnProperty.call(c,m)&&(m==="layout"||m==="paint"||m==="filter"||m==="metadata"||m==="minzoom"||m==="maxzoom"||(m.indexOf("paint.")===0?Ud(c[m],p[m],t,u,m.slice(6),"setPaintProperty"):xi(c[m],p[m])||ta(t,{command:"setLayerProperty",args:[u,m,p[m]]})));for(m in p)!Object.prototype.hasOwnProperty.call(p,m)||Object.prototype.hasOwnProperty.call(c,m)||m==="layout"||m==="paint"||m==="filter"||m==="metadata"||m==="minzoom"||m==="maxzoom"||(m.indexOf("paint.")===0?Ud(c[m],p[m],t,u,m.slice(6),"setPaintProperty"):xi(c[m],p[m])||ta(t,{command:"setLayerProperty",args:[u,m,p[m]]}))}}h(IL,"diffLayers");function LL(i,e){if(!i)return[{command:"setStyle",args:[e]}];let t=[];try{if(!xi(i.version,e.version))return[{command:"setStyle",args:[e]}];xi(i.center,e.center)||t.push({command:"setCenter",args:[e.center]}),xi(i.zoom,e.zoom)||t.push({command:"setZoom",args:[e.zoom]}),xi(i.bearing,e.bearing)||t.push({command:"setBearing",args:[e.bearing]}),xi(i.pitch,e.pitch)||t.push({command:"setPitch",args:[e.pitch]}),xi(i.sprite,e.sprite)||t.push({command:"setSprite",args:[e.sprite]}),xi(i.glyphs,e.glyphs)||t.push({command:"setGlyphs",args:[e.glyphs]}),xi(i.transition,e.transition)||t.push({command:"setTransition",args:[e.transition]}),xi(i.light,e.light)||t.push({command:"setLight",args:[e.light]}),xi(i.terrain,e.terrain)||t.push({command:"setTerrain",args:[e.terrain]}),xi(i.sky,e.sky)||t.push({command:"setSky",args:[e.sky]}),xi(i.projection,e.projection)||t.push({command:"setProjection",args:[e.projection]});let r={},n=[];AL(i.sources,e.sources,n,r);let a=[];i.layers&&i.layers.forEach(o=>{"source"in o&&r[o.source]?t.push({command:"removeLayer",args:[o.id]}):a.push(o)}),t=t.concat(n),IL(a,e.layers,t)}catch(r){console.warn("Unable to compute style diff:",r),t=[{command:"setStyle",args:[e]}]}return t}h(LL,"diffStyles");var DL=class{constructor(e,t,r,n){this.message=(e?`${e}: `:"")+r,n&&(this.identifier=n),t!=null&&t.__line__&&(this.line=t.__line__)}};h(DL,"ValidationError");var Je=DL;function qu(i,...e){for(let t of e)for(let r in t)i[r]=t[r];return i}h(qu,"extendBy");var kL=class extends Error{constructor(e,t){super(t),this.message=t,this.key=e}};h(kL,"ExpressionParsingError");var Bo=kL,RL=class FL{constructor(e,t=[]){this.parent=e,this.bindings={};for(let[r,n]of t)this.bindings[r]=n}concat(e){return new FL(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return this.bindings[e]?!0:this.parent?this.parent.has(e):!1}};h(RL,"Scope");var kae=RL,$m={kind:"null"},it={kind:"number"},Kt={kind:"string"},Xt={kind:"boolean"},go={kind:"color"},ip={kind:"object"},qt={kind:"value"},Rae={kind:"error"},nx={kind:"collator"},Um={kind:"formatted"},ax={kind:"padding"},Vm={kind:"resolvedImage"},ox={kind:"variableAnchorOffsetCollection"};function Nn(i,e){return{kind:"array",itemType:i,N:e}}h(Nn,"array$1");function zi(i){if(i.kind==="array"){let e=zi(i.itemType);return typeof i.N=="number"?`array<${e}, ${i.N}>`:i.itemType.kind==="value"?"array":`array<${e}>`}else return i.kind}h(zi,"toString$1");var Fae=[$m,it,Kt,Xt,go,Um,ip,Nn(qt),ax,Vm,ox];function Ap(i,e){if(e.kind==="error")return null;if(i.kind==="array"){if(e.kind==="array"&&(e.N===0&&e.itemType.kind==="value"||!Ap(i.itemType,e.itemType))&&(typeof i.N!="number"||i.N===e.N))return null}else{if(i.kind===e.kind)return null;if(i.kind==="value"){for(let t of Fae)if(!Ap(t,e))return null}}return`Expected ${zi(i)} but found ${zi(e)} instead.`}h(Ap,"checkSubtype");function sx(i,e){return e.some(t=>t.kind===i.kind)}h(sx,"isValidType");function Ip(i,e){return e.some(t=>t==="null"?i===null:t==="array"?Array.isArray(i):t==="object"?i&&!Array.isArray(i)&&typeof i=="object":t===typeof i)}h(Ip,"isValidNativeType");function Hh(i,e){return i.kind==="array"&&e.kind==="array"?i.itemType.kind===e.itemType.kind&&typeof i.N=="number":i.kind===e.kind}h(Hh,"verifyType");var zL=.96422,BL=1,OL=.82521,NL=4/29,rp=6/29,$L=3*rp*rp,zae=rp*rp*rp,Bae=Math.PI/180,Oae=180/Math.PI;function VC(i){return i=i%360,i<0&&(i+=360),i}h(VC,"constrainAngle");function jC([i,e,t,r]){i=Z1(i),e=Z1(e),t=Z1(t);let n,a,o=Y1((.2225045*i+.7168786*e+.0606169*t)/BL);i===e&&e===t?n=a=o:(n=Y1((.4360747*i+.3850649*e+.1430804*t)/zL),a=Y1((.0139322*i+.0971045*e+.7141733*t)/OL));let s=116*o-16;return[s<0?0:s,500*(n-o),200*(o-a),r]}h(jC,"rgbToLab");function Z1(i){return i<=.04045?i/12.92:Math.pow((i+.055)/1.055,2.4)}h(Z1,"rgb2xyz");function Y1(i){return i>zae?Math.pow(i,1/3):i/$L+NL}h(Y1,"xyz2lab");function HC([i,e,t,r]){let n=(i+16)/116,a=isNaN(e)?n:n+e/500,o=isNaN(t)?n:n-t/200;return n=BL*K1(n),a=zL*K1(a),o=OL*K1(o),[J1(3.1338561*a-1.6168667*n-.4906146*o),J1(-.9787684*a+1.9161415*n+.033454*o),J1(.0719453*a-.2289914*n+1.4052427*o),r]}h(HC,"labToRgb");function J1(i){return i=i<=.00304?12.92*i:1.055*Math.pow(i,1/2.4)-.055,i<0?0:i>1?1:i}h(J1,"xyz2rgb");function K1(i){return i>rp?i*i*i:$L*(i-NL)}h(K1,"lab2xyz");function UL(i){let[e,t,r,n]=jC(i),a=Math.sqrt(t*t+r*r);return[Math.round(a*1e4)?VC(Math.atan2(r,t)*Oae):NaN,a,e,n]}h(UL,"rgbToHcl");function VL([i,e,t,r]){return i=isNaN(i)?0:i*Bae,HC([t,Math.cos(i)*e,Math.sin(i)*e,r])}h(VL,"hclToRgb");function jL([i,e,t,r]){i=VC(i),e/=100,t/=100;function n(a){let o=(a+i/30)%12,s=e*Math.min(t,1-t);return t-s*Math.max(-1,Math.min(o-3,9-o,1))}return h(n,"f"),[n(0),n(8),n(4),r]}h(jL,"hslToRgb");function HL(i){if(i=i.toLowerCase().trim(),i==="transparent")return[0,0,0,0];let e=Nae[i];if(e){let[n,a,o]=e;return[n/255,a/255,o/255,1]}if(i.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(i)){let n=i.length<6?1:2,a=1;return[Vd(i.slice(a,a+=n)),Vd(i.slice(a,a+=n)),Vd(i.slice(a,a+=n)),Vd(i.slice(a,a+n)||"ff")]}if(i.startsWith("rgb")){let n=/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/,a=i.match(n);if(a){let[o,s,l,u,c,p,d,m,g,b,x,v]=a,w=[u||" ",d||" ",b].join("");if(w==="  "||w==="  /"||w===",,"||w===",,,"){let _=[l,p,g].join(""),C=_==="%%%"?100:_===""?255:0;if(C){let E=[xu(+s/C,0,1),xu(+c/C,0,1),xu(+m/C,0,1),x?Yb(+x,v):1];if(Jb(E))return E}}return}}let t=/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/,r=i.match(t);if(r){let[n,a,o,s,l,u,c,p,d]=r,m=[o||" ",l||" ",c].join("");if(m==="  "||m==="  /"||m===",,"||m===",,,"){let g=[+a,xu(+s,0,100),xu(+u,0,100),p?Yb(+p,d):1];if(Jb(g))return jL(g)}}}h(HL,"parseCssColor");function Vd(i){return parseInt(i.padEnd(2,i),16)/255}h(Vd,"parseHex");function Yb(i,e){return xu(e?i/100:i,0,1)}h(Yb,"parseAlpha");function xu(i,e,t){return Math.min(Math.max(e,i),t)}h(xu,"clamp");function Jb(i){return!i.some(Number.isNaN)}h(Jb,"validateNumbers");var Nae={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},GL=class Kb{constructor(e,t,r,n=1,a=!0){this.r=e,this.g=t,this.b=r,this.a=n,a||(this.r*=n,this.g*=n,this.b*=n,n||this.overwriteGetter("rgb",[e,t,r,n]))}static parse(e){if(e instanceof Kb)return e;if(typeof e!="string")return;let t=HL(e);if(t)return new Kb(...t,!1)}get rgb(){let{r:e,g:t,b:r,a:n}=this,a=n||1/0;return this.overwriteGetter("rgb",[e/a,t/a,r/a,n])}get hcl(){return this.overwriteGetter("hcl",UL(this.rgb))}get lab(){return this.overwriteGetter("lab",jC(this.rgb))}overwriteGetter(e,t){return Object.defineProperty(this,e,{value:t}),t}toString(){let[e,t,r,n]=this.rgb;return`rgba(${[e,t,r].map(a=>Math.round(a*255)).join(",")},${n})`}};h(GL,"Color");var zt=GL;zt.black=new zt(0,0,0,1);zt.white=new zt(1,1,1,1);zt.transparent=new zt(0,0,0,0);zt.red=new zt(1,0,0,1);var WL=class{constructor(e,t,r){e?this.sensitivity=t?"variant":"case":this.sensitivity=t?"accent":"base",this.locale=r,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,t){return this.collator.compare(e,t)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}};h(WL,"Collator");var GC=WL,XL=class{constructor(e,t,r,n,a){this.text=e,this.image=t,this.scale=r,this.fontStack=n,this.textColor=a}};h(XL,"FormattedSection");var Qb=XL,qL=class Q1{constructor(e){this.sections=e}static fromString(e){return new Q1([new Qb(e,null,null,null,null)])}isEmpty(){return this.sections.length===0?!0:!this.sections.some(e=>e.text.length!==0||e.image&&e.image.name.length!==0)}static factory(e){return e instanceof Q1?e:Q1.fromString(e)}toString(){return this.sections.length===0?"":this.sections.map(e=>e.text).join("")}};h(qL,"Formatted");var Ls=qL,ZL=class ey{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof ey)return e;if(typeof e=="number")return new ey([e,e,e,e]);if(Array.isArray(e)&&!(e.length<1||e.length>4)){for(let t of e)if(typeof t!="number")return;switch(e.length){case 1:e=[e[0],e[0],e[0],e[0]];break;case 2:e=[e[0],e[1],e[0],e[1]];break;case 3:e=[e[0],e[1],e[2],e[1]];break}return new ey(e)}}toString(){return JSON.stringify(this.values)}};h(ZL,"Padding");var Fs=ZL,$ae=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]),YL=class ew{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof ew)return e;if(!(!Array.isArray(e)||e.length<1||e.length%2!==0)){for(let t=0;t<e.length;t+=2){let r=e[t],n=e[t+1];if(typeof r!="string"||!$ae.has(r)||!Array.isArray(n)||n.length!==2||typeof n[0]!="number"||typeof n[1]!="number")return}return new ew(e)}}toString(){return JSON.stringify(this.values)}};h(YL,"VariableAnchorOffsetCollection");var sh=YL,JL=class KL{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new KL({name:e,available:!1}):null}};h(JL,"ResolvedImage");var Wo=JL;function WC(i,e,t,r){return typeof i=="number"&&i>=0&&i<=255&&typeof e=="number"&&e>=0&&e<=255&&typeof t=="number"&&t>=0&&t<=255?typeof r>"u"||typeof r=="number"&&r>=0&&r<=1?null:`Invalid rgba value [${[i,e,t,r].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof r=="number"?[i,e,t,r]:[i,e,t]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}h(WC,"validateRGBA");function Lp(i){if(i===null||typeof i=="string"||typeof i=="boolean"||typeof i=="number"||i instanceof zt||i instanceof GC||i instanceof Ls||i instanceof Fs||i instanceof sh||i instanceof Wo)return!0;if(Array.isArray(i)){for(let e of i)if(!Lp(e))return!1;return!0}else if(typeof i=="object"){for(let e in i)if(!Lp(i[e]))return!1;return!0}else return!1}h(Lp,"isValue");function xr(i){if(i===null)return $m;if(typeof i=="string")return Kt;if(typeof i=="boolean")return Xt;if(typeof i=="number")return it;if(i instanceof zt)return go;if(i instanceof GC)return nx;if(i instanceof Ls)return Um;if(i instanceof Fs)return ax;if(i instanceof sh)return ox;if(i instanceof Wo)return Vm;if(Array.isArray(i)){let e=i.length,t;for(let r of i){let n=xr(r);if(!t)t=n;else{if(t===n)continue;t=qt;break}}return Nn(t||qt,e)}else return ip}h(xr,"typeOf");function np(i){let e=typeof i;return i===null?"":e==="string"||e==="number"||e==="boolean"?String(i):i instanceof zt||i instanceof Ls||i instanceof Fs||i instanceof sh||i instanceof Wo?i.toString():JSON.stringify(i)}h(np,"toString");var QL=class e9{constructor(e,t){this.type=e,this.value=t}static parse(e,t){if(e.length!==2)return t.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!Lp(e[1]))return t.error("invalid value");let r=e[1],n=xr(r),a=t.expectedType;return n.kind==="array"&&n.N===0&&a&&a.kind==="array"&&(typeof a.N!="number"||a.N===0)&&(n=a),new e9(n,r)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}};h(QL,"Literal");var pm=QL,t9=class{constructor(e){this.name="ExpressionEvaluationError",this.message=e}toJSON(){return this.message}};h(t9,"RuntimeError");var _r=t9,Rg={string:Kt,number:it,boolean:Xt,object:ip},i9=class r9{constructor(e,t){this.type=e,this.args=t}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");let r=1,n,a=e[0];if(a==="array"){let s;if(e.length>2){let u=e[1];if(typeof u!="string"||!(u in Rg)||u==="object")return t.error('The item type argument of "array" must be one of string, number, boolean',1);s=Rg[u],r++}else s=qt;let l;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return t.error('The length argument to "array" must be a positive integer literal',2);l=e[2],r++}n=Nn(s,l)}else{if(!Rg[a])throw new Error(`Types doesn't contain name = ${a}`);n=Rg[a]}let o=[];for(;r<e.length;r++){let s=t.parse(e[r],r,qt);if(!s)return null;o.push(s)}return new r9(n,o)}evaluate(e){for(let t=0;t<this.args.length;t++){let r=this.args[t].evaluate(e);if(Ap(this.type,xr(r))){if(t===this.args.length-1)throw new _r(`Expected value to be of type ${zi(this.type)}, but found ${zi(xr(r))} instead.`)}else return r}throw new Error}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}};h(i9,"Assertion");var xs=i9,EP={"to-boolean":Xt,"to-color":go,"to-number":it,"to-string":Kt},n9=class a9{constructor(e,t){this.type=e,this.args=t}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");let r=e[0];if(!EP[r])throw new Error(`Can't parse ${r} as it is not part of the known types`);if((r==="to-boolean"||r==="to-string")&&e.length!==2)return t.error("Expected one argument.");let n=EP[r],a=[];for(let o=1;o<e.length;o++){let s=t.parse(e[o],o,qt);if(!s)return null;a.push(s)}return new a9(n,a)}evaluate(e){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(e);case"color":{let t,r;for(let n of this.args){if(t=n.evaluate(e),r=null,t instanceof zt)return t;if(typeof t=="string"){let a=e.parseColor(t);if(a)return a}else if(Array.isArray(t)&&(t.length<3||t.length>4?r=`Invalid rbga value ${JSON.stringify(t)}: expected an array containing either three or four numeric values.`:r=WC(t[0],t[1],t[2],t[3]),!r))return new zt(t[0]/255,t[1]/255,t[2]/255,t[3])}throw new _r(r||`Could not parse color from value '${typeof t=="string"?t:JSON.stringify(t)}'`)}case"padding":{let t;for(let r of this.args){t=r.evaluate(e);let n=Fs.parse(t);if(n)return n}throw new _r(`Could not parse padding from value '${typeof t=="string"?t:JSON.stringify(t)}'`)}case"variableAnchorOffsetCollection":{let t;for(let r of this.args){t=r.evaluate(e);let n=sh.parse(t);if(n)return n}throw new _r(`Could not parse variableAnchorOffsetCollection from value '${typeof t=="string"?t:JSON.stringify(t)}'`)}case"number":{let t=null;for(let r of this.args){if(t=r.evaluate(e),t===null)return 0;let n=Number(t);if(!isNaN(n))return n}throw new _r(`Could not convert ${JSON.stringify(t)} to number.`)}case"formatted":return Ls.fromString(np(this.args[0].evaluate(e)));case"resolvedImage":return Wo.fromString(np(this.args[0].evaluate(e)));default:return np(this.args[0].evaluate(e))}}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}};h(n9,"Coercion");var Vc=n9,Uae=["Unknown","Point","LineString","Polygon"],o9=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Uae[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(e){let t=this._parseColorCache[e];return t||(t=this._parseColorCache[e]=zt.parse(e)),t}};h(o9,"EvaluationContext");var s9=o9,l9=class u9{constructor(e,t,r=[],n,a=new kae,o=[]){this.registry=e,this.path=r,this.key=r.map(s=>`[${s}]`).join(""),this.scope=a,this.errors=o,this.expectedType=n,this._isConstant=t}parse(e,t,r,n,a={}){return t?this.concat(t,r,n)._parse(e,a):this._parse(e,a)}_parse(e,t){(e===null||typeof e=="string"||typeof e=="boolean"||typeof e=="number")&&(e=["literal",e]);function r(n,a,o){return o==="assert"?new xs(a,[n]):o==="coerce"?new Vc(a,[n]):n}if(h(r,"annotate"),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');let n=e[0];if(typeof n!="string")return this.error(`Expression name must be a string, but found ${typeof n} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;let a=this.registry[n];if(a){let o=a.parse(e,this);if(!o)return null;if(this.expectedType){let s=this.expectedType,l=o.type;if((s.kind==="string"||s.kind==="number"||s.kind==="boolean"||s.kind==="object"||s.kind==="array")&&l.kind==="value")o=r(o,s,t.typeAnnotation||"assert");else if((s.kind==="color"||s.kind==="formatted"||s.kind==="resolvedImage")&&(l.kind==="value"||l.kind==="string"))o=r(o,s,t.typeAnnotation||"coerce");else if(s.kind==="padding"&&(l.kind==="value"||l.kind==="number"||l.kind==="array"))o=r(o,s,t.typeAnnotation||"coerce");else if(s.kind==="variableAnchorOffsetCollection"&&(l.kind==="value"||l.kind==="array"))o=r(o,s,t.typeAnnotation||"coerce");else if(this.checkSubtype(s,l))return null}if(!(o instanceof pm)&&o.type.kind!=="resolvedImage"&&this._isConstant(o)){let s=new s9;try{o=new pm(o.type,o.evaluate(s))}catch(l){return this.error(l.message),null}}return o}return this.error(`Unknown expression "${n}". If you wanted a literal array, use ["literal", [...]].`,0)}else return typeof e>"u"?this.error("'undefined' value invalid. Use null instead."):typeof e=="object"?this.error('Bare objects invalid. Use ["literal", {...}] instead.'):this.error(`Expected an array, but found ${typeof e} instead.`)}concat(e,t,r){let n=typeof e=="number"?this.path.concat(e):this.path,a=r?this.scope.concat(r):this.scope;return new u9(this.registry,this._isConstant,n,t||null,a,this.errors)}error(e,...t){let r=`${this.key}${t.map(n=>`[${n}]`).join("")}`;this.errors.push(new Bo(r,e))}checkSubtype(e,t){let r=Ap(e,t);return r&&this.error(r),r}};h(l9,"ParsingContext");var h9=l9,c9=class p9{constructor(e,t){this.type=t.type,this.bindings=[].concat(e),this.result=t}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(let t of this.bindings)e(t[1]);e(this.result)}static parse(e,t){if(e.length<4)return t.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);let r=[];for(let a=1;a<e.length-1;a+=2){let o=e[a];if(typeof o!="string")return t.error(`Expected string, but found ${typeof o} instead.`,a);if(/[^a-zA-Z0-9_]/.test(o))return t.error("Variable names must contain only alphanumeric characters or '_'.",a);let s=t.parse(e[a+1],a+1);if(!s)return null;r.push([o,s])}let n=t.parse(e[e.length-1],e.length-1,t.expectedType,r);return n?new p9(r,n):null}outputDefined(){return this.result.outputDefined()}};h(c9,"Let");var d9=c9,f9=class m9{constructor(e,t){this.type=t.type,this.name=e,this.boundExpression=t}static parse(e,t){if(e.length!==2||typeof e[1]!="string")return t.error("'var' expression requires exactly one string literal argument.");let r=e[1];return t.scope.has(r)?new m9(r,t.scope.get(r)):t.error(`Unknown variable "${r}". Make sure "${r}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}};h(f9,"Var");var g9=f9,y9=class v9{constructor(e,t,r){this.type=e,this.index=t,this.input=r}static parse(e,t){if(e.length!==3)return t.error(`Expected 2 arguments, but found ${e.length-1} instead.`);let r=t.parse(e[1],1,it),n=t.parse(e[2],2,Nn(t.expectedType||qt));if(!r||!n)return null;let a=n.type;return new v9(a.itemType,r,n)}evaluate(e){let t=this.index.evaluate(e),r=this.input.evaluate(e);if(t<0)throw new _r(`Array index out of bounds: ${t} < 0.`);if(t>=r.length)throw new _r(`Array index out of bounds: ${t} > ${r.length-1}.`);if(t!==Math.floor(t))throw new _r(`Array index must be an integer, but found ${t} instead.`);return r[t]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}};h(y9,"At");var Vae=y9,x9=class _9{constructor(e,t){this.type=Xt,this.needle=e,this.haystack=t}static parse(e,t){if(e.length!==3)return t.error(`Expected 2 arguments, but found ${e.length-1} instead.`);let r=t.parse(e[1],1,qt),n=t.parse(e[2],2,qt);return!r||!n?null:sx(r.type,[Xt,Kt,it,$m,qt])?new _9(r,n):t.error(`Expected first argument to be of type boolean, string, number or null, but found ${zi(r.type)} instead`)}evaluate(e){let t=this.needle.evaluate(e),r=this.haystack.evaluate(e);if(!r)return!1;if(!Ip(t,["boolean","string","number","null"]))throw new _r(`Expected first argument to be of type boolean, string, number or null, but found ${zi(xr(t))} instead.`);if(!Ip(r,["string","array"]))throw new _r(`Expected second argument to be of type array or string, but found ${zi(xr(r))} instead.`);return r.indexOf(t)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}};h(x9,"In");var jae=x9,b9=class tw{constructor(e,t,r){this.type=it,this.needle=e,this.haystack=t,this.fromIndex=r}static parse(e,t){if(e.length<=2||e.length>=5)return t.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);let r=t.parse(e[1],1,qt),n=t.parse(e[2],2,qt);if(!r||!n)return null;if(!sx(r.type,[Xt,Kt,it,$m,qt]))return t.error(`Expected first argument to be of type boolean, string, number or null, but found ${zi(r.type)} instead`);if(e.length===4){let a=t.parse(e[3],3,it);return a?new tw(r,n,a):null}else return new tw(r,n)}evaluate(e){let t=this.needle.evaluate(e),r=this.haystack.evaluate(e);if(!Ip(t,["boolean","string","number","null"]))throw new _r(`Expected first argument to be of type boolean, string, number or null, but found ${zi(xr(t))} instead.`);if(!Ip(r,["string","array"]))throw new _r(`Expected second argument to be of type array or string, but found ${zi(xr(r))} instead.`);if(this.fromIndex){let n=this.fromIndex.evaluate(e);return r.indexOf(t,n)}return r.indexOf(t)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}};h(b9,"IndexOf");var Hae=b9,w9=class S9{constructor(e,t,r,n,a,o){this.inputType=e,this.type=t,this.input=r,this.cases=n,this.outputs=a,this.otherwise=o}static parse(e,t){if(e.length<5)return t.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!==1)return t.error("Expected an even number of arguments.");let r,n;t.expectedType&&t.expectedType.kind!=="value"&&(n=t.expectedType);let a={},o=[];for(let u=2;u<e.length-1;u+=2){let c=e[u],p=e[u+1];Array.isArray(c)||(c=[c]);let d=t.concat(u);if(c.length===0)return d.error("Expected at least one branch label.");for(let g of c){if(typeof g!="number"&&typeof g!="string")return d.error("Branch labels must be numbers or strings.");if(typeof g=="number"&&Math.abs(g)>Number.MAX_SAFE_INTEGER)return d.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof g=="number"&&Math.floor(g)!==g)return d.error("Numeric branch labels must be integer values.");if(!r)r=xr(g);else if(d.checkSubtype(r,xr(g)))return null;if(typeof a[String(g)]<"u")return d.error("Branch labels must be unique.");a[String(g)]=o.length}let m=t.parse(p,u,n);if(!m)return null;n=n||m.type,o.push(m)}let s=t.parse(e[1],1,qt);if(!s)return null;let l=t.parse(e[e.length-1],e.length-1,n);return!l||s.type.kind!=="value"&&t.concat(1).checkSubtype(r,s.type)?null:new S9(r,n,s,a,o,l)}evaluate(e){let t=this.input.evaluate(e);return(xr(t)===this.inputType&&this.outputs[this.cases[t]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every(e=>e.outputDefined())&&this.otherwise.outputDefined()}};h(w9,"Match");var Gae=w9,M9=class C9{constructor(e,t,r){this.type=e,this.branches=t,this.otherwise=r}static parse(e,t){if(e.length<4)return t.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!==0)return t.error("Expected an odd number of arguments.");let r;t.expectedType&&t.expectedType.kind!=="value"&&(r=t.expectedType);let n=[];for(let o=1;o<e.length-1;o+=2){let s=t.parse(e[o],o,Xt);if(!s)return null;let l=t.parse(e[o+1],o+1,r);if(!l)return null;n.push([s,l]),r=r||l.type}let a=t.parse(e[e.length-1],e.length-1,r);if(!a)return null;if(!r)throw new Error("Can't infer output type");return new C9(r,n,a)}evaluate(e){for(let[t,r]of this.branches)if(t.evaluate(e))return r.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(let[t,r]of this.branches)e(t),e(r);e(this.otherwise)}outputDefined(){return this.branches.every(([e,t])=>t.outputDefined())&&this.otherwise.outputDefined()}};h(M9,"Case");var Wae=M9,E9=class iw{constructor(e,t,r,n){this.type=e,this.input=t,this.beginIndex=r,this.endIndex=n}static parse(e,t){if(e.length<=2||e.length>=5)return t.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);let r=t.parse(e[1],1,qt),n=t.parse(e[2],2,it);if(!r||!n)return null;if(!sx(r.type,[Nn(qt),Kt,qt]))return t.error(`Expected first argument to be of type array or string, but found ${zi(r.type)} instead`);if(e.length===4){let a=t.parse(e[3],3,it);return a?new iw(r.type,r,n,a):null}else return new iw(r.type,r,n)}evaluate(e){let t=this.input.evaluate(e),r=this.beginIndex.evaluate(e);if(!Ip(t,["string","array"]))throw new _r(`Expected first argument to be of type array or string, but found ${zi(xr(t))} instead.`);if(this.endIndex){let n=this.endIndex.evaluate(e);return t.slice(r,n)}return t.slice(r)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}};h(E9,"Slice");var Xae=E9;function jm(i,e){let t=i.length-1,r=0,n=t,a=0,o,s;for(;r<=n;)if(a=Math.floor((r+n)/2),o=i[a],s=i[a+1],o<=e){if(a===t||e<s)return a;r=a+1}else if(o>e)n=a-1;else throw new _r("Input is not a number.");return 0}h(jm,"findStopLessThanOrEqualTo");var T9=class P9{constructor(e,t,r){this.type=e,this.input=t,this.labels=[],this.outputs=[];for(let[n,a]of r)this.labels.push(n),this.outputs.push(a)}static parse(e,t){if(e.length-1<4)return t.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!==0)return t.error("Expected an even number of arguments.");let r=t.parse(e[1],1,it);if(!r)return null;let n=[],a=null;t.expectedType&&t.expectedType.kind!=="value"&&(a=t.expectedType);for(let o=1;o<e.length;o+=2){let s=o===1?-1/0:e[o],l=e[o+1],u=o,c=o+1;if(typeof s!="number")return t.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',u);if(n.length&&n[n.length-1][0]>=s)return t.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',u);let p=t.parse(l,c,a);if(!p)return null;a=a||p.type,n.push([s,p])}return new P9(a,r,n)}evaluate(e){let t=this.labels,r=this.outputs;if(t.length===1)return r[0].evaluate(e);let n=this.input.evaluate(e);if(n<=t[0])return r[0].evaluate(e);let a=t.length;if(n>=t[a-1])return r[a-1].evaluate(e);let o=jm(t,n);return r[o].evaluate(e)}eachChild(e){e(this.input);for(let t of this.outputs)e(t)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}};h(T9,"Step");var XC=T9;function A9(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}h(A9,"getDefaultExportFromCjs");var qae=qC;function qC(i,e,t,r){this.cx=3*i,this.bx=3*(t-i)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(r-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=i,this.p1y=e,this.p2x=t,this.p2y=r}h(qC,"UnitBezier");qC.prototype={sampleCurveX:function(i){return((this.ax*i+this.bx)*i+this.cx)*i},sampleCurveY:function(i){return((this.ay*i+this.by)*i+this.cy)*i},sampleCurveDerivativeX:function(i){return(3*this.ax*i+2*this.bx)*i+this.cx},solveCurveX:function(i,e){if(e===void 0&&(e=1e-6),i<0)return 0;if(i>1)return 1;for(var t=i,r=0;r<8;r++){var n=this.sampleCurveX(t)-i;if(Math.abs(n)<e)return t;var a=this.sampleCurveDerivativeX(t);if(Math.abs(a)<1e-6)break;t=t-n/a}var o=0,s=1;for(t=i,r=0;r<20&&(n=this.sampleCurveX(t),!(Math.abs(n-i)<e));r++)i>n?o=t:s=t,t=(s-o)*.5+o;return t},solve:function(i,e){return this.sampleCurveY(this.solveCurveX(i,e))}};var Zae=A9(qae);function I9(i){return i==="rgb"||i==="hcl"||i==="lab"}h(I9,"isSupportedInterpolationColorSpace");function Tl(i,e,t){return i+t*(e-i)}h(Tl,"number");function L9(i,e,t,r="rgb"){switch(r){case"rgb":{let[n,a,o,s]=dm(i.rgb,e.rgb,t);return new zt(n,a,o,s,!1)}case"hcl":{let[n,a,o,s]=i.hcl,[l,u,c,p]=e.hcl,d,m;if(!isNaN(n)&&!isNaN(l)){let w=l-n;l>n&&w>180?w-=360:l<n&&n-l>180&&(w+=360),d=n+t*w}else isNaN(n)?isNaN(l)?d=NaN:(d=l,(o===1||o===0)&&(m=u)):(d=n,(c===1||c===0)&&(m=a));let[g,b,x,v]=VL([d,m??Tl(a,u,t),Tl(o,c,t),Tl(s,p,t)]);return new zt(g,b,x,v,!1)}case"lab":{let[n,a,o,s]=HC(dm(i.lab,e.lab,t));return new zt(n,a,o,s,!1)}}}h(L9,"color");function dm(i,e,t){return i.map((r,n)=>Tl(r,e[n],t))}h(dm,"array");function D9(i,e,t){return new Fs(dm(i.values,e.values,t))}h(D9,"padding");function k9(i,e,t){let r=i.values,n=e.values;if(r.length!==n.length)throw new _r(`Cannot interpolate values of different length. from: ${i.toString()}, to: ${e.toString()}`);let a=[];for(let o=0;o<r.length;o+=2){if(r[o]!==n[o])throw new _r(`Cannot interpolate values containing mismatched anchors. from[${o}]: ${r[o]}, to[${o}]: ${n[o]}`);a.push(r[o]);let[s,l]=r[o+1],[u,c]=n[o+1];a.push([Tl(s,u,t),Tl(l,c,t)])}return new sh(a)}h(k9,"variableAnchorOffsetCollection");var ji={number:Tl,color:L9,array:dm,padding:D9,variableAnchorOffsetCollection:k9},R9=class rw{constructor(e,t,r,n,a){this.type=e,this.operator=t,this.interpolation=r,this.input=n,this.labels=[],this.outputs=[];for(let[o,s]of a)this.labels.push(o),this.outputs.push(s)}static interpolationFactor(e,t,r,n){let a=0;if(e.name==="exponential")a=ty(t,e.base,r,n);else if(e.name==="linear")a=ty(t,1,r,n);else if(e.name==="cubic-bezier"){let o=e.controlPoints;a=new Zae(o[0],o[1],o[2],o[3]).solve(ty(t,1,r,n))}return a}static parse(e,t){let[r,n,a,...o]=e;if(!Array.isArray(n)||n.length===0)return t.error("Expected an interpolation type expression.",1);if(n[0]==="linear")n={name:"linear"};else if(n[0]==="exponential"){let u=n[1];if(typeof u!="number")return t.error("Exponential interpolation requires a numeric base.",1,1);n={name:"exponential",base:u}}else if(n[0]==="cubic-bezier"){let u=n.slice(1);if(u.length!==4||u.some(c=>typeof c!="number"||c<0||c>1))return t.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);n={name:"cubic-bezier",controlPoints:u}}else return t.error(`Unknown interpolation type ${String(n[0])}`,1,0);if(e.length-1<4)return t.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!==0)return t.error("Expected an even number of arguments.");if(a=t.parse(a,2,it),!a)return null;let s=[],l=null;r==="interpolate-hcl"||r==="interpolate-lab"?l=go:t.expectedType&&t.expectedType.kind!=="value"&&(l=t.expectedType);for(let u=0;u<o.length;u+=2){let c=o[u],p=o[u+1],d=u+3,m=u+4;if(typeof c!="number")return t.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',d);if(s.length&&s[s.length-1][0]>=c)return t.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',d);let g=t.parse(p,m,l);if(!g)return null;l=l||g.type,s.push([c,g])}return!Hh(l,it)&&!Hh(l,go)&&!Hh(l,ax)&&!Hh(l,ox)&&!Hh(l,Nn(it))?t.error(`Type ${zi(l)} is not interpolatable.`):new rw(l,r,n,a,s)}evaluate(e){let t=this.labels,r=this.outputs;if(t.length===1)return r[0].evaluate(e);let n=this.input.evaluate(e);if(n<=t[0])return r[0].evaluate(e);let a=t.length;if(n>=t[a-1])return r[a-1].evaluate(e);let o=jm(t,n),s=t[o],l=t[o+1],u=rw.interpolationFactor(this.interpolation,n,s,l),c=r[o].evaluate(e),p=r[o+1].evaluate(e);switch(this.operator){case"interpolate":return ji[this.type.kind](c,p,u);case"interpolate-hcl":return ji.color(c,p,u,"hcl");case"interpolate-lab":return ji.color(c,p,u,"lab")}}eachChild(e){e(this.input);for(let t of this.outputs)e(t)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}};h(R9,"Interpolate");var Vo=R9;function ty(i,e,t,r){let n=r-t,a=i-t;return n===0?0:e===1?a/n:(Math.pow(e,a)-1)/(Math.pow(e,n)-1)}h(ty,"exponentialInterpolation");var F9=class nw{constructor(e,t){this.type=e,this.args=t}static parse(e,t){if(e.length<2)return t.error("Expectected at least one argument.");let r=null,n=t.expectedType;n&&n.kind!=="value"&&(r=n);let a=[];for(let o of e.slice(1)){let s=t.parse(o,1+a.length,r,void 0,{typeAnnotation:"omit"});if(!s)return null;r=r||s.type,a.push(s)}if(!r)throw new Error("No output type");return n&&a.some(o=>Ap(n,o.type))?new nw(qt,a):new nw(r,a)}evaluate(e){let t=null,r=0,n;for(let a of this.args)if(r++,t=a.evaluate(e),t&&t instanceof Wo&&!t.available&&(n||(n=t.name),t=null,r===this.args.length&&(t=n)),t!==null)break;return t}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}};h(F9,"Coalesce");var z9=F9;function aw(i,e){return i==="=="||i==="!="?e.kind==="boolean"||e.kind==="string"||e.kind==="number"||e.kind==="null"||e.kind==="value":e.kind==="string"||e.kind==="number"||e.kind==="value"}h(aw,"isComparableType");function B9(i,e,t){return e===t}h(B9,"eq");function O9(i,e,t){return e!==t}h(O9,"neq");function N9(i,e,t){return e<t}h(N9,"lt");function $9(i,e,t){return e>t}h($9,"gt");function U9(i,e,t){return e<=t}h(U9,"lteq");function V9(i,e,t){return e>=t}h(V9,"gteq");function ZC(i,e,t,r){return r.compare(e,t)===0}h(ZC,"eqCollate");function j9(i,e,t,r){return!ZC(i,e,t,r)}h(j9,"neqCollate");function H9(i,e,t,r){return r.compare(e,t)<0}h(H9,"ltCollate");function G9(i,e,t,r){return r.compare(e,t)>0}h(G9,"gtCollate");function W9(i,e,t,r){return r.compare(e,t)<=0}h(W9,"lteqCollate");function X9(i,e,t,r){return r.compare(e,t)>=0}h(X9,"gteqCollate");function lh(i,e,t){var r;let n=i!=="=="&&i!=="!=";return r=class{constructor(a,o,s){this.type=Xt,this.lhs=a,this.rhs=o,this.collator=s,this.hasUntypedArgument=a.type.kind==="value"||o.type.kind==="value"}static parse(a,o){if(a.length!==3&&a.length!==4)return o.error("Expected two or three arguments.");let s=a[0],l=o.parse(a[1],1,qt);if(!l)return null;if(!aw(s,l.type))return o.concat(1).error(`"${s}" comparisons are not supported for type '${zi(l.type)}'.`);let u=o.parse(a[2],2,qt);if(!u)return null;if(!aw(s,u.type))return o.concat(2).error(`"${s}" comparisons are not supported for type '${zi(u.type)}'.`);if(l.type.kind!==u.type.kind&&l.type.kind!=="value"&&u.type.kind!=="value")return o.error(`Cannot compare types '${zi(l.type)}' and '${zi(u.type)}'.`);n&&(l.type.kind==="value"&&u.type.kind!=="value"?l=new xs(u.type,[l]):l.type.kind!=="value"&&u.type.kind==="value"&&(u=new xs(l.type,[u])));let c=null;if(a.length===4){if(l.type.kind!=="string"&&u.type.kind!=="string"&&l.type.kind!=="value"&&u.type.kind!=="value")return o.error("Cannot use collator to compare non-string types.");if(c=o.parse(a[3],3,nx),!c)return null}return new r(l,u,c)}evaluate(a){let o=this.lhs.evaluate(a),s=this.rhs.evaluate(a);if(n&&this.hasUntypedArgument){let l=xr(o),u=xr(s);if(l.kind!==u.kind||!(l.kind==="string"||l.kind==="number"))throw new _r(`Expected arguments for "${i}" to be (string, string) or (number, number), but found (${l.kind}, ${u.kind}) instead.`)}if(this.collator&&!n&&this.hasUntypedArgument){let l=xr(o),u=xr(s);if(l.kind!=="string"||u.kind!=="string")return e(a,o,s)}return this.collator?t(a,o,s,this.collator.evaluate(a)):e(a,o,s)}eachChild(a){a(this.lhs),a(this.rhs),this.collator&&a(this.collator)}outputDefined(){return!0}},h(r,"Comparison"),r}h(lh,"makeComparison");var Yae=lh("==",B9,ZC),Jae=lh("!=",O9,j9),Kae=lh("<",N9,H9),Qae=lh(">",$9,G9),eoe=lh("<=",U9,W9),toe=lh(">=",V9,X9),q9=class Z9{constructor(e,t,r){this.type=nx,this.locale=r,this.caseSensitive=e,this.diacriticSensitive=t}static parse(e,t){if(e.length!==2)return t.error("Expected one argument.");let r=e[1];if(typeof r!="object"||Array.isArray(r))return t.error("Collator options argument must be an object.");let n=t.parse(r["case-sensitive"]===void 0?!1:r["case-sensitive"],1,Xt);if(!n)return null;let a=t.parse(r["diacritic-sensitive"]===void 0?!1:r["diacritic-sensitive"],1,Xt);if(!a)return null;let o=null;return r.locale&&(o=t.parse(r.locale,1,Kt),!o)?null:new Z9(n,a,o)}evaluate(e){return new GC(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}};h(q9,"CollatorExpression");var Y9=q9,J9=class K9{constructor(e,t,r,n,a){this.type=Kt,this.number=e,this.locale=t,this.currency=r,this.minFractionDigits=n,this.maxFractionDigits=a}static parse(e,t){if(e.length!==3)return t.error("Expected two arguments.");let r=t.parse(e[1],1,it);if(!r)return null;let n=e[2];if(typeof n!="object"||Array.isArray(n))return t.error("NumberFormat options argument must be an object.");let a=null;if(n.locale&&(a=t.parse(n.locale,1,Kt),!a))return null;let o=null;if(n.currency&&(o=t.parse(n.currency,1,Kt),!o))return null;let s=null;if(n["min-fraction-digits"]&&(s=t.parse(n["min-fraction-digits"],1,it),!s))return null;let l=null;return n["max-fraction-digits"]&&(l=t.parse(n["max-fraction-digits"],1,it),!l)?null:new K9(r,a,o,s,l)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}};h(J9,"NumberFormat");var ioe=J9,Q9=class eD{constructor(e){this.type=Um,this.sections=e}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");let r=e[1];if(!Array.isArray(r)&&typeof r=="object")return t.error("First argument must be an image or text section.");let n=[],a=!1;for(let o=1;o<=e.length-1;++o){let s=e[o];if(a&&typeof s=="object"&&!Array.isArray(s)){a=!1;let l=null;if(s["font-scale"]&&(l=t.parse(s["font-scale"],1,it),!l))return null;let u=null;if(s["text-font"]&&(u=t.parse(s["text-font"],1,Nn(Kt)),!u))return null;let c=null;if(s["text-color"]&&(c=t.parse(s["text-color"],1,go),!c))return null;let p=n[n.length-1];p.scale=l,p.font=u,p.textColor=c}else{let l=t.parse(e[o],1,qt);if(!l)return null;let u=l.type.kind;if(u!=="string"&&u!=="value"&&u!=="null"&&u!=="resolvedImage")return t.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");a=!0,n.push({content:l,scale:null,font:null,textColor:null})}}return new eD(n)}evaluate(e){let t=h(r=>{let n=r.content.evaluate(e);return xr(n)===Vm?new Qb("",n,null,null,null):new Qb(np(n),null,r.scale?r.scale.evaluate(e):null,r.font?r.font.evaluate(e).join(","):null,r.textColor?r.textColor.evaluate(e):null)},"evaluateSection");return new Ls(this.sections.map(t))}eachChild(e){for(let t of this.sections)e(t.content),t.scale&&e(t.scale),t.font&&e(t.font),t.textColor&&e(t.textColor)}outputDefined(){return!1}};h(Q9,"FormatExpression");var tD=Q9,iD=class rD{constructor(e){this.type=Vm,this.input=e}static parse(e,t){if(e.length!==2)return t.error("Expected two arguments.");let r=t.parse(e[1],1,Kt);return r?new rD(r):t.error("No image name provided.")}evaluate(e){let t=this.input.evaluate(e),r=Wo.fromString(t);return r&&e.availableImages&&(r.available=e.availableImages.indexOf(t)>-1),r}eachChild(e){e(this.input)}outputDefined(){return!1}};h(iD,"ImageExpression");var roe=iD,nD=class aD{constructor(e){this.type=it,this.input=e}static parse(e,t){if(e.length!==2)return t.error(`Expected 1 argument, but found ${e.length-1} instead.`);let r=t.parse(e[1],1);return r?r.type.kind!=="array"&&r.type.kind!=="string"&&r.type.kind!=="value"?t.error(`Expected argument of type string or array, but found ${zi(r.type)} instead.`):new aD(r):null}evaluate(e){let t=this.input.evaluate(e);if(typeof t=="string"||Array.isArray(t))return t.length;throw new _r(`Expected value to be of type string or array, but found ${zi(xr(t))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}};h(nD,"Length");var noe=nD,jo=8192;function oD(i,e){let t=sD(i[0]),r=uD(i[1]),n=Math.pow(2,e.z);return[Math.round(t*n*jo),Math.round(r*n*jo)]}h(oD,"getTileCoordinates");function lx(i,e){let t=Math.pow(2,e.z),r=(i[0]/jo+e.x)/t,n=(i[1]/jo+e.y)/t;return[lD(r),hD(n)]}h(lx,"getLngLatFromTileCoord");function sD(i){return(180+i)/360}h(sD,"mercatorXfromLng");function lD(i){return i*360-180}h(lD,"lngFromMercatorXfromLng");function uD(i){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i*Math.PI/360)))/360}h(uD,"mercatorYfromLat");function hD(i){return 360/Math.PI*Math.atan(Math.exp((180-i*360)*Math.PI/180))-90}h(hD,"latFromMercatorY");function Qp(i,e){i[0]=Math.min(i[0],e[0]),i[1]=Math.min(i[1],e[1]),i[2]=Math.max(i[2],e[0]),i[3]=Math.max(i[3],e[1])}h(Qp,"updateBBox");function Dp(i,e){return!(i[0]<=e[0]||i[2]>=e[2]||i[1]<=e[1]||i[3]>=e[3])}h(Dp,"boxWithinBox");function cD(i,e,t){return e[1]>i[1]!=t[1]>i[1]&&i[0]<(t[0]-e[0])*(i[1]-e[1])/(t[1]-e[1])+e[0]}h(cD,"rayIntersect");function pD(i,e,t){let r=i[0]-e[0],n=i[1]-e[1],a=i[0]-t[0],o=i[1]-t[1];return r*o-a*n===0&&r*a<=0&&n*o<=0}h(pD,"pointOnBoundary");function Hm(i,e,t,r){let n=[e[0]-i[0],e[1]-i[1]],a=[r[0]-t[0],r[1]-t[1]];return gD(a,n)===0?!1:!!(ow(i,e,t,r)&&ow(t,r,i,e))}h(Hm,"segmentIntersectSegment");function dD(i,e,t){for(let r of t)for(let n=0;n<r.length-1;++n)if(Hm(i,e,r[n],r[n+1]))return!0;return!1}h(dD,"lineIntersectPolygon");function uh(i,e,t=!1){let r=!1;for(let n of e)for(let a=0;a<n.length-1;a++){if(pD(i,n[a],n[a+1]))return t;cD(i,n[a],n[a+1])&&(r=!r)}return r}h(uh,"pointWithinPolygon");function fD(i,e){for(let t of e)if(uh(i,t))return!0;return!1}h(fD,"pointWithinPolygons");function YC(i,e){for(let t of i)if(!uh(t,e))return!1;for(let t=0;t<i.length-1;++t)if(dD(i[t],i[t+1],e))return!1;return!0}h(YC,"lineStringWithinPolygon");function mD(i,e){for(let t of e)if(YC(i,t))return!0;return!1}h(mD,"lineStringWithinPolygons");function gD(i,e){return i[0]*e[1]-i[1]*e[0]}h(gD,"perp");function ow(i,e,t,r){let n=i[0]-t[0],a=i[1]-t[1],o=e[0]-t[0],s=e[1]-t[1],l=r[0]-t[0],u=r[1]-t[1],c=n*u-l*a,p=o*u-l*s;return c>0&&p<0||c<0&&p>0}h(ow,"twoSided");function ux(i,e,t){let r=[];for(let n=0;n<i.length;n++){let a=[];for(let o=0;o<i[n].length;o++){let s=oD(i[n][o],t);Qp(e,s),a.push(s)}r.push(a)}return r}h(ux,"getTilePolygon");function JC(i,e,t){let r=[];for(let n=0;n<i.length;n++){let a=ux(i[n],e,t);r.push(a)}return r}h(JC,"getTilePolygons");function KC(i,e,t,r){if(i[0]<t[0]||i[0]>t[2]){let n=r*.5,a=i[0]-t[0]>n?-r:t[0]-i[0]>n?r:0;a===0&&(a=i[0]-t[2]>n?-r:t[2]-i[0]>n?r:0),i[0]+=a}Qp(e,i)}h(KC,"updatePoint");function yD(i){i[0]=i[1]=1/0,i[2]=i[3]=-1/0}h(yD,"resetBBox");function sw(i,e,t,r){let n=Math.pow(2,r.z)*jo,a=[r.x*jo,r.y*jo],o=[];for(let s of i)for(let l of s){let u=[l.x+a[0],l.y+a[1]];KC(u,e,t,n),o.push(u)}return o}h(sw,"getTilePoints");function lw(i,e,t,r){let n=Math.pow(2,r.z)*jo,a=[r.x*jo,r.y*jo],o=[];for(let s of i){let l=[];for(let u of s){let c=[u.x+a[0],u.y+a[1]];Qp(e,c),l.push(c)}o.push(l)}if(e[2]-e[0]<=n/2){yD(e);for(let s of o)for(let l of s)KC(l,e,t,n)}return o}h(lw,"getTileLines");function vD(i,e){let t=[1/0,1/0,-1/0,-1/0],r=[1/0,1/0,-1/0,-1/0],n=i.canonicalID();if(e.type==="Polygon"){let a=ux(e.coordinates,r,n),o=sw(i.geometry(),t,r,n);if(!Dp(t,r))return!1;for(let s of o)if(!uh(s,a))return!1}if(e.type==="MultiPolygon"){let a=JC(e.coordinates,r,n),o=sw(i.geometry(),t,r,n);if(!Dp(t,r))return!1;for(let s of o)if(!fD(s,a))return!1}return!0}h(vD,"pointsWithinPolygons");function xD(i,e){let t=[1/0,1/0,-1/0,-1/0],r=[1/0,1/0,-1/0,-1/0],n=i.canonicalID();if(e.type==="Polygon"){let a=ux(e.coordinates,r,n),o=lw(i.geometry(),t,r,n);if(!Dp(t,r))return!1;for(let s of o)if(!YC(s,a))return!1}if(e.type==="MultiPolygon"){let a=JC(e.coordinates,r,n),o=lw(i.geometry(),t,r,n);if(!Dp(t,r))return!1;for(let s of o)if(!mD(s,a))return!1}return!0}h(xD,"linesWithinPolygons");var _D=class iy{constructor(e,t){this.type=Xt,this.geojson=e,this.geometries=t}static parse(e,t){if(e.length!==2)return t.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(Lp(e[1])){let r=e[1];if(r.type==="FeatureCollection"){let n=[];for(let a of r.features){let{type:o,coordinates:s}=a.geometry;o==="Polygon"&&n.push(s),o==="MultiPolygon"&&n.push(...s)}if(n.length){let a={type:"MultiPolygon",coordinates:n};return new iy(r,a)}}else if(r.type==="Feature"){let n=r.geometry.type;if(n==="Polygon"||n==="MultiPolygon")return new iy(r,r.geometry)}else if(r.type==="Polygon"||r.type==="MultiPolygon")return new iy(r,r)}return t.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return vD(e,this.geometries);if(e.geometryType()==="LineString")return xD(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}};h(_D,"Within");var QC=_D,bD=class{constructor(e=[],t=SD){if(this.data=e,this.length=this.data.length,this.compare=t,this.length>0)for(let r=(this.length>>1)-1;r>=0;r--)this._down(r)}push(e){this.data.push(e),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;let e=this.data[0],t=this.data.pop();return this.length--,this.length>0&&(this.data[0]=t,this._down(0)),e}peek(){return this.data[0]}_up(e){let{data:t,compare:r}=this,n=t[e];for(;e>0;){let a=e-1>>1,o=t[a];if(r(n,o)>=0)break;t[e]=o,e=a}t[e]=n}_down(e){let{data:t,compare:r}=this,n=this.length>>1,a=t[e];for(;e<n;){let o=(e<<1)+1,s=t[o],l=o+1;if(l<this.length&&r(t[l],s)<0&&(o=l,s=t[l]),r(s,a)>=0)break;t[e]=s,e=o}t[e]=a}};h(bD,"TinyQueue");var wD=bD;function SD(i,e){return i<e?-1:i>e?1:0}h(SD,"defaultCompare$1");function MD(i,e,t,r,n){e4(i,e,t,r||i.length-1,n||CD)}h(MD,"quickselect");function e4(i,e,t,r,n){for(;r>t;){if(r-t>600){var a=r-t+1,o=e-t+1,s=Math.log(a),l=.5*Math.exp(2*s/3),u=.5*Math.sqrt(s*l*(a-l)/a)*(o-a/2<0?-1:1),c=Math.max(t,Math.floor(e-o*l/a+u)),p=Math.min(r,Math.floor(e+(a-o)*l/a+u));e4(i,e,c,p,n)}var d=i[e],m=t,g=r;for(Gh(i,t,e),n(i[r],d)>0&&Gh(i,t,r);m<g;){for(Gh(i,m,g),m++,g--;n(i[m],d)<0;)m++;for(;n(i[g],d)>0;)g--}n(i[t],d)===0?Gh(i,t,g):(g++,Gh(i,g,r)),g<=e&&(t=g+1),e<=g&&(r=g-1)}}h(e4,"quickselectStep");function Gh(i,e,t){var r=i[e];i[e]=i[t],i[t]=r}h(Gh,"swap");function CD(i,e){return i<e?-1:i>e?1:0}h(CD,"defaultCompare");function ED(i,e){if(i.length<=1)return[i];let t=[],r,n;for(let a of i){let o=PD(a);o!==0&&(a.area=Math.abs(o),n===void 0&&(n=o<0),n===o<0?(r&&t.push(r),r=[a]):r.push(a))}if(r&&t.push(r),e>1)for(let a=0;a<t.length;a++)t[a].length<=e||(MD(t[a],e,1,t[a].length-1,TD),t[a]=t[a].slice(0,e));return t}h(ED,"classifyRings");function TD(i,e){return e.area-i.area}h(TD,"compareAreas");function PD(i){let e=0;for(let t=0,r=i.length,n=r-1,a,o;t<r;n=t++)a=i[t],o=i[n],e+=(o.x-a.x)*(a.y+o.y);return e}h(PD,"calculateSignedArea");var aoe=6378.137,TP=1/298.257223563,PP=TP*(2-TP),AP=Math.PI/180,AD=class{constructor(e){let t=AP*aoe*1e3,r=Math.cos(e*AP),n=1/(1-PP*(1-r*r)),a=Math.sqrt(n);this.kx=t*a*r,this.ky=t*a*n*(1-PP)}distance(e,t){let r=this.wrap(e[0]-t[0])*this.kx,n=(e[1]-t[1])*this.ky;return Math.sqrt(r*r+n*n)}pointOnLine(e,t){let r=1/0,n,a,o,s;for(let l=0;l<e.length-1;l++){let u=e[l][0],c=e[l][1],p=this.wrap(e[l+1][0]-u)*this.kx,d=(e[l+1][1]-c)*this.ky,m=0;(p!==0||d!==0)&&(m=(this.wrap(t[0]-u)*this.kx*p+(t[1]-c)*this.ky*d)/(p*p+d*d),m>1?(u=e[l+1][0],c=e[l+1][1]):m>0&&(u+=p/this.kx*m,c+=d/this.ky*m)),p=this.wrap(t[0]-u)*this.kx,d=(t[1]-c)*this.ky;let g=p*p+d*d;g<r&&(r=g,n=u,a=c,o=l,s=m)}return{point:[n,a],index:o,t:Math.max(0,Math.min(1,s))}}wrap(e){for(;e<-180;)e+=360;for(;e>180;)e-=360;return e}};h(AD,"CheapRuler");var t4=AD,uw=100,hw=50;function i4(i,e){return e[0]-i[0]}h(i4,"compareDistPair");function fm(i){return i[1]-i[0]+1}h(fm,"getRangeSize");function Xo(i,e){return i[1]>=i[0]&&i[1]<e}h(Xo,"isRangeSafe");function K0(i,e){if(i[0]>i[1])return[null,null];let t=fm(i);if(e){if(t===2)return[i,null];let n=Math.floor(t/2);return[[i[0],i[0]+n],[i[0]+n,i[1]]]}if(t===1)return[i,null];let r=Math.floor(t/2)-1;return[[i[0],i[0]+r],[i[0]+r+1,i[1]]]}h(K0,"splitRange");function Q0(i,e){if(!Xo(e,i.length))return[1/0,1/0,-1/0,-1/0];let t=[1/0,1/0,-1/0,-1/0];for(let r=e[0];r<=e[1];++r)Qp(t,i[r]);return t}h(Q0,"getBBox");function ev(i){let e=[1/0,1/0,-1/0,-1/0];for(let t of i)for(let r of t)Qp(e,r);return e}h(ev,"getPolygonBBox");function cw(i){return i[0]!==-1/0&&i[1]!==-1/0&&i[2]!==1/0&&i[3]!==1/0}h(cw,"isValidBBox");function hx(i,e,t){if(!cw(i)||!cw(e))return NaN;let r=0,n=0;return i[2]<e[0]&&(r=e[0]-i[2]),i[0]>e[2]&&(r=i[0]-e[2]),i[1]>e[3]&&(n=i[1]-e[3]),i[3]<e[1]&&(n=e[1]-i[3]),t.distance([0,0],[r,n])}h(hx,"bboxToBBoxDistance");function gl(i,e,t){let r=t.pointOnLine(e,i);return t.distance(i,r.point)}h(gl,"pointToLineDistance");function cx(i,e,t,r,n){let a=Math.min(gl(i,[t,r],n),gl(e,[t,r],n)),o=Math.min(gl(t,[i,e],n),gl(r,[i,e],n));return Math.min(a,o)}h(cx,"segmentToSegmentDistance");function ID(i,e,t,r,n){if(!(Xo(e,i.length)&&Xo(r,t.length)))return 1/0;let a=1/0;for(let o=e[0];o<e[1];++o){let s=i[o],l=i[o+1];for(let u=r[0];u<r[1];++u){let c=t[u],p=t[u+1];if(Hm(s,l,c,p))return 0;a=Math.min(a,cx(s,l,c,p,n))}}return a}h(ID,"lineToLineDistance");function LD(i,e,t,r,n){if(!(Xo(e,i.length)&&Xo(r,t.length)))return NaN;let a=1/0;for(let o=e[0];o<=e[1];++o)for(let s=r[0];s<=r[1];++s)if(a=Math.min(a,n.distance(i[o],t[s])),a===0)return a;return a}h(LD,"pointsToPointsDistance");function DD(i,e,t){if(uh(i,e,!0))return 0;let r=1/0;for(let n of e){let a=n[0],o=n[n.length-1];if(a!==o&&(r=Math.min(r,gl(i,[o,a],t)),r===0))return r;let s=t.pointOnLine(n,i);if(r=Math.min(r,t.distance(i,s.point)),r===0)return r}return r}h(DD,"pointToPolygonDistance");function kD(i,e,t,r){if(!Xo(e,i.length))return NaN;for(let a=e[0];a<=e[1];++a)if(uh(i[a],t,!0))return 0;let n=1/0;for(let a=e[0];a<e[1];++a){let o=i[a],s=i[a+1];for(let l of t)for(let u=0,c=l.length,p=c-1;u<c;p=u++){let d=l[p],m=l[u];if(Hm(o,s,d,m))return 0;n=Math.min(n,cx(o,s,d,m,r))}}return n}h(kD,"lineToPolygonDistance");function pw(i,e){for(let t of i)for(let r of t)if(uh(r,e,!0))return!0;return!1}h(pw,"polygonIntersect");function RD(i,e,t,r=1/0){let n=ev(i),a=ev(e);if(r!==1/0&&hx(n,a,t)>=r)return r;if(Dp(n,a)){if(pw(i,e))return 0}else if(pw(e,i))return 0;let o=1/0;for(let s of i)for(let l=0,u=s.length,c=u-1;l<u;c=l++){let p=s[c],d=s[l];for(let m of e)for(let g=0,b=m.length,x=b-1;g<b;x=g++){let v=m[x],w=m[g];if(Hm(p,d,v,w))return 0;o=Math.min(o,cx(p,d,v,w,t))}}return o}h(RD,"polygonToPolygonDistance");function dw(i,e,t,r,n,a){if(!a)return;let o=hx(Q0(r,a),n,t);o<e&&i.push([o,a,[0,0]])}h(dw,"updateQueue");function jd(i,e,t,r,n,a,o){if(!a||!o)return;let s=hx(Q0(r,a),Q0(n,o),t);s<e&&i.push([s,a,o])}h(jd,"updateQueueTwoSets");function mm(i,e,t,r,n=1/0){let a=Math.min(r.distance(i[0],t[0][0]),n);if(a===0)return a;let o=new wD([[0,[0,i.length-1],[0,0]]],i4),s=ev(t);for(;o.length>0;){let l=o.pop();if(l[0]>=a)continue;let u=l[1],c=e?hw:uw;if(fm(u)<=c){if(!Xo(u,i.length))return NaN;if(e){let p=kD(i,u,t,r);if(isNaN(p)||p===0)return p;a=Math.min(a,p)}else for(let p=u[0];p<=u[1];++p){let d=DD(i[p],t,r);if(a=Math.min(a,d),a===0)return 0}}else{let p=K0(u,e);dw(o,a,r,i,s,p[0]),dw(o,a,r,i,s,p[1])}}return a}h(mm,"pointsToPolygonDistance");function gm(i,e,t,r,n,a=1/0){let o=Math.min(a,n.distance(i[0],t[0]));if(o===0)return o;let s=new wD([[0,[0,i.length-1],[0,t.length-1]]],i4);for(;s.length>0;){let l=s.pop();if(l[0]>=o)continue;let u=l[1],c=l[2],p=e?hw:uw,d=r?hw:uw;if(fm(u)<=p&&fm(c)<=d){if(!Xo(u,i.length)&&Xo(c,t.length))return NaN;let m;if(e&&r)m=ID(i,u,t,c,n),o=Math.min(o,m);else if(e&&!r){let g=i.slice(u[0],u[1]+1);for(let b=c[0];b<=c[1];++b)if(m=gl(t[b],g,n),o=Math.min(o,m),o===0)return o}else if(!e&&r){let g=t.slice(c[0],c[1]+1);for(let b=u[0];b<=u[1];++b)if(m=gl(i[b],g,n),o=Math.min(o,m),o===0)return o}else m=LD(i,u,t,c,n),o=Math.min(o,m)}else{let m=K0(u,e),g=K0(c,r);jd(s,o,n,i,t,m[0],g[0]),jd(s,o,n,i,t,m[0],g[1]),jd(s,o,n,i,t,m[1],g[0]),jd(s,o,n,i,t,m[1],g[1])}}return o}h(gm,"pointSetToPointSetDistance");function FD(i,e){let t=i.geometry(),r=t.flat().map(o=>lx([o.x,o.y],i.canonical));if(t.length===0)return NaN;let n=new t4(r[0][1]),a=1/0;for(let o of e){switch(o.type){case"Point":a=Math.min(a,gm(r,!1,[o.coordinates],!1,n,a));break;case"LineString":a=Math.min(a,gm(r,!1,o.coordinates,!0,n,a));break;case"Polygon":a=Math.min(a,mm(r,!1,o.coordinates,n,a));break}if(a===0)return a}return a}h(FD,"pointToGeometryDistance");function zD(i,e){let t=i.geometry(),r=t.flat().map(o=>lx([o.x,o.y],i.canonical));if(t.length===0)return NaN;let n=new t4(r[0][1]),a=1/0;for(let o of e){switch(o.type){case"Point":a=Math.min(a,gm(r,!0,[o.coordinates],!1,n,a));break;case"LineString":a=Math.min(a,gm(r,!0,o.coordinates,!0,n,a));break;case"Polygon":a=Math.min(a,mm(r,!0,o.coordinates,n,a));break}if(a===0)return a}return a}h(zD,"lineStringToGeometryDistance");function BD(i,e){let t=i.geometry();if(t.length===0||t[0].length===0)return NaN;let r=ED(t,0).map(o=>o.map(s=>s.map(l=>lx([l.x,l.y],i.canonical)))),n=new t4(r[0][0][0][1]),a=1/0;for(let o of e)for(let s of r){switch(o.type){case"Point":a=Math.min(a,mm([o.coordinates],!1,s,n,a));break;case"LineString":a=Math.min(a,mm(o.coordinates,!0,s,n,a));break;case"Polygon":a=Math.min(a,RD(s,o.coordinates,n,a));break}if(a===0)return a}return a}h(BD,"polygonToGeometryDistance");function ry(i){return i.type==="MultiPolygon"?i.coordinates.map(e=>({type:"Polygon",coordinates:e})):i.type==="MultiLineString"?i.coordinates.map(e=>({type:"LineString",coordinates:e})):i.type==="MultiPoint"?i.coordinates.map(e=>({type:"Point",coordinates:e})):[i]}h(ry,"toSimpleGeometry");var OD=class ny{constructor(e,t){this.type=it,this.geojson=e,this.geometries=t}static parse(e,t){if(e.length!==2)return t.error(`'distance' expression requires exactly one argument, but found ${e.length-1} instead.`);if(Lp(e[1])){let r=e[1];if(r.type==="FeatureCollection")return new ny(r,r.features.map(n=>ry(n.geometry)).flat());if(r.type==="Feature")return new ny(r,ry(r.geometry));if("type"in r&&"coordinates"in r)return new ny(r,ry(r))}return t.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return FD(e,this.geometries);if(e.geometryType()==="LineString")return zD(e,this.geometries);if(e.geometryType()==="Polygon")return BD(e,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}};h(OD,"Distance");var r4=OD,ap={"==":Yae,"!=":Jae,">":Qae,"<":Kae,">=":toe,"<=":eoe,array:xs,at:Vae,boolean:xs,case:Wae,coalesce:z9,collator:Y9,format:tD,image:roe,in:jae,"index-of":Hae,interpolate:Vo,"interpolate-hcl":Vo,"interpolate-lab":Vo,length:noe,let:d9,literal:pm,match:Gae,number:xs,"number-format":ioe,object:xs,slice:Xae,step:XC,string:xs,"to-boolean":Vc,"to-color":Vc,"to-number":Vc,"to-string":Vc,var:g9,within:QC,distance:r4},ND=class Hd{constructor(e,t,r,n){this.name=e,this.type=t,this._evaluate=r,this.args=n}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}static parse(e,t){let r=e[0],n=Hd.definitions[r];if(!n)return t.error(`Unknown expression "${r}". If you wanted a literal array, use ["literal", [...]].`,0);let a=Array.isArray(n)?n[0]:n.type,o=Array.isArray(n)?[[n[1],n[2]]]:n.overloads,s=o.filter(([u])=>!Array.isArray(u)||u.length===e.length-1),l=null;for(let[u,c]of s){l=new h9(t.registry,ym,t.path,null,t.scope);let p=[],d=!1;for(let m=1;m<e.length;m++){let g=e[m],b=Array.isArray(u)?u[m-1]:u.type,x=l.parse(g,1+p.length,b);if(!x){d=!0;break}p.push(x)}if(!d){if(Array.isArray(u)&&u.length!==p.length){l.error(`Expected ${u.length} arguments, but found ${p.length} instead.`);continue}for(let m=0;m<p.length;m++){let g=Array.isArray(u)?u[m]:u.type,b=p[m];l.concat(m+1).checkSubtype(g,b.type)}if(l.errors.length===0)return new Hd(r,a,c,p)}}if(s.length===1)t.errors.push(...l.errors);else{let u=(s.length?s:o).map(([p])=>UD(p)).join(" | "),c=[];for(let p=1;p<e.length;p++){let d=t.parse(e[p],1+c.length);if(!d)return null;c.push(zi(d.type))}t.error(`Expected arguments of type ${u}, but found (${c.join(", ")}) instead.`)}return null}static register(e,t){Hd.definitions=t;for(let r in t)e[r]=Hd}};h(ND,"CompoundExpression");var hh=ND;function fw(i,[e,t,r,n]){e=e.evaluate(i),t=t.evaluate(i),r=r.evaluate(i);let a=n?n.evaluate(i):1,o=WC(e,t,r,a);if(o)throw new _r(o);return new zt(e/255,t/255,r/255,a,!1)}h(fw,"rgba");function mw(i,e){return i in e}h(mw,"has");function ay(i,e){let t=e[i];return typeof t>"u"?null:t}h(ay,"get");function $D(i,e,t,r){for(;t<=r;){let n=t+r>>1;if(e[n]===i)return!0;e[n]>i?r=n-1:t=n+1}return!1}h($D,"binarySearch");function Zs(i){return{type:i}}h(Zs,"varargs");hh.register(ap,{error:[Rae,[Kt],(i,[e])=>{throw new _r(e.evaluate(i))}],typeof:[Kt,[qt],(i,[e])=>zi(xr(e.evaluate(i)))],"to-rgba":[Nn(it,4),[go],(i,[e])=>{let[t,r,n,a]=e.evaluate(i).rgb;return[t*255,r*255,n*255,a]}],rgb:[go,[it,it,it],fw],rgba:[go,[it,it,it,it],fw],has:{type:Xt,overloads:[[[Kt],(i,[e])=>mw(e.evaluate(i),i.properties())],[[Kt,ip],(i,[e,t])=>mw(e.evaluate(i),t.evaluate(i))]]},get:{type:qt,overloads:[[[Kt],(i,[e])=>ay(e.evaluate(i),i.properties())],[[Kt,ip],(i,[e,t])=>ay(e.evaluate(i),t.evaluate(i))]]},"feature-state":[qt,[Kt],(i,[e])=>ay(e.evaluate(i),i.featureState||{})],properties:[ip,[],i=>i.properties()],"geometry-type":[Kt,[],i=>i.geometryType()],id:[qt,[],i=>i.id()],zoom:[it,[],i=>i.globals.zoom],"heatmap-density":[it,[],i=>i.globals.heatmapDensity||0],"line-progress":[it,[],i=>i.globals.lineProgress||0],accumulated:[qt,[],i=>i.globals.accumulated===void 0?null:i.globals.accumulated],"+":[it,Zs(it),(i,e)=>{let t=0;for(let r of e)t+=r.evaluate(i);return t}],"*":[it,Zs(it),(i,e)=>{let t=1;for(let r of e)t*=r.evaluate(i);return t}],"-":{type:it,overloads:[[[it,it],(i,[e,t])=>e.evaluate(i)-t.evaluate(i)],[[it],(i,[e])=>-e.evaluate(i)]]},"/":[it,[it,it],(i,[e,t])=>e.evaluate(i)/t.evaluate(i)],"%":[it,[it,it],(i,[e,t])=>e.evaluate(i)%t.evaluate(i)],ln2:[it,[],()=>Math.LN2],pi:[it,[],()=>Math.PI],e:[it,[],()=>Math.E],"^":[it,[it,it],(i,[e,t])=>Math.pow(e.evaluate(i),t.evaluate(i))],sqrt:[it,[it],(i,[e])=>Math.sqrt(e.evaluate(i))],log10:[it,[it],(i,[e])=>Math.log(e.evaluate(i))/Math.LN10],ln:[it,[it],(i,[e])=>Math.log(e.evaluate(i))],log2:[it,[it],(i,[e])=>Math.log(e.evaluate(i))/Math.LN2],sin:[it,[it],(i,[e])=>Math.sin(e.evaluate(i))],cos:[it,[it],(i,[e])=>Math.cos(e.evaluate(i))],tan:[it,[it],(i,[e])=>Math.tan(e.evaluate(i))],asin:[it,[it],(i,[e])=>Math.asin(e.evaluate(i))],acos:[it,[it],(i,[e])=>Math.acos(e.evaluate(i))],atan:[it,[it],(i,[e])=>Math.atan(e.evaluate(i))],min:[it,Zs(it),(i,e)=>Math.min(...e.map(t=>t.evaluate(i)))],max:[it,Zs(it),(i,e)=>Math.max(...e.map(t=>t.evaluate(i)))],abs:[it,[it],(i,[e])=>Math.abs(e.evaluate(i))],round:[it,[it],(i,[e])=>{let t=e.evaluate(i);return t<0?-Math.round(-t):Math.round(t)}],floor:[it,[it],(i,[e])=>Math.floor(e.evaluate(i))],ceil:[it,[it],(i,[e])=>Math.ceil(e.evaluate(i))],"filter-==":[Xt,[Kt,qt],(i,[e,t])=>i.properties()[e.value]===t.value],"filter-id-==":[Xt,[qt],(i,[e])=>i.id()===e.value],"filter-type-==":[Xt,[Kt],(i,[e])=>i.geometryType()===e.value],"filter-<":[Xt,[Kt,qt],(i,[e,t])=>{let r=i.properties()[e.value],n=t.value;return typeof r==typeof n&&r<n}],"filter-id-<":[Xt,[qt],(i,[e])=>{let t=i.id(),r=e.value;return typeof t==typeof r&&t<r}],"filter->":[Xt,[Kt,qt],(i,[e,t])=>{let r=i.properties()[e.value],n=t.value;return typeof r==typeof n&&r>n}],"filter-id->":[Xt,[qt],(i,[e])=>{let t=i.id(),r=e.value;return typeof t==typeof r&&t>r}],"filter-<=":[Xt,[Kt,qt],(i,[e,t])=>{let r=i.properties()[e.value],n=t.value;return typeof r==typeof n&&r<=n}],"filter-id-<=":[Xt,[qt],(i,[e])=>{let t=i.id(),r=e.value;return typeof t==typeof r&&t<=r}],"filter->=":[Xt,[Kt,qt],(i,[e,t])=>{let r=i.properties()[e.value],n=t.value;return typeof r==typeof n&&r>=n}],"filter-id->=":[Xt,[qt],(i,[e])=>{let t=i.id(),r=e.value;return typeof t==typeof r&&t>=r}],"filter-has":[Xt,[qt],(i,[e])=>e.value in i.properties()],"filter-has-id":[Xt,[],i=>i.id()!==null&&i.id()!==void 0],"filter-type-in":[Xt,[Nn(Kt)],(i,[e])=>e.value.indexOf(i.geometryType())>=0],"filter-id-in":[Xt,[Nn(qt)],(i,[e])=>e.value.indexOf(i.id())>=0],"filter-in-small":[Xt,[Kt,Nn(qt)],(i,[e,t])=>t.value.indexOf(i.properties()[e.value])>=0],"filter-in-large":[Xt,[Kt,Nn(qt)],(i,[e,t])=>$D(i.properties()[e.value],t.value,0,t.value.length-1)],all:{type:Xt,overloads:[[[Xt,Xt],(i,[e,t])=>e.evaluate(i)&&t.evaluate(i)],[Zs(Xt),(i,e)=>{for(let t of e)if(!t.evaluate(i))return!1;return!0}]]},any:{type:Xt,overloads:[[[Xt,Xt],(i,[e,t])=>e.evaluate(i)||t.evaluate(i)],[Zs(Xt),(i,e)=>{for(let t of e)if(t.evaluate(i))return!0;return!1}]]},"!":[Xt,[Xt],(i,[e])=>!e.evaluate(i)],"is-supported-script":[Xt,[Kt],(i,[e])=>{let t=i.globals&&i.globals.isSupportedScript;return t?t(e.evaluate(i)):!0}],upcase:[Kt,[Kt],(i,[e])=>e.evaluate(i).toUpperCase()],downcase:[Kt,[Kt],(i,[e])=>e.evaluate(i).toLowerCase()],concat:[Kt,Zs(qt),(i,e)=>e.map(t=>np(t.evaluate(i))).join("")],"resolved-locale":[Kt,[nx],(i,[e])=>e.evaluate(i).resolvedLocale()]});function UD(i){return Array.isArray(i)?`(${i.map(zi).join(", ")})`:`(${zi(i.type)}...)`}h(UD,"stringifySignature");function ym(i){if(i instanceof g9)return ym(i.boundExpression);if(i instanceof hh&&i.name==="error"||i instanceof Y9||i instanceof QC||i instanceof r4)return!1;let e=i instanceof Vc||i instanceof xs,t=!0;return i.eachChild(r=>{e?t=t&&ym(r):t=t&&r instanceof pm}),t?Gm(i)&&Wm(i,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"]):!1}h(ym,"isExpressionConstant");function Gm(i){if(i instanceof hh&&(i.name==="get"&&i.args.length===1||i.name==="feature-state"||i.name==="has"&&i.args.length===1||i.name==="properties"||i.name==="geometry-type"||i.name==="id"||/^filter-/.test(i.name))||i instanceof QC||i instanceof r4)return!1;let e=!0;return i.eachChild(t=>{e&&!Gm(t)&&(e=!1)}),e}h(Gm,"isFeatureConstant");function kp(i){if(i instanceof hh&&i.name==="feature-state")return!1;let e=!0;return i.eachChild(t=>{e&&!kp(t)&&(e=!1)}),e}h(kp,"isStateConstant");function Wm(i,e){if(i instanceof hh&&e.indexOf(i.name)>=0)return!1;let t=!0;return i.eachChild(r=>{t&&!Wm(r,e)&&(t=!1)}),t}h(Wm,"isGlobalPropertyConstant");function tv(i){return{result:"success",value:i}}h(tv,"success");function _u(i){return{result:"error",value:i}}h(_u,"error");function Zu(i){return i["property-type"]==="data-driven"||i["property-type"]==="cross-faded-data-driven"}h(Zu,"supportsPropertyExpression");function n4(i){return!!i.expression&&i.expression.parameters.indexOf("zoom")>-1}h(n4,"supportsZoomExpression");function px(i){return!!i.expression&&i.expression.interpolated}h(px,"supportsInterpolation");function ui(i){return i instanceof Number?"number":i instanceof String?"string":i instanceof Boolean?"boolean":Array.isArray(i)?"array":i===null?"null":typeof i}h(ui,"getType");function Xm(i){return typeof i=="object"&&i!==null&&!Array.isArray(i)}h(Xm,"isFunction$1");function VD(i){return i}h(VD,"identityFunction");function a4(i,e){let t=e.type==="color",r=i.stops&&typeof i.stops[0][0]=="object",n=r||i.property!==void 0,a=r||!n,o=i.type||(px(e)?"exponential":"interval");if(t||e.type==="padding"){let c=t?zt.parse:Fs.parse;i=qu({},i),i.stops&&(i.stops=i.stops.map(p=>[p[0],c(p[1])])),i.default?i.default=c(i.default):i.default=c(e.default)}if(i.colorSpace&&!I9(i.colorSpace))throw new Error(`Unknown color space: "${i.colorSpace}"`);let s,l,u;if(o==="exponential")s=gw;else if(o==="interval")s=HD;else if(o==="categorical"){s=jD,l=Object.create(null);for(let c of i.stops)l[c[0]]=c[1];u=typeof i.stops[0][0]}else if(o==="identity")s=GD;else throw new Error(`Unknown function type "${o}"`);if(r){let c={},p=[];for(let g=0;g<i.stops.length;g++){let b=i.stops[g],x=b[0].zoom;c[x]===void 0&&(c[x]={zoom:x,type:i.type,property:i.property,default:i.default,stops:[]},p.push(x)),c[x].stops.push([b[0].value,b[1]])}let d=[];for(let g of p)d.push([c[g].zoom,a4(c[g],e)]);let m={name:"linear"};return{kind:"composite",interpolationType:m,interpolationFactor:Vo.interpolationFactor.bind(void 0,m),zoomStops:d.map(g=>g[0]),evaluate({zoom:g},b){return gw({stops:d,base:i.base},e,g).evaluate(g,b)}}}else if(a){let c=o==="exponential"?{name:"exponential",base:i.base!==void 0?i.base:1}:null;return{kind:"camera",interpolationType:c,interpolationFactor:Vo.interpolationFactor.bind(void 0,c),zoomStops:i.stops.map(p=>p[0]),evaluate:({zoom:p})=>s(i,e,p,l,u)}}else return{kind:"source",evaluate(c,p){let d=p&&p.properties?p.properties[i.property]:void 0;return d===void 0?ed(i.default,e.default):s(i,e,d,l,u)}}}h(a4,"createFunction");function ed(i,e,t){if(i!==void 0)return i;if(e!==void 0)return e;if(t!==void 0)return t}h(ed,"coalesce$1");function jD(i,e,t,r,n){let a=typeof t===n?r[t]:void 0;return ed(a,i.default,e.default)}h(jD,"evaluateCategoricalFunction");function HD(i,e,t){if(ui(t)!=="number")return ed(i.default,e.default);let r=i.stops.length;if(r===1||t<=i.stops[0][0])return i.stops[0][1];if(t>=i.stops[r-1][0])return i.stops[r-1][1];let n=jm(i.stops.map(a=>a[0]),t);return i.stops[n][1]}h(HD,"evaluateIntervalFunction");function gw(i,e,t){let r=i.base!==void 0?i.base:1;if(ui(t)!=="number")return ed(i.default,e.default);let n=i.stops.length;if(n===1||t<=i.stops[0][0])return i.stops[0][1];if(t>=i.stops[n-1][0])return i.stops[n-1][1];let a=jm(i.stops.map(c=>c[0]),t),o=WD(t,r,i.stops[a][0],i.stops[a+1][0]),s=i.stops[a][1],l=i.stops[a+1][1],u=ji[e.type]||VD;return typeof s.evaluate=="function"?{evaluate(...c){let p=s.evaluate.apply(void 0,c),d=l.evaluate.apply(void 0,c);if(!(p===void 0||d===void 0))return u(p,d,o,i.colorSpace)}}:u(s,l,o,i.colorSpace)}h(gw,"evaluateExponentialFunction");function GD(i,e,t){switch(e.type){case"color":t=zt.parse(t);break;case"formatted":t=Ls.fromString(t.toString());break;case"resolvedImage":t=Wo.fromString(t.toString());break;case"padding":t=Fs.parse(t);break;default:ui(t)!==e.type&&(e.type!=="enum"||!e.values[t])&&(t=void 0)}return ed(t,i.default,e.default)}h(GD,"evaluateIdentityFunction");function WD(i,e,t,r){let n=r-t,a=i-t;return n===0?0:e===1?a/n:(Math.pow(e,a)-1)/(Math.pow(e,n)-1)}h(WD,"interpolationFactor");var XD=class{constructor(e,t){this.expression=e,this._warningHistory={},this._evaluator=new s9,this._defaultValue=t?tk(t):null,this._enumValues=t&&t.type==="enum"?t.values:null}evaluateWithoutErrorHandling(e,t,r,n,a,o){return this._evaluator.globals=e,this._evaluator.feature=t,this._evaluator.featureState=r,this._evaluator.canonical=n,this._evaluator.availableImages=a||null,this._evaluator.formattedSection=o,this.expression.evaluate(this._evaluator)}evaluate(e,t,r,n,a,o){this._evaluator.globals=e,this._evaluator.feature=t||null,this._evaluator.featureState=r||null,this._evaluator.canonical=n,this._evaluator.availableImages=a||null,this._evaluator.formattedSection=o||null;try{let s=this.expression.evaluate(this._evaluator);if(s==null||typeof s=="number"&&s!==s)return this._defaultValue;if(this._enumValues&&!(s in this._enumValues))throw new _r(`Expected value to be one of ${Object.keys(this._enumValues).map(l=>JSON.stringify(l)).join(", ")}, but found ${JSON.stringify(s)} instead.`);return s}catch(s){return this._warningHistory[s.message]||(this._warningHistory[s.message]=!0,typeof console<"u"&&console.warn(s.message)),this._defaultValue}}};h(XD,"StyleExpression");var o4=XD;function td(i){return Array.isArray(i)&&i.length>0&&typeof i[0]=="string"&&i[0]in ap}h(td,"isExpression");function dx(i,e){let t=new h9(ap,ym,[],e?ek(e):void 0),r=t.parse(i,void 0,void 0,void 0,e&&e.type==="string"?{typeAnnotation:"coerce"}:void 0);return r?tv(new o4(r,e)):_u(t.errors)}h(dx,"createExpression");var qD=class{constructor(e,t){this.kind=e,this._styleExpression=t,this.isStateDependent=e!=="constant"&&!kp(t.expression)}evaluateWithoutErrorHandling(e,t,r,n,a,o){return this._styleExpression.evaluateWithoutErrorHandling(e,t,r,n,a,o)}evaluate(e,t,r,n,a,o){return this._styleExpression.evaluate(e,t,r,n,a,o)}};h(qD,"ZoomConstantExpression");var iv=qD,ZD=class{constructor(e,t,r,n){this.kind=e,this.zoomStops=r,this._styleExpression=t,this.isStateDependent=e!=="camera"&&!kp(t.expression),this.interpolationType=n}evaluateWithoutErrorHandling(e,t,r,n,a,o){return this._styleExpression.evaluateWithoutErrorHandling(e,t,r,n,a,o)}evaluate(e,t,r,n,a,o){return this._styleExpression.evaluate(e,t,r,n,a,o)}interpolationFactor(e,t,r){return this.interpolationType?Vo.interpolationFactor(this.interpolationType,e,t,r):0}};h(ZD,"ZoomDependentExpression");var rv=ZD;function s4(i,e){let t=dx(i,e);if(t.result==="error")return t;let r=t.value.expression,n=Gm(r);if(!n&&!Zu(e))return _u([new Bo("","data expressions not supported")]);let a=Wm(r,["zoom"]);if(!a&&!n4(e))return _u([new Bo("","zoom expressions not supported")]);let o=Hf(r);if(!o&&!a)return _u([new Bo("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')]);if(o instanceof Bo)return _u([o]);if(o instanceof Vo&&!px(e))return _u([new Bo("",'"interpolate" expressions cannot be used with this property')]);if(!o)return tv(n?new iv("constant",t.value):new iv("source",t.value));let s=o instanceof Vo?o.interpolation:void 0;return tv(n?new rv("camera",t.value,o.labels,s):new rv("composite",t.value,o.labels,s))}h(s4,"createPropertyExpression");var YD=class JD{constructor(e,t){this._parameters=e,this._specification=t,qu(this,a4(this._parameters,this._specification))}static deserialize(e){return new JD(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}};h(YD,"StylePropertyFunction");var KD=YD;function QD(i,e){if(Xm(i))return new KD(i,e);if(td(i)){let t=s4(i,e);if(t.result==="error")throw new Error(t.value.map(r=>`${r.key}: ${r.message}`).join(", "));return t.value}else{let t=i;return e.type==="color"&&typeof i=="string"?t=zt.parse(i):e.type==="padding"&&(typeof i=="number"||Array.isArray(i))?t=Fs.parse(i):e.type==="variableAnchorOffsetCollection"&&Array.isArray(i)&&(t=sh.parse(i)),{kind:"constant",evaluate:()=>t}}}h(QD,"normalizePropertyExpression");function Hf(i){let e=null;if(i instanceof d9)e=Hf(i.result);else if(i instanceof z9){for(let t of i.args)if(e=Hf(t),e)break}else(i instanceof XC||i instanceof Vo)&&i.input instanceof hh&&i.input.name==="zoom"&&(e=i);return e instanceof Bo||i.eachChild(t=>{let r=Hf(t);r instanceof Bo?e=r:!e&&r?e=new Bo("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&r&&e!==r&&(e=new Bo("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),e}h(Hf,"findZoomCurve");function ek(i){let e={color:go,string:Kt,number:it,enum:Kt,boolean:Xt,formatted:Um,padding:ax,resolvedImage:Vm,variableAnchorOffsetCollection:ox};return i.type==="array"?Nn(e[i.value]||qt,i.length):e[i.type]}h(ek,"getExpectedType");function tk(i){return i.type==="color"&&Xm(i.default)?new zt(0,0,0,0):i.type==="color"?zt.parse(i.default)||null:i.type==="padding"?Fs.parse(i.default)||null:i.type==="variableAnchorOffsetCollection"?sh.parse(i.default)||null:i.default===void 0?null:i.default}h(tk,"getDefaultValue");function fx(i){if(i===!0||i===!1)return!0;if(!Array.isArray(i)||i.length===0)return!1;switch(i[0]){case"has":return i.length>=2&&i[1]!=="$id"&&i[1]!=="$type";case"in":return i.length>=3&&(typeof i[1]!="string"||Array.isArray(i[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return i.length!==3||Array.isArray(i[1])||Array.isArray(i[2]);case"any":case"all":for(let e of i.slice(1))if(!fx(e)&&typeof e!="boolean")return!1;return!0;default:return!0}}h(fx,"isExpressionFilter");var ooe={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function nv(i){if(i==null)return{filter:()=>!0,needGeometry:!1};fx(i)||(i=vm(i));let e=dx(i,ooe);if(e.result==="error")throw new Error(e.value.map(t=>`${t.key}: ${t.message}`).join(", "));{let t=l4(i);return{filter:(r,n,a)=>e.value.evaluate(r,n,{},a),needGeometry:t}}}h(nv,"createFilter");function ik(i,e){return i<e?-1:i>e?1:0}h(ik,"compare");function l4(i){if(!Array.isArray(i))return!1;if(i[0]==="within"||i[0]==="distance")return!0;for(let e=1;e<i.length;e++)if(l4(i[e]))return!0;return!1}h(l4,"geometryNeeded");function vm(i){if(!i)return!0;let e=i[0];return i.length<=1?e!=="any":e==="=="?oy(i[1],i[2],"=="):e==="!="?Gd(oy(i[1],i[2],"==")):e==="<"||e===">"||e==="<="||e===">="?oy(i[1],i[2],e):e==="any"?rk(i.slice(1)):e==="all"?["all"].concat(i.slice(1).map(vm)):e==="none"?["all"].concat(i.slice(1).map(vm).map(Gd)):e==="in"?yw(i[1],i.slice(2)):e==="!in"?Gd(yw(i[1],i.slice(2))):e==="has"?vw(i[1]):e==="!has"?Gd(vw(i[1])):!0}h(vm,"convertFilter$1");function oy(i,e,t){switch(i){case"$type":return[`filter-type-${t}`,e];case"$id":return[`filter-id-${t}`,e];default:return[`filter-${t}`,i,e]}}h(oy,"convertComparisonOp$1");function rk(i){return["any"].concat(i.map(vm))}h(rk,"convertDisjunctionOp");function yw(i,e){if(e.length===0)return!1;switch(i){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(t=>typeof t!=typeof e[0])?["filter-in-large",i,["literal",e.sort(ik)]]:["filter-in-small",i,["literal",e]]}}h(yw,"convertInOp$1");function vw(i){switch(i){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",i]}}h(vw,"convertHasOp$1");function Gd(i){return["!",i]}h(Gd,"convertNegation");function nk(){let i={},e=Le.$version;for(let t in Le.$root){let r=Le.$root[t];if(r.required){let n=null;t==="version"?n=e:r.type==="array"?n=[]:n={},n!=null&&(i[t]=n)}}return i}h(nk,"emptyStyle");function u4(i){let e=i.key,t=i.value;return t?[new Je(e,t,"constants have been deprecated as of v8")]:[]}h(u4,"validateConstants");function Ki(i){return i instanceof Number||i instanceof String||i instanceof Boolean?i.valueOf():i}h(Ki,"unbundle");function Rl(i){if(Array.isArray(i))return i.map(Rl);if(i instanceof Object&&!(i instanceof Number||i instanceof String||i instanceof Boolean)){let e={};for(let t in i)e[t]=Rl(i[t]);return e}return Ki(i)}h(Rl,"deepUnbundle");function sa(i){let e=i.key,t=i.value,r=i.valueSpec||{},n=i.objectElementValidators||{},a=i.style,o=i.styleSpec,s=i.validateSpec,l=[],u=ui(t);if(u!=="object")return[new Je(e,t,`object expected, ${u} found`)];for(let c in t){let p=c.split(".")[0],d=r[p]||r["*"],m;if(n[p])m=n[p];else if(r[p])m=s;else if(n["*"])m=n["*"];else if(r["*"])m=s;else{l.push(new Je(e,t[c],`unknown property "${c}"`));continue}l=l.concat(m({key:(e&&`${e}.`)+c,value:t[c],valueSpec:d,style:a,styleSpec:o,object:t,objectKey:c,validateSpec:s},t))}for(let c in r)n[c]||r[c].required&&r[c].default===void 0&&t[c]===void 0&&l.push(new Je(e,t,`missing required property "${c}"`));return l}h(sa,"validateObject");function mx(i){let e=i.value,t=i.valueSpec,r=i.validateSpec,n=i.style,a=i.styleSpec,o=i.key,s=i.arrayElementValidator||r;if(ui(e)!=="array")return[new Je(o,e,`array expected, ${ui(e)} found`)];if(t.length&&e.length!==t.length)return[new Je(o,e,`array length ${t.length} expected, length ${e.length} found`)];if(t["min-length"]&&e.length<t["min-length"])return[new Je(o,e,`array length at least ${t["min-length"]} expected, length ${e.length} found`)];let l={type:t.value,values:t.values};a.$version<7&&(l.function=t.function),ui(t.value)==="object"&&(l=t.value);let u=[];for(let c=0;c<e.length;c++)u=u.concat(s({array:e,arrayIndex:c,value:e[c],valueSpec:l,validateSpec:i.validateSpec,style:n,styleSpec:a,key:`${o}[${c}]`}));return u}h(mx,"validateArray");function gx(i){let e=i.key,t=i.value,r=i.valueSpec,n=ui(t);return n==="number"&&t!==t&&(n="NaN"),n!=="number"?[new Je(e,t,`number expected, ${n} found`)]:"minimum"in r&&t<r.minimum?[new Je(e,t,`${t} is less than the minimum value ${r.minimum}`)]:"maximum"in r&&t>r.maximum?[new Je(e,t,`${t} is greater than the maximum value ${r.maximum}`)]:[]}h(gx,"validateNumber");function h4(i){let e=i.valueSpec,t=Ki(i.value.type),r,n={},a,o,s=t!=="categorical"&&i.value.property===void 0,l=!s,u=ui(i.value.stops)==="array"&&ui(i.value.stops[0])==="array"&&ui(i.value.stops[0][0])==="object",c=sa({key:i.key,value:i.value,valueSpec:i.styleSpec.function,validateSpec:i.validateSpec,style:i.style,styleSpec:i.styleSpec,objectElementValidators:{stops:p,default:g}});return t==="identity"&&s&&c.push(new Je(i.key,i.value,'missing required property "property"')),t!=="identity"&&!i.value.stops&&c.push(new Je(i.key,i.value,'missing required property "stops"')),t==="exponential"&&i.valueSpec.expression&&!px(i.valueSpec)&&c.push(new Je(i.key,i.value,"exponential functions not supported")),i.styleSpec.$version>=8&&(l&&!Zu(i.valueSpec)?c.push(new Je(i.key,i.value,"property functions not supported")):s&&!n4(i.valueSpec)&&c.push(new Je(i.key,i.value,"zoom functions not supported"))),(t==="categorical"||u)&&i.value.property===void 0&&c.push(new Je(i.key,i.value,'"property" property is required')),c;function p(b){if(t==="identity")return[new Je(b.key,b.value,'identity function may not have a "stops" property')];let x=[],v=b.value;return x=x.concat(mx({key:b.key,value:v,valueSpec:b.valueSpec,validateSpec:b.validateSpec,style:b.style,styleSpec:b.styleSpec,arrayElementValidator:d})),ui(v)==="array"&&v.length===0&&x.push(new Je(b.key,v,"array must have at least one stop")),x}function d(b){let x=[],v=b.value,w=b.key;if(ui(v)!=="array")return[new Je(w,v,`array expected, ${ui(v)} found`)];if(v.length!==2)return[new Je(w,v,`array length 2 expected, length ${v.length} found`)];if(u){if(ui(v[0])!=="object")return[new Je(w,v,`object expected, ${ui(v[0])} found`)];if(v[0].zoom===void 0)return[new Je(w,v,"object stop key must have zoom")];if(v[0].value===void 0)return[new Je(w,v,"object stop key must have value")];if(o&&o>Ki(v[0].zoom))return[new Je(w,v[0].zoom,"stop zoom values must appear in ascending order")];Ki(v[0].zoom)!==o&&(o=Ki(v[0].zoom),a=void 0,n={}),x=x.concat(sa({key:`${w}[0]`,value:v[0],valueSpec:{zoom:{}},validateSpec:b.validateSpec,style:b.style,styleSpec:b.styleSpec,objectElementValidators:{zoom:gx,value:m}}))}else x=x.concat(m({key:`${w}[0]`,value:v[0],valueSpec:{},validateSpec:b.validateSpec,style:b.style,styleSpec:b.styleSpec},v));return td(Rl(v[1]))?x.concat([new Je(`${w}[1]`,v[1],"expressions are not allowed in function stops.")]):x.concat(b.validateSpec({key:`${w}[1]`,value:v[1],valueSpec:e,validateSpec:b.validateSpec,style:b.style,styleSpec:b.styleSpec}))}function m(b,x){let v=ui(b.value),w=Ki(b.value),_=b.value!==null?b.value:x;if(!r)r=v;else if(v!==r)return[new Je(b.key,_,`${v} stop domain type must match previous stop domain type ${r}`)];if(v!=="number"&&v!=="string"&&v!=="boolean")return[new Je(b.key,_,"stop domain value must be a number, string, or boolean")];if(v!=="number"&&t!=="categorical"){let C=`number expected, ${v} found`;return Zu(e)&&t===void 0&&(C+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Je(b.key,_,C)]}return t==="categorical"&&v==="number"&&(!isFinite(w)||Math.floor(w)!==w)?[new Je(b.key,_,`integer expected, found ${w}`)]:t!=="categorical"&&v==="number"&&a!==void 0&&w<a?[new Je(b.key,_,"stop domain values must appear in ascending order")]:(a=w,t==="categorical"&&w in n?[new Je(b.key,_,"stop domain values must be unique")]:(n[w]=!0,[]))}function g(b){return b.validateSpec({key:b.key,value:b.value,valueSpec:e,validateSpec:b.validateSpec,style:b.style,styleSpec:b.styleSpec})}}h(h4,"validateFunction");function Yu(i){let e=(i.expressionContext==="property"?s4:dx)(Rl(i.value),i.valueSpec);if(e.result==="error")return e.value.map(r=>new Je(`${i.key}${r.key}`,i.value,r.message));let t=e.value.expression||e.value._styleExpression.expression;if(i.expressionContext==="property"&&i.propertyKey==="text-font"&&!t.outputDefined())return[new Je(i.key,i.value,`Invalid data expression for "${i.propertyKey}". Output values must be contained as literals within the expression.`)];if(i.expressionContext==="property"&&i.propertyType==="layout"&&!kp(t))return[new Je(i.key,i.value,'"feature-state" data expressions are not supported with layout properties.')];if(i.expressionContext==="filter"&&!kp(t))return[new Je(i.key,i.value,'"feature-state" data expressions are not supported with filters.')];if(i.expressionContext&&i.expressionContext.indexOf("cluster")===0){if(!Wm(t,["zoom","feature-state"]))return[new Je(i.key,i.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(i.expressionContext==="cluster-initial"&&!Gm(t))return[new Je(i.key,i.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}h(Yu,"validateExpression");function ak(i){let e=i.value,t=i.key,r=ui(e);return r!=="boolean"?[new Je(t,e,`boolean expected, ${r} found`)]:[]}h(ak,"validateBoolean");function ok(i){let e=i.key,t=i.value,r=ui(t);return r!=="string"?[new Je(e,t,`color expected, ${r} found`)]:zt.parse(String(t))?[]:[new Je(e,t,`color expected, "${t}" found`)]}h(ok,"validateColor");function Rp(i){let e=i.key,t=i.value,r=i.valueSpec,n=[];return Array.isArray(r.values)?r.values.indexOf(Ki(t))===-1&&n.push(new Je(e,t,`expected one of [${r.values.join(", ")}], ${JSON.stringify(t)} found`)):Object.keys(r.values).indexOf(Ki(t))===-1&&n.push(new Je(e,t,`expected one of [${Object.keys(r.values).join(", ")}], ${JSON.stringify(t)} found`)),n}h(Rp,"validateEnum");function yx(i){return fx(Rl(i.value))?Yu(qu({},i,{expressionContext:"filter",valueSpec:{value:"boolean"}})):c4(i)}h(yx,"validateFilter");function c4(i){let e=i.value,t=i.key;if(ui(e)!=="array")return[new Je(t,e,`array expected, ${ui(e)} found`)];let r=i.styleSpec,n,a=[];if(e.length<1)return[new Je(t,e,"filter array must have at least 1 element")];switch(a=a.concat(Rp({key:`${t}[0]`,value:e[0],valueSpec:r.filter_operator,style:i.style,styleSpec:i.styleSpec})),Ki(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&Ki(e[1])==="$type"&&a.push(new Je(t,e,`"$type" cannot be use with operator "${e[0]}"`));case"==":case"!=":e.length!==3&&a.push(new Je(t,e,`filter array for operator "${e[0]}" must have 3 elements`));case"in":case"!in":e.length>=2&&(n=ui(e[1]),n!=="string"&&a.push(new Je(`${t}[1]`,e[1],`string expected, ${n} found`)));for(let o=2;o<e.length;o++)n=ui(e[o]),Ki(e[1])==="$type"?a=a.concat(Rp({key:`${t}[${o}]`,value:e[o],valueSpec:r.geometry_type,style:i.style,styleSpec:i.styleSpec})):n!=="string"&&n!=="number"&&n!=="boolean"&&a.push(new Je(`${t}[${o}]`,e[o],`string, number, or boolean expected, ${n} found`));break;case"any":case"all":case"none":for(let o=1;o<e.length;o++)a=a.concat(c4({key:`${t}[${o}]`,value:e[o],style:i.style,styleSpec:i.styleSpec}));break;case"has":case"!has":n=ui(e[1]),e.length!==2?a.push(new Je(t,e,`filter array for "${e[0]}" operator must have 2 elements`)):n!=="string"&&a.push(new Je(`${t}[1]`,e[1],`string expected, ${n} found`));break}return a}h(c4,"validateNonExpressionFilter");function p4(i,e){let t=i.key,r=i.validateSpec,n=i.style,a=i.styleSpec,o=i.value,s=i.objectKey,l=a[`${e}_${i.layerType}`];if(!l)return[];let u=s.match(/^(.*)-transition$/);if(e==="paint"&&u&&l[u[1]]&&l[u[1]].transition)return r({key:t,value:o,valueSpec:a.transition,style:n,styleSpec:a});let c=i.valueSpec||l[s];if(!c)return[new Je(t,o,`unknown property "${s}"`)];let p;if(ui(o)==="string"&&Zu(c)&&!c.tokens&&(p=/^{([^}]+)}$/.exec(o)))return[new Je(t,o,`"${s}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(p[1])} }\`.`)];let d=[];return i.layerType==="symbol"&&(s==="text-field"&&n&&!n.glyphs&&d.push(new Je(t,o,'use of "text-field" requires a style "glyphs" property')),s==="text-font"&&Xm(Rl(o))&&Ki(o.type)==="identity"&&d.push(new Je(t,o,'"text-font" does not support identity functions'))),d.concat(r({key:i.key,value:o,valueSpec:c,style:n,styleSpec:a,expressionContext:"property",propertyType:e,propertyKey:s}))}h(p4,"validateProperty");function d4(i){return p4(i,"paint")}h(d4,"validatePaintProperty");function f4(i){return p4(i,"layout")}h(f4,"validateLayoutProperty");function m4(i){let e=[],t=i.value,r=i.key,n=i.style,a=i.styleSpec;!t.type&&!t.ref&&e.push(new Je(r,t,'either "type" or "ref" is required'));let o=Ki(t.type),s=Ki(t.ref);if(t.id){let l=Ki(t.id);for(let u=0;u<i.arrayIndex;u++){let c=n.layers[u];Ki(c.id)===l&&e.push(new Je(r,t.id,`duplicate layer id "${t.id}", previously used at line ${c.id.__line__}`))}}if("ref"in t){["type","source","source-layer","filter","layout"].forEach(u=>{u in t&&e.push(new Je(r,t[u],`"${u}" is prohibited for ref layers`))});let l;n.layers.forEach(u=>{Ki(u.id)===s&&(l=u)}),l?l.ref?e.push(new Je(r,t.ref,"ref cannot reference another ref layer")):o=Ki(l.type):e.push(new Je(r,t.ref,`ref layer "${s}" not found`))}else if(o!=="background")if(!t.source)e.push(new Je(r,t,'missing required property "source"'));else{let l=n.sources&&n.sources[t.source],u=l&&Ki(l.type);l?u==="vector"&&o==="raster"?e.push(new Je(r,t.source,`layer "${t.id}" requires a raster source`)):u!=="raster-dem"&&o==="hillshade"?e.push(new Je(r,t.source,`layer "${t.id}" requires a raster-dem source`)):u==="raster"&&o!=="raster"?e.push(new Je(r,t.source,`layer "${t.id}" requires a vector source`)):u==="vector"&&!t["source-layer"]?e.push(new Je(r,t,`layer "${t.id}" must specify a "source-layer"`)):u==="raster-dem"&&o!=="hillshade"?e.push(new Je(r,t.source,"raster-dem source can only be used with layer type 'hillshade'.")):o==="line"&&t.paint&&t.paint["line-gradient"]&&(u!=="geojson"||!l.lineMetrics)&&e.push(new Je(r,t,`layer "${t.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):e.push(new Je(r,t.source,`source "${t.source}" not found`))}return e=e.concat(sa({key:r,value:t,valueSpec:a.layer,style:i.style,styleSpec:i.styleSpec,validateSpec:i.validateSpec,objectElementValidators:{"*"(){return[]},type(){return i.validateSpec({key:`${r}.type`,value:t.type,valueSpec:a.layer.type,style:i.style,styleSpec:i.styleSpec,validateSpec:i.validateSpec,object:t,objectKey:"type"})},filter:yx,layout(l){return sa({layer:t,key:l.key,value:l.value,style:l.style,styleSpec:l.styleSpec,validateSpec:l.validateSpec,objectElementValidators:{"*"(u){return f4(qu({layerType:o},u))}}})},paint(l){return sa({layer:t,key:l.key,value:l.value,style:l.style,styleSpec:l.styleSpec,validateSpec:l.validateSpec,objectElementValidators:{"*"(u){return d4(qu({layerType:o},u))}}})}}})),e}h(m4,"validateLayer");function Fl(i){let e=i.value,t=i.key,r=ui(e);return r!=="string"?[new Je(t,e,`string expected, ${r} found`)]:[]}h(Fl,"validateString");function sk(i){var e;let t=(e=i.sourceName)!==null&&e!==void 0?e:"",r=i.value,n=i.styleSpec,a=n.source_raster_dem,o=i.style,s=[],l=ui(r);if(r===void 0)return s;if(l!=="object")return s.push(new Je("source_raster_dem",r,`object expected, ${l} found`)),s;let u=Ki(r.encoding)==="custom",c=["redFactor","greenFactor","blueFactor","baseShift"],p=i.value.encoding?`"${i.value.encoding}"`:"Default";for(let d in r)!u&&c.includes(d)?s.push(new Je(d,r[d],`In "${t}": "${d}" is only valid when "encoding" is set to "custom". ${p} encoding found`)):a[d]?s=s.concat(i.validateSpec({key:d,value:r[d],valueSpec:a[d],validateSpec:i.validateSpec,style:o,styleSpec:n})):s.push(new Je(d,r[d],`unknown property "${d}"`));return s}h(sk,"validateRasterDEMSource");var IP={promoteId:lk};function g4(i){let e=i.value,t=i.key,r=i.styleSpec,n=i.style,a=i.validateSpec;if(!e.type)return[new Je(t,e,'"type" is required')];let o=Ki(e.type),s;switch(o){case"vector":case"raster":return s=sa({key:t,value:e,valueSpec:r[`source_${o.replace("-","_")}`],style:i.style,styleSpec:r,objectElementValidators:IP,validateSpec:a}),s;case"raster-dem":return s=sk({sourceName:t,value:e,style:i.style,styleSpec:r,validateSpec:a}),s;case"geojson":if(s=sa({key:t,value:e,valueSpec:r.source_geojson,style:n,styleSpec:r,validateSpec:a,objectElementValidators:IP}),e.cluster)for(let l in e.clusterProperties){let[u,c]=e.clusterProperties[l],p=typeof u=="string"?[u,["accumulated"],["get",l]]:u;s.push(...Yu({key:`${t}.${l}.map`,value:c,validateSpec:a,expressionContext:"cluster-map"})),s.push(...Yu({key:`${t}.${l}.reduce`,value:p,validateSpec:a,expressionContext:"cluster-reduce"}))}return s;case"video":return sa({key:t,value:e,valueSpec:r.source_video,style:n,validateSpec:a,styleSpec:r});case"image":return sa({key:t,value:e,valueSpec:r.source_image,style:n,validateSpec:a,styleSpec:r});case"canvas":return[new Je(t,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Rp({key:`${t}.type`,value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:n,validateSpec:a,styleSpec:r})}}h(g4,"validateSource");function lk({key:i,value:e}){if(ui(e)==="string")return Fl({key:i,value:e});{let t=[];for(let r in e)t.push(...Fl({key:`${i}.${r}`,value:e[r]}));return t}}h(lk,"validatePromoteId");function y4(i){let e=i.value,t=i.styleSpec,r=t.light,n=i.style,a=[],o=ui(e);if(e===void 0)return a;if(o!=="object")return a=a.concat([new Je("light",e,`object expected, ${o} found`)]),a;for(let s in e){let l=s.match(/^(.*)-transition$/);l&&r[l[1]]&&r[l[1]].transition?a=a.concat(i.validateSpec({key:s,value:e[s],valueSpec:t.transition,validateSpec:i.validateSpec,style:n,styleSpec:t})):r[s]?a=a.concat(i.validateSpec({key:s,value:e[s],valueSpec:r[s],validateSpec:i.validateSpec,style:n,styleSpec:t})):a=a.concat([new Je(s,e[s],`unknown property "${s}"`)])}return a}h(y4,"validateLight");function v4(i){let e=i.value,t=i.styleSpec,r=t.sky,n=i.style,a=ui(e);if(e===void 0)return[];if(a!=="object")return[new Je("sky",e,`object expected, ${a} found`)];let o=[];for(let s in e)r[s]?o=o.concat(i.validateSpec({key:s,value:e[s],valueSpec:r[s],style:n,styleSpec:t})):o=o.concat([new Je(s,e[s],`unknown property "${s}"`)]);return o}h(v4,"validateSky");function x4(i){let e=i.value,t=i.styleSpec,r=t.terrain,n=i.style,a=[],o=ui(e);if(e===void 0)return a;if(o!=="object")return a=a.concat([new Je("terrain",e,`object expected, ${o} found`)]),a;for(let s in e)r[s]?a=a.concat(i.validateSpec({key:s,value:e[s],valueSpec:r[s],validateSpec:i.validateSpec,style:n,styleSpec:t})):a=a.concat([new Je(s,e[s],`unknown property "${s}"`)]);return a}h(x4,"validateTerrain");function uk(i){return Fl(i).length===0?[]:Yu(i)}h(uk,"validateFormatted");function hk(i){return Fl(i).length===0?[]:Yu(i)}h(hk,"validateImage");function ck(i){let e=i.key,t=i.value;if(ui(t)==="array"){if(t.length<1||t.length>4)return[new Je(e,t,`padding requires 1 to 4 values; ${t.length} values found`)];let r={type:"number"},n=[];for(let a=0;a<t.length;a++)n=n.concat(i.validateSpec({key:`${e}[${a}]`,value:t[a],validateSpec:i.validateSpec,valueSpec:r}));return n}else return gx({key:e,value:t,valueSpec:{}})}h(ck,"validatePadding");function pk(i){let e=i.key,t=i.value,r=ui(t),n=i.styleSpec;if(r!=="array"||t.length<1||t.length%2!==0)return[new Je(e,t,"variableAnchorOffsetCollection requires a non-empty array of even length")];let a=[];for(let o=0;o<t.length;o+=2)a=a.concat(Rp({key:`${e}[${o}]`,value:t[o],valueSpec:n.layout_symbol["text-anchor"]})),a=a.concat(mx({key:`${e}[${o+1}]`,value:t[o+1],valueSpec:{length:2,value:"number"},validateSpec:i.validateSpec,style:i.style,styleSpec:n}));return a}h(pk,"validateVariableAnchorOffsetCollection");function _4(i){let e=[],t=i.value,r=i.key;if(Array.isArray(t)){let n=[],a=[];for(let o in t){t[o].id&&n.includes(t[o].id)&&e.push(new Je(r,t,`all the sprites' ids must be unique, but ${t[o].id} is duplicated`)),n.push(t[o].id),t[o].url&&a.includes(t[o].url)&&e.push(new Je(r,t,`all the sprites' URLs must be unique, but ${t[o].url} is duplicated`)),a.push(t[o].url);let s={id:{type:"string",required:!0},url:{type:"string",required:!0}};e=e.concat(sa({key:`${r}[${o}]`,value:t[o],valueSpec:s,validateSpec:i.validateSpec}))}return e}else return Fl({key:r,value:t})}h(_4,"validateSprite");function dk(i){let e=i.value,t=i.styleSpec,r=t.projection,n=i.style,a=ui(e);if(e===void 0)return[];if(a!=="object")return[new Je("projection",e,`object expected, ${a} found`)];let o=[];for(let s in e)r[s]?o=o.concat(i.validateSpec({key:s,value:e[s],valueSpec:r[s],style:n,styleSpec:t})):o=o.concat([new Je(s,e[s],`unknown property "${s}"`)]);return o}h(dk,"validateProjection");var LP={"*"(){return[]},array:mx,boolean:ak,number:gx,color:ok,constants:u4,enum:Rp,filter:yx,function:h4,layer:m4,object:sa,source:g4,light:y4,sky:v4,terrain:x4,projection:dk,string:Fl,formatted:uk,resolvedImage:hk,padding:ck,variableAnchorOffsetCollection:pk,sprite:_4};function op(i){let e=i.value,t=i.valueSpec,r=i.styleSpec;return i.validateSpec=op,t.expression&&Xm(Ki(e))?h4(i):t.expression&&td(Rl(e))?Yu(i):t.type&&LP[t.type]?LP[t.type](i):sa(qu({},i,{valueSpec:t.type?r[t.type]:t}))}h(op,"validate");function b4(i){let e=i.value,t=i.key,r=Fl(i);return r.length||(e.indexOf("{fontstack}")===-1&&r.push(new Je(t,e,'"glyphs" url must include a "{fontstack}" token')),e.indexOf("{range}")===-1&&r.push(new Je(t,e,'"glyphs" url must include a "{range}" token'))),r}h(b4,"validateGlyphsUrl");function Ua(i,e=Le){let t=[];return t=t.concat(op({key:"",value:i,valueSpec:e.$root,styleSpec:e,style:i,validateSpec:op,objectElementValidators:{glyphs:b4,"*"(){return[]}}})),i.constants&&(t=t.concat(u4({key:"constants",value:i.constants,style:i,styleSpec:e,validateSpec:op}))),w4(t)}h(Ua,"validateStyleMin");Ua.source=bo(_o(g4));Ua.sprite=bo(_o(_4));Ua.glyphs=bo(_o(b4));Ua.light=bo(_o(y4));Ua.sky=bo(_o(v4));Ua.terrain=bo(_o(x4));Ua.layer=bo(_o(m4));Ua.filter=bo(_o(yx));Ua.paintProperty=bo(_o(d4));Ua.layoutProperty=bo(_o(f4));function _o(i){return function(e){return i({...e,validateSpec:op})}}h(_o,"injectValidateSpec");function w4(i){return[].concat(i).sort((e,t)=>e.line-t.line)}h(w4,"sortErrors");function bo(i){return function(...e){return w4(i.apply(this,e))}}h(bo,"wrapCleanErrors");R();var Dr=Ua;Dr.source;var soe=Dr.light;Dr.terrain;Dr.filter;var loe=Dr.paintProperty,uoe=Dr.layoutProperty;function vx(i,e){let t=!1;if(e&&e.length)for(let r of e)i.fire(new Mt(new Error(r.message))),t=!0;return t}h(vx,"emitValidationErrors");R();R();R();var fk=class mk{constructor(e,t,r){let n=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;let o=new Int32Array(this.arrayBuffer);e=o[0],t=o[1],r=o[2],this.d=t+2*r;for(let u=0;u<this.d*this.d;u++){let c=o[3+u],p=o[3+u+1];n.push(c===p?null:o.subarray(c,p))}let s=o[3+n.length],l=o[3+n.length+1];this.keys=o.subarray(s,l),this.bboxes=o.subarray(l),this.insert=this._insertReadonly}else{this.d=t+2*r;for(let o=0;o<this.d*this.d;o++)n.push([]);this.keys=[],this.bboxes=[]}this.n=t,this.extent=e,this.padding=r,this.scale=t/e,this.uid=0;let a=r/t*e;this.min=-a,this.max=e+a}insert(e,t,r,n,a){this._forEachCell(t,r,n,a,this._insertCell,this.uid++,void 0,void 0),this.keys.push(e),this.bboxes.push(t),this.bboxes.push(r),this.bboxes.push(n),this.bboxes.push(a)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(e,t,r,n,a,o){this.cells[a].push(o)}query(e,t,r,n,a){let o=this.min,s=this.max;if(e<=o&&t<=o&&s<=r&&s<=n&&!a)return Array.prototype.slice.call(this.keys);{let l=[],u={};return this._forEachCell(e,t,r,n,this._queryCell,l,u,a),l}}_queryCell(e,t,r,n,a,o,s,l){let u=this.cells[a];if(u!==null){let c=this.keys,p=this.bboxes;for(let d=0;d<u.length;d++){let m=u[d];if(s[m]===void 0){let g=m*4;(l?l(p[g+0],p[g+1],p[g+2],p[g+3]):e<=p[g+2]&&t<=p[g+3]&&r>=p[g+0]&&n>=p[g+1])?(s[m]=!0,o.push(c[m])):s[m]=!1}}}}_forEachCell(e,t,r,n,a,o,s,l){let u=this._convertToCellCoord(e),c=this._convertToCellCoord(t),p=this._convertToCellCoord(r),d=this._convertToCellCoord(n);for(let m=u;m<=p;m++)for(let g=c;g<=d;g++){let b=this.d*g+m;if(!(l&&!l(this._convertFromCellCoord(m),this._convertFromCellCoord(g),this._convertFromCellCoord(m+1),this._convertFromCellCoord(g+1)))&&a.call(this,e,t,r,n,b,o,s,l))return}}_convertFromCellCoord(e){return(e-this.padding)/this.scale}_convertToCellCoord(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;let e=this.cells,t=3+this.cells.length+1+1,r=0;for(let o=0;o<this.cells.length;o++)r+=this.cells[o].length;let n=new Int32Array(t+r+this.keys.length+this.bboxes.length);n[0]=this.extent,n[1]=this.n,n[2]=this.padding;let a=t;for(let o=0;o<e.length;o++){let s=e[o];n[3+o]=a,n.set(s,a),a+=s.length}return n[3+e.length]=a,n.set(this.keys,a),a+=this.keys.length,n[3+e.length+1]=a,n.set(this.bboxes,a),a+=this.bboxes.length,n.buffer}static serialize(e,t){let r=e.toArrayBuffer();return t&&t.push(r),{buffer:r}}static deserialize(e){return new mk(e.buffer)}};h(fk,"TransferableGridIndex");var xw=fk,Pl={};function st(i,e,t={}){if(Pl[i])throw new Error(`${i} is already registered.`);Object.defineProperty(e,"_classRegistryKey",{value:i,writeable:!1}),Pl[i]={klass:e,omit:t.omit||[],shallow:t.shallow||[]}}h(st,"register");st("Object",Object);st("TransferableGridIndex",xw);st("Color",zt);st("Error",Error);st("AJAXError",RC);st("ResolvedImage",Wo);st("StylePropertyFunction",KD);st("StyleExpression",o4,{omit:["_evaluator"]});st("ZoomDependentExpression",rv);st("ZoomConstantExpression",iv);st("CompoundExpression",hh,{omit:["_evaluate"]});for(let i in ap)ap[i]._classRegistryKey||st(`Expression_${i}`,ap[i]);function S4(i){return i&&typeof ArrayBuffer<"u"&&(i instanceof ArrayBuffer||i.constructor&&i.constructor.name==="ArrayBuffer")}h(S4,"isArrayBuffer");function sp(i,e){if(i==null||typeof i=="boolean"||typeof i=="number"||typeof i=="string"||i instanceof Boolean||i instanceof Number||i instanceof String||i instanceof Date||i instanceof RegExp||i instanceof Blob||i instanceof Error)return i;if(S4(i)||$o(i))return e&&e.push(i),i;if(ArrayBuffer.isView(i)){let t=i;return e&&e.push(t.buffer),t}if(i instanceof ImageData)return e&&e.push(i.data.buffer),i;if(Array.isArray(i)){let t=[];for(let r of i)t.push(sp(r,e));return t}if(typeof i=="object"){let t=i.constructor,r=t._classRegistryKey;if(!r)throw new Error(`can't serialize object of unregistered class ${t.name}`);if(!Pl[r])throw new Error(`${r} is not registered.`);let n=t.serialize?t.serialize(i,e):{};if(t.serialize){if(e&&n===e[e.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(let a in i){if(!i.hasOwnProperty(a)||Pl[r].omit.indexOf(a)>=0)continue;let o=i[a];n[a]=Pl[r].shallow.indexOf(a)>=0?o:sp(o,e)}i instanceof Error&&(n.message=i.message)}if(n.$name)throw new Error("$name property is reserved for worker serialization logic.");return r!=="Object"&&(n.$name=r),n}throw new Error(`can't serialize object of type ${typeof i}`)}h(sp,"serialize");function lp(i){if(i==null||typeof i=="boolean"||typeof i=="number"||typeof i=="string"||i instanceof Boolean||i instanceof Number||i instanceof String||i instanceof Date||i instanceof RegExp||i instanceof Blob||i instanceof Error||S4(i)||$o(i)||ArrayBuffer.isView(i)||i instanceof ImageData)return i;if(Array.isArray(i))return i.map(lp);if(typeof i=="object"){let e=i.$name||"Object";if(!Pl[e])throw new Error(`can't deserialize unregistered class ${e}`);let{klass:t}=Pl[e];if(!t)throw new Error(`can't deserialize unregistered class ${e}`);if(t.deserialize)return t.deserialize(i);let r=Object.create(t.prototype);for(let n of Object.keys(i)){if(n==="$name")continue;let a=i[n];r[n]=Pl[e].shallow.indexOf(n)>=0?a:lp(a)}return r}throw new Error(`can't deserialize object of type ${typeof i}`)}h(lp,"deserialize");R();R();var gk=class{constructor(){this.first=!0}update(e,t){let r=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=r,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=r,!0):(this.lastFloorZoom>r?(this.lastIntegerZoom=r+1,this.lastIntegerZoomTime=t):this.lastFloorZoom<r&&(this.lastIntegerZoom=r,this.lastIntegerZoomTime=t),e!==this.lastZoom?(this.lastZoom=e,this.lastFloorZoom=r,!0):!1)}};h(gk,"ZoomHistory");var yk=gk;R();R();var ii={"Latin-1 Supplement":i=>i>=128&&i<=255,Arabic:i=>i>=1536&&i<=1791,"Arabic Supplement":i=>i>=1872&&i<=1919,"Arabic Extended-A":i=>i>=2208&&i<=2303,"Hangul Jamo":i=>i>=4352&&i<=4607,"Unified Canadian Aboriginal Syllabics":i=>i>=5120&&i<=5759,Khmer:i=>i>=6016&&i<=6143,"Unified Canadian Aboriginal Syllabics Extended":i=>i>=6320&&i<=6399,"General Punctuation":i=>i>=8192&&i<=8303,"Letterlike Symbols":i=>i>=8448&&i<=8527,"Number Forms":i=>i>=8528&&i<=8591,"Miscellaneous Technical":i=>i>=8960&&i<=9215,"Control Pictures":i=>i>=9216&&i<=9279,"Optical Character Recognition":i=>i>=9280&&i<=9311,"Enclosed Alphanumerics":i=>i>=9312&&i<=9471,"Geometric Shapes":i=>i>=9632&&i<=9727,"Miscellaneous Symbols":i=>i>=9728&&i<=9983,"Miscellaneous Symbols and Arrows":i=>i>=11008&&i<=11263,"CJK Radicals Supplement":i=>i>=11904&&i<=12031,"Kangxi Radicals":i=>i>=12032&&i<=12255,"Ideographic Description Characters":i=>i>=12272&&i<=12287,"CJK Symbols and Punctuation":i=>i>=12288&&i<=12351,Hiragana:i=>i>=12352&&i<=12447,Katakana:i=>i>=12448&&i<=12543,Bopomofo:i=>i>=12544&&i<=12591,"Hangul Compatibility Jamo":i=>i>=12592&&i<=12687,Kanbun:i=>i>=12688&&i<=12703,"Bopomofo Extended":i=>i>=12704&&i<=12735,"CJK Strokes":i=>i>=12736&&i<=12783,"Katakana Phonetic Extensions":i=>i>=12784&&i<=12799,"Enclosed CJK Letters and Months":i=>i>=12800&&i<=13055,"CJK Compatibility":i=>i>=13056&&i<=13311,"CJK Unified Ideographs Extension A":i=>i>=13312&&i<=19903,"Yijing Hexagram Symbols":i=>i>=19904&&i<=19967,"CJK Unified Ideographs":i=>i>=19968&&i<=40959,"Yi Syllables":i=>i>=40960&&i<=42127,"Yi Radicals":i=>i>=42128&&i<=42191,"Hangul Jamo Extended-A":i=>i>=43360&&i<=43391,"Hangul Syllables":i=>i>=44032&&i<=55215,"Hangul Jamo Extended-B":i=>i>=55216&&i<=55295,"Private Use Area":i=>i>=57344&&i<=63743,"CJK Compatibility Ideographs":i=>i>=63744&&i<=64255,"Arabic Presentation Forms-A":i=>i>=64336&&i<=65023,"Vertical Forms":i=>i>=65040&&i<=65055,"CJK Compatibility Forms":i=>i>=65072&&i<=65103,"Small Form Variants":i=>i>=65104&&i<=65135,"Arabic Presentation Forms-B":i=>i>=65136&&i<=65279,"Halfwidth and Fullwidth Forms":i=>i>=65280&&i<=65519};function vk(i){for(let e of i)if(xk(e.charCodeAt(0)))return!0;return!1}h(vk,"allowsVerticalWritingMode");function xk(i){return i===746||i===747?!0:i<4352?!1:!!(ii["Bopomofo Extended"](i)||ii.Bopomofo(i)||ii["CJK Compatibility Forms"](i)&&!(i>=65097&&i<=65103)||ii["CJK Compatibility Ideographs"](i)||ii["CJK Compatibility"](i)||ii["CJK Radicals Supplement"](i)||ii["CJK Strokes"](i)||ii["CJK Symbols and Punctuation"](i)&&!(i>=12296&&i<=12305)&&!(i>=12308&&i<=12319)&&i!==12336||ii["CJK Unified Ideographs Extension A"](i)||ii["CJK Unified Ideographs"](i)||ii["Enclosed CJK Letters and Months"](i)||ii["Hangul Compatibility Jamo"](i)||ii["Hangul Jamo Extended-A"](i)||ii["Hangul Jamo Extended-B"](i)||ii["Hangul Jamo"](i)||ii["Hangul Syllables"](i)||ii.Hiragana(i)||ii["Ideographic Description Characters"](i)||ii.Kanbun(i)||ii["Kangxi Radicals"](i)||ii["Katakana Phonetic Extensions"](i)||ii.Katakana(i)&&i!==12540||ii["Halfwidth and Fullwidth Forms"](i)&&i!==65288&&i!==65289&&i!==65293&&!(i>=65306&&i<=65310)&&i!==65339&&i!==65341&&i!==65343&&!(i>=65371&&i<=65503)&&i!==65507&&!(i>=65512&&i<=65519)||ii["Small Form Variants"](i)&&!(i>=65112&&i<=65118)&&!(i>=65123&&i<=65126)||ii["Unified Canadian Aboriginal Syllabics"](i)||ii["Unified Canadian Aboriginal Syllabics Extended"](i)||ii["Vertical Forms"](i)||ii["Yijing Hexagram Symbols"](i)||ii["Yi Syllables"](i)||ii["Yi Radicals"](i))}h(xk,"charHasUprightVerticalOrientation");function M4(i){return i>=1424&&i<=2303||ii["Arabic Presentation Forms-A"](i)||ii["Arabic Presentation Forms-B"](i)}h(M4,"charInRTLScript");function _k(i,e){return!(!e&&M4(i)||i>=2304&&i<=3583||i>=3840&&i<=4255||ii.Khmer(i))}h(_k,"charInSupportedScript");function bk(i){for(let e of i)if(M4(e.charCodeAt(0)))return!0;return!1}h(bk,"stringContainsRTLText");function wk(i,e){for(let t of i)if(!_k(t.charCodeAt(0),e))return!1;return!0}h(wk,"isStringInSupportedScript");R();var Sk=class{constructor(){this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null}setState(e){this.pluginStatus=e.pluginStatus,this.pluginURL=e.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(e){this.applyArabicShaping=e.applyArabicShaping,this.processBidirectionalText=e.processBidirectionalText,this.processStyledBidirectionalText=e.processStyledBidirectionalText}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getPluginURL(){return this.pluginURL}getRTLTextPluginStatus(){return this.pluginStatus}};h(Sk,"RTLWorkerPlugin");var hoe=Sk,xm=new hoe,Mk=class{constructor(e,t){this.zoom=e,t?(this.now=t.now,this.fadeDuration=t.fadeDuration,this.zoomHistory=t.zoomHistory,this.transition=t.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new yk,this.transition={})}isSupportedScript(e){return wk(e,xm.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){let e=this.zoom,t=e-Math.floor(e),r=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:t+(1-t)*r}:{fromScale:.5,toScale:1,t:1-(1-r)*t}}};h(Mk,"EvaluationParameters");var Pr=Mk,Ck=class{constructor(e,t){this.property=e,this.value=t,this.expression=QD(t===void 0?e.specification.default:t,e.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(e,t,r){return this.property.possiblyEvaluate(this,e,t,r)}};h(Ck,"PropertyValue");var xx=Ck,Ek=class{constructor(e){this.property=e,this.value=new xx(e,void 0)}transitioned(e,t){return new DP(this.property,this.value,t,ht({},e.transition,this.transition),e.now)}untransitioned(){return new DP(this.property,this.value,null,{},0)}};h(Ek,"TransitionablePropertyValue");var _w=Ek,Tk=class{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)}getValue(e){return oa(this._values[e].value.value)}setValue(e,t){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new _w(this._values[e].property)),this._values[e].value=new xx(this._values[e].property,t===null?void 0:oa(t))}getTransition(e){return oa(this._values[e].transition)}setTransition(e,t){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new _w(this._values[e].property)),this._values[e].transition=oa(t)||void 0}serialize(){let e={};for(let t of Object.keys(this._values)){let r=this.getValue(t);r!==void 0&&(e[t]=r);let n=this.getTransition(t);n!==void 0&&(e[`${t}-transition`]=n)}return e}transitioned(e,t){let r=new kP(this._properties);for(let n of Object.keys(this._values))r._values[n]=this._values[n].transitioned(e,t._values[n]);return r}untransitioned(){let e=new kP(this._properties);for(let t of Object.keys(this._values))e._values[t]=this._values[t].untransitioned();return e}};h(Tk,"Transitionable");var Pk=Tk,Ak=class{constructor(e,t,r,n,a){this.property=e,this.value=t,this.begin=a+n.delay||0,this.end=this.begin+n.duration||0,e.specification.transition&&(n.delay||n.duration)&&(this.prior=r)}possiblyEvaluate(e,t,r){let n=e.now||0,a=this.value.possiblyEvaluate(e,t,r),o=this.prior;if(o){if(n>this.end)return this.prior=null,a;if(this.value.isDataDriven())return this.prior=null,a;if(n<this.begin)return o.possiblyEvaluate(e,t,r);{let s=(n-this.begin)/(this.end-this.begin);return this.property.interpolate(o.possiblyEvaluate(e,t,r),a,iL(s))}}else return a}};h(Ak,"TransitioningPropertyValue");var DP=Ak,Ik=class{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,t,r){let n=new _x(this._properties);for(let a of Object.keys(this._values))n._values[a]=this._values[a].possiblyEvaluate(e,t,r);return n}hasTransition(){for(let e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}};h(Ik,"Transitioning");var kP=Ik,Lk=class{constructor(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)}hasValue(e){return this._values[e].value!==void 0}getValue(e){return oa(this._values[e].value)}setValue(e,t){this._values[e]=new xx(this._values[e].property,t===null?void 0:oa(t))}serialize(){let e={};for(let t of Object.keys(this._values)){let r=this.getValue(t);r!==void 0&&(e[t]=r)}return e}possiblyEvaluate(e,t,r){let n=new _x(this._properties);for(let a of Object.keys(this._values))n._values[a]=this._values[a].possiblyEvaluate(e,t,r);return n}};h(Lk,"Layout");var coe=Lk,Dk=class{constructor(e,t,r){this.property=e,this.value=t,this.parameters=r}isConstant(){return this.value.kind==="constant"}constantOr(e){return this.value.kind==="constant"?this.value.value:e}evaluate(e,t,r,n){return this.property.evaluate(this.value,this.parameters,e,t,r,n)}};h(Dk,"PossiblyEvaluatedPropertyValue");var co=Dk,kk=class{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}};h(kk,"PossiblyEvaluated");var _x=kk,Rk=class{constructor(e){this.specification=e}possiblyEvaluate(e,t){if(e.isDataDriven())throw new Error("Value should not be data driven");return e.expression.evaluate(t)}interpolate(e,t,r){let n=this.specification.type,a=ji[n];return a?a(e,t,r):e}};h(Rk,"DataConstantProperty");var mt=Rk,Fk=class{constructor(e,t){this.specification=e,this.overrides=t}possiblyEvaluate(e,t,r,n){return e.expression.kind==="constant"||e.expression.kind==="camera"?new co(this,{kind:"constant",value:e.expression.evaluate(t,null,{},r,n)},t):new co(this,e.expression,t)}interpolate(e,t,r){if(e.value.kind!=="constant"||t.value.kind!=="constant")return e;if(e.value.value===void 0||t.value.value===void 0)return new co(this,{kind:"constant",value:void 0},e.parameters);let n=this.specification.type,a=ji[n];if(a){let o=a(e.value.value,t.value.value,r);return new co(this,{kind:"constant",value:o},e.parameters)}else return e}evaluate(e,t,r,n,a,o){return e.kind==="constant"?e.value:e.evaluate(t,r,n,a,o)}};h(Fk,"DataDrivenProperty");var St=Fk,zk=class extends St{possiblyEvaluate(e,t,r,n){if(e.value===void 0)return new co(this,{kind:"constant",value:void 0},t);if(e.expression.kind==="constant"){let a=e.expression.evaluate(t,null,{},r,n),o=e.property.specification.type==="resolvedImage"&&typeof a!="string"?a.name:a,s=this._calculate(o,o,o,t);return new co(this,{kind:"constant",value:s},t)}else if(e.expression.kind==="camera"){let a=this._calculate(e.expression.evaluate({zoom:t.zoom-1}),e.expression.evaluate({zoom:t.zoom}),e.expression.evaluate({zoom:t.zoom+1}),t);return new co(this,{kind:"constant",value:a},t)}else return new co(this,e.expression,t)}evaluate(e,t,r,n,a,o){if(e.kind==="source"){let s=e.evaluate(t,r,n,a,o);return this._calculate(s,s,s,t)}else return e.kind==="composite"?this._calculate(e.evaluate({zoom:Math.floor(t.zoom)-1},r,n),e.evaluate({zoom:Math.floor(t.zoom)},r,n),e.evaluate({zoom:Math.floor(t.zoom)+1},r,n),t):e.value}_calculate(e,t,r,n){return n.zoom>n.zoomHistory.lastIntegerZoom?{from:e,to:t}:{from:r,to:t}}interpolate(e){return e}};h(zk,"CrossFadedDataDrivenProperty");var bx=zk,Bk=class{constructor(e){this.specification=e}possiblyEvaluate(e,t,r,n){if(e.value!==void 0)if(e.expression.kind==="constant"){let a=e.expression.evaluate(t,null,{},r,n);return this._calculate(a,a,a,t)}else return this._calculate(e.expression.evaluate(new Pr(Math.floor(t.zoom-1),t)),e.expression.evaluate(new Pr(Math.floor(t.zoom),t)),e.expression.evaluate(new Pr(Math.floor(t.zoom+1),t)),t)}_calculate(e,t,r,n){return n.zoom>n.zoomHistory.lastIntegerZoom?{from:e,to:t}:{from:r,to:t}}interpolate(e){return e}};h(Bk,"CrossFadedProperty");var C4=Bk,Ok=class{constructor(e){this.specification=e}possiblyEvaluate(e,t,r,n){return!!e.expression.evaluate(t,null,{},r,n)}interpolate(){return!1}};h(Ok,"ColorRampProperty");var E4=Ok,Nk=class{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(let t in e){let r=e[t];r.specification.overridable&&this.overridableProperties.push(t);let n=this.defaultPropertyValues[t]=new xx(r,void 0),a=this.defaultTransitionablePropertyValues[t]=new _w(r);this.defaultTransitioningPropertyValues[t]=a.untransitioned(),this.defaultPossiblyEvaluatedValues[t]=n.possiblyEvaluate({})}}};h(Nk,"Properties");var Zn=Nk;st("DataDrivenProperty",St);st("DataConstantProperty",mt);st("CrossFadedDataDrivenProperty",bx);st("CrossFadedProperty",C4);st("ColorRampProperty",E4);var Fg="-transition",$k=class extends hn{constructor(e,t){if(super(),this.id=e.id,this.type=e.type,this._featureFilter={filter:()=>!0,needGeometry:!1},e.type!=="custom"&&(e=e,this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,e.type!=="background"&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),t.layout&&(this._unevaluatedLayout=new coe(t.layout)),t.paint)){this._transitionablePaint=new Pk(t.paint);for(let r in e.paint)this.setPaintProperty(r,e.paint[r],{validate:!1});for(let r in e.layout)this.setLayoutProperty(r,e.layout[r],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new _x(t.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(e){return e==="visibility"?this.visibility:this._unevaluatedLayout.getValue(e)}setLayoutProperty(e,t,r={}){if(t!=null){let n=`layers.${this.id}.layout.${e}`;if(this._validate(uoe,n,e,t,r))return}if(e==="visibility"){this.visibility=t;return}this._unevaluatedLayout.setValue(e,t)}getPaintProperty(e){return e.endsWith(Fg)?this._transitionablePaint.getTransition(e.slice(0,-Fg.length)):this._transitionablePaint.getValue(e)}setPaintProperty(e,t,r={}){if(t!=null){let n=`layers.${this.id}.paint.${e}`;if(this._validate(loe,n,e,t,r))return!1}if(e.endsWith(Fg))return this._transitionablePaint.setTransition(e.slice(0,-Fg.length),t||void 0),!1;{let n=this._transitionablePaint._values[e],a=n.property.specification["property-type"]==="cross-faded-data-driven",o=n.value.isDataDriven(),s=n.value;this._transitionablePaint.setValue(e,t),this._handleSpecialPaintPropertyUpdate(e);let l=this._transitionablePaint._values[e].value;return l.isDataDriven()||o||a||this._handleOverridablePaintPropertyUpdate(e,s,l)}}_handleSpecialPaintPropertyUpdate(e){}_handleOverridablePaintPropertyUpdate(e,t,r){return!1}isHidden(e){return this.minzoom&&e<this.minzoom||this.maxzoom&&e>=this.maxzoom?!0:this.visibility==="none"}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(e,t){e.getCrossfadeParameters&&(this._crossfadeParameters=e.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,t)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,t)}serialize(){let e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),DC(e,(t,r)=>t!==void 0&&!(r==="layout"&&!Object.keys(t).length)&&!(r==="paint"&&!Object.keys(t).length))}_validate(e,t,r,n,a={}){return a&&a.validate===!1?!1:vx(this,e.call(Dr,{key:t,layerType:this.type,objectKey:r,value:n,styleSpec:Le,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(let e in this.paint._values){let t=this.paint.get(e);if(!(!(t instanceof co)||!Zu(t.property.specification))&&(t.value.kind==="source"||t.value.kind==="composite")&&t.value.isStateDependent)return!0}return!1}};h($k,"StyleLayer");var qo=$k;R();R();R();var poe={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},Uk=class{constructor(e,t){this._structArray=e,this._pos1=t*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}};h(Uk,"Struct");var qm=Uk,doe=128,foe=5,Vk=class{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,t){return e._trim(),t&&(e.isTransferred=!0,t.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){let t=Object.create(this.prototype);return t.arrayBuffer=e.arrayBuffer,t.length=e.length,t.capacity=e.arrayBuffer.byteLength/t.bytesPerElement,t._refreshViews(),t}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(this.capacity*foe),doe),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);let t=this.uint8;this._refreshViews(),t&&this.uint8.set(t)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}};h(Vk,"StructArray");var nr=Vk;function Xi(i,e=1){let t=0,r=0,n=i.map(o=>{let s=jk(o.type),l=t=bw(t,Math.max(e,s)),u=o.components||1;return r=Math.max(r,s),t+=s*u,{name:o.name,type:o.type,components:u,offset:l}}),a=bw(t,Math.max(r,e));return{members:n,size:a,alignment:e}}h(Xi,"createLayout");function jk(i){return poe[i].BYTES_PER_ELEMENT}h(jk,"sizeOf");function bw(i,e){return Math.ceil(i/e)*e}h(bw,"align");var moe=It(di(),1),Hk=class extends nr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t){let r=this.length;return this.resize(r+1),this.emplace(r,e,t)}emplace(e,t,r){let n=e*2;return this.int16[n+0]=t,this.int16[n+1]=r,e}};h(Hk,"StructArrayLayout2i4");var Zm=Hk;Zm.prototype.bytesPerElement=4;st("StructArrayLayout2i4",Zm);var Gk=class extends nr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,r){let n=this.length;return this.resize(n+1),this.emplace(n,e,t,r)}emplace(e,t,r,n){let a=e*3;return this.int16[a+0]=t,this.int16[a+1]=r,this.int16[a+2]=n,e}};h(Gk,"StructArrayLayout3i6");var wx=Gk;wx.prototype.bytesPerElement=6;st("StructArrayLayout3i6",wx);var Wk=class extends nr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,r,n){let a=this.length;return this.resize(a+1),this.emplace(a,e,t,r,n)}emplace(e,t,r,n,a){let o=e*4;return this.int16[o+0]=t,this.int16[o+1]=r,this.int16[o+2]=n,this.int16[o+3]=a,e}};h(Wk,"StructArrayLayout4i8");var T4=Wk;T4.prototype.bytesPerElement=8;st("StructArrayLayout4i8",T4);var Xk=class extends nr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,r,n,a,o){let s=this.length;return this.resize(s+1),this.emplace(s,e,t,r,n,a,o)}emplace(e,t,r,n,a,o,s){let l=e*6;return this.int16[l+0]=t,this.int16[l+1]=r,this.int16[l+2]=n,this.int16[l+3]=a,this.int16[l+4]=o,this.int16[l+5]=s,e}};h(Xk,"StructArrayLayout2i4i12");var P4=Xk;P4.prototype.bytesPerElement=12;st("StructArrayLayout2i4i12",P4);var qk=class extends nr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,r,n,a,o){let s=this.length;return this.resize(s+1),this.emplace(s,e,t,r,n,a,o)}emplace(e,t,r,n,a,o,s){let l=e*4,u=e*8;return this.int16[l+0]=t,this.int16[l+1]=r,this.uint8[u+4]=n,this.uint8[u+5]=a,this.uint8[u+6]=o,this.uint8[u+7]=s,e}};h(qk,"StructArrayLayout2i4ub8");var A4=qk;A4.prototype.bytesPerElement=8;st("StructArrayLayout2i4ub8",A4);var Zk=class extends nr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t){let r=this.length;return this.resize(r+1),this.emplace(r,e,t)}emplace(e,t,r){let n=e*2;return this.float32[n+0]=t,this.float32[n+1]=r,e}};h(Zk,"StructArrayLayout2f8");var _m=Zk;_m.prototype.bytesPerElement=8;st("StructArrayLayout2f8",_m);var Yk=class extends nr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,r,n,a,o,s,l,u,c){let p=this.length;return this.resize(p+1),this.emplace(p,e,t,r,n,a,o,s,l,u,c)}emplace(e,t,r,n,a,o,s,l,u,c,p){let d=e*10;return this.uint16[d+0]=t,this.uint16[d+1]=r,this.uint16[d+2]=n,this.uint16[d+3]=a,this.uint16[d+4]=o,this.uint16[d+5]=s,this.uint16[d+6]=l,this.uint16[d+7]=u,this.uint16[d+8]=c,this.uint16[d+9]=p,e}};h(Yk,"StructArrayLayout10ui20");var I4=Yk;I4.prototype.bytesPerElement=20;st("StructArrayLayout10ui20",I4);var Jk=class extends nr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,r,n,a,o,s,l,u,c,p,d){let m=this.length;return this.resize(m+1),this.emplace(m,e,t,r,n,a,o,s,l,u,c,p,d)}emplace(e,t,r,n,a,o,s,l,u,c,p,d,m){let g=e*12;return this.int16[g+0]=t,this.int16[g+1]=r,this.int16[g+2]=n,this.int16[g+3]=a,this.uint16[g+4]=o,this.uint16[g+5]=s,this.uint16[g+6]=l,this.uint16[g+7]=u,this.int16[g+8]=c,this.int16[g+9]=p,this.int16[g+10]=d,this.int16[g+11]=m,e}};h(Jk,"StructArrayLayout4i4ui4i24");var L4=Jk;L4.prototype.bytesPerElement=24;st("StructArrayLayout4i4ui4i24",L4);var Kk=class extends nr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,r){let n=this.length;return this.resize(n+1),this.emplace(n,e,t,r)}emplace(e,t,r,n){let a=e*3;return this.float32[a+0]=t,this.float32[a+1]=r,this.float32[a+2]=n,e}};h(Kk,"StructArrayLayout3f12");var D4=Kk;D4.prototype.bytesPerElement=12;st("StructArrayLayout3f12",D4);var Qk=class extends nr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){let t=this.length;return this.resize(t+1),this.emplace(t,e)}emplace(e,t){let r=e*1;return this.uint32[r+0]=t,e}};h(Qk,"StructArrayLayout1ul4");var k4=Qk;k4.prototype.bytesPerElement=4;st("StructArrayLayout1ul4",k4);var eR=class extends nr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,r,n,a,o,s,l,u){let c=this.length;return this.resize(c+1),this.emplace(c,e,t,r,n,a,o,s,l,u)}emplace(e,t,r,n,a,o,s,l,u,c){let p=e*10,d=e*5;return this.int16[p+0]=t,this.int16[p+1]=r,this.int16[p+2]=n,this.int16[p+3]=a,this.int16[p+4]=o,this.int16[p+5]=s,this.uint32[d+3]=l,this.uint16[p+8]=u,this.uint16[p+9]=c,e}};h(eR,"StructArrayLayout6i1ul2ui20");var R4=eR;R4.prototype.bytesPerElement=20;st("StructArrayLayout6i1ul2ui20",R4);var tR=class extends nr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,r,n,a,o){let s=this.length;return this.resize(s+1),this.emplace(s,e,t,r,n,a,o)}emplace(e,t,r,n,a,o,s){let l=e*6;return this.int16[l+0]=t,this.int16[l+1]=r,this.int16[l+2]=n,this.int16[l+3]=a,this.int16[l+4]=o,this.int16[l+5]=s,e}};h(tR,"StructArrayLayout2i2i2i12");var F4=tR;F4.prototype.bytesPerElement=12;st("StructArrayLayout2i2i2i12",F4);var iR=class extends nr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,r,n,a){let o=this.length;return this.resize(o+1),this.emplace(o,e,t,r,n,a)}emplace(e,t,r,n,a,o){let s=e*4,l=e*8;return this.float32[s+0]=t,this.float32[s+1]=r,this.float32[s+2]=n,this.int16[l+6]=a,this.int16[l+7]=o,e}};h(iR,"StructArrayLayout2f1f2i16");var z4=iR;z4.prototype.bytesPerElement=16;st("StructArrayLayout2f1f2i16",z4);var rR=class extends nr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,r,n){let a=this.length;return this.resize(a+1),this.emplace(a,e,t,r,n)}emplace(e,t,r,n,a){let o=e*12,s=e*3;return this.uint8[o+0]=t,this.uint8[o+1]=r,this.float32[s+1]=n,this.float32[s+2]=a,e}};h(rR,"StructArrayLayout2ub2f12");var B4=rR;B4.prototype.bytesPerElement=12;st("StructArrayLayout2ub2f12",B4);var nR=class extends nr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,r){let n=this.length;return this.resize(n+1),this.emplace(n,e,t,r)}emplace(e,t,r,n){let a=e*3;return this.uint16[a+0]=t,this.uint16[a+1]=r,this.uint16[a+2]=n,e}};h(nR,"StructArrayLayout3ui6");var Sx=nR;Sx.prototype.bytesPerElement=6;st("StructArrayLayout3ui6",Sx);var aR=class extends nr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,r,n,a,o,s,l,u,c,p,d,m,g,b,x,v){let w=this.length;return this.resize(w+1),this.emplace(w,e,t,r,n,a,o,s,l,u,c,p,d,m,g,b,x,v)}emplace(e,t,r,n,a,o,s,l,u,c,p,d,m,g,b,x,v,w){let _=e*24,C=e*12,E=e*48;return this.int16[_+0]=t,this.int16[_+1]=r,this.uint16[_+2]=n,this.uint16[_+3]=a,this.uint32[C+2]=o,this.uint32[C+3]=s,this.uint32[C+4]=l,this.uint16[_+10]=u,this.uint16[_+11]=c,this.uint16[_+12]=p,this.float32[C+7]=d,this.float32[C+8]=m,this.uint8[E+36]=g,this.uint8[E+37]=b,this.uint8[E+38]=x,this.uint32[C+10]=v,this.int16[_+22]=w,e}};h(aR,"StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48");var O4=aR;O4.prototype.bytesPerElement=48;st("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",O4);var oR=class extends nr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,r,n,a,o,s,l,u,c,p,d,m,g,b,x,v,w,_,C,E,T,L,D,B,A,k,$){let O=this.length;return this.resize(O+1),this.emplace(O,e,t,r,n,a,o,s,l,u,c,p,d,m,g,b,x,v,w,_,C,E,T,L,D,B,A,k,$)}emplace(e,t,r,n,a,o,s,l,u,c,p,d,m,g,b,x,v,w,_,C,E,T,L,D,B,A,k,$,O){let P=e*32,U=e*16;return this.int16[P+0]=t,this.int16[P+1]=r,this.int16[P+2]=n,this.int16[P+3]=a,this.int16[P+4]=o,this.int16[P+5]=s,this.int16[P+6]=l,this.int16[P+7]=u,this.uint16[P+8]=c,this.uint16[P+9]=p,this.uint16[P+10]=d,this.uint16[P+11]=m,this.uint16[P+12]=g,this.uint16[P+13]=b,this.uint16[P+14]=x,this.uint16[P+15]=v,this.uint16[P+16]=w,this.uint16[P+17]=_,this.uint16[P+18]=C,this.uint16[P+19]=E,this.uint16[P+20]=T,this.uint16[P+21]=L,this.uint16[P+22]=D,this.uint32[U+12]=B,this.float32[U+13]=A,this.float32[U+14]=k,this.uint16[P+30]=$,this.uint16[P+31]=O,e}};h(oR,"StructArrayLayout8i15ui1ul2f2ui64");var N4=oR;N4.prototype.bytesPerElement=64;st("StructArrayLayout8i15ui1ul2f2ui64",N4);var sR=class extends nr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){let t=this.length;return this.resize(t+1),this.emplace(t,e)}emplace(e,t){let r=e*1;return this.float32[r+0]=t,e}};h(sR,"StructArrayLayout1f4");var Mx=sR;Mx.prototype.bytesPerElement=4;st("StructArrayLayout1f4",Mx);var lR=class extends nr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,r){let n=this.length;return this.resize(n+1),this.emplace(n,e,t,r)}emplace(e,t,r,n){let a=e*6,o=e*3;return this.uint16[a+0]=t,this.float32[o+1]=r,this.float32[o+2]=n,e}};h(lR,"StructArrayLayout1ui2f12");var $4=lR;$4.prototype.bytesPerElement=12;st("StructArrayLayout1ui2f12",$4);var uR=class extends nr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,r){let n=this.length;return this.resize(n+1),this.emplace(n,e,t,r)}emplace(e,t,r,n){let a=e*2,o=e*4;return this.uint32[a+0]=t,this.uint16[o+2]=r,this.uint16[o+3]=n,e}};h(uR,"StructArrayLayout1ul2ui8");var U4=uR;U4.prototype.bytesPerElement=8;st("StructArrayLayout1ul2ui8",U4);var hR=class extends nr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t){let r=this.length;return this.resize(r+1),this.emplace(r,e,t)}emplace(e,t,r){let n=e*2;return this.uint16[n+0]=t,this.uint16[n+1]=r,e}};h(hR,"StructArrayLayout2ui4");var V4=hR;V4.prototype.bytesPerElement=4;st("StructArrayLayout2ui4",V4);var cR=class extends nr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){let t=this.length;return this.resize(t+1),this.emplace(t,e)}emplace(e,t){let r=e*1;return this.uint16[r+0]=t,e}};h(cR,"StructArrayLayout1ui2");var j4=cR;j4.prototype.bytesPerElement=2;st("StructArrayLayout1ui2",j4);var pR=class extends nr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,r,n){let a=this.length;return this.resize(a+1),this.emplace(a,e,t,r,n)}emplace(e,t,r,n,a){let o=e*4;return this.float32[o+0]=t,this.float32[o+1]=r,this.float32[o+2]=n,this.float32[o+3]=a,e}};h(pR,"StructArrayLayout4f16");var H4=pR;H4.prototype.bytesPerElement=16;st("StructArrayLayout4f16",H4);var dR=class extends qm{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new moe.default(this.anchorPointX,this.anchorPointY)}};h(dR,"CollisionBoxStruct");var fR=dR;fR.prototype.size=20;var mR=class extends R4{get(e){return new fR(this,e)}};h(mR,"CollisionBoxArray");var gR=mR;st("CollisionBoxArray",gR);var yR=class extends qm{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(e){this._structArray.uint8[this._pos1+37]=e}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(e){this._structArray.uint8[this._pos1+38]=e}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(e){this._structArray.uint32[this._pos4+10]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}};h(yR,"PlacedSymbolStruct");var vR=yR;vR.prototype.size=48;var xR=class extends O4{get(e){return new vR(this,e)}};h(xR,"PlacedSymbolArray");var _R=xR;st("PlacedSymbolArray",_R);var bR=class extends qm{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(e){this._structArray.uint32[this._pos4+12]=e}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}};h(bR,"SymbolInstanceStruct");var wR=bR;wR.prototype.size=64;var SR=class extends N4{get(e){return new wR(this,e)}};h(SR,"SymbolInstanceArray");var MR=SR;st("SymbolInstanceArray",MR);var CR=class extends Mx{getoffsetX(e){return this.float32[e*1+0]}};h(CR,"GlyphOffsetArray");var ER=CR;st("GlyphOffsetArray",ER);var TR=class extends wx{getx(e){return this.int16[e*3+0]}gety(e){return this.int16[e*3+1]}gettileUnitDistanceFromAnchor(e){return this.int16[e*3+2]}};h(TR,"SymbolLineVertexArray");var PR=TR;st("SymbolLineVertexArray",PR);var AR=class extends qm{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}};h(AR,"TextAnchorOffsetStruct");var IR=AR;IR.prototype.size=12;var LR=class extends $4{get(e){return new IR(this,e)}};h(LR,"TextAnchorOffsetArray");var DR=LR;st("TextAnchorOffsetArray",DR);var kR=class extends qm{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}};h(kR,"FeatureIndexStruct");var RR=kR;RR.prototype.size=8;var FR=class extends U4{get(e){return new RR(this,e)}};h(FR,"FeatureIndexArray");var zR=FR;st("FeatureIndexArray",zR);var BR=class extends Zm{};h(BR,"PosArray");var sy=BR,OR=class extends wx{};h(OR,"Pos3dArray");var goe=OR,NR=class extends T4{};h(NR,"RasterBoundsArray");var $R=NR,UR=class extends Zm{};h(UR,"CircleLayoutArray");var yoe=UR,VR=class extends Zm{};h(VR,"FillLayoutArray");var voe=VR,jR=class extends P4{};h(jR,"FillExtrusionLayoutArray");var xoe=jR,HR=class extends A4{};h(HR,"LineLayoutArray");var _oe=HR,GR=class extends _m{};h(GR,"LineExtLayoutArray");var boe=GR,WR=class extends I4{};h(WR,"PatternLayoutArray");var wh=WR,XR=class extends L4{};h(XR,"SymbolLayoutArray");var woe=XR,qR=class extends D4{};h(qR,"SymbolDynamicLayoutArray");var Soe=qR,ZR=class extends k4{};h(ZR,"SymbolOpacityArray");var Moe=ZR,YR=class extends F4{};h(YR,"CollisionBoxLayoutArray");var RP=YR,JR=class extends z4{};h(JR,"CollisionCircleLayoutArray");var Coe=JR,KR=class extends B4{};h(KR,"CollisionVertexArray");var Eoe=KR,QR=class extends Sx{};h(QR,"QuadTriangleArray");var Toe=QR,eF=class extends Sx{};h(eF,"TriangleIndexArray");var ch=eF,tF=class extends V4{};h(tF,"LineIndexArray");var ww=tF,iF=class extends j4{};h(iF,"LineStripIndexArray");var Poe=iF;R();var Aoe=Xi([{name:"a_pos",components:2,type:"Int16"}],4),{members:Ioe,size:ywe,alignment:vwe}=Aoe;R();var rF=class Wd{constructor(e=[]){this.segments=e}prepareSegment(e,t,r,n){let a=this.segments[this.segments.length-1];return e>Wd.MAX_VERTEX_ARRAY_LENGTH&&ln(`Max vertices per segment is ${Wd.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${e}`),(!a||a.vertexLength+e>Wd.MAX_VERTEX_ARRAY_LENGTH||a.sortKey!==n)&&(a={vertexOffset:t.length,primitiveOffset:r.length,vertexLength:0,primitiveLength:0},n!==void 0&&(a.sortKey=n),this.segments.push(a)),a}get(){return this.segments}destroy(){for(let e of this.segments)for(let t in e.vaos)e.vaos[t].destroy()}static simpleSegment(e,t,r,n){return new Wd([{vertexOffset:e,primitiveOffset:t,vertexLength:r,primitiveLength:n,vaos:{},sortKey:0}])}};h(rF,"SegmentVector");var cr=rF;cr.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1;st("SegmentVector",cr);R();R();function Sw(i,e){return i=Tr(Math.floor(i),0,255),e=Tr(Math.floor(e),0,255),256*i+e}h(Sw,"packUint8ToFloat");R();var av=Xi([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);R();var Loe=It(Z7(),1),nF=class aF{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(e,t,r,n){this.ids.push(Mw(e)),this.positions.push(t,r,n)}getPositions(e){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");let t=Mw(e),r=0,n=this.ids.length-1;for(;r<n;){let o=r+n>>1;this.ids[o]>=t?n=o:r=o+1}let a=[];for(;this.ids[r]===t;){let o=this.positions[3*r],s=this.positions[3*r+1],l=this.positions[3*r+2];a.push({index:o,start:s,end:l}),r++}return a}static serialize(e,t){let r=new Float64Array(e.ids),n=new Uint32Array(e.positions);return ov(r,n,0,r.length-1),t&&t.push(r.buffer,n.buffer),{ids:r,positions:n}}static deserialize(e){let t=new aF;return t.ids=e.ids,t.positions=e.positions,t.indexed=!0,t}};h(nF,"FeaturePositionMap");var oF=nF;function Mw(i){let e=+i;return!isNaN(e)&&e<=Number.MAX_SAFE_INTEGER?e:(0,Loe.default)(String(i))}h(Mw,"getNumericId");function ov(i,e,t,r){for(;t<r;){let n=i[t+r>>1],a=t-1,o=r+1;for(;;){do a++;while(i[a]<n);do o--;while(i[o]>n);if(a>=o)break;Xd(i,a,o),Xd(e,3*a,3*o),Xd(e,3*a+1,3*o+1),Xd(e,3*a+2,3*o+2)}o-t<r-o?(ov(i,e,t,o),t=o+1):(ov(i,e,o+1,r),r=o)}}h(ov,"sort");function Xd(i,e,t){let r=i[e];i[e]=i[t],i[t]=r}h(Xd,"swap");st("FeaturePositionMap",oF);R();var sF=class{constructor(e,t){this.gl=e.gl,this.location=t}};h(sF,"Uniform");var ph=sF,lF=class extends ph{constructor(e,t){super(e,t),this.current=0}set(e){this.current!==e&&(this.current=e,this.gl.uniform1i(this.location,e))}};h(lF,"Uniform1i");var Zt=lF,uF=class extends ph{constructor(e,t){super(e,t),this.current=0}set(e){this.current!==e&&(this.current=e,this.gl.uniform1f(this.location,e))}};h(uF,"Uniform1f");var nt=uF,hF=class extends ph{constructor(e,t){super(e,t),this.current=[0,0]}set(e){(e[0]!==this.current[0]||e[1]!==this.current[1])&&(this.current=e,this.gl.uniform2f(this.location,e[0],e[1]))}};h(hF,"Uniform2f");var Qt=hF,cF=class extends ph{constructor(e,t){super(e,t),this.current=[0,0,0]}set(e){(e[0]!==this.current[0]||e[1]!==this.current[1]||e[2]!==this.current[2])&&(this.current=e,this.gl.uniform3f(this.location,e[0],e[1],e[2]))}};h(cF,"Uniform3f");var Es=cF,pF=class extends ph{constructor(e,t){super(e,t),this.current=[0,0,0,0]}set(e){(e[0]!==this.current[0]||e[1]!==this.current[1]||e[2]!==this.current[2]||e[3]!==this.current[3])&&(this.current=e,this.gl.uniform4f(this.location,e[0],e[1],e[2],e[3]))}};h(pF,"Uniform4f");var G4=pF,dF=class extends ph{constructor(e,t){super(e,t),this.current=zt.transparent}set(e){(e.r!==this.current.r||e.g!==this.current.g||e.b!==this.current.b||e.a!==this.current.a)&&(this.current=e,this.gl.uniform4f(this.location,e.r,e.g,e.b,e.a))}};h(dF,"UniformColor");var up=dF,Doe=new Float32Array(16),fF=class extends ph{constructor(e,t){super(e,t),this.current=Doe}set(e){if(e[12]!==this.current[12]||e[0]!==this.current[0]){this.current=e,this.gl.uniformMatrix4fv(this.location,!1,e);return}for(let t=1;t<16;t++)if(e[t]!==this.current[t]){this.current=e,this.gl.uniformMatrix4fv(this.location,!1,e);break}}};h(fF,"UniformMatrix4f");var oi=fF;function sv(i){return[Sw(255*i.r,255*i.g),Sw(255*i.b,255*i.a)]}h(sv,"packColor");var mF=class{constructor(e,t,r){this.value=e,this.uniformNames=t.map(n=>`u_${n}`),this.type=r}setUniform(e,t,r){e.set(r.constantOr(this.value))}getBinding(e,t,r){return this.type==="color"?new up(e,t):new nt(e,t)}};h(mF,"ConstantBinder");var qd=mF,gF=class{constructor(e,t){this.uniformNames=t.map(r=>`u_${r}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(e,t){this.pixelRatioFrom=t.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=t.tlbr,this.patternTo=e.tlbr}setUniform(e,t,r,n){let a=n==="u_pattern_to"?this.patternTo:n==="u_pattern_from"?this.patternFrom:n==="u_pixel_ratio_to"?this.pixelRatioTo:n==="u_pixel_ratio_from"?this.pixelRatioFrom:null;a&&e.set(a)}getBinding(e,t,r){return r.substr(0,9)==="u_pattern"?new G4(e,t):new nt(e,t)}};h(gF,"CrossFadedConstantBinder");var Wh=gF,yF=class{constructor(e,t,r,n){this.expression=e,this.type=r,this.maxValue=0,this.paintVertexAttributes=t.map(a=>({name:`a_${a}`,type:"Float32",components:r==="color"?2:1,offset:0})),this.paintVertexArray=new n}populatePaintArray(e,t,r,n,a){let o=this.paintVertexArray.length,s=this.expression.evaluate(new Pr(0),t,{},n,[],a);this.paintVertexArray.resize(e),this._setPaintValue(o,e,s)}updatePaintArray(e,t,r,n){let a=this.expression.evaluate({zoom:0},r,n);this._setPaintValue(e,t,a)}_setPaintValue(e,t,r){if(this.type==="color"){let n=sv(r);for(let a=e;a<t;a++)this.paintVertexArray.emplace(a,n[0],n[1])}else{for(let n=e;n<t;n++)this.paintVertexArray.emplace(n,r);this.maxValue=Math.max(this.maxValue,Math.abs(r))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}};h(yF,"SourceExpressionBinder");var os=yF,vF=class{constructor(e,t,r,n,a,o){this.expression=e,this.uniformNames=t.map(s=>`u_${s}_t`),this.type=r,this.useIntegerZoom=n,this.zoom=a,this.maxValue=0,this.paintVertexAttributes=t.map(s=>({name:`a_${s}`,type:"Float32",components:r==="color"?4:2,offset:0})),this.paintVertexArray=new o}populatePaintArray(e,t,r,n,a){let o=this.expression.evaluate(new Pr(this.zoom),t,{},n,[],a),s=this.expression.evaluate(new Pr(this.zoom+1),t,{},n,[],a),l=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(l,e,o,s)}updatePaintArray(e,t,r,n){let a=this.expression.evaluate({zoom:this.zoom},r,n),o=this.expression.evaluate({zoom:this.zoom+1},r,n);this._setPaintValue(e,t,a,o)}_setPaintValue(e,t,r,n){if(this.type==="color"){let a=sv(r),o=sv(n);for(let s=e;s<t;s++)this.paintVertexArray.emplace(s,a[0],a[1],o[0],o[1])}else{for(let a=e;a<t;a++)this.paintVertexArray.emplace(a,r,n);this.maxValue=Math.max(this.maxValue,Math.abs(r),Math.abs(n))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,t){let r=this.useIntegerZoom?Math.floor(t.zoom):t.zoom,n=Tr(this.expression.interpolationFactor(r,this.zoom,this.zoom+1),0,1);e.set(n)}getBinding(e,t,r){return new nt(e,t)}};h(vF,"CompositeExpressionBinder");var Ja=vF,xF=class{constructor(e,t,r,n,a,o){this.expression=e,this.type=t,this.useIntegerZoom=r,this.zoom=n,this.layerId=o,this.zoomInPaintVertexArray=new a,this.zoomOutPaintVertexArray=new a}populatePaintArray(e,t,r){let n=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(n,e,t.patterns&&t.patterns[this.layerId],r)}updatePaintArray(e,t,r,n,a){this._setPaintValues(e,t,r.patterns&&r.patterns[this.layerId],a)}_setPaintValues(e,t,r,n){if(!n||!r)return;let{min:a,mid:o,max:s}=r,l=n[a],u=n[o],c=n[s];if(!(!l||!u||!c))for(let p=e;p<t;p++)this.zoomInPaintVertexArray.emplace(p,u.tl[0],u.tl[1],u.br[0],u.br[1],l.tl[0],l.tl[1],l.br[0],l.br[1],u.pixelRatio,l.pixelRatio),this.zoomOutPaintVertexArray.emplace(p,u.tl[0],u.tl[1],u.br[0],u.br[1],c.tl[0],c.tl[1],c.br[0],c.br[1],u.pixelRatio,c.pixelRatio)}upload(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,av.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,av.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}};h(xF,"CrossFadedCompositeBinder");var Ys=xF,_F=class{constructor(e,t,r){this.binders={},this._buffers=[];let n=[];for(let a in e.paint._values){if(!r(a))continue;let o=e.paint.get(a);if(!(o instanceof co)||!Zu(o.property.specification))continue;let s=SF(a,e.type),l=o.value,u=o.property.specification.type,c=o.property.useIntegerZoom,p=o.property.specification["property-type"],d=p==="cross-faded"||p==="cross-faded-data-driven";if(l.kind==="constant")this.binders[a]=d?new Wh(l.value,s):new qd(l.value,s,u),n.push(`/u_${a}`);else if(l.kind==="source"||d){let m=Cw(a,u,"source");this.binders[a]=d?new Ys(l,u,c,t,m,e.id):new os(l,s,u,m),n.push(`/a_${a}`)}else{let m=Cw(a,u,"composite");this.binders[a]=new Ja(l,s,u,c,t,m),n.push(`/z_${a}`)}}this.cacheKey=n.sort().join("")}getMaxValue(e){let t=this.binders[e];return t instanceof os||t instanceof Ja?t.maxValue:0}populatePaintArrays(e,t,r,n,a){for(let o in this.binders){let s=this.binders[o];(s instanceof os||s instanceof Ja||s instanceof Ys)&&s.populatePaintArray(e,t,r,n,a)}}setConstantPatternPositions(e,t){for(let r in this.binders){let n=this.binders[r];n instanceof Wh&&n.setConstantPatternPositions(e,t)}}updatePaintArrays(e,t,r,n,a){let o=!1;for(let s in e){let l=t.getPositions(s);for(let u of l){let c=r.feature(u.index);for(let p in this.binders){let d=this.binders[p];if((d instanceof os||d instanceof Ja||d instanceof Ys)&&d.expression.isStateDependent===!0){let m=n.paint.get(p);d.expression=m.value,d.updatePaintArray(u.start,u.end,c,e[s],a),o=!0}}}}return o}defines(){let e=[];for(let t in this.binders){let r=this.binders[t];(r instanceof qd||r instanceof Wh)&&e.push(...r.uniformNames.map(n=>`#define HAS_UNIFORM_${n}`))}return e}getBinderAttributes(){let e=[];for(let t in this.binders){let r=this.binders[t];if(r instanceof os||r instanceof Ja)for(let n=0;n<r.paintVertexAttributes.length;n++)e.push(r.paintVertexAttributes[n].name);else if(r instanceof Ys)for(let n=0;n<av.members.length;n++)e.push(av.members[n].name)}return e}getBinderUniforms(){let e=[];for(let t in this.binders){let r=this.binders[t];if(r instanceof qd||r instanceof Wh||r instanceof Ja)for(let n of r.uniformNames)e.push(n)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e,t){let r=[];for(let n in this.binders){let a=this.binders[n];if(a instanceof qd||a instanceof Wh||a instanceof Ja){for(let o of a.uniformNames)if(t[o]){let s=a.getBinding(e,t[o],o);r.push({name:o,property:n,binding:s})}}}return r}setUniforms(e,t,r,n){for(let{name:a,property:o,binding:s}of t)this.binders[o].setUniform(s,n,r.get(o),a)}updatePaintBuffers(e){this._buffers=[];for(let t in this.binders){let r=this.binders[t];if(e&&r instanceof Ys){let n=e.fromScale===2?r.zoomInPaintVertexBuffer:r.zoomOutPaintVertexBuffer;n&&this._buffers.push(n)}else(r instanceof os||r instanceof Ja)&&r.paintVertexBuffer&&this._buffers.push(r.paintVertexBuffer)}}upload(e){for(let t in this.binders){let r=this.binders[t];(r instanceof os||r instanceof Ja||r instanceof Ys)&&r.upload(e)}this.updatePaintBuffers()}destroy(){for(let e in this.binders){let t=this.binders[e];(t instanceof os||t instanceof Ja||t instanceof Ys)&&t.destroy()}}};h(_F,"ProgramConfiguration");var bF=_F,wF=class{constructor(e,t,r=()=>!0){this.programConfigurations={};for(let n of e)this.programConfigurations[n.id]=new bF(n,t,r);this.needsUpload=!1,this._featureMap=new oF,this._bufferOffset=0}populatePaintArrays(e,t,r,n,a,o){for(let s in this.programConfigurations)this.programConfigurations[s].populatePaintArrays(e,t,n,a,o);t.id!==void 0&&this._featureMap.add(t.id,r,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,t,r,n){for(let a of r)this.needsUpload=this.programConfigurations[a.id].updatePaintArrays(e,this._featureMap,t,a,n)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(let t in this.programConfigurations)this.programConfigurations[t].upload(e);this.needsUpload=!1}}destroy(){for(let e in this.programConfigurations)this.programConfigurations[e].destroy()}};h(wF,"ProgramConfigurationSet");var Ju=wF;function SF(i,e){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[i]||[i.replace(`${e}-`,"").replace(/-/g,"_")]}h(SF,"paintAttributeNames");function MF(i){return{"line-pattern":{source:wh,composite:wh},"fill-pattern":{source:wh,composite:wh},"fill-extrusion-pattern":{source:wh,composite:wh}}[i]}h(MF,"getLayoutException");function Cw(i,e,t){let r={color:{source:_m,composite:H4},number:{source:Mx,composite:_m}},n=MF(i);return n&&n[t]||r[e][t]}h(Cw,"layoutType");st("ConstantBinder",qd);st("CrossFadedConstantBinder",Wh);st("SourceExpressionBinder",os);st("CrossFadedCompositeBinder",Ys);st("CompositeExpressionBinder",Ja);st("ProgramConfiguration",bF,{omit:["_buffers"]});st("ProgramConfigurationSet",Ju);R();R();R();var koe=15,Ew=Math.pow(2,koe-1)-1,FP=-Ew-1;function jl(i){let e=8192/i.extent,t=i.loadGeometry();for(let r=0;r<t.length;r++){let n=t[r];for(let a=0;a<n.length;a++){let o=n[a],s=Math.round(o.x*e),l=Math.round(o.y*e);o.x=Tr(s,FP,Ew),o.y=Tr(l,FP,Ew),(s<o.x||s>o.x+1||l<o.y||l>o.y+1)&&ln("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return t}h(jl,"loadGeometry");R();function Hl(i,e){return{type:i.type,id:i.id,properties:i.properties,geometry:e?jl(i):[]}}h(Hl,"toEvaluationFeature");function Zd(i,e,t,r,n){i.emplaceBack(e*2+(r+1)/2,t*2+(n+1)/2)}h(Zd,"addCircleVertex");var CF=class{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(t=>t.id),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new yoe,this.indexArray=new ch,this.segments=new cr,this.programConfigurations=new Ju(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(t=>t.isStateDependent()).map(t=>t.id)}populate(e,t,r){let n=this.layers[0],a=[],o=null,s=!1;n.type==="circle"&&(o=n.layout.get("circle-sort-key"),s=!o.isConstant());for(let{feature:l,id:u,index:c,sourceLayerIndex:p}of e){let d=this.layers[0]._featureFilter.needGeometry,m=Hl(l,d);if(!this.layers[0]._featureFilter.filter(new Pr(this.zoom),m,r))continue;let g=s?o.evaluate(m,{},r):void 0,b={id:u,properties:l.properties,type:l.type,sourceLayerIndex:p,index:c,geometry:d?m.geometry:jl(l),patterns:{},sortKey:g};a.push(b)}s&&a.sort((l,u)=>l.sortKey-u.sortKey);for(let l of a){let{geometry:u,index:c,sourceLayerIndex:p}=l,d=e[c].feature;this.addFeature(l,u,c,r),t.featureIndex.insert(d,u,c,p,this.index)}}update(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Ioe),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,t,r,n){for(let a of t)for(let o of a){let s=o.x,l=o.y;if(s<0||s>=8192||l<0||l>=8192)continue;let u=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),c=u.vertexLength;Zd(this.layoutVertexArray,s,l,-1,-1),Zd(this.layoutVertexArray,s,l,1,-1),Zd(this.layoutVertexArray,s,l,1,1),Zd(this.layoutVertexArray,s,l,-1,1),this.indexArray.emplaceBack(c,c+1,c+2),this.indexArray.emplaceBack(c,c+3,c+2),u.vertexLength+=4,u.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,{},n)}};h(CF,"CircleBucket");var W4=CF;st("CircleBucket",W4,{omit:["layers"]});R();var zg=It(di(),1);function X4(i,e){for(let t=0;t<i.length;t++)if(Ku(e,i[t]))return!0;for(let t=0;t<e.length;t++)if(Ku(i,e[t]))return!0;return!!Cx(i,e)}h(X4,"polygonIntersectsPolygon");function EF(i,e,t){return!!(Ku(i,e)||lv(e,i,t))}h(EF,"polygonIntersectsBufferedPoint");function q4(i,e){if(i.length===1)return Tw(e,i[0]);for(let t=0;t<e.length;t++){let r=e[t];for(let n=0;n<r.length;n++)if(Ku(i,r[n]))return!0}for(let t=0;t<i.length;t++)if(Tw(e,i[t]))return!0;for(let t=0;t<e.length;t++)if(Cx(i,e[t]))return!0;return!1}h(q4,"polygonIntersectsMultiPolygon");function TF(i,e,t){for(let r=0;r<e.length;r++){let n=e[r];if(i.length>=3){for(let a=0;a<n.length;a++)if(Ku(i,n[a]))return!0}if(PF(i,n,t))return!0}return!1}h(TF,"polygonIntersectsBufferedMultiLine");function PF(i,e,t){if(i.length>1){if(Cx(i,e))return!0;for(let r=0;r<e.length;r++)if(lv(e[r],i,t))return!0}for(let r=0;r<i.length;r++)if(lv(i[r],e,t))return!0;return!1}h(PF,"lineIntersectsBufferedLine");function Cx(i,e){if(i.length===0||e.length===0)return!1;for(let t=0;t<i.length-1;t++){let r=i[t],n=i[t+1];for(let a=0;a<e.length-1;a++){let o=e[a],s=e[a+1];if(AF(r,n,o,s))return!0}}return!1}h(Cx,"lineIntersectsLine");function AF(i,e,t,r){return Ss(i,t,r)!==Ss(e,t,r)&&Ss(i,e,t)!==Ss(i,e,r)}h(AF,"lineSegmentIntersectsLineSegment");function lv(i,e,t){let r=t*t;if(e.length===1)return i.distSqr(e[0])<r;for(let n=1;n<e.length;n++){let a=e[n-1],o=e[n];if(IF(i,a,o)<r)return!0}return!1}h(lv,"pointIntersectsBufferedLine");function IF(i,e,t){let r=e.distSqr(t);if(r===0)return i.distSqr(e);let n=((i.x-e.x)*(t.x-e.x)+(i.y-e.y)*(t.y-e.y))/r;return n<0?i.distSqr(e):n>1?i.distSqr(t):i.distSqr(t.sub(e)._mult(n)._add(e))}h(IF,"distToSegmentSquared");function Tw(i,e){let t=!1,r,n,a;for(let o=0;o<i.length;o++){r=i[o];for(let s=0,l=r.length-1;s<r.length;l=s++)n=r[s],a=r[l],n.y>e.y!=a.y>e.y&&e.x<(a.x-n.x)*(e.y-n.y)/(a.y-n.y)+n.x&&(t=!t)}return t}h(Tw,"multiPolygonContainsPoint");function Ku(i,e){let t=!1;for(let r=0,n=i.length-1;r<i.length;n=r++){let a=i[r],o=i[n];a.y>e.y!=o.y>e.y&&e.x<(o.x-a.x)*(e.y-a.y)/(o.y-a.y)+a.x&&(t=!t)}return t}h(Ku,"polygonContainsPoint");function LF(i,e,t,r,n){for(let o of i)if(e<=o.x&&t<=o.y&&r>=o.x&&n>=o.y)return!0;let a=[new zg.default(e,t),new zg.default(e,n),new zg.default(r,n),new zg.default(r,t)];if(i.length>2){for(let o of a)if(Ku(i,o))return!0}for(let o=0;o<i.length-1;o++){let s=i[o],l=i[o+1];if(DF(s,l,a))return!0}return!1}h(LF,"polygonIntersectsBox");function DF(i,e,t){let r=t[0],n=t[2];if(i.x<r.x&&e.x<r.x||i.x>n.x&&e.x>n.x||i.y<r.y&&e.y<r.y||i.y>n.y&&e.y>n.y)return!1;let a=Ss(i,e,t[0]);return a!==Ss(i,e,t[1])||a!==Ss(i,e,t[2])||a!==Ss(i,e,t[3])}h(DF,"edgeIntersectsBox");R();var Pw=It(di(),1);function hp(i,e,t){let r=e.paint.get(i).value;return r.kind==="constant"?r.value:t.programConfigurations.get(e.id).getMaxValue(i)}h(hp,"getMaximumPaintValue");function Ym(i){return Math.sqrt(i[0]*i[0]+i[1]*i[1])}h(Ym,"translateDistance");function Jm(i,e,t,r,n){if(!e[0]&&!e[1])return i;let a=Pw.default.convert(e)._mult(n);t==="viewport"&&a._rotate(-r);let o=[];for(let s=0;s<i.length;s++){let l=i[s];o.push(l.sub(a))}return o}h(Jm,"translate");function kF(i,e){let t=[];for(let r=0;r<i.length;r++){let n=i[r],a=[];for(let o=0;o<n.length;o++){let s=n[o-1],l=n[o],u=n[o+1],c=o===0?new Pw.default(0,0):l.sub(s)._unit()._perp(),p=o===n.length-1?new Pw.default(0,0):u.sub(l)._unit()._perp(),d=c._add(p)._unit(),m=d.x*p.x+d.y*p.y;m!==0&&d._mult(1/m),a.push(d._mult(e)._add(l))}t.push(a)}return t}h(kF,"offsetLine");R();var zP,Roe=h(()=>zP=zP||new Zn({"circle-sort-key":new St(Le.layout_circle["circle-sort-key"])}),"getLayout"),BP,Foe=h(()=>BP=BP||new Zn({"circle-radius":new St(Le.paint_circle["circle-radius"]),"circle-color":new St(Le.paint_circle["circle-color"]),"circle-blur":new St(Le.paint_circle["circle-blur"]),"circle-opacity":new St(Le.paint_circle["circle-opacity"]),"circle-translate":new mt(Le.paint_circle["circle-translate"]),"circle-translate-anchor":new mt(Le.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new mt(Le.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new mt(Le.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new St(Le.paint_circle["circle-stroke-width"]),"circle-stroke-color":new St(Le.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new St(Le.paint_circle["circle-stroke-opacity"])}),"getPaint"),zoe={get paint(){return Foe()},get layout(){return Roe()}};R();R();var Gt=1e-6,Pi=typeof Float32Array<"u"?Float32Array:Array,Tu=Math.random;Math.hypot||(Math.hypot=function(){for(var i=0,e=arguments.length;e--;)i+=arguments[e]*arguments[e];return Math.sqrt(i)});var Aw={};oh(Aw,{LDU:()=>YF,add:()=>JF,adjoint:()=>VF,clone:()=>FF,copy:()=>zF,create:()=>RF,determinant:()=>jF,equals:()=>QF,exactEquals:()=>KF,frob:()=>ZF,fromRotation:()=>WF,fromScaling:()=>XF,fromValues:()=>OF,identity:()=>BF,invert:()=>UF,mul:()=>Boe,multiply:()=>Z4,multiplyScalar:()=>ez,multiplyScalarAndAdd:()=>tz,rotate:()=>HF,scale:()=>GF,set:()=>NF,str:()=>qF,sub:()=>Ooe,subtract:()=>Y4,transpose:()=>$F});R();function RF(){var i=new Pi(4);return Pi!=Float32Array&&(i[1]=0,i[2]=0),i[0]=1,i[3]=1,i}h(RF,"create");function FF(i){var e=new Pi(4);return e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e}h(FF,"clone");function zF(i,e){return i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i}h(zF,"copy");function BF(i){return i[0]=1,i[1]=0,i[2]=0,i[3]=1,i}h(BF,"identity");function OF(i,e,t,r){var n=new Pi(4);return n[0]=i,n[1]=e,n[2]=t,n[3]=r,n}h(OF,"fromValues");function NF(i,e,t,r,n){return i[0]=e,i[1]=t,i[2]=r,i[3]=n,i}h(NF,"set");function $F(i,e){if(i===e){var t=e[1];i[1]=e[2],i[2]=t}else i[0]=e[0],i[1]=e[2],i[2]=e[1],i[3]=e[3];return i}h($F,"transpose");function UF(i,e){var t=e[0],r=e[1],n=e[2],a=e[3],o=t*a-n*r;return o?(o=1/o,i[0]=a*o,i[1]=-r*o,i[2]=-n*o,i[3]=t*o,i):null}h(UF,"invert");function VF(i,e){var t=e[0];return i[0]=e[3],i[1]=-e[1],i[2]=-e[2],i[3]=t,i}h(VF,"adjoint");function jF(i){return i[0]*i[3]-i[2]*i[1]}h(jF,"determinant");function Z4(i,e,t){var r=e[0],n=e[1],a=e[2],o=e[3],s=t[0],l=t[1],u=t[2],c=t[3];return i[0]=r*s+a*l,i[1]=n*s+o*l,i[2]=r*u+a*c,i[3]=n*u+o*c,i}h(Z4,"multiply");function HF(i,e,t){var r=e[0],n=e[1],a=e[2],o=e[3],s=Math.sin(t),l=Math.cos(t);return i[0]=r*l+a*s,i[1]=n*l+o*s,i[2]=r*-s+a*l,i[3]=n*-s+o*l,i}h(HF,"rotate");function GF(i,e,t){var r=e[0],n=e[1],a=e[2],o=e[3],s=t[0],l=t[1];return i[0]=r*s,i[1]=n*s,i[2]=a*l,i[3]=o*l,i}h(GF,"scale");function WF(i,e){var t=Math.sin(e),r=Math.cos(e);return i[0]=r,i[1]=t,i[2]=-t,i[3]=r,i}h(WF,"fromRotation");function XF(i,e){return i[0]=e[0],i[1]=0,i[2]=0,i[3]=e[1],i}h(XF,"fromScaling");function qF(i){return"mat2("+i[0]+", "+i[1]+", "+i[2]+", "+i[3]+")"}h(qF,"str");function ZF(i){return Math.hypot(i[0],i[1],i[2],i[3])}h(ZF,"frob");function YF(i,e,t,r){return i[2]=r[2]/r[0],t[0]=r[0],t[1]=r[1],t[3]=r[3]-i[2]*t[1],[i,e,t]}h(YF,"LDU");function JF(i,e,t){return i[0]=e[0]+t[0],i[1]=e[1]+t[1],i[2]=e[2]+t[2],i[3]=e[3]+t[3],i}h(JF,"add");function Y4(i,e,t){return i[0]=e[0]-t[0],i[1]=e[1]-t[1],i[2]=e[2]-t[2],i[3]=e[3]-t[3],i}h(Y4,"subtract");function KF(i,e){return i[0]===e[0]&&i[1]===e[1]&&i[2]===e[2]&&i[3]===e[3]}h(KF,"exactEquals");function QF(i,e){var t=i[0],r=i[1],n=i[2],a=i[3],o=e[0],s=e[1],l=e[2],u=e[3];return Math.abs(t-o)<=Gt*Math.max(1,Math.abs(t),Math.abs(o))&&Math.abs(r-s)<=Gt*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(n-l)<=Gt*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(a-u)<=Gt*Math.max(1,Math.abs(a),Math.abs(u))}h(QF,"equals");function ez(i,e,t){return i[0]=e[0]*t,i[1]=e[1]*t,i[2]=e[2]*t,i[3]=e[3]*t,i}h(ez,"multiplyScalar");function tz(i,e,t,r){return i[0]=e[0]+t[0]*r,i[1]=e[1]+t[1]*r,i[2]=e[2]+t[2]*r,i[3]=e[3]+t[3]*r,i}h(tz,"multiplyScalarAndAdd");var Boe=Z4,Ooe=Y4,Iw={};oh(Iw,{add:()=>Cz,adjoint:()=>cz,clone:()=>nz,copy:()=>az,create:()=>iz,determinant:()=>pz,equals:()=>Az,exactEquals:()=>Pz,frob:()=>Mz,fromMat2d:()=>xz,fromMat4:()=>rz,fromQuat:()=>_z,fromRotation:()=>yz,fromScaling:()=>vz,fromTranslation:()=>gz,fromValues:()=>oz,identity:()=>lz,invert:()=>hz,mul:()=>Noe,multiply:()=>J4,multiplyScalar:()=>Ez,multiplyScalarAndAdd:()=>Tz,normalFromMat4:()=>bz,projection:()=>wz,rotate:()=>fz,scale:()=>mz,set:()=>sz,str:()=>Sz,sub:()=>$oe,subtract:()=>K4,translate:()=>dz,transpose:()=>uz});R();function iz(){var i=new Pi(9);return Pi!=Float32Array&&(i[1]=0,i[2]=0,i[3]=0,i[5]=0,i[6]=0,i[7]=0),i[0]=1,i[4]=1,i[8]=1,i}h(iz,"create");function rz(i,e){return i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[4],i[4]=e[5],i[5]=e[6],i[6]=e[8],i[7]=e[9],i[8]=e[10],i}h(rz,"fromMat4");function nz(i){var e=new Pi(9);return e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e[4]=i[4],e[5]=i[5],e[6]=i[6],e[7]=i[7],e[8]=i[8],e}h(nz,"clone");function az(i,e){return i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i[4]=e[4],i[5]=e[5],i[6]=e[6],i[7]=e[7],i[8]=e[8],i}h(az,"copy");function oz(i,e,t,r,n,a,o,s,l){var u=new Pi(9);return u[0]=i,u[1]=e,u[2]=t,u[3]=r,u[4]=n,u[5]=a,u[6]=o,u[7]=s,u[8]=l,u}h(oz,"fromValues");function sz(i,e,t,r,n,a,o,s,l,u){return i[0]=e,i[1]=t,i[2]=r,i[3]=n,i[4]=a,i[5]=o,i[6]=s,i[7]=l,i[8]=u,i}h(sz,"set");function lz(i){return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=1,i[5]=0,i[6]=0,i[7]=0,i[8]=1,i}h(lz,"identity");function uz(i,e){if(i===e){var t=e[1],r=e[2],n=e[5];i[1]=e[3],i[2]=e[6],i[3]=t,i[5]=e[7],i[6]=r,i[7]=n}else i[0]=e[0],i[1]=e[3],i[2]=e[6],i[3]=e[1],i[4]=e[4],i[5]=e[7],i[6]=e[2],i[7]=e[5],i[8]=e[8];return i}h(uz,"transpose");function hz(i,e){var t=e[0],r=e[1],n=e[2],a=e[3],o=e[4],s=e[5],l=e[6],u=e[7],c=e[8],p=c*o-s*u,d=-c*a+s*l,m=u*a-o*l,g=t*p+r*d+n*m;return g?(g=1/g,i[0]=p*g,i[1]=(-c*r+n*u)*g,i[2]=(s*r-n*o)*g,i[3]=d*g,i[4]=(c*t-n*l)*g,i[5]=(-s*t+n*a)*g,i[6]=m*g,i[7]=(-u*t+r*l)*g,i[8]=(o*t-r*a)*g,i):null}h(hz,"invert");function cz(i,e){var t=e[0],r=e[1],n=e[2],a=e[3],o=e[4],s=e[5],l=e[6],u=e[7],c=e[8];return i[0]=o*c-s*u,i[1]=n*u-r*c,i[2]=r*s-n*o,i[3]=s*l-a*c,i[4]=t*c-n*l,i[5]=n*a-t*s,i[6]=a*u-o*l,i[7]=r*l-t*u,i[8]=t*o-r*a,i}h(cz,"adjoint");function pz(i){var e=i[0],t=i[1],r=i[2],n=i[3],a=i[4],o=i[5],s=i[6],l=i[7],u=i[8];return e*(u*a-o*l)+t*(-u*n+o*s)+r*(l*n-a*s)}h(pz,"determinant");function J4(i,e,t){var r=e[0],n=e[1],a=e[2],o=e[3],s=e[4],l=e[5],u=e[6],c=e[7],p=e[8],d=t[0],m=t[1],g=t[2],b=t[3],x=t[4],v=t[5],w=t[6],_=t[7],C=t[8];return i[0]=d*r+m*o+g*u,i[1]=d*n+m*s+g*c,i[2]=d*a+m*l+g*p,i[3]=b*r+x*o+v*u,i[4]=b*n+x*s+v*c,i[5]=b*a+x*l+v*p,i[6]=w*r+_*o+C*u,i[7]=w*n+_*s+C*c,i[8]=w*a+_*l+C*p,i}h(J4,"multiply");function dz(i,e,t){var r=e[0],n=e[1],a=e[2],o=e[3],s=e[4],l=e[5],u=e[6],c=e[7],p=e[8],d=t[0],m=t[1];return i[0]=r,i[1]=n,i[2]=a,i[3]=o,i[4]=s,i[5]=l,i[6]=d*r+m*o+u,i[7]=d*n+m*s+c,i[8]=d*a+m*l+p,i}h(dz,"translate");function fz(i,e,t){var r=e[0],n=e[1],a=e[2],o=e[3],s=e[4],l=e[5],u=e[6],c=e[7],p=e[8],d=Math.sin(t),m=Math.cos(t);return i[0]=m*r+d*o,i[1]=m*n+d*s,i[2]=m*a+d*l,i[3]=m*o-d*r,i[4]=m*s-d*n,i[5]=m*l-d*a,i[6]=u,i[7]=c,i[8]=p,i}h(fz,"rotate");function mz(i,e,t){var r=t[0],n=t[1];return i[0]=r*e[0],i[1]=r*e[1],i[2]=r*e[2],i[3]=n*e[3],i[4]=n*e[4],i[5]=n*e[5],i[6]=e[6],i[7]=e[7],i[8]=e[8],i}h(mz,"scale");function gz(i,e){return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=1,i[5]=0,i[6]=e[0],i[7]=e[1],i[8]=1,i}h(gz,"fromTranslation");function yz(i,e){var t=Math.sin(e),r=Math.cos(e);return i[0]=r,i[1]=t,i[2]=0,i[3]=-t,i[4]=r,i[5]=0,i[6]=0,i[7]=0,i[8]=1,i}h(yz,"fromRotation");function vz(i,e){return i[0]=e[0],i[1]=0,i[2]=0,i[3]=0,i[4]=e[1],i[5]=0,i[6]=0,i[7]=0,i[8]=1,i}h(vz,"fromScaling");function xz(i,e){return i[0]=e[0],i[1]=e[1],i[2]=0,i[3]=e[2],i[4]=e[3],i[5]=0,i[6]=e[4],i[7]=e[5],i[8]=1,i}h(xz,"fromMat2d");function _z(i,e){var t=e[0],r=e[1],n=e[2],a=e[3],o=t+t,s=r+r,l=n+n,u=t*o,c=r*o,p=r*s,d=n*o,m=n*s,g=n*l,b=a*o,x=a*s,v=a*l;return i[0]=1-p-g,i[3]=c-v,i[6]=d+x,i[1]=c+v,i[4]=1-u-g,i[7]=m-b,i[2]=d-x,i[5]=m+b,i[8]=1-u-p,i}h(_z,"fromQuat");function bz(i,e){var t=e[0],r=e[1],n=e[2],a=e[3],o=e[4],s=e[5],l=e[6],u=e[7],c=e[8],p=e[9],d=e[10],m=e[11],g=e[12],b=e[13],x=e[14],v=e[15],w=t*s-r*o,_=t*l-n*o,C=t*u-a*o,E=r*l-n*s,T=r*u-a*s,L=n*u-a*l,D=c*b-p*g,B=c*x-d*g,A=c*v-m*g,k=p*x-d*b,$=p*v-m*b,O=d*v-m*x,P=w*O-_*$+C*k+E*A-T*B+L*D;return P?(P=1/P,i[0]=(s*O-l*$+u*k)*P,i[1]=(l*A-o*O-u*B)*P,i[2]=(o*$-s*A+u*D)*P,i[3]=(n*$-r*O-a*k)*P,i[4]=(t*O-n*A+a*B)*P,i[5]=(r*A-t*$-a*D)*P,i[6]=(b*L-x*T+v*E)*P,i[7]=(x*C-g*L-v*_)*P,i[8]=(g*T-b*C+v*w)*P,i):null}h(bz,"normalFromMat4");function wz(i,e,t){return i[0]=2/e,i[1]=0,i[2]=0,i[3]=0,i[4]=-2/t,i[5]=0,i[6]=-1,i[7]=1,i[8]=1,i}h(wz,"projection");function Sz(i){return"mat3("+i[0]+", "+i[1]+", "+i[2]+", "+i[3]+", "+i[4]+", "+i[5]+", "+i[6]+", "+i[7]+", "+i[8]+")"}h(Sz,"str");function Mz(i){return Math.hypot(i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7],i[8])}h(Mz,"frob");function Cz(i,e,t){return i[0]=e[0]+t[0],i[1]=e[1]+t[1],i[2]=e[2]+t[2],i[3]=e[3]+t[3],i[4]=e[4]+t[4],i[5]=e[5]+t[5],i[6]=e[6]+t[6],i[7]=e[7]+t[7],i[8]=e[8]+t[8],i}h(Cz,"add");function K4(i,e,t){return i[0]=e[0]-t[0],i[1]=e[1]-t[1],i[2]=e[2]-t[2],i[3]=e[3]-t[3],i[4]=e[4]-t[4],i[5]=e[5]-t[5],i[6]=e[6]-t[6],i[7]=e[7]-t[7],i[8]=e[8]-t[8],i}h(K4,"subtract");function Ez(i,e,t){return i[0]=e[0]*t,i[1]=e[1]*t,i[2]=e[2]*t,i[3]=e[3]*t,i[4]=e[4]*t,i[5]=e[5]*t,i[6]=e[6]*t,i[7]=e[7]*t,i[8]=e[8]*t,i}h(Ez,"multiplyScalar");function Tz(i,e,t,r){return i[0]=e[0]+t[0]*r,i[1]=e[1]+t[1]*r,i[2]=e[2]+t[2]*r,i[3]=e[3]+t[3]*r,i[4]=e[4]+t[4]*r,i[5]=e[5]+t[5]*r,i[6]=e[6]+t[6]*r,i[7]=e[7]+t[7]*r,i[8]=e[8]+t[8]*r,i}h(Tz,"multiplyScalarAndAdd");function Pz(i,e){return i[0]===e[0]&&i[1]===e[1]&&i[2]===e[2]&&i[3]===e[3]&&i[4]===e[4]&&i[5]===e[5]&&i[6]===e[6]&&i[7]===e[7]&&i[8]===e[8]}h(Pz,"exactEquals");function Az(i,e){var t=i[0],r=i[1],n=i[2],a=i[3],o=i[4],s=i[5],l=i[6],u=i[7],c=i[8],p=e[0],d=e[1],m=e[2],g=e[3],b=e[4],x=e[5],v=e[6],w=e[7],_=e[8];return Math.abs(t-p)<=Gt*Math.max(1,Math.abs(t),Math.abs(p))&&Math.abs(r-d)<=Gt*Math.max(1,Math.abs(r),Math.abs(d))&&Math.abs(n-m)<=Gt*Math.max(1,Math.abs(n),Math.abs(m))&&Math.abs(a-g)<=Gt*Math.max(1,Math.abs(a),Math.abs(g))&&Math.abs(o-b)<=Gt*Math.max(1,Math.abs(o),Math.abs(b))&&Math.abs(s-x)<=Gt*Math.max(1,Math.abs(s),Math.abs(x))&&Math.abs(l-v)<=Gt*Math.max(1,Math.abs(l),Math.abs(v))&&Math.abs(u-w)<=Gt*Math.max(1,Math.abs(u),Math.abs(w))&&Math.abs(c-_)<=Gt*Math.max(1,Math.abs(c),Math.abs(_))}h(Az,"equals");var Noe=J4,$oe=K4,lt={};oh(lt,{add:()=>cB,adjoint:()=>Bz,clone:()=>Lz,copy:()=>Dz,create:()=>Iz,determinant:()=>Oz,equals:()=>mB,exactEquals:()=>fB,frob:()=>hB,fromQuat:()=>iB,fromQuat2:()=>Jz,fromRotation:()=>Xz,fromRotationTranslation:()=>t5,fromRotationTranslationScale:()=>eB,fromRotationTranslationScaleOrigin:()=>tB,fromScaling:()=>Wz,fromTranslation:()=>Gz,fromValues:()=>kz,fromXRotation:()=>qz,fromYRotation:()=>Zz,fromZRotation:()=>Yz,frustum:()=>rB,getRotation:()=>Qz,getScaling:()=>i5,getTranslation:()=>Kz,identity:()=>Q4,invert:()=>zz,lookAt:()=>sB,mul:()=>joe,multiply:()=>e5,multiplyScalar:()=>pB,multiplyScalarAndAdd:()=>dB,ortho:()=>Voe,orthoNO:()=>n5,orthoZO:()=>oB,perspective:()=>Uoe,perspectiveFromFieldOfView:()=>aB,perspectiveNO:()=>r5,perspectiveZO:()=>nB,rotate:()=>Uz,rotateX:()=>Vz,rotateY:()=>jz,rotateZ:()=>Hz,scale:()=>$z,set:()=>Rz,str:()=>uB,sub:()=>Hoe,subtract:()=>a5,targetTo:()=>lB,translate:()=>Nz,transpose:()=>Fz});R();function Iz(){var i=new Pi(16);return Pi!=Float32Array&&(i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0),i[0]=1,i[5]=1,i[10]=1,i[15]=1,i}h(Iz,"create");function Lz(i){var e=new Pi(16);return e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e[4]=i[4],e[5]=i[5],e[6]=i[6],e[7]=i[7],e[8]=i[8],e[9]=i[9],e[10]=i[10],e[11]=i[11],e[12]=i[12],e[13]=i[13],e[14]=i[14],e[15]=i[15],e}h(Lz,"clone");function Dz(i,e){return i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i[4]=e[4],i[5]=e[5],i[6]=e[6],i[7]=e[7],i[8]=e[8],i[9]=e[9],i[10]=e[10],i[11]=e[11],i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15],i}h(Dz,"copy");function kz(i,e,t,r,n,a,o,s,l,u,c,p,d,m,g,b){var x=new Pi(16);return x[0]=i,x[1]=e,x[2]=t,x[3]=r,x[4]=n,x[5]=a,x[6]=o,x[7]=s,x[8]=l,x[9]=u,x[10]=c,x[11]=p,x[12]=d,x[13]=m,x[14]=g,x[15]=b,x}h(kz,"fromValues");function Rz(i,e,t,r,n,a,o,s,l,u,c,p,d,m,g,b,x){return i[0]=e,i[1]=t,i[2]=r,i[3]=n,i[4]=a,i[5]=o,i[6]=s,i[7]=l,i[8]=u,i[9]=c,i[10]=p,i[11]=d,i[12]=m,i[13]=g,i[14]=b,i[15]=x,i}h(Rz,"set");function Q4(i){return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}h(Q4,"identity");function Fz(i,e){if(i===e){var t=e[1],r=e[2],n=e[3],a=e[6],o=e[7],s=e[11];i[1]=e[4],i[2]=e[8],i[3]=e[12],i[4]=t,i[6]=e[9],i[7]=e[13],i[8]=r,i[9]=a,i[11]=e[14],i[12]=n,i[13]=o,i[14]=s}else i[0]=e[0],i[1]=e[4],i[2]=e[8],i[3]=e[12],i[4]=e[1],i[5]=e[5],i[6]=e[9],i[7]=e[13],i[8]=e[2],i[9]=e[6],i[10]=e[10],i[11]=e[14],i[12]=e[3],i[13]=e[7],i[14]=e[11],i[15]=e[15];return i}h(Fz,"transpose");function zz(i,e){var t=e[0],r=e[1],n=e[2],a=e[3],o=e[4],s=e[5],l=e[6],u=e[7],c=e[8],p=e[9],d=e[10],m=e[11],g=e[12],b=e[13],x=e[14],v=e[15],w=t*s-r*o,_=t*l-n*o,C=t*u-a*o,E=r*l-n*s,T=r*u-a*s,L=n*u-a*l,D=c*b-p*g,B=c*x-d*g,A=c*v-m*g,k=p*x-d*b,$=p*v-m*b,O=d*v-m*x,P=w*O-_*$+C*k+E*A-T*B+L*D;return P?(P=1/P,i[0]=(s*O-l*$+u*k)*P,i[1]=(n*$-r*O-a*k)*P,i[2]=(b*L-x*T+v*E)*P,i[3]=(d*T-p*L-m*E)*P,i[4]=(l*A-o*O-u*B)*P,i[5]=(t*O-n*A+a*B)*P,i[6]=(x*C-g*L-v*_)*P,i[7]=(c*L-d*C+m*_)*P,i[8]=(o*$-s*A+u*D)*P,i[9]=(r*A-t*$-a*D)*P,i[10]=(g*T-b*C+v*w)*P,i[11]=(p*C-c*T-m*w)*P,i[12]=(s*B-o*k-l*D)*P,i[13]=(t*k-r*B+n*D)*P,i[14]=(b*_-g*E-x*w)*P,i[15]=(c*E-p*_+d*w)*P,i):null}h(zz,"invert");function Bz(i,e){var t=e[0],r=e[1],n=e[2],a=e[3],o=e[4],s=e[5],l=e[6],u=e[7],c=e[8],p=e[9],d=e[10],m=e[11],g=e[12],b=e[13],x=e[14],v=e[15];return i[0]=s*(d*v-m*x)-p*(l*v-u*x)+b*(l*m-u*d),i[1]=-(r*(d*v-m*x)-p*(n*v-a*x)+b*(n*m-a*d)),i[2]=r*(l*v-u*x)-s*(n*v-a*x)+b*(n*u-a*l),i[3]=-(r*(l*m-u*d)-s*(n*m-a*d)+p*(n*u-a*l)),i[4]=-(o*(d*v-m*x)-c*(l*v-u*x)+g*(l*m-u*d)),i[5]=t*(d*v-m*x)-c*(n*v-a*x)+g*(n*m-a*d),i[6]=-(t*(l*v-u*x)-o*(n*v-a*x)+g*(n*u-a*l)),i[7]=t*(l*m-u*d)-o*(n*m-a*d)+c*(n*u-a*l),i[8]=o*(p*v-m*b)-c*(s*v-u*b)+g*(s*m-u*p),i[9]=-(t*(p*v-m*b)-c*(r*v-a*b)+g*(r*m-a*p)),i[10]=t*(s*v-u*b)-o*(r*v-a*b)+g*(r*u-a*s),i[11]=-(t*(s*m-u*p)-o*(r*m-a*p)+c*(r*u-a*s)),i[12]=-(o*(p*x-d*b)-c*(s*x-l*b)+g*(s*d-l*p)),i[13]=t*(p*x-d*b)-c*(r*x-n*b)+g*(r*d-n*p),i[14]=-(t*(s*x-l*b)-o*(r*x-n*b)+g*(r*l-n*s)),i[15]=t*(s*d-l*p)-o*(r*d-n*p)+c*(r*l-n*s),i}h(Bz,"adjoint");function Oz(i){var e=i[0],t=i[1],r=i[2],n=i[3],a=i[4],o=i[5],s=i[6],l=i[7],u=i[8],c=i[9],p=i[10],d=i[11],m=i[12],g=i[13],b=i[14],x=i[15],v=e*o-t*a,w=e*s-r*a,_=e*l-n*a,C=t*s-r*o,E=t*l-n*o,T=r*l-n*s,L=u*g-c*m,D=u*b-p*m,B=u*x-d*m,A=c*b-p*g,k=c*x-d*g,$=p*x-d*b;return v*$-w*k+_*A+C*B-E*D+T*L}h(Oz,"determinant");function e5(i,e,t){var r=e[0],n=e[1],a=e[2],o=e[3],s=e[4],l=e[5],u=e[6],c=e[7],p=e[8],d=e[9],m=e[10],g=e[11],b=e[12],x=e[13],v=e[14],w=e[15],_=t[0],C=t[1],E=t[2],T=t[3];return i[0]=_*r+C*s+E*p+T*b,i[1]=_*n+C*l+E*d+T*x,i[2]=_*a+C*u+E*m+T*v,i[3]=_*o+C*c+E*g+T*w,_=t[4],C=t[5],E=t[6],T=t[7],i[4]=_*r+C*s+E*p+T*b,i[5]=_*n+C*l+E*d+T*x,i[6]=_*a+C*u+E*m+T*v,i[7]=_*o+C*c+E*g+T*w,_=t[8],C=t[9],E=t[10],T=t[11],i[8]=_*r+C*s+E*p+T*b,i[9]=_*n+C*l+E*d+T*x,i[10]=_*a+C*u+E*m+T*v,i[11]=_*o+C*c+E*g+T*w,_=t[12],C=t[13],E=t[14],T=t[15],i[12]=_*r+C*s+E*p+T*b,i[13]=_*n+C*l+E*d+T*x,i[14]=_*a+C*u+E*m+T*v,i[15]=_*o+C*c+E*g+T*w,i}h(e5,"multiply");function Nz(i,e,t){var r=t[0],n=t[1],a=t[2],o,s,l,u,c,p,d,m,g,b,x,v;return e===i?(i[12]=e[0]*r+e[4]*n+e[8]*a+e[12],i[13]=e[1]*r+e[5]*n+e[9]*a+e[13],i[14]=e[2]*r+e[6]*n+e[10]*a+e[14],i[15]=e[3]*r+e[7]*n+e[11]*a+e[15]):(o=e[0],s=e[1],l=e[2],u=e[3],c=e[4],p=e[5],d=e[6],m=e[7],g=e[8],b=e[9],x=e[10],v=e[11],i[0]=o,i[1]=s,i[2]=l,i[3]=u,i[4]=c,i[5]=p,i[6]=d,i[7]=m,i[8]=g,i[9]=b,i[10]=x,i[11]=v,i[12]=o*r+c*n+g*a+e[12],i[13]=s*r+p*n+b*a+e[13],i[14]=l*r+d*n+x*a+e[14],i[15]=u*r+m*n+v*a+e[15]),i}h(Nz,"translate");function $z(i,e,t){var r=t[0],n=t[1],a=t[2];return i[0]=e[0]*r,i[1]=e[1]*r,i[2]=e[2]*r,i[3]=e[3]*r,i[4]=e[4]*n,i[5]=e[5]*n,i[6]=e[6]*n,i[7]=e[7]*n,i[8]=e[8]*a,i[9]=e[9]*a,i[10]=e[10]*a,i[11]=e[11]*a,i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15],i}h($z,"scale");function Uz(i,e,t,r){var n=r[0],a=r[1],o=r[2],s=Math.hypot(n,a,o),l,u,c,p,d,m,g,b,x,v,w,_,C,E,T,L,D,B,A,k,$,O,P,U;return s<Gt?null:(s=1/s,n*=s,a*=s,o*=s,l=Math.sin(t),u=Math.cos(t),c=1-u,p=e[0],d=e[1],m=e[2],g=e[3],b=e[4],x=e[5],v=e[6],w=e[7],_=e[8],C=e[9],E=e[10],T=e[11],L=n*n*c+u,D=a*n*c+o*l,B=o*n*c-a*l,A=n*a*c-o*l,k=a*a*c+u,$=o*a*c+n*l,O=n*o*c+a*l,P=a*o*c-n*l,U=o*o*c+u,i[0]=p*L+b*D+_*B,i[1]=d*L+x*D+C*B,i[2]=m*L+v*D+E*B,i[3]=g*L+w*D+T*B,i[4]=p*A+b*k+_*$,i[5]=d*A+x*k+C*$,i[6]=m*A+v*k+E*$,i[7]=g*A+w*k+T*$,i[8]=p*O+b*P+_*U,i[9]=d*O+x*P+C*U,i[10]=m*O+v*P+E*U,i[11]=g*O+w*P+T*U,e!==i&&(i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15]),i)}h(Uz,"rotate");function Vz(i,e,t){var r=Math.sin(t),n=Math.cos(t),a=e[4],o=e[5],s=e[6],l=e[7],u=e[8],c=e[9],p=e[10],d=e[11];return e!==i&&(i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15]),i[4]=a*n+u*r,i[5]=o*n+c*r,i[6]=s*n+p*r,i[7]=l*n+d*r,i[8]=u*n-a*r,i[9]=c*n-o*r,i[10]=p*n-s*r,i[11]=d*n-l*r,i}h(Vz,"rotateX");function jz(i,e,t){var r=Math.sin(t),n=Math.cos(t),a=e[0],o=e[1],s=e[2],l=e[3],u=e[8],c=e[9],p=e[10],d=e[11];return e!==i&&(i[4]=e[4],i[5]=e[5],i[6]=e[6],i[7]=e[7],i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15]),i[0]=a*n-u*r,i[1]=o*n-c*r,i[2]=s*n-p*r,i[3]=l*n-d*r,i[8]=a*r+u*n,i[9]=o*r+c*n,i[10]=s*r+p*n,i[11]=l*r+d*n,i}h(jz,"rotateY");function Hz(i,e,t){var r=Math.sin(t),n=Math.cos(t),a=e[0],o=e[1],s=e[2],l=e[3],u=e[4],c=e[5],p=e[6],d=e[7];return e!==i&&(i[8]=e[8],i[9]=e[9],i[10]=e[10],i[11]=e[11],i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15]),i[0]=a*n+u*r,i[1]=o*n+c*r,i[2]=s*n+p*r,i[3]=l*n+d*r,i[4]=u*n-a*r,i[5]=c*n-o*r,i[6]=p*n-s*r,i[7]=d*n-l*r,i}h(Hz,"rotateZ");function Gz(i,e){return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=e[0],i[13]=e[1],i[14]=e[2],i[15]=1,i}h(Gz,"fromTranslation");function Wz(i,e){return i[0]=e[0],i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=e[1],i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=e[2],i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}h(Wz,"fromScaling");function Xz(i,e,t){var r=t[0],n=t[1],a=t[2],o=Math.hypot(r,n,a),s,l,u;return o<Gt?null:(o=1/o,r*=o,n*=o,a*=o,s=Math.sin(e),l=Math.cos(e),u=1-l,i[0]=r*r*u+l,i[1]=n*r*u+a*s,i[2]=a*r*u-n*s,i[3]=0,i[4]=r*n*u-a*s,i[5]=n*n*u+l,i[6]=a*n*u+r*s,i[7]=0,i[8]=r*a*u+n*s,i[9]=n*a*u-r*s,i[10]=a*a*u+l,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i)}h(Xz,"fromRotation");function qz(i,e){var t=Math.sin(e),r=Math.cos(e);return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=r,i[6]=t,i[7]=0,i[8]=0,i[9]=-t,i[10]=r,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}h(qz,"fromXRotation");function Zz(i,e){var t=Math.sin(e),r=Math.cos(e);return i[0]=r,i[1]=0,i[2]=-t,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=t,i[9]=0,i[10]=r,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}h(Zz,"fromYRotation");function Yz(i,e){var t=Math.sin(e),r=Math.cos(e);return i[0]=r,i[1]=t,i[2]=0,i[3]=0,i[4]=-t,i[5]=r,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}h(Yz,"fromZRotation");function t5(i,e,t){var r=e[0],n=e[1],a=e[2],o=e[3],s=r+r,l=n+n,u=a+a,c=r*s,p=r*l,d=r*u,m=n*l,g=n*u,b=a*u,x=o*s,v=o*l,w=o*u;return i[0]=1-(m+b),i[1]=p+w,i[2]=d-v,i[3]=0,i[4]=p-w,i[5]=1-(c+b),i[6]=g+x,i[7]=0,i[8]=d+v,i[9]=g-x,i[10]=1-(c+m),i[11]=0,i[12]=t[0],i[13]=t[1],i[14]=t[2],i[15]=1,i}h(t5,"fromRotationTranslation");function Jz(i,e){var t=new Pi(3),r=-e[0],n=-e[1],a=-e[2],o=e[3],s=e[4],l=e[5],u=e[6],c=e[7],p=r*r+n*n+a*a+o*o;return p>0?(t[0]=(s*o+c*r+l*a-u*n)*2/p,t[1]=(l*o+c*n+u*r-s*a)*2/p,t[2]=(u*o+c*a+s*n-l*r)*2/p):(t[0]=(s*o+c*r+l*a-u*n)*2,t[1]=(l*o+c*n+u*r-s*a)*2,t[2]=(u*o+c*a+s*n-l*r)*2),t5(i,e,t),i}h(Jz,"fromQuat2");function Kz(i,e){return i[0]=e[12],i[1]=e[13],i[2]=e[14],i}h(Kz,"getTranslation");function i5(i,e){var t=e[0],r=e[1],n=e[2],a=e[4],o=e[5],s=e[6],l=e[8],u=e[9],c=e[10];return i[0]=Math.hypot(t,r,n),i[1]=Math.hypot(a,o,s),i[2]=Math.hypot(l,u,c),i}h(i5,"getScaling");function Qz(i,e){var t=new Pi(3);i5(t,e);var r=1/t[0],n=1/t[1],a=1/t[2],o=e[0]*r,s=e[1]*n,l=e[2]*a,u=e[4]*r,c=e[5]*n,p=e[6]*a,d=e[8]*r,m=e[9]*n,g=e[10]*a,b=o+c+g,x=0;return b>0?(x=Math.sqrt(b+1)*2,i[3]=.25*x,i[0]=(p-m)/x,i[1]=(d-l)/x,i[2]=(s-u)/x):o>c&&o>g?(x=Math.sqrt(1+o-c-g)*2,i[3]=(p-m)/x,i[0]=.25*x,i[1]=(s+u)/x,i[2]=(d+l)/x):c>g?(x=Math.sqrt(1+c-o-g)*2,i[3]=(d-l)/x,i[0]=(s+u)/x,i[1]=.25*x,i[2]=(p+m)/x):(x=Math.sqrt(1+g-o-c)*2,i[3]=(s-u)/x,i[0]=(d+l)/x,i[1]=(p+m)/x,i[2]=.25*x),i}h(Qz,"getRotation");function eB(i,e,t,r){var n=e[0],a=e[1],o=e[2],s=e[3],l=n+n,u=a+a,c=o+o,p=n*l,d=n*u,m=n*c,g=a*u,b=a*c,x=o*c,v=s*l,w=s*u,_=s*c,C=r[0],E=r[1],T=r[2];return i[0]=(1-(g+x))*C,i[1]=(d+_)*C,i[2]=(m-w)*C,i[3]=0,i[4]=(d-_)*E,i[5]=(1-(p+x))*E,i[6]=(b+v)*E,i[7]=0,i[8]=(m+w)*T,i[9]=(b-v)*T,i[10]=(1-(p+g))*T,i[11]=0,i[12]=t[0],i[13]=t[1],i[14]=t[2],i[15]=1,i}h(eB,"fromRotationTranslationScale");function tB(i,e,t,r,n){var a=e[0],o=e[1],s=e[2],l=e[3],u=a+a,c=o+o,p=s+s,d=a*u,m=a*c,g=a*p,b=o*c,x=o*p,v=s*p,w=l*u,_=l*c,C=l*p,E=r[0],T=r[1],L=r[2],D=n[0],B=n[1],A=n[2],k=(1-(b+v))*E,$=(m+C)*E,O=(g-_)*E,P=(m-C)*T,U=(1-(d+v))*T,G=(x+w)*T,K=(g+_)*L,z=(x-w)*L,V=(1-(d+b))*L;return i[0]=k,i[1]=$,i[2]=O,i[3]=0,i[4]=P,i[5]=U,i[6]=G,i[7]=0,i[8]=K,i[9]=z,i[10]=V,i[11]=0,i[12]=t[0]+D-(k*D+P*B+K*A),i[13]=t[1]+B-($*D+U*B+z*A),i[14]=t[2]+A-(O*D+G*B+V*A),i[15]=1,i}h(tB,"fromRotationTranslationScaleOrigin");function iB(i,e){var t=e[0],r=e[1],n=e[2],a=e[3],o=t+t,s=r+r,l=n+n,u=t*o,c=r*o,p=r*s,d=n*o,m=n*s,g=n*l,b=a*o,x=a*s,v=a*l;return i[0]=1-p-g,i[1]=c+v,i[2]=d-x,i[3]=0,i[4]=c-v,i[5]=1-u-g,i[6]=m+b,i[7]=0,i[8]=d+x,i[9]=m-b,i[10]=1-u-p,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}h(iB,"fromQuat");function rB(i,e,t,r,n,a,o){var s=1/(t-e),l=1/(n-r),u=1/(a-o);return i[0]=a*2*s,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=a*2*l,i[6]=0,i[7]=0,i[8]=(t+e)*s,i[9]=(n+r)*l,i[10]=(o+a)*u,i[11]=-1,i[12]=0,i[13]=0,i[14]=o*a*2*u,i[15]=0,i}h(rB,"frustum");function r5(i,e,t,r,n){var a=1/Math.tan(e/2),o;return i[0]=a/t,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=a,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=-1,i[12]=0,i[13]=0,i[15]=0,n!=null&&n!==1/0?(o=1/(r-n),i[10]=(n+r)*o,i[14]=2*n*r*o):(i[10]=-1,i[14]=-2*r),i}h(r5,"perspectiveNO");var Uoe=r5;function nB(i,e,t,r,n){var a=1/Math.tan(e/2),o;return i[0]=a/t,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=a,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=-1,i[12]=0,i[13]=0,i[15]=0,n!=null&&n!==1/0?(o=1/(r-n),i[10]=n*o,i[14]=n*r*o):(i[10]=-1,i[14]=-r),i}h(nB,"perspectiveZO");function aB(i,e,t,r){var n=Math.tan(e.upDegrees*Math.PI/180),a=Math.tan(e.downDegrees*Math.PI/180),o=Math.tan(e.leftDegrees*Math.PI/180),s=Math.tan(e.rightDegrees*Math.PI/180),l=2/(o+s),u=2/(n+a);return i[0]=l,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=u,i[6]=0,i[7]=0,i[8]=-((o-s)*l*.5),i[9]=(n-a)*u*.5,i[10]=r/(t-r),i[11]=-1,i[12]=0,i[13]=0,i[14]=r*t/(t-r),i[15]=0,i}h(aB,"perspectiveFromFieldOfView");function n5(i,e,t,r,n,a,o){var s=1/(e-t),l=1/(r-n),u=1/(a-o);return i[0]=-2*s,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=-2*l,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=2*u,i[11]=0,i[12]=(e+t)*s,i[13]=(n+r)*l,i[14]=(o+a)*u,i[15]=1,i}h(n5,"orthoNO");var Voe=n5;function oB(i,e,t,r,n,a,o){var s=1/(e-t),l=1/(r-n),u=1/(a-o);return i[0]=-2*s,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=-2*l,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=u,i[11]=0,i[12]=(e+t)*s,i[13]=(n+r)*l,i[14]=a*u,i[15]=1,i}h(oB,"orthoZO");function sB(i,e,t,r){var n,a,o,s,l,u,c,p,d,m,g=e[0],b=e[1],x=e[2],v=r[0],w=r[1],_=r[2],C=t[0],E=t[1],T=t[2];return Math.abs(g-C)<Gt&&Math.abs(b-E)<Gt&&Math.abs(x-T)<Gt?Q4(i):(c=g-C,p=b-E,d=x-T,m=1/Math.hypot(c,p,d),c*=m,p*=m,d*=m,n=w*d-_*p,a=_*c-v*d,o=v*p-w*c,m=Math.hypot(n,a,o),m?(m=1/m,n*=m,a*=m,o*=m):(n=0,a=0,o=0),s=p*o-d*a,l=d*n-c*o,u=c*a-p*n,m=Math.hypot(s,l,u),m?(m=1/m,s*=m,l*=m,u*=m):(s=0,l=0,u=0),i[0]=n,i[1]=s,i[2]=c,i[3]=0,i[4]=a,i[5]=l,i[6]=p,i[7]=0,i[8]=o,i[9]=u,i[10]=d,i[11]=0,i[12]=-(n*g+a*b+o*x),i[13]=-(s*g+l*b+u*x),i[14]=-(c*g+p*b+d*x),i[15]=1,i)}h(sB,"lookAt");function lB(i,e,t,r){var n=e[0],a=e[1],o=e[2],s=r[0],l=r[1],u=r[2],c=n-t[0],p=a-t[1],d=o-t[2],m=c*c+p*p+d*d;m>0&&(m=1/Math.sqrt(m),c*=m,p*=m,d*=m);var g=l*d-u*p,b=u*c-s*d,x=s*p-l*c;return m=g*g+b*b+x*x,m>0&&(m=1/Math.sqrt(m),g*=m,b*=m,x*=m),i[0]=g,i[1]=b,i[2]=x,i[3]=0,i[4]=p*x-d*b,i[5]=d*g-c*x,i[6]=c*b-p*g,i[7]=0,i[8]=c,i[9]=p,i[10]=d,i[11]=0,i[12]=n,i[13]=a,i[14]=o,i[15]=1,i}h(lB,"targetTo");function uB(i){return"mat4("+i[0]+", "+i[1]+", "+i[2]+", "+i[3]+", "+i[4]+", "+i[5]+", "+i[6]+", "+i[7]+", "+i[8]+", "+i[9]+", "+i[10]+", "+i[11]+", "+i[12]+", "+i[13]+", "+i[14]+", "+i[15]+")"}h(uB,"str");function hB(i){return Math.hypot(i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7],i[8],i[9],i[10],i[11],i[12],i[13],i[14],i[15])}h(hB,"frob");function cB(i,e,t){return i[0]=e[0]+t[0],i[1]=e[1]+t[1],i[2]=e[2]+t[2],i[3]=e[3]+t[3],i[4]=e[4]+t[4],i[5]=e[5]+t[5],i[6]=e[6]+t[6],i[7]=e[7]+t[7],i[8]=e[8]+t[8],i[9]=e[9]+t[9],i[10]=e[10]+t[10],i[11]=e[11]+t[11],i[12]=e[12]+t[12],i[13]=e[13]+t[13],i[14]=e[14]+t[14],i[15]=e[15]+t[15],i}h(cB,"add");function a5(i,e,t){return i[0]=e[0]-t[0],i[1]=e[1]-t[1],i[2]=e[2]-t[2],i[3]=e[3]-t[3],i[4]=e[4]-t[4],i[5]=e[5]-t[5],i[6]=e[6]-t[6],i[7]=e[7]-t[7],i[8]=e[8]-t[8],i[9]=e[9]-t[9],i[10]=e[10]-t[10],i[11]=e[11]-t[11],i[12]=e[12]-t[12],i[13]=e[13]-t[13],i[14]=e[14]-t[14],i[15]=e[15]-t[15],i}h(a5,"subtract");function pB(i,e,t){return i[0]=e[0]*t,i[1]=e[1]*t,i[2]=e[2]*t,i[3]=e[3]*t,i[4]=e[4]*t,i[5]=e[5]*t,i[6]=e[6]*t,i[7]=e[7]*t,i[8]=e[8]*t,i[9]=e[9]*t,i[10]=e[10]*t,i[11]=e[11]*t,i[12]=e[12]*t,i[13]=e[13]*t,i[14]=e[14]*t,i[15]=e[15]*t,i}h(pB,"multiplyScalar");function dB(i,e,t,r){return i[0]=e[0]+t[0]*r,i[1]=e[1]+t[1]*r,i[2]=e[2]+t[2]*r,i[3]=e[3]+t[3]*r,i[4]=e[4]+t[4]*r,i[5]=e[5]+t[5]*r,i[6]=e[6]+t[6]*r,i[7]=e[7]+t[7]*r,i[8]=e[8]+t[8]*r,i[9]=e[9]+t[9]*r,i[10]=e[10]+t[10]*r,i[11]=e[11]+t[11]*r,i[12]=e[12]+t[12]*r,i[13]=e[13]+t[13]*r,i[14]=e[14]+t[14]*r,i[15]=e[15]+t[15]*r,i}h(dB,"multiplyScalarAndAdd");function fB(i,e){return i[0]===e[0]&&i[1]===e[1]&&i[2]===e[2]&&i[3]===e[3]&&i[4]===e[4]&&i[5]===e[5]&&i[6]===e[6]&&i[7]===e[7]&&i[8]===e[8]&&i[9]===e[9]&&i[10]===e[10]&&i[11]===e[11]&&i[12]===e[12]&&i[13]===e[13]&&i[14]===e[14]&&i[15]===e[15]}h(fB,"exactEquals");function mB(i,e){var t=i[0],r=i[1],n=i[2],a=i[3],o=i[4],s=i[5],l=i[6],u=i[7],c=i[8],p=i[9],d=i[10],m=i[11],g=i[12],b=i[13],x=i[14],v=i[15],w=e[0],_=e[1],C=e[2],E=e[3],T=e[4],L=e[5],D=e[6],B=e[7],A=e[8],k=e[9],$=e[10],O=e[11],P=e[12],U=e[13],G=e[14],K=e[15];return Math.abs(t-w)<=Gt*Math.max(1,Math.abs(t),Math.abs(w))&&Math.abs(r-_)<=Gt*Math.max(1,Math.abs(r),Math.abs(_))&&Math.abs(n-C)<=Gt*Math.max(1,Math.abs(n),Math.abs(C))&&Math.abs(a-E)<=Gt*Math.max(1,Math.abs(a),Math.abs(E))&&Math.abs(o-T)<=Gt*Math.max(1,Math.abs(o),Math.abs(T))&&Math.abs(s-L)<=Gt*Math.max(1,Math.abs(s),Math.abs(L))&&Math.abs(l-D)<=Gt*Math.max(1,Math.abs(l),Math.abs(D))&&Math.abs(u-B)<=Gt*Math.max(1,Math.abs(u),Math.abs(B))&&Math.abs(c-A)<=Gt*Math.max(1,Math.abs(c),Math.abs(A))&&Math.abs(p-k)<=Gt*Math.max(1,Math.abs(p),Math.abs(k))&&Math.abs(d-$)<=Gt*Math.max(1,Math.abs(d),Math.abs($))&&Math.abs(m-O)<=Gt*Math.max(1,Math.abs(m),Math.abs(O))&&Math.abs(g-P)<=Gt*Math.max(1,Math.abs(g),Math.abs(P))&&Math.abs(b-U)<=Gt*Math.max(1,Math.abs(b),Math.abs(U))&&Math.abs(x-G)<=Gt*Math.max(1,Math.abs(x),Math.abs(G))&&Math.abs(v-K)<=Gt*Math.max(1,Math.abs(v),Math.abs(K))}h(mB,"equals");var joe=e5,Hoe=a5,uo={};oh(uo,{add:()=>_B,angle:()=>VB,bezier:()=>RB,ceil:()=>bB,clone:()=>gB,copy:()=>vB,create:()=>o5,cross:()=>LB,dist:()=>qoe,distance:()=>c5,div:()=>Xoe,divide:()=>h5,dot:()=>f5,equals:()=>WB,exactEquals:()=>GB,floor:()=>wB,forEach:()=>Koe,fromValues:()=>yB,hermite:()=>kB,inverse:()=>AB,len:()=>Yoe,length:()=>s5,lerp:()=>DB,max:()=>MB,min:()=>SB,mul:()=>Woe,multiply:()=>u5,negate:()=>PB,normalize:()=>IB,random:()=>FB,rotateX:()=>NB,rotateY:()=>$B,rotateZ:()=>UB,round:()=>CB,scale:()=>EB,scaleAndAdd:()=>TB,set:()=>xB,sqrDist:()=>Zoe,sqrLen:()=>Joe,squaredDistance:()=>p5,squaredLength:()=>d5,str:()=>HB,sub:()=>Goe,subtract:()=>l5,transformMat3:()=>BB,transformMat4:()=>zB,transformQuat:()=>OB,zero:()=>jB});R();function o5(){var i=new Pi(3);return Pi!=Float32Array&&(i[0]=0,i[1]=0,i[2]=0),i}h(o5,"create");function gB(i){var e=new Pi(3);return e[0]=i[0],e[1]=i[1],e[2]=i[2],e}h(gB,"clone");function s5(i){var e=i[0],t=i[1],r=i[2];return Math.hypot(e,t,r)}h(s5,"length");function yB(i,e,t){var r=new Pi(3);return r[0]=i,r[1]=e,r[2]=t,r}h(yB,"fromValues");function vB(i,e){return i[0]=e[0],i[1]=e[1],i[2]=e[2],i}h(vB,"copy");function xB(i,e,t,r){return i[0]=e,i[1]=t,i[2]=r,i}h(xB,"set");function _B(i,e,t){return i[0]=e[0]+t[0],i[1]=e[1]+t[1],i[2]=e[2]+t[2],i}h(_B,"add");function l5(i,e,t){return i[0]=e[0]-t[0],i[1]=e[1]-t[1],i[2]=e[2]-t[2],i}h(l5,"subtract");function u5(i,e,t){return i[0]=e[0]*t[0],i[1]=e[1]*t[1],i[2]=e[2]*t[2],i}h(u5,"multiply");function h5(i,e,t){return i[0]=e[0]/t[0],i[1]=e[1]/t[1],i[2]=e[2]/t[2],i}h(h5,"divide");function bB(i,e){return i[0]=Math.ceil(e[0]),i[1]=Math.ceil(e[1]),i[2]=Math.ceil(e[2]),i}h(bB,"ceil");function wB(i,e){return i[0]=Math.floor(e[0]),i[1]=Math.floor(e[1]),i[2]=Math.floor(e[2]),i}h(wB,"floor");function SB(i,e,t){return i[0]=Math.min(e[0],t[0]),i[1]=Math.min(e[1],t[1]),i[2]=Math.min(e[2],t[2]),i}h(SB,"min");function MB(i,e,t){return i[0]=Math.max(e[0],t[0]),i[1]=Math.max(e[1],t[1]),i[2]=Math.max(e[2],t[2]),i}h(MB,"max");function CB(i,e){return i[0]=Math.round(e[0]),i[1]=Math.round(e[1]),i[2]=Math.round(e[2]),i}h(CB,"round");function EB(i,e,t){return i[0]=e[0]*t,i[1]=e[1]*t,i[2]=e[2]*t,i}h(EB,"scale");function TB(i,e,t,r){return i[0]=e[0]+t[0]*r,i[1]=e[1]+t[1]*r,i[2]=e[2]+t[2]*r,i}h(TB,"scaleAndAdd");function c5(i,e){var t=e[0]-i[0],r=e[1]-i[1],n=e[2]-i[2];return Math.hypot(t,r,n)}h(c5,"distance");function p5(i,e){var t=e[0]-i[0],r=e[1]-i[1],n=e[2]-i[2];return t*t+r*r+n*n}h(p5,"squaredDistance");function d5(i){var e=i[0],t=i[1],r=i[2];return e*e+t*t+r*r}h(d5,"squaredLength");function PB(i,e){return i[0]=-e[0],i[1]=-e[1],i[2]=-e[2],i}h(PB,"negate");function AB(i,e){return i[0]=1/e[0],i[1]=1/e[1],i[2]=1/e[2],i}h(AB,"inverse");function IB(i,e){var t=e[0],r=e[1],n=e[2],a=t*t+r*r+n*n;return a>0&&(a=1/Math.sqrt(a)),i[0]=e[0]*a,i[1]=e[1]*a,i[2]=e[2]*a,i}h(IB,"normalize");function f5(i,e){return i[0]*e[0]+i[1]*e[1]+i[2]*e[2]}h(f5,"dot");function LB(i,e,t){var r=e[0],n=e[1],a=e[2],o=t[0],s=t[1],l=t[2];return i[0]=n*l-a*s,i[1]=a*o-r*l,i[2]=r*s-n*o,i}h(LB,"cross");function DB(i,e,t,r){var n=e[0],a=e[1],o=e[2];return i[0]=n+r*(t[0]-n),i[1]=a+r*(t[1]-a),i[2]=o+r*(t[2]-o),i}h(DB,"lerp");function kB(i,e,t,r,n,a){var o=a*a,s=o*(2*a-3)+1,l=o*(a-2)+a,u=o*(a-1),c=o*(3-2*a);return i[0]=e[0]*s+t[0]*l+r[0]*u+n[0]*c,i[1]=e[1]*s+t[1]*l+r[1]*u+n[1]*c,i[2]=e[2]*s+t[2]*l+r[2]*u+n[2]*c,i}h(kB,"hermite");function RB(i,e,t,r,n,a){var o=1-a,s=o*o,l=a*a,u=s*o,c=3*a*s,p=3*l*o,d=l*a;return i[0]=e[0]*u+t[0]*c+r[0]*p+n[0]*d,i[1]=e[1]*u+t[1]*c+r[1]*p+n[1]*d,i[2]=e[2]*u+t[2]*c+r[2]*p+n[2]*d,i}h(RB,"bezier");function FB(i,e){e=e||1;var t=Tu()*2*Math.PI,r=Tu()*2-1,n=Math.sqrt(1-r*r)*e;return i[0]=Math.cos(t)*n,i[1]=Math.sin(t)*n,i[2]=r*e,i}h(FB,"random");function zB(i,e,t){var r=e[0],n=e[1],a=e[2],o=t[3]*r+t[7]*n+t[11]*a+t[15];return o=o||1,i[0]=(t[0]*r+t[4]*n+t[8]*a+t[12])/o,i[1]=(t[1]*r+t[5]*n+t[9]*a+t[13])/o,i[2]=(t[2]*r+t[6]*n+t[10]*a+t[14])/o,i}h(zB,"transformMat4");function BB(i,e,t){var r=e[0],n=e[1],a=e[2];return i[0]=r*t[0]+n*t[3]+a*t[6],i[1]=r*t[1]+n*t[4]+a*t[7],i[2]=r*t[2]+n*t[5]+a*t[8],i}h(BB,"transformMat3");function OB(i,e,t){var r=t[0],n=t[1],a=t[2],o=t[3],s=e[0],l=e[1],u=e[2],c=n*u-a*l,p=a*s-r*u,d=r*l-n*s,m=n*d-a*p,g=a*c-r*d,b=r*p-n*c,x=o*2;return c*=x,p*=x,d*=x,m*=2,g*=2,b*=2,i[0]=s+c+m,i[1]=l+p+g,i[2]=u+d+b,i}h(OB,"transformQuat");function NB(i,e,t,r){var n=[],a=[];return n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],a[0]=n[0],a[1]=n[1]*Math.cos(r)-n[2]*Math.sin(r),a[2]=n[1]*Math.sin(r)+n[2]*Math.cos(r),i[0]=a[0]+t[0],i[1]=a[1]+t[1],i[2]=a[2]+t[2],i}h(NB,"rotateX");function $B(i,e,t,r){var n=[],a=[];return n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],a[0]=n[2]*Math.sin(r)+n[0]*Math.cos(r),a[1]=n[1],a[2]=n[2]*Math.cos(r)-n[0]*Math.sin(r),i[0]=a[0]+t[0],i[1]=a[1]+t[1],i[2]=a[2]+t[2],i}h($B,"rotateY");function UB(i,e,t,r){var n=[],a=[];return n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],a[0]=n[0]*Math.cos(r)-n[1]*Math.sin(r),a[1]=n[0]*Math.sin(r)+n[1]*Math.cos(r),a[2]=n[2],i[0]=a[0]+t[0],i[1]=a[1]+t[1],i[2]=a[2]+t[2],i}h(UB,"rotateZ");function VB(i,e){var t=i[0],r=i[1],n=i[2],a=e[0],o=e[1],s=e[2],l=Math.sqrt(t*t+r*r+n*n),u=Math.sqrt(a*a+o*o+s*s),c=l*u,p=c&&f5(i,e)/c;return Math.acos(Math.min(Math.max(p,-1),1))}h(VB,"angle");function jB(i){return i[0]=0,i[1]=0,i[2]=0,i}h(jB,"zero");function HB(i){return"vec3("+i[0]+", "+i[1]+", "+i[2]+")"}h(HB,"str");function GB(i,e){return i[0]===e[0]&&i[1]===e[1]&&i[2]===e[2]}h(GB,"exactEquals");function WB(i,e){var t=i[0],r=i[1],n=i[2],a=e[0],o=e[1],s=e[2];return Math.abs(t-a)<=Gt*Math.max(1,Math.abs(t),Math.abs(a))&&Math.abs(r-o)<=Gt*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(n-s)<=Gt*Math.max(1,Math.abs(n),Math.abs(s))}h(WB,"equals");var Goe=l5,Woe=u5,Xoe=h5,qoe=c5,Zoe=p5,Yoe=s5,Joe=d5,Koe=function(){var i=o5();return function(e,t,r,n,a,o){var s,l;for(t||(t=3),r||(r=0),n?l=Math.min(n*t+r,e.length):l=e.length,s=r;s<l;s+=t)i[0]=e[s],i[1]=e[s+1],i[2]=e[s+2],a(i,i,o),e[s]=i[0],e[s+1]=i[1],e[s+2]=i[2];return e}}(),wn={};oh(wn,{add:()=>JB,ceil:()=>KB,clone:()=>XB,copy:()=>ZB,create:()=>m5,cross:()=>uO,dist:()=>ise,distance:()=>x5,div:()=>tse,divide:()=>v5,dot:()=>lO,equals:()=>yO,exactEquals:()=>gO,floor:()=>QB,forEach:()=>ose,fromValues:()=>qB,inverse:()=>oO,len:()=>nse,length:()=>b5,lerp:()=>hO,max:()=>tO,min:()=>eO,mul:()=>ese,multiply:()=>y5,negate:()=>aO,normalize:()=>sO,random:()=>cO,round:()=>iO,scale:()=>rO,scaleAndAdd:()=>nO,set:()=>YB,sqrDist:()=>rse,sqrLen:()=>ase,squaredDistance:()=>_5,squaredLength:()=>w5,str:()=>mO,sub:()=>Qoe,subtract:()=>g5,transformMat4:()=>pO,transformQuat:()=>dO,zero:()=>fO});R();function m5(){var i=new Pi(4);return Pi!=Float32Array&&(i[0]=0,i[1]=0,i[2]=0,i[3]=0),i}h(m5,"create");function XB(i){var e=new Pi(4);return e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e}h(XB,"clone");function qB(i,e,t,r){var n=new Pi(4);return n[0]=i,n[1]=e,n[2]=t,n[3]=r,n}h(qB,"fromValues");function ZB(i,e){return i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i}h(ZB,"copy");function YB(i,e,t,r,n){return i[0]=e,i[1]=t,i[2]=r,i[3]=n,i}h(YB,"set");function JB(i,e,t){return i[0]=e[0]+t[0],i[1]=e[1]+t[1],i[2]=e[2]+t[2],i[3]=e[3]+t[3],i}h(JB,"add");function g5(i,e,t){return i[0]=e[0]-t[0],i[1]=e[1]-t[1],i[2]=e[2]-t[2],i[3]=e[3]-t[3],i}h(g5,"subtract");function y5(i,e,t){return i[0]=e[0]*t[0],i[1]=e[1]*t[1],i[2]=e[2]*t[2],i[3]=e[3]*t[3],i}h(y5,"multiply");function v5(i,e,t){return i[0]=e[0]/t[0],i[1]=e[1]/t[1],i[2]=e[2]/t[2],i[3]=e[3]/t[3],i}h(v5,"divide");function KB(i,e){return i[0]=Math.ceil(e[0]),i[1]=Math.ceil(e[1]),i[2]=Math.ceil(e[2]),i[3]=Math.ceil(e[3]),i}h(KB,"ceil");function QB(i,e){return i[0]=Math.floor(e[0]),i[1]=Math.floor(e[1]),i[2]=Math.floor(e[2]),i[3]=Math.floor(e[3]),i}h(QB,"floor");function eO(i,e,t){return i[0]=Math.min(e[0],t[0]),i[1]=Math.min(e[1],t[1]),i[2]=Math.min(e[2],t[2]),i[3]=Math.min(e[3],t[3]),i}h(eO,"min");function tO(i,e,t){return i[0]=Math.max(e[0],t[0]),i[1]=Math.max(e[1],t[1]),i[2]=Math.max(e[2],t[2]),i[3]=Math.max(e[3],t[3]),i}h(tO,"max");function iO(i,e){return i[0]=Math.round(e[0]),i[1]=Math.round(e[1]),i[2]=Math.round(e[2]),i[3]=Math.round(e[3]),i}h(iO,"round");function rO(i,e,t){return i[0]=e[0]*t,i[1]=e[1]*t,i[2]=e[2]*t,i[3]=e[3]*t,i}h(rO,"scale");function nO(i,e,t,r){return i[0]=e[0]+t[0]*r,i[1]=e[1]+t[1]*r,i[2]=e[2]+t[2]*r,i[3]=e[3]+t[3]*r,i}h(nO,"scaleAndAdd");function x5(i,e){var t=e[0]-i[0],r=e[1]-i[1],n=e[2]-i[2],a=e[3]-i[3];return Math.hypot(t,r,n,a)}h(x5,"distance");function _5(i,e){var t=e[0]-i[0],r=e[1]-i[1],n=e[2]-i[2],a=e[3]-i[3];return t*t+r*r+n*n+a*a}h(_5,"squaredDistance");function b5(i){var e=i[0],t=i[1],r=i[2],n=i[3];return Math.hypot(e,t,r,n)}h(b5,"length");function w5(i){var e=i[0],t=i[1],r=i[2],n=i[3];return e*e+t*t+r*r+n*n}h(w5,"squaredLength");function aO(i,e){return i[0]=-e[0],i[1]=-e[1],i[2]=-e[2],i[3]=-e[3],i}h(aO,"negate");function oO(i,e){return i[0]=1/e[0],i[1]=1/e[1],i[2]=1/e[2],i[3]=1/e[3],i}h(oO,"inverse");function sO(i,e){var t=e[0],r=e[1],n=e[2],a=e[3],o=t*t+r*r+n*n+a*a;return o>0&&(o=1/Math.sqrt(o)),i[0]=t*o,i[1]=r*o,i[2]=n*o,i[3]=a*o,i}h(sO,"normalize");function lO(i,e){return i[0]*e[0]+i[1]*e[1]+i[2]*e[2]+i[3]*e[3]}h(lO,"dot");function uO(i,e,t,r){var n=t[0]*r[1]-t[1]*r[0],a=t[0]*r[2]-t[2]*r[0],o=t[0]*r[3]-t[3]*r[0],s=t[1]*r[2]-t[2]*r[1],l=t[1]*r[3]-t[3]*r[1],u=t[2]*r[3]-t[3]*r[2],c=e[0],p=e[1],d=e[2],m=e[3];return i[0]=p*u-d*l+m*s,i[1]=-(c*u)+d*o-m*a,i[2]=c*l-p*o+m*n,i[3]=-(c*s)+p*a-d*n,i}h(uO,"cross");function hO(i,e,t,r){var n=e[0],a=e[1],o=e[2],s=e[3];return i[0]=n+r*(t[0]-n),i[1]=a+r*(t[1]-a),i[2]=o+r*(t[2]-o),i[3]=s+r*(t[3]-s),i}h(hO,"lerp");function cO(i,e){e=e||1;var t,r,n,a,o,s;do t=Tu()*2-1,r=Tu()*2-1,o=t*t+r*r;while(o>=1);do n=Tu()*2-1,a=Tu()*2-1,s=n*n+a*a;while(s>=1);var l=Math.sqrt((1-o)/s);return i[0]=e*t,i[1]=e*r,i[2]=e*n*l,i[3]=e*a*l,i}h(cO,"random");function pO(i,e,t){var r=e[0],n=e[1],a=e[2],o=e[3];return i[0]=t[0]*r+t[4]*n+t[8]*a+t[12]*o,i[1]=t[1]*r+t[5]*n+t[9]*a+t[13]*o,i[2]=t[2]*r+t[6]*n+t[10]*a+t[14]*o,i[3]=t[3]*r+t[7]*n+t[11]*a+t[15]*o,i}h(pO,"transformMat4");function dO(i,e,t){var r=e[0],n=e[1],a=e[2],o=t[0],s=t[1],l=t[2],u=t[3],c=u*r+s*a-l*n,p=u*n+l*r-o*a,d=u*a+o*n-s*r,m=-o*r-s*n-l*a;return i[0]=c*u+m*-o+p*-l-d*-s,i[1]=p*u+m*-s+d*-o-c*-l,i[2]=d*u+m*-l+c*-s-p*-o,i[3]=e[3],i}h(dO,"transformQuat");function fO(i){return i[0]=0,i[1]=0,i[2]=0,i[3]=0,i}h(fO,"zero");function mO(i){return"vec4("+i[0]+", "+i[1]+", "+i[2]+", "+i[3]+")"}h(mO,"str");function gO(i,e){return i[0]===e[0]&&i[1]===e[1]&&i[2]===e[2]&&i[3]===e[3]}h(gO,"exactEquals");function yO(i,e){var t=i[0],r=i[1],n=i[2],a=i[3],o=e[0],s=e[1],l=e[2],u=e[3];return Math.abs(t-o)<=Gt*Math.max(1,Math.abs(t),Math.abs(o))&&Math.abs(r-s)<=Gt*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(n-l)<=Gt*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(a-u)<=Gt*Math.max(1,Math.abs(a),Math.abs(u))}h(yO,"equals");var Qoe=g5,ese=y5,tse=v5,ise=x5,rse=_5,nse=b5,ase=w5,ose=function(){var i=m5();return function(e,t,r,n,a,o){var s,l;for(t||(t=4),r||(r=0),n?l=Math.min(n*t+r,e.length):l=e.length,s=r;s<l;s+=t)i[0]=e[s],i[1]=e[s+1],i[2]=e[s+2],i[3]=e[s+3],a(i,i,o),e[s]=i[0],e[s+1]=i[1],e[s+2]=i[2],e[s+3]=i[3];return e}}(),S5={};oh(S5,{add:()=>wO,angle:()=>VO,ceil:()=>SO,clone:()=>vO,copy:()=>_O,create:()=>M5,cross:()=>RO,dist:()=>cse,distance:()=>P5,div:()=>hse,divide:()=>T5,dot:()=>kO,equals:()=>WO,exactEquals:()=>GO,floor:()=>MO,forEach:()=>fse,fromValues:()=>xO,inverse:()=>LO,len:()=>sse,length:()=>I5,lerp:()=>FO,max:()=>EO,min:()=>CO,mul:()=>use,multiply:()=>E5,negate:()=>IO,normalize:()=>DO,random:()=>zO,rotate:()=>UO,round:()=>TO,scale:()=>PO,scaleAndAdd:()=>AO,set:()=>bO,sqrDist:()=>pse,sqrLen:()=>dse,squaredDistance:()=>A5,squaredLength:()=>L5,str:()=>HO,sub:()=>lse,subtract:()=>C5,transformMat2:()=>BO,transformMat2d:()=>OO,transformMat3:()=>NO,transformMat4:()=>$O,zero:()=>jO});R();function M5(){var i=new Pi(2);return Pi!=Float32Array&&(i[0]=0,i[1]=0),i}h(M5,"create");function vO(i){var e=new Pi(2);return e[0]=i[0],e[1]=i[1],e}h(vO,"clone");function xO(i,e){var t=new Pi(2);return t[0]=i,t[1]=e,t}h(xO,"fromValues");function _O(i,e){return i[0]=e[0],i[1]=e[1],i}h(_O,"copy");function bO(i,e,t){return i[0]=e,i[1]=t,i}h(bO,"set");function wO(i,e,t){return i[0]=e[0]+t[0],i[1]=e[1]+t[1],i}h(wO,"add");function C5(i,e,t){return i[0]=e[0]-t[0],i[1]=e[1]-t[1],i}h(C5,"subtract");function E5(i,e,t){return i[0]=e[0]*t[0],i[1]=e[1]*t[1],i}h(E5,"multiply");function T5(i,e,t){return i[0]=e[0]/t[0],i[1]=e[1]/t[1],i}h(T5,"divide");function SO(i,e){return i[0]=Math.ceil(e[0]),i[1]=Math.ceil(e[1]),i}h(SO,"ceil");function MO(i,e){return i[0]=Math.floor(e[0]),i[1]=Math.floor(e[1]),i}h(MO,"floor");function CO(i,e,t){return i[0]=Math.min(e[0],t[0]),i[1]=Math.min(e[1],t[1]),i}h(CO,"min");function EO(i,e,t){return i[0]=Math.max(e[0],t[0]),i[1]=Math.max(e[1],t[1]),i}h(EO,"max");function TO(i,e){return i[0]=Math.round(e[0]),i[1]=Math.round(e[1]),i}h(TO,"round");function PO(i,e,t){return i[0]=e[0]*t,i[1]=e[1]*t,i}h(PO,"scale");function AO(i,e,t,r){return i[0]=e[0]+t[0]*r,i[1]=e[1]+t[1]*r,i}h(AO,"scaleAndAdd");function P5(i,e){var t=e[0]-i[0],r=e[1]-i[1];return Math.hypot(t,r)}h(P5,"distance");function A5(i,e){var t=e[0]-i[0],r=e[1]-i[1];return t*t+r*r}h(A5,"squaredDistance");function I5(i){var e=i[0],t=i[1];return Math.hypot(e,t)}h(I5,"length");function L5(i){var e=i[0],t=i[1];return e*e+t*t}h(L5,"squaredLength");function IO(i,e){return i[0]=-e[0],i[1]=-e[1],i}h(IO,"negate");function LO(i,e){return i[0]=1/e[0],i[1]=1/e[1],i}h(LO,"inverse");function DO(i,e){var t=e[0],r=e[1],n=t*t+r*r;return n>0&&(n=1/Math.sqrt(n)),i[0]=e[0]*n,i[1]=e[1]*n,i}h(DO,"normalize");function kO(i,e){return i[0]*e[0]+i[1]*e[1]}h(kO,"dot");function RO(i,e,t){var r=e[0]*t[1]-e[1]*t[0];return i[0]=i[1]=0,i[2]=r,i}h(RO,"cross");function FO(i,e,t,r){var n=e[0],a=e[1];return i[0]=n+r*(t[0]-n),i[1]=a+r*(t[1]-a),i}h(FO,"lerp");function zO(i,e){e=e||1;var t=Tu()*2*Math.PI;return i[0]=Math.cos(t)*e,i[1]=Math.sin(t)*e,i}h(zO,"random");function BO(i,e,t){var r=e[0],n=e[1];return i[0]=t[0]*r+t[2]*n,i[1]=t[1]*r+t[3]*n,i}h(BO,"transformMat2");function OO(i,e,t){var r=e[0],n=e[1];return i[0]=t[0]*r+t[2]*n+t[4],i[1]=t[1]*r+t[3]*n+t[5],i}h(OO,"transformMat2d");function NO(i,e,t){var r=e[0],n=e[1];return i[0]=t[0]*r+t[3]*n+t[6],i[1]=t[1]*r+t[4]*n+t[7],i}h(NO,"transformMat3");function $O(i,e,t){var r=e[0],n=e[1];return i[0]=t[0]*r+t[4]*n+t[12],i[1]=t[1]*r+t[5]*n+t[13],i}h($O,"transformMat4");function UO(i,e,t,r){var n=e[0]-t[0],a=e[1]-t[1],o=Math.sin(r),s=Math.cos(r);return i[0]=n*s-a*o+t[0],i[1]=n*o+a*s+t[1],i}h(UO,"rotate");function VO(i,e){var t=i[0],r=i[1],n=e[0],a=e[1],o=Math.sqrt(t*t+r*r)*Math.sqrt(n*n+a*a),s=o&&(t*n+r*a)/o;return Math.acos(Math.min(Math.max(s,-1),1))}h(VO,"angle");function jO(i){return i[0]=0,i[1]=0,i}h(jO,"zero");function HO(i){return"vec2("+i[0]+", "+i[1]+")"}h(HO,"str");function GO(i,e){return i[0]===e[0]&&i[1]===e[1]}h(GO,"exactEquals");function WO(i,e){var t=i[0],r=i[1],n=e[0],a=e[1];return Math.abs(t-n)<=Gt*Math.max(1,Math.abs(t),Math.abs(n))&&Math.abs(r-a)<=Gt*Math.max(1,Math.abs(r),Math.abs(a))}h(WO,"equals");var sse=I5,lse=C5,use=E5,hse=T5,cse=P5,pse=A5,dse=L5,fse=function(){var i=M5();return function(e,t,r,n,a,o){var s,l;for(t||(t=2),r||(r=0),n?l=Math.min(n*t+r,e.length):l=e.length,s=r;s<l;s+=t)i[0]=e[s],i[1]=e[s+1],a(i,i,o),e[s]=i[0],e[s+1]=i[1];return e}}(),mse=It(di(),1),XO=class extends qo{constructor(e){super(e,zoe)}createBucket(e){return new W4(e)}queryRadius(e){let t=e;return hp("circle-radius",this,t)+hp("circle-stroke-width",this,t)+Ym(this.paint.get("circle-translate"))}queryIntersectsFeature(e,t,r,n,a,o,s,l){let u=Jm(e,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),o.angle,s),c=this.paint.get("circle-radius").evaluate(t,r),p=this.paint.get("circle-stroke-width").evaluate(t,r),d=c+p,m=this.paint.get("circle-pitch-alignment")==="map",g=m?u:qO(u,l),b=m?d*s:d;for(let x of n)for(let v of x){let w=m?v:D5(v,l),_=b,C=wn.transformMat4([],[v.x,v.y,0,1],l);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?_*=C[3]/o.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(_*=o.cameraToCenterDistance/C[3]),EF(g,w,_))return!0}return!1}};h(XO,"CircleStyleLayer");var gse=XO;function D5(i,e){let t=wn.transformMat4([],[i.x,i.y,0,1],e);return new mse.default(t[0]/t[3],t[1]/t[3])}h(D5,"projectPoint");function qO(i,e){return i.map(t=>D5(t,e))}h(qO,"projectQueryGeometry");R();R();var ZO=class extends W4{};h(ZO,"HeatmapBucket");var YO=ZO;st("HeatmapBucket",YO,{omit:["layers"]});R();var OP,yse=h(()=>OP=OP||new Zn({"heatmap-radius":new St(Le.paint_heatmap["heatmap-radius"]),"heatmap-weight":new St(Le.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new mt(Le.paint_heatmap["heatmap-intensity"]),"heatmap-color":new E4(Le.paint_heatmap["heatmap-color"]),"heatmap-opacity":new mt(Le.paint_heatmap["heatmap-opacity"])}),"getPaint"),vse={get paint(){return yse()}};R();R();function Ex(i,{width:e,height:t},r,n){if(!n)n=new Uint8Array(e*t*r);else if(n instanceof Uint8ClampedArray)n=new Uint8Array(n.buffer);else if(n.length!==e*t*r)throw new RangeError(`mismatched image size. expected: ${n.length} but got: ${e*t*r}`);return i.width=e,i.height=t,i.data=n,i}h(Ex,"createImage");function k5(i,{width:e,height:t},r){if(e===i.width&&t===i.height)return;let n=Ex({},{width:e,height:t},r);Tx(i,n,{x:0,y:0},{x:0,y:0},{width:Math.min(i.width,e),height:Math.min(i.height,t)},r),i.width=e,i.height=t,i.data=n.data}h(k5,"resizeImage");function Tx(i,e,t,r,n,a){if(n.width===0||n.height===0)return e;if(n.width>i.width||n.height>i.height||t.x>i.width-n.width||t.y>i.height-n.height)throw new RangeError("out of range source coordinates for image copy");if(n.width>e.width||n.height>e.height||r.x>e.width-n.width||r.y>e.height-n.height)throw new RangeError("out of range destination coordinates for image copy");let o=i.data,s=e.data;if(o===s)throw new Error("srcData equals dstData, so image is already copied");for(let l=0;l<n.height;l++){let u=((t.y+l)*i.width+t.x)*a,c=((r.y+l)*e.width+r.x)*a;for(let p=0;p<n.width*a;p++)s[c+p]=o[u+p]}return e}h(Tx,"copyImage");var JO=class KO{constructor(e,t){Ex(this,e,1,t)}resize(e){k5(this,e,1)}clone(){return new KO({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,t,r,n,a){Tx(e,t,r,n,a,1)}};h(JO,"AlphaImage");var R5=JO,QO=class eN{constructor(e,t){Ex(this,e,4,t)}resize(e){k5(this,e,4)}replace(e,t){t?this.data.set(e):e instanceof Uint8ClampedArray?this.data=new Uint8Array(e.buffer):this.data=e}clone(){return new eN({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,t,r,n,a){Tx(e,t,r,n,a,4)}};h(QO,"RGBAImage");var Qi=QO;st("AlphaImage",R5);st("RGBAImage",Qi);function F5(i){let e={},t=i.resolution||256,r=i.clips?i.clips.length:1,n=i.image||new Qi({width:t,height:r});if(!nL(t))throw new Error(`width is not a power of 2 - ${t}`);let a=h((o,s,l)=>{e[i.evaluationKey]=l;let u=i.expression.evaluate(e);n.data[o+s+0]=Math.floor(u.r*255/u.a),n.data[o+s+1]=Math.floor(u.g*255/u.a),n.data[o+s+2]=Math.floor(u.b*255/u.a),n.data[o+s+3]=Math.floor(u.a*255)},"renderPixel");if(i.clips)for(let o=0,s=0;o<r;++o,s+=t*4)for(let l=0,u=0;l<t;l++,u+=4){let c=l/(t-1),{start:p,end:d}=i.clips[o],m=p*(1-c)+d*c;a(s,u,m)}else for(let o=0,s=0;o<t;o++,s+=4){let l=o/(t-1);a(0,s,l)}return n}h(F5,"renderColorRamp");var tN=class extends qo{createBucket(e){return new YO(e)}constructor(e){super(e,vse),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(e){e==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){let e=this._transitionablePaint._values["heatmap-color"].value.expression;this.colorRamp=F5({expression:e,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}};h(tN,"HeatmapStyleLayer");var xse=tN;R();R();var NP,_se=h(()=>NP=NP||new Zn({"hillshade-illumination-direction":new mt(Le.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new mt(Le.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new mt(Le.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new mt(Le.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new mt(Le.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new mt(Le.paint_hillshade["hillshade-accent-color"])}),"getPaint"),bse={get paint(){return _se()}},iN=class extends qo{constructor(e){super(e,bse)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}};h(iN,"HillshadeStyleLayer");var wse=iN;R();R();R();var Sse=Xi([{name:"a_pos",components:2,type:"Int16"}],4),{members:Mse,size:Nwe,alignment:$we}=Sse,Cse=It(Y7(),1);R();R();function rN(i,e,t,r,n){z5(i,e,t||0,r||i.length-1,n||nN)}h(rN,"quickselect");function z5(i,e,t,r,n){for(;r>t;){if(r-t>600){var a=r-t+1,o=e-t+1,s=Math.log(a),l=.5*Math.exp(2*s/3),u=.5*Math.sqrt(s*l*(a-l)/a)*(o-a/2<0?-1:1),c=Math.max(t,Math.floor(e-o*l/a+u)),p=Math.min(r,Math.floor(e+(a-o)*l/a+u));z5(i,e,c,p,n)}var d=i[e],m=t,g=r;for(Xh(i,t,e),n(i[r],d)>0&&Xh(i,t,r);m<g;){for(Xh(i,m,g),m++,g--;n(i[m],d)<0;)m++;for(;n(i[g],d)>0;)g--}n(i[t],d)===0?Xh(i,t,g):(g++,Xh(i,g,r)),g<=e&&(t=g+1),e<=g&&(r=g-1)}}h(z5,"quickselectStep");function Xh(i,e,t){var r=i[e];i[e]=i[t],i[t]=r}h(Xh,"swap");function nN(i,e){return i<e?-1:i>e?1:0}h(nN,"defaultCompare");function B5(i,e){let t=i.length;if(t<=1)return[i];let r=[],n,a;for(let o=0;o<t;o++){let s=lL(i[o]);s!==0&&(i[o].area=Math.abs(s),a===void 0&&(a=s<0),a===s<0?(n&&r.push(n),n=[i[o]]):n.push(i[o]))}if(n&&r.push(n),e>1)for(let o=0;o<r.length;o++)r[o].length<=e||(rN(r[o],e,1,r[o].length-1,aN),r[o]=r[o].slice(0,e));return r}h(B5,"classifyRings");function aN(i,e){return e.area-i.area}h(aN,"compareAreas");R();function Px(i,e,t){let r=t.patternDependencies,n=!1;for(let a of e){let o=a.paint.get(`${i}-pattern`);o.isConstant()||(n=!0);let s=o.constantOr(null);s&&(n=!0,r[s.to]=!0,r[s.from]=!0)}return n}h(Px,"hasPattern");function Ax(i,e,t,r,n){let a=n.patternDependencies;for(let o of e){let s=o.paint.get(`${i}-pattern`).value;if(s.kind!=="constant"){let l=s.evaluate({zoom:r-1},t,{},n.availableImages),u=s.evaluate({zoom:r},t,{},n.availableImages),c=s.evaluate({zoom:r+1},t,{},n.availableImages);l=l&&l.name?l.name:l,u=u&&u.name?u.name:u,c=c&&c.name?c.name:c,a[l]=!0,a[u]=!0,a[c]=!0,t.patterns[o.id]={min:l,mid:u,max:c}}}return t}h(Ax,"addPatternDependencies");var Ese=500,oN=class{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(t=>t.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new voe,this.indexArray=new ch,this.indexArray2=new ww,this.programConfigurations=new Ju(e.layers,e.zoom),this.segments=new cr,this.segments2=new cr,this.stateDependentLayerIds=this.layers.filter(t=>t.isStateDependent()).map(t=>t.id)}populate(e,t,r){this.hasPattern=Px("fill",this.layers,t);let n=this.layers[0].layout.get("fill-sort-key"),a=!n.isConstant(),o=[];for(let{feature:s,id:l,index:u,sourceLayerIndex:c}of e){let p=this.layers[0]._featureFilter.needGeometry,d=Hl(s,p);if(!this.layers[0]._featureFilter.filter(new Pr(this.zoom),d,r))continue;let m=a?n.evaluate(d,{},r,t.availableImages):void 0,g={id:l,properties:s.properties,type:s.type,sourceLayerIndex:c,index:u,geometry:p?d.geometry:jl(s),patterns:{},sortKey:m};o.push(g)}a&&o.sort((s,l)=>s.sortKey-l.sortKey);for(let s of o){let{geometry:l,index:u,sourceLayerIndex:c}=s;if(this.hasPattern){let d=Ax("fill",this.layers,s,this.zoom,t);this.patternFeatures.push(d)}else this.addFeature(s,l,u,r,{});let p=e[u].feature;t.featureIndex.insert(p,l,u,c,this.index)}}update(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)}addFeatures(e,t,r){for(let n of this.patternFeatures)this.addFeature(n,n.geometry,n.index,t,r)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Mse),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,t,r,n,a){for(let o of B5(t,Ese)){let s=0;for(let m of o)s+=m.length;let l=this.segments.prepareSegment(s,this.layoutVertexArray,this.indexArray),u=l.vertexLength,c=[],p=[];for(let m of o){if(m.length===0)continue;m!==o[0]&&p.push(c.length/2);let g=this.segments2.prepareSegment(m.length,this.layoutVertexArray,this.indexArray2),b=g.vertexLength;this.layoutVertexArray.emplaceBack(m[0].x,m[0].y),this.indexArray2.emplaceBack(b+m.length-1,b),c.push(m[0].x),c.push(m[0].y);for(let x=1;x<m.length;x++)this.layoutVertexArray.emplaceBack(m[x].x,m[x].y),this.indexArray2.emplaceBack(b+x-1,b+x),c.push(m[x].x),c.push(m[x].y);g.vertexLength+=m.length,g.primitiveLength+=m.length}let d=(0,Cse.default)(c,p);for(let m=0;m<d.length;m+=3)this.indexArray.emplaceBack(u+d[m],u+d[m+1],u+d[m+2]);l.vertexLength+=s,l.primitiveLength+=d.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,a,n)}};h(oN,"FillBucket");var sN=oN;st("FillBucket",sN,{omit:["layers","patternFeatures"]});R();var $P,Tse=h(()=>$P=$P||new Zn({"fill-sort-key":new St(Le.layout_fill["fill-sort-key"])}),"getLayout"),UP,Pse=h(()=>UP=UP||new Zn({"fill-antialias":new mt(Le.paint_fill["fill-antialias"]),"fill-opacity":new St(Le.paint_fill["fill-opacity"]),"fill-color":new St(Le.paint_fill["fill-color"]),"fill-outline-color":new St(Le.paint_fill["fill-outline-color"]),"fill-translate":new mt(Le.paint_fill["fill-translate"]),"fill-translate-anchor":new mt(Le.paint_fill["fill-translate-anchor"]),"fill-pattern":new bx(Le.paint_fill["fill-pattern"])}),"getPaint"),Ase={get paint(){return Pse()},get layout(){return Tse()}},lN=class extends qo{constructor(e){super(e,Ase)}recalculate(e,t){super.recalculate(e,t);let r=this.paint._values["fill-outline-color"];r.value.kind==="constant"&&r.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(e){return new sN(e)}queryRadius(){return Ym(this.paint.get("fill-translate"))}queryIntersectsFeature(e,t,r,n,a,o,s){let l=Jm(e,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),o.angle,s);return q4(l,n)}isTileClipped(){return!0}};h(lN,"FillStyleLayer");var Ise=lN;R();R();R();var Lse=Xi([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),Dse=Xi([{name:"a_centroid",components:2,type:"Int16"}],4),{members:kse,size:jwe,alignment:Hwe}=Lse,Rse=It(Y7(),1),Fse=It(Qv(),1),zse=Fse.default.VectorTileFeature.types,Bse=500,$_=Math.pow(2,13);function qh(i,e,t,r,n,a,o,s){i.emplaceBack(e,t,Math.floor(r*$_)*2+o,n*$_*2,a*$_*2,Math.round(s))}h(qh,"addVertex");var uN=class{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(t=>t.id),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new xoe,this.centroidVertexArray=new sy,this.indexArray=new ch,this.programConfigurations=new Ju(e.layers,e.zoom),this.segments=new cr,this.stateDependentLayerIds=this.layers.filter(t=>t.isStateDependent()).map(t=>t.id)}populate(e,t,r){this.features=[],this.hasPattern=Px("fill-extrusion",this.layers,t);for(let{feature:n,id:a,index:o,sourceLayerIndex:s}of e){let l=this.layers[0]._featureFilter.needGeometry,u=Hl(n,l);if(!this.layers[0]._featureFilter.filter(new Pr(this.zoom),u,r))continue;let c={id:a,sourceLayerIndex:s,index:o,geometry:l?u.geometry:jl(n),properties:n.properties,type:n.type,patterns:{}};this.hasPattern?this.features.push(Ax("fill-extrusion",this.layers,c,this.zoom,t)):this.addFeature(c,c.geometry,o,r,{}),t.featureIndex.insert(n,c.geometry,o,s,this.index,!0)}}addFeatures(e,t,r){for(let n of this.features){let{geometry:a}=n;this.addFeature(n,a,n.index,t,r)}}update(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,kse),this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,Dse.members,!0),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(e,t,r,n,a){let o={x:0,y:0,vertexCount:0};for(let s of B5(t,Bse)){let l=0;for(let g of s)l+=g.length;let u=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(let g of s){if(g.length===0||pN(g))continue;let b=0;for(let x=0;x<g.length;x++){let v=g[x];if(x>=1){let w=g[x-1];if(!cN(v,w)){u.vertexLength+4>cr.MAX_VERTEX_ARRAY_LENGTH&&(u=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));let _=v.sub(w)._perp()._unit(),C=w.dist(v);b+C>32768&&(b=0),qh(this.layoutVertexArray,v.x,v.y,_.x,_.y,0,0,b),qh(this.layoutVertexArray,v.x,v.y,_.x,_.y,0,1,b),o.x+=2*v.x,o.y+=2*v.y,o.vertexCount+=2,b+=C,qh(this.layoutVertexArray,w.x,w.y,_.x,_.y,0,0,b),qh(this.layoutVertexArray,w.x,w.y,_.x,_.y,0,1,b),o.x+=2*w.x,o.y+=2*w.y,o.vertexCount+=2;let E=u.vertexLength;this.indexArray.emplaceBack(E,E+2,E+1),this.indexArray.emplaceBack(E+1,E+2,E+3),u.vertexLength+=4,u.primitiveLength+=2}}}}if(u.vertexLength+l>cr.MAX_VERTEX_ARRAY_LENGTH&&(u=this.segments.prepareSegment(l,this.layoutVertexArray,this.indexArray)),zse[e.type]!=="Polygon")continue;let c=[],p=[],d=u.vertexLength;for(let g of s)if(g.length!==0){g!==s[0]&&p.push(c.length/2);for(let b=0;b<g.length;b++){let x=g[b];qh(this.layoutVertexArray,x.x,x.y,0,0,1,1,0),o.x+=x.x,o.y+=x.y,o.vertexCount+=1,c.push(x.x),c.push(x.y)}}let m=(0,Rse.default)(c,p);for(let g=0;g<m.length;g+=3)this.indexArray.emplaceBack(d+m[g],d+m[g+2],d+m[g+1]);u.primitiveLength+=m.length/3,u.vertexLength+=l}for(let s=0;s<o.vertexCount;s++)this.centroidVertexArray.emplaceBack(Math.floor(o.x/o.vertexCount),Math.floor(o.y/o.vertexCount));this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,a,n)}};h(uN,"FillExtrusionBucket");var hN=uN;st("FillExtrusionBucket",hN,{omit:["layers","features"]});function cN(i,e){return i.x===e.x&&(i.x<0||i.x>8192)||i.y===e.y&&(i.y<0||i.y>8192)}h(cN,"isBoundaryEdge");function pN(i){return i.every(e=>e.x<0)||i.every(e=>e.x>8192)||i.every(e=>e.y<0)||i.every(e=>e.y>8192)}h(pN,"isEntirelyOutside");R();var VP,Ose=h(()=>VP=VP||new Zn({"fill-extrusion-opacity":new mt(Le["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new St(Le["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new mt(Le["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new mt(Le["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new bx(Le["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new St(Le["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new St(Le["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new mt(Le["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])}),"getPaint"),Nse={get paint(){return Ose()}},Lw=It(di(),1),dN=class extends qo{constructor(e){super(e,Nse)}createBucket(e){return new hN(e)}queryRadius(){return Ym(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(e,t,r,n,a,o,s,l){let u=Jm(e,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),o.angle,s),c=this.paint.get("fill-extrusion-height").evaluate(t,r),p=this.paint.get("fill-extrusion-base").evaluate(t,r),d=gN(u,l,o,0),m=mN(n,p,c,l),g=m[0],b=m[1];return fN(g,b,d)}};h(dN,"FillExtrusionStyleLayer");var $se=dN;function Zh(i,e){return i.x*e.x+i.y*e.y}h(Zh,"dot");function Dw(i,e){if(i.length===1){let t=0,r=e[t++],n;for(;!n||r.equals(n);)if(n=e[t++],!n)return 1/0;for(;t<e.length;t++){let a=e[t],o=i[0],s=n.sub(r),l=a.sub(r),u=o.sub(r),c=Zh(s,s),p=Zh(s,l),d=Zh(l,l),m=Zh(u,s),g=Zh(u,l),b=c*d-p*p,x=(d*m-p*g)/b,v=(c*g-p*m)/b,w=1-x-v,_=r.z*w+n.z*x+a.z*v;if(isFinite(_))return _}return 1/0}else{let t=1/0;for(let r of e)t=Math.min(t,r.z);return t}}h(Dw,"getIntersectionDistance");function fN(i,e,t){let r=1/0;q4(t,e)&&(r=Dw(t,e[0]));for(let n=0;n<e.length;n++){let a=e[n],o=i[n];for(let s=0;s<a.length-1;s++){let l=a[s],u=a[s+1],c=o[s],p=o[s+1],d=[l,u,p,c,l];X4(t,d)&&(r=Math.min(r,Dw(t,d)))}}return r===1/0?!1:r}h(fN,"checkIntersection");function mN(i,e,t,r){let n=[],a=[],o=r[8]*e,s=r[9]*e,l=r[10]*e,u=r[11]*e,c=r[8]*t,p=r[9]*t,d=r[10]*t,m=r[11]*t;for(let g of i){let b=[],x=[];for(let v of g){let w=v.x,_=v.y,C=r[0]*w+r[4]*_+r[12],E=r[1]*w+r[5]*_+r[13],T=r[2]*w+r[6]*_+r[14],L=r[3]*w+r[7]*_+r[15],D=C+o,B=E+s,A=T+l,k=L+u,$=C+c,O=E+p,P=T+d,U=L+m,G=new Lw.default(D/k,B/k);G.z=A/k,b.push(G);let K=new Lw.default($/U,O/U);K.z=P/U,x.push(K)}n.push(b),a.push(x)}return[n,a]}h(mN,"projectExtrusion");function gN(i,e,t,r){let n=[];for(let a of i){let o=[a.x,a.y,r,1];wn.transformMat4(o,o,e),n.push(new Lw.default(o[0]/o[3],o[1]/o[3]))}return n}h(gN,"projectQueryGeometry");R();R();R();var Use=Xi([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:Vse,size:Xwe,alignment:qwe}=Use;R();var jse=Xi([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:Hse,size:Zwe,alignment:Ywe}=jse,Gse=It(Qv(),1),Wse=Gse.default.VectorTileFeature.types,jP=63,Xse=Math.cos(75/2*(Math.PI/180)),qse=15,Zse=20,Yse=15,yN=1/2,HP=Math.pow(2,Yse-1)/yN,vN=class{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(t=>t.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(t=>{this.gradients[t.id]={}}),this.layoutVertexArray=new _oe,this.layoutVertexArray2=new boe,this.indexArray=new ch,this.programConfigurations=new Ju(e.layers,e.zoom),this.segments=new cr,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(t=>t.isStateDependent()).map(t=>t.id)}populate(e,t,r){this.hasPattern=Px("line",this.layers,t);let n=this.layers[0].layout.get("line-sort-key"),a=!n.isConstant(),o=[];for(let{feature:s,id:l,index:u,sourceLayerIndex:c}of e){let p=this.layers[0]._featureFilter.needGeometry,d=Hl(s,p);if(!this.layers[0]._featureFilter.filter(new Pr(this.zoom),d,r))continue;let m=a?n.evaluate(d,{},r):void 0,g={id:l,properties:s.properties,type:s.type,sourceLayerIndex:c,index:u,geometry:p?d.geometry:jl(s),patterns:{},sortKey:m};o.push(g)}a&&o.sort((s,l)=>s.sortKey-l.sortKey);for(let s of o){let{geometry:l,index:u,sourceLayerIndex:c}=s;if(this.hasPattern){let d=Ax("line",this.layers,s,this.zoom,t);this.patternFeatures.push(d)}else this.addFeature(s,l,u,r,{});let p=e[u].feature;t.featureIndex.insert(p,l,u,c,this.index)}}update(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)}addFeatures(e,t,r){for(let n of this.patternFeatures)this.addFeature(n,n.geometry,n.index,t,r)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,Hse)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Vse),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_end")){let t=+e.properties.mapbox_clip_start,r=+e.properties.mapbox_clip_end;return{start:t,end:r}}}addFeature(e,t,r,n,a){let o=this.layers[0].layout,s=o.get("line-join").evaluate(e,{}),l=o.get("line-cap"),u=o.get("line-miter-limit"),c=o.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(let p of t)this.addLine(p,e,s,l,u,c);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,a,n)}addLine(e,t,r,n,a,o){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let v=0;v<e.length-1;v++)this.totalDistance+=e[v].dist(e[v+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}let s=Wse[t.type]==="Polygon",l=e.length;for(;l>=2&&e[l-1].equals(e[l-2]);)l--;let u=0;for(;u<l-1&&e[u].equals(e[u+1]);)u++;if(l<(s?3:2))return;r==="bevel"&&(a=1.05);let c=this.overscaling<=16?qse*8192/(512*this.overscaling):0,p=this.segments.prepareSegment(l*10,this.layoutVertexArray,this.indexArray),d,m,g,b,x;this.e1=this.e2=-1,s&&(d=e[l-2],x=e[u].sub(d)._unit()._perp());for(let v=u;v<l;v++){if(g=v===l-1?s?e[u+1]:void 0:e[v+1],g&&e[v].equals(g))continue;x&&(b=x),d&&(m=d),d=e[v],x=g?g.sub(d)._unit()._perp():b,b=b||x;let w=b.add(x);(w.x!==0||w.y!==0)&&w._unit();let _=b.x*x.x+b.y*x.y,C=w.x*x.x+w.y*x.y,E=C!==0?1/C:1/0,T=2*Math.sqrt(2-2*C),L=C<Xse&&m&&g,D=b.x*x.y-b.y*x.x>0;if(L&&v>u){let k=d.dist(m);if(k>2*c){let $=d.sub(d.sub(m)._mult(c/k)._round());this.updateDistance(m,$),this.addCurrentVertex($,b,0,0,p),m=$}}let B=m&&g,A=B?r:s?"butt":n;if(B&&A==="round"&&(E<o?A="miter":E<=2&&(A="fakeround")),A==="miter"&&E>a&&(A="bevel"),A==="bevel"&&(E>2&&(A="flipbevel"),E<a&&(A="miter")),m&&this.updateDistance(m,d),A==="miter")w._mult(E),this.addCurrentVertex(d,w,0,0,p);else if(A==="flipbevel"){if(E>100)w=x.mult(-1);else{let k=E*b.add(x).mag()/b.sub(x).mag();w._perp()._mult(k*(D?-1:1))}this.addCurrentVertex(d,w,0,0,p),this.addCurrentVertex(d,w.mult(-1),0,0,p)}else if(A==="bevel"||A==="fakeround"){let k=-Math.sqrt(E*E-1),$=D?k:0,O=D?0:k;if(m&&this.addCurrentVertex(d,b,$,O,p),A==="fakeround"){let P=Math.round(T*180/Math.PI/Zse);for(let U=1;U<P;U++){let G=U/P;if(G!==.5){let z=G-.5,V=1.0904+_*(-3.2452+_*(3.55645-_*1.43519)),j=.848013+_*(-1.06021+_*.215638);G=G+G*z*(G-1)*(V*z*z+j)}let K=x.sub(b)._mult(G)._add(b)._unit()._mult(D?-1:1);this.addHalfVertex(d,K.x,K.y,!1,D,0,p)}}g&&this.addCurrentVertex(d,x,-$,-O,p)}else if(A==="butt")this.addCurrentVertex(d,w,0,0,p);else if(A==="square"){let k=m?1:-1;this.addCurrentVertex(d,w,k,k,p)}else A==="round"&&(m&&(this.addCurrentVertex(d,b,0,0,p),this.addCurrentVertex(d,b,1,1,p,!0)),g&&(this.addCurrentVertex(d,x,-1,-1,p,!0),this.addCurrentVertex(d,x,0,0,p)));if(L&&v<l-1){let k=d.dist(g);if(k>2*c){let $=d.add(g.sub(d)._mult(c/k)._round());this.updateDistance(d,$),this.addCurrentVertex($,x,0,0,p),d=$}}}}addCurrentVertex(e,t,r,n,a,o=!1){let s=t.x+t.y*r,l=t.y-t.x*r,u=-t.x+t.y*n,c=-t.y-t.x*n;this.addHalfVertex(e,s,l,o,!1,r,a),this.addHalfVertex(e,u,c,o,!0,-n,a),this.distance>HP/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(e,t,r,n,a,o))}addHalfVertex({x:e,y:t},r,n,a,o,s,l){let u=(this.lineClips?this.scaledDistance*(HP-1):this.scaledDistance)*yN;if(this.layoutVertexArray.emplaceBack((e<<1)+(a?1:0),(t<<1)+(o?1:0),Math.round(jP*r)+128,Math.round(jP*n)+128,(s===0?0:s<0?-1:1)+1|(u&63)<<2,u>>6),this.lineClips){let p=this.scaledDistance-this.lineClips.start,d=this.lineClips.end-this.lineClips.start,m=p/d;this.layoutVertexArray2.emplaceBack(m,this.lineClipsArray.length)}let c=l.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,c),l.primitiveLength++),o?this.e2=c:this.e1=c}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(e,t){this.distance+=e.dist(t),this.updateScaledDistance()}};h(vN,"LineBucket");var xN=vN;st("LineBucket",xN,{omit:["layers","patternFeatures"]});R();var GP,Jse=h(()=>GP=GP||new Zn({"line-cap":new mt(Le.layout_line["line-cap"]),"line-join":new St(Le.layout_line["line-join"]),"line-miter-limit":new mt(Le.layout_line["line-miter-limit"]),"line-round-limit":new mt(Le.layout_line["line-round-limit"]),"line-sort-key":new St(Le.layout_line["line-sort-key"])}),"getLayout"),WP,Kse=h(()=>WP=WP||new Zn({"line-opacity":new St(Le.paint_line["line-opacity"]),"line-color":new St(Le.paint_line["line-color"]),"line-translate":new mt(Le.paint_line["line-translate"]),"line-translate-anchor":new mt(Le.paint_line["line-translate-anchor"]),"line-width":new St(Le.paint_line["line-width"]),"line-gap-width":new St(Le.paint_line["line-gap-width"]),"line-offset":new St(Le.paint_line["line-offset"]),"line-blur":new St(Le.paint_line["line-blur"]),"line-dasharray":new C4(Le.paint_line["line-dasharray"]),"line-pattern":new bx(Le.paint_line["line-pattern"]),"line-gradient":new E4(Le.paint_line["line-gradient"])}),"getPaint"),XP={get paint(){return Kse()},get layout(){return Jse()}},_N=class extends St{possiblyEvaluate(e,t){return t=new Pr(Math.floor(t.zoom),{now:t.now,fadeDuration:t.fadeDuration,zoomHistory:t.zoomHistory,transition:t.transition}),super.possiblyEvaluate(e,t)}evaluate(e,t,r,n){return t=ht({},t,{zoom:Math.floor(t.zoom)}),super.evaluate(e,t,r,n)}};h(_N,"LineFloorwidthProperty");var Qse=_N,Bg,bN=class extends qo{constructor(e){super(e,XP),this.gradientVersion=0,Bg||(Bg=new Qse(XP.paint.properties["line-width"].specification),Bg.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(e){if(e==="line-gradient"){let t=this.gradientExpression();td(t)?this.stepInterpolant=t._styleExpression.expression instanceof XC:this.stepInterpolant=!1,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(e,t){super.recalculate(e,t),this.paint._values["line-floorwidth"]=Bg.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,e)}createBucket(e){return new xN(e)}queryRadius(e){let t=e,r=kw(hp("line-width",this,t),hp("line-gap-width",this,t)),n=hp("line-offset",this,t);return r/2+Math.abs(n)+Ym(this.paint.get("line-translate"))}queryIntersectsFeature(e,t,r,n,a,o,s){let l=Jm(e,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),o.angle,s),u=s/2*kw(this.paint.get("line-width").evaluate(t,r),this.paint.get("line-gap-width").evaluate(t,r)),c=this.paint.get("line-offset").evaluate(t,r);return c&&(n=kF(n,c*s)),TF(l,n,u)}isTileClipped(){return!0}};h(bN,"LineStyleLayer");var ele=bN;function kw(i,e){return e>0?e+2*i:i}h(kw,"getLineWidth");R();R();R();var tle=Xi([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),ile=Xi([{name:"a_projected_pos",components:3,type:"Float32"}],4);Xi([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);var rle=Xi([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);Xi([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);var qP=Xi([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),nle=Xi([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Xi([{name:"triangle",components:3,type:"Uint16"}]);Xi([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]);Xi([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]);Xi([{type:"Float32",name:"offsetX"}]);Xi([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);Xi([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);var Og=It(di(),1);R();function wN(i,e,t){let r=e.layout.get("text-transform").evaluate(t,{});return r==="uppercase"?i=i.toLocaleUpperCase():r==="lowercase"&&(i=i.toLocaleLowerCase()),xm.applyArabicShaping&&(i=xm.applyArabicShaping(i)),i}h(wN,"transformTextInternal");function SN(i,e,t){return i.sections.forEach(r=>{r.text=wN(r.text,e,t)}),i}h(SN,"transformText");R();function MN(i){let e={},t={},r=[],n=0;function a(u){r.push(i[u]),n++}h(a,"add");function o(u,c,p){let d=t[u];return delete t[u],t[c]=d,r[d].geometry[0].pop(),r[d].geometry[0]=r[d].geometry[0].concat(p[0]),d}h(o,"mergeFromRight");function s(u,c,p){let d=e[c];return delete e[c],e[u]=d,r[d].geometry[0].shift(),r[d].geometry[0]=p[0].concat(r[d].geometry[0]),d}h(s,"mergeFromLeft");function l(u,c,p){let d=p?c[0][c[0].length-1]:c[0][0];return`${u}:${d.x}:${d.y}`}h(l,"getKey");for(let u=0;u<i.length;u++){let c=i[u],p=c.geometry,d=c.text?c.text.toString():null;if(!d){a(u);continue}let m=l(d,p),g=l(d,p,!0);if(m in t&&g in e&&t[m]!==e[g]){let b=s(m,g,p),x=o(m,g,r[b].geometry);delete e[m],delete t[g],t[l(d,r[x].geometry,!0)]=x,r[b].geometry=null}else m in t?o(m,g,p):g in e?s(m,g,p):(a(u),e[m]=n-1,t[g]=n-1)}return r.filter(u=>u.geometry)}h(MN,"mergeLines");R();R();var ale={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"};R();var CN=24;R();var ole=It(Q7(),1),ZP=3;function EN(i,e,t){i===1&&t.readMessage(TN,e)}h(EN,"readFontstacks");function TN(i,e,t){if(i===3){let{id:r,bitmap:n,width:a,height:o,left:s,top:l,advance:u}=t.readMessage(PN,{});e.push({id:r,bitmap:new R5({width:a+2*ZP,height:o+2*ZP},n),metrics:{width:a,height:o,left:s,top:l,advance:u}})}}h(TN,"readFontstack");function PN(i,e,t){i===1?e.id=t.readVarint():i===2?e.bitmap=t.readBytes():i===3?e.width=t.readVarint():i===4?e.height=t.readVarint():i===5?e.left=t.readSVarint():i===6?e.top=t.readSVarint():i===7&&(e.advance=t.readVarint())}h(PN,"readGlyph");function AN(i){return new ole.default(i).readFields(EN,[])}h(AN,"parseGlyphPbf");R();R();function O5(i){let e=0,t=0;for(let o of i)e+=o.w*o.h,t=Math.max(t,o.w);i.sort((o,s)=>s.h-o.h);let r=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),t),h:1/0}],n=0,a=0;for(let o of i)for(let s=r.length-1;s>=0;s--){let l=r[s];if(!(o.w>l.w||o.h>l.h)){if(o.x=l.x,o.y=l.y,a=Math.max(a,o.y+o.h),n=Math.max(n,o.x+o.w),o.w===l.w&&o.h===l.h){let u=r.pop();s<r.length&&(r[s]=u)}else o.h===l.h?(l.x+=o.w,l.w-=o.w):o.w===l.w?(l.y+=o.h,l.h-=o.h):(r.push({x:l.x+o.w,y:l.y,w:l.w-o.w,h:o.h}),l.y+=o.h,l.h-=o.h);break}}return{w:n,h:a,fill:e/(n*a)||0}}h(O5,"potpack");var Pa=1,IN=class{constructor(e,{pixelRatio:t,version:r,stretchX:n,stretchY:a,content:o}){this.paddedRect=e,this.pixelRatio=t,this.stretchX=n,this.stretchY=a,this.content=o,this.version=r}get tl(){return[this.paddedRect.x+Pa,this.paddedRect.y+Pa]}get br(){return[this.paddedRect.x+this.paddedRect.w-Pa,this.paddedRect.y+this.paddedRect.h-Pa]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-Pa*2)/this.pixelRatio,(this.paddedRect.h-Pa*2)/this.pixelRatio]}};h(IN,"ImagePosition");var N5=IN,LN=class{constructor(e,t){let r={},n={};this.haveRenderCallbacks=[];let a=[];this.addImages(e,r,a),this.addImages(t,n,a);let{w:o,h:s}=O5(a),l=new Qi({width:o||1,height:s||1});for(let u in e){let c=e[u],p=r[u].paddedRect;Qi.copy(c.data,l,{x:0,y:0},{x:p.x+Pa,y:p.y+Pa},c.data)}for(let u in t){let c=t[u],p=n[u].paddedRect,d=p.x+Pa,m=p.y+Pa,g=c.data.width,b=c.data.height;Qi.copy(c.data,l,{x:0,y:0},{x:d,y:m},c.data),Qi.copy(c.data,l,{x:0,y:b-1},{x:d,y:m-1},{width:g,height:1}),Qi.copy(c.data,l,{x:0,y:0},{x:d,y:m+b},{width:g,height:1}),Qi.copy(c.data,l,{x:g-1,y:0},{x:d-1,y:m},{width:1,height:b}),Qi.copy(c.data,l,{x:0,y:0},{x:d+g,y:m},{width:1,height:b})}this.image=l,this.iconPositions=r,this.patternPositions=n}addImages(e,t,r){for(let n in e){let a=e[n],o={x:0,y:0,w:a.data.width+2*Pa,h:a.data.height+2*Pa};r.push(o),t[n]=new N5(o,a),a.hasRenderCallback&&this.haveRenderCallbacks.push(n)}}patchUpdatedImages(e,t){e.dispatchRenderCallbacks(this.haveRenderCallbacks);for(let r in e.updatedImages)this.patchUpdatedImage(this.iconPositions[r],e.getImage(r),t),this.patchUpdatedImage(this.patternPositions[r],e.getImage(r),t)}patchUpdatedImage(e,t,r){if(!e||!t||e.version===t.version)return;e.version=t.version;let[n,a]=e.tl;r.update(t.data,void 0,{x:n,y:a})}};h(LN,"ImageAtlas");var sle=LN;st("ImagePosition",N5);st("ImageAtlas",sle);var DN=(i=>(i[i.none=0]="none",i[i.horizontal=1]="horizontal",i[i.vertical=2]="vertical",i[i.horizontalOnly=3]="horizontalOnly",i))(DN||{});function $5(i){let e=.5,t=.5;switch(i){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0;break}switch(i){case"bottom":case"bottom-right":case"bottom-left":t=1;break;case"top":case"top-right":case"top-left":t=0;break}return{horizontalAlign:e,verticalAlign:t}}h($5,"getAnchorAlignment");var lle=It(Qv(),1);R();var ule=255,ly=128,YP=ule*ly;function Rw(i,e){let{expression:t}=e;if(t.kind==="constant")return{kind:"constant",layoutSize:t.evaluate(new Pr(i+1))};if(t.kind==="source")return{kind:"source"};{let{zoomStops:r,interpolationType:n}=t,a=0;for(;a<r.length&&r[a]<=i;)a++;a=Math.max(0,a-1);let o=a;for(;o<r.length&&r[o]<i+1;)o++;o=Math.min(r.length-1,o);let s=r[a],l=r[o];if(t.kind==="composite")return{kind:"composite",minZoom:s,maxZoom:l,interpolationType:n};let u=t.evaluate(new Pr(s)),c=t.evaluate(new Pr(l));return{kind:"camera",minZoom:s,maxZoom:l,minSize:u,maxSize:c,interpolationType:n}}}h(Rw,"getSizeData");function Ix(i,{uSize:e,uSizeT:t},{lowerSize:r,upperSize:n}){return i.kind==="source"?r/ly:i.kind==="composite"?ji.number(r/ly,n/ly,t):e}h(Ix,"evaluateSizeForFeature");function Km(i,e){let t=0,r=0;if(i.kind==="constant")r=i.layoutSize;else if(i.kind!=="source"){let{interpolationType:n,minZoom:a,maxZoom:o}=i,s=n?Tr(Vo.interpolationFactor(n,e,a,o),0,1):0;i.kind==="camera"?r=ji.number(i.minSize,i.maxSize,s):t=s}return{uSizeT:t,uSize:r}}h(Km,"evaluateSizeForZoom");R();function bm(i,e,t){let r="never",n=i.get(e);return n?r=n:i.get(t)&&(r="always"),r}h(bm,"getOverlapMode");var hle=lle.default.VectorTileFeature.types,cle=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Yd(i,e,t,r,n,a,o,s,l,u,c,p,d){let m=s?Math.min(YP,Math.round(s[0])):0,g=s?Math.min(YP,Math.round(s[1])):0;i.emplaceBack(e,t,Math.round(r*32),Math.round(n*32),a,o,(m<<1)+(l?1:0),g,u*16,c*16,p*256,d*256)}h(Yd,"addVertex");function Fp(i,e,t){i.emplaceBack(e.x,e.y,t),i.emplaceBack(e.x,e.y,t),i.emplaceBack(e.x,e.y,t),i.emplaceBack(e.x,e.y,t)}h(Fp,"addDynamicAttributes");function kN(i){for(let e of i.sections)if(bk(e.text))return!0;return!1}h(kN,"containsRTLText");var RN=class{constructor(e){this.layoutVertexArray=new woe,this.indexArray=new ch,this.programConfigurations=e,this.segments=new cr,this.dynamicLayoutVertexArray=new Soe,this.opacityVertexArray=new Moe,this.hasVisibleVertices=!1,this.placedSymbolArray=new _R}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(e,t,r,n){this.isEmpty()||(r&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,tle.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,t),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,ile.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,cle,!0),this.opacityVertexBuffer.itemSize=1),(r||n)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}};h(RN,"SymbolBuffers");var Fw=RN;st("SymbolBuffers",Fw);var FN=class{constructor(e,t,r){this.layoutVertexArray=new e,this.layoutAttributes=t,this.indexArray=new r,this.segments=new cr,this.collisionVertexArray=new Eoe}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,rle.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}};h(FN,"CollisionBuffers");var zw=FN;st("CollisionBuffers",zw);var zN=class{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(s=>s.id),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=lt.identity([]),this.placementViewportMatrix=lt.identity([]);let t=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Rw(this.zoom,t["text-size"]),this.iconSizeData=Rw(this.zoom,t["icon-size"]);let r=this.layers[0].layout,n=r.get("symbol-sort-key"),a=r.get("symbol-z-order");this.canOverlap=bm(r,"text-overlap","text-allow-overlap")!=="never"||bm(r,"icon-overlap","icon-allow-overlap")!=="never"||r.get("text-ignore-placement")||r.get("icon-ignore-placement"),this.sortFeaturesByKey=a!=="viewport-y"&&!n.isConstant();let o=a==="viewport-y"||a==="auto"&&!this.sortFeaturesByKey;this.sortFeaturesByY=o&&this.canOverlap,r.get("symbol-placement")==="point"&&(this.writingModes=r.get("text-writing-mode").map(s=>DN[s])),this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id),this.sourceID=e.sourceID}createArrays(){this.text=new Fw(new Ju(this.layers,this.zoom,e=>/^text/.test(e))),this.icon=new Fw(new Ju(this.layers,this.zoom,e=>/^icon/.test(e))),this.glyphOffsetArray=new ER,this.lineVertexArray=new PR,this.symbolInstances=new MR,this.textAnchorOffsets=new DR}calculateGlyphDependencies(e,t,r,n,a){for(let o=0;o<e.length;o++)if(t[e.charCodeAt(o)]=!0,(r||n)&&a){let s=ale[e.charAt(o)];s&&(t[s.charCodeAt(0)]=!0)}}populate(e,t,r){let n=this.layers[0],a=n.layout,o=a.get("text-font"),s=a.get("text-field"),l=a.get("icon-image"),u=(s.value.kind!=="constant"||s.value.value instanceof Ls&&!s.value.value.isEmpty()||s.value.value.toString().length>0)&&(o.value.kind!=="constant"||o.value.value.length>0),c=l.value.kind!=="constant"||!!l.value.value||Object.keys(l.parameters).length>0,p=a.get("symbol-sort-key");if(this.features=[],!u&&!c)return;let d=t.iconDependencies,m=t.glyphDependencies,g=t.availableImages,b=new Pr(this.zoom);for(let{feature:x,id:v,index:w,sourceLayerIndex:_}of e){let C=n._featureFilter.needGeometry,E=Hl(x,C);if(!n._featureFilter.filter(b,E,r))continue;C||(E.geometry=jl(x));let T;if(u){let A=n.getValueAndResolveTokens("text-field",E,r,g),k=Ls.factory(A),$=this.hasRTLText=this.hasRTLText||kN(k);(!$||xm.getRTLTextPluginStatus()==="unavailable"||$&&xm.isParsed())&&(T=SN(k,n,E))}let L;if(c){let A=n.getValueAndResolveTokens("icon-image",E,r,g);A instanceof Wo?L=A:L=Wo.fromString(A)}if(!T&&!L)continue;let D=this.sortFeaturesByKey?p.evaluate(E,{},r):void 0,B={id:v,text:T,icon:L,index:w,sourceLayerIndex:_,geometry:E.geometry,properties:x.properties,type:hle[x.type],sortKey:D};if(this.features.push(B),L&&(d[L.name]=!0),T){let A=o.evaluate(E,{},r).join(","),k=a.get("text-rotation-alignment")!=="viewport"&&a.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(2)>=0;for(let $ of T.sections)if($.image)d[$.image.name]=!0;else{let O=vk(T.toString()),P=$.fontStack||A,U=m[P]=m[P]||{};this.calculateGlyphDependencies($.text,U,k,this.allowVerticalPlacement,O)}}}a.get("symbol-placement")==="line"&&(this.features=MN(this.features)),this.sortFeaturesByKey&&this.features.sort((x,v)=>x.sortKey-v.sortKey)}update(e,t,r){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,t,this.layers,r),this.icon.programConfigurations.updatePaintArrays(e,t,this.layers,r))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,t){let r=this.lineVertexArray.length;if(e.segment!==void 0){let n=e.dist(t[e.segment+1]),a=e.dist(t[e.segment]),o={};for(let s=e.segment+1;s<t.length;s++)o[s]={x:t[s].x,y:t[s].y,tileUnitDistanceFromAnchor:n},s<t.length-1&&(n+=t[s+1].dist(t[s]));for(let s=e.segment||0;s>=0;s--)o[s]={x:t[s].x,y:t[s].y,tileUnitDistanceFromAnchor:a},s>0&&(a+=t[s-1].dist(t[s]));for(let s=0;s<t.length;s++){let l=o[s];this.lineVertexArray.emplaceBack(l.x,l.y,l.tileUnitDistanceFromAnchor)}}return{lineStartIndex:r,lineLength:this.lineVertexArray.length-r}}addSymbols(e,t,r,n,a,o,s,l,u,c,p,d){let m=e.indexArray,g=e.layoutVertexArray,b=e.segments.prepareSegment(4*t.length,g,m,this.canOverlap?o.sortKey:void 0),x=this.glyphOffsetArray.length,v=b.vertexLength,w=this.allowVerticalPlacement&&s===2?Math.PI/2:0,_=o.text&&o.text.sections;for(let C=0;C<t.length;C++){let{tl:E,tr:T,bl:L,br:D,tex:B,pixelOffsetTL:A,pixelOffsetBR:k,minFontScaleX:$,minFontScaleY:O,glyphOffset:P,isSDF:U,sectionIndex:G}=t[C],K=b.vertexLength,z=P[1];Yd(g,l.x,l.y,E.x,z+E.y,B.x,B.y,r,U,A.x,A.y,$,O),Yd(g,l.x,l.y,T.x,z+T.y,B.x+B.w,B.y,r,U,k.x,A.y,$,O),Yd(g,l.x,l.y,L.x,z+L.y,B.x,B.y+B.h,r,U,A.x,k.y,$,O),Yd(g,l.x,l.y,D.x,z+D.y,B.x+B.w,B.y+B.h,r,U,k.x,k.y,$,O),Fp(e.dynamicLayoutVertexArray,l,w),m.emplaceBack(K,K+1,K+2),m.emplaceBack(K+1,K+2,K+3),b.vertexLength+=4,b.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(P[0]),(C===t.length-1||G!==t[C+1].sectionIndex)&&e.programConfigurations.populatePaintArrays(g.length,o,o.index,{},d,_&&_[G])}e.placedSymbolArray.emplaceBack(l.x,l.y,x,this.glyphOffsetArray.length-x,v,u,c,l.segment,r?r[0]:0,r?r[1]:0,n[0],n[1],s,0,!1,0,p)}_addCollisionDebugVertex(e,t,r,n,a,o){return t.emplaceBack(0,0),e.emplaceBack(r.x,r.y,n,a,Math.round(o.x),Math.round(o.y))}addCollisionDebugVertices(e,t,r,n,a,o,s){let l=a.segments.prepareSegment(4,a.layoutVertexArray,a.indexArray),u=l.vertexLength,c=a.layoutVertexArray,p=a.collisionVertexArray,d=s.anchorX,m=s.anchorY;this._addCollisionDebugVertex(c,p,o,d,m,new Og.default(e,t)),this._addCollisionDebugVertex(c,p,o,d,m,new Og.default(r,t)),this._addCollisionDebugVertex(c,p,o,d,m,new Og.default(r,n)),this._addCollisionDebugVertex(c,p,o,d,m,new Og.default(e,n)),l.vertexLength+=4;let g=a.indexArray;g.emplaceBack(u,u+1),g.emplaceBack(u+1,u+2),g.emplaceBack(u+2,u+3),g.emplaceBack(u+3,u),l.primitiveLength+=4}addDebugCollisionBoxes(e,t,r,n){for(let a=e;a<t;a++){let o=this.collisionBoxArray.get(a),s=o.x1,l=o.y1,u=o.x2,c=o.y2;this.addCollisionDebugVertices(s,l,u,c,n?this.textCollisionBox:this.iconCollisionBox,o.anchorPoint,r)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new zw(RP,qP.members,ww),this.iconCollisionBox=new zw(RP,qP.members,ww);for(let e=0;e<this.symbolInstances.length;e++){let t=this.symbolInstances.get(e);this.addDebugCollisionBoxes(t.textBoxStartIndex,t.textBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.verticalTextBoxStartIndex,t.verticalTextBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.iconBoxStartIndex,t.iconBoxEndIndex,t,!1),this.addDebugCollisionBoxes(t.verticalIconBoxStartIndex,t.verticalIconBoxEndIndex,t,!1)}}_deserializeCollisionBoxesForSymbol(e,t,r,n,a,o,s,l,u){let c={};for(let p=t;p<r;p++){let d=e.get(p);c.textBox={x1:d.x1,y1:d.y1,x2:d.x2,y2:d.y2,anchorPointX:d.anchorPointX,anchorPointY:d.anchorPointY},c.textFeatureIndex=d.featureIndex;break}for(let p=n;p<a;p++){let d=e.get(p);c.verticalTextBox={x1:d.x1,y1:d.y1,x2:d.x2,y2:d.y2,anchorPointX:d.anchorPointX,anchorPointY:d.anchorPointY},c.verticalTextFeatureIndex=d.featureIndex;break}for(let p=o;p<s;p++){let d=e.get(p);c.iconBox={x1:d.x1,y1:d.y1,x2:d.x2,y2:d.y2,anchorPointX:d.anchorPointX,anchorPointY:d.anchorPointY},c.iconFeatureIndex=d.featureIndex;break}for(let p=l;p<u;p++){let d=e.get(p);c.verticalIconBox={x1:d.x1,y1:d.y1,x2:d.x2,y2:d.y2,anchorPointX:d.anchorPointX,anchorPointY:d.anchorPointY},c.verticalIconFeatureIndex=d.featureIndex;break}return c}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let t=0;t<this.symbolInstances.length;t++){let r=this.symbolInstances.get(t);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,r.textBoxStartIndex,r.textBoxEndIndex,r.verticalTextBoxStartIndex,r.verticalTextBoxEndIndex,r.iconBoxStartIndex,r.iconBoxEndIndex,r.verticalIconBoxStartIndex,r.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(e,t){let r=e.placedSymbolArray.get(t),n=r.vertexStartIndex+r.numGlyphs*4;for(let a=r.vertexStartIndex;a<n;a+=4)e.indexArray.emplaceBack(a,a+1,a+2),e.indexArray.emplaceBack(a+1,a+2,a+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;let t=Math.sin(e),r=Math.cos(e),n=[],a=[],o=[];for(let s=0;s<this.symbolInstances.length;++s){o.push(s);let l=this.symbolInstances.get(s);n.push(Math.round(t*l.anchorX+r*l.anchorY)|0),a.push(l.featureIndex)}return o.sort((s,l)=>n[s]-n[l]||a[l]-a[s]),o}addToSortKeyRanges(e,t){let r=this.sortKeyRanges[this.sortKeyRanges.length-1];r&&r.sortKey===t?r.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:t,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(let t of this.symbolInstanceIndexes){let r=this.symbolInstances.get(t);this.featureSortOrder.push(r.featureIndex),[r.rightJustifiedTextSymbolIndex,r.centerJustifiedTextSymbolIndex,r.leftJustifiedTextSymbolIndex].forEach((n,a,o)=>{n>=0&&o.indexOf(n)===a&&this.addIndicesForPlacedSymbol(this.text,n)}),r.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,r.verticalPlacedTextSymbolIndex),r.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,r.placedIconSymbolIndex),r.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,r.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}};h(zN,"SymbolBucket");var zp=zN;st("SymbolBucket",zp,{omit:["layers","collisionBoxArray","features","compareText"]});zp.MAX_GLYPHS=65535;zp.addDynamicAttributes=Fp;R();function BN(i,e){return e.replace(/{([^{}]+)}/g,(t,r)=>i&&r in i?String(i[r]):"")}h(BN,"resolveTokens");R();var JP,ple=h(()=>JP=JP||new Zn({"symbol-placement":new mt(Le.layout_symbol["symbol-placement"]),"symbol-spacing":new mt(Le.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new mt(Le.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new St(Le.layout_symbol["symbol-sort-key"]),"symbol-z-order":new mt(Le.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new mt(Le.layout_symbol["icon-allow-overlap"]),"icon-overlap":new mt(Le.layout_symbol["icon-overlap"]),"icon-ignore-placement":new mt(Le.layout_symbol["icon-ignore-placement"]),"icon-optional":new mt(Le.layout_symbol["icon-optional"]),"icon-rotation-alignment":new mt(Le.layout_symbol["icon-rotation-alignment"]),"icon-size":new St(Le.layout_symbol["icon-size"]),"icon-text-fit":new mt(Le.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new mt(Le.layout_symbol["icon-text-fit-padding"]),"icon-image":new St(Le.layout_symbol["icon-image"]),"icon-rotate":new St(Le.layout_symbol["icon-rotate"]),"icon-padding":new St(Le.layout_symbol["icon-padding"]),"icon-keep-upright":new mt(Le.layout_symbol["icon-keep-upright"]),"icon-offset":new St(Le.layout_symbol["icon-offset"]),"icon-anchor":new St(Le.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new mt(Le.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new mt(Le.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new mt(Le.layout_symbol["text-rotation-alignment"]),"text-field":new St(Le.layout_symbol["text-field"]),"text-font":new St(Le.layout_symbol["text-font"]),"text-size":new St(Le.layout_symbol["text-size"]),"text-max-width":new St(Le.layout_symbol["text-max-width"]),"text-line-height":new mt(Le.layout_symbol["text-line-height"]),"text-letter-spacing":new St(Le.layout_symbol["text-letter-spacing"]),"text-justify":new St(Le.layout_symbol["text-justify"]),"text-radial-offset":new St(Le.layout_symbol["text-radial-offset"]),"text-variable-anchor":new mt(Le.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new St(Le.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new St(Le.layout_symbol["text-anchor"]),"text-max-angle":new mt(Le.layout_symbol["text-max-angle"]),"text-writing-mode":new mt(Le.layout_symbol["text-writing-mode"]),"text-rotate":new St(Le.layout_symbol["text-rotate"]),"text-padding":new mt(Le.layout_symbol["text-padding"]),"text-keep-upright":new mt(Le.layout_symbol["text-keep-upright"]),"text-transform":new St(Le.layout_symbol["text-transform"]),"text-offset":new St(Le.layout_symbol["text-offset"]),"text-allow-overlap":new mt(Le.layout_symbol["text-allow-overlap"]),"text-overlap":new mt(Le.layout_symbol["text-overlap"]),"text-ignore-placement":new mt(Le.layout_symbol["text-ignore-placement"]),"text-optional":new mt(Le.layout_symbol["text-optional"])}),"getLayout"),KP,dle=h(()=>KP=KP||new Zn({"icon-opacity":new St(Le.paint_symbol["icon-opacity"]),"icon-color":new St(Le.paint_symbol["icon-color"]),"icon-halo-color":new St(Le.paint_symbol["icon-halo-color"]),"icon-halo-width":new St(Le.paint_symbol["icon-halo-width"]),"icon-halo-blur":new St(Le.paint_symbol["icon-halo-blur"]),"icon-translate":new mt(Le.paint_symbol["icon-translate"]),"icon-translate-anchor":new mt(Le.paint_symbol["icon-translate-anchor"]),"text-opacity":new St(Le.paint_symbol["text-opacity"]),"text-color":new St(Le.paint_symbol["text-color"],{runtimeType:go,getOverride:i=>i.textColor,hasOverride:i=>!!i.textColor}),"text-halo-color":new St(Le.paint_symbol["text-halo-color"]),"text-halo-width":new St(Le.paint_symbol["text-halo-width"]),"text-halo-blur":new St(Le.paint_symbol["text-halo-blur"]),"text-translate":new mt(Le.paint_symbol["text-translate"]),"text-translate-anchor":new mt(Le.paint_symbol["text-translate-anchor"])}),"getPaint"),U_={get paint(){return dle()},get layout(){return ple()}};R();var ON=class{constructor(e){if(e.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=e.property.overrides?e.property.overrides.runtimeType:$m,this.defaultValue=e}evaluate(e){if(e.formattedSection){let t=this.defaultValue.property.overrides;if(t&&t.hasOverride(e.formattedSection))return t.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){if(!this.defaultValue.isConstant()){let t=this.defaultValue.value;e(t._styleExpression.expression)}}outputDefined(){return!1}serialize(){return null}};h(ON,"FormatSectionOverride");var NN=ON;st("FormatSectionOverride",NN,{omit:["defaultValue"]});var $N=class Bw extends qo{constructor(e){super(e,U_)}recalculate(e,t){if(super.recalculate(e,t),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout.get("symbol-placement")!=="point"?this.layout._values["icon-rotation-alignment"]="map":this.layout._values["icon-rotation-alignment"]="viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout.get("symbol-placement")!=="point"?this.layout._values["text-rotation-alignment"]="map":this.layout._values["text-rotation-alignment"]="viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){let r=this.layout.get("text-writing-mode");if(r){let n=[];for(let a of r)n.indexOf(a)<0&&n.push(a);this.layout._values["text-writing-mode"]=n}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(e,t,r,n){let a=this.layout.get(e).evaluate(t,{},r,n),o=this._unevaluatedLayout._values[e];return!o.isDataDriven()&&!td(o.value)&&a?BN(t.properties,a):a}createBucket(e){return new zp(e)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(let e of U_.paint.overridableProperties){if(!Bw.hasPaintOverride(this.layout,e))continue;let t=this.paint.get(e),r=new NN(t),n=new o4(r,t.property.specification),a=null;t.value.kind==="constant"||t.value.kind==="source"?a=new iv("source",n):a=new rv("composite",n,t.value.zoomStops),this.paint._values[e]=new co(t.property,a,t.parameters)}}_handleOverridablePaintPropertyUpdate(e,t,r){return!this.layout||t.isDataDriven()||r.isDataDriven()?!1:Bw.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,t){let r=e.get("text-field"),n=U_.paint.properties[t],a=!1,o=h(s=>{for(let l of s)if(n.overrides&&n.overrides.hasOverride(l)){a=!0;return}},"checkSections");if(r.value.kind==="constant"&&r.value.value instanceof Ls)o(r.value.value.sections);else if(r.value.kind==="source"){let s=h(u=>{if(!a)if(u instanceof pm&&xr(u.value)===Um){let c=u.value;o(c.sections)}else u instanceof tD?o(u.sections):u.eachChild(s)},"checkExpression"),l=r.value;l._styleExpression&&s(l._styleExpression.expression)}return a}};h($N,"SymbolStyleLayer");var fle=$N;R();R();var QP,mle=h(()=>QP=QP||new Zn({"background-color":new mt(Le.paint_background["background-color"]),"background-pattern":new C4(Le.paint_background["background-pattern"]),"background-opacity":new mt(Le.paint_background["background-opacity"])}),"getPaint"),gle={get paint(){return mle()}},UN=class extends qo{constructor(e){super(e,gle)}};h(UN,"BackgroundStyleLayer");var yle=UN;R();R();var eA,vle=h(()=>eA=eA||new Zn({"raster-opacity":new mt(Le.paint_raster["raster-opacity"]),"raster-hue-rotate":new mt(Le.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new mt(Le.paint_raster["raster-brightness-min"]),"raster-brightness-max":new mt(Le.paint_raster["raster-brightness-max"]),"raster-saturation":new mt(Le.paint_raster["raster-saturation"]),"raster-contrast":new mt(Le.paint_raster["raster-contrast"]),"raster-resampling":new mt(Le.paint_raster["raster-resampling"]),"raster-fade-duration":new mt(Le.paint_raster["raster-fade-duration"])}),"getPaint"),xle={get paint(){return vle()}},VN=class extends qo{constructor(e){super(e,xle)}};h(VN,"RasterStyleLayer");var _le=VN;R();function jN(i){let e=[],t=i.id;return t===void 0&&e.push({message:`layers.${t}: missing required property "id"`}),i.render===void 0&&e.push({message:`layers.${t}: missing required method "render"`}),i.renderingMode&&i.renderingMode!=="2d"&&i.renderingMode!=="3d"&&e.push({message:`layers.${t}: property "renderingMode" must be either "2d" or "3d"`}),e}h(jN,"validateCustomStyleLayer");var HN=class extends qo{constructor(e){super(e,{}),this.onAdd=t=>{this.implementation.onAdd&&this.implementation.onAdd(t,t.painter.context.gl)},this.onRemove=t=>{this.implementation.onRemove&&this.implementation.onRemove(t,t.painter.context.gl)},this.implementation=e}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}};h(HN,"CustomStyleLayer");var ble=HN;function uy(i){if(i.type==="custom")return new ble(i);switch(i.type){case"background":return new yle(i);case"circle":return new gse(i);case"fill":return new Ise(i);case"fill-extrusion":return new $se(i);case"heatmap":return new xse(i);case"hillshade":return new wse(i);case"line":return new ele(i);case"raster":return new _le(i);case"symbol":return new fle(i)}}h(uy,"createStyleLayer");R();R();function Gf(i){let e=[];if(typeof i=="string")e.push({id:"default",url:i});else if(i&&i.length>0){let t=[];for(let{id:r,url:n}of i){let a=`${r}${n}`;t.indexOf(a)===-1&&(t.push(a),e.push({id:r,url:n}))}}return e}h(Gf,"coerceSpriteToArray");async function GN(i,e,t,r){let n=Gf(i),a=t>1?"@2x":"",o={},s={};for(let{id:l,url:u}of n){let c=e.transformRequest(e.normalizeSpriteURL(u,a,".json"),"SpriteJSON");o[l]=rx(c,r);let p=e.transformRequest(e.normalizeSpriteURL(u,a,".png"),"SpriteImage");s[l]=Uo.getImage(p,r)}return await Promise.all([...Object.values(o),...Object.values(s)]),WN(o,s)}h(GN,"loadSprite");async function WN(i,e){let t={};for(let r in i){t[r]={};let n=ai.getImageCanvasContext((await e[r]).data),a=(await i[r]).data;for(let o in a){let{width:s,height:l,x:u,y:c,sdf:p,pixelRatio:d,stretchX:m,stretchY:g,content:b}=a[o],x={width:s,height:l,x:u,y:c,context:n};t[r][o]={data:null,pixelRatio:d,sdf:p,stretchX:m,stretchY:g,content:b,spriteData:x}}}return t}h(WN,"doOnceCompleted");R();R();var XN=class{constructor(e,t,r,n){this.context=e,this.format=r,this.texture=e.gl.createTexture(),this.update(t,n)}update(e,t,r){let{width:n,height:a}=e,o=(!this.size||this.size[0]!==n||this.size[1]!==a)&&!r,{context:s}=this,{gl:l}=s;if(this.useMipmap=!!(t&&t.useMipmap),l.bindTexture(l.TEXTURE_2D,this.texture),s.pixelStoreUnpackFlipY.set(!1),s.pixelStoreUnpack.set(1),s.pixelStoreUnpackPremultiplyAlpha.set(this.format===l.RGBA&&(!t||t.premultiply!==!1)),o)this.size=[n,a],e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||$o(e)?l.texImage2D(l.TEXTURE_2D,0,this.format,this.format,l.UNSIGNED_BYTE,e):l.texImage2D(l.TEXTURE_2D,0,this.format,n,a,0,this.format,l.UNSIGNED_BYTE,e.data);else{let{x:u,y:c}=r||{x:0,y:0};e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||$o(e)?l.texSubImage2D(l.TEXTURE_2D,0,u,c,l.RGBA,l.UNSIGNED_BYTE,e):l.texSubImage2D(l.TEXTURE_2D,0,u,c,n,a,l.RGBA,l.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&l.generateMipmap(l.TEXTURE_2D)}bind(e,t,r){let{context:n}=this,{gl:a}=n;a.bindTexture(a.TEXTURE_2D,this.texture),r===a.LINEAR_MIPMAP_NEAREST&&!this.isSizePowerOfTwo()&&(r=a.LINEAR),e!==this.filter&&(a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,e),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,r||e),this.filter=e),t!==this.wrap&&(a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,t),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,t),this.wrap=t)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1===0}destroy(){let{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}};h(XN,"Texture");var Rr=XN;R();function qN(i){let{userImage:e}=i;return e&&e.render&&e.render()?(i.data.replace(new Uint8Array(e.data.buffer)),!0):!1}h(qN,"renderStyleImage");var Ng=1,ZN=class extends hn{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new Qi({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(e){if(this.loaded!==e&&(this.loaded=e,e)){for(let{ids:t,promiseResolve:r}of this.requestors)r(this._getImagesForIds(t));this.requestors=[]}}getImage(e){let t=this.images[e];if(t&&!t.data&&t.spriteData){let r=t.spriteData;t.data=new Qi({width:r.width,height:r.height},r.context.getImageData(r.x,r.y,r.width,r.height).data),t.spriteData=null}return t}addImage(e,t){if(this.images[e])throw new Error(`Image id ${e} already exist, use updateImage instead`);this._validate(e,t)&&(this.images[e]=t)}_validate(e,t){let r=!0,n=t.data||t.spriteData;return this._validateStretch(t.stretchX,n&&n.width)||(this.fire(new Mt(new Error(`Image "${e}" has invalid "stretchX" value`))),r=!1),this._validateStretch(t.stretchY,n&&n.height)||(this.fire(new Mt(new Error(`Image "${e}" has invalid "stretchY" value`))),r=!1),this._validateContent(t.content,t)||(this.fire(new Mt(new Error(`Image "${e}" has invalid "content" value`))),r=!1),r}_validateStretch(e,t){if(!e)return!0;let r=0;for(let n of e){if(n[0]<r||n[1]<n[0]||t<n[1])return!1;r=n[1]}return!0}_validateContent(e,t){if(!e)return!0;if(e.length!==4)return!1;let r=t.spriteData,n=r&&r.width||t.data.width,a=r&&r.height||t.data.height;return!(e[0]<0||n<e[0]||e[1]<0||a<e[1]||e[2]<0||n<e[2]||e[3]<0||a<e[3]||e[2]<e[0]||e[3]<e[1])}updateImage(e,t,r=!0){let n=this.getImage(e);if(r&&(n.data.width!==t.data.width||n.data.height!==t.data.height))throw new Error(`size mismatch between old image (${n.data.width}x${n.data.height}) and new image (${t.data.width}x${t.data.height}).`);t.version=n.version+1,this.images[e]=t,this.updatedImages[e]=!0}removeImage(e){let t=this.images[e];delete this.images[e],delete this.patterns[e],t.userImage&&t.userImage.onRemove&&t.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(e){return new Promise((t,r)=>{let n=!0;if(!this.isLoaded())for(let a of e)this.images[a]||(n=!1);this.isLoaded()||n?t(this._getImagesForIds(e)):this.requestors.push({ids:e,promiseResolve:t})})}_getImagesForIds(e){let t={};for(let r of e){let n=this.getImage(r);n||(this.fire(new qe("styleimagemissing",{id:r})),n=this.getImage(r)),n?t[r]={data:n.data.clone(),pixelRatio:n.pixelRatio,sdf:n.sdf,version:n.version,stretchX:n.stretchX,stretchY:n.stretchY,content:n.content,hasRenderCallback:!!(n.userImage&&n.userImage.render)}:ln(`Image "${r}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return t}getPixelSize(){let{width:e,height:t}=this.atlasImage;return{width:e,height:t}}getPattern(e){let t=this.patterns[e],r=this.getImage(e);if(!r)return null;if(t&&t.position.version===r.version)return t.position;if(t)t.position.version=r.version;else{let n=r.data.width+Ng*2,a=r.data.height+Ng*2,o={w:n,h:a,x:0,y:0},s=new N5(o,r);this.patterns[e]={bin:o,position:s}}return this._updatePatternAtlas(),this.patterns[e].position}bind(e){let t=e.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new Rr(e,this.atlasImage,t.RGBA),this.atlasTexture.bind(t.LINEAR,t.CLAMP_TO_EDGE)}_updatePatternAtlas(){let e=[];for(let a in this.patterns)e.push(this.patterns[a].bin);let{w:t,h:r}=O5(e),n=this.atlasImage;n.resize({width:t||1,height:r||1});for(let a in this.patterns){let{bin:o}=this.patterns[a],s=o.x+Ng,l=o.y+Ng,u=this.getImage(a).data,c=u.width,p=u.height;Qi.copy(u,n,{x:0,y:0},{x:s,y:l},{width:c,height:p}),Qi.copy(u,n,{x:0,y:p-1},{x:s,y:l-1},{width:c,height:1}),Qi.copy(u,n,{x:0,y:0},{x:s,y:l+p},{width:c,height:1}),Qi.copy(u,n,{x:c-1,y:0},{x:s-1,y:l},{width:1,height:p}),Qi.copy(u,n,{x:0,y:0},{x:s+c,y:l},{width:1,height:p})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(e){for(let t of e){if(this.callbackDispatchedThisFrame[t])continue;this.callbackDispatchedThisFrame[t]=!0;let r=this.getImage(t);r||ln(`Image with ID: "${t}" was not found`),qN(r)&&this.updateImage(t,r)}}};h(ZN,"ImageManager");var wle=ZN;R();R();async function YN(i,e,t,r){let n=e*256,a=n+255,o=r.transformRequest(t.replace("{fontstack}",i).replace("{range}",`${n}-${a}`),"Glyphs"),s=await Vne(o,new AbortController);if(!s||!s.data)throw new Error(`Could not load glyph range. range: ${e}, ${n}-${a}`);let l={};for(let u of AN(s.data))l[u.id]=u;return l}h(YN,"loadGlyphRange");R();var JN=class{constructor({fontSize:e=24,buffer:t=3,radius:r=8,cutoff:n=.25,fontFamily:a="sans-serif",fontWeight:o="normal",fontStyle:s="normal"}={}){this.buffer=t,this.cutoff=n,this.radius=r;let l=this.size=e+t*4,u=this._createCanvas(l),c=this.ctx=u.getContext("2d",{willReadFrequently:!0});c.font=`${s} ${o} ${e}px ${a}`,c.textBaseline="alphabetic",c.textAlign="left",c.fillStyle="black",this.gridOuter=new Float64Array(l*l),this.gridInner=new Float64Array(l*l),this.f=new Float64Array(l),this.z=new Float64Array(l+1),this.v=new Uint16Array(l)}_createCanvas(e){let t=document.createElement("canvas");return t.width=t.height=e,t}draw(e){let{width:t,actualBoundingBoxAscent:r,actualBoundingBoxDescent:n,actualBoundingBoxLeft:a,actualBoundingBoxRight:o}=this.ctx.measureText(e),s=Math.ceil(r),l=0,u=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(o-a))),c=Math.min(this.size-this.buffer,s+Math.ceil(n)),p=u+2*this.buffer,d=c+2*this.buffer,m=Math.max(p*d,0),g=new Uint8ClampedArray(m),b={data:g,width:p,height:d,glyphWidth:u,glyphHeight:c,glyphTop:s,glyphLeft:l,glyphAdvance:t};if(u===0||c===0)return b;let{ctx:x,buffer:v,gridInner:w,gridOuter:_}=this;x.clearRect(v,v,u,c),x.fillText(e,v,v+s);let C=x.getImageData(v,v,u,c);_.fill(1e20,0,m),w.fill(0,0,m);for(let E=0;E<c;E++)for(let T=0;T<u;T++){let L=C.data[4*(E*u+T)+3]/255;if(L===0)continue;let D=(E+v)*p+T+v;if(L===1)_[D]=0,w[D]=1e20;else{let B=.5-L;_[D]=B>0?B*B:0,w[D]=B<0?B*B:0}}Ow(_,0,0,p,d,p,this.f,this.v,this.z),Ow(w,v,v,u,c,p,this.f,this.v,this.z);for(let E=0;E<m;E++){let T=Math.sqrt(_[E])-Math.sqrt(w[E]);g[E]=Math.round(255-255*(T/this.radius+this.cutoff))}return b}};h(JN,"TinySDF");var Sle=JN;function Ow(i,e,t,r,n,a,o,s,l){for(let u=e;u<e+r;u++)Nw(i,t*a+u,a,n,o,s,l);for(let u=t;u<t+n;u++)Nw(i,u*a+e,1,r,o,s,l)}h(Ow,"edt");function Nw(i,e,t,r,n,a,o){a[0]=0,o[0]=-1e20,o[1]=1e20,n[0]=i[e];for(let s=1,l=0,u=0;s<r;s++){n[s]=i[e+s*t];let c=s*s;do{let p=a[l];u=(n[s]-n[p]+c-p*p)/(s-p)/2}while(u<=o[l]&&--l>-1);l++,a[l]=s,o[l]=u,o[l+1]=1e20}for(let s=0,l=0;s<r;s++){for(;o[l+1]<s;)l++;let u=a[l],c=s-u;i[e+s*t]=n[u]+c*c}}h(Nw,"edt1d");var hy=class $w{constructor(e,t){this.requestManager=e,this.localIdeographFontFamily=t,this.entries={}}setURL(e){this.url=e}async getGlyphs(e){let t=[];for(let a in e)for(let o of e[a])t.push(this._getAndCacheGlyphsPromise(a,o));let r=await Promise.all(t),n={};for(let{stack:a,id:o,glyph:s}of r)n[a]||(n[a]={}),n[a][o]=s&&{id:s.id,bitmap:s.bitmap.clone(),metrics:s.metrics};return n}async _getAndCacheGlyphsPromise(e,t){let r=this.entries[e];r||(r=this.entries[e]={glyphs:{},requests:{},ranges:{}});let n=r.glyphs[t];if(n!==void 0)return{stack:e,id:t,glyph:n};if(n=this._tinySDF(r,e,t),n)return r.glyphs[t]=n,{stack:e,id:t,glyph:n};let a=Math.floor(t/256);if(a*256>65535)throw new Error("glyphs > 65535 not supported");if(r.ranges[a])return{stack:e,id:t,glyph:n};if(!this.url)throw new Error("glyphsUrl is not set");if(!r.requests[a]){let s=$w.loadGlyphRange(e,a,this.url,this.requestManager);r.requests[a]=s}let o=await r.requests[a];for(let s in o)this._doesCharSupportLocalGlyph(+s)||(r.glyphs[+s]=o[+s]);return r.ranges[a]=!0,{stack:e,id:t,glyph:o[t]||null}}_doesCharSupportLocalGlyph(e){return!!this.localIdeographFontFamily&&(ii["CJK Unified Ideographs"](e)||ii["Hangul Syllables"](e)||ii.Hiragana(e)||ii.Katakana(e))}_tinySDF(e,t,r){let n=this.localIdeographFontFamily;if(!n||!this._doesCharSupportLocalGlyph(r))return;let a=2,o=e.tinySDF;if(!o){let l="400";/bold/i.test(t)?l="900":/medium/i.test(t)?l="500":/light/i.test(t)&&(l="200"),o=e.tinySDF=new $w.TinySDF({fontSize:24*a,buffer:3*a,radius:8*a,cutoff:.25,fontFamily:n,fontWeight:l})}let s=o.draw(String.fromCharCode(r));return{id:r,bitmap:new R5({width:s.width||30*a,height:s.height||30*a},s.data),metrics:{width:s.glyphWidth/a||24,height:s.glyphHeight/a||24,left:s.glyphLeft/a+.5||0,top:s.glyphTop/a-27.5||-8,advance:s.glyphAdvance/a||24,isDoubleResolution:!0}}}};h(hy,"GlyphManager"),hy.loadGlyphRange=YN,hy.TinySDF=Sle;var Mle=hy;R();var KN=class{constructor(){this.specification=Le.light.position}possiblyEvaluate(e,t){return uL(e.expression.evaluate(t))}interpolate(e,t,r){return{x:ji.number(e.x,t.x,r),y:ji.number(e.y,t.y,r),z:ji.number(e.z,t.z,r)}}};h(KN,"LightPositionProperty");var Cle=KN,tA="-transition",V_,QN=class extends hn{constructor(e){super(),V_=V_||new Zn({anchor:new mt(Le.light.anchor),position:new Cle,color:new mt(Le.light.color),intensity:new mt(Le.light.intensity)}),this._transitionable=new Pk(V_),this.setLight(e),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(e,t={}){if(!this._validate(soe,e,t))for(let r in e){let n=e[r];r.endsWith(tA)?this._transitionable.setTransition(r.slice(0,-tA.length),n):this._transitionable.setValue(r,n)}}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,t,r){return r&&r.validate===!1?!1:vx(this,e.call(Dr,{value:t,style:{glyphs:!0,sprite:!0},styleSpec:Le}))}};h(QN,"Light");var Ele=QN;R();var e$=class{constructor(e,t){this.width=e,this.height=t,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(e,t){let r=e.join(",")+String(t);return this.dashEntry[r]||(this.dashEntry[r]=this.addDash(e,t)),this.dashEntry[r]}getDashRanges(e,t,r){let n=e.length%2===1,a=[],o=n?-e[e.length-1]*r:0,s=e[0]*r,l=!0;a.push({left:o,right:s,isDash:l,zeroLength:e[0]===0});let u=e[0];for(let c=1;c<e.length;c++){l=!l;let p=e[c];o=u*r,u+=p,s=u*r,a.push({left:o,right:s,isDash:l,zeroLength:p===0})}return a}addRoundDash(e,t,r){let n=t/2;for(let a=-r;a<=r;a++){let o=this.nextRow+r+a,s=this.width*o,l=0,u=e[l];for(let c=0;c<this.width;c++){c/u.right>1&&(u=e[++l]);let p=Math.abs(c-u.left),d=Math.abs(c-u.right),m=Math.min(p,d),g,b=a/r*(n+1);if(u.isDash){let x=n-Math.abs(b);g=Math.sqrt(m*m+x*x)}else g=n-Math.sqrt(m*m+b*b);this.data[s+c]=Math.max(0,Math.min(255,g+128))}}}addRegularDash(e){for(let s=e.length-1;s>=0;--s){let l=e[s],u=e[s+1];l.zeroLength?e.splice(s,1):u&&u.isDash===l.isDash&&(u.left=l.left,e.splice(s,1))}let t=e[0],r=e[e.length-1];t.isDash===r.isDash&&(t.left=r.left-this.width,r.right=t.right+this.width);let n=this.width*this.nextRow,a=0,o=e[a];for(let s=0;s<this.width;s++){s/o.right>1&&(o=e[++a]);let l=Math.abs(s-o.left),u=Math.abs(s-o.right),c=Math.min(l,u),p=o.isDash?c:-c;this.data[n+s]=Math.max(0,Math.min(255,p+128))}}addDash(e,t){let r=t?7:0,n=2*r+1;if(this.nextRow+n>this.height)return ln("LineAtlas out of space"),null;let a=0;for(let s=0;s<e.length;s++)a+=e[s];if(a!==0){let s=this.width/a,l=this.getDashRanges(e,this.width,s);t?this.addRoundDash(l,s,r):this.addRegularDash(l)}let o={y:(this.nextRow+r+.5)/this.height,height:2*r/this.height,width:a};return this.nextRow+=n,this.dirty=!0,o}bind(e){let t=e.gl;this.texture?(t.bindTexture(t.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,t.texSubImage2D(t.TEXTURE_2D,0,0,0,this.width,this.height,t.ALPHA,t.UNSIGNED_BYTE,this.data))):(this.texture=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texImage2D(t.TEXTURE_2D,0,t.ALPHA,this.width,this.height,0,t.ALPHA,t.UNSIGNED_BYTE,this.data))}};h(e$,"LineAtlas");var Tle=e$;R();R();R();var t$=class{constructor(e){this._methodToThrottle=e,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}};h(t$,"ThrottledInvoker");var Ple=t$,i$=class{constructor(e,t){this.target=e,this.mapId=t,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new Ple(()=>this.process()),this.subscription=fL(this.target,"message",r=>this.receive(r),!1),this.globalScope=Xu(self)?e:window}registerMessageHandler(e,t){this.messageHandlers[e]=t}sendAsync(e,t){return new Promise((r,n)=>{let a=Math.round(Math.random()*1e18).toString(36).substring(0,10);this.resolveRejects[a]={resolve:r,reject:n},t&&t.signal.addEventListener("abort",()=>{delete this.resolveRejects[a];let l={id:a,type:"<cancel>",origin:location.origin,targetMapId:e.targetMapId,sourceMapId:this.mapId};this.target.postMessage(l)},{once:!0});let o=[],s={...e,id:a,sourceMapId:this.mapId,origin:location.origin,data:sp(e.data,o)};this.target.postMessage(s,{transfer:o})})}receive(e){let t=e.data,r=t.id;if(!(t.origin!=="file://"&&location.origin!=="file://"&&t.origin!==location.origin)&&!(t.targetMapId&&this.mapId!==t.targetMapId)){if(t.type==="<cancel>"){delete this.tasks[r];let n=this.abortControllers[r];delete this.abortControllers[r],n&&n.abort();return}if(Xu(self)||t.mustQueue){this.tasks[r]=t,this.taskQueue.push(r),this.invoker.trigger();return}this.processTask(r,t)}}process(){if(this.taskQueue.length===0)return;let e=this.taskQueue.shift(),t=this.tasks[e];delete this.tasks[e],this.taskQueue.length>0&&this.invoker.trigger(),t&&this.processTask(e,t)}async processTask(e,t){if(t.type==="<response>"){let a=this.resolveRejects[e];if(delete this.resolveRejects[e],!a)return;t.error?a.reject(lp(t.error)):a.resolve(lp(t.data));return}if(!this.messageHandlers[t.type]){this.completeTask(e,new Error(`Could not find a registered handler for ${t.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));return}let r=lp(t.data),n=new AbortController;this.abortControllers[e]=n;try{let a=await this.messageHandlers[t.type](t.sourceMapId,r,n);this.completeTask(e,null,a)}catch(a){this.completeTask(e,a)}}completeTask(e,t,r){let n=[];delete this.abortControllers[e];let a={id:e,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:t?sp(t):null,data:sp(r,n)};this.target.postMessage(a,{transfer:n})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}};h(i$,"Actor");var Ale=i$;R();R();R();R();var Ile='(()=>{var by=Object.create;var Ba=Object.defineProperty;var vy=Object.getOwnPropertyDescriptor;var Py=Object.getOwnPropertyNames;var Sy=Object.getPrototypeOf,wy=Object.prototype.hasOwnProperty;var Ae=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),Ll=(e,t)=>{for(var r in t)Ba(e,r,{get:t[r],enumerable:!0})},Ay=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of Py(t))!wy.call(e,i)&&i!==r&&Ba(e,i,{get:()=>t[i],enumerable:!(n=vy(t,i))||n.enumerable});return e};var Z=(e,t,r)=>(r=e!=null?by(Sy(e)):{},Ay(t||!e||!e.__esModule?Ba(r,"default",{value:e,enumerable:!0}):r,e));var he=Ae((l0,Dl)=>{"use strict";Dl.exports=or;function or(e,t){this.x=e,this.y=t}or.prototype={clone:function(){return new or(this.x,this.y)},add:function(e){return this.clone()._add(e)},sub:function(e){return this.clone()._sub(e)},multByPoint:function(e){return this.clone()._multByPoint(e)},divByPoint:function(e){return this.clone()._divByPoint(e)},mult:function(e){return this.clone()._mult(e)},div:function(e){return this.clone()._div(e)},rotate:function(e){return this.clone()._rotate(e)},rotateAround:function(e,t){return this.clone()._rotateAround(e,t)},matMult:function(e){return this.clone()._matMult(e)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(e){return this.x===e.x&&this.y===e.y},dist:function(e){return Math.sqrt(this.distSqr(e))},distSqr:function(e){var t=e.x-this.x,r=e.y-this.y;return t*t+r*r},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith:function(e){return this.angleWithSep(e.x,e.y)},angleWithSep:function(e,t){return Math.atan2(this.x*t-this.y*e,this.x*e+this.y*t)},_matMult:function(e){var t=e[0]*this.x+e[1]*this.y,r=e[2]*this.x+e[3]*this.y;return this.x=t,this.y=r,this},_add:function(e){return this.x+=e.x,this.y+=e.y,this},_sub:function(e){return this.x-=e.x,this.y-=e.y,this},_mult:function(e){return this.x*=e,this.y*=e,this},_div:function(e){return this.x/=e,this.y/=e,this},_multByPoint:function(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint:function(e){return this.x/=e.x,this.y/=e.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var e=this.y;return this.y=this.x,this.x=-e,this},_rotate:function(e){var t=Math.cos(e),r=Math.sin(e),n=t*this.x-r*this.y,i=r*this.x+t*this.y;return this.x=n,this.y=i,this},_rotateAround:function(e,t){var r=Math.cos(e),n=Math.sin(e),i=t.x+r*(this.x-t.x)-n*(this.y-t.y),o=t.y+n*(this.x-t.x)+r*(this.y-t.y);return this.x=i,this.y=o,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}};or.convert=function(e){return e instanceof or?e:Array.isArray(e)?new or(e[0],e[1]):e}});var zl=Ae((u0,Bl)=>{"use strict";Bl.exports=Vl;function Vl(e,t,r,n){this.cx=3*e,this.bx=3*(r-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(n-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=t,this.p2x=r,this.p2y=n}Vl.prototype={sampleCurveX:function(e){return((this.ax*e+this.bx)*e+this.cx)*e},sampleCurveY:function(e){return((this.ay*e+this.by)*e+this.cy)*e},sampleCurveDerivativeX:function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},solveCurveX:function(e,t){if(t===void 0&&(t=1e-6),e<0)return 0;if(e>1)return 1;for(var r=e,n=0;n<8;n++){var i=this.sampleCurveX(r)-e;if(Math.abs(i)<t)return r;var o=this.sampleCurveDerivativeX(r);if(Math.abs(o)<1e-6)break;r=r-i/o}var a=0,s=1;for(r=e,n=0;n<20&&(i=this.sampleCurveX(r),!(Math.abs(i-e)<t));n++)e>i?a=r:s=r,r=(s-a)*.5+a;return r},solve:function(e,t){return this.sampleCurveY(this.solveCurveX(e,t))}}});var Ac=Ae(($v,As)=>{function sd(e,t){var r,n,i,o,a,s,l,u,c,p;for(r=e.length&3,n=e.length-r,i=t,a=3432918353,l=461845907,p=0;p<n;)c=e.charCodeAt(p)&255|(e.charCodeAt(++p)&255)<<8|(e.charCodeAt(++p)&255)<<16|(e.charCodeAt(++p)&255)<<24,++p,c=(c&65535)*a+(((c>>>16)*a&65535)<<16)&4294967295,c=c<<15|c>>>17,c=(c&65535)*l+(((c>>>16)*l&65535)<<16)&4294967295,i^=c,i=i<<13|i>>>19,o=(i&65535)*5+(((i>>>16)*5&65535)<<16)&4294967295,i=(o&65535)+27492+(((o>>>16)+58964&65535)<<16);switch(c=0,r){case 3:c^=(e.charCodeAt(p+2)&255)<<16;case 2:c^=(e.charCodeAt(p+1)&255)<<8;case 1:c^=e.charCodeAt(p)&255,c=(c&65535)*a+(((c>>>16)*a&65535)<<16)&4294967295,c=c<<15|c>>>17,c=(c&65535)*l+(((c>>>16)*l&65535)<<16)&4294967295,i^=c}return i^=e.length,i^=i>>>16,i=(i&65535)*2246822507+(((i>>>16)*2246822507&65535)<<16)&4294967295,i^=i>>>13,i=(i&65535)*3266489909+(((i>>>16)*3266489909&65535)<<16)&4294967295,i^=i>>>16,i>>>0}typeof As<"u"&&(As.exports=sd)});var _c=Ae((Gv,_s)=>{function ld(e,t){for(var r=e.length,n=t^r,i=0,o;r>=4;)o=e.charCodeAt(i)&255|(e.charCodeAt(++i)&255)<<8|(e.charCodeAt(++i)&255)<<16|(e.charCodeAt(++i)&255)<<24,o=(o&65535)*1540483477+(((o>>>16)*1540483477&65535)<<16),o^=o>>>24,o=(o&65535)*1540483477+(((o>>>16)*1540483477&65535)<<16),n=(n&65535)*1540483477+(((n>>>16)*1540483477&65535)<<16)^o,r-=4,++i;switch(r){case 3:n^=(e.charCodeAt(i+2)&255)<<16;case 2:n^=(e.charCodeAt(i+1)&255)<<8;case 1:n^=e.charCodeAt(i)&255,n=(n&65535)*1540483477+(((n>>>16)*1540483477&65535)<<16)}return n^=n>>>13,n=(n&65535)*1540483477+(((n>>>16)*1540483477&65535)<<16),n^=n>>>15,n>>>0}typeof _s!==void 0&&(_s.exports=ld)});var Is=Ae((qv,Mo)=>{var Ic=Ac(),ud=_c();Mo.exports=Ic;Mo.exports.murmur3=Ic;Mo.exports.murmur2=ud});var Os=Ae((BP,Rs)=>{"use strict";Rs.exports=Go;Rs.exports.default=Go;function Go(e,t,r){r=r||2;var n=t&&t.length,i=n?t[0]*r:e.length,o=fp(e,0,i,r,!0),a=[];if(!o||o.next===o.prev)return a;var s,l,u,c,p,f,y;if(n&&(o=Hg(e,t,o,r)),e.length>80*r){s=u=e[0],l=c=e[1];for(var m=r;m<i;m+=r)p=e[m],f=e[m+1],p<s&&(s=p),f<l&&(l=f),p>u&&(u=p),f>c&&(c=f);y=Math.max(u-s,c-l),y=y!==0?32767/y:0}return Zn(o,a,r,s,l,y,0),a}function fp(e,t,r,n,i){var o,a;if(i===zs(e,t,r,n)>0)for(o=t;o<r;o+=n)a=pp(o,e[o],e[o+1],a);else for(o=r-n;o>=t;o-=n)a=pp(o,e[o],e[o+1],a);return a&&qo(a,a.next)&&(Hn(a),a=a.next),a}function Qt(e,t){if(!e)return e;t||(t=e);var r=e,n;do if(n=!1,!r.steiner&&(qo(r,r.next)||oe(r.prev,r,r.next)===0)){if(Hn(r),r=t=r.prev,r===r.next)break;n=!0}else r=r.next;while(n||r!==t);return t}function Zn(e,t,r,n,i,o,a){if(e){!a&&o&&ex(e,n,i,o);for(var s=e,l,u;e.prev!==e.next;){if(l=e.prev,u=e.next,o?Jg(e,n,i,o):jg(e)){t.push(l.i/r|0),t.push(e.i/r|0),t.push(u.i/r|0),Hn(e),e=u.next,s=u.next;continue}if(e=u,e===s){a?a===1?(e=Zg(Qt(e),t,r),Zn(e,t,r,n,i,o,2)):a===2&&Wg(e,t,r,n,i,o):Zn(Qt(e),t,r,n,i,o,1);break}}}}function jg(e){var t=e.prev,r=e,n=e.next;if(oe(t,r,n)>=0)return!1;for(var i=t.x,o=r.x,a=n.x,s=t.y,l=r.y,u=n.y,c=i<o?i<a?i:a:o<a?o:a,p=s<l?s<u?s:u:l<u?l:u,f=i>o?i>a?i:a:o>a?o:a,y=s>l?s>u?s:u:l>u?l:u,m=n.next;m!==t;){if(m.x>=c&&m.x<=f&&m.y>=p&&m.y<=y&&Ar(i,s,o,l,a,u,m.x,m.y)&&oe(m.prev,m,m.next)>=0)return!1;m=m.next}return!0}function Jg(e,t,r,n){var i=e.prev,o=e,a=e.next;if(oe(i,o,a)>=0)return!1;for(var s=i.x,l=o.x,u=a.x,c=i.y,p=o.y,f=a.y,y=s<l?s<u?s:u:l<u?l:u,m=c<p?c<f?c:f:p<f?p:f,h=s>l?s>u?s:u:l>u?l:u,d=c>p?c>f?c:f:p>f?p:f,g=Vs(y,m,t,r,n),b=Vs(h,d,t,r,n),x=e.prevZ,v=e.nextZ;x&&x.z>=g&&v&&v.z<=b;){if(x.x>=y&&x.x<=h&&x.y>=m&&x.y<=d&&x!==i&&x!==a&&Ar(s,c,l,p,u,f,x.x,x.y)&&oe(x.prev,x,x.next)>=0||(x=x.prevZ,v.x>=y&&v.x<=h&&v.y>=m&&v.y<=d&&v!==i&&v!==a&&Ar(s,c,l,p,u,f,v.x,v.y)&&oe(v.prev,v,v.next)>=0))return!1;v=v.nextZ}for(;x&&x.z>=g;){if(x.x>=y&&x.x<=h&&x.y>=m&&x.y<=d&&x!==i&&x!==a&&Ar(s,c,l,p,u,f,x.x,x.y)&&oe(x.prev,x,x.next)>=0)return!1;x=x.prevZ}for(;v&&v.z<=b;){if(v.x>=y&&v.x<=h&&v.y>=m&&v.y<=d&&v!==i&&v!==a&&Ar(s,c,l,p,u,f,v.x,v.y)&&oe(v.prev,v,v.next)>=0)return!1;v=v.nextZ}return!0}function Zg(e,t,r){var n=e;do{var i=n.prev,o=n.next.next;!qo(i,o)&&yp(i,n,n.next,o)&&Wn(i,o)&&Wn(o,i)&&(t.push(i.i/r|0),t.push(n.i/r|0),t.push(o.i/r|0),Hn(n),Hn(n.next),n=e=o),n=n.next}while(n!==e);return Qt(n)}function Wg(e,t,r,n,i,o){var a=e;do{for(var s=a.next.next;s!==a.prev;){if(a.i!==s.i&&nx(a,s)){var l=mp(a,s);a=Qt(a,a.next),l=Qt(l,l.next),Zn(a,t,r,n,i,o,0),Zn(l,t,r,n,i,o,0);return}s=s.next}a=a.next}while(a!==e)}function Hg(e,t,r,n){var i=[],o,a,s,l,u;for(o=0,a=t.length;o<a;o++)s=t[o]*n,l=o<a-1?t[o+1]*n:e.length,u=fp(e,s,l,n,!1),u===u.next&&(u.steiner=!0),i.push(rx(u));for(i.sort(Xg),o=0;o<i.length;o++)r=Kg(i[o],r);return r}function Xg(e,t){return e.x-t.x}function Kg(e,t){var r=Yg(e,t);if(!r)return t;var n=mp(r,e);return Qt(n,n.next),Qt(r,r.next)}function Yg(e,t){var r=t,n=e.x,i=e.y,o=-1/0,a;do{if(i<=r.y&&i>=r.next.y&&r.next.y!==r.y){var s=r.x+(i-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=n&&s>o&&(o=s,a=r.x<r.next.x?r:r.next,s===n))return a}r=r.next}while(r!==t);if(!a)return null;var l=a,u=a.x,c=a.y,p=1/0,f;r=a;do n>=r.x&&r.x>=u&&n!==r.x&&Ar(i<c?n:o,i,u,c,i<c?o:n,i,r.x,r.y)&&(f=Math.abs(i-r.y)/(n-r.x),Wn(r,e)&&(f<p||f===p&&(r.x>a.x||r.x===a.x&&Qg(a,r)))&&(a=r,p=f)),r=r.next;while(r!==l);return a}function Qg(e,t){return oe(e.prev,e,t.prev)<0&&oe(t.next,e,e.next)<0}function ex(e,t,r,n){var i=e;do i.z===0&&(i.z=Vs(i.x,i.y,t,r,n)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,tx(i)}function tx(e){var t,r,n,i,o,a,s,l,u=1;do{for(r=e,e=null,o=null,a=0;r;){for(a++,n=r,s=0,t=0;t<u&&(s++,n=n.nextZ,!!n);t++);for(l=u;s>0||l>0&&n;)s!==0&&(l===0||!n||r.z<=n.z)?(i=r,r=r.nextZ,s--):(i=n,n=n.nextZ,l--),o?o.nextZ=i:e=i,i.prevZ=o,o=i;r=n}o.nextZ=null,u*=2}while(a>1);return e}function Vs(e,t,r,n,i){return e=(e-r)*i|0,t=(t-n)*i|0,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e|t<<1}function rx(e){var t=e,r=e;do(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next;while(t!==e);return r}function Ar(e,t,r,n,i,o,a,s){return(i-a)*(t-s)>=(e-a)*(o-s)&&(e-a)*(n-s)>=(r-a)*(t-s)&&(r-a)*(o-s)>=(i-a)*(n-s)}function nx(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!ix(e,t)&&(Wn(e,t)&&Wn(t,e)&&ox(e,t)&&(oe(e.prev,e,t.prev)||oe(e,t.prev,t))||qo(e,t)&&oe(e.prev,e,e.next)>0&&oe(t.prev,t,t.next)>0)}function oe(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function qo(e,t){return e.x===t.x&&e.y===t.y}function yp(e,t,r,n){var i=$o(oe(e,t,r)),o=$o(oe(e,t,n)),a=$o(oe(r,n,e)),s=$o(oe(r,n,t));return!!(i!==o&&a!==s||i===0&&Uo(e,r,t)||o===0&&Uo(e,n,t)||a===0&&Uo(r,e,n)||s===0&&Uo(r,t,n))}function Uo(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function $o(e){return e>0?1:e<0?-1:0}function ix(e,t){var r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&yp(r,r.next,e,t))return!0;r=r.next}while(r!==e);return!1}function Wn(e,t){return oe(e.prev,e,e.next)<0?oe(e,t,e.next)>=0&&oe(e,e.prev,t)>=0:oe(e,t,e.prev)<0||oe(e,e.next,t)<0}function ox(e,t){var r=e,n=!1,i=(e.x+t.x)/2,o=(e.y+t.y)/2;do r.y>o!=r.next.y>o&&r.next.y!==r.y&&i<(r.next.x-r.x)*(o-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next;while(r!==e);return n}function mp(e,t){var r=new Bs(e.i,e.x,e.y),n=new Bs(t.i,t.x,t.y),i=e.next,o=t.prev;return e.next=t,t.prev=e,r.next=i,i.prev=r,n.next=r,r.prev=n,o.next=n,n.prev=o,n}function pp(e,t,r,n){var i=new Bs(e,t,r);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function Hn(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function Bs(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}Go.deviation=function(e,t,r,n){var i=t&&t.length,o=i?t[0]*r:e.length,a=Math.abs(zs(e,0,o,r));if(i)for(var s=0,l=t.length;s<l;s++){var u=t[s]*r,c=s<l-1?t[s+1]*r:e.length;a-=Math.abs(zs(e,u,c,r))}var p=0;for(s=0;s<n.length;s+=3){var f=n[s]*r,y=n[s+1]*r,m=n[s+2]*r;p+=Math.abs((e[f]-e[m])*(e[y+1]-e[f+1])-(e[f]-e[y])*(e[m+1]-e[f+1]))}return a===0&&p===0?0:Math.abs((p-a)/a)};function zs(e,t,r,n){for(var i=0,o=t,a=r-n;o<r;o+=n)i+=(e[a]-e[o])*(e[o+1]+e[a+1]),a=o;return i}Go.flatten=function(e){for(var t=e[0][0].length,r={vertices:[],holes:[],dimensions:t},n=0,i=0;i<e.length;i++){for(var o=0;o<e[i].length;o++)for(var a=0;a<t;a++)r.vertices.push(e[i][o][a]);i>0&&(n+=e[i-1].length,r.holes.push(n))}return r}});var Us=Ae((bS,Sp)=>{"use strict";var fx=he();Sp.exports=Cr;function Cr(e,t,r,n,i){this.properties={},this.extent=r,this.type=0,this._pbf=e,this._geometry=-1,this._keys=n,this._values=i,e.readFields(yx,this,t)}function yx(e,t,r){e==1?t.id=r.readVarint():e==2?mx(r,t):e==3?t.type=r.readVarint():e==4&&(t._geometry=r.pos)}function mx(e,t){for(var r=e.readVarint()+e.pos;e.pos<r;){var n=t._keys[e.readVarint()],i=t._values[e.readVarint()];t.properties[n]=i}}Cr.types=["Unknown","Point","LineString","Polygon"];Cr.prototype.loadGeometry=function(){var e=this._pbf;e.pos=this._geometry;for(var t=e.readVarint()+e.pos,r=1,n=0,i=0,o=0,a=[],s;e.pos<t;){if(n<=0){var l=e.readVarint();r=l&7,n=l>>3}if(n--,r===1||r===2)i+=e.readSVarint(),o+=e.readSVarint(),r===1&&(s&&a.push(s),s=[]),s.push(new fx(i,o));else if(r===7)s&&s.push(s[0].clone());else throw new Error("unknown command "+r)}return s&&a.push(s),a};Cr.prototype.bbox=function(){var e=this._pbf;e.pos=this._geometry;for(var t=e.readVarint()+e.pos,r=1,n=0,i=0,o=0,a=1/0,s=-1/0,l=1/0,u=-1/0;e.pos<t;){if(n<=0){var c=e.readVarint();r=c&7,n=c>>3}if(n--,r===1||r===2)i+=e.readSVarint(),o+=e.readSVarint(),i<a&&(a=i),i>s&&(s=i),o<l&&(l=o),o>u&&(u=o);else if(r!==7)throw new Error("unknown command "+r)}return[a,l,s,u]};Cr.prototype.toGeoJSON=function(e,t,r){var n=this.extent*Math.pow(2,r),i=this.extent*e,o=this.extent*t,a=this.loadGeometry(),s=Cr.types[this.type],l,u;function c(y){for(var m=0;m<y.length;m++){var h=y[m],d=180-(h.y+o)*360/n;y[m]=[(h.x+i)*360/n-180,360/Math.PI*Math.atan(Math.exp(d*Math.PI/180))-90]}}switch(this.type){case 1:var p=[];for(l=0;l<a.length;l++)p[l]=a[l][0];a=p,c(a);break;case 2:for(l=0;l<a.length;l++)c(a[l]);break;case 3:for(a=hx(a),l=0;l<a.length;l++)for(u=0;u<a[l].length;u++)c(a[l][u]);break}a.length===1?a=a[0]:s="Multi"+s;var f={type:"Feature",geometry:{type:s,coordinates:a},properties:this.properties};return"id"in this&&(f.id=this.id),f};function hx(e){var t=e.length;if(t<=1)return[e];for(var r=[],n,i,o=0;o<t;o++){var a=dx(e[o]);a!==0&&(i===void 0&&(i=a<0),i===a<0?(n&&r.push(n),n=[e[o]]):n.push(e[o]))}return n&&r.push(n),r}function dx(e){for(var t=0,r=0,n=e.length,i=n-1,o,a;r<n;i=r++)o=e[r],a=e[i],t+=(a.x-o.x)*(o.y+a.y);return t}});var $s=Ae((vS,Ap)=>{"use strict";var gx=Us();Ap.exports=wp;function wp(e,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(xx,this,t),this.length=this._features.length}function xx(e,t,r){e===15?t.version=r.readVarint():e===1?t.name=r.readString():e===5?t.extent=r.readVarint():e===2?t._features.push(r.pos):e===3?t._keys.push(r.readString()):e===4&&t._values.push(bx(r))}function bx(e){for(var t=null,r=e.readVarint()+e.pos;e.pos<r;){var n=e.readVarint()>>3;t=n===1?e.readString():n===2?e.readFloat():n===3?e.readDouble():n===4?e.readVarint64():n===5?e.readVarint():n===6?e.readSVarint():n===7?e.readBoolean():null}return t}wp.prototype.feature=function(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];var t=this._pbf.readVarint()+this._pbf.pos;return new gx(this._pbf,t,this.extent,this._keys,this._values)}});var Ip=Ae((PS,_p)=>{"use strict";var vx=$s();_p.exports=Px;function Px(e,t){this.layers=e.readFields(Sx,{},t)}function Sx(e,t,r){if(e===3){var n=new vx(r,r.readVarint()+r.pos);n.length&&(t[n.name]=n)}}});var Tt=Ae((SS,Jo)=>{Jo.exports.VectorTile=Ip();Jo.exports.VectorTileFeature=Us();Jo.exports.VectorTileLayer=$s()});var Zp=Ae(Zs=>{Zs.read=function(e,t,r,n,i){var o,a,s=i*8-n-1,l=(1<<s)-1,u=l>>1,c=-7,p=r?i-1:0,f=r?-1:1,y=e[t+p];for(p+=f,o=y&(1<<-c)-1,y>>=-c,c+=s;c>0;o=o*256+e[t+p],p+=f,c-=8);for(a=o&(1<<-c)-1,o>>=-c,c+=n;c>0;a=a*256+e[t+p],p+=f,c-=8);if(o===0)o=1-u;else{if(o===l)return a?NaN:(y?-1:1)*(1/0);a=a+Math.pow(2,n),o=o-u}return(y?-1:1)*a*Math.pow(2,o-n)};Zs.write=function(e,t,r,n,i,o){var a,s,l,u=o*8-i-1,c=(1<<u)-1,p=c>>1,f=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,y=n?0:o-1,m=n?1:-1,h=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=c):(a=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-a))<1&&(a--,l*=2),a+p>=1?t+=f/l:t+=f*Math.pow(2,1-p),t*l>=2&&(a++,l/=2),a+p>=c?(s=0,a=c):a+p>=1?(s=(t*l-1)*Math.pow(2,i),a=a+p):(s=t*Math.pow(2,p-1)*Math.pow(2,i),a=0));i>=8;e[r+y]=s&255,y+=m,s/=256,i-=8);for(a=a<<i|s,u+=i;u>0;e[r+y]=a&255,y+=m,a/=256,u-=8);e[r+y-m]|=h*128}});var Qn=Ae((i2,Yp)=>{"use strict";Yp.exports=J;var Ko=Zp();function J(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0),this.pos=0,this.type=0,this.length=this.buf.length}J.Varint=0;J.Fixed64=1;J.Bytes=2;J.Fixed32=5;var Ws=65536*65536,Wp=1/Ws,Ux=12,Kp=typeof TextDecoder>"u"?null:new TextDecoder("utf8");J.prototype={destroy:function(){this.buf=null},readFields:function(e,t,r){for(r=r||this.length;this.pos<r;){var n=this.readVarint(),i=n>>3,o=this.pos;this.type=n&7,e(i,t,this),this.pos===o&&this.skip(n)}return t},readMessage:function(e,t){return this.readFields(e,t,this.readVarint()+this.pos)},readFixed32:function(){var e=Yo(this.buf,this.pos);return this.pos+=4,e},readSFixed32:function(){var e=Xp(this.buf,this.pos);return this.pos+=4,e},readFixed64:function(){var e=Yo(this.buf,this.pos)+Yo(this.buf,this.pos+4)*Ws;return this.pos+=8,e},readSFixed64:function(){var e=Yo(this.buf,this.pos)+Xp(this.buf,this.pos+4)*Ws;return this.pos+=8,e},readFloat:function(){var e=Ko.read(this.buf,this.pos,!0,23,4);return this.pos+=4,e},readDouble:function(){var e=Ko.read(this.buf,this.pos,!0,52,8);return this.pos+=8,e},readVarint:function(e){var t=this.buf,r,n;return n=t[this.pos++],r=n&127,n<128||(n=t[this.pos++],r|=(n&127)<<7,n<128)||(n=t[this.pos++],r|=(n&127)<<14,n<128)||(n=t[this.pos++],r|=(n&127)<<21,n<128)?r:(n=t[this.pos],r|=(n&15)<<28,$x(r,e,this))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var e=this.readVarint();return e%2===1?(e+1)/-2:e/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var e=this.readVarint()+this.pos,t=this.pos;return this.pos=e,e-t>=Ux&&Kp?rb(this.buf,t,e):tb(this.buf,t,e)},readBytes:function(){var e=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,e);return this.pos=e,t},readPackedVarint:function(e,t){if(this.type!==J.Bytes)return e.push(this.readVarint(t));var r=ct(this);for(e=e||[];this.pos<r;)e.push(this.readVarint(t));return e},readPackedSVarint:function(e){if(this.type!==J.Bytes)return e.push(this.readSVarint());var t=ct(this);for(e=e||[];this.pos<t;)e.push(this.readSVarint());return e},readPackedBoolean:function(e){if(this.type!==J.Bytes)return e.push(this.readBoolean());var t=ct(this);for(e=e||[];this.pos<t;)e.push(this.readBoolean());return e},readPackedFloat:function(e){if(this.type!==J.Bytes)return e.push(this.readFloat());var t=ct(this);for(e=e||[];this.pos<t;)e.push(this.readFloat());return e},readPackedDouble:function(e){if(this.type!==J.Bytes)return e.push(this.readDouble());var t=ct(this);for(e=e||[];this.pos<t;)e.push(this.readDouble());return e},readPackedFixed32:function(e){if(this.type!==J.Bytes)return e.push(this.readFixed32());var t=ct(this);for(e=e||[];this.pos<t;)e.push(this.readFixed32());return e},readPackedSFixed32:function(e){if(this.type!==J.Bytes)return e.push(this.readSFixed32());var t=ct(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed32());return e},readPackedFixed64:function(e){if(this.type!==J.Bytes)return e.push(this.readFixed64());var t=ct(this);for(e=e||[];this.pos<t;)e.push(this.readFixed64());return e},readPackedSFixed64:function(e){if(this.type!==J.Bytes)return e.push(this.readSFixed64());var t=ct(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed64());return e},skip:function(e){var t=e&7;if(t===J.Varint)for(;this.buf[this.pos++]>127;);else if(t===J.Bytes)this.pos=this.readVarint()+this.pos;else if(t===J.Fixed32)this.pos+=4;else if(t===J.Fixed64)this.pos+=8;else throw new Error("Unimplemented type: "+t)},writeTag:function(e,t){this.writeVarint(e<<3|t)},realloc:function(e){for(var t=this.length||16;t<this.pos+e;)t*=2;if(t!==this.length){var r=new Uint8Array(t);r.set(this.buf),this.buf=r,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(e){this.realloc(4),Er(this.buf,e,this.pos),this.pos+=4},writeSFixed32:function(e){this.realloc(4),Er(this.buf,e,this.pos),this.pos+=4},writeFixed64:function(e){this.realloc(8),Er(this.buf,e&-1,this.pos),Er(this.buf,Math.floor(e*Wp),this.pos+4),this.pos+=8},writeSFixed64:function(e){this.realloc(8),Er(this.buf,e&-1,this.pos),Er(this.buf,Math.floor(e*Wp),this.pos+4),this.pos+=8},writeVarint:function(e){if(e=+e||0,e>268435455||e<0){Gx(e,this);return}this.realloc(4),this.buf[this.pos++]=e&127|(e>127?128:0),!(e<=127)&&(this.buf[this.pos++]=(e>>>=7)&127|(e>127?128:0),!(e<=127)&&(this.buf[this.pos++]=(e>>>=7)&127|(e>127?128:0),!(e<=127)&&(this.buf[this.pos++]=e>>>7&127)))},writeSVarint:function(e){this.writeVarint(e<0?-e*2-1:e*2)},writeBoolean:function(e){this.writeVarint(!!e)},writeString:function(e){e=String(e),this.realloc(e.length*4),this.pos++;var t=this.pos;this.pos=nb(this.buf,e,this.pos);var r=this.pos-t;r>=128&&Hp(t,r,this),this.pos=t-1,this.writeVarint(r),this.pos+=r},writeFloat:function(e){this.realloc(4),Ko.write(this.buf,e,this.pos,!0,23,4),this.pos+=4},writeDouble:function(e){this.realloc(8),Ko.write(this.buf,e,this.pos,!0,52,8),this.pos+=8},writeBytes:function(e){var t=e.length;this.writeVarint(t),this.realloc(t);for(var r=0;r<t;r++)this.buf[this.pos++]=e[r]},writeRawMessage:function(e,t){this.pos++;var r=this.pos;e(t,this);var n=this.pos-r;n>=128&&Hp(r,n,this),this.pos=r-1,this.writeVarint(n),this.pos+=n},writeMessage:function(e,t,r){this.writeTag(e,J.Bytes),this.writeRawMessage(t,r)},writePackedVarint:function(e,t){t.length&&this.writeMessage(e,Jx,t)},writePackedSVarint:function(e,t){t.length&&this.writeMessage(e,Zx,t)},writePackedBoolean:function(e,t){t.length&&this.writeMessage(e,Xx,t)},writePackedFloat:function(e,t){t.length&&this.writeMessage(e,Wx,t)},writePackedDouble:function(e,t){t.length&&this.writeMessage(e,Hx,t)},writePackedFixed32:function(e,t){t.length&&this.writeMessage(e,Kx,t)},writePackedSFixed32:function(e,t){t.length&&this.writeMessage(e,Yx,t)},writePackedFixed64:function(e,t){t.length&&this.writeMessage(e,Qx,t)},writePackedSFixed64:function(e,t){t.length&&this.writeMessage(e,eb,t)},writeBytesField:function(e,t){this.writeTag(e,J.Bytes),this.writeBytes(t)},writeFixed32Field:function(e,t){this.writeTag(e,J.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(e,t){this.writeTag(e,J.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(e,t){this.writeTag(e,J.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(e,t){this.writeTag(e,J.Fixed64),this.writeSFixed64(t)},writeVarintField:function(e,t){this.writeTag(e,J.Varint),this.writeVarint(t)},writeSVarintField:function(e,t){this.writeTag(e,J.Varint),this.writeSVarint(t)},writeStringField:function(e,t){this.writeTag(e,J.Bytes),this.writeString(t)},writeFloatField:function(e,t){this.writeTag(e,J.Fixed32),this.writeFloat(t)},writeDoubleField:function(e,t){this.writeTag(e,J.Fixed64),this.writeDouble(t)},writeBooleanField:function(e,t){this.writeVarintField(e,!!t)}};function $x(e,t,r){var n=r.buf,i,o;if(o=n[r.pos++],i=(o&112)>>4,o<128||(o=n[r.pos++],i|=(o&127)<<3,o<128)||(o=n[r.pos++],i|=(o&127)<<10,o<128)||(o=n[r.pos++],i|=(o&127)<<17,o<128)||(o=n[r.pos++],i|=(o&127)<<24,o<128)||(o=n[r.pos++],i|=(o&1)<<31,o<128))return Mr(e,i,t);throw new Error("Expected varint not more than 10 bytes")}function ct(e){return e.type===J.Bytes?e.readVarint()+e.pos:e.pos+1}function Mr(e,t,r){return r?t*4294967296+(e>>>0):(t>>>0)*4294967296+(e>>>0)}function Gx(e,t){var r,n;if(e>=0?(r=e%4294967296|0,n=e/4294967296|0):(r=~(-e%4294967296),n=~(-e/4294967296),r^4294967295?r=r+1|0:(r=0,n=n+1|0)),e>=18446744073709552e3||e<-18446744073709552e3)throw new Error("Given varint doesn\'t fit into 10 bytes");t.realloc(10),qx(r,n,t),jx(n,t)}function qx(e,t,r){r.buf[r.pos++]=e&127|128,e>>>=7,r.buf[r.pos++]=e&127|128,e>>>=7,r.buf[r.pos++]=e&127|128,e>>>=7,r.buf[r.pos++]=e&127|128,e>>>=7,r.buf[r.pos]=e&127}function jx(e,t){var r=(e&7)<<4;t.buf[t.pos++]|=r|((e>>>=3)?128:0),e&&(t.buf[t.pos++]=e&127|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=e&127|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=e&127|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=e&127|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=e&127)))))}function Hp(e,t,r){var n=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(Math.LN2*7));r.realloc(n);for(var i=r.pos-1;i>=e;i--)r.buf[i+n]=r.buf[i]}function Jx(e,t){for(var r=0;r<e.length;r++)t.writeVarint(e[r])}function Zx(e,t){for(var r=0;r<e.length;r++)t.writeSVarint(e[r])}function Wx(e,t){for(var r=0;r<e.length;r++)t.writeFloat(e[r])}function Hx(e,t){for(var r=0;r<e.length;r++)t.writeDouble(e[r])}function Xx(e,t){for(var r=0;r<e.length;r++)t.writeBoolean(e[r])}function Kx(e,t){for(var r=0;r<e.length;r++)t.writeFixed32(e[r])}function Yx(e,t){for(var r=0;r<e.length;r++)t.writeSFixed32(e[r])}function Qx(e,t){for(var r=0;r<e.length;r++)t.writeFixed64(e[r])}function eb(e,t){for(var r=0;r<e.length;r++)t.writeSFixed64(e[r])}function Yo(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+e[t+3]*16777216}function Er(e,t,r){e[r]=t,e[r+1]=t>>>8,e[r+2]=t>>>16,e[r+3]=t>>>24}function Xp(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+(e[t+3]<<24)}function tb(e,t,r){for(var n="",i=t;i<r;){var o=e[i],a=null,s=o>239?4:o>223?3:o>191?2:1;if(i+s>r)break;var l,u,c;s===1?o<128&&(a=o):s===2?(l=e[i+1],(l&192)===128&&(a=(o&31)<<6|l&63,a<=127&&(a=null))):s===3?(l=e[i+1],u=e[i+2],(l&192)===128&&(u&192)===128&&(a=(o&15)<<12|(l&63)<<6|u&63,(a<=2047||a>=55296&&a<=57343)&&(a=null))):s===4&&(l=e[i+1],u=e[i+2],c=e[i+3],(l&192)===128&&(u&192)===128&&(c&192)===128&&(a=(o&15)<<18|(l&63)<<12|(u&63)<<6|c&63,(a<=65535||a>=1114112)&&(a=null))),a===null?(a=65533,s=1):a>65535&&(a-=65536,n+=String.fromCharCode(a>>>10&1023|55296),a=56320|a&1023),n+=String.fromCharCode(a),i+=s}return n}function rb(e,t,r){return Kp.decode(e.subarray(t,r))}function nb(e,t,r){for(var n=0,i,o;n<t.length;n++){if(i=t.charCodeAt(n),i>55295&&i<57344)if(o)if(i<56320){e[r++]=239,e[r++]=191,e[r++]=189,o=i;continue}else i=o-55296<<10|i-56320|65536,o=null;else{i>56319||n+1===t.length?(e[r++]=239,e[r++]=191,e[r++]=189):o=i;continue}else o&&(e[r++]=239,e[r++]=191,e[r++]=189,o=null);i<128?e[r++]=i:(i<2048?e[r++]=i>>6|192:(i<65536?e[r++]=i>>12|224:(e[r++]=i>>18|240,e[r++]=i>>12&63|128),e[r++]=i>>6&63|128),e[r++]=i&63|128)}return r}});var Wf=Ae((tT,Zf)=>{Zf.exports=Pa;function Pa(e,t){var r=e&&e.type,n;if(r==="FeatureCollection")for(n=0;n<e.features.length;n++)Pa(e.features[n],t);else if(r==="GeometryCollection")for(n=0;n<e.geometries.length;n++)Pa(e.geometries[n],t);else if(r==="Feature")Pa(e.geometry,t);else if(r==="Polygon")jf(e.coordinates,t);else if(r==="MultiPolygon")for(n=0;n<e.coordinates.length;n++)jf(e.coordinates[n],t);return e}function jf(e,t){if(e.length!==0){Jf(e[0],t);for(var r=1;r<e.length;r++)Jf(e[r],!t)}}function Jf(e,t){for(var r=0,n=0,i=0,o=e.length,a=o-1;i<o;a=i++){var s=(e[i][0]-e[a][0])*(e[a][1]+e[i][1]),l=r+s;n+=Math.abs(r)>=Math.abs(s)?r-l+s:s-l+r,r=l}r+n>=0!=!!t&&e.reverse()}});var Yf=Ae((iT,Kf)=>{"use strict";var Ob=he(),Nb=Tt().VectorTileFeature;Kf.exports=Xf;function Xf(e,t){this.options=t||{},this.features=e,this.length=e.length}Xf.prototype.feature=function(e){return new wa(this.features[e],this.options.extent)};function wa(e,t){this.id=typeof e.id=="number"?e.id:void 0,this.type=e.type,this.rawGeometry=e.type===1?[e.geometry]:e.geometry,this.properties=e.tags,this.extent=t||4096}wa.prototype.loadGeometry=function(){var e=this.rawGeometry;this.geometry=[];for(var t=0;t<e.length;t++){for(var r=e[t],n=[],i=0;i<r.length;i++)n.push(new Ob(r[i][0],r[i][1]));this.geometry.push(n)}return this.geometry};wa.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var e=this.geometry,t=1/0,r=-1/0,n=1/0,i=-1/0,o=0;o<e.length;o++)for(var a=e[o],s=0;s<a.length;s++){var l=a[s];t=Math.min(t,l.x),r=Math.max(r,l.x),n=Math.min(n,l.y),i=Math.max(i,l.y)}return[t,n,r,i]};wa.prototype.toGeoJSON=Nb.prototype.toGeoJSON});var ty=Ae((oT,di)=>{var Ub=Qn(),ey=Yf();di.exports=yl;di.exports.fromVectorTileJs=yl;di.exports.fromGeojsonVt=$b;di.exports.GeoJSONWrapper=ey;function yl(e){var t=new Ub;return Gb(e,t),t.finish()}function $b(e,t){t=t||{};var r={};for(var n in e)r[n]=new ey(e[n].features,t),r[n].name=n,r[n].version=t.version,r[n].extent=t.extent;return yl({layers:r})}function Gb(e,t){for(var r in e.layers)t.writeMessage(3,qb,e.layers[r])}function qb(e,t){t.writeVarintField(15,e.version||1),t.writeStringField(1,e.name||""),t.writeVarintField(5,e.extent||4096);var r,n={keys:[],values:[],keycache:{},valuecache:{}};for(r=0;r<e.length;r++)n.feature=e.feature(r),t.writeMessage(2,jb,n);var i=n.keys;for(r=0;r<i.length;r++)t.writeStringField(3,i[r]);var o=n.values;for(r=0;r<o.length;r++)t.writeMessage(4,Wb,o[r])}function jb(e,t){var r=e.feature;r.id!==void 0&&t.writeVarintField(1,r.id),t.writeMessage(2,Jb,e),t.writeVarintField(3,r.type),t.writeMessage(4,Zb,r)}function Jb(e,t){var r=e.feature,n=e.keys,i=e.values,o=e.keycache,a=e.valuecache;for(var s in r.properties){var l=r.properties[s],u=o[s];if(l!==null){typeof u>"u"&&(n.push(s),u=n.length-1,o[s]=u),t.writeVarint(u);var c=typeof l;c!=="string"&&c!=="boolean"&&c!=="number"&&(l=JSON.stringify(l));var p=c+":"+l,f=a[p];typeof f>"u"&&(i.push(l),f=i.length-1,a[p]=f),t.writeVarint(f)}}}function fl(e,t){return(t<<3)+(e&7)}function Qf(e){return e<<1^e>>31}function Zb(e,t){for(var r=e.loadGeometry(),n=e.type,i=0,o=0,a=r.length,s=0;s<a;s++){var l=r[s],u=1;n===1&&(u=l.length),t.writeVarint(fl(1,u));for(var c=n===3?l.length-1:l.length,p=0;p<c;p++){p===1&&n!==1&&t.writeVarint(fl(2,c-1));var f=l[p].x-i,y=l[p].y-o;t.writeVarint(Qf(f)),t.writeVarint(Qf(y)),i+=f,o+=y}n===3&&t.writeVarint(fl(7,1))}}function Wb(e,t){var r=typeof e;r==="string"?t.writeStringField(1,e):r==="boolean"?t.writeBooleanField(7,e):r==="number"&&(e%1!==0?t.writeDoubleField(3,e):e<0?t.writeSVarintField(6,e):t.writeVarintField(5,e))}});var _y=Z(he(),1),Ul=Z(zl(),1);var za;function Rl(){return za==null&&(za=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),za}var Ii;function Ol(){if(Ii==null&&(Ii=!1,Rl())){let r=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(r){for(let i=0;i<5*5;i++){let o=i*4;r.fillStyle=`rgb(${o},${o+1},${o+2})`,r.fillRect(i%5,Math.floor(i/5),1,1)}let n=r.getImageData(0,0,5,5).data;for(let i=0;i<5*5*4;i++)if(i%4!==3&&n[i]!==i){Ii=!0;break}}}return Ii||!1}function $l(e){if(e<=0)return 0;if(e>=1)return 1;let t=e*e,r=t*e;return 4*(e<.5?r:3*(e-t)+r-.75)}function Iy(e,t,r,n){let i=new Ul.default(e,t,r,n);return function(o){return i.solve(o)}}var m0=Iy(.25,.1,.25,1);function it(e,t,r){return Math.min(r,Math.max(t,e))}function Gl(e,t,r){let n=r-t,i=((e-t)%n+n)%n+t;return i===t?r:i}function Pe(e,...t){for(let r of t)for(let n in r)e[n]=r[n];return e}function ql(e){return Math.log(e)/Math.LN2%1===0}function Gr(e,t,r){let n={};for(let i in e)n[i]=t.call(r||this,e[i],i,e);return n}function jl(e,t,r){let n={};for(let i in e)t.call(r||this,e[i],i,e)&&(n[i]=e[i]);return n}function nt(e){return Array.isArray(e)?e.map(nt):typeof e=="object"&&e?Gr(e,nt):e}function Jl(e,t){for(let r=0;r<e.length;r++)if(t.indexOf(e[r])>=0)return!0;return!1}var Nl={};function fe(e){Nl[e]||(typeof console<"u"&&console.warn(e),Nl[e]=!0)}function ot(e,t,r){return(r.y-e.y)*(t.x-e.x)>(t.y-e.y)*(r.x-e.x)}function Zl(e){let t=0;for(let r=0,n=e.length,i=n-1,o,a;r<n;i=r++)o=e[r],a=e[i],t+=(a.x-o.x)*(o.y+a.y);return t}function at(e){return typeof WorkerGlobalScope<"u"&&typeof e<"u"&&e instanceof WorkerGlobalScope}function qr(e){return typeof ImageBitmap<"u"&&e instanceof ImageBitmap}function Ty(e,t,r,n,i){let o=Math.max(-t,0)*4,l=(Math.max(0,r)-r)*n*4+o,u=n*4,c=Math.max(0,t),p=Math.max(0,r),f=Math.min(e.width,t+n),y=Math.min(e.height,r+i);return{rect:{x:c,y:p,width:f-c,height:y-p},layout:[{offset:l,stride:u}]}}async function Cy(e,t,r,n,i){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");let o=new VideoFrame(e,{timestamp:0});try{let a=o==null?void 0:o.format;if(!a||!(a.startsWith("BGR")||a.startsWith("RGB")))throw new Error(`Unrecognized format ${a}`);let s=a.startsWith("BGR"),l=new Uint8ClampedArray(n*i*4);if(await o.copyTo(l,Ty(e,t,r,n,i)),s)for(let u=0;u<l.length;u+=4){let c=l[u];l[u]=l[u+2],l[u+2]=c}return l}finally{o.close()}}var Ur,$r;function ky(e,t,r,n,i){let o=e.width,a=e.height;(!Ur||!$r)&&(Ur=new OffscreenCanvas(o,a),$r=Ur.getContext("2d",{willReadFrequently:!0})),Ur.width=o,Ur.height=a,$r.drawImage(e,0,0,o,a);let s=$r.getImageData(t,r,n,i);return $r.clearRect(0,0,o,a),s.data}async function Wl(e,t,r,n,i){if(Ol())try{return await Cy(e,t,r,n,i)}catch{}return ky(e,t,r,n,i)}function Hl(e,t,r,n){return e.addEventListener(t,r,n),{unsubscribe:()=>{e.removeEventListener(t,r,n)}}}var Dt=class e{constructor(t,r,n){let i=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;let a=new Int32Array(this.arrayBuffer);t=a[0],r=a[1],n=a[2],this.d=r+2*n;for(let u=0;u<this.d*this.d;u++){let c=a[3+u],p=a[3+u+1];i.push(c===p?null:a.subarray(c,p))}let s=a[3+i.length],l=a[3+i.length+1];this.keys=a.subarray(s,l),this.bboxes=a.subarray(l),this.insert=this._insertReadonly}else{this.d=r+2*n;for(let a=0;a<this.d*this.d;a++)i.push([]);this.keys=[],this.bboxes=[]}this.n=r,this.extent=t,this.padding=n,this.scale=r/t,this.uid=0;let o=n/r*t;this.min=-o,this.max=t+o}insert(t,r,n,i,o){this._forEachCell(r,n,i,o,this._insertCell,this.uid++,void 0,void 0),this.keys.push(t),this.bboxes.push(r),this.bboxes.push(n),this.bboxes.push(i),this.bboxes.push(o)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(t,r,n,i,o,a){this.cells[o].push(a)}query(t,r,n,i,o){let a=this.min,s=this.max;if(t<=a&&r<=a&&s<=n&&s<=i&&!o)return Array.prototype.slice.call(this.keys);{let l=[],u={};return this._forEachCell(t,r,n,i,this._queryCell,l,u,o),l}}_queryCell(t,r,n,i,o,a,s,l){let u=this.cells[o];if(u!==null){let c=this.keys,p=this.bboxes;for(let f=0;f<u.length;f++){let y=u[f];if(s[y]===void 0){let m=y*4;(l?l(p[m+0],p[m+1],p[m+2],p[m+3]):t<=p[m+2]&&r<=p[m+3]&&n>=p[m+0]&&i>=p[m+1])?(s[y]=!0,a.push(c[y])):s[y]=!1}}}}_forEachCell(t,r,n,i,o,a,s,l){let u=this._convertToCellCoord(t),c=this._convertToCellCoord(r),p=this._convertToCellCoord(n),f=this._convertToCellCoord(i);for(let y=u;y<=p;y++)for(let m=c;m<=f;m++){let h=this.d*m+y;if(!(l&&!l(this._convertFromCellCoord(y),this._convertFromCellCoord(m),this._convertFromCellCoord(y+1),this._convertFromCellCoord(m+1)))&&o.call(this,t,r,n,i,h,a,s,l))return}}_convertFromCellCoord(t){return(t-this.padding)/this.scale}_convertToCellCoord(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;let t=this.cells,r=3+this.cells.length+1+1,n=0;for(let a=0;a<this.cells.length;a++)n+=this.cells[a].length;let i=new Int32Array(r+n+this.keys.length+this.bboxes.length);i[0]=this.extent,i[1]=this.n,i[2]=this.padding;let o=r;for(let a=0;a<t.length;a++){let s=t[a];i[3+a]=o,i.set(s,o),o+=s.length}return i[3+t.length]=o,i.set(this.keys,o),o+=this.keys.length,i[3+t.length+1]=o,i.set(this.bboxes,o),o+=this.bboxes.length,i.buffer}static serialize(t,r){let n=t.toArrayBuffer();return r&&r.push(n),{buffer:n}}static deserialize(t){return new e(t.buffer)}};var My=8,Ey={version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},Fy={"*":{type:"source"}},Ly=["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],Dy={type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},Vy={type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},By={type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},zy={type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},Ry={type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},Oy={type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},Ny={id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},Uy=["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],$y={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Gy={"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},qy={"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},jy={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Jy={"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Zy={"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Wy={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Hy={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Xy={type:"array",value:"*"},Ky={type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},Yy={type:"enum",values:{Point:{},LineString:{},Polygon:{}}},Qy={type:"array",minimum:0,maximum:24,value:["number","color"],length:2},em={type:"array",value:"*",minimum:1},tm={anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},rm={"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},nm={source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},im={type:{type:"enum",default:"mercator",values:{mercator:{},globe:{}}}},om=["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],am={"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},sm={"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},lm={"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},um={"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},cm={"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},pm={"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},fm={"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},ym={"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},mm={duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},hm={"*":{type:"string"}},S={$version:My,$root:Ey,sources:Fy,source:Ly,source_vector:Dy,source_raster:Vy,source_raster_dem:By,source_geojson:zy,source_video:Ry,source_image:Oy,layer:Ny,layout:Uy,layout_background:$y,layout_fill:Gy,layout_circle:qy,layout_heatmap:jy,"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:Jy,layout_symbol:Zy,layout_raster:Wy,layout_hillshade:Hy,filter:Xy,filter_operator:Ky,geometry_type:Yy,function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:Qy,expression:em,light:tm,sky:rm,terrain:nm,projection:im,paint:om,paint_fill:am,"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:sm,paint_circle:lm,paint_heatmap:um,paint_symbol:cm,paint_raster:pm,paint_hillshade:fm,paint_background:ym,transition:mm,"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:hm},dm=["type","source","source-layer","minzoom","maxzoom","filter","layout"];var M=class{constructor(t,r,n,i){this.message=(t?`${t}: `:"")+n,i&&(this.identifier=i),r!=null&&r.__line__&&(this.line=r.__line__)}};function cr(e,...t){for(let r of t)for(let n in r)e[n]=r[n];return e}var Be=class extends Error{constructor(t,r){super(r),this.message=r,this.key=t}},Ja=class e{constructor(t,r=[]){this.parent=t,this.bindings={};for(let[n,i]of r)this.bindings[n]=i}concat(t){return new e(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(`${t} not found in scope.`)}has(t){return this.bindings[t]?!0:this.parent?this.parent.has(t):!1}},yr={kind:"null"},L={kind:"number"},G={kind:"string"},U={kind:"boolean"},Re={kind:"color"},lr={kind:"object"},$={kind:"value"},gm={kind:"error"},ji={kind:"collator"},mr={kind:"formatted"},Ji={kind:"padding"},un={kind:"resolvedImage"},Zi={kind:"variableAnchorOffsetCollection"};function Ee(e,t){return{kind:"array",itemType:e,N:t}}function te(e){if(e.kind==="array"){let t=te(e.itemType);return typeof e.N=="number"?`array<${t}, ${e.N}>`:e.itemType.kind==="value"?"array":`array<${t}>`}else return e.kind}var xm=[yr,L,G,U,Re,mr,lr,Ee($),Ji,un,Zi];function Hr(e,t){if(t.kind==="error")return null;if(e.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!Hr(e.itemType,t.itemType))&&(typeof e.N!="number"||e.N===t.N))return null}else{if(e.kind===t.kind)return null;if(e.kind==="value"){for(let r of xm)if(!Hr(r,t))return null}}return`Expected ${te(e)} but found ${te(t)} instead.`}function us(e,t){return t.some(r=>r.kind===e.kind)}function Xr(e,t){return t.some(r=>r==="null"?e===null:r==="array"?Array.isArray(e):r==="object"?e&&!Array.isArray(e)&&typeof e=="object":r===typeof e)}function jr(e,t){return e.kind==="array"&&t.kind==="array"?e.itemType.kind===t.itemType.kind&&typeof e.N=="number":e.kind===t.kind}var du=.96422,gu=1,xu=.82521,bu=4/29,ur=6/29,vu=3*ur*ur,bm=ur*ur*ur,vm=Math.PI/180,Pm=180/Math.PI;function Pu(e){return e=e%360,e<0&&(e+=360),e}function Su([e,t,r,n]){e=Ra(e),t=Ra(t),r=Ra(r);let i,o,a=Oa((.2225045*e+.7168786*t+.0606169*r)/gu);e===t&&t===r?i=o=a:(i=Oa((.4360747*e+.3850649*t+.1430804*r)/du),o=Oa((.0139322*e+.0971045*t+.7141733*r)/xu));let s=116*a-16;return[s<0?0:s,500*(i-a),200*(a-o),n]}function Ra(e){return e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function Oa(e){return e>bm?Math.pow(e,1/3):e/vu+bu}function wu([e,t,r,n]){let i=(e+16)/116,o=isNaN(t)?i:i+t/500,a=isNaN(r)?i:i-r/200;return i=gu*Ua(i),o=du*Ua(o),a=xu*Ua(a),[Na(3.1338561*o-1.6168667*i-.4906146*a),Na(-.9787684*o+1.9161415*i+.033454*a),Na(.0719453*o-.2289914*i+1.4052427*a),n]}function Na(e){return e=e<=.00304?12.92*e:1.055*Math.pow(e,1/2.4)-.055,e<0?0:e>1?1:e}function Ua(e){return e>ur?e*e*e:vu*(e-bu)}function Sm(e){let[t,r,n,i]=Su(e),o=Math.sqrt(r*r+n*n);return[Math.round(o*1e4)?Pu(Math.atan2(n,r)*Pm):NaN,o,t,i]}function wm([e,t,r,n]){return e=isNaN(e)?0:e*vm,wu([r,Math.cos(e)*t,Math.sin(e)*t,n])}function Am([e,t,r,n]){e=Pu(e),t/=100,r/=100;function i(o){let a=(o+e/30)%12,s=t*Math.min(r,1-r);return r-s*Math.max(-1,Math.min(a-3,9-a,1))}return[i(0),i(8),i(4),n]}function _m(e){if(e=e.toLowerCase().trim(),e==="transparent")return[0,0,0,0];let t=Im[e];if(t){let[i,o,a]=t;return[i/255,o/255,a/255,1]}if(e.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(e)){let o=e.length<6?1:2,a=1;return[Ti(e.slice(a,a+=o)),Ti(e.slice(a,a+=o)),Ti(e.slice(a,a+=o)),Ti(e.slice(a,a+o)||"ff")]}if(e.startsWith("rgb")){let i=/^rgba?\\(\\s*([\\de.+-]+)(%)?(?:\\s+|\\s*(,)\\s*)([\\de.+-]+)(%)?(?:\\s+|\\s*(,)\\s*)([\\de.+-]+)(%)?(?:\\s*([,\\/])\\s*([\\de.+-]+)(%)?)?\\s*\\)$/,o=e.match(i);if(o){let[a,s,l,u,c,p,f,y,m,h,d,g]=o,b=[u||" ",f||" ",h].join("");if(b==="  "||b==="  /"||b===",,"||b===",,,"){let x=[l,p,m].join(""),v=x==="%%%"?100:x===""?255:0;if(v){let P=[ar(+s/v,0,1),ar(+c/v,0,1),ar(+y/v,0,1),d?Xl(+d,g):1];if(Kl(P))return P}}return}}let r=/^hsla?\\(\\s*([\\de.+-]+)(?:deg)?(?:\\s+|\\s*(,)\\s*)([\\de.+-]+)%(?:\\s+|\\s*(,)\\s*)([\\de.+-]+)%(?:\\s*([,\\/])\\s*([\\de.+-]+)(%)?)?\\s*\\)$/,n=e.match(r);if(n){let[i,o,a,s,l,u,c,p,f]=n,y=[a||" ",l||" ",c].join("");if(y==="  "||y==="  /"||y===",,"||y===",,,"){let m=[+o,ar(+s,0,100),ar(+u,0,100),p?Xl(+p,f):1];if(Kl(m))return Am(m)}}}function Ti(e){return parseInt(e.padEnd(2,e),16)/255}function Xl(e,t){return ar(t?e/100:e,0,1)}function ar(e,t,r){return Math.min(Math.max(t,e),r)}function Kl(e){return!e.some(Number.isNaN)}var Im={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},W=class e{constructor(t,r,n,i=1,o=!0){this.r=t,this.g=r,this.b=n,this.a=i,o||(this.r*=i,this.g*=i,this.b*=i,i||this.overwriteGetter("rgb",[t,r,n,i]))}static parse(t){if(t instanceof e)return t;if(typeof t!="string")return;let r=_m(t);if(r)return new e(...r,!1)}get rgb(){let{r:t,g:r,b:n,a:i}=this,o=i||1/0;return this.overwriteGetter("rgb",[t/o,r/o,n/o,i])}get hcl(){return this.overwriteGetter("hcl",Sm(this.rgb))}get lab(){return this.overwriteGetter("lab",Su(this.rgb))}overwriteGetter(t,r){return Object.defineProperty(this,t,{value:r}),r}toString(){let[t,r,n,i]=this.rgb;return`rgba(${[t,r,n].map(o=>Math.round(o*255)).join(",")},${i})`}};W.black=new W(0,0,0,1);W.white=new W(1,1,1,1);W.transparent=new W(0,0,0,0);W.red=new W(1,0,0,1);var Kr=class{constructor(t,r,n){t?this.sensitivity=r?"variant":"case":this.sensitivity=r?"accent":"base",this.locale=n,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,r){return this.collator.compare(t,r)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}},Yr=class{constructor(t,r,n,i,o){this.text=t,this.image=r,this.scale=n,this.fontStack=i,this.textColor=o}},Fe=class e{constructor(t){this.sections=t}static fromString(t){return new e([new Yr(t,null,null,null,null)])}isEmpty(){return this.sections.length===0?!0:!this.sections.some(t=>t.text.length!==0||t.image&&t.image.name.length!==0)}static factory(t){return t instanceof e?t:e.fromString(t)}toString(){return this.sections.length===0?"":this.sections.map(t=>t.text).join("")}},Ze=class e{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof e)return t;if(typeof t=="number")return new e([t,t,t,t]);if(Array.isArray(t)&&!(t.length<1||t.length>4)){for(let r of t)if(typeof r!="number")return;switch(t.length){case 1:t=[t[0],t[0],t[0],t[0]];break;case 2:t=[t[0],t[1],t[0],t[1]];break;case 3:t=[t[0],t[1],t[2],t[1]];break}return new e(t)}}toString(){return JSON.stringify(this.values)}},Tm=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]),Ne=class e{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof e)return t;if(!(!Array.isArray(t)||t.length<1||t.length%2!==0)){for(let r=0;r<t.length;r+=2){let n=t[r],i=t[r+1];if(typeof n!="string"||!Tm.has(n)||!Array.isArray(i)||i.length!==2||typeof i[0]!="number"||typeof i[1]!="number")return}return new e(t)}}toString(){return JSON.stringify(this.values)}},Te=class e{constructor(t){this.name=t.name,this.available=t.available}toString(){return this.name}static fromString(t){return t?new e({name:t,available:!1}):null}};function Au(e,t,r,n){return typeof e=="number"&&e>=0&&e<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof r=="number"&&r>=0&&r<=255?typeof n>"u"||typeof n=="number"&&n>=0&&n<=1?null:`Invalid rgba value [${[e,t,r,n].join(", ")}]: \'a\' must be between 0 and 1.`:`Invalid rgba value [${(typeof n=="number"?[e,t,r,n]:[e,t,r]).join(", ")}]: \'r\', \'g\', and \'b\' must be between 0 and 255.`}function Qr(e){if(e===null||typeof e=="string"||typeof e=="boolean"||typeof e=="number"||e instanceof W||e instanceof Kr||e instanceof Fe||e instanceof Ze||e instanceof Ne||e instanceof Te)return!0;if(Array.isArray(e)){for(let t of e)if(!Qr(t))return!1;return!0}else if(typeof e=="object"){for(let t in e)if(!Qr(e[t]))return!1;return!0}else return!1}function ue(e){if(e===null)return yr;if(typeof e=="string")return G;if(typeof e=="boolean")return U;if(typeof e=="number")return L;if(e instanceof W)return Re;if(e instanceof Kr)return ji;if(e instanceof Fe)return mr;if(e instanceof Ze)return Ji;if(e instanceof Ne)return Zi;if(e instanceof Te)return un;if(Array.isArray(e)){let t=e.length,r;for(let n of e){let i=ue(n);if(!r)r=i;else{if(r===i)continue;r=$;break}}return Ee(r||$,t)}else return lr}function Zr(e){let t=typeof e;return e===null?"":t==="string"||t==="number"||t==="boolean"?String(e):e instanceof W||e instanceof Fe||e instanceof Ze||e instanceof Ne||e instanceof Te?e.toString():JSON.stringify(e)}var mt=class e{constructor(t,r){this.type=t,this.value=r}static parse(t,r){if(t.length!==2)return r.error(`\'literal\' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!Qr(t[1]))return r.error("invalid value");let n=t[1],i=ue(n),o=r.expectedType;return i.kind==="array"&&i.N===0&&o&&o.kind==="array"&&(typeof o.N!="number"||o.N===0)&&(i=o),new e(i,n)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}},ie=class{constructor(t){this.name="ExpressionEvaluationError",this.message=t}toJSON(){return this.message}},Ci={string:G,number:L,boolean:U,object:lr},je=class e{constructor(t,r){this.type=t,this.args=r}static parse(t,r){if(t.length<2)return r.error("Expected at least one argument.");let n=1,i,o=t[0];if(o==="array"){let s;if(t.length>2){let u=t[1];if(typeof u!="string"||!(u in Ci)||u==="object")return r.error(\'The item type argument of "array" must be one of string, number, boolean\',1);s=Ci[u],n++}else s=$;let l;if(t.length>3){if(t[2]!==null&&(typeof t[2]!="number"||t[2]<0||t[2]!==Math.floor(t[2])))return r.error(\'The length argument to "array" must be a positive integer literal\',2);l=t[2],n++}i=Ee(s,l)}else{if(!Ci[o])throw new Error(`Types doesn\'t contain name = ${o}`);i=Ci[o]}let a=[];for(;n<t.length;n++){let s=r.parse(t[n],n,$);if(!s)return null;a.push(s)}return new e(i,a)}evaluate(t){for(let r=0;r<this.args.length;r++){let n=this.args[r].evaluate(t);if(Hr(this.type,ue(n))){if(r===this.args.length-1)throw new ie(`Expected value to be of type ${te(this.type)}, but found ${te(ue(n))} instead.`)}else return n}throw new Error}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}},Yl={"to-boolean":U,"to-color":Re,"to-number":L,"to-string":G},yt=class e{constructor(t,r){this.type=t,this.args=r}static parse(t,r){if(t.length<2)return r.error("Expected at least one argument.");let n=t[0];if(!Yl[n])throw new Error(`Can\'t parse ${n} as it is not part of the known types`);if((n==="to-boolean"||n==="to-string")&&t.length!==2)return r.error("Expected one argument.");let i=Yl[n],o=[];for(let a=1;a<t.length;a++){let s=r.parse(t[a],a,$);if(!s)return null;o.push(s)}return new e(i,o)}evaluate(t){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(t);case"color":{let r,n;for(let i of this.args){if(r=i.evaluate(t),n=null,r instanceof W)return r;if(typeof r=="string"){let o=t.parseColor(r);if(o)return o}else if(Array.isArray(r)&&(r.length<3||r.length>4?n=`Invalid rbga value ${JSON.stringify(r)}: expected an array containing either three or four numeric values.`:n=Au(r[0],r[1],r[2],r[3]),!n))return new W(r[0]/255,r[1]/255,r[2]/255,r[3])}throw new ie(n||`Could not parse color from value \'${typeof r=="string"?r:JSON.stringify(r)}\'`)}case"padding":{let r;for(let n of this.args){r=n.evaluate(t);let i=Ze.parse(r);if(i)return i}throw new ie(`Could not parse padding from value \'${typeof r=="string"?r:JSON.stringify(r)}\'`)}case"variableAnchorOffsetCollection":{let r;for(let n of this.args){r=n.evaluate(t);let i=Ne.parse(r);if(i)return i}throw new ie(`Could not parse variableAnchorOffsetCollection from value \'${typeof r=="string"?r:JSON.stringify(r)}\'`)}case"number":{let r=null;for(let n of this.args){if(r=n.evaluate(t),r===null)return 0;let i=Number(r);if(!isNaN(i))return i}throw new ie(`Could not convert ${JSON.stringify(r)} to number.`)}case"formatted":return Fe.fromString(Zr(this.args[0].evaluate(t)));case"resolvedImage":return Te.fromString(Zr(this.args[0].evaluate(t)));default:return Zr(this.args[0].evaluate(t))}}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}},Cm=["Unknown","Point","LineString","Polygon"],Fi=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Cm[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(t){let r=this._parseColorCache[t];return r||(r=this._parseColorCache[t]=W.parse(t)),r}},Li=class e{constructor(t,r,n=[],i,o=new Ja,a=[]){this.registry=t,this.path=n,this.key=n.map(s=>`[${s}]`).join(""),this.scope=o,this.errors=a,this.expectedType=i,this._isConstant=r}parse(t,r,n,i,o={}){return r?this.concat(r,n,i)._parse(t,o):this._parse(t,o)}_parse(t,r){(t===null||typeof t=="string"||typeof t=="boolean"||typeof t=="number")&&(t=["literal",t]);function n(i,o,a){return a==="assert"?new je(o,[i]):a==="coerce"?new yt(o,[i]):i}if(Array.isArray(t)){if(t.length===0)return this.error(\'Expected an array with at least one element. If you wanted a literal array, use ["literal", []].\');let i=t[0];if(typeof i!="string")return this.error(`Expression name must be a string, but found ${typeof i} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;let o=this.registry[i];if(o){let a=o.parse(t,this);if(!a)return null;if(this.expectedType){let s=this.expectedType,l=a.type;if((s.kind==="string"||s.kind==="number"||s.kind==="boolean"||s.kind==="object"||s.kind==="array")&&l.kind==="value")a=n(a,s,r.typeAnnotation||"assert");else if((s.kind==="color"||s.kind==="formatted"||s.kind==="resolvedImage")&&(l.kind==="value"||l.kind==="string"))a=n(a,s,r.typeAnnotation||"coerce");else if(s.kind==="padding"&&(l.kind==="value"||l.kind==="number"||l.kind==="array"))a=n(a,s,r.typeAnnotation||"coerce");else if(s.kind==="variableAnchorOffsetCollection"&&(l.kind==="value"||l.kind==="array"))a=n(a,s,r.typeAnnotation||"coerce");else if(this.checkSubtype(s,l))return null}if(!(a instanceof mt)&&a.type.kind!=="resolvedImage"&&this._isConstant(a)){let s=new Fi;try{a=new mt(a.type,a.evaluate(s))}catch(l){return this.error(l.message),null}}return a}return this.error(`Unknown expression "${i}". If you wanted a literal array, use ["literal", [...]].`,0)}else return typeof t>"u"?this.error("\'undefined\' value invalid. Use null instead."):typeof t=="object"?this.error(\'Bare objects invalid. Use ["literal", {...}] instead.\'):this.error(`Expected an array, but found ${typeof t} instead.`)}concat(t,r,n){let i=typeof t=="number"?this.path.concat(t):this.path,o=n?this.scope.concat(n):this.scope;return new e(this.registry,this._isConstant,i,r||null,o,this.errors)}error(t,...r){let n=`${this.key}${r.map(i=>`[${i}]`).join("")}`;this.errors.push(new Be(n,t))}checkSubtype(t,r){let n=Hr(t,r);return n&&this.error(n),n}},Di=class e{constructor(t,r){this.type=r.type,this.bindings=[].concat(t),this.result=r}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(let r of this.bindings)t(r[1]);t(this.result)}static parse(t,r){if(t.length<4)return r.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);let n=[];for(let o=1;o<t.length-1;o+=2){let a=t[o];if(typeof a!="string")return r.error(`Expected string, but found ${typeof a} instead.`,o);if(/[^a-zA-Z0-9_]/.test(a))return r.error("Variable names must contain only alphanumeric characters or \'_\'.",o);let s=r.parse(t[o+1],o+1);if(!s)return null;n.push([a,s])}let i=r.parse(t[t.length-1],t.length-1,r.expectedType,n);return i?new e(n,i):null}outputDefined(){return this.result.outputDefined()}},Vi=class e{constructor(t,r){this.type=r.type,this.name=t,this.boundExpression=r}static parse(t,r){if(t.length!==2||typeof t[1]!="string")return r.error("\'var\' expression requires exactly one string literal argument.");let n=t[1];return r.scope.has(n)?new e(n,r.scope.get(n)):r.error(`Unknown variable "${n}". Make sure "${n}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}},Za=class e{constructor(t,r,n){this.type=t,this.index=r,this.input=n}static parse(t,r){if(t.length!==3)return r.error(`Expected 2 arguments, but found ${t.length-1} instead.`);let n=r.parse(t[1],1,L),i=r.parse(t[2],2,Ee(r.expectedType||$));if(!n||!i)return null;let o=i.type;return new e(o.itemType,n,i)}evaluate(t){let r=this.index.evaluate(t),n=this.input.evaluate(t);if(r<0)throw new ie(`Array index out of bounds: ${r} < 0.`);if(r>=n.length)throw new ie(`Array index out of bounds: ${r} > ${n.length-1}.`);if(r!==Math.floor(r))throw new ie(`Array index must be an integer, but found ${r} instead.`);return n[r]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}},Wa=class e{constructor(t,r){this.type=U,this.needle=t,this.haystack=r}static parse(t,r){if(t.length!==3)return r.error(`Expected 2 arguments, but found ${t.length-1} instead.`);let n=r.parse(t[1],1,$),i=r.parse(t[2],2,$);return!n||!i?null:us(n.type,[U,G,L,yr,$])?new e(n,i):r.error(`Expected first argument to be of type boolean, string, number or null, but found ${te(n.type)} instead`)}evaluate(t){let r=this.needle.evaluate(t),n=this.haystack.evaluate(t);if(!n)return!1;if(!Xr(r,["boolean","string","number","null"]))throw new ie(`Expected first argument to be of type boolean, string, number or null, but found ${te(ue(r))} instead.`);if(!Xr(n,["string","array"]))throw new ie(`Expected second argument to be of type array or string, but found ${te(ue(n))} instead.`);return n.indexOf(r)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}},Ha=class e{constructor(t,r,n){this.type=L,this.needle=t,this.haystack=r,this.fromIndex=n}static parse(t,r){if(t.length<=2||t.length>=5)return r.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);let n=r.parse(t[1],1,$),i=r.parse(t[2],2,$);if(!n||!i)return null;if(!us(n.type,[U,G,L,yr,$]))return r.error(`Expected first argument to be of type boolean, string, number or null, but found ${te(n.type)} instead`);if(t.length===4){let o=r.parse(t[3],3,L);return o?new e(n,i,o):null}else return new e(n,i)}evaluate(t){let r=this.needle.evaluate(t),n=this.haystack.evaluate(t);if(!Xr(r,["boolean","string","number","null"]))throw new ie(`Expected first argument to be of type boolean, string, number or null, but found ${te(ue(r))} instead.`);if(!Xr(n,["string","array"]))throw new ie(`Expected second argument to be of type array or string, but found ${te(ue(n))} instead.`);if(this.fromIndex){let i=this.fromIndex.evaluate(t);return n.indexOf(r,i)}return n.indexOf(r)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}},Xa=class e{constructor(t,r,n,i,o,a){this.inputType=t,this.type=r,this.input=n,this.cases=i,this.outputs=o,this.otherwise=a}static parse(t,r){if(t.length<5)return r.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!==1)return r.error("Expected an even number of arguments.");let n,i;r.expectedType&&r.expectedType.kind!=="value"&&(i=r.expectedType);let o={},a=[];for(let u=2;u<t.length-1;u+=2){let c=t[u],p=t[u+1];Array.isArray(c)||(c=[c]);let f=r.concat(u);if(c.length===0)return f.error("Expected at least one branch label.");for(let m of c){if(typeof m!="number"&&typeof m!="string")return f.error("Branch labels must be numbers or strings.");if(typeof m=="number"&&Math.abs(m)>Number.MAX_SAFE_INTEGER)return f.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof m=="number"&&Math.floor(m)!==m)return f.error("Numeric branch labels must be integer values.");if(!n)n=ue(m);else if(f.checkSubtype(n,ue(m)))return null;if(typeof o[String(m)]<"u")return f.error("Branch labels must be unique.");o[String(m)]=a.length}let y=r.parse(p,u,i);if(!y)return null;i=i||y.type,a.push(y)}let s=r.parse(t[1],1,$);if(!s)return null;let l=r.parse(t[t.length-1],t.length-1,i);return!l||s.type.kind!=="value"&&r.concat(1).checkSubtype(n,s.type)?null:new e(n,i,s,o,a,l)}evaluate(t){let r=this.input.evaluate(t);return(ue(r)===this.inputType&&this.outputs[this.cases[r]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every(t=>t.outputDefined())&&this.otherwise.outputDefined()}},Ka=class e{constructor(t,r,n){this.type=t,this.branches=r,this.otherwise=n}static parse(t,r){if(t.length<4)return r.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!==0)return r.error("Expected an odd number of arguments.");let n;r.expectedType&&r.expectedType.kind!=="value"&&(n=r.expectedType);let i=[];for(let a=1;a<t.length-1;a+=2){let s=r.parse(t[a],a,U);if(!s)return null;let l=r.parse(t[a+1],a+1,n);if(!l)return null;i.push([s,l]),n=n||l.type}let o=r.parse(t[t.length-1],t.length-1,n);if(!o)return null;if(!n)throw new Error("Can\'t infer output type");return new e(n,i,o)}evaluate(t){for(let[r,n]of this.branches)if(r.evaluate(t))return n.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(let[r,n]of this.branches)t(r),t(n);t(this.otherwise)}outputDefined(){return this.branches.every(([t,r])=>r.outputDefined())&&this.otherwise.outputDefined()}},Ya=class e{constructor(t,r,n,i){this.type=t,this.input=r,this.beginIndex=n,this.endIndex=i}static parse(t,r){if(t.length<=2||t.length>=5)return r.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);let n=r.parse(t[1],1,$),i=r.parse(t[2],2,L);if(!n||!i)return null;if(!us(n.type,[Ee($),G,$]))return r.error(`Expected first argument to be of type array or string, but found ${te(n.type)} instead`);if(t.length===4){let o=r.parse(t[3],3,L);return o?new e(n.type,n,i,o):null}else return new e(n.type,n,i)}evaluate(t){let r=this.input.evaluate(t),n=this.beginIndex.evaluate(t);if(!Xr(r,["string","array"]))throw new ie(`Expected first argument to be of type array or string, but found ${te(ue(r))} instead.`);if(this.endIndex){let i=this.endIndex.evaluate(t);return r.slice(n,i)}return r.slice(n)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}};function Wi(e,t){let r=e.length-1,n=0,i=r,o=0,a,s;for(;n<=i;)if(o=Math.floor((n+i)/2),a=e[o],s=e[o+1],a<=t){if(o===r||t<s)return o;n=o+1}else if(a>t)i=o-1;else throw new ie("Input is not a number.");return 0}var pr=class e{constructor(t,r,n){this.type=t,this.input=r,this.labels=[],this.outputs=[];for(let[i,o]of n)this.labels.push(i),this.outputs.push(o)}static parse(t,r){if(t.length-1<4)return r.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!==0)return r.error("Expected an even number of arguments.");let n=r.parse(t[1],1,L);if(!n)return null;let i=[],o=null;r.expectedType&&r.expectedType.kind!=="value"&&(o=r.expectedType);for(let a=1;a<t.length;a+=2){let s=a===1?-1/0:t[a],l=t[a+1],u=a,c=a+1;if(typeof s!="number")return r.error(\'Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.\',u);if(i.length&&i[i.length-1][0]>=s)return r.error(\'Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.\',u);let p=r.parse(l,c,o);if(!p)return null;o=o||p.type,i.push([s,p])}return new e(o,n,i)}evaluate(t){let r=this.labels,n=this.outputs;if(r.length===1)return n[0].evaluate(t);let i=this.input.evaluate(t);if(i<=r[0])return n[0].evaluate(t);let o=r.length;if(i>=r[o-1])return n[o-1].evaluate(t);let a=Wi(r,i);return n[a].evaluate(t)}eachChild(t){t(this.input);for(let r of this.outputs)t(r)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}};function km(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Mm=_u;function _u(e,t,r,n){this.cx=3*e,this.bx=3*(r-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(n-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=t,this.p2x=r,this.p2y=n}_u.prototype={sampleCurveX:function(e){return((this.ax*e+this.bx)*e+this.cx)*e},sampleCurveY:function(e){return((this.ay*e+this.by)*e+this.cy)*e},sampleCurveDerivativeX:function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},solveCurveX:function(e,t){if(t===void 0&&(t=1e-6),e<0)return 0;if(e>1)return 1;for(var r=e,n=0;n<8;n++){var i=this.sampleCurveX(r)-e;if(Math.abs(i)<t)return r;var o=this.sampleCurveDerivativeX(r);if(Math.abs(o)<1e-6)break;r=r-i/o}var a=0,s=1;for(r=e,n=0;n<20&&(i=this.sampleCurveX(r),!(Math.abs(i-e)<t));n++)e>i?a=r:s=r,r=(s-a)*.5+a;return r},solve:function(e,t){return this.sampleCurveY(this.solveCurveX(e,t))}};var Em=km(Mm);function Fm(e){return e==="rgb"||e==="hcl"||e==="lab"}function zt(e,t,r){return e+r*(t-e)}function Lm(e,t,r,n="rgb"){switch(n){case"rgb":{let[i,o,a,s]=Bi(e.rgb,t.rgb,r);return new W(i,o,a,s,!1)}case"hcl":{let[i,o,a,s]=e.hcl,[l,u,c,p]=t.hcl,f,y;if(!isNaN(i)&&!isNaN(l)){let b=l-i;l>i&&b>180?b-=360:l<i&&i-l>180&&(b+=360),f=i+r*b}else isNaN(i)?isNaN(l)?f=NaN:(f=l,(a===1||a===0)&&(y=u)):(f=i,(c===1||c===0)&&(y=o));let[m,h,d,g]=wm([f,y!=null?y:zt(o,u,r),zt(a,c,r),zt(s,p,r)]);return new W(m,h,d,g,!1)}case"lab":{let[i,o,a,s]=wu(Bi(e.lab,t.lab,r));return new W(i,o,a,s,!1)}}}function Bi(e,t,r){return e.map((n,i)=>zt(n,t[i],r))}function Dm(e,t,r){return new Ze(Bi(e.values,t.values,r))}function Vm(e,t,r){let n=e.values,i=t.values;if(n.length!==i.length)throw new ie(`Cannot interpolate values of different length. from: ${e.toString()}, to: ${t.toString()}`);let o=[];for(let a=0;a<n.length;a+=2){if(n[a]!==i[a])throw new ie(`Cannot interpolate values containing mismatched anchors. from[${a}]: ${n[a]}, to[${a}]: ${i[a]}`);o.push(n[a]);let[s,l]=n[a+1],[u,c]=i[a+1];o.push([zt(s,u,r),zt(l,c,r)])}return new Ne(o)}var Oe={number:zt,color:Lm,array:Bi,padding:Dm,variableAnchorOffsetCollection:Vm},Je=class e{constructor(t,r,n,i,o){this.type=t,this.operator=r,this.interpolation=n,this.input=i,this.labels=[],this.outputs=[];for(let[a,s]of o)this.labels.push(a),this.outputs.push(s)}static interpolationFactor(t,r,n,i){let o=0;if(t.name==="exponential")o=$a(r,t.base,n,i);else if(t.name==="linear")o=$a(r,1,n,i);else if(t.name==="cubic-bezier"){let a=t.controlPoints;o=new Em(a[0],a[1],a[2],a[3]).solve($a(r,1,n,i))}return o}static parse(t,r){let[n,i,o,...a]=t;if(!Array.isArray(i)||i.length===0)return r.error("Expected an interpolation type expression.",1);if(i[0]==="linear")i={name:"linear"};else if(i[0]==="exponential"){let u=i[1];if(typeof u!="number")return r.error("Exponential interpolation requires a numeric base.",1,1);i={name:"exponential",base:u}}else if(i[0]==="cubic-bezier"){let u=i.slice(1);if(u.length!==4||u.some(c=>typeof c!="number"||c<0||c>1))return r.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);i={name:"cubic-bezier",controlPoints:u}}else return r.error(`Unknown interpolation type ${String(i[0])}`,1,0);if(t.length-1<4)return r.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!==0)return r.error("Expected an even number of arguments.");if(o=r.parse(o,2,L),!o)return null;let s=[],l=null;n==="interpolate-hcl"||n==="interpolate-lab"?l=Re:r.expectedType&&r.expectedType.kind!=="value"&&(l=r.expectedType);for(let u=0;u<a.length;u+=2){let c=a[u],p=a[u+1],f=u+3,y=u+4;if(typeof c!="number")return r.error(\'Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.\',f);if(s.length&&s[s.length-1][0]>=c)return r.error(\'Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.\',f);let m=r.parse(p,y,l);if(!m)return null;l=l||m.type,s.push([c,m])}return!jr(l,L)&&!jr(l,Re)&&!jr(l,Ji)&&!jr(l,Zi)&&!jr(l,Ee(L))?r.error(`Type ${te(l)} is not interpolatable.`):new e(l,n,i,o,s)}evaluate(t){let r=this.labels,n=this.outputs;if(r.length===1)return n[0].evaluate(t);let i=this.input.evaluate(t);if(i<=r[0])return n[0].evaluate(t);let o=r.length;if(i>=r[o-1])return n[o-1].evaluate(t);let a=Wi(r,i),s=r[a],l=r[a+1],u=e.interpolationFactor(this.interpolation,i,s,l),c=n[a].evaluate(t),p=n[a+1].evaluate(t);switch(this.operator){case"interpolate":return Oe[this.type.kind](c,p,u);case"interpolate-hcl":return Oe.color(c,p,u,"hcl");case"interpolate-lab":return Oe.color(c,p,u,"lab")}}eachChild(t){t(this.input);for(let r of this.outputs)t(r)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}};function $a(e,t,r,n){let i=n-r,o=e-r;return i===0?0:t===1?o/i:(Math.pow(t,o)-1)/(Math.pow(t,i)-1)}var zi=class e{constructor(t,r){this.type=t,this.args=r}static parse(t,r){if(t.length<2)return r.error("Expectected at least one argument.");let n=null,i=r.expectedType;i&&i.kind!=="value"&&(n=i);let o=[];for(let s of t.slice(1)){let l=r.parse(s,1+o.length,n,void 0,{typeAnnotation:"omit"});if(!l)return null;n=n||l.type,o.push(l)}if(!n)throw new Error("No output type");return i&&o.some(s=>Hr(i,s.type))?new e($,o):new e(n,o)}evaluate(t){let r=null,n=0,i;for(let o of this.args)if(n++,r=o.evaluate(t),r&&r instanceof Te&&!r.available&&(i||(i=r.name),r=null,n===this.args.length&&(r=i)),r!==null)break;return r}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}};function Ql(e,t){return e==="=="||e==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function Bm(e,t,r){return t===r}function zm(e,t,r){return t!==r}function Rm(e,t,r){return t<r}function Om(e,t,r){return t>r}function Nm(e,t,r){return t<=r}function Um(e,t,r){return t>=r}function Iu(e,t,r,n){return n.compare(t,r)===0}function $m(e,t,r,n){return!Iu(e,t,r,n)}function Gm(e,t,r,n){return n.compare(t,r)<0}function qm(e,t,r,n){return n.compare(t,r)>0}function jm(e,t,r,n){return n.compare(t,r)<=0}function Jm(e,t,r,n){return n.compare(t,r)>=0}function hr(e,t,r){let n=e!=="=="&&e!=="!=";return class Tu{constructor(o,a,s){this.type=U,this.lhs=o,this.rhs=a,this.collator=s,this.hasUntypedArgument=o.type.kind==="value"||a.type.kind==="value"}static parse(o,a){if(o.length!==3&&o.length!==4)return a.error("Expected two or three arguments.");let s=o[0],l=a.parse(o[1],1,$);if(!l)return null;if(!Ql(s,l.type))return a.concat(1).error(`"${s}" comparisons are not supported for type \'${te(l.type)}\'.`);let u=a.parse(o[2],2,$);if(!u)return null;if(!Ql(s,u.type))return a.concat(2).error(`"${s}" comparisons are not supported for type \'${te(u.type)}\'.`);if(l.type.kind!==u.type.kind&&l.type.kind!=="value"&&u.type.kind!=="value")return a.error(`Cannot compare types \'${te(l.type)}\' and \'${te(u.type)}\'.`);n&&(l.type.kind==="value"&&u.type.kind!=="value"?l=new je(u.type,[l]):l.type.kind!=="value"&&u.type.kind==="value"&&(u=new je(l.type,[u])));let c=null;if(o.length===4){if(l.type.kind!=="string"&&u.type.kind!=="string"&&l.type.kind!=="value"&&u.type.kind!=="value")return a.error("Cannot use collator to compare non-string types.");if(c=a.parse(o[3],3,ji),!c)return null}return new Tu(l,u,c)}evaluate(o){let a=this.lhs.evaluate(o),s=this.rhs.evaluate(o);if(n&&this.hasUntypedArgument){let l=ue(a),u=ue(s);if(l.kind!==u.kind||!(l.kind==="string"||l.kind==="number"))throw new ie(`Expected arguments for "${e}" to be (string, string) or (number, number), but found (${l.kind}, ${u.kind}) instead.`)}if(this.collator&&!n&&this.hasUntypedArgument){let l=ue(a),u=ue(s);if(l.kind!=="string"||u.kind!=="string")return t(o,a,s)}return this.collator?r(o,a,s,this.collator.evaluate(o)):t(o,a,s)}eachChild(o){o(this.lhs),o(this.rhs),this.collator&&o(this.collator)}outputDefined(){return!0}}}var Zm=hr("==",Bm,Iu),Wm=hr("!=",zm,$m),Hm=hr("<",Rm,Gm),Xm=hr(">",Om,qm),Km=hr("<=",Nm,jm),Ym=hr(">=",Um,Jm),Ri=class e{constructor(t,r,n){this.type=ji,this.locale=n,this.caseSensitive=t,this.diacriticSensitive=r}static parse(t,r){if(t.length!==2)return r.error("Expected one argument.");let n=t[1];if(typeof n!="object"||Array.isArray(n))return r.error("Collator options argument must be an object.");let i=r.parse(n["case-sensitive"]===void 0?!1:n["case-sensitive"],1,U);if(!i)return null;let o=r.parse(n["diacritic-sensitive"]===void 0?!1:n["diacritic-sensitive"],1,U);if(!o)return null;let a=null;return n.locale&&(a=r.parse(n.locale,1,G),!a)?null:new e(i,o,a)}evaluate(t){return new Kr(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}},Qa=class e{constructor(t,r,n,i,o){this.type=G,this.number=t,this.locale=r,this.currency=n,this.minFractionDigits=i,this.maxFractionDigits=o}static parse(t,r){if(t.length!==3)return r.error("Expected two arguments.");let n=r.parse(t[1],1,L);if(!n)return null;let i=t[2];if(typeof i!="object"||Array.isArray(i))return r.error("NumberFormat options argument must be an object.");let o=null;if(i.locale&&(o=r.parse(i.locale,1,G),!o))return null;let a=null;if(i.currency&&(a=r.parse(i.currency,1,G),!a))return null;let s=null;if(i["min-fraction-digits"]&&(s=r.parse(i["min-fraction-digits"],1,L),!s))return null;let l=null;return i["max-fraction-digits"]&&(l=r.parse(i["max-fraction-digits"],1,L),!l)?null:new e(n,o,a,s,l)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}},en=class e{constructor(t){this.type=mr,this.sections=t}static parse(t,r){if(t.length<2)return r.error("Expected at least one argument.");let n=t[1];if(!Array.isArray(n)&&typeof n=="object")return r.error("First argument must be an image or text section.");let i=[],o=!1;for(let a=1;a<=t.length-1;++a){let s=t[a];if(o&&typeof s=="object"&&!Array.isArray(s)){o=!1;let l=null;if(s["font-scale"]&&(l=r.parse(s["font-scale"],1,L),!l))return null;let u=null;if(s["text-font"]&&(u=r.parse(s["text-font"],1,Ee(G)),!u))return null;let c=null;if(s["text-color"]&&(c=r.parse(s["text-color"],1,Re),!c))return null;let p=i[i.length-1];p.scale=l,p.font=u,p.textColor=c}else{let l=r.parse(t[a],1,$);if(!l)return null;let u=l.type.kind;if(u!=="string"&&u!=="value"&&u!=="null"&&u!=="resolvedImage")return r.error("Formatted text type must be \'string\', \'value\', \'image\' or \'null\'.");o=!0,i.push({content:l,scale:null,font:null,textColor:null})}}return new e(i)}evaluate(t){let r=n=>{let i=n.content.evaluate(t);return ue(i)===un?new Yr("",i,null,null,null):new Yr(Zr(i),null,n.scale?n.scale.evaluate(t):null,n.font?n.font.evaluate(t).join(","):null,n.textColor?n.textColor.evaluate(t):null)};return new Fe(this.sections.map(r))}eachChild(t){for(let r of this.sections)t(r.content),r.scale&&t(r.scale),r.font&&t(r.font),r.textColor&&t(r.textColor)}outputDefined(){return!1}},es=class e{constructor(t){this.type=un,this.input=t}static parse(t,r){if(t.length!==2)return r.error("Expected two arguments.");let n=r.parse(t[1],1,G);return n?new e(n):r.error("No image name provided.")}evaluate(t){let r=this.input.evaluate(t),n=Te.fromString(r);return n&&t.availableImages&&(n.available=t.availableImages.indexOf(r)>-1),n}eachChild(t){t(this.input)}outputDefined(){return!1}},ts=class e{constructor(t){this.type=L,this.input=t}static parse(t,r){if(t.length!==2)return r.error(`Expected 1 argument, but found ${t.length-1} instead.`);let n=r.parse(t[1],1);return n?n.type.kind!=="array"&&n.type.kind!=="string"&&n.type.kind!=="value"?r.error(`Expected argument of type string or array, but found ${te(n.type)} instead.`):new e(n):null}evaluate(t){let r=this.input.evaluate(t);if(typeof r=="string")return r.length;if(Array.isArray(r))return r.length;throw new ie(`Expected value to be of type string or array, but found ${te(ue(r))} instead.`)}eachChild(t){t(this.input)}outputDefined(){return!1}},Xe=8192;function Qm(e,t){let r=eh(e[0]),n=rh(e[1]),i=Math.pow(2,t.z);return[Math.round(r*i*Xe),Math.round(n*i*Xe)]}function cs(e,t){let r=Math.pow(2,t.z),n=(e[0]/Xe+t.x)/r,i=(e[1]/Xe+t.y)/r;return[th(n),nh(i)]}function eh(e){return(180+e)/360}function th(e){return e*360-180}function rh(e){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e*Math.PI/360)))/360}function nh(e){return 360/Math.PI*Math.atan(Math.exp((180-e*360)*Math.PI/180))-90}function cn(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.max(e[2],t[0]),e[3]=Math.max(e[3],t[1])}function tn(e,t){return!(e[0]<=t[0]||e[2]>=t[2]||e[1]<=t[1]||e[3]>=t[3])}function ih(e,t,r){return t[1]>e[1]!=r[1]>e[1]&&e[0]<(r[0]-t[0])*(e[1]-t[1])/(r[1]-t[1])+t[0]}function oh(e,t,r){let n=e[0]-t[0],i=e[1]-t[1],o=e[0]-r[0],a=e[1]-r[1];return n*a-o*i===0&&n*o<=0&&i*a<=0}function Hi(e,t,r,n){let i=[t[0]-e[0],t[1]-e[1]],o=[n[0]-r[0],n[1]-r[1]];return uh(o,i)===0?!1:!!(eu(e,t,r,n)&&eu(r,n,e,t))}function ah(e,t,r){for(let n of r)for(let i=0;i<n.length-1;++i)if(Hi(e,t,n[i],n[i+1]))return!0;return!1}function dr(e,t,r=!1){let n=!1;for(let i of t)for(let o=0;o<i.length-1;o++){if(oh(e,i[o],i[o+1]))return r;ih(e,i[o],i[o+1])&&(n=!n)}return n}function sh(e,t){for(let r of t)if(dr(e,r))return!0;return!1}function Cu(e,t){for(let r of e)if(!dr(r,t))return!1;for(let r=0;r<e.length-1;++r)if(ah(e[r],e[r+1],t))return!1;return!0}function lh(e,t){for(let r of t)if(Cu(e,r))return!0;return!1}function uh(e,t){return e[0]*t[1]-e[1]*t[0]}function eu(e,t,r,n){let i=e[0]-r[0],o=e[1]-r[1],a=t[0]-r[0],s=t[1]-r[1],l=n[0]-r[0],u=n[1]-r[1],c=i*u-l*o,p=a*u-l*s;return c>0&&p<0||c<0&&p>0}function ps(e,t,r){let n=[];for(let i=0;i<e.length;i++){let o=[];for(let a=0;a<e[i].length;a++){let s=Qm(e[i][a],r);cn(t,s),o.push(s)}n.push(o)}return n}function ku(e,t,r){let n=[];for(let i=0;i<e.length;i++){let o=ps(e[i],t,r);n.push(o)}return n}function Mu(e,t,r,n){if(e[0]<r[0]||e[0]>r[2]){let i=n*.5,o=e[0]-r[0]>i?-n:r[0]-e[0]>i?n:0;o===0&&(o=e[0]-r[2]>i?-n:r[2]-e[0]>i?n:0),e[0]+=o}cn(t,e)}function ch(e){e[0]=e[1]=1/0,e[2]=e[3]=-1/0}function tu(e,t,r,n){let i=Math.pow(2,n.z)*Xe,o=[n.x*Xe,n.y*Xe],a=[];for(let s of e)for(let l of s){let u=[l.x+o[0],l.y+o[1]];Mu(u,t,r,i),a.push(u)}return a}function ru(e,t,r,n){let i=Math.pow(2,n.z)*Xe,o=[n.x*Xe,n.y*Xe],a=[];for(let s of e){let l=[];for(let u of s){let c=[u.x+o[0],u.y+o[1]];cn(t,c),l.push(c)}a.push(l)}if(t[2]-t[0]<=i/2){ch(t);for(let s of a)for(let l of s)Mu(l,t,r,i)}return a}function ph(e,t){let r=[1/0,1/0,-1/0,-1/0],n=[1/0,1/0,-1/0,-1/0],i=e.canonicalID();if(t.type==="Polygon"){let o=ps(t.coordinates,n,i),a=tu(e.geometry(),r,n,i);if(!tn(r,n))return!1;for(let s of a)if(!dr(s,o))return!1}if(t.type==="MultiPolygon"){let o=ku(t.coordinates,n,i),a=tu(e.geometry(),r,n,i);if(!tn(r,n))return!1;for(let s of a)if(!sh(s,o))return!1}return!0}function fh(e,t){let r=[1/0,1/0,-1/0,-1/0],n=[1/0,1/0,-1/0,-1/0],i=e.canonicalID();if(t.type==="Polygon"){let o=ps(t.coordinates,n,i),a=ru(e.geometry(),r,n,i);if(!tn(r,n))return!1;for(let s of a)if(!Cu(s,o))return!1}if(t.type==="MultiPolygon"){let o=ku(t.coordinates,n,i),a=ru(e.geometry(),r,n,i);if(!tn(r,n))return!1;for(let s of a)if(!lh(s,o))return!1}return!0}var rn=class e{constructor(t,r){this.type=U,this.geojson=t,this.geometries=r}static parse(t,r){if(t.length!==2)return r.error(`\'within\' expression requires exactly one argument, but found ${t.length-1} instead.`);if(Qr(t[1])){let n=t[1];if(n.type==="FeatureCollection"){let i=[];for(let o of n.features){let{type:a,coordinates:s}=o.geometry;a==="Polygon"&&i.push(s),a==="MultiPolygon"&&i.push(...s)}if(i.length){let o={type:"MultiPolygon",coordinates:i};return new e(n,o)}}else if(n.type==="Feature"){let i=n.geometry.type;if(i==="Polygon"||i==="MultiPolygon")return new e(n,n.geometry)}else if(n.type==="Polygon"||n.type==="MultiPolygon")return new e(n,n)}return r.error("\'within\' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return ph(t,this.geometries);if(t.geometryType()==="LineString")return fh(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}},Oi=class{constructor(t=[],r=yh){if(this.data=t,this.length=this.data.length,this.compare=r,this.length>0)for(let n=(this.length>>1)-1;n>=0;n--)this._down(n)}push(t){this.data.push(t),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;let t=this.data[0],r=this.data.pop();return this.length--,this.length>0&&(this.data[0]=r,this._down(0)),t}peek(){return this.data[0]}_up(t){let{data:r,compare:n}=this,i=r[t];for(;t>0;){let o=t-1>>1,a=r[o];if(n(i,a)>=0)break;r[t]=a,t=o}r[t]=i}_down(t){let{data:r,compare:n}=this,i=this.length>>1,o=r[t];for(;t<i;){let a=(t<<1)+1,s=r[a],l=a+1;if(l<this.length&&n(r[l],s)<0&&(a=l,s=r[l]),n(s,o)>=0)break;r[t]=s,t=a}r[t]=o}};function yh(e,t){return e<t?-1:e>t?1:0}function mh(e,t,r,n,i){Eu(e,t,r,n||e.length-1,i||hh)}function Eu(e,t,r,n,i){for(;n>r;){if(n-r>600){var o=n-r+1,a=t-r+1,s=Math.log(o),l=.5*Math.exp(2*s/3),u=.5*Math.sqrt(s*l*(o-l)/o)*(a-o/2<0?-1:1),c=Math.max(r,Math.floor(t-a*l/o+u)),p=Math.min(n,Math.floor(t+(o-a)*l/o+u));Eu(e,t,c,p,i)}var f=e[t],y=r,m=n;for(Jr(e,r,t),i(e[n],f)>0&&Jr(e,r,n);y<m;){for(Jr(e,y,m),y++,m--;i(e[y],f)<0;)y++;for(;i(e[m],f)>0;)m--}i(e[r],f)===0?Jr(e,r,m):(m++,Jr(e,m,n)),m<=t&&(r=m+1),t<=m&&(n=m-1)}}function Jr(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function hh(e,t){return e<t?-1:e>t?1:0}function dh(e,t){if(e.length<=1)return[e];let n=[],i,o;for(let a of e){let s=xh(a);s!==0&&(a.area=Math.abs(s),o===void 0&&(o=s<0),o===s<0?(i&&n.push(i),i=[a]):i.push(a))}if(i&&n.push(i),t>1)for(let a=0;a<n.length;a++)n[a].length<=t||(mh(n[a],t,1,n[a].length-1,gh),n[a]=n[a].slice(0,t));return n}function gh(e,t){return t.area-e.area}function xh(e){let t=0;for(let r=0,n=e.length,i=n-1,o,a;r<n;i=r++)o=e[r],a=e[i],t+=(a.x-o.x)*(o.y+a.y);return t}var bh=6378.137,nu=1/298.257223563,iu=nu*(2-nu),ou=Math.PI/180,nn=class{constructor(t){let r=ou*bh*1e3,n=Math.cos(t*ou),i=1/(1-iu*(1-n*n)),o=Math.sqrt(i);this.kx=r*o*n,this.ky=r*o*i*(1-iu)}distance(t,r){let n=this.wrap(t[0]-r[0])*this.kx,i=(t[1]-r[1])*this.ky;return Math.sqrt(n*n+i*i)}pointOnLine(t,r){let n=1/0,i,o,a,s;for(let l=0;l<t.length-1;l++){let u=t[l][0],c=t[l][1],p=this.wrap(t[l+1][0]-u)*this.kx,f=(t[l+1][1]-c)*this.ky,y=0;(p!==0||f!==0)&&(y=(this.wrap(r[0]-u)*this.kx*p+(r[1]-c)*this.ky*f)/(p*p+f*f),y>1?(u=t[l+1][0],c=t[l+1][1]):y>0&&(u+=p/this.kx*y,c+=f/this.ky*y)),p=this.wrap(r[0]-u)*this.kx,f=(r[1]-c)*this.ky;let m=p*p+f*f;m<n&&(n=m,i=u,o=c,a=l,s=y)}return{point:[i,o],index:a,t:Math.max(0,Math.min(1,s))}}wrap(t){for(;t<-180;)t+=360;for(;t>180;)t-=360;return t}},rs=100,ns=50;function Fu(e,t){return t[0]-e[0]}function Ni(e){return e[1]-e[0]+1}function st(e,t){return e[1]>=e[0]&&e[1]<t}function is(e,t){if(e[0]>e[1])return[null,null];let r=Ni(e);if(t){if(r===2)return[e,null];let i=Math.floor(r/2);return[[e[0],e[0]+i],[e[0]+i,e[1]]]}if(r===1)return[e,null];let n=Math.floor(r/2)-1;return[[e[0],e[0]+n],[e[0]+n+1,e[1]]]}function os(e,t){if(!st(t,e.length))return[1/0,1/0,-1/0,-1/0];let r=[1/0,1/0,-1/0,-1/0];for(let n=t[0];n<=t[1];++n)cn(r,e[n]);return r}function as(e){let t=[1/0,1/0,-1/0,-1/0];for(let r of e)for(let n of r)cn(t,n);return t}function au(e){return e[0]!==-1/0&&e[1]!==-1/0&&e[2]!==1/0&&e[3]!==1/0}function fs(e,t,r){if(!au(e)||!au(t))return NaN;let n=0,i=0;return e[2]<t[0]&&(n=t[0]-e[2]),e[0]>t[2]&&(n=e[0]-t[2]),e[1]>t[3]&&(i=e[1]-t[3]),e[3]<t[1]&&(i=t[1]-e[3]),r.distance([0,0],[n,i])}function Bt(e,t,r){let n=r.pointOnLine(t,e);return r.distance(e,n.point)}function ys(e,t,r,n,i){let o=Math.min(Bt(e,[r,n],i),Bt(t,[r,n],i)),a=Math.min(Bt(r,[e,t],i),Bt(n,[e,t],i));return Math.min(o,a)}function vh(e,t,r,n,i){if(!(st(t,e.length)&&st(n,r.length)))return 1/0;let a=1/0;for(let s=t[0];s<t[1];++s){let l=e[s],u=e[s+1];for(let c=n[0];c<n[1];++c){let p=r[c],f=r[c+1];if(Hi(l,u,p,f))return 0;a=Math.min(a,ys(l,u,p,f,i))}}return a}function Ph(e,t,r,n,i){if(!(st(t,e.length)&&st(n,r.length)))return NaN;let a=1/0;for(let s=t[0];s<=t[1];++s)for(let l=n[0];l<=n[1];++l)if(a=Math.min(a,i.distance(e[s],r[l])),a===0)return a;return a}function Sh(e,t,r){if(dr(e,t,!0))return 0;let n=1/0;for(let i of t){let o=i[0],a=i[i.length-1];if(o!==a&&(n=Math.min(n,Bt(e,[a,o],r)),n===0))return n;let s=r.pointOnLine(i,e);if(n=Math.min(n,r.distance(e,s.point)),n===0)return n}return n}function wh(e,t,r,n){if(!st(t,e.length))return NaN;for(let o=t[0];o<=t[1];++o)if(dr(e[o],r,!0))return 0;let i=1/0;for(let o=t[0];o<t[1];++o){let a=e[o],s=e[o+1];for(let l of r)for(let u=0,c=l.length,p=c-1;u<c;p=u++){let f=l[p],y=l[u];if(Hi(a,s,f,y))return 0;i=Math.min(i,ys(a,s,f,y,n))}}return i}function su(e,t){for(let r of e)for(let n of r)if(dr(n,t,!0))return!0;return!1}function Ah(e,t,r,n=1/0){let i=as(e),o=as(t);if(n!==1/0&&fs(i,o,r)>=n)return n;if(tn(i,o)){if(su(e,t))return 0}else if(su(t,e))return 0;let a=1/0;for(let s of e)for(let l=0,u=s.length,c=u-1;l<u;c=l++){let p=s[c],f=s[l];for(let y of t)for(let m=0,h=y.length,d=h-1;m<h;d=m++){let g=y[d],b=y[m];if(Hi(p,f,g,b))return 0;a=Math.min(a,ys(p,f,g,b,r))}}return a}function lu(e,t,r,n,i,o){if(!o)return;let a=fs(os(n,o),i,r);a<t&&e.push([a,o,[0,0]])}function ki(e,t,r,n,i,o,a){if(!o||!a)return;let s=fs(os(n,o),os(i,a),r);s<t&&e.push([s,o,a])}function Ui(e,t,r,n,i=1/0){let o=Math.min(n.distance(e[0],r[0][0]),i);if(o===0)return o;let a=new Oi([[0,[0,e.length-1],[0,0]]],Fu),s=as(r);for(;a.length>0;){let l=a.pop();if(l[0]>=o)continue;let u=l[1],c=t?ns:rs;if(Ni(u)<=c){if(!st(u,e.length))return NaN;if(t){let p=wh(e,u,r,n);if(isNaN(p)||p===0)return p;o=Math.min(o,p)}else for(let p=u[0];p<=u[1];++p){let f=Sh(e[p],r,n);if(o=Math.min(o,f),o===0)return 0}}else{let p=is(u,t);lu(a,o,n,e,s,p[0]),lu(a,o,n,e,s,p[1])}}return o}function $i(e,t,r,n,i,o=1/0){let a=Math.min(o,i.distance(e[0],r[0]));if(a===0)return a;let s=new Oi([[0,[0,e.length-1],[0,r.length-1]]],Fu);for(;s.length>0;){let l=s.pop();if(l[0]>=a)continue;let u=l[1],c=l[2],p=t?ns:rs,f=n?ns:rs;if(Ni(u)<=p&&Ni(c)<=f){if(!st(u,e.length)&&st(c,r.length))return NaN;let y;if(t&&n)y=vh(e,u,r,c,i),a=Math.min(a,y);else if(t&&!n){let m=e.slice(u[0],u[1]+1);for(let h=c[0];h<=c[1];++h)if(y=Bt(r[h],m,i),a=Math.min(a,y),a===0)return a}else if(!t&&n){let m=r.slice(c[0],c[1]+1);for(let h=u[0];h<=u[1];++h)if(y=Bt(e[h],m,i),a=Math.min(a,y),a===0)return a}else y=Ph(e,u,r,c,i),a=Math.min(a,y)}else{let y=is(u,t),m=is(c,n);ki(s,a,i,e,r,y[0],m[0]),ki(s,a,i,e,r,y[0],m[1]),ki(s,a,i,e,r,y[1],m[0]),ki(s,a,i,e,r,y[1],m[1])}}return a}function _h(e,t){let r=e.geometry(),n=r.flat().map(a=>cs([a.x,a.y],e.canonical));if(r.length===0)return NaN;let i=new nn(n[0][1]),o=1/0;for(let a of t){switch(a.type){case"Point":o=Math.min(o,$i(n,!1,[a.coordinates],!1,i,o));break;case"LineString":o=Math.min(o,$i(n,!1,a.coordinates,!0,i,o));break;case"Polygon":o=Math.min(o,Ui(n,!1,a.coordinates,i,o));break}if(o===0)return o}return o}function Ih(e,t){let r=e.geometry(),n=r.flat().map(a=>cs([a.x,a.y],e.canonical));if(r.length===0)return NaN;let i=new nn(n[0][1]),o=1/0;for(let a of t){switch(a.type){case"Point":o=Math.min(o,$i(n,!0,[a.coordinates],!1,i,o));break;case"LineString":o=Math.min(o,$i(n,!0,a.coordinates,!0,i,o));break;case"Polygon":o=Math.min(o,Ui(n,!0,a.coordinates,i,o));break}if(o===0)return o}return o}function Th(e,t){let r=e.geometry();if(r.length===0||r[0].length===0)return NaN;let n=dh(r,0).map(a=>a.map(s=>s.map(l=>cs([l.x,l.y],e.canonical)))),i=new nn(n[0][0][0][1]),o=1/0;for(let a of t)for(let s of n){switch(a.type){case"Point":o=Math.min(o,Ui([a.coordinates],!1,s,i,o));break;case"LineString":o=Math.min(o,Ui(a.coordinates,!0,s,i,o));break;case"Polygon":o=Math.min(o,Ah(s,a.coordinates,i,o));break}if(o===0)return o}return o}function Ga(e){return e.type==="MultiPolygon"?e.coordinates.map(t=>({type:"Polygon",coordinates:t})):e.type==="MultiLineString"?e.coordinates.map(t=>({type:"LineString",coordinates:t})):e.type==="MultiPoint"?e.coordinates.map(t=>({type:"Point",coordinates:t})):[e]}var on=class e{constructor(t,r){this.type=L,this.geojson=t,this.geometries=r}static parse(t,r){if(t.length!==2)return r.error(`\'distance\' expression requires exactly one argument, but found ${t.length-1} instead.`);if(Qr(t[1])){let n=t[1];if(n.type==="FeatureCollection")return new e(n,n.features.map(i=>Ga(i.geometry)).flat());if(n.type==="Feature")return new e(n,Ga(n.geometry));if("type"in n&&"coordinates"in n)return new e(n,Ga(n))}return r.error("\'distance\' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return _h(t,this.geometries);if(t.geometryType()==="LineString")return Ih(t,this.geometries);if(t.geometryType()==="Polygon")return Th(t,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}},Ut={"==":Zm,"!=":Wm,">":Xm,"<":Hm,">=":Ym,"<=":Km,array:je,at:Za,boolean:je,case:Ka,coalesce:zi,collator:Ri,format:en,image:es,in:Wa,"index-of":Ha,interpolate:Je,"interpolate-hcl":Je,"interpolate-lab":Je,length:ts,let:Di,literal:mt,match:Xa,number:je,"number-format":Qa,object:je,slice:Ya,step:pr,string:je,"to-boolean":yt,"to-color":yt,"to-number":yt,"to-string":yt,var:Vi,within:rn,distance:on},Ke=class e{constructor(t,r,n,i){this.name=t,this.type=r,this._evaluate=n,this.args=i}evaluate(t){return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}static parse(t,r){let n=t[0],i=e.definitions[n];if(!i)return r.error(`Unknown expression "${n}". If you wanted a literal array, use ["literal", [...]].`,0);let o=Array.isArray(i)?i[0]:i.type,a=Array.isArray(i)?[[i[1],i[2]]]:i.overloads,s=a.filter(([u])=>!Array.isArray(u)||u.length===t.length-1),l=null;for(let[u,c]of s){l=new Li(r.registry,Gi,r.path,null,r.scope);let p=[],f=!1;for(let y=1;y<t.length;y++){let m=t[y],h=Array.isArray(u)?u[y-1]:u.type,d=l.parse(m,1+p.length,h);if(!d){f=!0;break}p.push(d)}if(!f){if(Array.isArray(u)&&u.length!==p.length){l.error(`Expected ${u.length} arguments, but found ${p.length} instead.`);continue}for(let y=0;y<p.length;y++){let m=Array.isArray(u)?u[y]:u.type,h=p[y];l.concat(y+1).checkSubtype(m,h.type)}if(l.errors.length===0)return new e(n,o,c,p)}}if(s.length===1)r.errors.push(...l.errors);else{let c=(s.length?s:a).map(([f])=>kh(f)).join(" | "),p=[];for(let f=1;f<t.length;f++){let y=r.parse(t[f],1+p.length);if(!y)return null;p.push(te(y.type))}r.error(`Expected arguments of type ${c}, but found (${p.join(", ")}) instead.`)}return null}static register(t,r){e.definitions=r;for(let n in r)t[n]=e}};function uu(e,[t,r,n,i]){t=t.evaluate(e),r=r.evaluate(e),n=n.evaluate(e);let o=i?i.evaluate(e):1,a=Au(t,r,n,o);if(a)throw new ie(a);return new W(t/255,r/255,n/255,o,!1)}function cu(e,t){return e in t}function qa(e,t){let r=t[e];return typeof r>"u"?null:r}function Ch(e,t,r,n){for(;r<=n;){let i=r+n>>1;if(t[i]===e)return!0;t[i]>e?n=i-1:r=i+1}return!1}function Vt(e){return{type:e}}Ke.register(Ut,{error:[gm,[G],(e,[t])=>{throw new ie(t.evaluate(e))}],typeof:[G,[$],(e,[t])=>te(ue(t.evaluate(e)))],"to-rgba":[Ee(L,4),[Re],(e,[t])=>{let[r,n,i,o]=t.evaluate(e).rgb;return[r*255,n*255,i*255,o]}],rgb:[Re,[L,L,L],uu],rgba:[Re,[L,L,L,L],uu],has:{type:U,overloads:[[[G],(e,[t])=>cu(t.evaluate(e),e.properties())],[[G,lr],(e,[t,r])=>cu(t.evaluate(e),r.evaluate(e))]]},get:{type:$,overloads:[[[G],(e,[t])=>qa(t.evaluate(e),e.properties())],[[G,lr],(e,[t,r])=>qa(t.evaluate(e),r.evaluate(e))]]},"feature-state":[$,[G],(e,[t])=>qa(t.evaluate(e),e.featureState||{})],properties:[lr,[],e=>e.properties()],"geometry-type":[G,[],e=>e.geometryType()],id:[$,[],e=>e.id()],zoom:[L,[],e=>e.globals.zoom],"heatmap-density":[L,[],e=>e.globals.heatmapDensity||0],"line-progress":[L,[],e=>e.globals.lineProgress||0],accumulated:[$,[],e=>e.globals.accumulated===void 0?null:e.globals.accumulated],"+":[L,Vt(L),(e,t)=>{let r=0;for(let n of t)r+=n.evaluate(e);return r}],"*":[L,Vt(L),(e,t)=>{let r=1;for(let n of t)r*=n.evaluate(e);return r}],"-":{type:L,overloads:[[[L,L],(e,[t,r])=>t.evaluate(e)-r.evaluate(e)],[[L],(e,[t])=>-t.evaluate(e)]]},"/":[L,[L,L],(e,[t,r])=>t.evaluate(e)/r.evaluate(e)],"%":[L,[L,L],(e,[t,r])=>t.evaluate(e)%r.evaluate(e)],ln2:[L,[],()=>Math.LN2],pi:[L,[],()=>Math.PI],e:[L,[],()=>Math.E],"^":[L,[L,L],(e,[t,r])=>Math.pow(t.evaluate(e),r.evaluate(e))],sqrt:[L,[L],(e,[t])=>Math.sqrt(t.evaluate(e))],log10:[L,[L],(e,[t])=>Math.log(t.evaluate(e))/Math.LN10],ln:[L,[L],(e,[t])=>Math.log(t.evaluate(e))],log2:[L,[L],(e,[t])=>Math.log(t.evaluate(e))/Math.LN2],sin:[L,[L],(e,[t])=>Math.sin(t.evaluate(e))],cos:[L,[L],(e,[t])=>Math.cos(t.evaluate(e))],tan:[L,[L],(e,[t])=>Math.tan(t.evaluate(e))],asin:[L,[L],(e,[t])=>Math.asin(t.evaluate(e))],acos:[L,[L],(e,[t])=>Math.acos(t.evaluate(e))],atan:[L,[L],(e,[t])=>Math.atan(t.evaluate(e))],min:[L,Vt(L),(e,t)=>Math.min(...t.map(r=>r.evaluate(e)))],max:[L,Vt(L),(e,t)=>Math.max(...t.map(r=>r.evaluate(e)))],abs:[L,[L],(e,[t])=>Math.abs(t.evaluate(e))],round:[L,[L],(e,[t])=>{let r=t.evaluate(e);return r<0?-Math.round(-r):Math.round(r)}],floor:[L,[L],(e,[t])=>Math.floor(t.evaluate(e))],ceil:[L,[L],(e,[t])=>Math.ceil(t.evaluate(e))],"filter-==":[U,[G,$],(e,[t,r])=>e.properties()[t.value]===r.value],"filter-id-==":[U,[$],(e,[t])=>e.id()===t.value],"filter-type-==":[U,[G],(e,[t])=>e.geometryType()===t.value],"filter-<":[U,[G,$],(e,[t,r])=>{let n=e.properties()[t.value],i=r.value;return typeof n==typeof i&&n<i}],"filter-id-<":[U,[$],(e,[t])=>{let r=e.id(),n=t.value;return typeof r==typeof n&&r<n}],"filter->":[U,[G,$],(e,[t,r])=>{let n=e.properties()[t.value],i=r.value;return typeof n==typeof i&&n>i}],"filter-id->":[U,[$],(e,[t])=>{let r=e.id(),n=t.value;return typeof r==typeof n&&r>n}],"filter-<=":[U,[G,$],(e,[t,r])=>{let n=e.properties()[t.value],i=r.value;return typeof n==typeof i&&n<=i}],"filter-id-<=":[U,[$],(e,[t])=>{let r=e.id(),n=t.value;return typeof r==typeof n&&r<=n}],"filter->=":[U,[G,$],(e,[t,r])=>{let n=e.properties()[t.value],i=r.value;return typeof n==typeof i&&n>=i}],"filter-id->=":[U,[$],(e,[t])=>{let r=e.id(),n=t.value;return typeof r==typeof n&&r>=n}],"filter-has":[U,[$],(e,[t])=>t.value in e.properties()],"filter-has-id":[U,[],e=>e.id()!==null&&e.id()!==void 0],"filter-type-in":[U,[Ee(G)],(e,[t])=>t.value.indexOf(e.geometryType())>=0],"filter-id-in":[U,[Ee($)],(e,[t])=>t.value.indexOf(e.id())>=0],"filter-in-small":[U,[G,Ee($)],(e,[t,r])=>r.value.indexOf(e.properties()[t.value])>=0],"filter-in-large":[U,[G,Ee($)],(e,[t,r])=>Ch(e.properties()[t.value],r.value,0,r.value.length-1)],all:{type:U,overloads:[[[U,U],(e,[t,r])=>t.evaluate(e)&&r.evaluate(e)],[Vt(U),(e,t)=>{for(let r of t)if(!r.evaluate(e))return!1;return!0}]]},any:{type:U,overloads:[[[U,U],(e,[t,r])=>t.evaluate(e)||r.evaluate(e)],[Vt(U),(e,t)=>{for(let r of t)if(r.evaluate(e))return!0;return!1}]]},"!":[U,[U],(e,[t])=>!t.evaluate(e)],"is-supported-script":[U,[G],(e,[t])=>{let r=e.globals&&e.globals.isSupportedScript;return r?r(t.evaluate(e)):!0}],upcase:[G,[G],(e,[t])=>t.evaluate(e).toUpperCase()],downcase:[G,[G],(e,[t])=>t.evaluate(e).toLowerCase()],concat:[G,Vt($),(e,t)=>t.map(r=>Zr(r.evaluate(e))).join("")],"resolved-locale":[G,[ji],(e,[t])=>t.evaluate(e).resolvedLocale()]});function kh(e){return Array.isArray(e)?`(${e.map(te).join(", ")})`:`(${te(e.type)}...)`}function Gi(e){if(e instanceof Vi)return Gi(e.boundExpression);if(e instanceof Ke&&e.name==="error")return!1;if(e instanceof Ri)return!1;if(e instanceof rn)return!1;if(e instanceof on)return!1;let t=e instanceof yt||e instanceof je,r=!0;return e.eachChild(n=>{t?r=r&&Gi(n):r=r&&n instanceof mt}),r?Xi(e)&&Ki(e,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"]):!1}function Xi(e){if(e instanceof Ke){if(e.name==="get"&&e.args.length===1)return!1;if(e.name==="feature-state")return!1;if(e.name==="has"&&e.args.length===1)return!1;if(e.name==="properties"||e.name==="geometry-type"||e.name==="id")return!1;if(/^filter-/.test(e.name))return!1}if(e instanceof rn||e instanceof on)return!1;let t=!0;return e.eachChild(r=>{t&&!Xi(r)&&(t=!1)}),t}function an(e){if(e instanceof Ke&&e.name==="feature-state")return!1;let t=!0;return e.eachChild(r=>{t&&!an(r)&&(t=!1)}),t}function Ki(e,t){if(e instanceof Ke&&t.indexOf(e.name)>=0)return!1;let r=!0;return e.eachChild(n=>{r&&!Ki(n,t)&&(r=!1)}),r}function ss(e){return{result:"success",value:e}}function sr(e){return{result:"error",value:e}}function ht(e){return e["property-type"]==="data-driven"||e["property-type"]==="cross-faded-data-driven"}function Lu(e){return!!e.expression&&e.expression.parameters.indexOf("zoom")>-1}function ms(e){return!!e.expression&&e.expression.interpolated}function j(e){return e instanceof Number?"number":e instanceof String?"string":e instanceof Boolean?"boolean":Array.isArray(e)?"array":e===null?"null":typeof e}function Yi(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)}function Mh(e){return e}function Du(e,t){let r=t.type==="color",n=e.stops&&typeof e.stops[0][0]=="object",i=n||e.property!==void 0,o=n||!i,a=e.type||(ms(t)?"exponential":"interval");if(r||t.type==="padding"){let c=r?W.parse:Ze.parse;e=cr({},e),e.stops&&(e.stops=e.stops.map(p=>[p[0],c(p[1])])),e.default?e.default=c(e.default):e.default=c(t.default)}if(e.colorSpace&&!Fm(e.colorSpace))throw new Error(`Unknown color space: "${e.colorSpace}"`);let s,l,u;if(a==="exponential")s=pu;else if(a==="interval")s=Fh;else if(a==="categorical"){s=Eh,l=Object.create(null);for(let c of e.stops)l[c[0]]=c[1];u=typeof e.stops[0][0]}else if(a==="identity")s=Lh;else throw new Error(`Unknown function type "${a}"`);if(n){let c={},p=[];for(let m=0;m<e.stops.length;m++){let h=e.stops[m],d=h[0].zoom;c[d]===void 0&&(c[d]={zoom:d,type:e.type,property:e.property,default:e.default,stops:[]},p.push(d)),c[d].stops.push([h[0].value,h[1]])}let f=[];for(let m of p)f.push([c[m].zoom,Du(c[m],t)]);let y={name:"linear"};return{kind:"composite",interpolationType:y,interpolationFactor:Je.interpolationFactor.bind(void 0,y),zoomStops:f.map(m=>m[0]),evaluate({zoom:m},h){return pu({stops:f,base:e.base},t,m).evaluate(m,h)}}}else if(o){let c=a==="exponential"?{name:"exponential",base:e.base!==void 0?e.base:1}:null;return{kind:"camera",interpolationType:c,interpolationFactor:Je.interpolationFactor.bind(void 0,c),zoomStops:e.stops.map(p=>p[0]),evaluate:({zoom:p})=>s(e,t,p,l,u)}}else return{kind:"source",evaluate(c,p){let f=p&&p.properties?p.properties[e.property]:void 0;return f===void 0?pn(e.default,t.default):s(e,t,f,l,u)}}}function pn(e,t,r){if(e!==void 0)return e;if(t!==void 0)return t;if(r!==void 0)return r}function Eh(e,t,r,n,i){let o=typeof r===i?n[r]:void 0;return pn(o,e.default,t.default)}function Fh(e,t,r){if(j(r)!=="number")return pn(e.default,t.default);let n=e.stops.length;if(n===1||r<=e.stops[0][0])return e.stops[0][1];if(r>=e.stops[n-1][0])return e.stops[n-1][1];let i=Wi(e.stops.map(o=>o[0]),r);return e.stops[i][1]}function pu(e,t,r){let n=e.base!==void 0?e.base:1;if(j(r)!=="number")return pn(e.default,t.default);let i=e.stops.length;if(i===1||r<=e.stops[0][0])return e.stops[0][1];if(r>=e.stops[i-1][0])return e.stops[i-1][1];let o=Wi(e.stops.map(c=>c[0]),r),a=Dh(r,n,e.stops[o][0],e.stops[o+1][0]),s=e.stops[o][1],l=e.stops[o+1][1],u=Oe[t.type]||Mh;return typeof s.evaluate=="function"?{evaluate(...c){let p=s.evaluate.apply(void 0,c),f=l.evaluate.apply(void 0,c);if(!(p===void 0||f===void 0))return u(p,f,a,e.colorSpace)}}:u(s,l,a,e.colorSpace)}function Lh(e,t,r){switch(t.type){case"color":r=W.parse(r);break;case"formatted":r=Fe.fromString(r.toString());break;case"resolvedImage":r=Te.fromString(r.toString());break;case"padding":r=Ze.parse(r);break;default:j(r)!==t.type&&(t.type!=="enum"||!t.values[r])&&(r=void 0)}return pn(r,e.default,t.default)}function Dh(e,t,r,n){let i=n-r,o=e-r;return i===0?0:t===1?o/i:(Math.pow(t,o)-1)/(Math.pow(t,i)-1)}var Rt=class{constructor(t,r){this.expression=t,this._warningHistory={},this._evaluator=new Fi,this._defaultValue=r?Bh(r):null,this._enumValues=r&&r.type==="enum"?r.values:null}evaluateWithoutErrorHandling(t,r,n,i,o,a){return this._evaluator.globals=t,this._evaluator.feature=r,this._evaluator.featureState=n,this._evaluator.canonical=i,this._evaluator.availableImages=o||null,this._evaluator.formattedSection=a,this.expression.evaluate(this._evaluator)}evaluate(t,r,n,i,o,a){this._evaluator.globals=t,this._evaluator.feature=r||null,this._evaluator.featureState=n||null,this._evaluator.canonical=i,this._evaluator.availableImages=o||null,this._evaluator.formattedSection=a||null;try{let s=this.expression.evaluate(this._evaluator);if(s==null||typeof s=="number"&&s!==s)return this._defaultValue;if(this._enumValues&&!(s in this._enumValues))throw new ie(`Expected value to be one of ${Object.keys(this._enumValues).map(l=>JSON.stringify(l)).join(", ")}, but found ${JSON.stringify(s)} instead.`);return s}catch(s){return this._warningHistory[s.message]||(this._warningHistory[s.message]=!0,typeof console<"u"&&console.warn(s.message)),this._defaultValue}}};function $t(e){return Array.isArray(e)&&e.length>0&&typeof e[0]=="string"&&e[0]in Ut}function Gt(e,t){let r=new Li(Ut,Gi,[],t?Vh(t):void 0),n=r.parse(e,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return n?ss(new Rt(n,t)):sr(r.errors)}var dt=class{constructor(t,r){this.kind=t,this._styleExpression=r,this.isStateDependent=t!=="constant"&&!an(r.expression)}evaluateWithoutErrorHandling(t,r,n,i,o,a){return this._styleExpression.evaluateWithoutErrorHandling(t,r,n,i,o,a)}evaluate(t,r,n,i,o,a){return this._styleExpression.evaluate(t,r,n,i,o,a)}},gt=class{constructor(t,r,n,i){this.kind=t,this.zoomStops=n,this._styleExpression=r,this.isStateDependent=t!=="camera"&&!an(r.expression),this.interpolationType=i}evaluateWithoutErrorHandling(t,r,n,i,o,a){return this._styleExpression.evaluateWithoutErrorHandling(t,r,n,i,o,a)}evaluate(t,r,n,i,o,a){return this._styleExpression.evaluate(t,r,n,i,o,a)}interpolationFactor(t,r,n){return this.interpolationType?Je.interpolationFactor(this.interpolationType,t,r,n):0}};function Vu(e,t){let r=Gt(e,t);if(r.result==="error")return r;let n=r.value.expression,i=Xi(n);if(!i&&!ht(t))return sr([new Be("","data expressions not supported")]);let o=Ki(n,["zoom"]);if(!o&&!Lu(t))return sr([new Be("","zoom expressions not supported")]);let a=Ei(n);if(!a&&!o)return sr([new Be("",\'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.\')]);if(a instanceof Be)return sr([a]);if(a instanceof Je&&!ms(t))return sr([new Be("",\'"interpolate" expressions cannot be used with this property\')]);if(!a)return ss(i?new dt("constant",r.value):new dt("source",r.value));let s=a instanceof Je?a.interpolation:void 0;return ss(i?new gt("camera",r.value,a.labels,s):new gt("composite",r.value,a.labels,s))}var sn=class e{constructor(t,r){this._parameters=t,this._specification=r,cr(this,Du(this._parameters,this._specification))}static deserialize(t){return new e(t._parameters,t._specification)}static serialize(t){return{_parameters:t._parameters,_specification:t._specification}}};function Bu(e,t){if(Yi(e))return new sn(e,t);if($t(e)){let r=Vu(e,t);if(r.result==="error")throw new Error(r.value.map(n=>`${n.key}: ${n.message}`).join(", "));return r.value}else{let r=e;return t.type==="color"&&typeof e=="string"?r=W.parse(e):t.type==="padding"&&(typeof e=="number"||Array.isArray(e))?r=Ze.parse(e):t.type==="variableAnchorOffsetCollection"&&Array.isArray(e)&&(r=Ne.parse(e)),{kind:"constant",evaluate:()=>r}}}function Ei(e){let t=null;if(e instanceof Di)t=Ei(e.result);else if(e instanceof zi){for(let r of e.args)if(t=Ei(r),t)break}else(e instanceof pr||e instanceof Je)&&e.input instanceof Ke&&e.input.name==="zoom"&&(t=e);return t instanceof Be||e.eachChild(r=>{let n=Ei(r);n instanceof Be?t=n:!t&&n?t=new Be("",\'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.\'):t&&n&&t!==n&&(t=new Be("",\'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.\'))}),t}function Vh(e){let t={color:Re,string:G,number:L,enum:G,boolean:U,formatted:mr,padding:Ji,resolvedImage:un,variableAnchorOffsetCollection:Zi};return e.type==="array"?Ee(t[e.value]||$,e.length):t[e.type]}function Bh(e){return e.type==="color"&&Yi(e.default)?new W(0,0,0,0):e.type==="color"?W.parse(e.default)||null:e.type==="padding"?Ze.parse(e.default)||null:e.type==="variableAnchorOffsetCollection"?Ne.parse(e.default)||null:e.default===void 0?null:e.default}function hs(e){if(e===!0||e===!1)return!0;if(!Array.isArray(e)||e.length===0)return!1;switch(e[0]){case"has":return e.length>=2&&e[1]!=="$id"&&e[1]!=="$type";case"in":return e.length>=3&&(typeof e[1]!="string"||Array.isArray(e[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return e.length!==3||Array.isArray(e[1])||Array.isArray(e[2]);case"any":case"all":for(let t of e.slice(1))if(!hs(t)&&typeof t!="boolean")return!1;return!0;default:return!0}}var zh={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function fn(e){if(e==null)return{filter:()=>!0,needGeometry:!1};hs(e)||(e=qi(e));let t=Gt(e,zh);if(t.result==="error")throw new Error(t.value.map(r=>`${r.key}: ${r.message}`).join(", "));{let r=zu(e);return{filter:(n,i,o)=>t.value.evaluate(n,i,{},o),needGeometry:r}}}function Rh(e,t){return e<t?-1:e>t?1:0}function zu(e){if(!Array.isArray(e))return!1;if(e[0]==="within"||e[0]==="distance")return!0;for(let t=1;t<e.length;t++)if(zu(e[t]))return!0;return!1}function qi(e){if(!e)return!0;let t=e[0];return e.length<=1?t!=="any":t==="=="?ja(e[1],e[2],"=="):t==="!="?Mi(ja(e[1],e[2],"==")):t==="<"||t===">"||t==="<="||t===">="?ja(e[1],e[2],t):t==="any"?Oh(e.slice(1)):t==="all"?["all"].concat(e.slice(1).map(qi)):t==="none"?["all"].concat(e.slice(1).map(qi).map(Mi)):t==="in"?fu(e[1],e.slice(2)):t==="!in"?Mi(fu(e[1],e.slice(2))):t==="has"?yu(e[1]):t==="!has"?Mi(yu(e[1])):!0}function ja(e,t,r){switch(e){case"$type":return[`filter-type-${r}`,t];case"$id":return[`filter-id-${r}`,t];default:return[`filter-${r}`,e,t]}}function Oh(e){return["any"].concat(e.map(qi))}function fu(e,t){if(t.length===0)return!1;switch(e){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(r=>typeof r!=typeof t[0])?["filter-in-large",e,["literal",t.sort(Rh)]]:["filter-in-small",e,["literal",t]]}}function yu(e){switch(e){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",e]}}function Mi(e){return["!",e]}function ls(e){let t=typeof e;if(t==="number"||t==="boolean"||t==="string"||e===void 0||e===null)return JSON.stringify(e);if(Array.isArray(e)){let i="[";for(let o of e)i+=`${ls(o)},`;return`${i}]`}let r=Object.keys(e).sort(),n="{";for(let i=0;i<r.length;i++)n+=`${JSON.stringify(r[i])}:${ls(e[r[i]])},`;return`${n}}`}function Nh(e){let t="";for(let r of dm)t+=`/${ls(e[r])}`;return t}function Ru(e,t){let r={};for(let i=0;i<e.length;i++){let o=t&&t[e[i].id]||Nh(e[i]);t&&(t[e[i].id]=o);let a=r[o];a||(a=r[o]=[]),a.push(e[i])}let n=[];for(let i in r)n.push(r[i]);return n}function Ou(e){let t=e.key,r=e.value;return r?[new M(t,r,"constants have been deprecated as of v8")]:[]}function ae(e){return e instanceof Number||e instanceof String||e instanceof Boolean?e.valueOf():e}function Ot(e){if(Array.isArray(e))return e.map(Ot);if(e instanceof Object&&!(e instanceof Number||e instanceof String||e instanceof Boolean)){let t={};for(let r in e)t[r]=Ot(e[r]);return t}return ae(e)}function ze(e){let t=e.key,r=e.value,n=e.valueSpec||{},i=e.objectElementValidators||{},o=e.style,a=e.styleSpec,s=e.validateSpec,l=[],u=j(r);if(u!=="object")return[new M(t,r,`object expected, ${u} found`)];for(let c in r){let p=c.split(".")[0],f=n[p]||n["*"],y;if(i[p])y=i[p];else if(n[p])y=s;else if(i["*"])y=i["*"];else if(n["*"])y=s;else{l.push(new M(t,r[c],`unknown property "${c}"`));continue}l=l.concat(y({key:(t&&`${t}.`)+c,value:r[c],valueSpec:f,style:o,styleSpec:a,object:r,objectKey:c,validateSpec:s},r))}for(let c in n)i[c]||n[c].required&&n[c].default===void 0&&r[c]===void 0&&l.push(new M(t,r,`missing required property "${c}"`));return l}function ds(e){let t=e.value,r=e.valueSpec,n=e.validateSpec,i=e.style,o=e.styleSpec,a=e.key,s=e.arrayElementValidator||n;if(j(t)!=="array")return[new M(a,t,`array expected, ${j(t)} found`)];if(r.length&&t.length!==r.length)return[new M(a,t,`array length ${r.length} expected, length ${t.length} found`)];if(r["min-length"]&&t.length<r["min-length"])return[new M(a,t,`array length at least ${r["min-length"]} expected, length ${t.length} found`)];let l={type:r.value,values:r.values};o.$version<7&&(l.function=r.function),j(r.value)==="object"&&(l=r.value);let u=[];for(let c=0;c<t.length;c++)u=u.concat(s({array:t,arrayIndex:c,value:t[c],valueSpec:l,validateSpec:e.validateSpec,style:i,styleSpec:o,key:`${a}[${c}]`}));return u}function gs(e){let t=e.key,r=e.value,n=e.valueSpec,i=j(r);return i==="number"&&r!==r&&(i="NaN"),i!=="number"?[new M(t,r,`number expected, ${i} found`)]:"minimum"in n&&r<n.minimum?[new M(t,r,`${r} is less than the minimum value ${n.minimum}`)]:"maximum"in n&&r>n.maximum?[new M(t,r,`${r} is greater than the maximum value ${n.maximum}`)]:[]}function Nu(e){let t=e.valueSpec,r=ae(e.value.type),n,i={},o,a,s=r!=="categorical"&&e.value.property===void 0,l=!s,u=j(e.value.stops)==="array"&&j(e.value.stops[0])==="array"&&j(e.value.stops[0][0])==="object",c=ze({key:e.key,value:e.value,valueSpec:e.styleSpec.function,validateSpec:e.validateSpec,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{stops:p,default:m}});return r==="identity"&&s&&c.push(new M(e.key,e.value,\'missing required property "property"\')),r!=="identity"&&!e.value.stops&&c.push(new M(e.key,e.value,\'missing required property "stops"\')),r==="exponential"&&e.valueSpec.expression&&!ms(e.valueSpec)&&c.push(new M(e.key,e.value,"exponential functions not supported")),e.styleSpec.$version>=8&&(l&&!ht(e.valueSpec)?c.push(new M(e.key,e.value,"property functions not supported")):s&&!Lu(e.valueSpec)&&c.push(new M(e.key,e.value,"zoom functions not supported"))),(r==="categorical"||u)&&e.value.property===void 0&&c.push(new M(e.key,e.value,\'"property" property is required\')),c;function p(h){if(r==="identity")return[new M(h.key,h.value,\'identity function may not have a "stops" property\')];let d=[],g=h.value;return d=d.concat(ds({key:h.key,value:g,valueSpec:h.valueSpec,validateSpec:h.validateSpec,style:h.style,styleSpec:h.styleSpec,arrayElementValidator:f})),j(g)==="array"&&g.length===0&&d.push(new M(h.key,g,"array must have at least one stop")),d}function f(h){let d=[],g=h.value,b=h.key;if(j(g)!=="array")return[new M(b,g,`array expected, ${j(g)} found`)];if(g.length!==2)return[new M(b,g,`array length 2 expected, length ${g.length} found`)];if(u){if(j(g[0])!=="object")return[new M(b,g,`object expected, ${j(g[0])} found`)];if(g[0].zoom===void 0)return[new M(b,g,"object stop key must have zoom")];if(g[0].value===void 0)return[new M(b,g,"object stop key must have value")];if(a&&a>ae(g[0].zoom))return[new M(b,g[0].zoom,"stop zoom values must appear in ascending order")];ae(g[0].zoom)!==a&&(a=ae(g[0].zoom),o=void 0,i={}),d=d.concat(ze({key:`${b}[0]`,value:g[0],valueSpec:{zoom:{}},validateSpec:h.validateSpec,style:h.style,styleSpec:h.styleSpec,objectElementValidators:{zoom:gs,value:y}}))}else d=d.concat(y({key:`${b}[0]`,value:g[0],valueSpec:{},validateSpec:h.validateSpec,style:h.style,styleSpec:h.styleSpec},g));return $t(Ot(g[1]))?d.concat([new M(`${b}[1]`,g[1],"expressions are not allowed in function stops.")]):d.concat(h.validateSpec({key:`${b}[1]`,value:g[1],valueSpec:t,validateSpec:h.validateSpec,style:h.style,styleSpec:h.styleSpec}))}function y(h,d){let g=j(h.value),b=ae(h.value),x=h.value!==null?h.value:d;if(!n)n=g;else if(g!==n)return[new M(h.key,x,`${g} stop domain type must match previous stop domain type ${n}`)];if(g!=="number"&&g!=="string"&&g!=="boolean")return[new M(h.key,x,"stop domain value must be a number, string, or boolean")];if(g!=="number"&&r!=="categorical"){let v=`number expected, ${g} found`;return ht(t)&&r===void 0&&(v+=\'\\nIf you intended to use a categorical function, specify `"type": "categorical"`.\'),[new M(h.key,x,v)]}return r==="categorical"&&g==="number"&&(!isFinite(b)||Math.floor(b)!==b)?[new M(h.key,x,`integer expected, found ${b}`)]:r!=="categorical"&&g==="number"&&o!==void 0&&b<o?[new M(h.key,x,"stop domain values must appear in ascending order")]:(o=b,r==="categorical"&&b in i?[new M(h.key,x,"stop domain values must be unique")]:(i[b]=!0,[]))}function m(h){return h.validateSpec({key:h.key,value:h.value,valueSpec:t,validateSpec:h.validateSpec,style:h.style,styleSpec:h.styleSpec})}}function fr(e){let t=(e.expressionContext==="property"?Vu:Gt)(Ot(e.value),e.valueSpec);if(t.result==="error")return t.value.map(n=>new M(`${e.key}${n.key}`,e.value,n.message));let r=t.value.expression||t.value._styleExpression.expression;if(e.expressionContext==="property"&&e.propertyKey==="text-font"&&!r.outputDefined())return[new M(e.key,e.value,`Invalid data expression for "${e.propertyKey}". Output values must be contained as literals within the expression.`)];if(e.expressionContext==="property"&&e.propertyType==="layout"&&!an(r))return[new M(e.key,e.value,\'"feature-state" data expressions are not supported with layout properties.\')];if(e.expressionContext==="filter"&&!an(r))return[new M(e.key,e.value,\'"feature-state" data expressions are not supported with filters.\')];if(e.expressionContext&&e.expressionContext.indexOf("cluster")===0){if(!Ki(r,["zoom","feature-state"]))return[new M(e.key,e.value,\'"zoom" and "feature-state" expressions are not supported with cluster properties.\')];if(e.expressionContext==="cluster-initial"&&!Xi(r))return[new M(e.key,e.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Uh(e){let t=e.value,r=e.key,n=j(t);return n!=="boolean"?[new M(r,t,`boolean expected, ${n} found`)]:[]}function $h(e){let t=e.key,r=e.value,n=j(r);return n!=="string"?[new M(t,r,`color expected, ${n} found`)]:W.parse(String(r))?[]:[new M(t,r,`color expected, "${r}" found`)]}function ln(e){let t=e.key,r=e.value,n=e.valueSpec,i=[];return Array.isArray(n.values)?n.values.indexOf(ae(r))===-1&&i.push(new M(t,r,`expected one of [${n.values.join(", ")}], ${JSON.stringify(r)} found`)):Object.keys(n.values).indexOf(ae(r))===-1&&i.push(new M(t,r,`expected one of [${Object.keys(n.values).join(", ")}], ${JSON.stringify(r)} found`)),i}function xs(e){return hs(Ot(e.value))?fr(cr({},e,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Uu(e)}function Uu(e){let t=e.value,r=e.key;if(j(t)!=="array")return[new M(r,t,`array expected, ${j(t)} found`)];let n=e.styleSpec,i,o=[];if(t.length<1)return[new M(r,t,"filter array must have at least 1 element")];switch(o=o.concat(ln({key:`${r}[0]`,value:t[0],valueSpec:n.filter_operator,style:e.style,styleSpec:e.styleSpec})),ae(t[0])){case"<":case"<=":case">":case">=":t.length>=2&&ae(t[1])==="$type"&&o.push(new M(r,t,`"$type" cannot be use with operator "${t[0]}"`));case"==":case"!=":t.length!==3&&o.push(new M(r,t,`filter array for operator "${t[0]}" must have 3 elements`));case"in":case"!in":t.length>=2&&(i=j(t[1]),i!=="string"&&o.push(new M(`${r}[1]`,t[1],`string expected, ${i} found`)));for(let a=2;a<t.length;a++)i=j(t[a]),ae(t[1])==="$type"?o=o.concat(ln({key:`${r}[${a}]`,value:t[a],valueSpec:n.geometry_type,style:e.style,styleSpec:e.styleSpec})):i!=="string"&&i!=="number"&&i!=="boolean"&&o.push(new M(`${r}[${a}]`,t[a],`string, number, or boolean expected, ${i} found`));break;case"any":case"all":case"none":for(let a=1;a<t.length;a++)o=o.concat(Uu({key:`${r}[${a}]`,value:t[a],style:e.style,styleSpec:e.styleSpec}));break;case"has":case"!has":i=j(t[1]),t.length!==2?o.push(new M(r,t,`filter array for "${t[0]}" operator must have 2 elements`)):i!=="string"&&o.push(new M(`${r}[1]`,t[1],`string expected, ${i} found`));break}return o}function $u(e,t){let r=e.key,n=e.validateSpec,i=e.style,o=e.styleSpec,a=e.value,s=e.objectKey,l=o[`${t}_${e.layerType}`];if(!l)return[];let u=s.match(/^(.*)-transition$/);if(t==="paint"&&u&&l[u[1]]&&l[u[1]].transition)return n({key:r,value:a,valueSpec:o.transition,style:i,styleSpec:o});let c=e.valueSpec||l[s];if(!c)return[new M(r,a,`unknown property "${s}"`)];let p;if(j(a)==="string"&&ht(c)&&!c.tokens&&(p=/^{([^}]+)}$/.exec(a)))return[new M(r,a,`"${s}" does not support interpolation syntax\nUse an identity property function instead: \\`{ "type": "identity", "property": ${JSON.stringify(p[1])} }\\`.`)];let f=[];return e.layerType==="symbol"&&(s==="text-field"&&i&&!i.glyphs&&f.push(new M(r,a,\'use of "text-field" requires a style "glyphs" property\')),s==="text-font"&&Yi(Ot(a))&&ae(a.type)==="identity"&&f.push(new M(r,a,\'"text-font" does not support identity functions\'))),f.concat(n({key:e.key,value:a,valueSpec:c,style:i,styleSpec:o,expressionContext:"property",propertyType:t,propertyKey:s}))}function Gu(e){return $u(e,"paint")}function qu(e){return $u(e,"layout")}function ju(e){let t=[],r=e.value,n=e.key,i=e.style,o=e.styleSpec;!r.type&&!r.ref&&t.push(new M(n,r,\'either "type" or "ref" is required\'));let a=ae(r.type),s=ae(r.ref);if(r.id){let l=ae(r.id);for(let u=0;u<e.arrayIndex;u++){let c=i.layers[u];ae(c.id)===l&&t.push(new M(n,r.id,`duplicate layer id "${r.id}", previously used at line ${c.id.__line__}`))}}if("ref"in r){["type","source","source-layer","filter","layout"].forEach(u=>{u in r&&t.push(new M(n,r[u],`"${u}" is prohibited for ref layers`))});let l;i.layers.forEach(u=>{ae(u.id)===s&&(l=u)}),l?l.ref?t.push(new M(n,r.ref,"ref cannot reference another ref layer")):a=ae(l.type):t.push(new M(n,r.ref,`ref layer "${s}" not found`))}else if(a!=="background")if(!r.source)t.push(new M(n,r,\'missing required property "source"\'));else{let l=i.sources&&i.sources[r.source],u=l&&ae(l.type);l?u==="vector"&&a==="raster"?t.push(new M(n,r.source,`layer "${r.id}" requires a raster source`)):u!=="raster-dem"&&a==="hillshade"?t.push(new M(n,r.source,`layer "${r.id}" requires a raster-dem source`)):u==="raster"&&a!=="raster"?t.push(new M(n,r.source,`layer "${r.id}" requires a vector source`)):u==="vector"&&!r["source-layer"]?t.push(new M(n,r,`layer "${r.id}" must specify a "source-layer"`)):u==="raster-dem"&&a!=="hillshade"?t.push(new M(n,r.source,"raster-dem source can only be used with layer type \'hillshade\'.")):a==="line"&&r.paint&&r.paint["line-gradient"]&&(u!=="geojson"||!l.lineMetrics)&&t.push(new M(n,r,`layer "${r.id}" specifies a line-gradient, which requires a GeoJSON source with \\`lineMetrics\\` enabled.`)):t.push(new M(n,r.source,`source "${r.source}" not found`))}return t=t.concat(ze({key:n,value:r,valueSpec:o.layer,style:e.style,styleSpec:e.styleSpec,validateSpec:e.validateSpec,objectElementValidators:{"*"(){return[]},type(){return e.validateSpec({key:`${n}.type`,value:r.type,valueSpec:o.layer.type,style:e.style,styleSpec:e.styleSpec,validateSpec:e.validateSpec,object:r,objectKey:"type"})},filter:xs,layout(l){return ze({layer:r,key:l.key,value:l.value,style:l.style,styleSpec:l.styleSpec,validateSpec:l.validateSpec,objectElementValidators:{"*"(u){return qu(cr({layerType:a},u))}}})},paint(l){return ze({layer:r,key:l.key,value:l.value,style:l.style,styleSpec:l.styleSpec,validateSpec:l.validateSpec,objectElementValidators:{"*"(u){return Gu(cr({layerType:a},u))}}})}}})),t}function Nt(e){let t=e.value,r=e.key,n=j(t);return n!=="string"?[new M(r,t,`string expected, ${n} found`)]:[]}function Gh(e){var t;let r=(t=e.sourceName)!==null&&t!==void 0?t:"",n=e.value,i=e.styleSpec,o=i.source_raster_dem,a=e.style,s=[],l=j(n);if(n===void 0)return s;if(l!=="object")return s.push(new M("source_raster_dem",n,`object expected, ${l} found`)),s;let c=ae(n.encoding)==="custom",p=["redFactor","greenFactor","blueFactor","baseShift"],f=e.value.encoding?`"${e.value.encoding}"`:"Default";for(let y in n)!c&&p.includes(y)?s.push(new M(y,n[y],`In "${r}": "${y}" is only valid when "encoding" is set to "custom". ${f} encoding found`)):o[y]?s=s.concat(e.validateSpec({key:y,value:n[y],valueSpec:o[y],validateSpec:e.validateSpec,style:a,styleSpec:i})):s.push(new M(y,n[y],`unknown property "${y}"`));return s}var mu={promoteId:qh};function Ju(e){let t=e.value,r=e.key,n=e.styleSpec,i=e.style,o=e.validateSpec;if(!t.type)return[new M(r,t,\'"type" is required\')];let a=ae(t.type),s;switch(a){case"vector":case"raster":return s=ze({key:r,value:t,valueSpec:n[`source_${a.replace("-","_")}`],style:e.style,styleSpec:n,objectElementValidators:mu,validateSpec:o}),s;case"raster-dem":return s=Gh({sourceName:r,value:t,style:e.style,styleSpec:n,validateSpec:o}),s;case"geojson":if(s=ze({key:r,value:t,valueSpec:n.source_geojson,style:i,styleSpec:n,validateSpec:o,objectElementValidators:mu}),t.cluster)for(let l in t.clusterProperties){let[u,c]=t.clusterProperties[l],p=typeof u=="string"?[u,["accumulated"],["get",l]]:u;s.push(...fr({key:`${r}.${l}.map`,value:c,validateSpec:o,expressionContext:"cluster-map"})),s.push(...fr({key:`${r}.${l}.reduce`,value:p,validateSpec:o,expressionContext:"cluster-reduce"}))}return s;case"video":return ze({key:r,value:t,valueSpec:n.source_video,style:i,validateSpec:o,styleSpec:n});case"image":return ze({key:r,value:t,valueSpec:n.source_image,style:i,validateSpec:o,styleSpec:n});case"canvas":return[new M(r,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return ln({key:`${r}.type`,value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:i,validateSpec:o,styleSpec:n})}}function qh({key:e,value:t}){if(j(t)==="string")return Nt({key:e,value:t});{let r=[];for(let n in t)r.push(...Nt({key:`${e}.${n}`,value:t[n]}));return r}}function Zu(e){let t=e.value,r=e.styleSpec,n=r.light,i=e.style,o=[],a=j(t);if(t===void 0)return o;if(a!=="object")return o=o.concat([new M("light",t,`object expected, ${a} found`)]),o;for(let s in t){let l=s.match(/^(.*)-transition$/);l&&n[l[1]]&&n[l[1]].transition?o=o.concat(e.validateSpec({key:s,value:t[s],valueSpec:r.transition,validateSpec:e.validateSpec,style:i,styleSpec:r})):n[s]?o=o.concat(e.validateSpec({key:s,value:t[s],valueSpec:n[s],validateSpec:e.validateSpec,style:i,styleSpec:r})):o=o.concat([new M(s,t[s],`unknown property "${s}"`)])}return o}function Wu(e){let t=e.value,r=e.styleSpec,n=r.sky,i=e.style,o=j(t);if(t===void 0)return[];if(o!=="object")return[new M("sky",t,`object expected, ${o} found`)];let a=[];for(let s in t)n[s]?a=a.concat(e.validateSpec({key:s,value:t[s],valueSpec:n[s],style:i,styleSpec:r})):a=a.concat([new M(s,t[s],`unknown property "${s}"`)]);return a}function Hu(e){let t=e.value,r=e.styleSpec,n=r.terrain,i=e.style,o=[],a=j(t);if(t===void 0)return o;if(a!=="object")return o=o.concat([new M("terrain",t,`object expected, ${a} found`)]),o;for(let s in t)n[s]?o=o.concat(e.validateSpec({key:s,value:t[s],valueSpec:n[s],validateSpec:e.validateSpec,style:i,styleSpec:r})):o=o.concat([new M(s,t[s],`unknown property "${s}"`)]);return o}function jh(e){return Nt(e).length===0?[]:fr(e)}function Jh(e){return Nt(e).length===0?[]:fr(e)}function Zh(e){let t=e.key,r=e.value;if(j(r)==="array"){if(r.length<1||r.length>4)return[new M(t,r,`padding requires 1 to 4 values; ${r.length} values found`)];let i={type:"number"},o=[];for(let a=0;a<r.length;a++)o=o.concat(e.validateSpec({key:`${t}[${a}]`,value:r[a],validateSpec:e.validateSpec,valueSpec:i}));return o}else return gs({key:t,value:r,valueSpec:{}})}function Wh(e){let t=e.key,r=e.value,n=j(r),i=e.styleSpec;if(n!=="array"||r.length<1||r.length%2!==0)return[new M(t,r,"variableAnchorOffsetCollection requires a non-empty array of even length")];let o=[];for(let a=0;a<r.length;a+=2)o=o.concat(ln({key:`${t}[${a}]`,value:r[a],valueSpec:i.layout_symbol["text-anchor"]})),o=o.concat(ds({key:`${t}[${a+1}]`,value:r[a+1],valueSpec:{length:2,value:"number"},validateSpec:e.validateSpec,style:e.style,styleSpec:i}));return o}function Xu(e){let t=[],r=e.value,n=e.key;if(Array.isArray(r)){let i=[],o=[];for(let a in r){r[a].id&&i.includes(r[a].id)&&t.push(new M(n,r,`all the sprites\' ids must be unique, but ${r[a].id} is duplicated`)),i.push(r[a].id),r[a].url&&o.includes(r[a].url)&&t.push(new M(n,r,`all the sprites\' URLs must be unique, but ${r[a].url} is duplicated`)),o.push(r[a].url);let s={id:{type:"string",required:!0},url:{type:"string",required:!0}};t=t.concat(ze({key:`${n}[${a}]`,value:r[a],valueSpec:s,validateSpec:e.validateSpec}))}return t}else return Nt({key:n,value:r})}function Hh(e){let t=e.value,r=e.styleSpec,n=r.projection,i=e.style,o=j(t);if(t===void 0)return[];if(o!=="object")return[new M("projection",t,`object expected, ${o} found`)];let a=[];for(let s in t)n[s]?a=a.concat(e.validateSpec({key:s,value:t[s],valueSpec:n[s],style:i,styleSpec:r})):a=a.concat([new M(s,t[s],`unknown property "${s}"`)]);return a}var hu={"*"(){return[]},array:ds,boolean:Uh,number:gs,color:$h,constants:Ou,enum:ln,filter:xs,function:Nu,layer:ju,object:ze,source:Ju,light:Zu,sky:Wu,terrain:Hu,projection:Hh,string:Nt,formatted:jh,resolvedImage:Jh,padding:Zh,variableAnchorOffsetCollection:Wh,sprite:Xu};function Wr(e){let t=e.value,r=e.valueSpec,n=e.styleSpec;return e.validateSpec=Wr,r.expression&&Yi(ae(t))?Nu(e):r.expression&&$t(Ot(t))?fr(e):r.type&&hu[r.type]?hu[r.type](e):ze(cr({},e,{valueSpec:r.type?n[r.type]:r}))}function Ku(e){let t=e.value,r=e.key,n=Nt(e);return n.length||(t.indexOf("{fontstack}")===-1&&n.push(new M(r,t,\'"glyphs" url must include a "{fontstack}" token\')),t.indexOf("{range}")===-1&&n.push(new M(r,t,\'"glyphs" url must include a "{range}" token\'))),n}function Ue(e,t=S){let r=[];return r=r.concat(Wr({key:"",value:e,valueSpec:t.$root,styleSpec:t,style:e,validateSpec:Wr,objectElementValidators:{glyphs:Ku,"*"(){return[]}}})),e.constants&&(r=r.concat(Ou({key:"constants",value:e.constants,style:e,styleSpec:t,validateSpec:Wr}))),Yu(r)}Ue.source=Qe(Ye(Ju));Ue.sprite=Qe(Ye(Xu));Ue.glyphs=Qe(Ye(Ku));Ue.light=Qe(Ye(Zu));Ue.sky=Qe(Ye(Wu));Ue.terrain=Qe(Ye(Hu));Ue.layer=Qe(Ye(ju));Ue.filter=Qe(Ye(xs));Ue.paintProperty=Qe(Ye(Gu));Ue.layoutProperty=Qe(Ye(qu));function Ye(e){return function(t){return e({...t,validateSpec:Wr})}}function Yu(e){return[].concat(e).sort((t,r)=>t.line-r.line)}function Qe(e){return function(...t){return Yu(e.apply(this,t))}}var Qu="AbortError";function ec(e){return e.message===Qu}function bs(){return new Error(Qu)}var Qi={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function tc(e){return Qi.REGISTERED_PROTOCOLS[e.substring(0,e.indexOf("://"))]}function rc(e,t){Qi.REGISTERED_PROTOCOLS[e]=t}function nc(e){delete Qi.REGISTERED_PROTOCOLS[e]}var ic="global-dispatcher",gr=class extends Error{constructor(t,r,n,i){super(`AJAXError: ${r} (${t}): ${n}`),this.status=t,this.statusText=r,this.url=n,this.body=i}},ac=()=>at(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,Xh=e=>/^file:/.test(e)||/^file:/.test(ac())&&!/^\\w+:/.test(e);async function Kh(e,t){let r=new Request(e.url,{method:e.method||"GET",body:e.body,credentials:e.credentials,headers:e.headers,cache:e.cache,referrer:ac(),signal:t.signal});e.type==="json"&&r.headers.set("Accept","application/json");let n=await fetch(r);if(!n.ok){let a=await n.blob();throw new gr(n.status,n.statusText,e.url,a)}let i;e.type==="arrayBuffer"||e.type==="image"?i=n.arrayBuffer():e.type==="json"?i=n.json():i=n.text();let o=await i;if(t.signal.aborted)throw bs();return{data:o,cacheControl:n.headers.get("Cache-Control"),expires:n.headers.get("Expires")}}function Yh(e,t){return new Promise((r,n)=>{let i=new XMLHttpRequest;i.open(e.method||"GET",e.url,!0),(e.type==="arrayBuffer"||e.type==="image")&&(i.responseType="arraybuffer");for(let o in e.headers)i.setRequestHeader(o,e.headers[o]);e.type==="json"&&(i.responseType="text",i.setRequestHeader("Accept","application/json")),i.withCredentials=e.credentials==="include",i.onerror=()=>{n(new Error(i.statusText))},i.onload=()=>{if(!t.signal.aborted)if((i.status>=200&&i.status<300||i.status===0)&&i.response!==null){let o=i.response;if(e.type==="json")try{o=JSON.parse(i.response)}catch(a){n(a);return}r({data:o,cacheControl:i.getResponseHeader("Cache-Control"),expires:i.getResponseHeader("Expires")})}else{let o=new Blob([i.response],{type:i.getResponseHeader("Content-Type")});n(new gr(i.status,i.statusText,e.url,o))}},t.signal.addEventListener("abort",()=>{i.abort(),n(bs())}),i.send(e.body)})}var sc=function(e,t){if(/:\\/\\//.test(e.url)&&!/^https?:|^file:/.test(e.url)){let r=tc(e.url);if(r)return r(e,t);if(at(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:e,targetMapId:ic},t)}if(!Xh(e.url)){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return Kh(e,t);if(at(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:e,mustQueue:!0,targetMapId:ic},t)}return Yh(e,t)},lc=(e,t)=>sc(Pe(e,{type:"json"}),t),uc=(e,t)=>sc(Pe(e,{type:"arrayBuffer"}),t);var xt={};function C(e,t,r={}){if(xt[e])throw new Error(`${e} is already registered.`);Object.defineProperty(t,"_classRegistryKey",{value:e,writeable:!1}),xt[e]={klass:t,omit:r.omit||[],shallow:r.shallow||[]}}C("Object",Object);C("TransferableGridIndex",Dt);C("Color",W);C("Error",Error);C("AJAXError",gr);C("ResolvedImage",Te);C("StylePropertyFunction",sn);C("StyleExpression",Rt,{omit:["_evaluator"]});C("ZoomDependentExpression",gt);C("ZoomConstantExpression",dt);C("CompoundExpression",Ke,{omit:["_evaluate"]});for(let e in Ut)Ut[e]._classRegistryKey||C(`Expression_${e}`,Ut[e]);function cc(e){return e&&typeof ArrayBuffer<"u"&&(e instanceof ArrayBuffer||e.constructor&&e.constructor.name==="ArrayBuffer")}function xr(e,t){if(e==null||typeof e=="boolean"||typeof e=="number"||typeof e=="string"||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp||e instanceof Blob||e instanceof Error)return e;if(cc(e)||qr(e))return t&&t.push(e),e;if(ArrayBuffer.isView(e)){let r=e;return t&&t.push(r.buffer),r}if(e instanceof ImageData)return t&&t.push(e.data.buffer),e;if(Array.isArray(e)){let r=[];for(let n of e)r.push(xr(n,t));return r}if(typeof e=="object"){let r=e.constructor,n=r._classRegistryKey;if(!n)throw new Error(`can\'t serialize object of unregistered class ${r.name}`);if(!xt[n])throw new Error(`${n} is not registered.`);let i=r.serialize?r.serialize(e,t):{};if(r.serialize){if(t&&i===t[t.length-1])throw new Error("statically serialized object won\'t survive transfer of $name property")}else{for(let o in e){if(!e.hasOwnProperty(o)||xt[n].omit.indexOf(o)>=0)continue;let a=e[o];i[o]=xt[n].shallow.indexOf(o)>=0?a:xr(a,t)}e instanceof Error&&(i.message=e.message)}if(i.$name)throw new Error("$name property is reserved for worker serialization logic.");return n!=="Object"&&(i.$name=n),i}throw new Error(`can\'t serialize object of type ${typeof e}`)}function br(e){if(e==null||typeof e=="boolean"||typeof e=="number"||typeof e=="string"||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp||e instanceof Blob||e instanceof Error||cc(e)||qr(e)||ArrayBuffer.isView(e)||e instanceof ImageData)return e;if(Array.isArray(e))return e.map(br);if(typeof e=="object"){let t=e.$name||"Object";if(!xt[t])throw new Error(`can\'t deserialize unregistered class ${t}`);let{klass:r}=xt[t];if(!r)throw new Error(`can\'t deserialize unregistered class ${t}`);if(r.deserialize)return r.deserialize(e);let n=Object.create(r.prototype);for(let i of Object.keys(e)){if(i==="$name")continue;let o=e[i];n[i]=xt[t].shallow.indexOf(i)>=0?o:br(o)}return n}throw new Error(`can\'t deserialize object of type ${typeof e}`)}var eo=class{constructor(t){this._methodToThrottle=t,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}};var to=class{constructor(t,r){this.target=t,this.mapId=r,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new eo(()=>this.process()),this.subscription=Hl(this.target,"message",n=>this.receive(n),!1),this.globalScope=at(self)?t:window}registerMessageHandler(t,r){this.messageHandlers[t]=r}sendAsync(t,r){return new Promise((n,i)=>{let o=Math.round(Math.random()*1e18).toString(36).substring(0,10);this.resolveRejects[o]={resolve:n,reject:i},r&&r.signal.addEventListener("abort",()=>{delete this.resolveRejects[o];let l={id:o,type:"<cancel>",origin:location.origin,targetMapId:t.targetMapId,sourceMapId:this.mapId};this.target.postMessage(l)},{once:!0});let a=[],s={...t,id:o,sourceMapId:this.mapId,origin:location.origin,data:xr(t.data,a)};this.target.postMessage(s,{transfer:a})})}receive(t){let r=t.data,n=r.id;if(!(r.origin!=="file://"&&location.origin!=="file://"&&r.origin!==location.origin)&&!(r.targetMapId&&this.mapId!==r.targetMapId)){if(r.type==="<cancel>"){delete this.tasks[n];let i=this.abortControllers[n];delete this.abortControllers[n],i&&i.abort();return}if(at(self)||r.mustQueue){this.tasks[n]=r,this.taskQueue.push(n),this.invoker.trigger();return}this.processTask(n,r)}}process(){if(this.taskQueue.length===0)return;let t=this.taskQueue.shift(),r=this.tasks[t];delete this.tasks[t],this.taskQueue.length>0&&this.invoker.trigger(),r&&this.processTask(t,r)}async processTask(t,r){if(r.type==="<response>"){let o=this.resolveRejects[t];if(delete this.resolveRejects[t],!o)return;r.error?o.reject(br(r.error)):o.resolve(br(r.data));return}if(!this.messageHandlers[r.type]){this.completeTask(t,new Error(`Could not find a registered handler for ${r.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));return}let n=br(r.data),i=new AbortController;this.abortControllers[t]=i;try{let o=await this.messageHandlers[r.type](r.sourceMapId,n,i);this.completeTask(t,null,o)}catch(o){this.completeTask(t,o)}}completeTask(t,r,n){let i=[];delete this.abortControllers[t];let o={id:t,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:r?xr(r):null,data:xr(n,i)};this.target.postMessage(o,{transfer:i})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}};function pc(e,t,r){r[e]&&r[e].indexOf(t)!==-1||(r[e]=r[e]||[],r[e].push(t))}function vs(e,t,r){if(r&&r[e]){let n=r[e].indexOf(t);n!==-1&&r[e].splice(n,1)}}var ro=class{constructor(t,r={}){Pe(this,r),this.type=t}},yn=class extends ro{constructor(t,r={}){super("error",Pe({error:t},r))}},no=class{on(t,r){return this._listeners=this._listeners||{},pc(t,r,this._listeners),this}off(t,r){return vs(t,r,this._listeners),vs(t,r,this._oneTimeListeners),this}once(t,r){return r?(this._oneTimeListeners=this._oneTimeListeners||{},pc(t,r,this._oneTimeListeners),this):new Promise(n=>this.once(t,n))}fire(t,r){typeof t=="string"&&(t=new ro(t,r||{}));let n=t.type;if(this.listens(n)){t.target=this;let i=this._listeners&&this._listeners[n]?this._listeners[n].slice():[];for(let s of i)s.call(this,t);let o=this._oneTimeListeners&&this._oneTimeListeners[n]?this._oneTimeListeners[n].slice():[];for(let s of o)vs(n,s,this._oneTimeListeners),s.call(this,t);let a=this._eventedParent;a&&(Pe(t,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),a.fire(t))}else t instanceof yn&&console.error(t.error);return this}listens(t){return this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t)}setEventedParent(t,r){return this._eventedParent=t,this._eventedParentData=r,this}};var bt=Ue,j0=bt.source,J0=bt.light,Z0=bt.terrain,W0=bt.filter,fc=bt.paintProperty,yc=bt.layoutProperty;function mc(e,t){let r=!1;if(t&&t.length)for(let n of t)e.fire(new yn(new Error(n.message))),r=!0;return r}var io=class{constructor(){this.first=!0}update(t,r){let n=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=n,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=n,!0):(this.lastFloorZoom>n?(this.lastIntegerZoom=n+1,this.lastIntegerZoomTime=r):this.lastFloorZoom<n&&(this.lastIntegerZoom=n,this.lastIntegerZoomTime=r),t!==this.lastZoom?(this.lastZoom=t,this.lastFloorZoom=n,!0):!1)}};var D={"Latin-1 Supplement":e=>e>=128&&e<=255,Arabic:e=>e>=1536&&e<=1791,"Arabic Supplement":e=>e>=1872&&e<=1919,"Arabic Extended-A":e=>e>=2208&&e<=2303,"Hangul Jamo":e=>e>=4352&&e<=4607,"Unified Canadian Aboriginal Syllabics":e=>e>=5120&&e<=5759,Khmer:e=>e>=6016&&e<=6143,"Unified Canadian Aboriginal Syllabics Extended":e=>e>=6320&&e<=6399,"General Punctuation":e=>e>=8192&&e<=8303,"Letterlike Symbols":e=>e>=8448&&e<=8527,"Number Forms":e=>e>=8528&&e<=8591,"Miscellaneous Technical":e=>e>=8960&&e<=9215,"Control Pictures":e=>e>=9216&&e<=9279,"Optical Character Recognition":e=>e>=9280&&e<=9311,"Enclosed Alphanumerics":e=>e>=9312&&e<=9471,"Geometric Shapes":e=>e>=9632&&e<=9727,"Miscellaneous Symbols":e=>e>=9728&&e<=9983,"Miscellaneous Symbols and Arrows":e=>e>=11008&&e<=11263,"CJK Radicals Supplement":e=>e>=11904&&e<=12031,"Kangxi Radicals":e=>e>=12032&&e<=12255,"Ideographic Description Characters":e=>e>=12272&&e<=12287,"CJK Symbols and Punctuation":e=>e>=12288&&e<=12351,Hiragana:e=>e>=12352&&e<=12447,Katakana:e=>e>=12448&&e<=12543,Bopomofo:e=>e>=12544&&e<=12591,"Hangul Compatibility Jamo":e=>e>=12592&&e<=12687,Kanbun:e=>e>=12688&&e<=12703,"Bopomofo Extended":e=>e>=12704&&e<=12735,"CJK Strokes":e=>e>=12736&&e<=12783,"Katakana Phonetic Extensions":e=>e>=12784&&e<=12799,"Enclosed CJK Letters and Months":e=>e>=12800&&e<=13055,"CJK Compatibility":e=>e>=13056&&e<=13311,"CJK Unified Ideographs Extension A":e=>e>=13312&&e<=19903,"Yijing Hexagram Symbols":e=>e>=19904&&e<=19967,"CJK Unified Ideographs":e=>e>=19968&&e<=40959,"Yi Syllables":e=>e>=40960&&e<=42127,"Yi Radicals":e=>e>=42128&&e<=42191,"Hangul Jamo Extended-A":e=>e>=43360&&e<=43391,"Hangul Syllables":e=>e>=44032&&e<=55215,"Hangul Jamo Extended-B":e=>e>=55216&&e<=55295,"Private Use Area":e=>e>=57344&&e<=63743,"CJK Compatibility Ideographs":e=>e>=63744&&e<=64255,"Arabic Presentation Forms-A":e=>e>=64336&&e<=65023,"Vertical Forms":e=>e>=65040&&e<=65055,"CJK Compatibility Forms":e=>e>=65072&&e<=65103,"Small Form Variants":e=>e>=65104&&e<=65135,"Arabic Presentation Forms-B":e=>e>=65136&&e<=65279,"Halfwidth and Fullwidth Forms":e=>e>=65280&&e<=65519};function mn(e){for(let t of e)if(oo(t.charCodeAt(0)))return!0;return!1}function hc(e){for(let t of e)if(!Qh(t.charCodeAt(0)))return!1;return!0}function Qh(e){return!(D.Arabic(e)||D["Arabic Supplement"](e)||D["Arabic Extended-A"](e)||D["Arabic Presentation Forms-A"](e)||D["Arabic Presentation Forms-B"](e))}function dc(e){return e<11904?!1:!!(D["Bopomofo Extended"](e)||D.Bopomofo(e)||D["CJK Compatibility Forms"](e)||D["CJK Compatibility Ideographs"](e)||D["CJK Compatibility"](e)||D["CJK Radicals Supplement"](e)||D["CJK Strokes"](e)||D["CJK Symbols and Punctuation"](e)||D["CJK Unified Ideographs Extension A"](e)||D["CJK Unified Ideographs"](e)||D["Enclosed CJK Letters and Months"](e)||D["Halfwidth and Fullwidth Forms"](e)||D.Hiragana(e)||D["Ideographic Description Characters"](e)||D["Kangxi Radicals"](e)||D["Katakana Phonetic Extensions"](e)||D.Katakana(e)||D["Vertical Forms"](e)||D["Yi Radicals"](e)||D["Yi Syllables"](e))}function oo(e){return e===746||e===747?!0:e<4352?!1:!!(D["Bopomofo Extended"](e)||D.Bopomofo(e)||D["CJK Compatibility Forms"](e)&&!(e>=65097&&e<=65103)||D["CJK Compatibility Ideographs"](e)||D["CJK Compatibility"](e)||D["CJK Radicals Supplement"](e)||D["CJK Strokes"](e)||D["CJK Symbols and Punctuation"](e)&&!(e>=12296&&e<=12305)&&!(e>=12308&&e<=12319)&&e!==12336||D["CJK Unified Ideographs Extension A"](e)||D["CJK Unified Ideographs"](e)||D["Enclosed CJK Letters and Months"](e)||D["Hangul Compatibility Jamo"](e)||D["Hangul Jamo Extended-A"](e)||D["Hangul Jamo Extended-B"](e)||D["Hangul Jamo"](e)||D["Hangul Syllables"](e)||D.Hiragana(e)||D["Ideographic Description Characters"](e)||D.Kanbun(e)||D["Kangxi Radicals"](e)||D["Katakana Phonetic Extensions"](e)||D.Katakana(e)&&e!==12540||D["Halfwidth and Fullwidth Forms"](e)&&e!==65288&&e!==65289&&e!==65293&&!(e>=65306&&e<=65310)&&e!==65339&&e!==65341&&e!==65343&&!(e>=65371&&e<=65503)&&e!==65507&&!(e>=65512&&e<=65519)||D["Small Form Variants"](e)&&!(e>=65112&&e<=65118)&&!(e>=65123&&e<=65126)||D["Unified Canadian Aboriginal Syllabics"](e)||D["Unified Canadian Aboriginal Syllabics Extended"](e)||D["Vertical Forms"](e)||D["Yijing Hexagram Symbols"](e)||D["Yi Syllables"](e)||D["Yi Radicals"](e))}function ed(e){return!!(D["Latin-1 Supplement"](e)&&(e===167||e===169||e===174||e===177||e===188||e===189||e===190||e===215||e===247)||D["General Punctuation"](e)&&(e===8214||e===8224||e===8225||e===8240||e===8241||e===8251||e===8252||e===8258||e===8263||e===8264||e===8265||e===8273)||D["Letterlike Symbols"](e)||D["Number Forms"](e)||D["Miscellaneous Technical"](e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||e===9003||e>=9085&&e<=9114||e>=9150&&e<=9165||e===9167||e>=9169&&e<=9179||e>=9186&&e<=9215)||D["Control Pictures"](e)&&e!==9251||D["Optical Character Recognition"](e)||D["Enclosed Alphanumerics"](e)||D["Geometric Shapes"](e)||D["Miscellaneous Symbols"](e)&&!(e>=9754&&e<=9759)||D["Miscellaneous Symbols and Arrows"](e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||D["CJK Symbols and Punctuation"](e)||D.Katakana(e)||D["Private Use Area"](e)||D["CJK Compatibility Forms"](e)||D["Small Form Variants"](e)||D["Halfwidth and Fullwidth Forms"](e)||e===8734||e===8756||e===8757||e>=9984&&e<=10087||e>=10102&&e<=10131||e===65532||e===65533)}function Ps(e){return!(oo(e)||ed(e))}function gc(e){return D.Arabic(e)||D["Arabic Supplement"](e)||D["Arabic Extended-A"](e)||D["Arabic Presentation Forms-A"](e)||D["Arabic Presentation Forms-B"](e)}function xc(e){return e>=1424&&e<=2303||D["Arabic Presentation Forms-A"](e)||D["Arabic Presentation Forms-B"](e)}function td(e,t){return!(!t&&xc(e)||e>=2304&&e<=3583||e>=3840&&e<=4255||D.Khmer(e))}function bc(e){for(let t of e)if(xc(t.charCodeAt(0)))return!0;return!1}function vc(e,t){for(let r of e)if(!td(r.charCodeAt(0),t))return!1;return!0}var Ss=class{constructor(){this.applyArabicShaping=null;this.processBidirectionalText=null;this.processStyledBidirectionalText=null;this.pluginStatus="unavailable";this.pluginURL=null}setState(t){this.pluginStatus=t.pluginStatus,this.pluginURL=t.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(t){this.applyArabicShaping=t.applyArabicShaping,this.processBidirectionalText=t.processBidirectionalText,this.processStyledBidirectionalText=t.processStyledBidirectionalText}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getPluginURL(){return this.pluginURL}getRTLTextPluginStatus(){return this.pluginStatus}},ye=new Ss;var q=class{constructor(t,r){this.zoom=t,r?(this.now=r.now,this.fadeDuration=r.fadeDuration,this.zoomHistory=r.zoomHistory,this.transition=r.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new io,this.transition={})}isSupportedScript(t){return vc(t,ye.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){let t=this.zoom,r=t-Math.floor(t),n=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:r+(1-r)*n}:{fromScale:.5,toScale:1,t:1-(1-n)*r}}};var vr=class{constructor(t,r){this.property=t,this.value=r,this.expression=Bu(r===void 0?t.specification.default:r,t.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(t,r,n){return this.property.possiblyEvaluate(this,t,r,n)}},hn=class{constructor(t){this.property=t,this.value=new vr(t,void 0)}transitioned(t,r){return new so(this.property,this.value,r,Pe({},t.transition,this.transition),t.now)}untransitioned(){return new so(this.property,this.value,null,{},0)}},ao=class{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)}getValue(t){return nt(this._values[t].value.value)}setValue(t,r){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new hn(this._values[t].property)),this._values[t].value=new vr(this._values[t].property,r===null?void 0:nt(r))}getTransition(t){return nt(this._values[t].transition)}setTransition(t,r){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new hn(this._values[t].property)),this._values[t].transition=nt(r)||void 0}serialize(){let t={};for(let r of Object.keys(this._values)){let n=this.getValue(r);n!==void 0&&(t[r]=n);let i=this.getTransition(r);i!==void 0&&(t[`${r}-transition`]=i)}return t}transitioned(t,r){let n=new lo(this._properties);for(let i of Object.keys(this._values))n._values[i]=this._values[i].transitioned(t,r._values[i]);return n}untransitioned(){let t=new lo(this._properties);for(let r of Object.keys(this._values))t._values[r]=this._values[r].untransitioned();return t}},so=class{constructor(t,r,n,i,o){this.property=t,this.value=r,this.begin=o+i.delay||0,this.end=this.begin+i.duration||0,t.specification.transition&&(i.delay||i.duration)&&(this.prior=n)}possiblyEvaluate(t,r,n){let i=t.now||0,o=this.value.possiblyEvaluate(t,r,n),a=this.prior;if(a){if(i>this.end)return this.prior=null,o;if(this.value.isDataDriven())return this.prior=null,o;if(i<this.begin)return a.possiblyEvaluate(t,r,n);{let s=(i-this.begin)/(this.end-this.begin);return this.property.interpolate(a.possiblyEvaluate(t,r,n),o,$l(s))}}else return o}},lo=class{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)}possiblyEvaluate(t,r,n){let i=new vt(this._properties);for(let o of Object.keys(this._values))i._values[o]=this._values[o].possiblyEvaluate(t,r,n);return i}hasTransition(){for(let t of Object.keys(this._values))if(this._values[t].prior)return!0;return!1}},uo=class{constructor(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)}hasValue(t){return this._values[t].value!==void 0}getValue(t){return nt(this._values[t].value)}setValue(t,r){this._values[t]=new vr(this._values[t].property,r===null?void 0:nt(r))}serialize(){let t={};for(let r of Object.keys(this._values)){let n=this.getValue(r);n!==void 0&&(t[r]=n)}return t}possiblyEvaluate(t,r,n){let i=new vt(this._properties);for(let o of Object.keys(this._values))i._values[o]=this._values[o].possiblyEvaluate(t,r,n);return i}},Se=class{constructor(t,r,n){this.property=t,this.value=r,this.parameters=n}isConstant(){return this.value.kind==="constant"}constantOr(t){return this.value.kind==="constant"?this.value.value:t}evaluate(t,r,n,i){return this.property.evaluate(this.value,this.parameters,t,r,n,i)}},vt=class{constructor(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)}get(t){return this._values[t]}},B=class{constructor(t){this.specification=t}possiblyEvaluate(t,r){if(t.isDataDriven())throw new Error("Value should not be data driven");return t.expression.evaluate(r)}interpolate(t,r,n){let i=this.specification.type,o=Oe[i];return o?o(t,r,n):t}},R=class{constructor(t,r){this.specification=t,this.overrides=r}possiblyEvaluate(t,r,n,i){return t.expression.kind==="constant"||t.expression.kind==="camera"?new Se(this,{kind:"constant",value:t.expression.evaluate(r,null,{},n,i)},r):new Se(this,t.expression,r)}interpolate(t,r,n){if(t.value.kind!=="constant"||r.value.kind!=="constant")return t;if(t.value.value===void 0||r.value.value===void 0)return new Se(this,{kind:"constant",value:void 0},t.parameters);let i=this.specification.type,o=Oe[i];if(o){let a=o(t.value.value,r.value.value,n);return new Se(this,{kind:"constant",value:a},t.parameters)}else return t}evaluate(t,r,n,i,o,a){return t.kind==="constant"?t.value:t.evaluate(r,n,i,o,a)}},lt=class extends R{possiblyEvaluate(t,r,n,i){if(t.value===void 0)return new Se(this,{kind:"constant",value:void 0},r);if(t.expression.kind==="constant"){let o=t.expression.evaluate(r,null,{},n,i),s=t.property.specification.type==="resolvedImage"&&typeof o!="string"?o.name:o,l=this._calculate(s,s,s,r);return new Se(this,{kind:"constant",value:l},r)}else if(t.expression.kind==="camera"){let o=this._calculate(t.expression.evaluate({zoom:r.zoom-1}),t.expression.evaluate({zoom:r.zoom}),t.expression.evaluate({zoom:r.zoom+1}),r);return new Se(this,{kind:"constant",value:o},r)}else return new Se(this,t.expression,r)}evaluate(t,r,n,i,o,a){if(t.kind==="source"){let s=t.evaluate(r,n,i,o,a);return this._calculate(s,s,s,r)}else return t.kind==="composite"?this._calculate(t.evaluate({zoom:Math.floor(r.zoom)-1},n,i),t.evaluate({zoom:Math.floor(r.zoom)},n,i),t.evaluate({zoom:Math.floor(r.zoom)+1},n,i),r):t.value}_calculate(t,r,n,i){return i.zoom>i.zoomHistory.lastIntegerZoom?{from:t,to:r}:{from:n,to:r}}interpolate(t){return t}},qt=class{constructor(t){this.specification=t}possiblyEvaluate(t,r,n,i){if(t.value!==void 0)if(t.expression.kind==="constant"){let o=t.expression.evaluate(r,null,{},n,i);return this._calculate(o,o,o,r)}else return this._calculate(t.expression.evaluate(new q(Math.floor(r.zoom-1),r)),t.expression.evaluate(new q(Math.floor(r.zoom),r)),t.expression.evaluate(new q(Math.floor(r.zoom+1),r)),r)}_calculate(t,r,n,i){return i.zoom>i.zoomHistory.lastIntegerZoom?{from:t,to:r}:{from:n,to:r}}interpolate(t){return t}},jt=class{constructor(t){this.specification=t}possiblyEvaluate(t,r,n,i){return!!t.expression.evaluate(r,null,{},n,i)}interpolate(){return!1}},re=class{constructor(t){this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(let r in t){let n=t[r];n.specification.overridable&&this.overridableProperties.push(r);let i=this.defaultPropertyValues[r]=new vr(n,void 0),o=this.defaultTransitionablePropertyValues[r]=new hn(n);this.defaultTransitioningPropertyValues[r]=o.untransitioned(),this.defaultPossiblyEvaluatedValues[r]=i.possiblyEvaluate({})}}};C("DataDrivenProperty",R);C("DataConstantProperty",B);C("CrossFadedDataDrivenProperty",lt);C("CrossFadedProperty",qt);C("ColorRampProperty",jt);var co="-transition",se=class extends no{constructor(t,r){if(super(),this.id=t.id,this.type=t.type,this._featureFilter={filter:()=>!0,needGeometry:!1},t.type!=="custom"&&(t=t,this.metadata=t.metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,t.type!=="background"&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter),r.layout&&(this._unevaluatedLayout=new uo(r.layout)),r.paint)){this._transitionablePaint=new ao(r.paint);for(let n in t.paint)this.setPaintProperty(n,t.paint[n],{validate:!1});for(let n in t.layout)this.setLayoutProperty(n,t.layout[n],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new vt(r.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(t){return t==="visibility"?this.visibility:this._unevaluatedLayout.getValue(t)}setLayoutProperty(t,r,n={}){if(r!=null){let i=`layers.${this.id}.layout.${t}`;if(this._validate(yc,i,t,r,n))return}if(t==="visibility"){this.visibility=r;return}this._unevaluatedLayout.setValue(t,r)}getPaintProperty(t){return t.endsWith(co)?this._transitionablePaint.getTransition(t.slice(0,-co.length)):this._transitionablePaint.getValue(t)}setPaintProperty(t,r,n={}){if(r!=null){let i=`layers.${this.id}.paint.${t}`;if(this._validate(fc,i,t,r,n))return!1}if(t.endsWith(co))return this._transitionablePaint.setTransition(t.slice(0,-co.length),r||void 0),!1;{let i=this._transitionablePaint._values[t],o=i.property.specification["property-type"]==="cross-faded-data-driven",a=i.value.isDataDriven(),s=i.value;this._transitionablePaint.setValue(t,r),this._handleSpecialPaintPropertyUpdate(t);let l=this._transitionablePaint._values[t].value;return l.isDataDriven()||a||o||this._handleOverridablePaintPropertyUpdate(t,s,l)}}_handleSpecialPaintPropertyUpdate(t){}_handleOverridablePaintPropertyUpdate(t,r,n){return!1}isHidden(t){return this.minzoom&&t<this.minzoom||this.maxzoom&&t>=this.maxzoom?!0:this.visibility==="none"}updateTransitions(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(t,r){t.getCrossfadeParameters&&(this._crossfadeParameters=t.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,r)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,r)}serialize(){let t={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(t.layout=t.layout||{},t.layout.visibility=this.visibility),jl(t,(r,n)=>r!==void 0&&!(n==="layout"&&!Object.keys(r).length)&&!(n==="paint"&&!Object.keys(r).length))}_validate(t,r,n,i,o={}){return o&&o.validate===!1?!1:mc(this,t.call(bt,{key:r,layerType:this.type,objectKey:n,value:i,styleSpec:S,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(let t in this.paint._values){let r=this.paint.get(t);if(!(!(r instanceof Se)||!ht(r.property.specification))&&(r.value.kind==="source"||r.value.kind==="composite")&&r.value.isStateDependent)return!0}return!1}};var rd={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},Pt=class{constructor(t,r){this._structArray=t,this._pos1=r*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}},nd=128,id=5,ee=class{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(t,r){return t._trim(),r&&(t.isTransferred=!0,r.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}}static deserialize(t){let r=Object.create(this.prototype);return r.arrayBuffer=t.arrayBuffer,r.length=t.length,r.capacity=t.arrayBuffer.byteLength/r.bytesPerElement,r._refreshViews(),r}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(t){this.reserve(t),this.length=t}reserve(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(this.capacity*id),nd),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);let r=this.uint8;this._refreshViews(),r&&this.uint8.set(r)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}};function Y(e,t=1){let r=0,n=0,i=e.map(a=>{let s=od(a.type),l=r=Pc(r,Math.max(t,s)),u=a.components||1;return n=Math.max(n,s),r+=s*u,{name:a.name,type:a.type,components:u,offset:l}}),o=Pc(r,Math.max(n,t));return{members:i,size:o,alignment:t}}function od(e){return rd[e].BYTES_PER_ELEMENT}function Pc(e,t){return Math.ceil(e/t)*t}var Sc=Z(he(),1),Jt=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r){let n=this.length;return this.resize(n+1),this.emplace(n,t,r)}emplace(t,r,n){let i=t*2;return this.int16[i+0]=r,this.int16[i+1]=n,t}};Jt.prototype.bytesPerElement=4;C("StructArrayLayout2i4",Jt);var dn=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,n){let i=this.length;return this.resize(i+1),this.emplace(i,t,r,n)}emplace(t,r,n,i){let o=t*3;return this.int16[o+0]=r,this.int16[o+1]=n,this.int16[o+2]=i,t}};dn.prototype.bytesPerElement=6;C("StructArrayLayout3i6",dn);var po=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,n,i){let o=this.length;return this.resize(o+1),this.emplace(o,t,r,n,i)}emplace(t,r,n,i,o){let a=t*4;return this.int16[a+0]=r,this.int16[a+1]=n,this.int16[a+2]=i,this.int16[a+3]=o,t}};po.prototype.bytesPerElement=8;C("StructArrayLayout4i8",po);var gn=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,n,i,o,a){let s=this.length;return this.resize(s+1),this.emplace(s,t,r,n,i,o,a)}emplace(t,r,n,i,o,a,s){let l=t*6;return this.int16[l+0]=r,this.int16[l+1]=n,this.int16[l+2]=i,this.int16[l+3]=o,this.int16[l+4]=a,this.int16[l+5]=s,t}};gn.prototype.bytesPerElement=12;C("StructArrayLayout2i4i12",gn);var xn=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,n,i,o,a){let s=this.length;return this.resize(s+1),this.emplace(s,t,r,n,i,o,a)}emplace(t,r,n,i,o,a,s){let l=t*4,u=t*8;return this.int16[l+0]=r,this.int16[l+1]=n,this.uint8[u+4]=i,this.uint8[u+5]=o,this.uint8[u+6]=a,this.uint8[u+7]=s,t}};xn.prototype.bytesPerElement=8;C("StructArrayLayout2i4ub8",xn);var St=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r){let n=this.length;return this.resize(n+1),this.emplace(n,t,r)}emplace(t,r,n){let i=t*2;return this.float32[i+0]=r,this.float32[i+1]=n,t}};St.prototype.bytesPerElement=8;C("StructArrayLayout2f8",St);var bn=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r,n,i,o,a,s,l,u,c){let p=this.length;return this.resize(p+1),this.emplace(p,t,r,n,i,o,a,s,l,u,c)}emplace(t,r,n,i,o,a,s,l,u,c,p){let f=t*10;return this.uint16[f+0]=r,this.uint16[f+1]=n,this.uint16[f+2]=i,this.uint16[f+3]=o,this.uint16[f+4]=a,this.uint16[f+5]=s,this.uint16[f+6]=l,this.uint16[f+7]=u,this.uint16[f+8]=c,this.uint16[f+9]=p,t}};bn.prototype.bytesPerElement=20;C("StructArrayLayout10ui20",bn);var vn=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r,n,i,o,a,s,l,u,c,p,f){let y=this.length;return this.resize(y+1),this.emplace(y,t,r,n,i,o,a,s,l,u,c,p,f)}emplace(t,r,n,i,o,a,s,l,u,c,p,f,y){let m=t*12;return this.int16[m+0]=r,this.int16[m+1]=n,this.int16[m+2]=i,this.int16[m+3]=o,this.uint16[m+4]=a,this.uint16[m+5]=s,this.uint16[m+6]=l,this.uint16[m+7]=u,this.int16[m+8]=c,this.int16[m+9]=p,this.int16[m+10]=f,this.int16[m+11]=y,t}};vn.prototype.bytesPerElement=24;C("StructArrayLayout4i4ui4i24",vn);var Pn=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,n){let i=this.length;return this.resize(i+1),this.emplace(i,t,r,n)}emplace(t,r,n,i){let o=t*3;return this.float32[o+0]=r,this.float32[o+1]=n,this.float32[o+2]=i,t}};Pn.prototype.bytesPerElement=12;C("StructArrayLayout3f12",Pn);var Sn=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t){let r=this.length;return this.resize(r+1),this.emplace(r,t)}emplace(t,r){let n=t*1;return this.uint32[n+0]=r,t}};Sn.prototype.bytesPerElement=4;C("StructArrayLayout1ul4",Sn);var wn=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r,n,i,o,a,s,l,u){let c=this.length;return this.resize(c+1),this.emplace(c,t,r,n,i,o,a,s,l,u)}emplace(t,r,n,i,o,a,s,l,u,c){let p=t*10,f=t*5;return this.int16[p+0]=r,this.int16[p+1]=n,this.int16[p+2]=i,this.int16[p+3]=o,this.int16[p+4]=a,this.int16[p+5]=s,this.uint32[f+3]=l,this.uint16[p+8]=u,this.uint16[p+9]=c,t}};wn.prototype.bytesPerElement=20;C("StructArrayLayout6i1ul2ui20",wn);var An=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,n,i,o,a){let s=this.length;return this.resize(s+1),this.emplace(s,t,r,n,i,o,a)}emplace(t,r,n,i,o,a,s){let l=t*6;return this.int16[l+0]=r,this.int16[l+1]=n,this.int16[l+2]=i,this.int16[l+3]=o,this.int16[l+4]=a,this.int16[l+5]=s,t}};An.prototype.bytesPerElement=12;C("StructArrayLayout2i2i2i12",An);var fo=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,n,i,o){let a=this.length;return this.resize(a+1),this.emplace(a,t,r,n,i,o)}emplace(t,r,n,i,o,a){let s=t*4,l=t*8;return this.float32[s+0]=r,this.float32[s+1]=n,this.float32[s+2]=i,this.int16[l+6]=o,this.int16[l+7]=a,t}};fo.prototype.bytesPerElement=16;C("StructArrayLayout2f1f2i16",fo);var _n=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,n,i){let o=this.length;return this.resize(o+1),this.emplace(o,t,r,n,i)}emplace(t,r,n,i,o){let a=t*12,s=t*3;return this.uint8[a+0]=r,this.uint8[a+1]=n,this.float32[s+1]=i,this.float32[s+2]=o,t}};_n.prototype.bytesPerElement=12;C("StructArrayLayout2ub2f12",_n);var In=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r,n){let i=this.length;return this.resize(i+1),this.emplace(i,t,r,n)}emplace(t,r,n,i){let o=t*3;return this.uint16[o+0]=r,this.uint16[o+1]=n,this.uint16[o+2]=i,t}};In.prototype.bytesPerElement=6;C("StructArrayLayout3ui6",In);var Tn=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,n,i,o,a,s,l,u,c,p,f,y,m,h,d,g){let b=this.length;return this.resize(b+1),this.emplace(b,t,r,n,i,o,a,s,l,u,c,p,f,y,m,h,d,g)}emplace(t,r,n,i,o,a,s,l,u,c,p,f,y,m,h,d,g,b){let x=t*24,v=t*12,P=t*48;return this.int16[x+0]=r,this.int16[x+1]=n,this.uint16[x+2]=i,this.uint16[x+3]=o,this.uint32[v+2]=a,this.uint32[v+3]=s,this.uint32[v+4]=l,this.uint16[x+10]=u,this.uint16[x+11]=c,this.uint16[x+12]=p,this.float32[v+7]=f,this.float32[v+8]=y,this.uint8[P+36]=m,this.uint8[P+37]=h,this.uint8[P+38]=d,this.uint32[v+10]=g,this.int16[x+22]=b,t}};Tn.prototype.bytesPerElement=48;C("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Tn);var Cn=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,n,i,o,a,s,l,u,c,p,f,y,m,h,d,g,b,x,v,P,w,T,F,E,_,I,k){let V=this.length;return this.resize(V+1),this.emplace(V,t,r,n,i,o,a,s,l,u,c,p,f,y,m,h,d,g,b,x,v,P,w,T,F,E,_,I,k)}emplace(t,r,n,i,o,a,s,l,u,c,p,f,y,m,h,d,g,b,x,v,P,w,T,F,E,_,I,k,V){let A=t*32,z=t*16;return this.int16[A+0]=r,this.int16[A+1]=n,this.int16[A+2]=i,this.int16[A+3]=o,this.int16[A+4]=a,this.int16[A+5]=s,this.int16[A+6]=l,this.int16[A+7]=u,this.uint16[A+8]=c,this.uint16[A+9]=p,this.uint16[A+10]=f,this.uint16[A+11]=y,this.uint16[A+12]=m,this.uint16[A+13]=h,this.uint16[A+14]=d,this.uint16[A+15]=g,this.uint16[A+16]=b,this.uint16[A+17]=x,this.uint16[A+18]=v,this.uint16[A+19]=P,this.uint16[A+20]=w,this.uint16[A+21]=T,this.uint16[A+22]=F,this.uint32[z+12]=E,this.float32[z+13]=_,this.float32[z+14]=I,this.uint16[A+30]=k,this.uint16[A+31]=V,t}};Cn.prototype.bytesPerElement=64;C("StructArrayLayout8i15ui1ul2f2ui64",Cn);var Zt=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t){let r=this.length;return this.resize(r+1),this.emplace(r,t)}emplace(t,r){let n=t*1;return this.float32[n+0]=r,t}};Zt.prototype.bytesPerElement=4;C("StructArrayLayout1f4",Zt);var kn=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,n){let i=this.length;return this.resize(i+1),this.emplace(i,t,r,n)}emplace(t,r,n,i){let o=t*6,a=t*3;return this.uint16[o+0]=r,this.float32[a+1]=n,this.float32[a+2]=i,t}};kn.prototype.bytesPerElement=12;C("StructArrayLayout1ui2f12",kn);var Mn=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r,n){let i=this.length;return this.resize(i+1),this.emplace(i,t,r,n)}emplace(t,r,n,i){let o=t*2,a=t*4;return this.uint32[o+0]=r,this.uint16[a+2]=n,this.uint16[a+3]=i,t}};Mn.prototype.bytesPerElement=8;C("StructArrayLayout1ul2ui8",Mn);var En=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r){let n=this.length;return this.resize(n+1),this.emplace(n,t,r)}emplace(t,r,n){let i=t*2;return this.uint16[i+0]=r,this.uint16[i+1]=n,t}};En.prototype.bytesPerElement=4;C("StructArrayLayout2ui4",En);var yo=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t){let r=this.length;return this.resize(r+1),this.emplace(r,t)}emplace(t,r){let n=t*1;return this.uint16[n+0]=r,t}};yo.prototype.bytesPerElement=2;C("StructArrayLayout1ui2",yo);var Pr=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,n,i){let o=this.length;return this.resize(o+1),this.emplace(o,t,r,n,i)}emplace(t,r,n,i,o){let a=t*4;return this.float32[a+0]=r,this.float32[a+1]=n,this.float32[a+2]=i,this.float32[a+3]=o,t}};Pr.prototype.bytesPerElement=16;C("StructArrayLayout4f16",Pr);var mo=class extends Pt{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new Sc.default(this.anchorPointX,this.anchorPointY)}};mo.prototype.size=20;var Fn=class extends wn{get(t){return new mo(this,t)}};C("CollisionBoxArray",Fn);var ho=class extends Pt{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(t){this._structArray.uint8[this._pos1+37]=t}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(t){this._structArray.uint8[this._pos1+38]=t}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(t){this._structArray.uint32[this._pos4+10]=t}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}};ho.prototype.size=48;var Ln=class extends Tn{get(t){return new ho(this,t)}};C("PlacedSymbolArray",Ln);var go=class extends Pt{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(t){this._structArray.uint32[this._pos4+12]=t}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}};go.prototype.size=64;var Dn=class extends Cn{get(t){return new go(this,t)}};C("SymbolInstanceArray",Dn);var Vn=class extends Zt{getoffsetX(t){return this.float32[t*1+0]}};C("GlyphOffsetArray",Vn);var Bn=class extends dn{getx(t){return this.int16[t*3+0]}gety(t){return this.int16[t*3+1]}gettileUnitDistanceFromAnchor(t){return this.int16[t*3+2]}};C("SymbolLineVertexArray",Bn);var xo=class extends Pt{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}};xo.prototype.size=12;var zn=class extends kn{get(t){return new xo(this,t)}};C("TextAnchorOffsetArray",zn);var bo=class extends Pt{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}};bo.prototype.size=8;var Rn=class extends Mn{get(t){return new bo(this,t)}};C("FeatureIndexArray",Rn);var vo=class extends Jt{};var Po=class extends Jt{},So=class extends Jt{},wo=class extends gn{};var Ao=class extends xn{},_o=class extends St{},ut=class extends bn{},Io=class extends vn{},To=class extends Pn{},Co=class extends Sn{},On=class extends An{};var ko=class extends _n{};var Le=class extends In{},wt=class extends En{};var ad=Y([{name:"a_pos",components:2,type:"Int16"}],4);var{members:wc,size:Fv,alignment:Lv}=ad;var me=class e{constructor(t=[]){this.segments=t}prepareSegment(t,r,n,i){let o=this.segments[this.segments.length-1];return t>e.MAX_VERTEX_ARRAY_LENGTH&&fe(`Max vertices per segment is ${e.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${t}`),(!o||o.vertexLength+t>e.MAX_VERTEX_ARRAY_LENGTH||o.sortKey!==i)&&(o={vertexOffset:r.length,primitiveOffset:n.length,vertexLength:0,primitiveLength:0},i!==void 0&&(o.sortKey=i),this.segments.push(o)),o}get(){return this.segments}destroy(){for(let t of this.segments)for(let r in t.vaos)t.vaos[r].destroy()}static simpleSegment(t,r,n,i){return new e([{vertexOffset:t,primitiveOffset:r,vertexLength:n,primitiveLength:i,vaos:{},sortKey:0}])}};me.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1;C("SegmentVector",me);function ws(e,t){return e=it(Math.floor(e),0,255),t=it(Math.floor(t),0,255),256*e+t}var Nn=Y([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var Cc=Z(Is(),1);var Un=class e{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(t,r,n,i){this.ids.push(Tc(t)),this.positions.push(r,n,i)}getPositions(t){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");let r=Tc(t),n=0,i=this.ids.length-1;for(;n<i;){let a=n+i>>1;this.ids[a]>=r?i=a:n=a+1}let o=[];for(;this.ids[n]===r;){let a=this.positions[3*n],s=this.positions[3*n+1],l=this.positions[3*n+2];o.push({index:a,start:s,end:l}),n++}return o}static serialize(t,r){let n=new Float64Array(t.ids),i=new Uint32Array(t.positions);return Ts(n,i,0,n.length-1),r&&r.push(n.buffer,i.buffer),{ids:n,positions:i}}static deserialize(t){let r=new e;return r.ids=t.ids,r.positions=t.positions,r.indexed=!0,r}};function Tc(e){let t=+e;return!isNaN(t)&&t<=Number.MAX_SAFE_INTEGER?t:(0,Cc.default)(String(e))}function Ts(e,t,r,n){for(;r<n;){let i=e[r+n>>1],o=r-1,a=n+1;for(;;){do o++;while(e[o]<i);do a--;while(e[a]>i);if(o>=a)break;Eo(e,o,a),Eo(t,3*o,3*a),Eo(t,3*o+1,3*a+1),Eo(t,3*o+2,3*a+2)}a-r<n-a?(Ts(e,t,r,a),r=a+1):(Ts(e,t,a+1,n),n=a)}}function Eo(e,t,r){let n=e[t];e[t]=e[r],e[r]=n}C("FeaturePositionMap",Un);var $n=class{constructor(t,r){this.gl=t.gl,this.location=r}};var Sr=class extends $n{constructor(t,r){super(t,r),this.current=0}set(t){this.current!==t&&(this.current=t,this.gl.uniform1f(this.location,t))}};var Fo=class extends $n{constructor(t,r){super(t,r),this.current=[0,0,0,0]}set(t){(t[0]!==this.current[0]||t[1]!==this.current[1]||t[2]!==this.current[2]||t[3]!==this.current[3])&&(this.current=t,this.gl.uniform4f(this.location,t[0],t[1],t[2],t[3]))}},Lo=class extends $n{constructor(t,r){super(t,r),this.current=W.transparent}set(t){(t.r!==this.current.r||t.g!==this.current.g||t.b!==this.current.b||t.a!==this.current.a)&&(this.current=t,this.gl.uniform4f(this.location,t.r,t.g,t.b,t.a))}},Wv=new Float32Array(16);function Cs(e){return[ws(255*e.r,255*e.g),ws(255*e.b,255*e.a)]}var Wt=class{constructor(t,r,n){this.value=t,this.uniformNames=r.map(i=>`u_${i}`),this.type=n}setUniform(t,r,n){t.set(n.constantOr(this.value))}getBinding(t,r,n){return this.type==="color"?new Lo(t,r):new Sr(t,r)}},At=class{constructor(t,r){this.uniformNames=r.map(n=>`u_${n}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(t,r){this.pixelRatioFrom=r.pixelRatio,this.pixelRatioTo=t.pixelRatio,this.patternFrom=r.tlbr,this.patternTo=t.tlbr}setUniform(t,r,n,i){let o=i==="u_pattern_to"?this.patternTo:i==="u_pattern_from"?this.patternFrom:i==="u_pixel_ratio_to"?this.pixelRatioTo:i==="u_pixel_ratio_from"?this.pixelRatioFrom:null;o&&t.set(o)}getBinding(t,r,n){return n.substr(0,9)==="u_pattern"?new Fo(t,r):new Sr(t,r)}},We=class{constructor(t,r,n,i){this.expression=t,this.type=n,this.maxValue=0,this.paintVertexAttributes=r.map(o=>({name:`a_${o}`,type:"Float32",components:n==="color"?2:1,offset:0})),this.paintVertexArray=new i}populatePaintArray(t,r,n,i,o){let a=this.paintVertexArray.length,s=this.expression.evaluate(new q(0),r,{},i,[],o);this.paintVertexArray.resize(t),this._setPaintValue(a,t,s)}updatePaintArray(t,r,n,i){let o=this.expression.evaluate({zoom:0},n,i);this._setPaintValue(t,r,o)}_setPaintValue(t,r,n){if(this.type==="color"){let i=Cs(n);for(let o=t;o<r;o++)this.paintVertexArray.emplace(o,i[0],i[1])}else{for(let i=t;i<r;i++)this.paintVertexArray.emplace(i,n);this.maxValue=Math.max(this.maxValue,Math.abs(n))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}},De=class{constructor(t,r,n,i,o,a){this.expression=t,this.uniformNames=r.map(s=>`u_${s}_t`),this.type=n,this.useIntegerZoom=i,this.zoom=o,this.maxValue=0,this.paintVertexAttributes=r.map(s=>({name:`a_${s}`,type:"Float32",components:n==="color"?4:2,offset:0})),this.paintVertexArray=new a}populatePaintArray(t,r,n,i,o){let a=this.expression.evaluate(new q(this.zoom),r,{},i,[],o),s=this.expression.evaluate(new q(this.zoom+1),r,{},i,[],o),l=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(l,t,a,s)}updatePaintArray(t,r,n,i){let o=this.expression.evaluate({zoom:this.zoom},n,i),a=this.expression.evaluate({zoom:this.zoom+1},n,i);this._setPaintValue(t,r,o,a)}_setPaintValue(t,r,n,i){if(this.type==="color"){let o=Cs(n),a=Cs(i);for(let s=t;s<r;s++)this.paintVertexArray.emplace(s,o[0],o[1],a[0],a[1])}else{for(let o=t;o<r;o++)this.paintVertexArray.emplace(o,n,i);this.maxValue=Math.max(this.maxValue,Math.abs(n),Math.abs(i))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(t,r){let n=this.useIntegerZoom?Math.floor(r.zoom):r.zoom,i=it(this.expression.interpolationFactor(n,this.zoom,this.zoom+1),0,1);t.set(i)}getBinding(t,r,n){return new Sr(t,r)}},et=class{constructor(t,r,n,i,o,a){this.expression=t,this.type=r,this.useIntegerZoom=n,this.zoom=i,this.layerId=a,this.zoomInPaintVertexArray=new o,this.zoomOutPaintVertexArray=new o}populatePaintArray(t,r,n){let i=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(t),this.zoomOutPaintVertexArray.resize(t),this._setPaintValues(i,t,r.patterns&&r.patterns[this.layerId],n)}updatePaintArray(t,r,n,i,o){this._setPaintValues(t,r,n.patterns&&n.patterns[this.layerId],o)}_setPaintValues(t,r,n,i){if(!i||!n)return;let{min:o,mid:a,max:s}=n,l=i[o],u=i[a],c=i[s];if(!(!l||!u||!c))for(let p=t;p<r;p++)this.zoomInPaintVertexArray.emplace(p,u.tl[0],u.tl[1],u.br[0],u.br[1],l.tl[0],l.tl[1],l.br[0],l.br[1],u.pixelRatio,l.pixelRatio),this.zoomOutPaintVertexArray.emplace(p,u.tl[0],u.tl[1],u.br[0],u.br[1],c.tl[0],c.tl[1],c.br[0],c.br[1],u.pixelRatio,c.pixelRatio)}upload(t){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,Nn.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,Nn.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}},Do=class{constructor(t,r,n){this.binders={},this._buffers=[];let i=[];for(let o in t.paint._values){if(!n(o))continue;let a=t.paint.get(o);if(!(a instanceof Se)||!ht(a.property.specification))continue;let s=cd(o,t.type),l=a.value,u=a.property.specification.type,c=a.property.useIntegerZoom,p=a.property.specification["property-type"],f=p==="cross-faded"||p==="cross-faded-data-driven";if(l.kind==="constant")this.binders[o]=f?new At(l.value,s):new Wt(l.value,s,u),i.push(`/u_${o}`);else if(l.kind==="source"||f){let y=kc(o,u,"source");this.binders[o]=f?new et(l,u,c,r,y,t.id):new We(l,s,u,y),i.push(`/a_${o}`)}else{let y=kc(o,u,"composite");this.binders[o]=new De(l,s,u,c,r,y),i.push(`/z_${o}`)}}this.cacheKey=i.sort().join("")}getMaxValue(t){let r=this.binders[t];return r instanceof We||r instanceof De?r.maxValue:0}populatePaintArrays(t,r,n,i,o){for(let a in this.binders){let s=this.binders[a];(s instanceof We||s instanceof De||s instanceof et)&&s.populatePaintArray(t,r,n,i,o)}}setConstantPatternPositions(t,r){for(let n in this.binders){let i=this.binders[n];i instanceof At&&i.setConstantPatternPositions(t,r)}}updatePaintArrays(t,r,n,i,o){let a=!1;for(let s in t){let l=r.getPositions(s);for(let u of l){let c=n.feature(u.index);for(let p in this.binders){let f=this.binders[p];if((f instanceof We||f instanceof De||f instanceof et)&&f.expression.isStateDependent===!0){let y=i.paint.get(p);f.expression=y.value,f.updatePaintArray(u.start,u.end,c,t[s],o),a=!0}}}}return a}defines(){let t=[];for(let r in this.binders){let n=this.binders[r];(n instanceof Wt||n instanceof At)&&t.push(...n.uniformNames.map(i=>`#define HAS_UNIFORM_${i}`))}return t}getBinderAttributes(){let t=[];for(let r in this.binders){let n=this.binders[r];if(n instanceof We||n instanceof De)for(let i=0;i<n.paintVertexAttributes.length;i++)t.push(n.paintVertexAttributes[i].name);else if(n instanceof et)for(let i=0;i<Nn.members.length;i++)t.push(Nn.members[i].name)}return t}getBinderUniforms(){let t=[];for(let r in this.binders){let n=this.binders[r];if(n instanceof Wt||n instanceof At||n instanceof De)for(let i of n.uniformNames)t.push(i)}return t}getPaintVertexBuffers(){return this._buffers}getUniforms(t,r){let n=[];for(let i in this.binders){let o=this.binders[i];if(o instanceof Wt||o instanceof At||o instanceof De){for(let a of o.uniformNames)if(r[a]){let s=o.getBinding(t,r[a],a);n.push({name:a,property:i,binding:s})}}}return n}setUniforms(t,r,n,i){for(let{name:o,property:a,binding:s}of r)this.binders[a].setUniform(s,i,n.get(a),o)}updatePaintBuffers(t){this._buffers=[];for(let r in this.binders){let n=this.binders[r];if(t&&n instanceof et){let i=t.fromScale===2?n.zoomInPaintVertexBuffer:n.zoomOutPaintVertexBuffer;i&&this._buffers.push(i)}else(n instanceof We||n instanceof De)&&n.paintVertexBuffer&&this._buffers.push(n.paintVertexBuffer)}}upload(t){for(let r in this.binders){let n=this.binders[r];(n instanceof We||n instanceof De||n instanceof et)&&n.upload(t)}this.updatePaintBuffers()}destroy(){for(let t in this.binders){let r=this.binders[t];(r instanceof We||r instanceof De||r instanceof et)&&r.destroy()}}},Ce=class{constructor(t,r,n=()=>!0){this.programConfigurations={};for(let i of t)this.programConfigurations[i.id]=new Do(i,r,n);this.needsUpload=!1,this._featureMap=new Un,this._bufferOffset=0}populatePaintArrays(t,r,n,i,o,a){for(let s in this.programConfigurations)this.programConfigurations[s].populatePaintArrays(t,r,i,o,a);r.id!==void 0&&this._featureMap.add(r.id,n,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0}updatePaintArrays(t,r,n,i){for(let o of n)this.needsUpload=this.programConfigurations[o.id].updatePaintArrays(t,this._featureMap,r,o,i)||this.needsUpload}get(t){return this.programConfigurations[t]}upload(t){if(this.needsUpload){for(let r in this.programConfigurations)this.programConfigurations[r].upload(t);this.needsUpload=!1}}destroy(){for(let t in this.programConfigurations)this.programConfigurations[t].destroy()}};function cd(e,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[e]||[e.replace(`${t}-`,"").replace(/-/g,"_")]}function pd(e){return{"line-pattern":{source:ut,composite:ut},"fill-pattern":{source:ut,composite:ut},"fill-extrusion-pattern":{source:ut,composite:ut}}[e]}function kc(e,t,r){let n={color:{source:St,composite:Pr},number:{source:Zt,composite:St}},i=pd(e);return i&&i[r]||n[t][r]}C("ConstantBinder",Wt);C("CrossFadedConstantBinder",At);C("SourceExpressionBinder",We);C("CrossFadedCompositeBinder",et);C("CompositeExpressionBinder",De);C("ProgramConfiguration",Do,{omit:["_buffers"]});C("ProgramConfigurationSet",Ce);var fd=15,ks=Math.pow(2,fd-1)-1,Mc=-ks-1;function ke(e){let t=8192/e.extent,r=e.loadGeometry();for(let n=0;n<r.length;n++){let i=r[n];for(let o=0;o<i.length;o++){let a=i[o],s=Math.round(a.x*t),l=Math.round(a.y*t);a.x=it(s,Mc,ks),a.y=it(l,Mc,ks),(s<a.x||s>a.x+1||l<a.y||l>a.y+1)&&fe("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return r}function $e(e,t){return{type:e.type,id:e.id,properties:e.properties,geometry:t?ke(e):[]}}function Vo(e,t,r,n,i){e.emplaceBack(t*2+(n+1)/2,r*2+(i+1)/2)}var Ht=class{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(r=>r.id),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new Po,this.indexArray=new Le,this.segments=new me,this.programConfigurations=new Ce(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(t,r,n){let i=this.layers[0],o=[],a=null,s=!1;i.type==="circle"&&(a=i.layout.get("circle-sort-key"),s=!a.isConstant());for(let{feature:l,id:u,index:c,sourceLayerIndex:p}of t){let f=this.layers[0]._featureFilter.needGeometry,y=$e(l,f);if(!this.layers[0]._featureFilter.filter(new q(this.zoom),y,n))continue;let m=s?a.evaluate(y,{},n):void 0,h={id:u,properties:l.properties,type:l.type,sourceLayerIndex:p,index:c,geometry:f?y.geometry:ke(l),patterns:{},sortKey:m};o.push(h)}s&&o.sort((l,u)=>l.sortKey-u.sortKey);for(let l of o){let{geometry:u,index:c,sourceLayerIndex:p}=l,f=t[c].feature;this.addFeature(l,u,c,n),r.featureIndex.insert(f,u,c,p,this.index)}}update(t,r,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,r,this.stateDependentLayers,n)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,wc),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,r,n,i){for(let o of r)for(let a of o){let s=a.x,l=a.y;if(s<0||s>=8192||l<0||l>=8192)continue;let u=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,t.sortKey),c=u.vertexLength;Vo(this.layoutVertexArray,s,l,-1,-1),Vo(this.layoutVertexArray,s,l,1,-1),Vo(this.layoutVertexArray,s,l,1,1),Vo(this.layoutVertexArray,s,l,-1,1),this.indexArray.emplaceBack(c,c+1,c+2),this.indexArray.emplaceBack(c,c+3,c+2),u.vertexLength+=4,u.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,n,{},i)}};C("CircleBucket",Ht,{omit:["layers"]});var Gn=Z(he(),1);function Fc(e,t){for(let r=0;r<e.length;r++)if(wr(t,e[r]))return!0;for(let r=0;r<t.length;r++)if(wr(e,t[r]))return!0;return!!Es(e,t)}function Lc(e,t,r){return!!(wr(e,t)||Ms(t,e,r))}function Bo(e,t){if(e.length===1)return Ec(t,e[0]);for(let r=0;r<t.length;r++){let n=t[r];for(let i=0;i<n.length;i++)if(wr(e,n[i]))return!0}for(let r=0;r<e.length;r++)if(Ec(t,e[r]))return!0;for(let r=0;r<t.length;r++)if(Es(e,t[r]))return!0;return!1}function Dc(e,t,r){for(let n=0;n<t.length;n++){let i=t[n];if(e.length>=3){for(let o=0;o<i.length;o++)if(wr(e,i[o]))return!0}if(yd(e,i,r))return!0}return!1}function yd(e,t,r){if(e.length>1){if(Es(e,t))return!0;for(let n=0;n<t.length;n++)if(Ms(t[n],e,r))return!0}for(let n=0;n<e.length;n++)if(Ms(e[n],t,r))return!0;return!1}function Es(e,t){if(e.length===0||t.length===0)return!1;for(let r=0;r<e.length-1;r++){let n=e[r],i=e[r+1];for(let o=0;o<t.length-1;o++){let a=t[o],s=t[o+1];if(md(n,i,a,s))return!0}}return!1}function md(e,t,r,n){return ot(e,r,n)!==ot(t,r,n)&&ot(e,t,r)!==ot(e,t,n)}function Ms(e,t,r){let n=r*r;if(t.length===1)return e.distSqr(t[0])<n;for(let i=1;i<t.length;i++){let o=t[i-1],a=t[i];if(Fs(e,o,a)<n)return!0}return!1}function Fs(e,t,r){let n=t.distSqr(r);if(n===0)return e.distSqr(t);let i=((e.x-t.x)*(r.x-t.x)+(e.y-t.y)*(r.y-t.y))/n;return i<0?e.distSqr(t):i>1?e.distSqr(r):e.distSqr(r.sub(t)._mult(i)._add(t))}function Ec(e,t){let r=!1,n,i,o;for(let a=0;a<e.length;a++){n=e[a];for(let s=0,l=n.length-1;s<n.length;l=s++)i=n[s],o=n[l],i.y>t.y!=o.y>t.y&&t.x<(o.x-i.x)*(t.y-i.y)/(o.y-i.y)+i.x&&(r=!r)}return r}function wr(e,t){let r=!1;for(let n=0,i=e.length-1;n<e.length;i=n++){let o=e[n],a=e[i];o.y>t.y!=a.y>t.y&&t.x<(a.x-o.x)*(t.y-o.y)/(a.y-o.y)+o.x&&(r=!r)}return r}function Vc(e,t,r,n,i){for(let a of e)if(t<=a.x&&r<=a.y&&n>=a.x&&i>=a.y)return!0;let o=[new Gn.default(t,r),new Gn.default(t,i),new Gn.default(n,i),new Gn.default(n,r)];if(e.length>2){for(let a of o)if(wr(e,a))return!0}for(let a=0;a<e.length-1;a++){let s=e[a],l=e[a+1];if(hd(s,l,o))return!0}return!1}function hd(e,t,r){let n=r[0],i=r[2];if(e.x<n.x&&t.x<n.x||e.x>i.x&&t.x>i.x||e.y<n.y&&t.y<n.y||e.y>i.y&&t.y>i.y)return!1;let o=ot(e,t,r[0]);return o!==ot(e,t,r[1])||o!==ot(e,t,r[2])||o!==ot(e,t,r[3])}var zo=Z(he(),1);function Xt(e,t,r){let n=t.paint.get(e).value;return n.kind==="constant"?n.value:r.programConfigurations.get(t.id).getMaxValue(e)}function _t(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function It(e,t,r,n,i){if(!t[0]&&!t[1])return e;let o=zo.default.convert(t)._mult(i);r==="viewport"&&o._rotate(-n);let a=[];for(let s=0;s<e.length;s++){let l=e[s];a.push(l.sub(o))}return a}function Bc(e,t){let r=[];for(let n=0;n<e.length;n++){let i=e[n],o=[];for(let a=0;a<i.length;a++){let s=i[a-1],l=i[a],u=i[a+1],c=a===0?new zo.default(0,0):l.sub(s)._unit()._perp(),p=a===i.length-1?new zo.default(0,0):u.sub(l)._unit()._perp(),f=c._add(p)._unit(),y=f.x*p.x+f.y*p.y;y!==0&&f._mult(1/y),o.push(f._mult(t)._add(l))}r.push(o)}return r}var zc,dd=()=>zc=zc||new re({"circle-sort-key":new R(S.layout_circle["circle-sort-key"])}),Rc,gd=()=>Rc=Rc||new re({"circle-radius":new R(S.paint_circle["circle-radius"]),"circle-color":new R(S.paint_circle["circle-color"]),"circle-blur":new R(S.paint_circle["circle-blur"]),"circle-opacity":new R(S.paint_circle["circle-opacity"]),"circle-translate":new B(S.paint_circle["circle-translate"]),"circle-translate-anchor":new B(S.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new B(S.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new B(S.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new R(S.paint_circle["circle-stroke-width"]),"circle-stroke-color":new R(S.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new R(S.paint_circle["circle-stroke-opacity"])}),Oc={get paint(){return gd()},get layout(){return dd()}};var Q=1e-6,Ge=typeof Float32Array<"u"?Float32Array:Array,qn=Math.random;var N1=Math.PI/180;Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)});var jn={};Ll(jn,{add:()=>tg,adjoint:()=>_d,clone:()=>bd,copy:()=>vd,create:()=>xd,determinant:()=>Id,equals:()=>og,exactEquals:()=>ig,frob:()=>eg,fromQuat:()=>qd,fromQuat2:()=>Od,fromRotation:()=>Vd,fromRotationTranslation:()=>Gc,fromRotationTranslationScale:()=>$d,fromRotationTranslationScaleOrigin:()=>Gd,fromScaling:()=>Dd,fromTranslation:()=>Ld,fromValues:()=>Pd,fromXRotation:()=>Bd,fromYRotation:()=>zd,fromZRotation:()=>Rd,frustum:()=>jd,getRotation:()=>Ud,getScaling:()=>qc,getTranslation:()=>Nd,identity:()=>Uc,invert:()=>Ad,lookAt:()=>Kd,mul:()=>ag,multiply:()=>$c,multiplyScalar:()=>rg,multiplyScalarAndAdd:()=>ng,ortho:()=>Hd,orthoNO:()=>Jc,orthoZO:()=>Xd,perspective:()=>Jd,perspectiveFromFieldOfView:()=>Wd,perspectiveNO:()=>jc,perspectiveZO:()=>Zd,rotate:()=>kd,rotateX:()=>Md,rotateY:()=>Ed,rotateZ:()=>Fd,scale:()=>Cd,set:()=>Sd,str:()=>Qd,sub:()=>sg,subtract:()=>Zc,targetTo:()=>Yd,translate:()=>Td,transpose:()=>wd});function xd(){var e=new Ge(16);return Ge!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function bd(e){var t=new Ge(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function vd(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function Pd(e,t,r,n,i,o,a,s,l,u,c,p,f,y,m,h){var d=new Ge(16);return d[0]=e,d[1]=t,d[2]=r,d[3]=n,d[4]=i,d[5]=o,d[6]=a,d[7]=s,d[8]=l,d[9]=u,d[10]=c,d[11]=p,d[12]=f,d[13]=y,d[14]=m,d[15]=h,d}function Sd(e,t,r,n,i,o,a,s,l,u,c,p,f,y,m,h,d){return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e[4]=o,e[5]=a,e[6]=s,e[7]=l,e[8]=u,e[9]=c,e[10]=p,e[11]=f,e[12]=y,e[13]=m,e[14]=h,e[15]=d,e}function Uc(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function wd(e,t){if(e===t){var r=t[1],n=t[2],i=t[3],o=t[6],a=t[7],s=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=r,e[6]=t[9],e[7]=t[13],e[8]=n,e[9]=o,e[11]=t[14],e[12]=i,e[13]=a,e[14]=s}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e}function Ad(e,t){var r=t[0],n=t[1],i=t[2],o=t[3],a=t[4],s=t[5],l=t[6],u=t[7],c=t[8],p=t[9],f=t[10],y=t[11],m=t[12],h=t[13],d=t[14],g=t[15],b=r*s-n*a,x=r*l-i*a,v=r*u-o*a,P=n*l-i*s,w=n*u-o*s,T=i*u-o*l,F=c*h-p*m,E=c*d-f*m,_=c*g-y*m,I=p*d-f*h,k=p*g-y*h,V=f*g-y*d,A=b*V-x*k+v*I+P*_-w*E+T*F;return A?(A=1/A,e[0]=(s*V-l*k+u*I)*A,e[1]=(i*k-n*V-o*I)*A,e[2]=(h*T-d*w+g*P)*A,e[3]=(f*w-p*T-y*P)*A,e[4]=(l*_-a*V-u*E)*A,e[5]=(r*V-i*_+o*E)*A,e[6]=(d*v-m*T-g*x)*A,e[7]=(c*T-f*v+y*x)*A,e[8]=(a*k-s*_+u*F)*A,e[9]=(n*_-r*k-o*F)*A,e[10]=(m*w-h*v+g*b)*A,e[11]=(p*v-c*w-y*b)*A,e[12]=(s*E-a*I-l*F)*A,e[13]=(r*I-n*E+i*F)*A,e[14]=(h*x-m*P-d*b)*A,e[15]=(c*P-p*x+f*b)*A,e):null}function _d(e,t){var r=t[0],n=t[1],i=t[2],o=t[3],a=t[4],s=t[5],l=t[6],u=t[7],c=t[8],p=t[9],f=t[10],y=t[11],m=t[12],h=t[13],d=t[14],g=t[15];return e[0]=s*(f*g-y*d)-p*(l*g-u*d)+h*(l*y-u*f),e[1]=-(n*(f*g-y*d)-p*(i*g-o*d)+h*(i*y-o*f)),e[2]=n*(l*g-u*d)-s*(i*g-o*d)+h*(i*u-o*l),e[3]=-(n*(l*y-u*f)-s*(i*y-o*f)+p*(i*u-o*l)),e[4]=-(a*(f*g-y*d)-c*(l*g-u*d)+m*(l*y-u*f)),e[5]=r*(f*g-y*d)-c*(i*g-o*d)+m*(i*y-o*f),e[6]=-(r*(l*g-u*d)-a*(i*g-o*d)+m*(i*u-o*l)),e[7]=r*(l*y-u*f)-a*(i*y-o*f)+c*(i*u-o*l),e[8]=a*(p*g-y*h)-c*(s*g-u*h)+m*(s*y-u*p),e[9]=-(r*(p*g-y*h)-c*(n*g-o*h)+m*(n*y-o*p)),e[10]=r*(s*g-u*h)-a*(n*g-o*h)+m*(n*u-o*s),e[11]=-(r*(s*y-u*p)-a*(n*y-o*p)+c*(n*u-o*s)),e[12]=-(a*(p*d-f*h)-c*(s*d-l*h)+m*(s*f-l*p)),e[13]=r*(p*d-f*h)-c*(n*d-i*h)+m*(n*f-i*p),e[14]=-(r*(s*d-l*h)-a*(n*d-i*h)+m*(n*l-i*s)),e[15]=r*(s*f-l*p)-a*(n*f-i*p)+c*(n*l-i*s),e}function Id(e){var t=e[0],r=e[1],n=e[2],i=e[3],o=e[4],a=e[5],s=e[6],l=e[7],u=e[8],c=e[9],p=e[10],f=e[11],y=e[12],m=e[13],h=e[14],d=e[15],g=t*a-r*o,b=t*s-n*o,x=t*l-i*o,v=r*s-n*a,P=r*l-i*a,w=n*l-i*s,T=u*m-c*y,F=u*h-p*y,E=u*d-f*y,_=c*h-p*m,I=c*d-f*m,k=p*d-f*h;return g*k-b*I+x*_+v*E-P*F+w*T}function $c(e,t,r){var n=t[0],i=t[1],o=t[2],a=t[3],s=t[4],l=t[5],u=t[6],c=t[7],p=t[8],f=t[9],y=t[10],m=t[11],h=t[12],d=t[13],g=t[14],b=t[15],x=r[0],v=r[1],P=r[2],w=r[3];return e[0]=x*n+v*s+P*p+w*h,e[1]=x*i+v*l+P*f+w*d,e[2]=x*o+v*u+P*y+w*g,e[3]=x*a+v*c+P*m+w*b,x=r[4],v=r[5],P=r[6],w=r[7],e[4]=x*n+v*s+P*p+w*h,e[5]=x*i+v*l+P*f+w*d,e[6]=x*o+v*u+P*y+w*g,e[7]=x*a+v*c+P*m+w*b,x=r[8],v=r[9],P=r[10],w=r[11],e[8]=x*n+v*s+P*p+w*h,e[9]=x*i+v*l+P*f+w*d,e[10]=x*o+v*u+P*y+w*g,e[11]=x*a+v*c+P*m+w*b,x=r[12],v=r[13],P=r[14],w=r[15],e[12]=x*n+v*s+P*p+w*h,e[13]=x*i+v*l+P*f+w*d,e[14]=x*o+v*u+P*y+w*g,e[15]=x*a+v*c+P*m+w*b,e}function Td(e,t,r){var n=r[0],i=r[1],o=r[2],a,s,l,u,c,p,f,y,m,h,d,g;return t===e?(e[12]=t[0]*n+t[4]*i+t[8]*o+t[12],e[13]=t[1]*n+t[5]*i+t[9]*o+t[13],e[14]=t[2]*n+t[6]*i+t[10]*o+t[14],e[15]=t[3]*n+t[7]*i+t[11]*o+t[15]):(a=t[0],s=t[1],l=t[2],u=t[3],c=t[4],p=t[5],f=t[6],y=t[7],m=t[8],h=t[9],d=t[10],g=t[11],e[0]=a,e[1]=s,e[2]=l,e[3]=u,e[4]=c,e[5]=p,e[6]=f,e[7]=y,e[8]=m,e[9]=h,e[10]=d,e[11]=g,e[12]=a*n+c*i+m*o+t[12],e[13]=s*n+p*i+h*o+t[13],e[14]=l*n+f*i+d*o+t[14],e[15]=u*n+y*i+g*o+t[15]),e}function Cd(e,t,r){var n=r[0],i=r[1],o=r[2];return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*o,e[9]=t[9]*o,e[10]=t[10]*o,e[11]=t[11]*o,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function kd(e,t,r,n){var i=n[0],o=n[1],a=n[2],s=Math.hypot(i,o,a),l,u,c,p,f,y,m,h,d,g,b,x,v,P,w,T,F,E,_,I,k,V,A,z;return s<Q?null:(s=1/s,i*=s,o*=s,a*=s,l=Math.sin(r),u=Math.cos(r),c=1-u,p=t[0],f=t[1],y=t[2],m=t[3],h=t[4],d=t[5],g=t[6],b=t[7],x=t[8],v=t[9],P=t[10],w=t[11],T=i*i*c+u,F=o*i*c+a*l,E=a*i*c-o*l,_=i*o*c-a*l,I=o*o*c+u,k=a*o*c+i*l,V=i*a*c+o*l,A=o*a*c-i*l,z=a*a*c+u,e[0]=p*T+h*F+x*E,e[1]=f*T+d*F+v*E,e[2]=y*T+g*F+P*E,e[3]=m*T+b*F+w*E,e[4]=p*_+h*I+x*k,e[5]=f*_+d*I+v*k,e[6]=y*_+g*I+P*k,e[7]=m*_+b*I+w*k,e[8]=p*V+h*A+x*z,e[9]=f*V+d*A+v*z,e[10]=y*V+g*A+P*z,e[11]=m*V+b*A+w*z,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)}function Md(e,t,r){var n=Math.sin(r),i=Math.cos(r),o=t[4],a=t[5],s=t[6],l=t[7],u=t[8],c=t[9],p=t[10],f=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=o*i+u*n,e[5]=a*i+c*n,e[6]=s*i+p*n,e[7]=l*i+f*n,e[8]=u*i-o*n,e[9]=c*i-a*n,e[10]=p*i-s*n,e[11]=f*i-l*n,e}function Ed(e,t,r){var n=Math.sin(r),i=Math.cos(r),o=t[0],a=t[1],s=t[2],l=t[3],u=t[8],c=t[9],p=t[10],f=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*i-u*n,e[1]=a*i-c*n,e[2]=s*i-p*n,e[3]=l*i-f*n,e[8]=o*n+u*i,e[9]=a*n+c*i,e[10]=s*n+p*i,e[11]=l*n+f*i,e}function Fd(e,t,r){var n=Math.sin(r),i=Math.cos(r),o=t[0],a=t[1],s=t[2],l=t[3],u=t[4],c=t[5],p=t[6],f=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*i+u*n,e[1]=a*i+c*n,e[2]=s*i+p*n,e[3]=l*i+f*n,e[4]=u*i-o*n,e[5]=c*i-a*n,e[6]=p*i-s*n,e[7]=f*i-l*n,e}function Ld(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function Dd(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Vd(e,t,r){var n=r[0],i=r[1],o=r[2],a=Math.hypot(n,i,o),s,l,u;return a<Q?null:(a=1/a,n*=a,i*=a,o*=a,s=Math.sin(t),l=Math.cos(t),u=1-l,e[0]=n*n*u+l,e[1]=i*n*u+o*s,e[2]=o*n*u-i*s,e[3]=0,e[4]=n*i*u-o*s,e[5]=i*i*u+l,e[6]=o*i*u+n*s,e[7]=0,e[8]=n*o*u+i*s,e[9]=i*o*u-n*s,e[10]=o*o*u+l,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)}function Bd(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=n,e[6]=r,e[7]=0,e[8]=0,e[9]=-r,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function zd(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=0,e[2]=-r,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=r,e[9]=0,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Rd(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=r,e[2]=0,e[3]=0,e[4]=-r,e[5]=n,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Gc(e,t,r){var n=t[0],i=t[1],o=t[2],a=t[3],s=n+n,l=i+i,u=o+o,c=n*s,p=n*l,f=n*u,y=i*l,m=i*u,h=o*u,d=a*s,g=a*l,b=a*u;return e[0]=1-(y+h),e[1]=p+b,e[2]=f-g,e[3]=0,e[4]=p-b,e[5]=1-(c+h),e[6]=m+d,e[7]=0,e[8]=f+g,e[9]=m-d,e[10]=1-(c+y),e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e}function Od(e,t){var r=new Ge(3),n=-t[0],i=-t[1],o=-t[2],a=t[3],s=t[4],l=t[5],u=t[6],c=t[7],p=n*n+i*i+o*o+a*a;return p>0?(r[0]=(s*a+c*n+l*o-u*i)*2/p,r[1]=(l*a+c*i+u*n-s*o)*2/p,r[2]=(u*a+c*o+s*i-l*n)*2/p):(r[0]=(s*a+c*n+l*o-u*i)*2,r[1]=(l*a+c*i+u*n-s*o)*2,r[2]=(u*a+c*o+s*i-l*n)*2),Gc(e,t,r),e}function Nd(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e}function qc(e,t){var r=t[0],n=t[1],i=t[2],o=t[4],a=t[5],s=t[6],l=t[8],u=t[9],c=t[10];return e[0]=Math.hypot(r,n,i),e[1]=Math.hypot(o,a,s),e[2]=Math.hypot(l,u,c),e}function Ud(e,t){var r=new Ge(3);qc(r,t);var n=1/r[0],i=1/r[1],o=1/r[2],a=t[0]*n,s=t[1]*i,l=t[2]*o,u=t[4]*n,c=t[5]*i,p=t[6]*o,f=t[8]*n,y=t[9]*i,m=t[10]*o,h=a+c+m,d=0;return h>0?(d=Math.sqrt(h+1)*2,e[3]=.25*d,e[0]=(p-y)/d,e[1]=(f-l)/d,e[2]=(s-u)/d):a>c&&a>m?(d=Math.sqrt(1+a-c-m)*2,e[3]=(p-y)/d,e[0]=.25*d,e[1]=(s+u)/d,e[2]=(f+l)/d):c>m?(d=Math.sqrt(1+c-a-m)*2,e[3]=(f-l)/d,e[0]=(s+u)/d,e[1]=.25*d,e[2]=(p+y)/d):(d=Math.sqrt(1+m-a-c)*2,e[3]=(s-u)/d,e[0]=(f+l)/d,e[1]=(p+y)/d,e[2]=.25*d),e}function $d(e,t,r,n){var i=t[0],o=t[1],a=t[2],s=t[3],l=i+i,u=o+o,c=a+a,p=i*l,f=i*u,y=i*c,m=o*u,h=o*c,d=a*c,g=s*l,b=s*u,x=s*c,v=n[0],P=n[1],w=n[2];return e[0]=(1-(m+d))*v,e[1]=(f+x)*v,e[2]=(y-b)*v,e[3]=0,e[4]=(f-x)*P,e[5]=(1-(p+d))*P,e[6]=(h+g)*P,e[7]=0,e[8]=(y+b)*w,e[9]=(h-g)*w,e[10]=(1-(p+m))*w,e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e}function Gd(e,t,r,n,i){var o=t[0],a=t[1],s=t[2],l=t[3],u=o+o,c=a+a,p=s+s,f=o*u,y=o*c,m=o*p,h=a*c,d=a*p,g=s*p,b=l*u,x=l*c,v=l*p,P=n[0],w=n[1],T=n[2],F=i[0],E=i[1],_=i[2],I=(1-(h+g))*P,k=(y+v)*P,V=(m-x)*P,A=(y-v)*w,z=(1-(f+g))*w,O=(d+b)*w,N=(m+x)*T,K=(d-b)*T,xe=(1-(f+h))*T;return e[0]=I,e[1]=k,e[2]=V,e[3]=0,e[4]=A,e[5]=z,e[6]=O,e[7]=0,e[8]=N,e[9]=K,e[10]=xe,e[11]=0,e[12]=r[0]+F-(I*F+A*E+N*_),e[13]=r[1]+E-(k*F+z*E+K*_),e[14]=r[2]+_-(V*F+O*E+xe*_),e[15]=1,e}function qd(e,t){var r=t[0],n=t[1],i=t[2],o=t[3],a=r+r,s=n+n,l=i+i,u=r*a,c=n*a,p=n*s,f=i*a,y=i*s,m=i*l,h=o*a,d=o*s,g=o*l;return e[0]=1-p-m,e[1]=c+g,e[2]=f-d,e[3]=0,e[4]=c-g,e[5]=1-u-m,e[6]=y+h,e[7]=0,e[8]=f+d,e[9]=y-h,e[10]=1-u-p,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function jd(e,t,r,n,i,o,a){var s=1/(r-t),l=1/(i-n),u=1/(o-a);return e[0]=o*2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=o*2*l,e[6]=0,e[7]=0,e[8]=(r+t)*s,e[9]=(i+n)*l,e[10]=(a+o)*u,e[11]=-1,e[12]=0,e[13]=0,e[14]=a*o*2*u,e[15]=0,e}function jc(e,t,r,n,i){var o=1/Math.tan(t/2),a;return e[0]=o/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=o,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,i!=null&&i!==1/0?(a=1/(n-i),e[10]=(i+n)*a,e[14]=2*i*n*a):(e[10]=-1,e[14]=-2*n),e}var Jd=jc;function Zd(e,t,r,n,i){var o=1/Math.tan(t/2),a;return e[0]=o/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=o,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,i!=null&&i!==1/0?(a=1/(n-i),e[10]=i*a,e[14]=i*n*a):(e[10]=-1,e[14]=-n),e}function Wd(e,t,r,n){var i=Math.tan(t.upDegrees*Math.PI/180),o=Math.tan(t.downDegrees*Math.PI/180),a=Math.tan(t.leftDegrees*Math.PI/180),s=Math.tan(t.rightDegrees*Math.PI/180),l=2/(a+s),u=2/(i+o);return e[0]=l,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=u,e[6]=0,e[7]=0,e[8]=-((a-s)*l*.5),e[9]=(i-o)*u*.5,e[10]=n/(r-n),e[11]=-1,e[12]=0,e[13]=0,e[14]=n*r/(r-n),e[15]=0,e}function Jc(e,t,r,n,i,o,a){var s=1/(t-r),l=1/(n-i),u=1/(o-a);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*u,e[11]=0,e[12]=(t+r)*s,e[13]=(i+n)*l,e[14]=(a+o)*u,e[15]=1,e}var Hd=Jc;function Xd(e,t,r,n,i,o,a){var s=1/(t-r),l=1/(n-i),u=1/(o-a);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=u,e[11]=0,e[12]=(t+r)*s,e[13]=(i+n)*l,e[14]=o*u,e[15]=1,e}function Kd(e,t,r,n){var i,o,a,s,l,u,c,p,f,y,m=t[0],h=t[1],d=t[2],g=n[0],b=n[1],x=n[2],v=r[0],P=r[1],w=r[2];return Math.abs(m-v)<Q&&Math.abs(h-P)<Q&&Math.abs(d-w)<Q?Uc(e):(c=m-v,p=h-P,f=d-w,y=1/Math.hypot(c,p,f),c*=y,p*=y,f*=y,i=b*f-x*p,o=x*c-g*f,a=g*p-b*c,y=Math.hypot(i,o,a),y?(y=1/y,i*=y,o*=y,a*=y):(i=0,o=0,a=0),s=p*a-f*o,l=f*i-c*a,u=c*o-p*i,y=Math.hypot(s,l,u),y?(y=1/y,s*=y,l*=y,u*=y):(s=0,l=0,u=0),e[0]=i,e[1]=s,e[2]=c,e[3]=0,e[4]=o,e[5]=l,e[6]=p,e[7]=0,e[8]=a,e[9]=u,e[10]=f,e[11]=0,e[12]=-(i*m+o*h+a*d),e[13]=-(s*m+l*h+u*d),e[14]=-(c*m+p*h+f*d),e[15]=1,e)}function Yd(e,t,r,n){var i=t[0],o=t[1],a=t[2],s=n[0],l=n[1],u=n[2],c=i-r[0],p=o-r[1],f=a-r[2],y=c*c+p*p+f*f;y>0&&(y=1/Math.sqrt(y),c*=y,p*=y,f*=y);var m=l*f-u*p,h=u*c-s*f,d=s*p-l*c;return y=m*m+h*h+d*d,y>0&&(y=1/Math.sqrt(y),m*=y,h*=y,d*=y),e[0]=m,e[1]=h,e[2]=d,e[3]=0,e[4]=p*d-f*h,e[5]=f*m-c*d,e[6]=c*h-p*m,e[7]=0,e[8]=c,e[9]=p,e[10]=f,e[11]=0,e[12]=i,e[13]=o,e[14]=a,e[15]=1,e}function Qd(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"}function eg(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])}function tg(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e[6]=t[6]+r[6],e[7]=t[7]+r[7],e[8]=t[8]+r[8],e[9]=t[9]+r[9],e[10]=t[10]+r[10],e[11]=t[11]+r[11],e[12]=t[12]+r[12],e[13]=t[13]+r[13],e[14]=t[14]+r[14],e[15]=t[15]+r[15],e}function Zc(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e[6]=t[6]-r[6],e[7]=t[7]-r[7],e[8]=t[8]-r[8],e[9]=t[9]-r[9],e[10]=t[10]-r[10],e[11]=t[11]-r[11],e[12]=t[12]-r[12],e[13]=t[13]-r[13],e[14]=t[14]-r[14],e[15]=t[15]-r[15],e}function rg(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*r,e[9]=t[9]*r,e[10]=t[10]*r,e[11]=t[11]*r,e[12]=t[12]*r,e[13]=t[13]*r,e[14]=t[14]*r,e[15]=t[15]*r,e}function ng(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e[4]=t[4]+r[4]*n,e[5]=t[5]+r[5]*n,e[6]=t[6]+r[6]*n,e[7]=t[7]+r[7]*n,e[8]=t[8]+r[8]*n,e[9]=t[9]+r[9]*n,e[10]=t[10]+r[10]*n,e[11]=t[11]+r[11]*n,e[12]=t[12]+r[12]*n,e[13]=t[13]+r[13]*n,e[14]=t[14]+r[14]*n,e[15]=t[15]+r[15]*n,e}function ig(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]}function og(e,t){var r=e[0],n=e[1],i=e[2],o=e[3],a=e[4],s=e[5],l=e[6],u=e[7],c=e[8],p=e[9],f=e[10],y=e[11],m=e[12],h=e[13],d=e[14],g=e[15],b=t[0],x=t[1],v=t[2],P=t[3],w=t[4],T=t[5],F=t[6],E=t[7],_=t[8],I=t[9],k=t[10],V=t[11],A=t[12],z=t[13],O=t[14],N=t[15];return Math.abs(r-b)<=Q*Math.max(1,Math.abs(r),Math.abs(b))&&Math.abs(n-x)<=Q*Math.max(1,Math.abs(n),Math.abs(x))&&Math.abs(i-v)<=Q*Math.max(1,Math.abs(i),Math.abs(v))&&Math.abs(o-P)<=Q*Math.max(1,Math.abs(o),Math.abs(P))&&Math.abs(a-w)<=Q*Math.max(1,Math.abs(a),Math.abs(w))&&Math.abs(s-T)<=Q*Math.max(1,Math.abs(s),Math.abs(T))&&Math.abs(l-F)<=Q*Math.max(1,Math.abs(l),Math.abs(F))&&Math.abs(u-E)<=Q*Math.max(1,Math.abs(u),Math.abs(E))&&Math.abs(c-_)<=Q*Math.max(1,Math.abs(c),Math.abs(_))&&Math.abs(p-I)<=Q*Math.max(1,Math.abs(p),Math.abs(I))&&Math.abs(f-k)<=Q*Math.max(1,Math.abs(f),Math.abs(k))&&Math.abs(y-V)<=Q*Math.max(1,Math.abs(y),Math.abs(V))&&Math.abs(m-A)<=Q*Math.max(1,Math.abs(m),Math.abs(A))&&Math.abs(h-z)<=Q*Math.max(1,Math.abs(h),Math.abs(z))&&Math.abs(d-O)<=Q*Math.max(1,Math.abs(d),Math.abs(O))&&Math.abs(g-N)<=Q*Math.max(1,Math.abs(g),Math.abs(N))}var ag=$c,sg=Zc;var Kt={};Ll(Kt,{add:()=>fg,ceil:()=>yg,clone:()=>lg,copy:()=>cg,create:()=>Wc,cross:()=>Ag,dist:()=>Bg,distance:()=>Yc,div:()=>Vg,divide:()=>Kc,dot:()=>wg,equals:()=>Fg,exactEquals:()=>Eg,floor:()=>mg,forEach:()=>Ng,fromValues:()=>ug,inverse:()=>Pg,len:()=>Rg,length:()=>ep,lerp:()=>_g,max:()=>dg,min:()=>hg,mul:()=>Dg,multiply:()=>Xc,negate:()=>vg,normalize:()=>Sg,random:()=>Ig,round:()=>gg,scale:()=>xg,scaleAndAdd:()=>bg,set:()=>pg,sqrDist:()=>zg,sqrLen:()=>Og,squaredDistance:()=>Qc,squaredLength:()=>tp,str:()=>Mg,sub:()=>Lg,subtract:()=>Hc,transformMat4:()=>Tg,transformQuat:()=>Cg,zero:()=>kg});function Wc(){var e=new Ge(4);return Ge!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function lg(e){var t=new Ge(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function ug(e,t,r,n){var i=new Ge(4);return i[0]=e,i[1]=t,i[2]=r,i[3]=n,i}function cg(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function pg(e,t,r,n,i){return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e}function fg(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e}function Hc(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e}function Xc(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e[3]=t[3]*r[3],e}function Kc(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e[3]=t[3]/r[3],e}function yg(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e[3]=Math.ceil(t[3]),e}function mg(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e[3]=Math.floor(t[3]),e}function hg(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e[3]=Math.min(t[3],r[3]),e}function dg(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2]),e[3]=Math.max(t[3],r[3]),e}function gg(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e[3]=Math.round(t[3]),e}function xg(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e}function bg(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e}function Yc(e,t){var r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2],o=t[3]-e[3];return Math.hypot(r,n,i,o)}function Qc(e,t){var r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2],o=t[3]-e[3];return r*r+n*n+i*i+o*o}function ep(e){var t=e[0],r=e[1],n=e[2],i=e[3];return Math.hypot(t,r,n,i)}function tp(e){var t=e[0],r=e[1],n=e[2],i=e[3];return t*t+r*r+n*n+i*i}function vg(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e}function Pg(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e[3]=1/t[3],e}function Sg(e,t){var r=t[0],n=t[1],i=t[2],o=t[3],a=r*r+n*n+i*i+o*o;return a>0&&(a=1/Math.sqrt(a)),e[0]=r*a,e[1]=n*a,e[2]=i*a,e[3]=o*a,e}function wg(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}function Ag(e,t,r,n){var i=r[0]*n[1]-r[1]*n[0],o=r[0]*n[2]-r[2]*n[0],a=r[0]*n[3]-r[3]*n[0],s=r[1]*n[2]-r[2]*n[1],l=r[1]*n[3]-r[3]*n[1],u=r[2]*n[3]-r[3]*n[2],c=t[0],p=t[1],f=t[2],y=t[3];return e[0]=p*u-f*l+y*s,e[1]=-(c*u)+f*a-y*o,e[2]=c*l-p*a+y*i,e[3]=-(c*s)+p*o-f*i,e}function _g(e,t,r,n){var i=t[0],o=t[1],a=t[2],s=t[3];return e[0]=i+n*(r[0]-i),e[1]=o+n*(r[1]-o),e[2]=a+n*(r[2]-a),e[3]=s+n*(r[3]-s),e}function Ig(e,t){t=t||1;var r,n,i,o,a,s;do r=qn()*2-1,n=qn()*2-1,a=r*r+n*n;while(a>=1);do i=qn()*2-1,o=qn()*2-1,s=i*i+o*o;while(s>=1);var l=Math.sqrt((1-a)/s);return e[0]=t*r,e[1]=t*n,e[2]=t*i*l,e[3]=t*o*l,e}function Tg(e,t,r){var n=t[0],i=t[1],o=t[2],a=t[3];return e[0]=r[0]*n+r[4]*i+r[8]*o+r[12]*a,e[1]=r[1]*n+r[5]*i+r[9]*o+r[13]*a,e[2]=r[2]*n+r[6]*i+r[10]*o+r[14]*a,e[3]=r[3]*n+r[7]*i+r[11]*o+r[15]*a,e}function Cg(e,t,r){var n=t[0],i=t[1],o=t[2],a=r[0],s=r[1],l=r[2],u=r[3],c=u*n+s*o-l*i,p=u*i+l*n-a*o,f=u*o+a*i-s*n,y=-a*n-s*i-l*o;return e[0]=c*u+y*-a+p*-l-f*-s,e[1]=p*u+y*-s+f*-a-c*-l,e[2]=f*u+y*-l+c*-s-p*-a,e[3]=t[3],e}function kg(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e}function Mg(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}function Eg(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]}function Fg(e,t){var r=e[0],n=e[1],i=e[2],o=e[3],a=t[0],s=t[1],l=t[2],u=t[3];return Math.abs(r-a)<=Q*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(n-s)<=Q*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(i-l)<=Q*Math.max(1,Math.abs(i),Math.abs(l))&&Math.abs(o-u)<=Q*Math.max(1,Math.abs(o),Math.abs(u))}var Lg=Hc,Dg=Xc,Vg=Kc,Bg=Yc,zg=Qc,Rg=ep,Og=tp,Ng=function(){var e=Wc();return function(t,r,n,i,o,a){var s,l;for(r||(r=4),n||(n=0),i?l=Math.min(i*r+n,t.length):l=t.length,s=n;s<l;s+=r)e[0]=t[s],e[1]=t[s+1],e[2]=t[s+2],e[3]=t[s+3],o(e,e,a),t[s]=e[0],t[s+1]=e[1],t[s+2]=e[2],t[s+3]=e[3];return t}}();var rp=Z(he(),1),Ro=class extends se{constructor(t){super(t,Oc)}createBucket(t){return new Ht(t)}queryRadius(t){let r=t;return Xt("circle-radius",this,r)+Xt("circle-stroke-width",this,r)+_t(this.paint.get("circle-translate"))}queryIntersectsFeature(t,r,n,i,o,a,s,l){let u=It(t,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),a.angle,s),c=this.paint.get("circle-radius").evaluate(r,n),p=this.paint.get("circle-stroke-width").evaluate(r,n),f=c+p,y=this.paint.get("circle-pitch-alignment")==="map",m=y?u:Ug(u,l),h=y?f*s:f;for(let d of i)for(let g of d){let b=y?g:np(g,l),x=h,v=Kt.transformMat4([],[g.x,g.y,0,1],l);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?x*=v[3]/a.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(x*=a.cameraToCenterDistance/v[3]),Lc(m,b,x))return!0}return!1}};function np(e,t){let r=Kt.transformMat4([],[e.x,e.y,0,1],t);return new rp.default(r[0]/r[3],r[1]/r[3])}function Ug(e,t){return e.map(r=>np(r,t))}var Jn=class extends Ht{};C("HeatmapBucket",Jn,{omit:["layers"]});var ip,$g=()=>ip=ip||new re({"heatmap-radius":new R(S.paint_heatmap["heatmap-radius"]),"heatmap-weight":new R(S.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new B(S.paint_heatmap["heatmap-intensity"]),"heatmap-color":new jt(S.paint_heatmap["heatmap-color"]),"heatmap-opacity":new B(S.paint_heatmap["heatmap-opacity"])}),op={get paint(){return $g()}};function Ls(e,{width:t,height:r},n,i){if(!i)i=new Uint8Array(t*r*n);else if(i instanceof Uint8ClampedArray)i=new Uint8Array(i.buffer);else if(i.length!==t*r*n)throw new RangeError(`mismatched image size. expected: ${i.length} but got: ${t*r*n}`);return e.width=t,e.height=r,e.data=i,e}function ap(e,{width:t,height:r},n){if(t===e.width&&r===e.height)return;let i=Ls({},{width:t,height:r},n);Ds(e,i,{x:0,y:0},{x:0,y:0},{width:Math.min(e.width,t),height:Math.min(e.height,r)},n),e.width=t,e.height=r,e.data=i.data}function Ds(e,t,r,n,i,o){if(i.width===0||i.height===0)return t;if(i.width>e.width||i.height>e.height||r.x>e.width-i.width||r.y>e.height-i.height)throw new RangeError("out of range source coordinates for image copy");if(i.width>t.width||i.height>t.height||n.x>t.width-i.width||n.y>t.height-i.height)throw new RangeError("out of range destination coordinates for image copy");let a=e.data,s=t.data;if(a===s)throw new Error("srcData equals dstData, so image is already copied");for(let l=0;l<i.height;l++){let u=((r.y+l)*e.width+r.x)*o,c=((n.y+l)*t.width+n.x)*o;for(let p=0;p<i.width*o;p++)s[c+p]=a[u+p]}return t}var Yt=class e{constructor(t,r){Ls(this,t,1,r)}resize(t){ap(this,t,1)}clone(){return new e({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,r,n,i,o){Ds(t,r,n,i,o,1)}},de=class e{constructor(t,r){Ls(this,t,4,r)}resize(t){ap(this,t,4)}replace(t,r){r?this.data.set(t):t instanceof Uint8ClampedArray?this.data=new Uint8Array(t.buffer):this.data=t}clone(){return new e({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,r,n,i,o){Ds(t,r,n,i,o,4)}};C("AlphaImage",Yt);C("RGBAImage",de);function sp(e){let t={},r=e.resolution||256,n=e.clips?e.clips.length:1,i=e.image||new de({width:r,height:n});if(!ql(r))throw new Error(`width is not a power of 2 - ${r}`);let o=(a,s,l)=>{t[e.evaluationKey]=l;let u=e.expression.evaluate(t);i.data[a+s+0]=Math.floor(u.r*255/u.a),i.data[a+s+1]=Math.floor(u.g*255/u.a),i.data[a+s+2]=Math.floor(u.b*255/u.a),i.data[a+s+3]=Math.floor(u.a*255)};if(e.clips)for(let a=0,s=0;a<n;++a,s+=r*4)for(let l=0,u=0;l<r;l++,u+=4){let c=l/(r-1),{start:p,end:f}=e.clips[a],y=p*(1-c)+f*c;o(s,u,y)}else for(let a=0,s=0;a<r;a++,s+=4){let l=a/(r-1);o(0,s,l)}return i}var Oo=class extends se{createBucket(t){return new Jn(t)}constructor(t){super(t,op),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){t==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){let t=this._transitionablePaint._values["heatmap-color"].value.expression;this.colorRamp=sp({expression:t,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}};var lp,Gg=()=>lp=lp||new re({"hillshade-illumination-direction":new B(S.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new B(S.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new B(S.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new B(S.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new B(S.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new B(S.paint_hillshade["hillshade-accent-color"])}),up={get paint(){return Gg()}};var No=class extends se{constructor(t){super(t,up)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}};var qg=Y([{name:"a_pos",components:2,type:"Int16"}],4);var{members:cp,size:LP,alignment:DP}=qg;var dp=Z(Os(),1);function Ns(e,t,r,n,i){hp(e,t,r||0,n||e.length-1,i||ax)}function hp(e,t,r,n,i){for(;n>r;){if(n-r>600){var o=n-r+1,a=t-r+1,s=Math.log(o),l=.5*Math.exp(2*s/3),u=.5*Math.sqrt(s*l*(o-l)/o)*(a-o/2<0?-1:1),c=Math.max(r,Math.floor(t-a*l/o+u)),p=Math.min(n,Math.floor(t+(o-a)*l/o+u));hp(e,t,c,p,i)}var f=e[t],y=r,m=n;for(Xn(e,r,t),i(e[n],f)>0&&Xn(e,r,n);y<m;){for(Xn(e,y,m),y++,m--;i(e[y],f)<0;)y++;for(;i(e[m],f)>0;)m--}i(e[r],f)===0?Xn(e,r,m):(m++,Xn(e,m,n)),m<=t&&(r=m+1),t<=m&&(n=m-1)}}function Xn(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function ax(e,t){return e<t?-1:e>t?1:0}function _r(e,t){let r=e.length;if(r<=1)return[e];let n=[],i,o;for(let a=0;a<r;a++){let s=Zl(e[a]);s!==0&&(e[a].area=Math.abs(s),o===void 0&&(o=s<0),o===s<0?(i&&n.push(i),i=[e[a]]):i.push(e[a]))}if(i&&n.push(i),t>1)for(let a=0;a<n.length;a++)n[a].length<=t||(Ns(n[a],t,1,n[a].length-1,sx),n[a]=n[a].slice(0,t));return n}function sx(e,t){return t.area-e.area}function Ir(e,t,r){let n=r.patternDependencies,i=!1;for(let o of t){let a=o.paint.get(`${e}-pattern`);a.isConstant()||(i=!0);let s=a.constantOr(null);s&&(i=!0,n[s.to]=!0,n[s.from]=!0)}return i}function Tr(e,t,r,n,i){let o=i.patternDependencies;for(let a of t){let l=a.paint.get(`${e}-pattern`).value;if(l.kind!=="constant"){let u=l.evaluate({zoom:n-1},r,{},i.availableImages),c=l.evaluate({zoom:n},r,{},i.availableImages),p=l.evaluate({zoom:n+1},r,{},i.availableImages);u=u&&u.name?u.name:u,c=c&&c.name?c.name:c,p=p&&p.name?p.name:p,o[u]=!0,o[c]=!0,o[p]=!0,r.patterns[a.id]={min:u,mid:c,max:p}}}return r}var lx=500,er=class{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(r=>r.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new So,this.indexArray=new Le,this.indexArray2=new wt,this.programConfigurations=new Ce(t.layers,t.zoom),this.segments=new me,this.segments2=new me,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(t,r,n){this.hasPattern=Ir("fill",this.layers,r);let i=this.layers[0].layout.get("fill-sort-key"),o=!i.isConstant(),a=[];for(let{feature:s,id:l,index:u,sourceLayerIndex:c}of t){let p=this.layers[0]._featureFilter.needGeometry,f=$e(s,p);if(!this.layers[0]._featureFilter.filter(new q(this.zoom),f,n))continue;let y=o?i.evaluate(f,{},n,r.availableImages):void 0,m={id:l,properties:s.properties,type:s.type,sourceLayerIndex:c,index:u,geometry:p?f.geometry:ke(s),patterns:{},sortKey:y};a.push(m)}o&&a.sort((s,l)=>s.sortKey-l.sortKey);for(let s of a){let{geometry:l,index:u,sourceLayerIndex:c}=s;if(this.hasPattern){let f=Tr("fill",this.layers,s,this.zoom,r);this.patternFeatures.push(f)}else this.addFeature(s,l,u,n,{});let p=t[u].feature;r.featureIndex.insert(p,l,u,c,this.index)}}update(t,r,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,r,this.stateDependentLayers,n)}addFeatures(t,r,n){for(let i of this.patternFeatures)this.addFeature(i,i.geometry,i.index,r,n)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,cp),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(t,r,n,i,o){for(let a of _r(r,lx)){let s=0;for(let y of a)s+=y.length;let l=this.segments.prepareSegment(s,this.layoutVertexArray,this.indexArray),u=l.vertexLength,c=[],p=[];for(let y of a){if(y.length===0)continue;y!==a[0]&&p.push(c.length/2);let m=this.segments2.prepareSegment(y.length,this.layoutVertexArray,this.indexArray2),h=m.vertexLength;this.layoutVertexArray.emplaceBack(y[0].x,y[0].y),this.indexArray2.emplaceBack(h+y.length-1,h),c.push(y[0].x),c.push(y[0].y);for(let d=1;d<y.length;d++)this.layoutVertexArray.emplaceBack(y[d].x,y[d].y),this.indexArray2.emplaceBack(h+d-1,h+d),c.push(y[d].x),c.push(y[d].y);m.vertexLength+=y.length,m.primitiveLength+=y.length}let f=(0,dp.default)(c,p);for(let y=0;y<f.length;y+=3)this.indexArray.emplaceBack(u+f[y],u+f[y+1],u+f[y+2]);l.vertexLength+=s,l.primitiveLength+=f.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,n,o,i)}};C("FillBucket",er,{omit:["layers","patternFeatures"]});var gp,ux=()=>gp=gp||new re({"fill-sort-key":new R(S.layout_fill["fill-sort-key"])}),xp,cx=()=>xp=xp||new re({"fill-antialias":new B(S.paint_fill["fill-antialias"]),"fill-opacity":new R(S.paint_fill["fill-opacity"]),"fill-color":new R(S.paint_fill["fill-color"]),"fill-outline-color":new R(S.paint_fill["fill-outline-color"]),"fill-translate":new B(S.paint_fill["fill-translate"]),"fill-translate-anchor":new B(S.paint_fill["fill-translate-anchor"]),"fill-pattern":new lt(S.paint_fill["fill-pattern"])}),bp={get paint(){return cx()},get layout(){return ux()}};var jo=class extends se{constructor(t){super(t,bp)}recalculate(t,r){super.recalculate(t,r);let n=this.paint._values["fill-outline-color"];n.value.kind==="constant"&&n.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(t){return new er(t)}queryRadius(){return _t(this.paint.get("fill-translate"))}queryIntersectsFeature(t,r,n,i,o,a,s){let l=It(t,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),a.angle,s);return Bo(l,i)}isTileClipped(){return!0}};var px=Y([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),vp=Y([{name:"a_centroid",components:2,type:"Int16"}],4);var{members:Pp,size:dS,alignment:gS}=px;var Tp=Z(Os(),1),Cp=Z(Tt(),1);var wx=Cp.default.VectorTileFeature.types,Ax=500,Gs=Math.pow(2,13);function Kn(e,t,r,n,i,o,a,s){e.emplaceBack(t,r,Math.floor(n*Gs)*2+a,i*Gs*2,o*Gs*2,Math.round(s))}var tr=class{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(r=>r.id),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new wo,this.centroidVertexArray=new vo,this.indexArray=new Le,this.programConfigurations=new Ce(t.layers,t.zoom),this.segments=new me,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(t,r,n){this.features=[],this.hasPattern=Ir("fill-extrusion",this.layers,r);for(let{feature:i,id:o,index:a,sourceLayerIndex:s}of t){let l=this.layers[0]._featureFilter.needGeometry,u=$e(i,l);if(!this.layers[0]._featureFilter.filter(new q(this.zoom),u,n))continue;let c={id:o,sourceLayerIndex:s,index:a,geometry:l?u.geometry:ke(i),properties:i.properties,type:i.type,patterns:{}};this.hasPattern?this.features.push(Tr("fill-extrusion",this.layers,c,this.zoom,r)):this.addFeature(c,c.geometry,a,n,{}),r.featureIndex.insert(i,c.geometry,a,s,this.index,!0)}}addFeatures(t,r,n){for(let i of this.features){let{geometry:o}=i;this.addFeature(i,o,i.index,r,n)}}update(t,r,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,r,this.stateDependentLayers,n)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Pp),this.centroidVertexBuffer=t.createVertexBuffer(this.centroidVertexArray,vp.members,!0),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(t,r,n,i,o){let a={x:0,y:0,vertexCount:0};for(let s of _r(r,Ax)){let l=0;for(let m of s)l+=m.length;let u=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(let m of s){if(m.length===0||Ix(m))continue;let h=0;for(let d=0;d<m.length;d++){let g=m[d];if(d>=1){let b=m[d-1];if(!_x(g,b)){u.vertexLength+4>me.MAX_VERTEX_ARRAY_LENGTH&&(u=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));let x=g.sub(b)._perp()._unit(),v=b.dist(g);h+v>32768&&(h=0),Kn(this.layoutVertexArray,g.x,g.y,x.x,x.y,0,0,h),Kn(this.layoutVertexArray,g.x,g.y,x.x,x.y,0,1,h),a.x+=2*g.x,a.y+=2*g.y,a.vertexCount+=2,h+=v,Kn(this.layoutVertexArray,b.x,b.y,x.x,x.y,0,0,h),Kn(this.layoutVertexArray,b.x,b.y,x.x,x.y,0,1,h),a.x+=2*b.x,a.y+=2*b.y,a.vertexCount+=2;let P=u.vertexLength;this.indexArray.emplaceBack(P,P+2,P+1),this.indexArray.emplaceBack(P+1,P+2,P+3),u.vertexLength+=4,u.primitiveLength+=2}}}}if(u.vertexLength+l>me.MAX_VERTEX_ARRAY_LENGTH&&(u=this.segments.prepareSegment(l,this.layoutVertexArray,this.indexArray)),wx[t.type]!=="Polygon")continue;let c=[],p=[],f=u.vertexLength;for(let m of s)if(m.length!==0){m!==s[0]&&p.push(c.length/2);for(let h=0;h<m.length;h++){let d=m[h];Kn(this.layoutVertexArray,d.x,d.y,0,0,1,1,0),a.x+=d.x,a.y+=d.y,a.vertexCount+=1,c.push(d.x),c.push(d.y)}}let y=(0,Tp.default)(c,p);for(let m=0;m<y.length;m+=3)this.indexArray.emplaceBack(f+y[m],f+y[m+2],f+y[m+1]);u.primitiveLength+=y.length/3,u.vertexLength+=l}for(let s=0;s<a.vertexCount;s++)this.centroidVertexArray.emplaceBack(Math.floor(a.x/a.vertexCount),Math.floor(a.y/a.vertexCount));this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,n,o,i)}};C("FillExtrusionBucket",tr,{omit:["layers","features"]});function _x(e,t){return e.x===t.x&&(e.x<0||e.x>8192)||e.y===t.y&&(e.y<0||e.y>8192)}function Ix(e){return e.every(t=>t.x<0)||e.every(t=>t.x>8192)||e.every(t=>t.y<0)||e.every(t=>t.y>8192)}var kp,Tx=()=>kp=kp||new re({"fill-extrusion-opacity":new B(S["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new R(S["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new B(S["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new B(S["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new lt(S["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new R(S["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new R(S["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new B(S["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])}),Mp={get paint(){return Tx()}};var Zo=Z(he(),1);var Wo=class extends se{constructor(t){super(t,Mp)}createBucket(t){return new tr(t)}queryRadius(){return _t(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(t,r,n,i,o,a,s,l){let u=It(t,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),a.angle,s),c=this.paint.get("fill-extrusion-height").evaluate(r,n),p=this.paint.get("fill-extrusion-base").evaluate(r,n),f=Mx(u,l,a,0),y=kx(i,p,c,l),m=y[0],h=y[1];return Cx(m,h,f)}};function Yn(e,t){return e.x*t.x+e.y*t.y}function Ep(e,t){if(e.length===1){let r=0,n=t[r++],i;for(;!i||n.equals(i);)if(i=t[r++],!i)return 1/0;for(;r<t.length;r++){let o=t[r],a=e[0],s=i.sub(n),l=o.sub(n),u=a.sub(n),c=Yn(s,s),p=Yn(s,l),f=Yn(l,l),y=Yn(u,s),m=Yn(u,l),h=c*f-p*p,d=(f*y-p*m)/h,g=(c*m-p*y)/h,b=1-d-g,x=n.z*b+i.z*d+o.z*g;if(isFinite(x))return x}return 1/0}else{let r=1/0;for(let n of t)r=Math.min(r,n.z);return r}}function Cx(e,t,r){let n=1/0;Bo(r,t)&&(n=Ep(r,t[0]));for(let i=0;i<t.length;i++){let o=t[i],a=e[i];for(let s=0;s<o.length-1;s++){let l=o[s],u=o[s+1],c=a[s],p=a[s+1],f=[l,u,p,c,l];Fc(r,f)&&(n=Math.min(n,Ep(r,f)))}}return n===1/0?!1:n}function kx(e,t,r,n){let i=[],o=[],a=n[8]*t,s=n[9]*t,l=n[10]*t,u=n[11]*t,c=n[8]*r,p=n[9]*r,f=n[10]*r,y=n[11]*r;for(let m of e){let h=[],d=[];for(let g of m){let b=g.x,x=g.y,v=n[0]*b+n[4]*x+n[12],P=n[1]*b+n[5]*x+n[13],w=n[2]*b+n[6]*x+n[14],T=n[3]*b+n[7]*x+n[15],F=v+a,E=P+s,_=w+l,I=T+u,k=v+c,V=P+p,A=w+f,z=T+y,O=new Zo.default(F/I,E/I);O.z=_/I,h.push(O);let N=new Zo.default(k/z,V/z);N.z=A/z,d.push(N)}i.push(h),o.push(d)}return[i,o]}function Mx(e,t,r,n){let i=[];for(let o of e){let a=[o.x,o.y,n,1];Kt.transformMat4(a,a,t),i.push(new Zo.default(a[0]/a[3],a[1]/a[3]))}return i}var Ex=Y([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:Fp,size:QS,alignment:ew}=Ex;var Fx=Y([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:Lp,size:nw,alignment:iw}=Fx;var Bp=Z(Tt(),1);var Lx=Bp.default.VectorTileFeature.types,Dp=63,Dx=Math.cos(75/2*(Math.PI/180)),Vx=15,Bx=20,zx=15,zp=1/2,Vp=Math.pow(2,zx-1)/zp,rr=class{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(r=>r.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(r=>{this.gradients[r.id]={}}),this.layoutVertexArray=new Ao,this.layoutVertexArray2=new _o,this.indexArray=new Le,this.programConfigurations=new Ce(t.layers,t.zoom),this.segments=new me,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(t,r,n){this.hasPattern=Ir("line",this.layers,r);let i=this.layers[0].layout.get("line-sort-key"),o=!i.isConstant(),a=[];for(let{feature:s,id:l,index:u,sourceLayerIndex:c}of t){let p=this.layers[0]._featureFilter.needGeometry,f=$e(s,p);if(!this.layers[0]._featureFilter.filter(new q(this.zoom),f,n))continue;let y=o?i.evaluate(f,{},n):void 0,m={id:l,properties:s.properties,type:s.type,sourceLayerIndex:c,index:u,geometry:p?f.geometry:ke(s),patterns:{},sortKey:y};a.push(m)}o&&a.sort((s,l)=>s.sortKey-l.sortKey);for(let s of a){let{geometry:l,index:u,sourceLayerIndex:c}=s;if(this.hasPattern){let f=Tr("line",this.layers,s,this.zoom,r);this.patternFeatures.push(f)}else this.addFeature(s,l,u,n,{});let p=t[u].feature;r.featureIndex.insert(p,l,u,c,this.index)}}update(t,r,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,r,this.stateDependentLayers,n)}addFeatures(t,r,n){for(let i of this.patternFeatures)this.addFeature(i,i.geometry,i.index,r,n)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,Lp)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Fp),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(t){if(t.properties&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_end")){let r=+t.properties.mapbox_clip_start,n=+t.properties.mapbox_clip_end;return{start:r,end:n}}}addFeature(t,r,n,i,o){let a=this.layers[0].layout,s=a.get("line-join").evaluate(t,{}),l=a.get("line-cap"),u=a.get("line-miter-limit"),c=a.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(let p of r)this.addLine(p,t,s,l,u,c);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,n,o,i)}addLine(t,r,n,i,o,a){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let g=0;g<t.length-1;g++)this.totalDistance+=t[g].dist(t[g+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}let s=Lx[r.type]==="Polygon",l=t.length;for(;l>=2&&t[l-1].equals(t[l-2]);)l--;let u=0;for(;u<l-1&&t[u].equals(t[u+1]);)u++;if(l<(s?3:2))return;n==="bevel"&&(o=1.05);let c=this.overscaling<=16?Vx*8192/(512*this.overscaling):0,p=this.segments.prepareSegment(l*10,this.layoutVertexArray,this.indexArray),f,y,m,h,d;this.e1=this.e2=-1,s&&(f=t[l-2],d=t[u].sub(f)._unit()._perp());for(let g=u;g<l;g++){if(m=g===l-1?s?t[u+1]:void 0:t[g+1],m&&t[g].equals(m))continue;d&&(h=d),f&&(y=f),f=t[g],d=m?m.sub(f)._unit()._perp():h,h=h||d;let b=h.add(d);(b.x!==0||b.y!==0)&&b._unit();let x=h.x*d.x+h.y*d.y,v=b.x*d.x+b.y*d.y,P=v!==0?1/v:1/0,w=2*Math.sqrt(2-2*v),T=v<Dx&&y&&m,F=h.x*d.y-h.y*d.x>0;if(T&&g>u){let I=f.dist(y);if(I>2*c){let k=f.sub(f.sub(y)._mult(c/I)._round());this.updateDistance(y,k),this.addCurrentVertex(k,h,0,0,p),y=k}}let E=y&&m,_=E?n:s?"butt":i;if(E&&_==="round"&&(P<a?_="miter":P<=2&&(_="fakeround")),_==="miter"&&P>o&&(_="bevel"),_==="bevel"&&(P>2&&(_="flipbevel"),P<o&&(_="miter")),y&&this.updateDistance(y,f),_==="miter")b._mult(P),this.addCurrentVertex(f,b,0,0,p);else if(_==="flipbevel"){if(P>100)b=d.mult(-1);else{let I=P*h.add(d).mag()/h.sub(d).mag();b._perp()._mult(I*(F?-1:1))}this.addCurrentVertex(f,b,0,0,p),this.addCurrentVertex(f,b.mult(-1),0,0,p)}else if(_==="bevel"||_==="fakeround"){let I=-Math.sqrt(P*P-1),k=F?I:0,V=F?0:I;if(y&&this.addCurrentVertex(f,h,k,V,p),_==="fakeround"){let A=Math.round(w*180/Math.PI/Bx);for(let z=1;z<A;z++){let O=z/A;if(O!==.5){let K=O-.5,xe=1.0904+x*(-3.2452+x*(3.55645-x*1.43519)),X=.848013+x*(-1.06021+x*.215638);O=O+O*K*(O-1)*(xe*K*K+X)}let N=d.sub(h)._mult(O)._add(h)._unit()._mult(F?-1:1);this.addHalfVertex(f,N.x,N.y,!1,F,0,p)}}m&&this.addCurrentVertex(f,d,-k,-V,p)}else if(_==="butt")this.addCurrentVertex(f,b,0,0,p);else if(_==="square"){let I=y?1:-1;this.addCurrentVertex(f,b,I,I,p)}else _==="round"&&(y&&(this.addCurrentVertex(f,h,0,0,p),this.addCurrentVertex(f,h,1,1,p,!0)),m&&(this.addCurrentVertex(f,d,-1,-1,p,!0),this.addCurrentVertex(f,d,0,0,p)));if(T&&g<l-1){let I=f.dist(m);if(I>2*c){let k=f.add(m.sub(f)._mult(c/I)._round());this.updateDistance(f,k),this.addCurrentVertex(k,d,0,0,p),f=k}}}}addCurrentVertex(t,r,n,i,o,a=!1){let s=r.x+r.y*n,l=r.y-r.x*n,u=-r.x+r.y*i,c=-r.y-r.x*i;this.addHalfVertex(t,s,l,a,!1,n,o),this.addHalfVertex(t,u,c,a,!0,-i,o),this.distance>Vp/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(t,r,n,i,o,a))}addHalfVertex({x:t,y:r},n,i,o,a,s,l){let c=(this.lineClips?this.scaledDistance*(Vp-1):this.scaledDistance)*zp;if(this.layoutVertexArray.emplaceBack((t<<1)+(o?1:0),(r<<1)+(a?1:0),Math.round(Dp*n)+128,Math.round(Dp*i)+128,(s===0?0:s<0?-1:1)+1|(c&63)<<2,c>>6),this.lineClips){let f=this.scaledDistance-this.lineClips.start,y=this.lineClips.end-this.lineClips.start,m=f/y;this.layoutVertexArray2.emplaceBack(m,this.lineClipsArray.length)}let p=l.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,p),l.primitiveLength++),a?this.e2=p:this.e1=p}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(t,r){this.distance+=t.dist(r),this.updateScaledDistance()}};C("LineBucket",rr,{omit:["layers","patternFeatures"]});var Rp,Rx=()=>Rp=Rp||new re({"line-cap":new B(S.layout_line["line-cap"]),"line-join":new R(S.layout_line["line-join"]),"line-miter-limit":new B(S.layout_line["line-miter-limit"]),"line-round-limit":new B(S.layout_line["line-round-limit"]),"line-sort-key":new R(S.layout_line["line-sort-key"])}),Op,Ox=()=>Op=Op||new re({"line-opacity":new R(S.paint_line["line-opacity"]),"line-color":new R(S.paint_line["line-color"]),"line-translate":new B(S.paint_line["line-translate"]),"line-translate-anchor":new B(S.paint_line["line-translate-anchor"]),"line-width":new R(S.paint_line["line-width"]),"line-gap-width":new R(S.paint_line["line-gap-width"]),"line-offset":new R(S.paint_line["line-offset"]),"line-blur":new R(S.paint_line["line-blur"]),"line-dasharray":new qt(S.paint_line["line-dasharray"]),"line-pattern":new lt(S.paint_line["line-pattern"]),"line-gradient":new jt(S.paint_line["line-gradient"])}),qs={get paint(){return Ox()},get layout(){return Rx()}};var js=class extends R{possiblyEvaluate(t,r){return r=new q(Math.floor(r.zoom),{now:r.now,fadeDuration:r.fadeDuration,zoomHistory:r.zoomHistory,transition:r.transition}),super.possiblyEvaluate(t,r)}evaluate(t,r,n,i){return r=Pe({},r,{zoom:Math.floor(r.zoom)}),super.evaluate(t,r,n,i)}},Ho,Xo=class extends se{constructor(t){super(t,qs),this.gradientVersion=0,Ho||(Ho=new js(qs.paint.properties["line-width"].specification),Ho.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(t){if(t==="line-gradient"){let r=this.gradientExpression();$t(r)?this.stepInterpolant=r._styleExpression.expression instanceof pr:this.stepInterpolant=!1,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(t,r){super.recalculate(t,r),this.paint._values["line-floorwidth"]=Ho.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,t)}createBucket(t){return new rr(t)}queryRadius(t){let r=t,n=Np(Xt("line-width",this,r),Xt("line-gap-width",this,r)),i=Xt("line-offset",this,r);return n/2+Math.abs(i)+_t(this.paint.get("line-translate"))}queryIntersectsFeature(t,r,n,i,o,a,s){let l=It(t,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),a.angle,s),u=s/2*Np(this.paint.get("line-width").evaluate(r,n),this.paint.get("line-gap-width").evaluate(r,n)),c=this.paint.get("line-offset").evaluate(r,n);return c&&(i=Bc(i,c*s)),Dc(l,i,u)}isTileClipped(){return!0}};function Np(e,t){return t>0?t+2*e:e}var Up=Y([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),$p=Y([{name:"a_projected_pos",components:3,type:"Float32"}],4),Uw=Y([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),Gp=Y([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),$w=Y([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),Js=Y([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Gw=Y([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4),qw=Y([{name:"triangle",components:3,type:"Uint16"}]),jw=Y([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Jw=Y([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),Zw=Y([{type:"Float32",name:"offsetX"}]),Ww=Y([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),Hw=Y([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);var ii=Z(he(),1);function Nx(e,t,r){let n=t.layout.get("text-transform").evaluate(r,{});return n==="uppercase"?e=e.toLocaleUpperCase():n==="lowercase"&&(e=e.toLocaleLowerCase()),ye.applyArabicShaping&&(e=ye.applyArabicShaping(e)),e}function qp(e,t,r){return e.sections.forEach(n=>{n.text=Nx(n.text,t,r)}),e}function jp(e){let t={},r={},n=[],i=0;function o(u){n.push(e[u]),i++}function a(u,c,p){let f=r[u];return delete r[u],r[c]=f,n[f].geometry[0].pop(),n[f].geometry[0]=n[f].geometry[0].concat(p[0]),f}function s(u,c,p){let f=t[c];return delete t[c],t[u]=f,n[f].geometry[0].shift(),n[f].geometry[0]=p[0].concat(n[f].geometry[0]),f}function l(u,c,p){let f=p?c[0][c[0].length-1]:c[0][0];return`${u}:${f.x}:${f.y}`}for(let u=0;u<e.length;u++){let c=e[u],p=c.geometry,f=c.text?c.text.toString():null;if(!f){o(u);continue}let y=l(f,p),m=l(f,p,!0);if(y in r&&m in t&&r[y]!==t[m]){let h=s(y,m,p),d=a(y,m,n[h].geometry);delete t[y],delete r[m],r[l(f,n[d].geometry,!0)]=d,n[h].geometry=null}else y in r?a(y,m,p):m in t?s(y,m,p):(o(u),t[y]=i-1,r[m]=i-1)}return n.filter(u=>u.geometry)}var kr={"!":"\\uFE15","#":"\\uFF03",$:"\\uFF04","%":"\\uFF05","&":"\\uFF06","(":"\\uFE35",")":"\\uFE36","*":"\\uFF0A","+":"\\uFF0B",",":"\\uFE10","-":"\\uFE32",".":"\\u30FB","/":"\\uFF0F",":":"\\uFE13",";":"\\uFE14","<":"\\uFE3F","=":"\\uFF1D",">":"\\uFE40","?":"\\uFE16","@":"\\uFF20","[":"\\uFE47","\\\\":"\\uFF3C","]":"\\uFE48","^":"\\uFF3E",_:"\\uFE33","`":"\\uFF40","{":"\\uFE37","|":"\\u2015","}":"\\uFE38","~":"\\uFF5E","\\xA2":"\\uFFE0","\\xA3":"\\uFFE1","\\xA5":"\\uFFE5","\\xA6":"\\uFFE4","\\xAC":"\\uFFE2","\\xAF":"\\uFFE3","\\u2013":"\\uFE32","\\u2014":"\\uFE31","\\u2018":"\\uFE43","\\u2019":"\\uFE44","\\u201C":"\\uFE41","\\u201D":"\\uFE42","\\u2026":"\\uFE19","\\u2027":"\\u30FB","\\u20A9":"\\uFFE6","\\u3001":"\\uFE11","\\u3002":"\\uFE12","\\u3008":"\\uFE3F","\\u3009":"\\uFE40","\\u300A":"\\uFE3D","\\u300B":"\\uFE3E","\\u300C":"\\uFE41","\\u300D":"\\uFE42","\\u300E":"\\uFE43","\\u300F":"\\uFE44","\\u3010":"\\uFE3B","\\u3011":"\\uFE3C","\\u3014":"\\uFE39","\\u3015":"\\uFE3A","\\u3016":"\\uFE17","\\u3017":"\\uFE18","\\uFF01":"\\uFE15","\\uFF08":"\\uFE35","\\uFF09":"\\uFE36","\\uFF0C":"\\uFE10","\\uFF0D":"\\uFE32","\\uFF0E":"\\u30FB","\\uFF1A":"\\uFE13","\\uFF1B":"\\uFE14","\\uFF1C":"\\uFE3F","\\uFF1E":"\\uFE40","\\uFF1F":"\\uFE16","\\uFF3B":"\\uFE47","\\uFF3D":"\\uFE48","\\uFF3F":"\\uFE33","\\uFF5B":"\\uFE37","\\uFF5C":"\\u2015","\\uFF5D":"\\uFE38","\\uFF5F":"\\uFE35","\\uFF60":"\\uFE36","\\uFF61":"\\uFE12","\\uFF62":"\\uFE41","\\uFF63":"\\uFE42"};function Jp(e){let t="";for(let r=0;r<e.length;r++){let n=e.charCodeAt(r+1)||null,i=e.charCodeAt(r-1)||null;(!n||!Ps(n)||kr[e[r+1]])&&(!i||!Ps(i)||kr[e[r-1]])&&kr[e[r]]?t+=kr[e[r]]:t+=e[r]}return t}var ne=24;var ib=Z(Qn(),1),ob=3;var Qo=ob;function ei(e){let t=0,r=0;for(let s of e)t+=s.w*s.h,r=Math.max(r,s.w);e.sort((s,l)=>l.h-s.h);let i=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),r),h:1/0}],o=0,a=0;for(let s of e)for(let l=i.length-1;l>=0;l--){let u=i[l];if(!(s.w>u.w||s.h>u.h)){if(s.x=u.x,s.y=u.y,a=Math.max(a,s.y+s.h),o=Math.max(o,s.x+s.w),s.w===u.w&&s.h===u.h){let c=i.pop();l<i.length&&(i[l]=c)}else s.h===u.h?(u.x+=s.w,u.w-=s.w):s.w===u.w?(u.y+=s.h,u.h-=s.h):(i.push({x:u.x+s.w,y:u.y,w:u.w-s.w,h:s.h}),u.y+=s.h,u.h-=s.h);break}}return{w:o,h:a,fill:t/(o*a)||0}}var ge=1;var ea=class{constructor(t,{pixelRatio:r,version:n,stretchX:i,stretchY:o,content:a}){this.paddedRect=t,this.pixelRatio=r,this.stretchX=i,this.stretchY=o,this.content=a,this.version=n}get tl(){return[this.paddedRect.x+ge,this.paddedRect.y+ge]}get br(){return[this.paddedRect.x+this.paddedRect.w-ge,this.paddedRect.y+this.paddedRect.h-ge]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-ge*2)/this.pixelRatio,(this.paddedRect.h-ge*2)/this.pixelRatio]}},ti=class{constructor(t,r){let n={},i={};this.haveRenderCallbacks=[];let o=[];this.addImages(t,n,o),this.addImages(r,i,o);let{w:a,h:s}=ei(o),l=new de({width:a||1,height:s||1});for(let u in t){let c=t[u],p=n[u].paddedRect;de.copy(c.data,l,{x:0,y:0},{x:p.x+ge,y:p.y+ge},c.data)}for(let u in r){let c=r[u],p=i[u].paddedRect,f=p.x+ge,y=p.y+ge,m=c.data.width,h=c.data.height;de.copy(c.data,l,{x:0,y:0},{x:f,y},c.data),de.copy(c.data,l,{x:0,y:h-1},{x:f,y:y-1},{width:m,height:1}),de.copy(c.data,l,{x:0,y:0},{x:f,y:y+h},{width:m,height:1}),de.copy(c.data,l,{x:m-1,y:0},{x:f-1,y},{width:1,height:h}),de.copy(c.data,l,{x:0,y:0},{x:f+m,y},{width:1,height:h})}this.image=l,this.iconPositions=n,this.patternPositions=i}addImages(t,r,n){for(let i in t){let o=t[i],a={x:0,y:0,w:o.data.width+2*ge,h:o.data.height+2*ge};n.push(a),r[i]=new ea(a,o),o.hasRenderCallback&&this.haveRenderCallbacks.push(i)}}patchUpdatedImages(t,r){t.dispatchRenderCallbacks(this.haveRenderCallbacks);for(let n in t.updatedImages)this.patchUpdatedImage(this.iconPositions[n],t.getImage(n),r),this.patchUpdatedImage(this.patternPositions[n],t.getImage(n),r)}patchUpdatedImage(t,r,n){if(!t||!r||t.version===r.version)return;t.version=r.version;let[i,o]=t.tl;n.update(r.data,void 0,{x:i,y:o})}};C("ImagePosition",ea);C("ImageAtlas",ti);var na=(i=>(i[i.none=0]="none",i[i.horizontal=1]="horizontal",i[i.vertical=2]="vertical",i[i.horizontalOnly=3]="horizontalOnly",i))(na||{}),Fr=-17;function ab(e){for(let t of e)if(t.positionedGlyphs.length!==0)return!1;return!0}var Qp=57344,ef=63743,ta=class e{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(t,r){let n=new e;return n.scale=t||1,n.fontStack=r,n}static forImage(t){let r=new e;return r.imageName=t,r}},ri=class e{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(t,r){let n=new e;for(let i=0;i<t.sections.length;i++){let o=t.sections[i];o.image?n.addImageSection(o):n.addTextSection(o,r)}return n}length(){return this.text.length}getSection(t){return this.sections[this.sectionIndex[t]]}getSectionIndex(t){return this.sectionIndex[t]}getCharCode(t){return this.text.charCodeAt(t)}verticalizePunctuation(){this.text=Jp(this.text)}trim(){let t=0;for(let n=0;n<this.text.length&&ra[this.text.charCodeAt(n)];n++)t++;let r=this.text.length;for(let n=this.text.length-1;n>=0&&n>=t&&ra[this.text.charCodeAt(n)];n--)r--;this.text=this.text.substring(t,r),this.sectionIndex=this.sectionIndex.slice(t,r)}substring(t,r){let n=new e;return n.text=this.text.substring(t,r),n.sectionIndex=this.sectionIndex.slice(t,r),n.sections=this.sections,n}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((t,r)=>Math.max(t,this.sections[r].scale),0)}addTextSection(t,r){this.text+=t.text,this.sections.push(ta.forText(t.scale,t.fontStack||r));let n=this.sections.length-1;for(let i=0;i<t.text.length;++i)this.sectionIndex.push(n)}addImageSection(t){let r=t.image?t.image.name:"";if(r.length===0){fe("Can\'t add FormattedSection with an empty image.");return}let n=this.getNextImageSectionCharCode();if(!n){fe(`Reached maximum number of images ${ef-Qp+2}`);return}this.text+=String.fromCharCode(n),this.sections.push(ta.forImage(r)),this.sectionIndex.push(this.sections.length-1)}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=ef?null:++this.imageSectionID:(this.imageSectionID=Qp,this.imageSectionID)}};function sb(e,t){let r=[],n=e.text,i=0;for(let o of t)r.push(e.substring(i,o)),i=o;return i<n.length&&r.push(e.substring(i,n.length)),r}function ni(e,t,r,n,i,o,a,s,l,u,c,p,f,y,m,h){let d=ri.fromFeature(e,i);p===2&&d.verticalizePunctuation();let g,{processBidirectionalText:b,processStyledBidirectionalText:x}=ye;if(b&&d.sections.length===1){g=[];let w=b(d.toString(),Hs(d,u,o,t,n,y,m));for(let T of w){let F=new ri;F.text=T,F.sections=d.sections;for(let E=0;E<T.length;E++)F.sectionIndex.push(0);g.push(F)}}else if(x){g=[];let w=x(d.text,d.sectionIndex,Hs(d,u,o,t,n,y,m));for(let T of w){let F=new ri;F.text=T[0],F.sectionIndex=T[1],F.sections=d.sections,g.push(F)}}else g=sb(d,Hs(d,u,o,t,n,y,m));let v=[],P={positionedLines:v,text:d.toString(),top:c[1],bottom:c[1],left:c[0],right:c[0],writingMode:p,iconsInText:!1,verticalizable:!1};return pb(P,t,r,n,g,a,s,l,p,u,f,h),ab(v)?!1:P}var ra={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},lb={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function nf(e,t,r,n,i,o){if(t.imageName){let a=n[t.imageName];return a?a.displaySize[0]*t.scale*ne/o+i:0}else{let a=r[t.fontStack],s=a&&a[e];return s?s.metrics.advance*t.scale+i:0}}function ub(e,t,r,n,i,o){let a=0;for(let l=0;l<e.length();l++){let u=e.getSection(l);a+=nf(e.getCharCode(l),u,n,i,t,o)}let s=Math.max(1,Math.ceil(a/r));return a/s}function tf(e,t,r,n){let i=Math.pow(e-t,2);return n?e<t?i/2:i*2:i+Math.abs(r)*r}function cb(e,t,r){let n=0;return e===10&&(n-=1e4),r&&(n+=150),(e===40||e===65288)&&(n+=50),(t===41||t===65289)&&(n+=50),n}function rf(e,t,r,n,i,o){let a=null,s=tf(t,r,i,o);for(let l of n){let u=t-l.x,c=tf(u,r,i,o)+l.badness;c<=s&&(a=l,s=c)}return{index:e,x:t,priorBreak:a,badness:s}}function of(e){return e?of(e.priorBreak).concat(e.index):[]}function Hs(e,t,r,n,i,o,a){if(o!=="point")return[];if(!e)return[];let s=[],l=ub(e,t,r,n,i,a),u=e.text.indexOf("\\u200B")>=0,c=0;for(let p=0;p<e.length();p++){let f=e.getSection(p),y=e.getCharCode(p);if(ra[y]||(c+=nf(y,f,n,i,t,a)),p<e.length()-1){let m=dc(y);(lb[y]||m||f.imageName)&&s.push(rf(p+1,c,l,s,cb(y,e.getCharCode(p+1),m&&u),!1))}}return of(rf(e.length(),c,l,s,0,!0))}function af(e){let t=.5,r=.5;switch(e){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0;break}switch(e){case"bottom":case"bottom-right":case"bottom-left":r=1;break;case"top":case"top-right":case"top-left":r=0;break}return{horizontalAlign:t,verticalAlign:r}}function pb(e,t,r,n,i,o,a,s,l,u,c,p){let f=0,y=Fr,m=0,h=0,d=s==="right"?1:s==="left"?0:.5,g=0;for(let P of i){P.trim();let w=P.getMaxScale(),T=(w-1)*ne,F={positionedGlyphs:[],lineOffset:0};e.positionedLines[g]=F;let E=F.positionedGlyphs,_=0;if(!P.length()){y+=o,++g;continue}for(let k=0;k<P.length();k++){let V=P.getSection(k),A=P.getSectionIndex(k),z=P.getCharCode(k),O=0,N=null,K=null,xe=null,X=ne,le=!(l===1||!c&&!oo(z)||c&&(ra[z]||gc(z)));if(V.imageName){let ce=n[V.imageName];if(!ce)continue;xe=V.imageName,e.iconsInText=e.iconsInText||!0,K=ce.paddedRect;let pe=ce.displaySize;V.scale=V.scale*ne/p,N={width:pe[0],height:pe[1],left:ge,top:-Qo,advance:le?pe[1]:pe[0]};let _e=ne-pe[1]*V.scale;O=T+_e,X=N.advance;let be=le?pe[0]*V.scale-ne*w:pe[1]*V.scale-ne*w;be>0&&be>_&&(_=be)}else{let ce=r[V.fontStack],pe=ce&&ce[z];if(pe&&pe.rect)K=pe.rect,N=pe.metrics;else{let _e=t[V.fontStack],be=_e&&_e[z];if(!be)continue;N=be.metrics}O=(w-V.scale)*ne}le?(e.verticalizable=!0,E.push({glyph:z,imageName:xe,x:f,y:y+O,vertical:le,scale:V.scale,fontStack:V.fontStack,sectionIndex:A,metrics:N,rect:K}),f+=X*V.scale+u):(E.push({glyph:z,imageName:xe,x:f,y:y+O,vertical:le,scale:V.scale,fontStack:V.fontStack,sectionIndex:A,metrics:N,rect:K}),f+=N.advance*V.scale+u)}if(E.length!==0){let k=f-u;m=Math.max(k,m),fb(E,0,E.length-1,d,_)}f=0;let I=o*w+_;F.lineOffset=Math.max(_,T),y+=I,h=Math.max(I,h),++g}let b=y-Fr,{horizontalAlign:x,verticalAlign:v}=af(a);yb(e.positionedLines,d,x,v,m,h,o,b,i.length),e.top+=-v*b,e.bottom=e.top+b,e.left+=-x*m,e.right=e.left+m}function fb(e,t,r,n,i){if(!n&&!i)return;let o=e[r],a=o.metrics.advance*o.scale,s=(e[r].x+a)*n;for(let l=t;l<=r;l++)e[l].x-=s,e[l].y+=i}function yb(e,t,r,n,i,o,a,s,l){let u=(t-r)*i,c=0;o!==a?c=-s*n-Fr:c=(-n*l+.5)*a;for(let p of e)for(let f of p.positionedGlyphs)f.x+=u,f.y+=c}function sf(e,t,r){let{horizontalAlign:n,verticalAlign:i}=af(r),o=t[0],a=t[1],s=o-e.displaySize[0]*n,l=s+e.displaySize[0],u=a-e.displaySize[1]*i,c=u+e.displaySize[1];return{image:e,top:u,bottom:c,left:s,right:l}}function Xs(e,t,r,n,i,o){let a=e.image,s;if(a.content){let d=a.content,g=a.pixelRatio||1;s=[d[0]/g,d[1]/g,a.displaySize[0]-d[2]/g,a.displaySize[1]-d[3]/g]}let l=t.left*o,u=t.right*o,c,p,f,y;r==="width"||r==="both"?(y=i[0]+l-n[3],p=i[0]+u+n[1]):(y=i[0]+(l+u-a.displaySize[0])/2,p=y+a.displaySize[0]);let m=t.top*o,h=t.bottom*o;return r==="height"||r==="both"?(c=i[1]+m-n[0],f=i[1]+h+n[2]):(c=i[1]+(m+h-a.displaySize[1])/2,f=c+a.displaySize[1]),{image:a,top:c,right:p,bottom:f,left:y,collisionPadding:s}}var lf=Z(Tt(),1);var Lr=255,Ct=128,tt=Lr*Ct;function Ks(e,t){let{expression:r}=t;if(r.kind==="constant")return{kind:"constant",layoutSize:r.evaluate(new q(e+1))};if(r.kind==="source")return{kind:"source"};{let{zoomStops:n,interpolationType:i}=r,o=0;for(;o<n.length&&n[o]<=e;)o++;o=Math.max(0,o-1);let a=o;for(;a<n.length&&n[a]<e+1;)a++;a=Math.min(n.length-1,a);let s=n[o],l=n[a];if(r.kind==="composite")return{kind:"composite",minZoom:s,maxZoom:l,interpolationType:i};let u=r.evaluate(new q(s)),c=r.evaluate(new q(l));return{kind:"camera",minZoom:s,maxZoom:l,minSize:u,maxSize:c,interpolationType:i}}}function Ys(e,t,r){let n="never",i=e.get(t);return i?n=i:e.get(r)&&(n="always"),n}var mb=lf.default.VectorTileFeature.types,hb=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function ia(e,t,r,n,i,o,a,s,l,u,c,p,f){let y=s?Math.min(tt,Math.round(s[0])):0,m=s?Math.min(tt,Math.round(s[1])):0;e.emplaceBack(t,r,Math.round(n*32),Math.round(i*32),o,a,(y<<1)+(l?1:0),m,u*16,c*16,p*256,f*256)}function uf(e,t,r){e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r)}function db(e){for(let t of e.sections)if(bc(t.text))return!0;return!1}var oi=class{constructor(t){this.layoutVertexArray=new Io,this.indexArray=new Le,this.programConfigurations=t,this.segments=new me,this.dynamicLayoutVertexArray=new To,this.opacityVertexArray=new Co,this.hasVisibleVertices=!1,this.placedSymbolArray=new Ln}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(t,r,n,i){this.isEmpty()||(n&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Up.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,r),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,$p.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,hb,!0),this.opacityVertexBuffer.itemSize=1),(n||i)&&this.programConfigurations.upload(t))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}};C("SymbolBuffers",oi);var ai=class{constructor(t,r,n){this.layoutVertexArray=new t,this.layoutAttributes=r,this.indexArray=new n,this.segments=new me,this.collisionVertexArray=new ko}upload(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,Gp.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}};C("CollisionBuffers",ai);var He=class{constructor(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(l=>l.id),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=jn.identity([]),this.placementViewportMatrix=jn.identity([]);let n=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Ks(this.zoom,n["text-size"]),this.iconSizeData=Ks(this.zoom,n["icon-size"]);let i=this.layers[0].layout,o=i.get("symbol-sort-key"),a=i.get("symbol-z-order");this.canOverlap=Ys(i,"text-overlap","text-allow-overlap")!=="never"||Ys(i,"icon-overlap","icon-allow-overlap")!=="never"||i.get("text-ignore-placement")||i.get("icon-ignore-placement"),this.sortFeaturesByKey=a!=="viewport-y"&&!o.isConstant();let s=a==="viewport-y"||a==="auto"&&!this.sortFeaturesByKey;this.sortFeaturesByY=s&&this.canOverlap,i.get("symbol-placement")==="point"&&(this.writingModes=i.get("text-writing-mode").map(l=>na[l])),this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id),this.sourceID=t.sourceID}createArrays(){this.text=new oi(new Ce(this.layers,this.zoom,t=>/^text/.test(t))),this.icon=new oi(new Ce(this.layers,this.zoom,t=>/^icon/.test(t))),this.glyphOffsetArray=new Vn,this.lineVertexArray=new Bn,this.symbolInstances=new Dn,this.textAnchorOffsets=new zn}calculateGlyphDependencies(t,r,n,i,o){for(let a=0;a<t.length;a++)if(r[t.charCodeAt(a)]=!0,(n||i)&&o){let s=kr[t.charAt(a)];s&&(r[s.charCodeAt(0)]=!0)}}populate(t,r,n){let i=this.layers[0],o=i.layout,a=o.get("text-font"),s=o.get("text-field"),l=o.get("icon-image"),u=(s.value.kind!=="constant"||s.value.value instanceof Fe&&!s.value.value.isEmpty()||s.value.value.toString().length>0)&&(a.value.kind!=="constant"||a.value.value.length>0),c=l.value.kind!=="constant"||!!l.value.value||Object.keys(l.parameters).length>0,p=o.get("symbol-sort-key");if(this.features=[],!u&&!c)return;let f=r.iconDependencies,y=r.glyphDependencies,m=r.availableImages,h=new q(this.zoom);for(let{feature:d,id:g,index:b,sourceLayerIndex:x}of t){let v=i._featureFilter.needGeometry,P=$e(d,v);if(!i._featureFilter.filter(h,P,n))continue;v||(P.geometry=ke(d));let w;if(u){let _=i.getValueAndResolveTokens("text-field",P,n,m),I=Fe.factory(_),k=this.hasRTLText=this.hasRTLText||db(I);(!k||ye.getRTLTextPluginStatus()==="unavailable"||k&&ye.isParsed())&&(w=qp(I,i,P))}let T;if(c){let _=i.getValueAndResolveTokens("icon-image",P,n,m);_ instanceof Te?T=_:T=Te.fromString(_)}if(!w&&!T)continue;let F=this.sortFeaturesByKey?p.evaluate(P,{},n):void 0,E={id:g,text:w,icon:T,index:b,sourceLayerIndex:x,geometry:P.geometry,properties:d.properties,type:mb[d.type],sortKey:F};if(this.features.push(E),T&&(f[T.name]=!0),w){let _=a.evaluate(P,{},n).join(","),I=o.get("text-rotation-alignment")!=="viewport"&&o.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(2)>=0;for(let k of w.sections)if(k.image)f[k.image.name]=!0;else{let V=mn(w.toString()),A=k.fontStack||_,z=y[A]=y[A]||{};this.calculateGlyphDependencies(k.text,z,I,this.allowVerticalPlacement,V)}}}o.get("symbol-placement")==="line"&&(this.features=jp(this.features)),this.sortFeaturesByKey&&this.features.sort((d,g)=>d.sortKey-g.sortKey)}update(t,r,n){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,r,this.layers,n),this.icon.programConfigurations.updatePaintArrays(t,r,this.layers,n))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(t,r){let n=this.lineVertexArray.length;if(t.segment!==void 0){let i=t.dist(r[t.segment+1]),o=t.dist(r[t.segment]),a={};for(let s=t.segment+1;s<r.length;s++)a[s]={x:r[s].x,y:r[s].y,tileUnitDistanceFromAnchor:i},s<r.length-1&&(i+=r[s+1].dist(r[s]));for(let s=t.segment||0;s>=0;s--)a[s]={x:r[s].x,y:r[s].y,tileUnitDistanceFromAnchor:o},s>0&&(o+=r[s-1].dist(r[s]));for(let s=0;s<r.length;s++){let l=a[s];this.lineVertexArray.emplaceBack(l.x,l.y,l.tileUnitDistanceFromAnchor)}}return{lineStartIndex:n,lineLength:this.lineVertexArray.length-n}}addSymbols(t,r,n,i,o,a,s,l,u,c,p,f){let y=t.indexArray,m=t.layoutVertexArray,h=t.segments.prepareSegment(4*r.length,m,y,this.canOverlap?a.sortKey:void 0),d=this.glyphOffsetArray.length,g=h.vertexLength,b=this.allowVerticalPlacement&&s===2?Math.PI/2:0,x=a.text&&a.text.sections;for(let v=0;v<r.length;v++){let{tl:P,tr:w,bl:T,br:F,tex:E,pixelOffsetTL:_,pixelOffsetBR:I,minFontScaleX:k,minFontScaleY:V,glyphOffset:A,isSDF:z,sectionIndex:O}=r[v],N=h.vertexLength,K=A[1];ia(m,l.x,l.y,P.x,K+P.y,E.x,E.y,n,z,_.x,_.y,k,V),ia(m,l.x,l.y,w.x,K+w.y,E.x+E.w,E.y,n,z,I.x,_.y,k,V),ia(m,l.x,l.y,T.x,K+T.y,E.x,E.y+E.h,n,z,_.x,I.y,k,V),ia(m,l.x,l.y,F.x,K+F.y,E.x+E.w,E.y+E.h,n,z,I.x,I.y,k,V),uf(t.dynamicLayoutVertexArray,l,b),y.emplaceBack(N,N+1,N+2),y.emplaceBack(N+1,N+2,N+3),h.vertexLength+=4,h.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(A[0]),(v===r.length-1||O!==r[v+1].sectionIndex)&&t.programConfigurations.populatePaintArrays(m.length,a,a.index,{},f,x&&x[O])}t.placedSymbolArray.emplaceBack(l.x,l.y,d,this.glyphOffsetArray.length-d,g,u,c,l.segment,n?n[0]:0,n?n[1]:0,i[0],i[1],s,0,!1,0,p)}_addCollisionDebugVertex(t,r,n,i,o,a){return r.emplaceBack(0,0),t.emplaceBack(n.x,n.y,i,o,Math.round(a.x),Math.round(a.y))}addCollisionDebugVertices(t,r,n,i,o,a,s){let l=o.segments.prepareSegment(4,o.layoutVertexArray,o.indexArray),u=l.vertexLength,c=o.layoutVertexArray,p=o.collisionVertexArray,f=s.anchorX,y=s.anchorY;this._addCollisionDebugVertex(c,p,a,f,y,new ii.default(t,r)),this._addCollisionDebugVertex(c,p,a,f,y,new ii.default(n,r)),this._addCollisionDebugVertex(c,p,a,f,y,new ii.default(n,i)),this._addCollisionDebugVertex(c,p,a,f,y,new ii.default(t,i)),l.vertexLength+=4;let m=o.indexArray;m.emplaceBack(u,u+1),m.emplaceBack(u+1,u+2),m.emplaceBack(u+2,u+3),m.emplaceBack(u+3,u),l.primitiveLength+=4}addDebugCollisionBoxes(t,r,n,i){for(let o=t;o<r;o++){let a=this.collisionBoxArray.get(o),s=a.x1,l=a.y1,u=a.x2,c=a.y2;this.addCollisionDebugVertices(s,l,u,c,i?this.textCollisionBox:this.iconCollisionBox,a.anchorPoint,n)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new ai(On,Js.members,wt),this.iconCollisionBox=new ai(On,Js.members,wt);for(let t=0;t<this.symbolInstances.length;t++){let r=this.symbolInstances.get(t);this.addDebugCollisionBoxes(r.textBoxStartIndex,r.textBoxEndIndex,r,!0),this.addDebugCollisionBoxes(r.verticalTextBoxStartIndex,r.verticalTextBoxEndIndex,r,!0),this.addDebugCollisionBoxes(r.iconBoxStartIndex,r.iconBoxEndIndex,r,!1),this.addDebugCollisionBoxes(r.verticalIconBoxStartIndex,r.verticalIconBoxEndIndex,r,!1)}}_deserializeCollisionBoxesForSymbol(t,r,n,i,o,a,s,l,u){let c={};for(let p=r;p<n;p++){let f=t.get(p);c.textBox={x1:f.x1,y1:f.y1,x2:f.x2,y2:f.y2,anchorPointX:f.anchorPointX,anchorPointY:f.anchorPointY},c.textFeatureIndex=f.featureIndex;break}for(let p=i;p<o;p++){let f=t.get(p);c.verticalTextBox={x1:f.x1,y1:f.y1,x2:f.x2,y2:f.y2,anchorPointX:f.anchorPointX,anchorPointY:f.anchorPointY},c.verticalTextFeatureIndex=f.featureIndex;break}for(let p=a;p<s;p++){let f=t.get(p);c.iconBox={x1:f.x1,y1:f.y1,x2:f.x2,y2:f.y2,anchorPointX:f.anchorPointX,anchorPointY:f.anchorPointY},c.iconFeatureIndex=f.featureIndex;break}for(let p=l;p<u;p++){let f=t.get(p);c.verticalIconBox={x1:f.x1,y1:f.y1,x2:f.x2,y2:f.y2,anchorPointX:f.anchorPointX,anchorPointY:f.anchorPointY},c.verticalIconFeatureIndex=f.featureIndex;break}return c}deserializeCollisionBoxes(t){this.collisionArrays=[];for(let r=0;r<this.symbolInstances.length;r++){let n=this.symbolInstances.get(r);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,n.textBoxStartIndex,n.textBoxEndIndex,n.verticalTextBoxStartIndex,n.verticalTextBoxEndIndex,n.iconBoxStartIndex,n.iconBoxEndIndex,n.verticalIconBoxStartIndex,n.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(t,r){let n=t.placedSymbolArray.get(r),i=n.vertexStartIndex+n.numGlyphs*4;for(let o=n.vertexStartIndex;o<i;o+=4)t.indexArray.emplaceBack(o,o+1,o+2),t.indexArray.emplaceBack(o+1,o+2,o+3)}getSortedSymbolIndexes(t){if(this.sortedAngle===t&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;let r=Math.sin(t),n=Math.cos(t),i=[],o=[],a=[];for(let s=0;s<this.symbolInstances.length;++s){a.push(s);let l=this.symbolInstances.get(s);i.push(Math.round(r*l.anchorX+n*l.anchorY)|0),o.push(l.featureIndex)}return a.sort((s,l)=>i[s]-i[l]||o[l]-o[s]),a}addToSortKeyRanges(t,r){let n=this.sortKeyRanges[this.sortKeyRanges.length-1];n&&n.sortKey===r?n.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:r,symbolInstanceStart:t,symbolInstanceEnd:t+1})}sortFeatures(t){if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(let r of this.symbolInstanceIndexes){let n=this.symbolInstances.get(r);this.featureSortOrder.push(n.featureIndex),[n.rightJustifiedTextSymbolIndex,n.centerJustifiedTextSymbolIndex,n.leftJustifiedTextSymbolIndex].forEach((i,o,a)=>{i>=0&&a.indexOf(i)===o&&this.addIndicesForPlacedSymbol(this.text,i)}),n.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,n.verticalPlacedTextSymbolIndex),n.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,n.placedIconSymbolIndex),n.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,n.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}};C("SymbolBucket",He,{omit:["layers","collisionBoxArray","features","compareText"]});He.MAX_GLYPHS=65535;He.addDynamicAttributes=uf;function cf(e,t){return t.replace(/{([^{}]+)}/g,(r,n)=>e&&n in e?String(e[n]):"")}var pf,gb=()=>pf=pf||new re({"symbol-placement":new B(S.layout_symbol["symbol-placement"]),"symbol-spacing":new B(S.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new B(S.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new R(S.layout_symbol["symbol-sort-key"]),"symbol-z-order":new B(S.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new B(S.layout_symbol["icon-allow-overlap"]),"icon-overlap":new B(S.layout_symbol["icon-overlap"]),"icon-ignore-placement":new B(S.layout_symbol["icon-ignore-placement"]),"icon-optional":new B(S.layout_symbol["icon-optional"]),"icon-rotation-alignment":new B(S.layout_symbol["icon-rotation-alignment"]),"icon-size":new R(S.layout_symbol["icon-size"]),"icon-text-fit":new B(S.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new B(S.layout_symbol["icon-text-fit-padding"]),"icon-image":new R(S.layout_symbol["icon-image"]),"icon-rotate":new R(S.layout_symbol["icon-rotate"]),"icon-padding":new R(S.layout_symbol["icon-padding"]),"icon-keep-upright":new B(S.layout_symbol["icon-keep-upright"]),"icon-offset":new R(S.layout_symbol["icon-offset"]),"icon-anchor":new R(S.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new B(S.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new B(S.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new B(S.layout_symbol["text-rotation-alignment"]),"text-field":new R(S.layout_symbol["text-field"]),"text-font":new R(S.layout_symbol["text-font"]),"text-size":new R(S.layout_symbol["text-size"]),"text-max-width":new R(S.layout_symbol["text-max-width"]),"text-line-height":new B(S.layout_symbol["text-line-height"]),"text-letter-spacing":new R(S.layout_symbol["text-letter-spacing"]),"text-justify":new R(S.layout_symbol["text-justify"]),"text-radial-offset":new R(S.layout_symbol["text-radial-offset"]),"text-variable-anchor":new B(S.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new R(S.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new R(S.layout_symbol["text-anchor"]),"text-max-angle":new B(S.layout_symbol["text-max-angle"]),"text-writing-mode":new B(S.layout_symbol["text-writing-mode"]),"text-rotate":new R(S.layout_symbol["text-rotate"]),"text-padding":new B(S.layout_symbol["text-padding"]),"text-keep-upright":new B(S.layout_symbol["text-keep-upright"]),"text-transform":new R(S.layout_symbol["text-transform"]),"text-offset":new R(S.layout_symbol["text-offset"]),"text-allow-overlap":new B(S.layout_symbol["text-allow-overlap"]),"text-overlap":new B(S.layout_symbol["text-overlap"]),"text-ignore-placement":new B(S.layout_symbol["text-ignore-placement"]),"text-optional":new B(S.layout_symbol["text-optional"])}),ff,xb=()=>ff=ff||new re({"icon-opacity":new R(S.paint_symbol["icon-opacity"]),"icon-color":new R(S.paint_symbol["icon-color"]),"icon-halo-color":new R(S.paint_symbol["icon-halo-color"]),"icon-halo-width":new R(S.paint_symbol["icon-halo-width"]),"icon-halo-blur":new R(S.paint_symbol["icon-halo-blur"]),"icon-translate":new B(S.paint_symbol["icon-translate"]),"icon-translate-anchor":new B(S.paint_symbol["icon-translate-anchor"]),"text-opacity":new R(S.paint_symbol["text-opacity"]),"text-color":new R(S.paint_symbol["text-color"],{runtimeType:Re,getOverride:e=>e.textColor,hasOverride:e=>!!e.textColor}),"text-halo-color":new R(S.paint_symbol["text-halo-color"]),"text-halo-width":new R(S.paint_symbol["text-halo-width"]),"text-halo-blur":new R(S.paint_symbol["text-halo-blur"]),"text-translate":new B(S.paint_symbol["text-translate"]),"text-translate-anchor":new B(S.paint_symbol["text-translate-anchor"])}),oa={get paint(){return xb()},get layout(){return gb()}};var si=class{constructor(t){if(t.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=t.property.overrides?t.property.overrides.runtimeType:yr,this.defaultValue=t}evaluate(t){if(t.formattedSection){let r=this.defaultValue.property.overrides;if(r&&r.hasOverride(t.formattedSection))return r.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default}eachChild(t){if(!this.defaultValue.isConstant()){let r=this.defaultValue.value;t(r._styleExpression.expression)}}outputDefined(){return!1}serialize(){return null}};C("FormatSectionOverride",si,{omit:["defaultValue"]});var aa=class e extends se{constructor(t){super(t,oa)}recalculate(t,r){if(super.recalculate(t,r),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout.get("symbol-placement")!=="point"?this.layout._values["icon-rotation-alignment"]="map":this.layout._values["icon-rotation-alignment"]="viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout.get("symbol-placement")!=="point"?this.layout._values["text-rotation-alignment"]="map":this.layout._values["text-rotation-alignment"]="viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){let n=this.layout.get("text-writing-mode");if(n){let i=[];for(let o of n)i.indexOf(o)<0&&i.push(o);this.layout._values["text-writing-mode"]=i}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(t,r,n,i){let o=this.layout.get(t).evaluate(r,{},n,i),a=this._unevaluatedLayout._values[t];return!a.isDataDriven()&&!$t(a.value)&&o?cf(r.properties,o):o}createBucket(t){return new He(t)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(let t of oa.paint.overridableProperties){if(!e.hasPaintOverride(this.layout,t))continue;let r=this.paint.get(t),n=new si(r),i=new Rt(n,r.property.specification),o=null;r.value.kind==="constant"||r.value.kind==="source"?o=new dt("source",i):o=new gt("composite",i,r.value.zoomStops),this.paint._values[t]=new Se(r.property,o,r.parameters)}}_handleOverridablePaintPropertyUpdate(t,r,n){return!this.layout||r.isDataDriven()||n.isDataDriven()?!1:e.hasPaintOverride(this.layout,t)}static hasPaintOverride(t,r){let n=t.get("text-field"),i=oa.paint.properties[r],o=!1,a=s=>{for(let l of s)if(i.overrides&&i.overrides.hasOverride(l)){o=!0;return}};if(n.value.kind==="constant"&&n.value.value instanceof Fe)a(n.value.value.sections);else if(n.value.kind==="source"){let s=u=>{if(!o)if(u instanceof mt&&ue(u.value)===mr){let c=u.value;a(c.sections)}else u instanceof en?a(u.sections):u.eachChild(s)},l=n.value;l._styleExpression&&s(l._styleExpression.expression)}return o}};function yf(e,t,r,n=1){let i=e.get("icon-padding").evaluate(t,{},r),o=i&&i.values;return[o[0]*n,o[1]*n,o[2]*n,o[3]*n]}var mf,bb=()=>mf=mf||new re({"background-color":new B(S.paint_background["background-color"]),"background-pattern":new qt(S.paint_background["background-pattern"]),"background-opacity":new B(S.paint_background["background-opacity"])}),hf={get paint(){return bb()}};var sa=class extends se{constructor(t){super(t,hf)}};var df,vb=()=>df=df||new re({"raster-opacity":new B(S.paint_raster["raster-opacity"]),"raster-hue-rotate":new B(S.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new B(S.paint_raster["raster-brightness-min"]),"raster-brightness-max":new B(S.paint_raster["raster-brightness-max"]),"raster-saturation":new B(S.paint_raster["raster-saturation"]),"raster-contrast":new B(S.paint_raster["raster-contrast"]),"raster-resampling":new B(S.paint_raster["raster-resampling"]),"raster-fade-duration":new B(S.paint_raster["raster-fade-duration"])}),gf={get paint(){return vb()}};var la=class extends se{constructor(t){super(t,gf)}};var ua=class extends se{constructor(r){super(r,{});this.onAdd=r=>{this.implementation.onAdd&&this.implementation.onAdd(r,r.painter.context.gl)};this.onRemove=r=>{this.implementation.onRemove&&this.implementation.onRemove(r,r.painter.context.gl)};this.implementation=r}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}};function xf(e){if(e.type==="custom")return new ua(e);switch(e.type){case"background":return new sa(e);case"circle":return new Ro(e);case"fill":return new jo(e);case"fill-extrusion":return new Wo(e);case"heatmap":return new Oo(e);case"hillshade":return new No(e);case"line":return new Xo(e);case"raster":return new la(e);case"symbol":return new aa(e)}}var ca=class{constructor(t){this.keyCache={},t&&this.replace(t)}replace(t){this._layerConfigs={},this._layers={},this.update(t,[])}update(t,r){for(let i of t){this._layerConfigs[i.id]=i;let o=this._layers[i.id]=xf(i);o._featureFilter=fn(o.filter),this.keyCache[i.id]&&delete this.keyCache[i.id]}for(let i of r)delete this.keyCache[i],delete this._layerConfigs[i],delete this._layers[i];this.familiesBySource={};let n=Ru(Object.values(this._layerConfigs),this.keyCache);for(let i of n){let o=i.map(p=>this._layers[p.id]),a=o[0];if(a.visibility==="none")continue;let s=a.source||"",l=this.familiesBySource[s];l||(l=this.familiesBySource[s]={});let u=a.sourceLayer||"_geojsonTileLayer",c=l[u];c||(c=l[u]=[]),c.push(o)}}};var Gf=Z(Tt(),1),qf=Z(Qn(),1);var Dr=class{constructor(t){this._stringToNumber={},this._numberToString=[];for(let r=0;r<t.length;r++){let n=t[r];this._stringToNumber[n]=r,this._numberToString[r]=n}}encode(t){return this._stringToNumber[t]}decode(t){if(t>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${t} can\'t be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[t]}};var Pf=Z(Tt(),1),Sf=Z(Qn(),1);var pa=class{constructor(t,r,n,i,o){this.type="Feature",this._vectorTileFeature=t,t._z=r,t._x=n,t._y=i,this.properties=t.properties,this.id=o}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(t){this._geometry=t}toJSON(){let t={geometry:this.geometry};for(let r in this)r==="_geometry"||r==="_vectorTileFeature"||(t[r]=this[r]);return t}};var li=class{constructor(t,r){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new Dt(8192,16,0),this.grid3D=new Dt(8192,16,0),this.featureIndexArray=new Rn,this.promoteId=r}insert(t,r,n,i,o,a){let s=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(n,i,o);let l=a?this.grid3D:this.grid;for(let u=0;u<r.length;u++){let c=r[u],p=[1/0,1/0,-1/0,-1/0];for(let f=0;f<c.length;f++){let y=c[f];p[0]=Math.min(p[0],y.x),p[1]=Math.min(p[1],y.y),p[2]=Math.max(p[2],y.x),p[3]=Math.max(p[3],y.y)}p[0]<8192&&p[1]<8192&&p[2]>=0&&p[3]>=0&&l.insert(s,p[0],p[1],p[2],p[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new Pf.default.VectorTile(new Sf.default(this.rawTileData)).layers,this.sourceLayerCoder=new Dr(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(t,r,n,i){this.loadVTLayers();let o=t.params||{},a=8192/t.tileSize/t.scale,s=fn(o.filter),l=t.queryGeometry,u=t.queryPadding*a,c=vf(l),p=this.grid.query(c.minX-u,c.minY-u,c.maxX+u,c.maxY+u),f=vf(t.cameraQueryGeometry),y=this.grid3D.query(f.minX-u,f.minY-u,f.maxX+u,f.maxY+u,(d,g,b,x)=>Vc(t.cameraQueryGeometry,d-u,g-u,b+u,x+u));for(let d of y)p.push(d);p.sort(Pb);let m={},h;for(let d=0;d<p.length;d++){let g=p[d];if(g===h)continue;h=g;let b=this.featureIndexArray.get(g),x=null;this.loadMatchingFeature(m,b.bucketIndex,b.sourceLayerIndex,b.featureIndex,s,o.layers,o.availableImages,r,n,i,(v,P,w)=>(x||(x=ke(v)),P.queryIntersectsFeature(l,v,w,x,this.z,t.transform,a,t.pixelPosMatrix)))}return m}loadMatchingFeature(t,r,n,i,o,a,s,l,u,c,p){let f=this.bucketLayerIDs[r];if(a&&!Jl(a,f))return;let y=this.sourceLayerCoder.decode(n),h=this.vtLayers[y].feature(i);if(o.needGeometry){let g=$e(h,!0);if(!o.filter(new q(this.tileID.overscaledZ),g,this.tileID.canonical))return}else if(!o.filter(new q(this.tileID.overscaledZ),h))return;let d=this.getId(h,y);for(let g=0;g<f.length;g++){let b=f[g];if(a&&a.indexOf(b)<0)continue;let x=l[b];if(!x)continue;let v={};d&&c&&(v=c.getState(x.sourceLayer||"_geojsonTileLayer",d));let P=Pe({},u[b]);P.paint=bf(P.paint,x.paint,h,v,s),P.layout=bf(P.layout,x.layout,h,v,s);let w=!p||p(h,x,v);if(!w)continue;let T=new pa(h,this.z,this.x,this.y,d);T.layer=P;let F=t[b];F===void 0&&(F=t[b]=[]),F.push({featureIndex:i,feature:T,intersectionZ:w})}}lookupSymbolFeatures(t,r,n,i,o,a,s,l){let u={};this.loadVTLayers();let c=fn(o);for(let p of t)this.loadMatchingFeature(u,n,i,p,c,a,s,l,r);return u}hasLayer(t){for(let r of this.bucketLayerIDs)for(let n of r)if(t===n)return!0;return!1}getId(t,r){let n=t.id;if(this.promoteId){let i=typeof this.promoteId=="string"?this.promoteId:this.promoteId[r];n=t.properties[i],typeof n=="boolean"&&(n=Number(n))}return n}};C("FeatureIndex",li,{omit:["rawTileData","sourceLayerCoder"]});function bf(e,t,r,n,i){return Gr(e,(o,a)=>{let s=t instanceof vt?t.get(a):null;return s&&s.evaluate?s.evaluate(r,n,i):s})}function vf(e){let t=1/0,r=1/0,n=-1/0,i=-1/0;for(let o of e)t=Math.min(t,o.x),r=Math.min(r,o.y),n=Math.max(n,o.x),i=Math.max(i,o.y);return{minX:t,minY:r,maxX:n,maxY:i}}function Pb(e,t){return t-e}var wf=Z(he(),1);var rt=class e extends wf.default{constructor(t,r,n,i){super(t,r),this.angle=n,i!==void 0&&(this.segment=i)}clone(){return new e(this.x,this.y,this.angle,this.segment)}};C("Anchor",rt);function Qs(e,t,r,n,i){if(t.segment===void 0||r===0)return!0;let o=t,a=t.segment+1,s=0;for(;s>-r/2;){if(a--,a<0)return!1;s-=e[a].dist(o),o=e[a]}s+=e[a].dist(e[a+1]),a++;let l=[],u=0;for(;s<r/2;){let c=e[a-1],p=e[a],f=e[a+1];if(!f)return!1;let y=c.angleTo(p)-p.angleTo(f);for(y=Math.abs((y+3*Math.PI)%(Math.PI*2)-Math.PI),l.push({distance:s,angleDelta:y}),u+=y;s-l[0].distance>n;)u-=l.shift().angleDelta;if(u>i)return!1;a++,s+=p.dist(f)}return!0}function Af(e){let t=0;for(let r=0;r<e.length-1;r++)t+=e[r].dist(e[r+1]);return t}function _f(e,t,r){return e?3/5*t*r:0}function If(e,t){return Math.max(e?e.right-e.left:0,t?t.right-t.left:0)}function Tf(e,t,r,n,i,o){let a=_f(r,i,o),s=If(r,n)*o,l=0,u=Af(e)/2;for(let c=0;c<e.length-1;c++){let p=e[c],f=e[c+1],y=p.dist(f);if(l+y>u){let m=(u-l)/y,h=Oe.number(p.x,f.x,m),d=Oe.number(p.y,f.y,m),g=new rt(h,d,f.angleTo(p),c);return g._round(),!a||Qs(e,g,s,a,t)?g:void 0}l+=y}}function Cf(e,t,r,n,i,o,a,s,l){let u=_f(n,o,a),c=If(n,i),p=c*a,f=e[0].x===0||e[0].x===l||e[0].y===0||e[0].y===l;t-p<t/4&&(t=p+t/4);let y=o*2,m=f?t/2*s%t:(c/2+y)*a*s%t;return kf(e,m,t,u,r,p,f,!1,l)}function kf(e,t,r,n,i,o,a,s,l){let u=o/2,c=Af(e),p=0,f=t-r,y=[];for(let m=0;m<e.length-1;m++){let h=e[m],d=e[m+1],g=h.dist(d),b=d.angleTo(h);for(;f+r<p+g;){f+=r;let x=(f-p)/g,v=Oe.number(h.x,d.x,x),P=Oe.number(h.y,d.y,x);if(v>=0&&v<l&&P>=0&&P<l&&f-u>=0&&f+u<=c){let w=new rt(v,P,b,m);w._round(),(!n||Qs(e,w,o,n,i))&&y.push(w)}}p+=g}return!s&&!y.length&&!a&&(y=kf(e,p/2,r,n,i,o,a,!0,l)),y}var pt=Z(he(),1);function Mf(e,t,r,n,i){let o=[];for(let a=0;a<e.length;a++){let s=e[a],l;for(let u=0;u<s.length-1;u++){let c=s[u],p=s[u+1];c.x<t&&p.x<t||(c.x<t?c=new pt.default(t,c.y+(p.y-c.y)*((t-c.x)/(p.x-c.x)))._round():p.x<t&&(p=new pt.default(t,c.y+(p.y-c.y)*((t-c.x)/(p.x-c.x)))._round()),!(c.y<r&&p.y<r)&&(c.y<r?c=new pt.default(c.x+(p.x-c.x)*((r-c.y)/(p.y-c.y)),r)._round():p.y<r&&(p=new pt.default(c.x+(p.x-c.x)*((r-c.y)/(p.y-c.y)),r)._round()),!(c.x>=n&&p.x>=n)&&(c.x>=n?c=new pt.default(n,c.y+(p.y-c.y)*((n-c.x)/(p.x-c.x)))._round():p.x>=n&&(p=new pt.default(n,c.y+(p.y-c.y)*((n-c.x)/(p.x-c.x)))._round()),!(c.y>=i&&p.y>=i)&&(c.y>=i?c=new pt.default(c.x+(p.x-c.x)*((i-c.y)/(p.y-c.y)),i)._round():p.y>=i&&(p=new pt.default(c.x+(p.x-c.x)*((i-c.y)/(p.y-c.y)),i)._round()),(!l||!c.equals(l[l.length-1]))&&(l=[c],o.push(l)),l.push(p)))))}}return o}var we=Z(he(),1);var Vr=ge;function el(e,t,r,n){let i=[],o=e.image,a=o.pixelRatio,s=o.paddedRect.w-2*Vr,l=o.paddedRect.h-2*Vr,u=e.right-e.left,c=e.bottom-e.top,p=o.stretchX||[[0,s]],f=o.stretchY||[[0,l]],y=(I,k)=>I+k[1]-k[0],m=p.reduce(y,0),h=f.reduce(y,0),d=s-m,g=l-h,b=0,x=m,v=0,P=h,w=0,T=d,F=0,E=g;if(o.content&&n){let I=o.content;b=fa(p,0,I[0]),v=fa(f,0,I[1]),x=fa(p,I[0],I[2]),P=fa(f,I[1],I[3]),w=I[0]-b,F=I[1]-v,T=I[2]-I[0]-x,E=I[3]-I[1]-P}let _=(I,k,V,A)=>{let z=ya(I.stretch-b,x,u,e.left),O=ma(I.fixed-w,T,I.stretch,m),N=ya(k.stretch-v,P,c,e.top),K=ma(k.fixed-F,E,k.stretch,h),xe=ya(V.stretch-b,x,u,e.left),X=ma(V.fixed-w,T,V.stretch,m),le=ya(A.stretch-v,P,c,e.top),ce=ma(A.fixed-F,E,A.stretch,h),pe=new we.default(z,N),_e=new we.default(xe,N),be=new we.default(xe,le),wi=new we.default(z,le),Ea=new we.default(O/a,K/a),Fa=new we.default(X/a,ce/a),Or=t*Math.PI/180;if(Or){let Ie=Math.sin(Or),ve=Math.cos(Or),Ve=[ve,-Ie,Ie,ve];pe._matMult(Ve),_e._matMult(Ve),wi._matMult(Ve),be._matMult(Ve)}let Ai=I.stretch+I.fixed,Me=V.stretch+V.fixed,Ft=k.stretch+k.fixed,_i=A.stretch+A.fixed,La={x:o.paddedRect.x+Vr+Ai,y:o.paddedRect.y+Vr+Ft,w:Me-Ai,h:_i-Ft},Da=T/a/u,Va=E/a/c;return{tl:pe,tr:_e,bl:wi,br:be,tex:La,writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Ea,pixelOffsetBR:Fa,minFontScaleX:Da,minFontScaleY:Va,isSDF:r}};if(!n||!o.stretchX&&!o.stretchY)i.push(_({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:s+1},{fixed:0,stretch:l+1}));else{let I=Ef(p,d,m),k=Ef(f,g,h);for(let V=0;V<I.length-1;V++){let A=I[V],z=I[V+1];for(let O=0;O<k.length-1;O++){let N=k[O],K=k[O+1];i.push(_(A,N,z,K))}}}return i}function fa(e,t,r){let n=0;for(let i of e)n+=Math.max(t,Math.min(r,i[1]))-Math.max(t,Math.min(r,i[0]));return n}function Ef(e,t,r){let n=[{fixed:-Vr,stretch:0}];for(let[i,o]of e){let a=n[n.length-1];n.push({fixed:i-a.stretch,stretch:a.stretch}),n.push({fixed:i-a.stretch,stretch:a.stretch+(o-i)})}return n.push({fixed:t+Vr,stretch:r}),n}function ya(e,t,r,n){return e/t*r+n}function ma(e,t,r,n){return e-t*r/n}function Ff(e,t,r,n,i,o,a,s){let l=n.layout.get("text-rotate").evaluate(o,{})*Math.PI/180,u=[];for(let c of t.positionedLines)for(let p of c.positionedGlyphs){if(!p.rect)continue;let f=p.rect||{},m=Qo+1,h=!0,d=1,g=0,b=(i||s)&&p.vertical,x=p.metrics.advance*p.scale/2;if(s&&t.verticalizable){let X=(p.scale-1)*ne,le=(ne-p.metrics.width*p.scale)/2;g=c.lineOffset/2-(p.imageName?-le:X)}if(p.imageName){let X=a[p.imageName];h=X.sdf,d=X.pixelRatio,m=ge/d}let v=i?[p.x+x,p.y]:[0,0],P=i?[0,0]:[p.x+x+r[0],p.y+r[1]-g],w=[0,0];b&&(w=P,P=[0,0]);let T=p.metrics.isDoubleResolution?2:1,F=(p.metrics.left-m)*p.scale-x+P[0],E=(-p.metrics.top-m)*p.scale+P[1],_=F+f.w/T*p.scale/d,I=E+f.h/T*p.scale/d,k=new we.default(F,E),V=new we.default(_,E),A=new we.default(F,I),z=new we.default(_,I);if(b){let X=new we.default(-x,x-Fr),le=-Math.PI/2,ce=ne/2-x,pe=p.imageName?ce:0,_e=new we.default(5-Fr-ce,-pe),be=new we.default(...w);k._rotateAround(le,X)._add(_e)._add(be),V._rotateAround(le,X)._add(_e)._add(be),A._rotateAround(le,X)._add(_e)._add(be),z._rotateAround(le,X)._add(_e)._add(be)}if(l){let X=Math.sin(l),le=Math.cos(l),ce=[le,-X,X,le];k._matMult(ce),V._matMult(ce),A._matMult(ce),z._matMult(ce)}let O=new we.default(0,0),N=new we.default(0,0);u.push({tl:k,tr:V,bl:A,br:z,tex:f,writingMode:t.writingMode,glyphOffset:v,sectionIndex:p.sectionIndex,isSDF:h,pixelOffsetTL:O,pixelOffsetBR:N,minFontScaleX:0,minFontScaleY:0})}return u}var ui=Z(he(),1),nr=class{constructor(t,r,n,i,o,a,s,l,u,c){if(this.boxStartIndex=t.length,u){let p=a.top,f=a.bottom,y=a.collisionPadding;y&&(p-=y[1],f+=y[3]);let m=f-p;m>0&&(m=Math.max(10,m),this.circleDiameter=m)}else{let p=a.top*s-l[0],f=a.bottom*s+l[2],y=a.left*s-l[3],m=a.right*s+l[1],h=a.collisionPadding;if(h&&(y-=h[0]*s,p-=h[1]*s,m+=h[2]*s,f+=h[3]*s),c){let d=new ui.default(y,p),g=new ui.default(m,p),b=new ui.default(y,f),x=new ui.default(m,f),v=c*Math.PI/180;d._rotate(v),g._rotate(v),b._rotate(v),x._rotate(v),y=Math.min(d.x,g.x,b.x,x.x),m=Math.max(d.x,g.x,b.x,x.x),p=Math.min(d.y,g.y,b.y,x.y),f=Math.max(d.y,g.y,b.y,x.y)}t.emplaceBack(r.x,r.y,y,p,m,f,n,i,o)}this.boxEndIndex=t.length}};var ci=class{constructor(t=[],r=Sb){if(this.data=t,this.length=this.data.length,this.compare=r,this.length>0)for(let n=(this.length>>1)-1;n>=0;n--)this._down(n)}push(t){this.data.push(t),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;let t=this.data[0],r=this.data.pop();return this.length--,this.length>0&&(this.data[0]=r,this._down(0)),t}peek(){return this.data[0]}_up(t){let{data:r,compare:n}=this,i=r[t];for(;t>0;){let o=t-1>>1,a=r[o];if(n(i,a)>=0)break;r[t]=a,t=o}r[t]=i}_down(t){let{data:r,compare:n}=this,i=this.length>>1,o=r[t];for(;t<i;){let a=(t<<1)+1,s=r[a],l=a+1;if(l<this.length&&n(r[l],s)<0&&(a=l,s=r[l]),n(s,o)>=0)break;r[t]=s,t=a}r[t]=o}};function Sb(e,t){return e<t?-1:e>t?1:0}var tl=Z(he(),1);function Lf(e,t=1,r=!1){let n=1/0,i=1/0,o=-1/0,a=-1/0,s=e[0];for(let h=0;h<s.length;h++){let d=s[h];(!h||d.x<n)&&(n=d.x),(!h||d.y<i)&&(i=d.y),(!h||d.x>o)&&(o=d.x),(!h||d.y>a)&&(a=d.y)}let l=o-n,u=a-i,c=Math.min(l,u),p=c/2,f=new ci([],wb);if(c===0)return new tl.default(n,i);for(let h=n;h<o;h+=c)for(let d=i;d<a;d+=c)f.push(new Br(h+p,d+p,p,e));let y=_b(e),m=f.length;for(;f.length;){let h=f.pop();(h.d>y.d||!y.d)&&(y=h,r&&console.log("found best %d after %d probes",Math.round(1e4*h.d)/1e4,m)),!(h.max-y.d<=t)&&(p=h.h/2,f.push(new Br(h.p.x-p,h.p.y-p,p,e)),f.push(new Br(h.p.x+p,h.p.y-p,p,e)),f.push(new Br(h.p.x-p,h.p.y+p,p,e)),f.push(new Br(h.p.x+p,h.p.y+p,p,e)),m+=4)}return r&&(console.log(`num probes: ${m}`),console.log(`best distance: ${y.d}`)),y.p}function wb(e,t){return t.max-e.max}function Br(e,t,r,n){this.p=new tl.default(e,t),this.h=r,this.d=Ab(this.p,n),this.max=this.d+this.h*Math.SQRT2}function Ab(e,t){let r=!1,n=1/0;for(let i=0;i<t.length;i++){let o=t[i];for(let a=0,s=o.length,l=s-1;a<s;l=a++){let u=o[a],c=o[l];u.y>e.y!=c.y>e.y&&e.x<(c.x-u.x)*(e.y-u.y)/(c.y-u.y)+u.x&&(r=!r),n=Math.min(n,Fs(e,u,c))}}return(r?1:-1)*Math.sqrt(n)}function _b(e){let t=0,r=0,n=0,i=e[0];for(let o=0,a=i.length,s=a-1;o<a;s=o++){let l=i[o],u=i[s],c=l.x*u.y-u.x*l.y;r+=(l.x+u.x)*c,n+=(l.y+u.y)*c,t+=c*3}return new Br(r/t,n/t,0,e)}var ol=Z(Is(),1);var rl=(o=>(o[o.center=1]="center",o[o.left=2]="left",o[o.right=3]="right",o[o.top=4]="top",o[o.bottom=5]="bottom",o[o["top-left"]=6]="top-left",o[o["top-right"]=7]="top-right",o[o["bottom-left"]=8]="bottom-left",o[o["bottom-right"]=9]="bottom-right",o))(rl||{}),kt=7,ha=Number.POSITIVE_INFINITY;function nl(e,t){function r(i,o){let a=0,s=0;o<0&&(o=0);let l=o/Math.SQRT2;switch(i){case"top-right":case"top-left":s=l-kt;break;case"bottom-right":case"bottom-left":s=-l+kt;break;case"bottom":s=-o+kt;break;case"top":s=o-kt;break}switch(i){case"top-right":case"bottom-right":a=-l;break;case"top-left":case"bottom-left":a=l;break;case"left":a=o;break;case"right":a=-o;break}return[a,s]}function n(i,o,a){let s=0,l=0;switch(o=Math.abs(o),a=Math.abs(a),i){case"top-right":case"top-left":case"top":l=a-kt;break;case"bottom-right":case"bottom-left":case"bottom":l=-a+kt;break}switch(i){case"top-right":case"bottom-right":case"right":s=-o;break;case"top-left":case"bottom-left":case"left":s=o;break}return[s,l]}return t[1]!==ha?n(e,t[0],t[1]):r(e,t[0])}function il(e,t,r){var a;let n=e.layout,i=(a=n.get("text-variable-anchor-offset"))==null?void 0:a.evaluate(t,{},r);if(i){let s=i.values,l=[];for(let u=0;u<s.length;u+=2){let c=l[u]=s[u],p=s[u+1].map(f=>f*ne);c.startsWith("top")?p[1]-=kt:c.startsWith("bottom")&&(p[1]+=kt),l[u+1]=p}return new Ne(l)}let o=n.get("text-variable-anchor");if(o){let s;e._unevaluatedLayout.getValue("text-radial-offset")!==void 0?s=[n.get("text-radial-offset").evaluate(t,{},r)*ne,ha]:s=n.get("text-offset").evaluate(t,{},r).map(c=>c*ne);let u=[];for(let c of o)u.push(c,nl(c,s));return new Ne(u)}return null}function Bf(e){e.bucket.createArrays();let t=512*e.bucket.overscaling;e.bucket.tilePixelRatio=8192/t,e.bucket.compareText={},e.bucket.iconsNeedLinear=!1;let r=e.bucket.layers[0],n=r.layout,i=r._unevaluatedLayout._values,o={layoutIconSize:i["icon-size"].possiblyEvaluate(new q(e.bucket.zoom+1),e.canonical),layoutTextSize:i["text-size"].possiblyEvaluate(new q(e.bucket.zoom+1),e.canonical),textMaxSize:i["text-size"].possiblyEvaluate(new q(18))};if(e.bucket.textSizeData.kind==="composite"){let{minZoom:c,maxZoom:p}=e.bucket.textSizeData;o.compositeTextSizes=[i["text-size"].possiblyEvaluate(new q(c),e.canonical),i["text-size"].possiblyEvaluate(new q(p),e.canonical)]}if(e.bucket.iconSizeData.kind==="composite"){let{minZoom:c,maxZoom:p}=e.bucket.iconSizeData;o.compositeIconSizes=[i["icon-size"].possiblyEvaluate(new q(c),e.canonical),i["icon-size"].possiblyEvaluate(new q(p),e.canonical)]}let a=n.get("text-line-height")*ne,s=n.get("text-rotation-alignment")!=="viewport"&&n.get("symbol-placement")!=="point",l=n.get("text-keep-upright"),u=n.get("text-size");for(let c of e.bucket.features){let p=n.get("text-font").evaluate(c,{},e.canonical).join(","),f=u.evaluate(c,{},e.canonical),y=o.layoutTextSize.evaluate(c,{},e.canonical),m=o.layoutIconSize.evaluate(c,{},e.canonical),h={horizontal:{},vertical:void 0},d=c.text,g=[0,0];if(d){let P=d.toString(),w=n.get("text-letter-spacing").evaluate(c,{},e.canonical)*ne,T=hc(P)?w:0,F=n.get("text-anchor").evaluate(c,{},e.canonical),E=il(r,c,e.canonical);if(!E){let A=n.get("text-radial-offset").evaluate(c,{},e.canonical);A?g=nl(F,[A*ne,ha]):g=n.get("text-offset").evaluate(c,{},e.canonical).map(z=>z*ne)}let _=s?"center":n.get("text-justify").evaluate(c,{},e.canonical),I=n.get("symbol-placement"),k=I==="point"?n.get("text-max-width").evaluate(c,{},e.canonical)*ne:0,V=()=>{e.bucket.allowVerticalPlacement&&mn(P)&&(h.vertical=ni(d,e.glyphMap,e.glyphPositions,e.imagePositions,p,k,a,F,"left",T,g,2,!0,I,y,f))};if(!s&&E){let A=new Set;if(_==="auto")for(let O=0;O<E.values.length;O+=2)A.add(Df(E.values[O]));else A.add(_);let z=!1;for(let O of A)if(!h.horizontal[O])if(z)h.horizontal[O]=h.horizontal[0];else{let N=ni(d,e.glyphMap,e.glyphPositions,e.imagePositions,p,k,a,"center",O,T,g,1,!1,I,y,f);N&&(h.horizontal[O]=N,z=N.positionedLines.length===1)}V()}else{_==="auto"&&(_=Df(F));let A=ni(d,e.glyphMap,e.glyphPositions,e.imagePositions,p,k,a,F,_,T,g,1,!1,I,y,f);A&&(h.horizontal[_]=A),V(),mn(P)&&s&&l&&(h.vertical=ni(d,e.glyphMap,e.glyphPositions,e.imagePositions,p,k,a,F,_,T,g,2,!1,I,y,f))}}let b,x=!1;if(c.icon&&c.icon.name){let P=e.imageMap[c.icon.name];P&&(b=sf(e.imagePositions[c.icon.name],n.get("icon-offset").evaluate(c,{},e.canonical),n.get("icon-anchor").evaluate(c,{},e.canonical)),x=!!P.sdf,e.bucket.sdfIcons===void 0?e.bucket.sdfIcons=x:e.bucket.sdfIcons!==x&&fe("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(P.pixelRatio!==e.bucket.pixelRatio||n.get("icon-rotate").constantOr(1)!==0)&&(e.bucket.iconsNeedLinear=!0))}let v=zf(h.horizontal)||h.vertical;e.bucket.iconsInText=v?v.iconsInText:!1,(v||b)&&Ib(e.bucket,c,h,b,e.imageMap,o,y,m,g,x,e.canonical)}e.showCollisionBoxes&&e.bucket.generateCollisionDebugBuffers()}function Df(e){switch(e){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Ib(e,t,r,n,i,o,a,s,l,u,c){let p=o.textMaxSize.evaluate(t,{});p===void 0&&(p=a);let f=e.layers[0].layout,y=f.get("icon-offset").evaluate(t,{},c),m=zf(r.horizontal),h=24,d=a/h,g=e.tilePixelRatio*d,b=e.tilePixelRatio*p/h,x=e.tilePixelRatio*s,v=e.tilePixelRatio*f.get("symbol-spacing"),P=f.get("text-padding")*e.tilePixelRatio,w=yf(f,t,c,e.tilePixelRatio),T=f.get("text-max-angle")/180*Math.PI,F=f.get("text-rotation-alignment")!=="viewport"&&f.get("symbol-placement")!=="point",E=f.get("icon-rotation-alignment")==="map"&&f.get("symbol-placement")!=="point",_=f.get("symbol-placement"),I=v/2,k=f.get("icon-text-fit"),V;n&&k!=="none"&&(e.allowVerticalPlacement&&r.vertical&&(V=Xs(n,r.vertical,k,f.get("icon-text-fit-padding"),y,d)),m&&(n=Xs(n,m,k,f.get("icon-text-fit-padding"),y,d)));let A=(z,O)=>{O.x<0||O.x>=8192||O.y<0||O.y>=8192||Cb(e,O,z,r,n,i,V,e.layers[0],e.collisionBoxArray,t.index,t.sourceLayerIndex,e.index,g,[P,P,P,P],F,l,x,w,E,y,t,o,u,c,a)};if(_==="line")for(let z of Mf(t.geometry,0,0,8192,8192)){let O=Cf(z,v,T,r.vertical||m,n,h,b,e.overscaling,8192);for(let N of O){let K=m;(!K||!kb(e,K.text,I,N))&&A(z,N)}}else if(_==="line-center"){for(let z of t.geometry)if(z.length>1){let O=Tf(z,T,r.vertical||m,n,h,b);O&&A(z,O)}}else if(t.type==="Polygon")for(let z of _r(t.geometry,0)){let O=Lf(z,16);A(z[0],new rt(O.x,O.y,0))}else if(t.type==="LineString")for(let z of t.geometry)A(z,new rt(z[0].x,z[0].y,0));else if(t.type==="Point")for(let z of t.geometry)for(let O of z)A([O],new rt(O.x,O.y,0))}function Tb(e,t){let r=e.length,n=t==null?void 0:t.values;if((n==null?void 0:n.length)>0)for(let i=0;i<n.length;i+=2){let o=rl[n[i]],a=n[i+1];e.emplaceBack(o,a[0],a[1])}return[r,e.length]}function Vf(e,t,r,n,i,o,a,s,l,u,c,p,f,y,m){let h=Ff(t,r,s,i,o,a,n,e.allowVerticalPlacement),d=e.textSizeData,g=null;d.kind==="source"?(g=[Ct*i.layout.get("text-size").evaluate(a,{})],g[0]>tt&&fe(`${e.layerIds[0]}: Value for "text-size" is >= ${Lr}. Reduce your "text-size".`)):d.kind==="composite"&&(g=[Ct*y.compositeTextSizes[0].evaluate(a,{},m),Ct*y.compositeTextSizes[1].evaluate(a,{},m)],(g[0]>tt||g[1]>tt)&&fe(`${e.layerIds[0]}: Value for "text-size" is >= ${Lr}. Reduce your "text-size".`)),e.addSymbols(e.text,h,g,s,o,a,u,t,l.lineStartIndex,l.lineLength,f,m);for(let b of c)p[b]=e.text.placedSymbolArray.length-1;return h.length*4}function zf(e){for(let t in e)return e[t];return null}function Cb(e,t,r,n,i,o,a,s,l,u,c,p,f,y,m,h,d,g,b,x,v,P,w,T,F){let E=e.addToLineVertexArray(t,r),_,I,k,V,A=0,z=0,O=0,N=0,K=-1,xe=-1,X={},le=(0,ol.default)("");if(e.allowVerticalPlacement&&n.vertical){let ve=s.layout.get("text-rotate").evaluate(v,{},T)+90,Ve=n.vertical;k=new nr(l,t,u,c,p,Ve,f,y,m,ve),a&&(V=new nr(l,t,u,c,p,a,d,g,m,ve))}if(i){let Ie=s.layout.get("icon-rotate").evaluate(v,{}),ve=s.layout.get("icon-text-fit")!=="none",Ve=el(i,Ie,w,ve),Nr=a?el(a,Ie,w,ve):void 0;I=new nr(l,t,u,c,p,i,d,g,!1,Ie),A=Ve.length*4;let Fl=e.iconSizeData,Lt=null;Fl.kind==="source"?(Lt=[Ct*s.layout.get("icon-size").evaluate(v,{})],Lt[0]>tt&&fe(`${e.layerIds[0]}: Value for "icon-size" is >= ${Lr}. Reduce your "icon-size".`)):Fl.kind==="composite"&&(Lt=[Ct*P.compositeIconSizes[0].evaluate(v,{},T),Ct*P.compositeIconSizes[1].evaluate(v,{},T)],(Lt[0]>tt||Lt[1]>tt)&&fe(`${e.layerIds[0]}: Value for "icon-size" is >= ${Lr}. Reduce your "icon-size".`)),e.addSymbols(e.icon,Ve,Lt,x,b,v,0,t,E.lineStartIndex,E.lineLength,-1,T),K=e.icon.placedSymbolArray.length-1,Nr&&(z=Nr.length*4,e.addSymbols(e.icon,Nr,Lt,x,b,v,2,t,E.lineStartIndex,E.lineLength,-1,T),xe=e.icon.placedSymbolArray.length-1)}let ce=Object.keys(n.horizontal);for(let Ie of ce){let ve=n.horizontal[Ie];if(!_){le=(0,ol.default)(ve.text);let Nr=s.layout.get("text-rotate").evaluate(v,{},T);_=new nr(l,t,u,c,p,ve,f,y,m,Nr)}let Ve=ve.positionedLines.length===1;if(O+=Vf(e,t,ve,o,s,m,v,h,E,n.vertical?1:3,Ve?ce:[Ie],X,K,P,T),Ve)break}n.vertical&&(N+=Vf(e,t,n.vertical,o,s,m,v,h,E,2,["vertical"],X,xe,P,T));let pe=_?_.boxStartIndex:e.collisionBoxArray.length,_e=_?_.boxEndIndex:e.collisionBoxArray.length,be=k?k.boxStartIndex:e.collisionBoxArray.length,wi=k?k.boxEndIndex:e.collisionBoxArray.length,Ea=I?I.boxStartIndex:e.collisionBoxArray.length,Fa=I?I.boxEndIndex:e.collisionBoxArray.length,Or=V?V.boxStartIndex:e.collisionBoxArray.length,Ai=V?V.boxEndIndex:e.collisionBoxArray.length,Me=-1,Ft=(Ie,ve)=>Ie&&Ie.circleDiameter?Math.max(Ie.circleDiameter,ve):ve;Me=Ft(_,Me),Me=Ft(k,Me),Me=Ft(I,Me),Me=Ft(V,Me);let _i=Me>-1?1:0;_i&&(Me*=F/ne),e.glyphOffsetArray.length>=He.MAX_GLYPHS&&fe("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),v.sortKey!==void 0&&e.addToSortKeyRanges(e.symbolInstances.length,v.sortKey);let La=il(s,v,T),[Da,Va]=Tb(e.textAnchorOffsets,La);e.symbolInstances.emplaceBack(t.x,t.y,X.right>=0?X.right:-1,X.center>=0?X.center:-1,X.left>=0?X.left:-1,X.vertical||-1,K,xe,le,pe,_e,be,wi,Ea,Fa,Or,Ai,u,O,N,A,z,_i,0,f,Me,Da,Va)}function kb(e,t,r,n){let i=e.compareText;if(!(t in i))i[t]=[];else{let o=i[t];for(let a=o.length-1;a>=0;a--)if(n.dist(o[a])<r)return!0}return i[t].push(n),!1}var da=1,pi=class{constructor(t){let r={},n=[];for(let s in t){let l=t[s],u=r[s]={};for(let c in l){let p=l[+c];if(!p||p.bitmap.width===0||p.bitmap.height===0)continue;let f={x:0,y:0,w:p.bitmap.width+2*da,h:p.bitmap.height+2*da};n.push(f),u[c]={rect:f,metrics:p.metrics}}}let{w:i,h:o}=ei(n),a=new Yt({width:i||1,height:o||1});for(let s in t){let l=t[s];for(let u in l){let c=l[+u];if(!c||c.bitmap.width===0||c.bitmap.height===0)continue;let p=r[s][u].rect;Yt.copy(c.bitmap,a,{x:0,y:0},{x:p.x+da,y:p.y+da},c.bitmap)}}this.image=a,this.positions=r}};C("GlyphAtlas",pi);function Of(e,t,r){t=Math.pow(2,r)-t-1;var n=Rf(e*256,t*256,r),i=Rf((e+1)*256,(t+1)*256,r);return n[0]+","+n[1]+","+i[0]+","+i[1]}function Rf(e,t,r){var n=2*Math.PI*6378137/256/Math.pow(2,r),i=e*n-2*Math.PI*6378137/2,o=t*n-2*Math.PI*6378137/2;return[i,o]}var $f=Z(he(),1);var al=63710088e-1,fi=class e{constructor(t,r){if(isNaN(t)||isNaN(r))throw new Error(`Invalid LngLat object: (${t}, ${r})`);if(this.lng=+t,this.lat=+r,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new e(Gl(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(t){let r=Math.PI/180,n=this.lat*r,i=t.lat*r,o=Math.sin(n)*Math.sin(i)+Math.cos(n)*Math.cos(i)*Math.cos((t.lng-this.lng)*r);return al*Math.acos(Math.min(o,1))}static convert(t){if(t instanceof e)return t;if(Array.isArray(t)&&(t.length===2||t.length===3))return new e(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&typeof t=="object"&&t!==null)return new e(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}};var Nf=2*Math.PI*al;function Uf(e){return Nf*Math.cos(e*Math.PI/180)}function Mb(e){return(180+e)/360}function Eb(e){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e*Math.PI/360)))/360}function Fb(e,t){return e/Uf(t)}function Lb(e){return e*360-180}function sl(e){let t=180-e*360;return 360/Math.PI*Math.atan(Math.exp(t*Math.PI/180))-90}function Db(e,t){return e*Uf(sl(t))}function Vb(e){return 1/Math.cos(e*Math.PI/180)}var ga=class e{constructor(t,r,n=0){this.x=+t,this.y=+r,this.z=+n}static fromLngLat(t,r=0){let n=fi.convert(t);return new e(Mb(n.lng),Eb(n.lat),Fb(r,n.lat))}toLngLat(){return new fi(Lb(this.x),sl(this.y))}toAltitude(){return Db(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/Nf*Vb(sl(this.y))}};var xa=class{constructor(t,r,n){if(t<0||t>25||n<0||n>=Math.pow(2,t)||r<0||r>=Math.pow(2,t))throw new Error(`x=${r}, y=${n}, z=${t} outside of bounds. 0<=x<${Math.pow(2,t)}, 0<=y<${Math.pow(2,t)} 0<=z<=25 `);this.z=t,this.x=r,this.y=n,this.key=yi(0,t,t,r,n)}equals(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}url(t,r,n){let i=Of(this.x,this.y,this.z),o=Bb(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(n==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,r>1?"@2x":"").replace(/{quadkey}/g,o).replace(/{bbox-epsg-3857}/g,i)}isChildOf(t){let r=this.z-t.z;return r>0&&t.x===this.x>>r&&t.y===this.y>>r}getTilePoint(t){let r=Math.pow(2,this.z);return new $f.default((t.x*r-this.x)*8192,(t.y*r-this.y)*8192)}toString(){return`${this.z}/${this.x}/${this.y}`}},ll=class{constructor(t,r){this.wrap=t,this.canonical=r,this.key=yi(t,r.z,r.z,r.x,r.y)}},mi=class e{constructor(t,r,n,i,o){if(t<n)throw new Error(`overscaledZ should be >= z; overscaledZ = ${t}; z = ${n}`);this.overscaledZ=t,this.wrap=r,this.canonical=new xa(n,+i,+o),this.key=yi(r,t,n,i,o)}clone(){return new e(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)}scaledTo(t){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);let r=this.canonical.z-t;return t>this.canonical.z?new e(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new e(t,this.wrap,t,this.canonical.x>>r,this.canonical.y>>r)}calculateScaledKey(t,r){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);let n=this.canonical.z-t;return t>this.canonical.z?yi(this.wrap*+r,t,this.canonical.z,this.canonical.x,this.canonical.y):yi(this.wrap*+r,t,t,this.canonical.x>>n,this.canonical.y>>n)}isChildOf(t){if(t.wrap!==this.wrap)return!1;let r=this.canonical.z-t.canonical.z;return t.overscaledZ===0||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>r&&t.canonical.y===this.canonical.y>>r}children(t){if(this.overscaledZ>=t)return[new e(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];let r=this.canonical.z+1,n=this.canonical.x*2,i=this.canonical.y*2;return[new e(r,this.wrap,r,n,i),new e(r,this.wrap,r,n+1,i),new e(r,this.wrap,r,n,i+1),new e(r,this.wrap,r,n+1,i+1)]}isLessThan(t){return this.wrap<t.wrap?!0:this.wrap>t.wrap?!1:this.overscaledZ<t.overscaledZ?!0:this.overscaledZ>t.overscaledZ?!1:this.canonical.x<t.canonical.x?!0:this.canonical.x>t.canonical.x?!1:this.canonical.y<t.canonical.y}wrapped(){return new e(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(t){return new e(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new ll(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(t){return this.canonical.getTilePoint(new ga(t.x-this.wrap,t.y))}};function yi(e,t,r,n,i){e*=2,e<0&&(e=e*-1-1);let o=1<<r;return(o*o*e+o*i+n).toString(36)+r.toString(36)+t.toString(36)}function Bb(e,t,r){let n="",i;for(let o=e;o>0;o--)i=1<<o-1,n+=(t&i?1:0)+(r&i?2:0);return n}C("CanonicalTileID",xa);C("OverscaledTileID",mi,{omit:["posMatrix"]});var ba=class{constructor(t){this.tileID=new mi(t.tileID.overscaledZ,t.tileID.wrap,t.tileID.canonical.z,t.tileID.canonical.x,t.tileID.canonical.y),this.uid=t.uid,this.zoom=t.zoom,this.pixelRatio=t.pixelRatio,this.tileSize=t.tileSize,this.source=t.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=t.showCollisionBoxes,this.collectResourceTiming=!!t.collectResourceTiming,this.returnDependencies=!!t.returnDependencies,this.promoteId=t.promoteId,this.inFlightDependencies=[]}async parse(t,r,n,i){this.status="parsing",this.data=t,this.collisionBoxArray=new Fn;let o=new Dr(Object.keys(t.layers).sort()),a=new li(this.tileID,this.promoteId);a.bucketLayerIDs=[];let s={},l={featureIndex:a,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:n},u=r.familiesBySource[this.source];for(let P in u){let w=t.layers[P];if(!w)continue;w.version===1&&fe(`Vector tile source "${this.source}" layer "${P}" does not use vector tile spec v2 and therefore may have some rendering errors.`);let T=o.encode(P),F=[];for(let E=0;E<w.length;E++){let _=w.feature(E),I=a.getId(_,P);F.push({feature:_,id:I,index:E,sourceLayerIndex:T})}for(let E of u[P]){let _=E[0];if(_.source!==this.source&&fe(`layer.source = ${_.source} does not equal this.source = ${this.source}`),_.minzoom&&this.zoom<Math.floor(_.minzoom)||_.maxzoom&&this.zoom>=_.maxzoom||_.visibility==="none")continue;ul(E,this.zoom,n),(s[_.id]=_.createBucket({index:a.bucketLayerIDs.length,layers:E,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:T,sourceID:this.source})).populate(F,l,this.tileID.canonical),a.bucketLayerIDs.push(E.map(k=>k.id))}}let c=Gr(l.glyphDependencies,P=>Object.keys(P).map(Number));this.inFlightDependencies.forEach(P=>P==null?void 0:P.abort()),this.inFlightDependencies=[];let p=Promise.resolve({});if(Object.keys(c).length){let P=new AbortController;this.inFlightDependencies.push(P),p=i.sendAsync({type:"GG",data:{stacks:c,source:this.source,tileID:this.tileID,type:"glyphs"}},P)}let f=Object.keys(l.iconDependencies),y=Promise.resolve({});if(f.length){let P=new AbortController;this.inFlightDependencies.push(P),y=i.sendAsync({type:"GI",data:{icons:f,source:this.source,tileID:this.tileID,type:"icons"}},P)}let m=Object.keys(l.patternDependencies),h=Promise.resolve({});if(m.length){let P=new AbortController;this.inFlightDependencies.push(P),h=i.sendAsync({type:"GI",data:{icons:m,source:this.source,tileID:this.tileID,type:"patterns"}},P)}let[d,g,b]=await Promise.all([p,y,h]),x=new pi(d),v=new ti(g,b);for(let P in s){let w=s[P];w instanceof He?(ul(w.layers,this.zoom,n),Bf({bucket:w,glyphMap:d,glyphPositions:x.positions,imageMap:g,imagePositions:v.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):w.hasPattern&&(w instanceof rr||w instanceof er||w instanceof tr)&&(ul(w.layers,this.zoom,n),w.addFeatures(l,this.tileID.canonical,v.patternPositions))}return this.status="done",{buckets:Object.values(s).filter(P=>!P.isEmpty()),featureIndex:a,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:x.image,imageAtlas:v,glyphMap:this.returnDependencies?d:null,iconMap:this.returnDependencies?g:null,glyphPositions:this.returnDependencies?x.positions:null}}};function ul(e,t,r){let n=new q(t);for(let i of e)i.recalculate(n,r)}var zb=60,OI=1e3/zb;var zr=class{constructor(t){this._marks={start:[t.url,"start"].join("#"),end:[t.url,"end"].join("#"),measure:t.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let t=performance.getEntriesByName(this._marks.measure);return t.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),t=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),t}};var Rr=class{constructor(t,r,n){this.actor=t,this.layerIndex=r,this.availableImages=n,this.fetching={},this.loading={},this.loaded={}}async loadVectorTile(t,r){let n=await uc(t.request,r);try{return{vectorTile:new Gf.default.VectorTile(new qf.default(n.data)),rawData:n.data,cacheControl:n.cacheControl,expires:n.expires}}catch(i){let o=new Uint8Array(n.data),a=o[0]===31&&o[1]===139,s=`Unable to parse the tile at ${t.request.url}, `;throw a?s+="please make sure the data is not gzipped and that you have configured the relevant header in the server":s+=`got error: ${i.messge}`,new Error(s)}}async loadTile(t){let r=t.uid,n=t&&t.request&&t.request.collectResourceTiming?new zr(t.request):!1,i=new ba(t);this.loading[r]=i;let o=new AbortController;i.abort=o;try{let a=await this.loadVectorTile(t,o);if(delete this.loading[r],!a)return null;let s=a.rawData,l={};a.expires&&(l.expires=a.expires),a.cacheControl&&(l.cacheControl=a.cacheControl);let u={};if(n){let p=n.finish();p&&(u.resourceTiming=JSON.parse(JSON.stringify(p)))}i.vectorTile=a.vectorTile;let c=i.parse(a.vectorTile,this.layerIndex,this.availableImages,this.actor);this.loaded[r]=i,this.fetching[r]={rawTileData:s,cacheControl:l,resourceTiming:u};try{let p=await c;return Pe({rawTileData:s.slice(0)},p,l,u)}finally{delete this.fetching[r]}}catch(a){throw delete this.loading[r],i.status="done",this.loaded[r]=i,a}}async reloadTile(t){let r=t.uid;if(!this.loaded||!this.loaded[r])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");let n=this.loaded[r];if(n.showCollisionBoxes=t.showCollisionBoxes,n.status==="parsing"){let i=await n.parse(n.vectorTile,this.layerIndex,this.availableImages,this.actor),o;if(this.fetching[r]){let{rawTileData:a,cacheControl:s,resourceTiming:l}=this.fetching[r];delete this.fetching[r],o=Pe({rawTileData:a.slice(0)},i,s,l)}else o=i;return o}if(n.status==="done"&&n.vectorTile)return n.parse(n.vectorTile,this.layerIndex,this.availableImages,this.actor)}async abortTile(t){let r=this.loading,n=t.uid;r&&r[n]&&r[n].abort&&(r[n].abort.abort(),delete r[n])}async removeTile(t){this.loaded&&this.loaded[t.uid]&&delete this.loaded[t.uid]}};var hi=class{constructor(t,r,n,i=1,o=1,a=1,s=0){if(this.uid=t,r.height!==r.width)throw new RangeError("DEM tiles must be square");if(n&&!["mapbox","terrarium","custom"].includes(n)){fe(`"${n}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);return}this.stride=r.height;let l=this.dim=r.height-2;switch(this.data=new Uint32Array(r.data.buffer),n){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=i,this.greenFactor=o,this.blueFactor=a,this.baseShift=s;break;case"mapbox":default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4;break}for(let u=0;u<l;u++)this.data[this._idx(-1,u)]=this.data[this._idx(0,u)],this.data[this._idx(l,u)]=this.data[this._idx(l-1,u)],this.data[this._idx(u,-1)]=this.data[this._idx(u,0)],this.data[this._idx(u,l)]=this.data[this._idx(u,l-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(l,-1)]=this.data[this._idx(l-1,0)],this.data[this._idx(-1,l)]=this.data[this._idx(0,l-1)],this.data[this._idx(l,l)]=this.data[this._idx(l-1,l-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let u=0;u<l;u++)for(let c=0;c<l;c++){let p=this.get(u,c);p>this.max&&(this.max=p),p<this.min&&(this.min=p)}}get(t,r){let n=new Uint8Array(this.data.buffer),i=this._idx(t,r)*4;return this.unpack(n[i],n[i+1],n[i+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(t,r){if(t<-1||t>=this.dim+1||r<-1||r>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(r+1)*this.stride+(t+1)}unpack(t,r,n){return t*this.redFactor+r*this.greenFactor+n*this.blueFactor-this.baseShift}getPixels(){return new de({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(t,r,n){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");let i=r*this.dim,o=r*this.dim+this.dim,a=n*this.dim,s=n*this.dim+this.dim;switch(r){case-1:i=o-1;break;case 1:o=i+1;break}switch(n){case-1:a=s-1;break;case 1:s=a+1;break}let l=-r*this.dim,u=-n*this.dim;for(let c=a;c<s;c++)for(let p=i;p<o;p++)this.data[this._idx(p,c)]=t.data[this._idx(p+l,c+u)]}};C("DEMData",hi);var va=class{constructor(){this.loaded={}}async loadTile(t){let{uid:r,encoding:n,rawImageData:i,redFactor:o,greenFactor:a,blueFactor:s,baseShift:l}=t,u=i.width+2,c=i.height+2,p=qr(i)?new de({width:u,height:c},await Wl(i,-1,-1,u,c)):i,f=new hi(r,p,n,o,a,s,l);return this.loaded=this.loaded||{},this.loaded[r]=f,f}removeTile(t){let r=this.loaded,n=t.uid;r&&r[n]&&delete r[n]}};var gy=Z(Wf(),1);var cl=Z(he(),1),Hf=Z(Tt(),1);var Rb=Hf.default.VectorTileFeature.prototype.toGeoJSON,pl=class{constructor(t){this._feature=t,this.extent=8192,this.type=t.type,this.properties=t.tags,"id"in t&&!isNaN(t.id)&&(this.id=parseInt(t.id,10))}loadGeometry(){if(this._feature.type===1){let t=[];for(let r of this._feature.geometry)t.push([new cl.default(r[0],r[1])]);return t}else{let t=[];for(let r of this._feature.geometry){let n=[];for(let i of r)n.push(new cl.default(i[0],i[1]));t.push(n)}return t}}toGeoJSON(t,r,n){return Rb.call(this,t,r,n)}},Sa=class{constructor(t){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=8192,this.length=t.length,this._features=t}feature(t){return new pl(this._features[t])}};var xy=Z(ty(),1);var ry=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],ml=1,gi=8,bi=class e{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");let[r,n]=new Uint8Array(t,0,2);if(r!==219)throw new Error("Data does not appear to be in a KDBush format.");let i=n>>4;if(i!==ml)throw new Error(`Got v${i} data when expected v${ml}.`);let o=ry[n&15];if(!o)throw new Error("Unrecognized array type.");let[a]=new Uint16Array(t,2,1),[s]=new Uint32Array(t,4,1);return new e(s,a,o,t)}constructor(t,r=64,n=Float64Array,i){if(isNaN(t)||t<0)throw new Error(`Unpexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+r,2),65535),this.ArrayType=n,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;let o=ry.indexOf(this.ArrayType),a=t*2*this.ArrayType.BYTES_PER_ELEMENT,s=t*this.IndexArrayType.BYTES_PER_ELEMENT,l=(8-s%8)%8;if(o<0)throw new Error(`Unexpected typed array class: ${n}.`);i&&i instanceof ArrayBuffer?(this.data=i,this.ids=new this.IndexArrayType(this.data,gi,t),this.coords=new this.ArrayType(this.data,gi+s+l,t*2),this._pos=t*2,this._finished=!0):(this.data=new ArrayBuffer(gi+a+s+l),this.ids=new this.IndexArrayType(this.data,gi,t),this.coords=new this.ArrayType(this.data,gi+s+l,t*2),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,(ml<<4)+o]),new Uint16Array(this.data,2,1)[0]=r,new Uint32Array(this.data,4,1)[0]=t)}add(t,r){let n=this._pos>>1;return this.ids[n]=n,this.coords[this._pos++]=t,this.coords[this._pos++]=r,n}finish(){let t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return dl(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,r,n,i){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");let{ids:o,coords:a,nodeSize:s}=this,l=[0,o.length-1,0],u=[];for(;l.length;){let c=l.pop()||0,p=l.pop()||0,f=l.pop()||0;if(p-f<=s){for(let d=f;d<=p;d++){let g=a[2*d],b=a[2*d+1];g>=t&&g<=n&&b>=r&&b<=i&&u.push(o[d])}continue}let y=f+p>>1,m=a[2*y],h=a[2*y+1];m>=t&&m<=n&&h>=r&&h<=i&&u.push(o[y]),(c===0?t<=m:r<=h)&&(l.push(f),l.push(y-1),l.push(1-c)),(c===0?n>=m:i>=h)&&(l.push(y+1),l.push(p),l.push(1-c))}return u}within(t,r,n){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");let{ids:i,coords:o,nodeSize:a}=this,s=[0,i.length-1,0],l=[],u=n*n;for(;s.length;){let c=s.pop()||0,p=s.pop()||0,f=s.pop()||0;if(p-f<=a){for(let d=f;d<=p;d++)ny(o[2*d],o[2*d+1],t,r)<=u&&l.push(i[d]);continue}let y=f+p>>1,m=o[2*y],h=o[2*y+1];ny(m,h,t,r)<=u&&l.push(i[y]),(c===0?t-n<=m:r-n<=h)&&(s.push(f),s.push(y-1),s.push(1-c)),(c===0?t+n>=m:r+n>=h)&&(s.push(y+1),s.push(p),s.push(1-c))}return l}};function dl(e,t,r,n,i,o){if(i-n<=r)return;let a=n+i>>1;iy(e,t,a,n,i,o),dl(e,t,r,n,a-1,1-o),dl(e,t,r,a+1,i,1-o)}function iy(e,t,r,n,i,o){for(;i>n;){if(i-n>600){let u=i-n+1,c=r-n+1,p=Math.log(u),f=.5*Math.exp(2*p/3),y=.5*Math.sqrt(p*f*(u-f)/u)*(c-u/2<0?-1:1),m=Math.max(n,Math.floor(r-c*f/u+y)),h=Math.min(i,Math.floor(r+(u-c)*f/u+y));iy(e,t,r,m,h,o)}let a=t[2*r+o],s=n,l=i;for(xi(e,t,n,r),t[2*i+o]>a&&xi(e,t,n,i);s<l;){for(xi(e,t,s,l),s++,l--;t[2*s+o]<a;)s++;for(;t[2*l+o]>a;)l--}t[2*n+o]===a?xi(e,t,n,l):(l++,xi(e,t,l,i)),l<=r&&(n=l+1),r<=l&&(i=l-1)}}function xi(e,t,r,n){hl(e,r,n),hl(t,2*r,2*n),hl(t,2*r+1,2*n+1)}function hl(e,t,r){let n=e[t];e[t]=e[r],e[r]=n}function ny(e,t,r,n){let i=e-r,o=t-n;return i*i+o*o}var Hb={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:e=>e},oy=Math.fround||(e=>t=>(e[0]=+t,e[0]))(new Float32Array(1)),ir=2,Et=3,gl=4,Mt=5,sy=6,vi=class{constructor(t){this.options=Object.assign(Object.create(Hb),t),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(t){let{log:r,minZoom:n,maxZoom:i}=this.options;r&&console.time("total time");let o=`prepare ${t.length} points`;r&&console.time(o),this.points=t;let a=[];for(let l=0;l<t.length;l++){let u=t[l];if(!u.geometry)continue;let[c,p]=u.geometry.coordinates,f=oy(Aa(c)),y=oy(_a(p));a.push(f,y,1/0,l,-1,1),this.options.reduce&&a.push(0)}let s=this.trees[i+1]=this._createTree(a);r&&console.timeEnd(o);for(let l=i;l>=n;l--){let u=+Date.now();s=this.trees[l]=this._createTree(this._cluster(s,l)),r&&console.log("z%d: %d clusters in %dms",l,s.numItems,+Date.now()-u)}return r&&console.timeEnd("total time"),this}getClusters(t,r){let n=((t[0]+180)%360+360)%360-180,i=Math.max(-90,Math.min(90,t[1])),o=t[2]===180?180:((t[2]+180)%360+360)%360-180,a=Math.max(-90,Math.min(90,t[3]));if(t[2]-t[0]>=360)n=-180,o=180;else if(n>o){let p=this.getClusters([n,i,180,a],r),f=this.getClusters([-180,i,o,a],r);return p.concat(f)}let s=this.trees[this._limitZoom(r)],l=s.range(Aa(n),_a(a),Aa(o),_a(i)),u=s.data,c=[];for(let p of l){let f=this.stride*p;c.push(u[f+Mt]>1?ay(u,f,this.clusterProps):this.points[u[f+Et]])}return c}getChildren(t){let r=this._getOriginId(t),n=this._getOriginZoom(t),i="No cluster with the specified id.",o=this.trees[n];if(!o)throw new Error(i);let a=o.data;if(r*this.stride>=a.length)throw new Error(i);let s=this.options.radius/(this.options.extent*Math.pow(2,n-1)),l=a[r*this.stride],u=a[r*this.stride+1],c=o.within(l,u,s),p=[];for(let f of c){let y=f*this.stride;a[y+gl]===t&&p.push(a[y+Mt]>1?ay(a,y,this.clusterProps):this.points[a[y+Et]])}if(p.length===0)throw new Error(i);return p}getLeaves(t,r,n){r=r||10,n=n||0;let i=[];return this._appendLeaves(i,t,r,n,0),i}getTile(t,r,n){let i=this.trees[this._limitZoom(t)],o=Math.pow(2,t),{extent:a,radius:s}=this.options,l=s/a,u=(n-l)/o,c=(n+1+l)/o,p={features:[]};return this._addTileFeatures(i.range((r-l)/o,u,(r+1+l)/o,c),i.data,r,n,o,p),r===0&&this._addTileFeatures(i.range(1-l/o,u,1,c),i.data,o,n,o,p),r===o-1&&this._addTileFeatures(i.range(0,u,l/o,c),i.data,-1,n,o,p),p.features.length?p:null}getClusterExpansionZoom(t){let r=this._getOriginZoom(t)-1;for(;r<=this.options.maxZoom;){let n=this.getChildren(t);if(r++,n.length!==1)break;t=n[0].properties.cluster_id}return r}_appendLeaves(t,r,n,i,o){let a=this.getChildren(r);for(let s of a){let l=s.properties;if(l&&l.cluster?o+l.point_count<=i?o+=l.point_count:o=this._appendLeaves(t,l.cluster_id,n,i,o):o<i?o++:t.push(s),t.length===n)break}return o}_createTree(t){let r=new bi(t.length/this.stride|0,this.options.nodeSize,Float32Array);for(let n=0;n<t.length;n+=this.stride)r.add(t[n],t[n+1]);return r.finish(),r.data=t,r}_addTileFeatures(t,r,n,i,o,a){for(let s of t){let l=s*this.stride,u=r[l+Mt]>1,c,p,f;if(u)c=ly(r,l,this.clusterProps),p=r[l],f=r[l+1];else{let h=this.points[r[l+Et]];c=h.properties;let[d,g]=h.geometry.coordinates;p=Aa(d),f=_a(g)}let y={type:1,geometry:[[Math.round(this.options.extent*(p*o-n)),Math.round(this.options.extent*(f*o-i))]],tags:c},m;u||this.options.generateId?m=r[l+Et]:m=this.points[r[l+Et]].id,m!==void 0&&(y.id=m),a.features.push(y)}}_limitZoom(t){return Math.max(this.options.minZoom,Math.min(Math.floor(+t),this.options.maxZoom+1))}_cluster(t,r){let{radius:n,extent:i,reduce:o,minPoints:a}=this.options,s=n/(i*Math.pow(2,r)),l=t.data,u=[],c=this.stride;for(let p=0;p<l.length;p+=c){if(l[p+ir]<=r)continue;l[p+ir]=r;let f=l[p],y=l[p+1],m=t.within(l[p],l[p+1],s),h=l[p+Mt],d=h;for(let g of m){let b=g*c;l[b+ir]>r&&(d+=l[b+Mt])}if(d>h&&d>=a){let g=f*h,b=y*h,x,v=-1,P=((p/c|0)<<5)+(r+1)+this.points.length;for(let w of m){let T=w*c;if(l[T+ir]<=r)continue;l[T+ir]=r;let F=l[T+Mt];g+=l[T]*F,b+=l[T+1]*F,l[T+gl]=P,o&&(x||(x=this._map(l,p,!0),v=this.clusterProps.length,this.clusterProps.push(x)),o(x,this._map(l,T)))}l[p+gl]=P,u.push(g/d,b/d,1/0,P,-1,d),o&&u.push(v)}else{for(let g=0;g<c;g++)u.push(l[p+g]);if(d>1)for(let g of m){let b=g*c;if(!(l[b+ir]<=r)){l[b+ir]=r;for(let x=0;x<c;x++)u.push(l[b+x])}}}}return u}_getOriginId(t){return t-this.points.length>>5}_getOriginZoom(t){return(t-this.points.length)%32}_map(t,r,n){if(t[r+Mt]>1){let a=this.clusterProps[t[r+sy]];return n?Object.assign({},a):a}let i=this.points[t[r+Et]].properties,o=this.options.map(i);return n&&o===i?Object.assign({},o):o}};function ay(e,t,r){return{type:"Feature",id:e[t+Et],properties:ly(e,t,r),geometry:{type:"Point",coordinates:[Xb(e[t]),Kb(e[t+1])]}}}function ly(e,t,r){let n=e[t+Mt],i=n>=1e4?`${Math.round(n/1e3)}k`:n>=1e3?`${Math.round(n/100)/10}k`:n,o=e[t+sy],a=o===-1?{}:Object.assign({},r[o]);return Object.assign(a,{cluster:!0,cluster_id:e[t+Et],point_count:n,point_count_abbreviated:i})}function Aa(e){return e/360+.5}function _a(e){let t=Math.sin(e*Math.PI/180),r=.5-.25*Math.log((1+t)/(1-t))/Math.PI;return r<0?0:r>1?1:r}function Xb(e){return(e-.5)*360}function Kb(e){let t=(180-e*360)*Math.PI/180;return 360*Math.atan(Math.exp(t))/Math.PI-90}function Pi(e,t,r,n){for(var i=n,o=r-t>>1,a=r-t,s,l=e[t],u=e[t+1],c=e[r],p=e[r+1],f=t+3;f<r;f+=3){var y=Yb(e[f],e[f+1],l,u,c,p);if(y>i)s=f,i=y;else if(y===i){var m=Math.abs(f-o);m<a&&(s=f,a=m)}}i>n&&(s-t>3&&Pi(e,t,s,n),e[s+2]=i,r-s>3&&Pi(e,s,r,n))}function Yb(e,t,r,n,i,o){var a=i-r,s=o-n;if(a!==0||s!==0){var l=((e-r)*a+(t-n)*s)/(a*a+s*s);l>1?(r=i,n=o):l>0&&(r+=a*l,n+=s*l)}return a=e-r,s=t-n,a*a+s*s}function ft(e,t,r,n){var i={id:typeof e>"u"?null:e,type:t,geometry:r,tags:n,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return Qb(i),i}function Qb(e){var t=e.geometry,r=e.type;if(r==="Point"||r==="MultiPoint"||r==="LineString")xl(e,t);else if(r==="Polygon"||r==="MultiLineString")for(var n=0;n<t.length;n++)xl(e,t[n]);else if(r==="MultiPolygon")for(n=0;n<t.length;n++)for(var i=0;i<t[n].length;i++)xl(e,t[n][i])}function xl(e,t){for(var r=0;r<t.length;r+=3)e.minX=Math.min(e.minX,t[r]),e.minY=Math.min(e.minY,t[r+1]),e.maxX=Math.max(e.maxX,t[r]),e.maxY=Math.max(e.maxY,t[r+1])}function Pl(e,t){var r=[];if(e.type==="FeatureCollection")for(var n=0;n<e.features.length;n++)Ia(r,e.features[n],t,n);else e.type==="Feature"?Ia(r,e,t):Ia(r,{geometry:e},t);return r}function Ia(e,t,r,n){if(t.geometry){var i=t.geometry.coordinates,o=t.geometry.type,a=Math.pow(r.tolerance/((1<<r.maxZoom)*r.extent),2),s=[],l=t.id;if(r.promoteId?l=t.properties[r.promoteId]:r.generateId&&(l=n||0),o==="Point")uy(i,s);else if(o==="MultiPoint")for(var u=0;u<i.length;u++)uy(i[u],s);else if(o==="LineString")vl(i,s,a,!1);else if(o==="MultiLineString")if(r.lineMetrics){for(u=0;u<i.length;u++)s=[],vl(i[u],s,a,!1),e.push(ft(l,"LineString",s,t.properties));return}else bl(i,s,a,!1);else if(o==="Polygon")bl(i,s,a,!0);else if(o==="MultiPolygon")for(u=0;u<i.length;u++){var c=[];bl(i[u],c,a,!0),s.push(c)}else if(o==="GeometryCollection"){for(u=0;u<t.geometry.geometries.length;u++)Ia(e,{id:l,geometry:t.geometry.geometries[u],properties:t.properties},r,n);return}else throw new Error("Input data is not a valid GeoJSON object.");e.push(ft(l,o,s,t.properties))}}function uy(e,t){t.push(cy(e[0])),t.push(py(e[1])),t.push(0)}function vl(e,t,r,n){for(var i,o,a=0,s=0;s<e.length;s++){var l=cy(e[s][0]),u=py(e[s][1]);t.push(l),t.push(u),t.push(0),s>0&&(n?a+=(i*u-l*o)/2:a+=Math.sqrt(Math.pow(l-i,2)+Math.pow(u-o,2))),i=l,o=u}var c=t.length-3;t[2]=1,Pi(t,0,c,r),t[c+2]=1,t.size=Math.abs(a),t.start=0,t.end=t.size}function bl(e,t,r,n){for(var i=0;i<e.length;i++){var o=[];vl(e[i],o,r,n),t.push(o)}}function cy(e){return e/360+.5}function py(e){var t=Math.sin(e*Math.PI/180),r=.5-.25*Math.log((1+t)/(1-t))/Math.PI;return r<0?0:r>1?1:r}function qe(e,t,r,n,i,o,a,s){if(r/=t,n/=t,o>=r&&a<n)return e;if(a<r||o>=n)return null;for(var l=[],u=0;u<e.length;u++){var c=e[u],p=c.geometry,f=c.type,y=i===0?c.minX:c.minY,m=i===0?c.maxX:c.maxY;if(y>=r&&m<n){l.push(c);continue}else if(m<r||y>=n)continue;var h=[];if(f==="Point"||f==="MultiPoint")e0(p,h,r,n,i);else if(f==="LineString")yy(p,h,r,n,i,!1,s.lineMetrics);else if(f==="MultiLineString")Sl(p,h,r,n,i,!1);else if(f==="Polygon")Sl(p,h,r,n,i,!0);else if(f==="MultiPolygon")for(var d=0;d<p.length;d++){var g=[];Sl(p[d],g,r,n,i,!0),g.length&&h.push(g)}if(h.length){if(s.lineMetrics&&f==="LineString"){for(d=0;d<h.length;d++)l.push(ft(c.id,f,h[d],c.tags));continue}(f==="LineString"||f==="MultiLineString")&&(h.length===1?(f="LineString",h=h[0]):f="MultiLineString"),(f==="Point"||f==="MultiPoint")&&(f=h.length===3?"Point":"MultiPoint"),l.push(ft(c.id,f,h,c.tags))}}return l.length?l:null}function e0(e,t,r,n,i){for(var o=0;o<e.length;o+=3){var a=e[o+i];a>=r&&a<=n&&(t.push(e[o]),t.push(e[o+1]),t.push(e[o+2]))}}function yy(e,t,r,n,i,o,a){for(var s=fy(e),l=i===0?t0:r0,u=e.start,c,p,f=0;f<e.length-3;f+=3){var y=e[f],m=e[f+1],h=e[f+2],d=e[f+3],g=e[f+4],b=i===0?y:m,x=i===0?d:g,v=!1;a&&(c=Math.sqrt(Math.pow(y-d,2)+Math.pow(m-g,2))),b<r?x>r&&(p=l(s,y,m,d,g,r),a&&(s.start=u+c*p)):b>n?x<n&&(p=l(s,y,m,d,g,n),a&&(s.start=u+c*p)):wl(s,y,m,h),x<r&&b>=r&&(p=l(s,y,m,d,g,r),v=!0),x>n&&b<=n&&(p=l(s,y,m,d,g,n),v=!0),!o&&v&&(a&&(s.end=u+c*p),t.push(s),s=fy(e)),a&&(u+=c)}var P=e.length-3;y=e[P],m=e[P+1],h=e[P+2],b=i===0?y:m,b>=r&&b<=n&&wl(s,y,m,h),P=s.length-3,o&&P>=3&&(s[P]!==s[0]||s[P+1]!==s[1])&&wl(s,s[0],s[1],s[2]),s.length&&t.push(s)}function fy(e){var t=[];return t.size=e.size,t.start=e.start,t.end=e.end,t}function Sl(e,t,r,n,i,o){for(var a=0;a<e.length;a++)yy(e[a],t,r,n,i,o,!1)}function wl(e,t,r,n){e.push(t),e.push(r),e.push(n)}function t0(e,t,r,n,i,o){var a=(o-t)/(n-t);return e.push(o),e.push(r+(i-r)*a),e.push(1),a}function r0(e,t,r,n,i,o){var a=(o-r)/(i-r);return e.push(t+(n-t)*a),e.push(o),e.push(1),a}function _l(e,t){var r=t.buffer/t.extent,n=e,i=qe(e,1,-1-r,r,0,-1,2,t),o=qe(e,1,1-r,2+r,0,-1,2,t);return(i||o)&&(n=qe(e,1,-r,1+r,0,-1,2,t)||[],i&&(n=my(i,1).concat(n)),o&&(n=n.concat(my(o,-1)))),n}function my(e,t){for(var r=[],n=0;n<e.length;n++){var i=e[n],o=i.type,a;if(o==="Point"||o==="MultiPoint"||o==="LineString")a=Al(i.geometry,t);else if(o==="MultiLineString"||o==="Polygon"){a=[];for(var s=0;s<i.geometry.length;s++)a.push(Al(i.geometry[s],t))}else if(o==="MultiPolygon")for(a=[],s=0;s<i.geometry.length;s++){for(var l=[],u=0;u<i.geometry[s].length;u++)l.push(Al(i.geometry[s][u],t));a.push(l)}r.push(ft(i.id,o,a,i.tags))}return r}function Al(e,t){var r=[];r.size=e.size,e.start!==void 0&&(r.start=e.start,r.end=e.end);for(var n=0;n<e.length;n+=3)r.push(e[n]+t,e[n+1],e[n+2]);return r}function Ta(e,t){if(e.transformed)return e;var r=1<<e.z,n=e.x,i=e.y,o,a,s;for(o=0;o<e.features.length;o++){var l=e.features[o],u=l.geometry,c=l.type;if(l.geometry=[],c===1)for(a=0;a<u.length;a+=2)l.geometry.push(hy(u[a],u[a+1],t,r,n,i));else for(a=0;a<u.length;a++){var p=[];for(s=0;s<u[a].length;s+=2)p.push(hy(u[a][s],u[a][s+1],t,r,n,i));l.geometry.push(p)}}return e.transformed=!0,e}function hy(e,t,r,n,i,o){return[Math.round(r*(e*n-i)),Math.round(r*(t*n-o))]}function Tl(e,t,r,n,i){for(var o=t===i.maxZoom?0:i.tolerance/((1<<t)*i.extent),a={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:r,y:n,z:t,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},s=0;s<e.length;s++){a.numFeatures++,n0(a,e[s],o,i);var l=e[s].minX,u=e[s].minY,c=e[s].maxX,p=e[s].maxY;l<a.minX&&(a.minX=l),u<a.minY&&(a.minY=u),c>a.maxX&&(a.maxX=c),p>a.maxY&&(a.maxY=p)}return a}function n0(e,t,r,n){var i=t.geometry,o=t.type,a=[];if(o==="Point"||o==="MultiPoint")for(var s=0;s<i.length;s+=3)a.push(i[s]),a.push(i[s+1]),e.numPoints++,e.numSimplified++;else if(o==="LineString")Il(a,i,e,r,!1,!1);else if(o==="MultiLineString"||o==="Polygon")for(s=0;s<i.length;s++)Il(a,i[s],e,r,o==="Polygon",s===0);else if(o==="MultiPolygon")for(var l=0;l<i.length;l++){var u=i[l];for(s=0;s<u.length;s++)Il(a,u[s],e,r,!0,s===0)}if(a.length){var c=t.tags||null;if(o==="LineString"&&n.lineMetrics){c={};for(var p in t.tags)c[p]=t.tags[p];c.mapbox_clip_start=i.start/i.size,c.mapbox_clip_end=i.end/i.size}var f={geometry:a,type:o==="Polygon"||o==="MultiPolygon"?3:o==="LineString"||o==="MultiLineString"?2:1,tags:c};t.id!==null&&(f.id=t.id),e.features.push(f)}}function Il(e,t,r,n,i,o){var a=n*n;if(n>0&&t.size<(i?a:n)){r.numPoints+=t.length/3;return}for(var s=[],l=0;l<t.length;l+=3)(n===0||t[l+2]>a)&&(r.numSimplified++,s.push(t[l]),s.push(t[l+1])),r.numPoints++;i&&i0(s,o),e.push(s)}function i0(e,t){for(var r=0,n=0,i=e.length,o=i-2;n<i;o=n,n+=2)r+=(e[n]-e[o])*(e[n+1]+e[o+1]);if(r>0===t)for(n=0,i=e.length;n<i/2;n+=2){var a=e[n],s=e[n+1];e[n]=e[i-2-n],e[n+1]=e[i-1-n],e[i-2-n]=a,e[i-1-n]=s}}function kl(e,t){return new Ca(e,t)}function Ca(e,t){t=this.options=o0(Object.create(this.options),t);var r=t.debug;if(r&&console.time("preprocess data"),t.maxZoom<0||t.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(t.promoteId&&t.generateId)throw new Error("promoteId and generateId cannot be used together.");var n=Pl(e,t);this.tiles={},this.tileCoords=[],r&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",t.indexMaxZoom,t.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),n=_l(n,t),n.length&&this.splitTile(n,0,0,0),r&&(n.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}Ca.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};Ca.prototype.splitTile=function(e,t,r,n,i,o,a){for(var s=[e,t,r,n],l=this.options,u=l.debug;s.length;){n=s.pop(),r=s.pop(),t=s.pop(),e=s.pop();var c=1<<t,p=Cl(t,r,n),f=this.tiles[p];if(!f&&(u>1&&console.time("creation"),f=this.tiles[p]=Tl(e,t,r,n,l),this.tileCoords.push({z:t,x:r,y:n}),u)){u>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",t,r,n,f.numFeatures,f.numPoints,f.numSimplified),console.timeEnd("creation"));var y="z"+t;this.stats[y]=(this.stats[y]||0)+1,this.total++}if(f.source=e,i){if(t===l.maxZoom||t===i)continue;var m=1<<i-t;if(r!==Math.floor(o/m)||n!==Math.floor(a/m))continue}else if(t===l.indexMaxZoom||f.numPoints<=l.indexMaxPoints)continue;if(f.source=null,e.length!==0){u>1&&console.time("clipping");var h=.5*l.buffer/l.extent,d=.5-h,g=.5+h,b=1+h,x,v,P,w,T,F;x=v=P=w=null,T=qe(e,c,r-h,r+g,0,f.minX,f.maxX,l),F=qe(e,c,r+d,r+b,0,f.minX,f.maxX,l),e=null,T&&(x=qe(T,c,n-h,n+g,1,f.minY,f.maxY,l),v=qe(T,c,n+d,n+b,1,f.minY,f.maxY,l),T=null),F&&(P=qe(F,c,n-h,n+g,1,f.minY,f.maxY,l),w=qe(F,c,n+d,n+b,1,f.minY,f.maxY,l),F=null),u>1&&console.timeEnd("clipping"),s.push(x||[],t+1,r*2,n*2),s.push(v||[],t+1,r*2,n*2+1),s.push(P||[],t+1,r*2+1,n*2),s.push(w||[],t+1,r*2+1,n*2+1)}}};Ca.prototype.getTile=function(e,t,r){var n=this.options,i=n.extent,o=n.debug;if(e<0||e>24)return null;var a=1<<e;t=(t%a+a)%a;var s=Cl(e,t,r);if(this.tiles[s])return Ta(this.tiles[s],i);o>1&&console.log("drilling down to z%d-%d-%d",e,t,r);for(var l=e,u=t,c=r,p;!p&&l>0;)l--,u=Math.floor(u/2),c=Math.floor(c/2),p=this.tiles[Cl(l,u,c)];return!p||!p.source?null:(o>1&&console.log("found parent tile z%d-%d-%d",l,u,c),o>1&&console.time("drilling down"),this.splitTile(p.source,l,u,c,e,t,r),o>1&&console.timeEnd("drilling down"),this.tiles[s]?Ta(this.tiles[s],i):null)};function Cl(e,t,r){return((1<<e)*r+t)*32+e}function o0(e,t){for(var r in t)e[r]=t[r];return e}function Si(e,t){return t?e.properties[t]:e.id}function Ml(e,t){if(e==null)return!0;if(e.type==="Feature")return Si(e,t)!=null;if(e.type==="FeatureCollection"){let r=new Set;for(let n of e.features){let i=Si(n,t);if(i==null||r.has(i))return!1;r.add(i)}return!0}return!1}function El(e,t){let r=new Map;if(e!=null)if(e.type==="Feature")r.set(Si(e,t),e);else for(let n of e.features)r.set(Si(n,t),n);return r}function dy(e,t,r){var n,i,o,a;if(t.removeAll&&e.clear(),t.remove)for(let s of t.remove)e.delete(s);if(t.add)for(let s of t.add){let l=Si(s,r);l!=null&&e.set(l,s)}if(t.update)for(let s of t.update){let l=e.get(s.id);if(l==null)continue;let u=s.newGeometry||s.removeAllProperties,c=!s.removeAllProperties&&(((n=s.removeProperties)==null?void 0:n.length)>0||((i=s.addOrUpdateProperties)==null?void 0:i.length)>0);if((u||c)&&(l={...l},e.set(s.id,l),c&&(l.properties={...l.properties})),s.newGeometry&&(l.geometry=s.newGeometry),s.removeAllProperties)l.properties={};else if(((o=s.removeProperties)==null?void 0:o.length)>0)for(let p of s.removeProperties)Object.prototype.hasOwnProperty.call(l.properties,p)&&delete l.properties[p];if(((a=s.addOrUpdateProperties)==null?void 0:a.length)>0)for(let{key:p,value:f}of s.addOrUpdateProperties)l.properties[p]=f}}var ka=class extends Rr{constructor(){super(...arguments);this._dataUpdateable=new Map}async loadVectorTile(r,n){let i=r.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");let o=this._geoJSONIndex.getTile(i.z,i.x,i.y);if(!o)return null;let a=new Sa(o.features),s=(0,xy.default)(a);return(s.byteOffset!==0||s.byteLength!==s.buffer.byteLength)&&(s=new Uint8Array(s)),{vectorTile:a,rawData:s.buffer}}async loadData(r){var i;(i=this._pendingRequest)==null||i.abort();let n=r&&r.request&&r.request.collectResourceTiming?new zr(r.request):!1;this._pendingRequest=new AbortController;try{let o=await this.loadGeoJSON(r,this._pendingRequest);if(delete this._pendingRequest,typeof o!="object")throw new Error(`Input data given to \'${r.source}\' is not a valid GeoJSON object.`);if((0,gy.default)(o,!0),r.filter){let s=Gt(r.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(s.result==="error")throw new Error(s.value.map(u=>`${u.key}: ${u.message}`).join(", "));o={type:"FeatureCollection",features:o.features.filter(u=>s.value.evaluate({zoom:0},u))}}this._geoJSONIndex=r.cluster?new vi(a0(r)).load(o.features):kl(o,r.geojsonVtOptions),this.loaded={};let a={};if(n){let s=n.finish();s&&(a.resourceTiming={},a.resourceTiming[r.source]=JSON.parse(JSON.stringify(s)))}return a}catch(o){if(delete this._pendingRequest,ec(o))return{abandoned:!0};throw o}}reloadTile(r){let n=this.loaded,i=r.uid;return n&&n[i]?super.reloadTile(r):this.loadTile(r)}async loadGeoJSON(r,n){let{promoteId:i}=r;if(r.request){let o=await lc(r.request,n);return this._dataUpdateable=Ml(o.data,i)?El(o.data,i):void 0,o.data}if(typeof r.data=="string")try{let o=JSON.parse(r.data);return this._dataUpdateable=Ml(o,i)?El(o,i):void 0,o}catch{throw new Error(`Input data given to \'${r.source}\' is not a valid GeoJSON object.`)}if(!r.dataDiff)throw new Error(`Input data given to \'${r.source}\' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${r.source}`);return dy(this._dataUpdateable,r.dataDiff,i),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}}async removeSource(r){this._pendingRequest&&this._pendingRequest.abort()}getClusterExpansionZoom(r){return this._geoJSONIndex.getClusterExpansionZoom(r.clusterId)}getClusterChildren(r){return this._geoJSONIndex.getChildren(r.clusterId)}getClusterLeaves(r){return this._geoJSONIndex.getLeaves(r.clusterId,r.limit,r.offset)}};function a0({superclusterOptions:e,clusterProperties:t}){if(!t||!e)return e;let r={},n={},i={accumulated:null,zoom:0},o={properties:null},a=Object.keys(t);for(let s of a){let[l,u]=t[s],c=Gt(u),p=Gt(typeof l=="string"?[l,["accumulated"],["get",s]]:l);r[s]=c.value,n[s]=p.value}return e.map=s=>{o.properties=s;let l={};for(let u of a)l[u]=r[u].evaluate(i,o);return l},e.reduce=(s,l)=>{o.properties=l;for(let u of a)i.accumulated=s[u],s[u]=n[u].evaluate(i,o)},e}var Ma=class{constructor(t){this.self=t,this.actor=new to(t),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(r,n)=>{if(this.externalWorkerSourceTypes[r])throw new Error(`Worker source with name "${r}" already registered.`);this.externalWorkerSourceTypes[r]=n},this.self.addProtocol=rc,this.self.removeProtocol=nc,this.self.registerRTLTextPlugin=r=>{if(ye.isParsed())throw new Error("RTL text plugin already registered.");ye.setMethods(r)},this.actor.registerMessageHandler("LDT",(r,n)=>this._getDEMWorkerSource(r,n.source).loadTile(n)),this.actor.registerMessageHandler("RDT",async(r,n)=>{this._getDEMWorkerSource(r,n.source).removeTile(n)}),this.actor.registerMessageHandler("GCEZ",async(r,n)=>this._getWorkerSource(r,n.type,n.source).getClusterExpansionZoom(n)),this.actor.registerMessageHandler("GCC",async(r,n)=>this._getWorkerSource(r,n.type,n.source).getClusterChildren(n)),this.actor.registerMessageHandler("GCL",async(r,n)=>this._getWorkerSource(r,n.type,n.source).getClusterLeaves(n)),this.actor.registerMessageHandler("LD",(r,n)=>this._getWorkerSource(r,n.type,n.source).loadData(n)),this.actor.registerMessageHandler("LT",(r,n)=>this._getWorkerSource(r,n.type,n.source).loadTile(n)),this.actor.registerMessageHandler("RT",(r,n)=>this._getWorkerSource(r,n.type,n.source).reloadTile(n)),this.actor.registerMessageHandler("AT",(r,n)=>this._getWorkerSource(r,n.type,n.source).abortTile(n)),this.actor.registerMessageHandler("RMT",(r,n)=>this._getWorkerSource(r,n.type,n.source).removeTile(n)),this.actor.registerMessageHandler("RS",async(r,n)=>{if(!this.workerSources[r]||!this.workerSources[r][n.type]||!this.workerSources[r][n.type][n.source])return;let i=this.workerSources[r][n.type][n.source];delete this.workerSources[r][n.type][n.source],i.removeSource!==void 0&&i.removeSource(n)}),this.actor.registerMessageHandler("RM",async r=>{delete this.layerIndexes[r],delete this.availableImages[r],delete this.workerSources[r],delete this.demWorkerSources[r]}),this.actor.registerMessageHandler("SR",async(r,n)=>{this.referrer=n}),this.actor.registerMessageHandler("SRPS",(r,n)=>this._syncRTLPluginState(r,n)),this.actor.registerMessageHandler("IS",async(r,n)=>{this.self.importScripts(n)}),this.actor.registerMessageHandler("SI",(r,n)=>this._setImages(r,n)),this.actor.registerMessageHandler("UL",async(r,n)=>{this._getLayerIndex(r).update(n.layers,n.removedIds)}),this.actor.registerMessageHandler("SL",async(r,n)=>{this._getLayerIndex(r).replace(n)})}async _setImages(t,r){this.availableImages[t]=r;for(let n in this.workerSources[t]){let i=this.workerSources[t][n];for(let o in i)i[o].availableImages=r}}async _syncRTLPluginState(t,r){if(ye.isParsed())return ye.getState();if(r.pluginStatus!=="loading")return ye.setState(r),r;let n=r.pluginURL;if(this.self.importScripts(n),ye.isParsed()){let o={pluginStatus:"loaded",pluginURL:n};return ye.setState(o),o}throw ye.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${n}`)}_getAvailableImages(t){let r=this.availableImages[t];return r||(r=[]),r}_getLayerIndex(t){let r=this.layerIndexes[t];return r||(r=this.layerIndexes[t]=new ca),r}_getWorkerSource(t,r,n){if(this.workerSources[t]||(this.workerSources[t]={}),this.workerSources[t][r]||(this.workerSources[t][r]={}),!this.workerSources[t][r][n]){let i={sendAsync:(o,a)=>(o.targetMapId=t,this.actor.sendAsync(o,a))};switch(r){case"vector":this.workerSources[t][r][n]=new Rr(i,this._getLayerIndex(t),this._getAvailableImages(t));break;case"geojson":this.workerSources[t][r][n]=new ka(i,this._getLayerIndex(t),this._getAvailableImages(t));break;default:this.workerSources[t][r][n]=new this.externalWorkerSourceTypes[r](i,this._getLayerIndex(t),this._getAvailableImages(t));break}}return this.workerSources[t][r][n]}_getDEMWorkerSource(t,r){return this.demWorkerSources[t]||(this.demWorkerSources[t]={}),this.demWorkerSources[t][r]||(this.demWorkerSources[t][r]=new va),this.demWorkerSources[t][r]}};at(self)&&(self.worker=new Ma(self));})();\n/*! Bundled license information:\n\nieee754/index.js:\n  (*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> *)\n*/\n',Lle=h(()=>URL.createObjectURL(new Blob([Ile],{type:"text/javascript"})),"getWorkerURL");function r$(){return new Worker(Lle())}h(r$,"workerFactory");var U5="maplibre_preloaded_worker_pool",n$=class a${constructor(){this.active={}}acquire(e){if(!this.workers)for(this.workers=[];this.workers.length<a$.workerCount;)this.workers.push(r$());return this.active[e]=!0,this.workers.slice()}release(e){delete this.active[e],this.numActive()===0&&(this.workers.forEach(t=>{t.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[U5]}numActive(){return Object.keys(this.active).length}};h(n$,"WorkerPool");var Lx=n$,Dle=Math.floor(ai.hardwareConcurrency/2);Lx.workerCount=cL(globalThis)?Math.max(Math.min(Dle,3),1):1;var Wf;function Dx(){return Wf||(Wf=new Lx),Wf}h(Dx,"getGlobalWorkerPool");function kle(){Dx().acquire(U5)}h(kle,"prewarm");function Rle(){let i=Wf;i&&(i.isPreloaded()&&i.numActive()===1?(i.release(U5),Wf=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))}h(Rle,"clearPrewarmedResources");var o$=class{constructor(e,t){this.workerPool=e,this.actors=[],this.currentActor=0,this.id=t;let r=this.workerPool.acquire(t);for(let n=0;n<r.length;n++){let a=r[n],o=new Ale(a,t);o.name=`Worker ${n}`,this.actors.push(o)}if(!this.actors.length)throw new Error("No actors found")}broadcast(e,t){let r=[];for(let n of this.actors)r.push(n.sendAsync({type:e,data:t}));return Promise.all(r)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(e=!0){this.actors.forEach(t=>{t.remove()}),this.actors=[],e&&this.workerPool.release(this.id)}registerMessageHandler(e,t){for(let r of this.actors)r.registerMessageHandler(e,t)}};h(o$,"Dispatcher");var s$=o$,$g;function V5(){return $g||($g=new s$(Dx(),Gb),$g.registerMessageHandler("GR",(i,e,t)=>ix(e,t))),$g}h(V5,"getGlobalDispatcher");R();function l$(i,e){let t=lt.create();return lt.translate(t,t,[1,1,0]),lt.scale(t,t,[i.width*.5,i.height*.5,1]),lt.multiply(t,t,i.calculatePosMatrix(e.toUnwrapped()))}h(l$,"getPixelPosMatrix");function u$(i,e,t){if(i)for(let r of i){let n=e[r];if(n&&n.source===t&&n.type==="fill-extrusion")return!0}else for(let r in e){let n=e[r];if(n.source===t&&n.type==="fill-extrusion")return!0}return!1}h(u$,"queryIncludes3DLayer");function h$(i,e,t,r,n,a){let o=u$(n&&n.layers,e,i.id),s=a.maxPitchScaleFactor(),l=i.tilesIn(r,s,o);l.sort(j5);let u=[];for(let p of l)u.push({wrappedTileID:p.tileID.wrapped().key,queryResults:p.tile.queryRenderedFeatures(e,t,i._state,p.queryGeometry,p.cameraQueryGeometry,p.scale,n,a,s,l$(i.transform,p.tileID))});let c=d$(u);for(let p in c)c[p].forEach(d=>{let m=d.feature,g=i.getFeatureState(m.layer["source-layer"],m.id);m.source=m.layer.source,m.layer["source-layer"]&&(m.sourceLayer=m.layer["source-layer"]),m.state=g});return c}h(h$,"queryRenderedFeatures");function c$(i,e,t,r,n,a,o){let s={},l=a.queryRenderedSymbols(r),u=[];for(let c of Object.keys(l).map(Number))u.push(o[c]);u.sort(j5);for(let c of u){let p=c.featureIndex.lookupSymbolFeatures(l[c.bucketInstanceId],e,c.bucketIndex,c.sourceLayerIndex,n.filter,n.layers,n.availableImages,i);for(let d in p){let m=s[d]=s[d]||[],g=p[d];g.sort((b,x)=>{let v=c.featureSortOrder;if(v){let w=v.indexOf(b.featureIndex);return v.indexOf(x.featureIndex)-w}else return x.featureIndex-b.featureIndex});for(let b of g)m.push(b)}}for(let c in s)s[c].forEach(p=>{let d=p.feature,m=i[c],g=t[m.source].getFeatureState(d.layer["source-layer"],d.id);d.source=d.layer.source,d.layer["source-layer"]&&(d.sourceLayer=d.layer["source-layer"]),d.state=g});return s}h(c$,"queryRenderedSymbols");function p$(i,e){let t=i.getRenderableIds().map(a=>i.getTileByID(a)),r=[],n={};for(let a=0;a<t.length;a++){let o=t[a],s=o.tileID.canonical.key;n[s]||(n[s]=!0,o.querySourceFeatures(r,e))}return r}h(p$,"querySourceFeatures");function j5(i,e){let t=i.tileID,r=e.tileID;return t.overscaledZ-r.overscaledZ||t.canonical.y-r.canonical.y||t.wrap-r.wrap||t.canonical.x-r.canonical.x}h(j5,"sortTilesIn");function d$(i){let e={},t={};for(let r of i){let n=r.queryResults,a=r.wrappedTileID,o=t[a]=t[a]||{};for(let s in n){let l=n[s],u=o[s]=o[s]||{},c=e[s]=e[s]||[];for(let p of l)u[p.featureIndex]||(u[p.featureIndex]=!0,c.push(p))}}return e}h(d$,"mergeRenderedFeatureLayers");R();R();R();R();async function H5(i,e,t){let r=i;if(i.url?r=(await rx(e.transformRequest(i.url,"Source"),t)).data:await ai.frameAsync(t),!r)return null;let n=Om(ht(r,i),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in r&&r.vector_layers&&(n.vectorLayerIds=r.vector_layers.map(a=>a.id)),n}h(H5,"loadTileJson");R();R();R();var G5=63710088e-1,f$=class Jd{constructor(e,t){if(isNaN(e)||isNaN(t))throw new Error(`Invalid LngLat object: (${e}, ${t})`);if(this.lng=+e,this.lat=+t,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Jd(Eu(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(e){let t=Math.PI/180,r=this.lat*t,n=e.lat*t,a=Math.sin(r)*Math.sin(n)+Math.cos(r)*Math.cos(n)*Math.cos((e.lng-this.lng)*t);return G5*Math.acos(Math.min(a,1))}static convert(e){if(e instanceof Jd)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new Jd(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new Jd(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}};h(f$,"LngLat");var Jt=f$,m$=class Yh{constructor(e,t){e&&(t?this.setSouthWest(e).setNorthEast(t):Array.isArray(e)&&(e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1])))}setNorthEast(e){return this._ne=e instanceof Jt?new Jt(e.lng,e.lat):Jt.convert(e),this}setSouthWest(e){return this._sw=e instanceof Jt?new Jt(e.lng,e.lat):Jt.convert(e),this}extend(e){let t=this._sw,r=this._ne,n,a;if(e instanceof Jt)n=e,a=e;else if(e instanceof Yh){if(n=e._sw,a=e._ne,!n||!a)return this}else{if(Array.isArray(e))if(e.length===4||e.every(Array.isArray)){let o=e;return this.extend(Yh.convert(o))}else{let o=e;return this.extend(Jt.convert(o))}else if(e&&("lng"in e||"lon"in e)&&"lat"in e)return this.extend(Jt.convert(e));return this}return!t&&!r?(this._sw=new Jt(n.lng,n.lat),this._ne=new Jt(a.lng,a.lat)):(t.lng=Math.min(n.lng,t.lng),t.lat=Math.min(n.lat,t.lat),r.lng=Math.max(a.lng,r.lng),r.lat=Math.max(a.lat,r.lat)),this}getCenter(){return new Jt((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new Jt(this.getWest(),this.getNorth())}getSouthEast(){return new Jt(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){let{lng:t,lat:r}=Jt.convert(e),n=this._sw.lat<=r&&r<=this._ne.lat,a=this._sw.lng<=t&&t<=this._ne.lng;return this._sw.lng>this._ne.lng&&(a=this._sw.lng>=t&&t>=this._ne.lng),n&&a}static convert(e){return e instanceof Yh||!e?e:new Yh(e)}static fromLngLat(e,t=0){let r=360*t/40075017,n=r/Math.cos(Math.PI/180*e.lat);return new Yh(new Jt(e.lng-n,e.lat-r),new Jt(e.lng+n,e.lat+r))}};h(m$,"LngLatBounds");var zl=m$;R();var g$=2*Math.PI*G5;function W5(i){return g$*Math.cos(i*Math.PI/180)}h(W5,"circumferenceAtLatitude");function ku(i){return(180+i)/360}h(ku,"mercatorXfromLng");function Ru(i){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i*Math.PI/360)))/360}h(Ru,"mercatorYfromLat");function uv(i,e){return i/W5(e)}h(uv,"mercatorZfromAltitude");function y$(i){return i*360-180}h(y$,"lngFromMercatorX");function hv(i){let e=180-i*360;return 360/Math.PI*Math.atan(Math.exp(e*Math.PI/180))-90}h(hv,"latFromMercatorY");function v$(i,e){return i*W5(hv(e))}h(v$,"altitudeFromMercatorZ");function x$(i){return 1/Math.cos(i*Math.PI/180)}h(x$,"mercatorScale");var _$=class b${constructor(e,t,r=0){this.x=+e,this.y=+t,this.z=+r}static fromLngLat(e,t=0){let r=Jt.convert(e);return new b$(ku(r.lng),Ru(r.lat),uv(t,r.lat))}toLngLat(){return new Jt(y$(this.x),hv(this.y))}toAltitude(){return v$(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/g$*x$(hv(this.y))}};h(_$,"MercatorCoordinate");var qr=_$,w$=class{constructor(e,t,r){this.bounds=zl.convert(this.validateBounds(e)),this.minzoom=t||0,this.maxzoom=r||24}validateBounds(e){return!Array.isArray(e)||e.length!==4?[-180,-90,180,90]:[Math.max(-180,e[0]),Math.max(-90,e[1]),Math.min(180,e[2]),Math.min(90,e[3])]}contains(e){let t=Math.pow(2,e.z),r={minX:Math.floor(ku(this.bounds.getWest())*t),minY:Math.floor(Ru(this.bounds.getNorth())*t),maxX:Math.ceil(ku(this.bounds.getEast())*t),maxY:Math.ceil(Ru(this.bounds.getSouth())*t)};return e.x>=r.minX&&e.x<r.maxX&&e.y>=r.minY&&e.y<r.maxY}};h(w$,"TileBounds");var S$=w$,M$=class extends hn{constructor(e,t,r,n){if(super(),this.id=e,this.dispatcher=r,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,ht(this,Om(t,["url","scheme","tileSize","promoteId"])),this._options=ht({type:"vector"},t),this._collectResourceTiming=t.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(n)}async load(){this._loaded=!1,this.fire(new qe("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{let e=await H5(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),e&&(ht(this,e),e.bounds&&(this.tileBounds=new S$(e.bounds,this.minzoom,this.maxzoom)),this.fire(new qe("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new qe("data",{dataType:"source",sourceDataType:"content"})))}catch(e){this._tileJSONRequest=null,this.fire(new Mt(e))}}loaded(){return this._loaded}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}onAdd(e){this.map=e,this.load()}setSourceProperty(e){this._tileJSONRequest&&this._tileJSONRequest.abort(),e(),this.load()}setTiles(e){return this.setSourceProperty(()=>{this._options.tiles=e}),this}setUrl(e){return this.setSourceProperty(()=>{this.url=e,this._options.url=e}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return ht({},this._options)}async loadTile(e){let t=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),r={request:this.map._requestManager.transformRequest(t,"Tile"),uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,tileSize:this.tileSize*e.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};r.request.collectResourceTiming=this._collectResourceTiming;let n="RT";if(!e.actor||e.state==="expired")e.actor=this.dispatcher.getActor(),n="LT";else if(e.state==="loading")return new Promise((a,o)=>{e.reloadPromise={resolve:a,reject:o}});e.abortController=new AbortController;try{let a=await e.actor.sendAsync({type:n,data:r},e.abortController);if(delete e.abortController,e.aborted)return;this._afterTileLoadWorkerResponse(e,a)}catch(a){if(delete e.abortController,e.aborted)return;if(a&&a.status!==404)throw a;this._afterTileLoadWorkerResponse(e,null)}}_afterTileLoadWorkerResponse(e,t){if(t&&t.resourceTiming&&(e.resourceTiming=t.resourceTiming),t&&this.map._refreshExpiredTiles&&e.setExpiryData(t),e.loadVectorData(t,this.map.painter),e.reloadPromise){let r=e.reloadPromise;e.reloadPromise=null,this.loadTile(e).then(r.resolve).catch(r.reject)}}async abortTile(e){e.abortController&&(e.abortController.abort(),delete e.abortController),e.actor&&await e.actor.sendAsync({type:"AT",data:{uid:e.uid,type:this.type,source:this.id}})}async unloadTile(e){e.unloadVectorData(),e.actor&&await e.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}})}hasTransition(){return!1}};h(M$,"VectorTileSource");var Fle=M$;R();var C$=class extends hn{constructor(e,t,r,n){super(),this.id=e,this.dispatcher=r,this.setEventedParent(n),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=ht({type:"raster"},t),ht(this,Om(t,["url","scheme","tileSize"]))}async load(){this._loaded=!1,this.fire(new qe("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{let e=await H5(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,e&&(ht(this,e),e.bounds&&(this.tileBounds=new S$(e.bounds,this.minzoom,this.maxzoom)),this.fire(new qe("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new qe("data",{dataType:"source",sourceDataType:"content"})))}catch(e){this._tileJSONRequest=null,this.fire(new Mt(e))}}loaded(){return this._loaded}onAdd(e){this.map=e,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(e){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),e(),this.load()}setTiles(e){return this.setSourceProperty(()=>{this._options.tiles=e}),this}setUrl(e){return this.setSourceProperty(()=>{this.url=e,this._options.url=e}),this}serialize(){return ht({},this._options)}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}async loadTile(e){let t=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);e.abortController=new AbortController;try{let r=await Uo.getImage(this.map._requestManager.transformRequest(t,"Tile"),e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted){e.state="unloaded";return}if(r&&r.data){this.map._refreshExpiredTiles&&r.cacheControl&&r.expires&&e.setExpiryData({cacheControl:r.cacheControl,expires:r.expires});let n=this.map.painter.context,a=n.gl,o=r.data;e.texture=this.map.painter.getTileTexture(o.width),e.texture?e.texture.update(o,{useMipmap:!0}):(e.texture=new Rr(n,o,a.RGBA,{useMipmap:!0}),e.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE,a.LINEAR_MIPMAP_NEAREST),n.extTextureFilterAnisotropic&&a.texParameterf(a.TEXTURE_2D,n.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,n.extTextureFilterAnisotropicMax)),e.state="loaded"}}catch(r){if(delete e.abortController,e.aborted)e.state="unloaded";else if(r)throw e.state="errored",r}}async abortTile(e){e.abortController&&(e.abortController.abort(),delete e.abortController)}async unloadTile(e){e.texture&&this.map.painter.saveTileTexture(e.texture)}hasTransition(){return!1}};h(C$,"RasterTileSource");var E$=C$;R();R();R();function T$(i,e,t){e=Math.pow(2,t)-e-1;var r=Uw(i*256,e*256,t),n=Uw((i+1)*256,(e+1)*256,t);return r[0]+","+r[1]+","+n[0]+","+n[1]}h(T$,"getTileBBox");function Uw(i,e,t){var r=2*Math.PI*6378137/256/Math.pow(2,t),n=i*r-2*Math.PI*6378137/2,a=e*r-2*Math.PI*6378137/2;return[n,a]}h(Uw,"getMercCoords");var zle=It(di(),1),P$=class{constructor(e,t,r){if(e<0||e>25||r<0||r>=Math.pow(2,e)||t<0||t>=Math.pow(2,e))throw new Error(`x=${t}, y=${r}, z=${e} outside of bounds. 0<=x<${Math.pow(2,e)}, 0<=y<${Math.pow(2,e)} 0<=z<=25 `);this.z=e,this.x=t,this.y=r,this.key=cp(0,e,e,t,r)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,t,r){let n=T$(this.x,this.y,this.z),a=L$(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(r==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,t>1?"@2x":"").replace(/{quadkey}/g,a).replace(/{bbox-epsg-3857}/g,n)}isChildOf(e){let t=this.z-e.z;return t>0&&e.x===this.x>>t&&e.y===this.y>>t}getTilePoint(e){let t=Math.pow(2,this.z);return new zle.default((e.x*t-this.x)*8192,(e.y*t-this.y)*8192)}toString(){return`${this.z}/${this.x}/${this.y}`}};h(P$,"CanonicalTileID");var X5=P$,A$=class{constructor(e,t){this.wrap=e,this.canonical=t,this.key=cp(e,t.z,t.z,t.x,t.y)}};h(A$,"UnwrappedTileID");var Vw=A$,I$=class Ka{constructor(e,t,r,n,a){if(e<r)throw new Error(`overscaledZ should be >= z; overscaledZ = ${e}; z = ${r}`);this.overscaledZ=e,this.wrap=t,this.canonical=new X5(r,+n,+a),this.key=cp(t,e,r,n,a)}clone(){return new Ka(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){if(e>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${e}; overscaledZ = ${this.overscaledZ}`);let t=this.canonical.z-e;return e>this.canonical.z?new Ka(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Ka(e,this.wrap,e,this.canonical.x>>t,this.canonical.y>>t)}calculateScaledKey(e,t){if(e>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${e}; overscaledZ = ${this.overscaledZ}`);let r=this.canonical.z-e;return e>this.canonical.z?cp(this.wrap*+t,e,this.canonical.z,this.canonical.x,this.canonical.y):cp(this.wrap*+t,e,e,this.canonical.x>>r,this.canonical.y>>r)}isChildOf(e){if(e.wrap!==this.wrap)return!1;let t=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>t&&e.canonical.y===this.canonical.y>>t}children(e){if(this.overscaledZ>=e)return[new Ka(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];let t=this.canonical.z+1,r=this.canonical.x*2,n=this.canonical.y*2;return[new Ka(t,this.wrap,t,r,n),new Ka(t,this.wrap,t,r+1,n),new Ka(t,this.wrap,t,r,n+1),new Ka(t,this.wrap,t,r+1,n+1)]}isLessThan(e){return this.wrap<e.wrap?!0:this.wrap>e.wrap?!1:this.overscaledZ<e.overscaledZ?!0:this.overscaledZ>e.overscaledZ?!1:this.canonical.x<e.canonical.x?!0:this.canonical.x>e.canonical.x?!1:this.canonical.y<e.canonical.y}wrapped(){return new Ka(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new Ka(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Vw(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(e){return this.canonical.getTilePoint(new qr(e.x-this.wrap,e.y))}};h(I$,"OverscaledTileID");var ra=I$;function cp(i,e,t,r,n){i*=2,i<0&&(i=i*-1-1);let a=1<<t;return(a*a*i+a*n+r).toString(36)+t.toString(36)+e.toString(36)}h(cp,"calculateKey");function L$(i,e,t){let r="",n;for(let a=i;a>0;a--)n=1<<a-1,r+=(e&n?1:0)+(t&n?2:0);return r}h(L$,"getQuadkey");st("CanonicalTileID",X5);st("OverscaledTileID",ra,{omit:["posMatrix"]});R();var D$=class{constructor(e,t,r,n=1,a=1,o=1,s=0){if(this.uid=e,t.height!==t.width)throw new RangeError("DEM tiles must be square");if(r&&!["mapbox","terrarium","custom"].includes(r)){ln(`"${r}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);return}this.stride=t.height;let l=this.dim=t.height-2;switch(this.data=new Uint32Array(t.data.buffer),r){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=n,this.greenFactor=a,this.blueFactor=o,this.baseShift=s;break;case"mapbox":default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4;break}for(let u=0;u<l;u++)this.data[this._idx(-1,u)]=this.data[this._idx(0,u)],this.data[this._idx(l,u)]=this.data[this._idx(l-1,u)],this.data[this._idx(u,-1)]=this.data[this._idx(u,0)],this.data[this._idx(u,l)]=this.data[this._idx(u,l-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(l,-1)]=this.data[this._idx(l-1,0)],this.data[this._idx(-1,l)]=this.data[this._idx(0,l-1)],this.data[this._idx(l,l)]=this.data[this._idx(l-1,l-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let u=0;u<l;u++)for(let c=0;c<l;c++){let p=this.get(u,c);p>this.max&&(this.max=p),p<this.min&&(this.min=p)}}get(e,t){let r=new Uint8Array(this.data.buffer),n=this._idx(e,t)*4;return this.unpack(r[n],r[n+1],r[n+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(e,t){if(e<-1||e>=this.dim+1||t<-1||t>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(t+1)*this.stride+(e+1)}unpack(e,t,r){return e*this.redFactor+t*this.greenFactor+r*this.blueFactor-this.baseShift}getPixels(){return new Qi({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(e,t,r){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let n=t*this.dim,a=t*this.dim+this.dim,o=r*this.dim,s=r*this.dim+this.dim;switch(t){case-1:n=a-1;break;case 1:a=n+1;break}switch(r){case-1:o=s-1;break;case 1:s=o+1;break}let l=-t*this.dim,u=-r*this.dim;for(let c=o;c<s;c++)for(let p=n;p<a;p++)this.data[this._idx(p,c)]=e.data[this._idx(p+l,c+u)]}};h(D$,"DEMData");var Ble=D$;st("DEMData",Ble);var k$=class extends E${constructor(e,t,r,n){super(e,t,r,n),this.type="raster-dem",this.maxzoom=22,this._options=ht({type:"raster-dem"},t),this.encoding=t.encoding||"mapbox",this.redFactor=t.redFactor,this.greenFactor=t.greenFactor,this.blueFactor=t.blueFactor,this.baseShift=t.baseShift}async loadTile(e){let t=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),r=this.map._requestManager.transformRequest(t,"Tile");e.neighboringTiles=this._getNeighboringTiles(e.tileID),e.abortController=new AbortController;try{let n=await Uo.getImage(r,e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted){e.state="unloaded";return}if(n&&n.data){let a=n.data;this.map._refreshExpiredTiles&&n.cacheControl&&n.expires&&e.setExpiryData({cacheControl:n.cacheControl,expires:n.expires});let o=$o(a)&&IC()?a:await this.readImageNow(a),s={type:this.type,uid:e.uid,source:this.id,rawImageData:o,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!e.actor||e.state==="expired"){e.actor=this.dispatcher.getActor();let l=await e.actor.sendAsync({type:"LDT",data:s});e.dem=l,e.needsHillshadePrepare=!0,e.needsTerrainPrepare=!0,e.state="loaded"}}}catch(n){if(delete e.abortController,e.aborted)e.state="unloaded";else if(n)throw e.state="errored",n}}async readImageNow(e){if(typeof VideoFrame<"u"&&tL()){let t=e.width+2,r=e.height+2;try{return new Qi({width:t,height:r},await dL(e,-1,-1,t,r))}catch{}}return ai.getImageData(e,1)}_getNeighboringTiles(e){let t=e.canonical,r=Math.pow(2,t.z),n=(t.x-1+r)%r,a=t.x===0?e.wrap-1:e.wrap,o=(t.x+1+r)%r,s=t.x+1===r?e.wrap+1:e.wrap,l={};return l[new ra(e.overscaledZ,a,t.z,n,t.y).key]={backfilled:!1},l[new ra(e.overscaledZ,s,t.z,o,t.y).key]={backfilled:!1},t.y>0&&(l[new ra(e.overscaledZ,a,t.z,n,t.y-1).key]={backfilled:!1},l[new ra(e.overscaledZ,e.wrap,t.z,t.x,t.y-1).key]={backfilled:!1},l[new ra(e.overscaledZ,s,t.z,o,t.y-1).key]={backfilled:!1}),t.y+1<r&&(l[new ra(e.overscaledZ,a,t.z,n,t.y+1).key]={backfilled:!1},l[new ra(e.overscaledZ,e.wrap,t.z,t.x,t.y+1).key]={backfilled:!1},l[new ra(e.overscaledZ,s,t.z,o,t.y+1).key]={backfilled:!1}),l}async unloadTile(e){e.demTexture&&this.map.painter.saveTileTexture(e.demTexture),e.fbo&&(e.fbo.destroy(),delete e.fbo),e.dem&&delete e.dem,delete e.neighboringTiles,e.state="unloaded",e.actor&&await e.actor.sendAsync({type:"RDT",data:{type:this.type,uid:e.uid,source:this.id}})}};h(k$,"RasterDEMTileSource");var Ole=k$;R();var R$=class extends hn{constructor(e,t,r,n){super(),this.id=e,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=r.getActor(),this.setEventedParent(n),this._data=t.data,this._options=ht({},t),this._collectResourceTiming=t.collectResourceTiming,t.maxzoom!==void 0&&(this.maxzoom=t.maxzoom),t.type&&(this.type=t.type),t.attribution&&(this.attribution=t.attribution),this.promoteId=t.promoteId;let a=8192/this.tileSize;this.workerOptions=ht({source:this.id,cluster:t.cluster||!1,geojsonVtOptions:{buffer:(t.buffer!==void 0?t.buffer:128)*a,tolerance:(t.tolerance!==void 0?t.tolerance:.375)*a,extent:8192,maxZoom:this.maxzoom,lineMetrics:t.lineMetrics||!1,generateId:t.generateId||!1},superclusterOptions:{maxZoom:t.clusterMaxZoom!==void 0?t.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,t.clusterMinPoints||2),extent:8192,radius:(t.clusterRadius||50)*a,log:!1,generateId:t.generateId||!1},clusterProperties:t.clusterProperties,filter:t.filter},t.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}async load(){await this._updateWorkerData()}onAdd(e){this.map=e,this.load()}setData(e){return this._data=e,this._updateWorkerData(),this}updateData(e){return this._updateWorkerData(e),this}setClusterOptions(e){return this.workerOptions.cluster=e.cluster,e&&(e.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=e.clusterRadius),e.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=e.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(e){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:e,source:this.id}})}getClusterChildren(e){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:e,source:this.id}})}getClusterLeaves(e,t,r){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:e,limit:t,offset:r}})}async _updateWorkerData(e){let t=ht({type:this.type},this.workerOptions);e?t.dataDiff=e:typeof this._data=="string"?(t.request=this.map._requestManager.transformRequest(ai.resolveURL(this._data),"Source"),t.request.collectResourceTiming=this._collectResourceTiming):t.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new qe("dataloading",{dataType:"source"}));try{let r=await this.actor.sendAsync({type:"LD",data:t});if(this._pendingLoads--,this._removed||r.abandoned){this.fire(new qe("dataabort",{dataType:"source"}));return}let n=null;r.resourceTiming&&r.resourceTiming[this.id]&&(n=r.resourceTiming[this.id].slice(0));let a={dataType:"source"};this._collectResourceTiming&&n&&n.length>0&&ht(a,{resourceTiming:n}),this.fire(new qe("data",{...a,sourceDataType:"metadata"})),this.fire(new qe("data",{...a,sourceDataType:"content"}))}catch(r){if(this._pendingLoads--,this._removed){this.fire(new qe("dataabort",{dataType:"source"}));return}this.fire(new Mt(r))}}loaded(){return this._pendingLoads===0}async loadTile(e){let t=e.actor?"RT":"LT";e.actor=this.actor;let r={type:this.type,uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};e.abortController=new AbortController;let n=await this.actor.sendAsync({type:t,data:r},e.abortController);delete e.abortController,e.unloadVectorData(),e.aborted||e.loadVectorData(n,this.map.painter,t==="RT")}async abortTile(e){e.abortController&&(e.abortController.abort(),delete e.abortController),e.aborted=!0}async unloadTile(e){e.unloadVectorData(),await this.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return ht({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}};h(R$,"GeoJSONSource");var Nle=R$;R();R();R();var kx=Xi([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),F$=class extends hn{constructor(e,t,r,n){super(),this.id=e,this.dispatcher=r,this.coordinates=t.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(n),this.options=t}async load(e){this._loaded=!1,this.fire(new qe("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{let t=await Uo.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,t&&t.data&&(this.image=t.data,e&&(this.coordinates=e),this._finishLoading())}catch(t){this._request=null,this._loaded=!0,this.fire(new Mt(t))}}loaded(){return this._loaded}updateImage(e){return e.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=e.url,this.load(e.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new qe("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(e){this.map=e,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(e){this.coordinates=e;let t=e.map(qr.fromLngLat);this.tileID=z$(t),this.minzoom=this.maxzoom=this.tileID.z;let r=t.map(n=>this.tileID.getTilePoint(n)._round());return this._boundsArray=new $R,this._boundsArray.emplaceBack(r[0].x,r[0].y,0,0),this._boundsArray.emplaceBack(r[1].x,r[1].y,8192,0),this._boundsArray.emplaceBack(r[3].x,r[3].y,0,8192),this._boundsArray.emplaceBack(r[2].x,r[2].y,8192,8192),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new qe("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;let e=this.map.painter.context,t=e.gl;this.boundsBuffer||(this.boundsBuffer=e.createVertexBuffer(this._boundsArray,kx.members)),this.boundsSegments||(this.boundsSegments=cr.simpleSegment(0,0,4,2)),this.texture||(this.texture=new Rr(e,this.image,t.RGBA),this.texture.bind(t.LINEAR,t.CLAMP_TO_EDGE));let r=!1;for(let n in this.tiles){let a=this.tiles[n];a.state!=="loaded"&&(a.state="loaded",a.texture=this.texture,r=!0)}r&&this.fire(new qe("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}async loadTile(e){this.tileID&&this.tileID.equals(e.tileID.canonical)?(this.tiles[String(e.tileID.wrap)]=e,e.buckets={}):e.state="errored"}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}};h(F$,"ImageSource");var wm=F$;function z$(i){let e=1/0,t=1/0,r=-1/0,n=-1/0;for(let c of i)e=Math.min(e,c.x),t=Math.min(t,c.y),r=Math.max(r,c.x),n=Math.max(n,c.y);let a=r-e,o=n-t,s=Math.max(a,o),l=Math.max(0,Math.floor(-Math.log(s)/Math.LN2)),u=Math.pow(2,l);return new X5(l,Math.floor((e+r)/2*u),Math.floor((t+n)/2*u))}h(z$,"getCoordinatesCenterTileID");var B$=class extends wm{constructor(e,t,r,n){super(e,t,r,n),this.roundZoom=!0,this.type="video",this.options=t}async load(){this._loaded=!1;let e=this.options;this.urls=[];for(let t of e.urls)this.urls.push(this.map._requestManager.transformRequest(t,"Source").url);try{let t=await jne(this.urls);if(this._loaded=!0,!t)return;this.video=t,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(t){this.fire(new Mt(t))}}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(e){if(this.video){let t=this.video.seekable;e<t.start(0)||e>t.end(0)?this.fire(new Mt(new Je(`sources.${this.id}`,null,`Playback for this video can be set only between the ${t.start(0)} and ${t.end(0)}-second mark.`))):this.video.currentTime=e}}getVideo(){return this.video}onAdd(e){this.map||(this.map=e,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;let e=this.map.painter.context,t=e.gl;this.boundsBuffer||(this.boundsBuffer=e.createVertexBuffer(this._boundsArray,kx.members)),this.boundsSegments||(this.boundsSegments=cr.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(t.LINEAR,t.CLAMP_TO_EDGE),t.texSubImage2D(t.TEXTURE_2D,0,0,0,t.RGBA,t.UNSIGNED_BYTE,this.video)):(this.texture=new Rr(e,this.video,t.RGBA),this.texture.bind(t.LINEAR,t.CLAMP_TO_EDGE));let r=!1;for(let n in this.tiles){let a=this.tiles[n];a.state!=="loaded"&&(a.state="loaded",a.texture=this.texture,r=!0)}r&&this.fire(new qe("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}};h(B$,"VideoSource");var $le=B$;R();var O$=class extends wm{constructor(e,t,r,n){super(e,t,r,n),t.coordinates?(!Array.isArray(t.coordinates)||t.coordinates.length!==4||t.coordinates.some(a=>!Array.isArray(a)||a.length!==2||a.some(o=>typeof o!="number")))&&this.fire(new Mt(new Je(`sources.${e}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new Mt(new Je(`sources.${e}`,null,'missing required property "coordinates"'))),t.animate&&typeof t.animate!="boolean"&&this.fire(new Mt(new Je(`sources.${e}`,null,'optional "animate" property must be a boolean value'))),t.canvas?typeof t.canvas!="string"&&!(t.canvas instanceof HTMLCanvasElement)&&this.fire(new Mt(new Je(`sources.${e}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new Mt(new Je(`sources.${e}`,null,'missing required property "canvas"'))),this.options=t,this.animate=t.animate!==void 0?t.animate:!0}async load(){if(this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()){this.fire(new Mt(new Error("Canvas dimensions cannot be less than or equal to zero.")));return}this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading()}getCanvas(){return this.canvas}onAdd(e){this.map=e,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let e=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,e=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,e=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;let t=this.map.painter.context,r=t.gl;this.boundsBuffer||(this.boundsBuffer=t.createVertexBuffer(this._boundsArray,kx.members)),this.boundsSegments||(this.boundsSegments=cr.simpleSegment(0,0,4,2)),this.texture?(e||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new Rr(t,this.canvas,r.RGBA,{premultiply:!0});let n=!1;for(let a in this.tiles){let o=this.tiles[a];o.state!=="loaded"&&(o.state="loaded",o.texture=this.texture,n=!0)}n&&this.fire(new qe("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(let e of[this.canvas.width,this.canvas.height])if(isNaN(e)||e<=0)return!0;return!1}};h(O$,"CanvasSource");var Ule=O$,N$={},Vle=h((i,e,t,r)=>{let n=$$(e.type),a=new n(i,e,t,r);if(a.id!==i)throw new Error(`Expected Source id to be ${i} instead of ${a.id}`);return a},"create"),$$=h(i=>{switch(i){case"geojson":return Nle;case"image":return wm;case"raster":return E$;case"raster-dem":return Ole;case"vector":return Fle;case"video":return $le;case"canvas":return Ule}return N$[i]},"getSourceType"),jle=h((i,e)=>{N$[i]=e},"setSourceType"),A3e=h(async(i,e)=>{if($$(i))throw new Error(`A source type called "${i}" already exists.`);jle(i,e)},"addSourceType");R();R();function U$(i,e){let t={};if(!e)return t;for(let r of i){let n=r.layerIds.map(a=>e.getLayer(a)).filter(Boolean);if(n.length!==0){r.layers=n,r.stateDependentLayerIds&&(r.stateDependentLayers=r.stateDependentLayerIds.map(a=>n.filter(o=>o.id===a)[0]));for(let a of n)t[a.id]=r}}return t}h(U$,"deserialize");R();R();var V$=class{constructor(e){this._stringToNumber={},this._numberToString=[];for(let t=0;t<e.length;t++){let r=e[t];this._stringToNumber[r]=t,this._numberToString[t]=r}}encode(e){return this._stringToNumber[e]}decode(e){if(e>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${e} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[e]}};h(V$,"DictionaryCoder");var Hle=V$,Gle=It(Qv(),1),Wle=It(Q7(),1);R();var j$=class{constructor(e,t,r,n,a){this.type="Feature",this._vectorTileFeature=e,e._z=t,e._x=r,e._y=n,this.properties=e.properties,this.id=a}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(e){this._geometry=e}toJSON(){let e={geometry:this.geometry};for(let t in this)t==="_geometry"||t==="_vectorTileFeature"||(e[t]=this[t]);return e}};h(j$,"GeoJSONFeature");var H$=j$,G$=class{constructor(e,t){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new xw(8192,16,0),this.grid3D=new xw(8192,16,0),this.featureIndexArray=new zR,this.promoteId=t}insert(e,t,r,n,a,o){let s=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(r,n,a);let l=o?this.grid3D:this.grid;for(let u=0;u<t.length;u++){let c=t[u],p=[1/0,1/0,-1/0,-1/0];for(let d=0;d<c.length;d++){let m=c[d];p[0]=Math.min(p[0],m.x),p[1]=Math.min(p[1],m.y),p[2]=Math.max(p[2],m.x),p[3]=Math.max(p[3],m.y)}p[0]<8192&&p[1]<8192&&p[2]>=0&&p[3]>=0&&l.insert(s,p[0],p[1],p[2],p[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new Gle.default.VectorTile(new Wle.default(this.rawTileData)).layers,this.sourceLayerCoder=new Hle(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(e,t,r,n){this.loadVTLayers();let a=e.params||{},o=8192/e.tileSize/e.scale,s=nv(a.filter),l=e.queryGeometry,u=e.queryPadding*o,c=Hw(l),p=this.grid.query(c.minX-u,c.minY-u,c.maxX+u,c.maxY+u),d=Hw(e.cameraQueryGeometry),m=this.grid3D.query(d.minX-u,d.minY-u,d.maxX+u,d.maxY+u,(x,v,w,_)=>LF(e.cameraQueryGeometry,x-u,v-u,w+u,_+u));for(let x of m)p.push(x);p.sort(W$);let g={},b;for(let x=0;x<p.length;x++){let v=p[x];if(v===b)continue;b=v;let w=this.featureIndexArray.get(v),_=null;this.loadMatchingFeature(g,w.bucketIndex,w.sourceLayerIndex,w.featureIndex,s,a.layers,a.availableImages,t,r,n,(C,E,T)=>(_||(_=jl(C)),E.queryIntersectsFeature(l,C,T,_,this.z,e.transform,o,e.pixelPosMatrix)))}return g}loadMatchingFeature(e,t,r,n,a,o,s,l,u,c,p){let d=this.bucketLayerIDs[t];if(o&&!oL(o,d))return;let m=this.sourceLayerCoder.decode(r),g=this.vtLayers[m].feature(n);if(a.needGeometry){let x=Hl(g,!0);if(!a.filter(new Pr(this.tileID.overscaledZ),x,this.tileID.canonical))return}else if(!a.filter(new Pr(this.tileID.overscaledZ),g))return;let b=this.getId(g,m);for(let x=0;x<d.length;x++){let v=d[x];if(o&&o.indexOf(v)<0)continue;let w=l[v];if(!w)continue;let _={};b&&c&&(_=c.getState(w.sourceLayer||"_geojsonTileLayer",b));let C=ht({},u[v]);C.paint=jw(C.paint,w.paint,g,_,s),C.layout=jw(C.layout,w.layout,g,_,s);let E=!p||p(g,w,_);if(!E)continue;let T=new H$(g,this.z,this.x,this.y,b);T.layer=C;let L=e[v];L===void 0&&(L=e[v]=[]),L.push({featureIndex:n,feature:T,intersectionZ:E})}}lookupSymbolFeatures(e,t,r,n,a,o,s,l){let u={};this.loadVTLayers();let c=nv(a);for(let p of e)this.loadMatchingFeature(u,r,n,p,c,o,s,l,t);return u}hasLayer(e){for(let t of this.bucketLayerIDs)for(let r of t)if(e===r)return!0;return!1}getId(e,t){let r=e.id;if(this.promoteId){let n=typeof this.promoteId=="string"?this.promoteId:this.promoteId[t];r=e.properties[n],typeof r=="boolean"&&(r=Number(r))}return r}};h(G$,"FeatureIndex");var Xle=G$;st("FeatureIndex",Xle,{omit:["rawTileData","sourceLayerCoder"]});function jw(i,e,t,r,n){return tx(i,(a,o)=>{let s=e instanceof _x?e.get(o):null;return s&&s.evaluate?s.evaluate(t,r,n):s})}h(jw,"evaluateProperties");function Hw(i){let e=1/0,t=1/0,r=-1/0,n=-1/0;for(let a of i)e=Math.min(e,a.x),t=Math.min(t,a.y),r=Math.max(r,a.x),n=Math.max(n,a.y);return{minX:e,minY:t,maxX:r,maxY:n}}h(Hw,"getBounds");function W$(i,e){return e-i}h(W$,"topDownFeatureComparator");R();R();var Gw="RTLPluginLoaded",X$=class extends hn{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=V5()}_syncState(e){return this.status=e,this.dispatcher.broadcast("SRPS",{pluginStatus:e,pluginURL:this.url}).catch(t=>{throw this.status="error",t})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}async setRTLTextPlugin(e,t=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=ai.resolveURL(e),!this.url)throw new Error(`requested url ${e} is invalid`);if(this.status==="unavailable")if(t)this.status="deferred",this._syncState(this.status);else return this._requestImport();else if(this.status==="requested")return this._requestImport()}async _requestImport(){await this._syncState("loading"),this.status="loaded",this.fire(new qe(Gw))}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}};h(X$,"RTLMainThreadPlugin");var qle=X$,j_=null;function Bp(){return j_||(j_=new qle),j_}h(Bp,"rtlMainThreadPluginFactory");var Zle=3e4,q$=class{constructor(e,t){this.timeAdded=0,this.fadeEndTime=0,this.tileID=e,this.uid=LC(),this.uses=0,this.tileSize=t,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(e){let t=e+this.timeAdded;t<this.fadeEndTime||(this.fadeEndTime=t)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(e){this.demTexture&&e.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(e,t,r){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",!e){this.collisionBoxArray=new gR;return}e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=U$(e.buckets,t.style),this.hasSymbolBuckets=!1;for(let n in this.buckets){let a=this.buckets[n];if(a instanceof zp)if(this.hasSymbolBuckets=!0,r)a.justReloaded=!0;else break}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(let n in this.buckets){let a=this.buckets[n];if(a instanceof zp&&a.hasRTLText){this.hasRTLText=!0,Bp().lazyLoad();break}}this.queryPadding=0;for(let n in this.buckets){let a=this.buckets[n];this.queryPadding=Math.max(this.queryPadding,t.style.getLayer(n).queryRadius(a))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}unloadVectorData(){for(let e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(e){return this.buckets[e.id]}upload(e){for(let r in this.buckets){let n=this.buckets[r];n.uploadPending()&&n.upload(e)}let t=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Rr(e,this.imageAtlas.image,t.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Rr(e,this.glyphAtlasImage,t.ALPHA),this.glyphAtlasImage=null)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,t,r,n,a,o,s,l,u,c){return!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData?{}:this.latestFeatureIndex.query({queryGeometry:n,cameraQueryGeometry:a,scale:o,tileSize:this.tileSize,pixelPosMatrix:c,transform:l,params:s,queryPadding:this.queryPadding*u},e,t,r)}querySourceFeatures(e,t){let r=this.latestFeatureIndex;if(!r||!r.rawTileData)return;let n=r.loadVTLayers(),a=t&&t.sourceLayer?t.sourceLayer:"",o=n._geojsonTileLayer||n[a];if(!o)return;let s=nv(t&&t.filter),{z:l,x:u,y:c}=this.tileID.canonical,p={z:l,x:u,y:c};for(let d=0;d<o.length;d++){let m=o.feature(d);if(s.needGeometry){let x=Hl(m,!0);if(!s.filter(new Pr(this.tileID.overscaledZ),x,this.tileID.canonical))continue}else if(!s.filter(new Pr(this.tileID.overscaledZ),m))continue;let g=r.getId(m,a),b=new H$(m,l,u,c,g);b.tile=p,e.push(b)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){let t=this.expirationTime;if(e.cacheControl){let r=hL(e.cacheControl);r["max-age"]&&(this.expirationTime=Date.now()+r["max-age"]*1e3)}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){let r=Date.now(),n=!1;if(this.expirationTime>r)n=!1;else if(!t)n=!0;else if(this.expirationTime<t)n=!0;else{let a=this.expirationTime-t;a?this.expirationTime=r+Math.max(a,Zle):n=!0}n?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(e,t){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(e).length===0)return;let r=this.latestFeatureIndex.loadVTLayers();for(let n in this.buckets){if(!t.style.hasLayer(n))continue;let a=this.buckets[n],o=a.layers[0].sourceLayer||"_geojsonTileLayer",s=r[o],l=e[o];if(!s||!l||Object.keys(l).length===0)continue;a.update(l,s,this.imageAtlas&&this.imageAtlas.patternPositions||{});let u=t&&t.style&&t.style.getLayer(n);u&&(this.queryPadding=Math.max(this.queryPadding,u.queryRadius(a)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<ai.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=ai.now()+e}setDependencies(e,t){let r={};for(let n of t)r[n]=!0;this.dependencies[e]=r}hasDependency(e,t){for(let r of e){let n=this.dependencies[r];if(n){for(let a of t)if(n[a])return!0}}return!1}};h(q$,"Tile");var Z$=q$;R();var Y$=class{constructor(e,t){this.max=e,this.onRemove=t,this.reset()}reset(){for(let e in this.data)for(let t of this.data[e])t.timeout&&clearTimeout(t.timeout),this.onRemove(t.value);return this.data={},this.order=[],this}add(e,t,r){let n=e.wrapped().key;this.data[n]===void 0&&(this.data[n]=[]);let a={value:t,timeout:void 0};if(r!==void 0&&(a.timeout=setTimeout(()=>{this.remove(e,a)},r)),this.data[n].push(a),this.order.push(n),this.order.length>this.max){let o=this._getAndRemoveByKey(this.order[0]);o&&this.onRemove(o)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){let t=this.data[e].shift();return t.timeout&&clearTimeout(t.timeout),this.data[e].length===0&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),t.value}getByKey(e){let t=this.data[e];return t?t[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,t){if(!this.has(e))return this;let r=e.wrapped().key,n=t===void 0?0:this.data[r].indexOf(t),a=this.data[r][n];return this.data[r].splice(n,1),a.timeout&&clearTimeout(a.timeout),this.data[r].length===0&&delete this.data[r],this.onRemove(a.value),this.order.splice(this.order.indexOf(r),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){let t=this._getAndRemoveByKey(this.order[0]);t&&this.onRemove(t)}return this}filter(e){let t=[];for(let r in this.data)for(let n of this.data[r])e(n.value)||t.push(n);for(let r of t)this.remove(r.value.tileID,r)}};h(Y$,"TileCache");var Yle=Y$,iA=It(di(),1);R();var J$=class{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,t,r){let n=String(t);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][n]=this.stateChanges[e][n]||{},ht(this.stateChanges[e][n],r),this.deletedStates[e]===null){this.deletedStates[e]={};for(let a in this.state[e])a!==n&&(this.deletedStates[e][a]=null)}else if(this.deletedStates[e]&&this.deletedStates[e][n]===null){this.deletedStates[e][n]={};for(let a in this.state[e][n])r[a]||(this.deletedStates[e][n][a]=null)}else for(let a in r)this.deletedStates[e]&&this.deletedStates[e][n]&&this.deletedStates[e][n][a]===null&&delete this.deletedStates[e][n][a]}removeFeatureState(e,t,r){if(this.deletedStates[e]===null)return;let n=String(t);if(this.deletedStates[e]=this.deletedStates[e]||{},r&&t!==void 0)this.deletedStates[e][n]!==null&&(this.deletedStates[e][n]=this.deletedStates[e][n]||{},this.deletedStates[e][n][r]=null);else if(t!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][n]){this.deletedStates[e][n]={};for(r in this.stateChanges[e][n])this.deletedStates[e][n][r]=null}else this.deletedStates[e][n]=null;else this.deletedStates[e]=null}getState(e,t){let r=String(t),n=this.state[e]||{},a=this.stateChanges[e]||{},o=ht({},n[r],a[r]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){let s=this.deletedStates[e][t];if(s===null)return{};for(let l in s)delete o[l]}return o}initializeTileState(e,t){e.setFeatureState(this.state,t)}coalesceChanges(e,t){let r={};for(let n in this.stateChanges){this.state[n]=this.state[n]||{};let a={};for(let o in this.stateChanges[n])this.state[n][o]||(this.state[n][o]={}),ht(this.state[n][o],this.stateChanges[n][o]),a[o]=this.state[n][o];r[n]=a}for(let n in this.deletedStates){this.state[n]=this.state[n]||{};let a={};if(this.deletedStates[n]===null)for(let o in this.state[n])a[o]={},this.state[n][o]={};else for(let o in this.deletedStates[n]){if(this.deletedStates[n][o]===null)this.state[n][o]={};else for(let s of Object.keys(this.deletedStates[n][o]))delete this.state[n][o][s];a[o]=this.state[n][o]}r[n]=r[n]||{},ht(r[n],a)}if(this.stateChanges={},this.deletedStates={},Object.keys(r).length!==0)for(let n in e)e[n].setFeatureState(r,t)}};h(J$,"SourceFeatureState");var Jle=J$,K$=class Kd extends hn{constructor(e,t,r){super(),this.id=e,this.dispatcher=r,this.on("data",n=>this._dataHandler(n)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=Vle(e,t,r,this),this._tiles={},this._cache=new Yle(0,n=>this._unloadTile(n)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new Jle,this._didEmitContent=!1,this._updated=!1}onAdd(e){this.map=e,this._maxTileCacheSize=e?e._maxTileCacheSize:null,this._maxTileCacheZoomLevels=e?e._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(e)}onRemove(e){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(e)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if((this.used!==void 0||this.usedForTerrain!==void 0)&&!this.used&&!this.usedForTerrain)return!0;if(!this._updated)return!1;for(let e in this._tiles){let t=this._tiles[e];if(t.state!=="loaded"&&t.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;let e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}async _loadTile(e,t,r){try{await this._source.loadTile(e),this._tileLoaded(e,t,r)}catch(n){e.state="errored",n.status!==404?this._source.fire(new Mt(n,{tile:e})):this.update(this.transform,this.terrain)}}_unloadTile(e){this._source.unloadTile&&this._source.unloadTile(e)}_abortTile(e){this._source.abortTile&&this._source.abortTile(e),this._source.fire(new qe("dataabort",{tile:e,coord:e.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(let t in this._tiles){let r=this._tiles[t];r.upload(e),r.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(e=>e.tileID).sort(Ww).map(e=>e.key)}getRenderableIds(e){let t=[];for(let r in this._tiles)this._isIdRenderable(r,e)&&t.push(this._tiles[r]);return e?t.sort((r,n)=>{let a=r.tileID,o=n.tileID,s=new iA.default(a.canonical.x,a.canonical.y)._rotate(this.transform.angle),l=new iA.default(o.canonical.x,o.canonical.y)._rotate(this.transform.angle);return a.overscaledZ-o.overscaledZ||l.y-s.y||l.x-s.x}).map(r=>r.tileID.key):t.map(r=>r.tileID).sort(Ww).map(r=>r.key)}hasRenderableParent(e){let t=this.findLoadedParent(e,0);return t?this._isIdRenderable(t.tileID.key):!1}_isIdRenderable(e,t){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(t||!this._tiles[e].holdingForFade())}reload(){if(this._paused){this._shouldReloadOnResume=!0;return}this._cache.reset();for(let e in this._tiles)this._tiles[e].state!=="errored"&&this._reloadTile(e,"reloading")}async _reloadTile(e,t){let r=this._tiles[e];r&&(r.state!=="loading"&&(r.state=t),await this._loadTile(r,e,t))}_tileLoaded(e,t,r){e.timeAdded=ai.now(),r==="expired"&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(t,e),this.getSource().type==="raster-dem"&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),e.aborted||this._source.fire(new qe("data",{dataType:"source",tile:e,coord:e.tileID}))}_backfillDEM(e){let t=this.getRenderableIds();for(let n=0;n<t.length;n++){let a=t[n];if(e.neighboringTiles&&e.neighboringTiles[a]){let o=this.getTileByID(a);r(e,o),r(o,e)}}function r(n,a){n.needsHillshadePrepare=!0,n.needsTerrainPrepare=!0;let o=a.tileID.canonical.x-n.tileID.canonical.x,s=a.tileID.canonical.y-n.tileID.canonical.y,l=Math.pow(2,n.tileID.canonical.z),u=a.tileID.key;o===0&&s===0||Math.abs(s)>1||(Math.abs(o)>1&&(Math.abs(o+l)===1?o+=l:Math.abs(o-l)===1&&(o-=l)),!(!a.dem||!n.dem)&&(n.dem.backfillBorder(a.dem,o,s),n.neighboringTiles&&n.neighboringTiles[u]&&(n.neighboringTiles[u].backfilled=!0)))}h(r,"fillBorder")}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,t,r,n){for(let a in this._tiles){let o=this._tiles[a];if(n[a]||!o.hasData()||o.tileID.overscaledZ<=t||o.tileID.overscaledZ>r)continue;let s=o.tileID;for(;o&&o.tileID.overscaledZ>t+1;){let u=o.tileID.scaledTo(o.tileID.overscaledZ-1);o=this._tiles[u.key],o&&o.hasData()&&(s=u)}let l=s;for(;l.overscaledZ>t;)if(l=l.scaledTo(l.overscaledZ-1),e[l.key]){n[s.key]=s;break}}}findLoadedParent(e,t){if(e.key in this._loadedParentTiles){let r=this._loadedParentTiles[e.key];return r&&r.tileID.overscaledZ>=t?r:null}for(let r=e.overscaledZ-1;r>=t;r--){let n=e.scaledTo(r),a=this._getLoadedTile(n);if(a)return a}}_getLoadedTile(e){let t=this._tiles[e.key];return t&&t.hasData()?t:this._cache.getByKey(e.wrapped().key)}updateCacheSize(e){let t=Math.ceil(e.width/this._source.tileSize)+1,r=Math.ceil(e.height/this._source.tileSize)+1,n=t*r,a=this._maxTileCacheZoomLevels===null?vo.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels,o=Math.floor(n*a),s=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,o):o;this._cache.setMaxSize(s)}handleWrapJump(e){let t=this._prevLng===void 0?e:this._prevLng,r=(e-t)/360,n=Math.round(r);if(this._prevLng=e,n){let a={};for(let o in this._tiles){let s=this._tiles[o];s.tileID=s.tileID.unwrapTo(s.tileID.wrap+n),a[s.tileID.key]=s}this._tiles=a;for(let o in this._timers)clearTimeout(this._timers[o]),delete this._timers[o];for(let o in this._tiles){let s=this._tiles[o];this._setTileReloadTimer(o,s)}}}update(e,t){if(!this._sourceLoaded||this._paused)return;this.transform=e,this.terrain=t,this.updateCacheSize(e),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={};let r;!this.used&&!this.usedForTerrain?r=[]:this._source.tileID?r=e.getVisibleUnwrappedCoordinates(this._source.tileID).map(c=>new ra(c.canonical.z,c.wrap,c.canonical.z,c.canonical.x,c.canonical.y)):(r=e.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this.usedForTerrain?!1:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:t}),this._source.hasTile&&(r=r.filter(c=>this._source.hasTile(c))));let n=e.coveringZoomLevel(this._source),a=Math.max(n-Kd.maxOverzooming,this._source.minzoom),o=Math.max(n+Kd.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){let c={};for(let p of r)if(p.canonical.z>this._source.minzoom){let d=p.scaledTo(p.canonical.z-1);c[d.key]=d;let m=p.scaledTo(Math.max(this._source.minzoom,Math.min(p.canonical.z,5)));c[m.key]=m}r=r.concat(Object.values(c))}let s=r.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,s&&this.fire(new qe("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));let l=this._updateRetainedTiles(r,n);if(Xw(this._source.type)){let c={},p={},d=Object.keys(l),m=ai.now();for(let g of d){let b=l[g],x=this._tiles[g];if(!x||x.fadeEndTime!==0&&x.fadeEndTime<=m)continue;let v=this.findLoadedParent(b,a);v&&(this._addTile(v.tileID),c[v.tileID.key]=v.tileID),p[g]=b}this._retainLoadedChildren(p,n,o,l);for(let g in c)l[g]||(this._coveredTiles[g]=!0,l[g]=c[g]);if(t){let g={},b={};for(let x of r)this._tiles[x.key].hasData()?g[x.key]=x:b[x.key]=x;for(let x in b){let v=b[x].children(this._source.maxzoom);this._tiles[v[0].key]&&this._tiles[v[1].key]&&this._tiles[v[2].key]&&this._tiles[v[3].key]&&(g[v[0].key]=l[v[0].key]=v[0],g[v[1].key]=l[v[1].key]=v[1],g[v[2].key]=l[v[2].key]=v[2],g[v[3].key]=l[v[3].key]=v[3],delete b[x])}for(let x in b){let v=this.findLoadedParent(b[x],this._source.minzoom);if(v){g[v.tileID.key]=l[v.tileID.key]=v.tileID;for(let w in g)g[w].isChildOf(v.tileID)&&delete g[w]}}for(let x in this._tiles)g[x]||(this._coveredTiles[x]=!0)}}for(let c in l)this._tiles[c].clearFadeHold();let u=rL(this._tiles,l);for(let c of u){let p=this._tiles[c];p.hasSymbolBuckets&&!p.holdingForFade()?p.setHoldDuration(this.map._fadeDuration):(!p.hasSymbolBuckets||p.symbolFadeFinished())&&this._removeTile(c)}this._updateLoadedParentTileCache()}releaseSymbolFadeTiles(){for(let e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(e)}_updateRetainedTiles(e,t){let r={},n={},a=Math.max(t-Kd.maxOverzooming,this._source.minzoom),o=Math.max(t+Kd.maxUnderzooming,this._source.minzoom),s={};for(let l of e){let u=this._addTile(l);r[l.key]=l,!u.hasData()&&t<this._source.maxzoom&&(s[l.key]=l)}this._retainLoadedChildren(s,t,o,r);for(let l of e){let u=this._tiles[l.key];if(u.hasData())continue;if(t+1>this._source.maxzoom){let p=l.children(this._source.maxzoom)[0],d=this.getTile(p);if(d&&d.hasData()){r[p.key]=p;continue}}else{let p=l.children(this._source.maxzoom);if(r[p[0].key]&&r[p[1].key]&&r[p[2].key]&&r[p[3].key])continue}let c=u.wasRequested();for(let p=l.overscaledZ-1;p>=a;--p){let d=l.scaledTo(p);if(n[d.key])break;if(n[d.key]=!0,u=this.getTile(d),!u&&c&&(u=this._addTile(d)),u){let m=u.hasData();if((c||m)&&(r[d.key]=d),c=u.wasRequested(),m)break}}}return r}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(let e in this._tiles){let t=[],r,n=this._tiles[e].tileID;for(;n.overscaledZ>0;){if(n.key in this._loadedParentTiles){r=this._loadedParentTiles[n.key];break}t.push(n.key);let a=n.scaledTo(n.overscaledZ-1);if(r=this._getLoadedTile(a),r)break;n=a}for(let a of t)this._loadedParentTiles[a]=r}}_addTile(e){let t=this._tiles[e.key];if(t)return t;t=this._cache.getAndRemove(e),t&&(this._setTileReloadTimer(e.key,t),t.tileID=e,this._state.initializeTileState(t,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,t)));let r=t;return t||(t=new Z$(e,this._source.tileSize*e.overscaleFactor()),this._loadTile(t,e.key,t.state)),t.uses++,this._tiles[e.key]=t,r||this._source.fire(new qe("dataloading",{tile:t,coord:t.tileID,dataType:"source"})),t}_setTileReloadTimer(e,t){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);let r=t.getExpiryTimeout();r&&(this._timers[e]=setTimeout(()=>{this._reloadTile(e,"expired"),delete this._timers[e]},r))}_removeTile(e){let t=this._tiles[e];t&&(t.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),!(t.uses>0)&&(t.hasData()&&t.state!=="reloading"?this._cache.add(t.tileID,t,t.getExpiryTimeout()):(t.aborted=!0,this._abortTile(t),this._unloadTile(t))))}_dataHandler(e){let t=e.sourceDataType;e.dataType==="source"&&t==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&e.dataType==="source"&&t==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(let e in this._tiles)this._removeTile(e);this._cache.reset()}tilesIn(e,t,r){let n=[],a=this.transform;if(!a)return n;let o=r?a.getCameraQueryGeometry(e):e,s=e.map(g=>a.pointCoordinate(g,this.terrain)),l=o.map(g=>a.pointCoordinate(g,this.terrain)),u=this.getIds(),c=1/0,p=1/0,d=-1/0,m=-1/0;for(let g of l)c=Math.min(c,g.x),p=Math.min(p,g.y),d=Math.max(d,g.x),m=Math.max(m,g.y);for(let g=0;g<u.length;g++){let b=this._tiles[u[g]];if(b.holdingForFade())continue;let x=b.tileID,v=Math.pow(2,a.zoom-b.tileID.overscaledZ),w=t*b.queryPadding*8192/b.tileSize/v,_=[x.getTilePoint(new qr(c,p)),x.getTilePoint(new qr(d,m))];if(_[0].x-w<8192&&_[0].y-w<8192&&_[1].x+w>=0&&_[1].y+w>=0){let C=s.map(T=>x.getTilePoint(T)),E=l.map(T=>x.getTilePoint(T));n.push({tile:b,tileID:x,queryGeometry:C,cameraQueryGeometry:E,scale:v})}}return n}getVisibleCoordinates(e){let t=this.getRenderableIds(e).map(r=>this._tiles[r].tileID);for(let r of t)r.posMatrix=this.transform.calculatePosMatrix(r.toUnwrapped());return t}hasTransition(){if(this._source.hasTransition())return!0;if(Xw(this._source.type)){let e=ai.now();for(let t in this._tiles)if(this._tiles[t].fadeEndTime>=e)return!0}return!1}setFeatureState(e,t,r){e=e||"_geojsonTileLayer",this._state.updateState(e,t,r)}removeFeatureState(e,t,r){e=e||"_geojsonTileLayer",this._state.removeFeatureState(e,t,r)}getFeatureState(e,t){return e=e||"_geojsonTileLayer",this._state.getState(e,t)}setDependencies(e,t,r){let n=this._tiles[e];n&&n.setDependencies(t,r)}reloadTilesForDependencies(e,t){for(let r in this._tiles)this._tiles[r].hasDependency(e,t)&&this._reloadTile(r,"reloading");this._cache.filter(r=>!r.hasDependency(e,t))}};h(K$,"SourceCache");var Sm=K$;Sm.maxOverzooming=10;Sm.maxUnderzooming=3;function Ww(i,e){let t=Math.abs(i.wrap*2)-+(i.wrap<0),r=Math.abs(e.wrap*2)-+(e.wrap<0);return i.overscaledZ-e.overscaledZ||r-t||e.canonical.y-i.canonical.y||e.canonical.x-i.canonical.x}h(Ww,"compareTileId");function Xw(i){return i==="raster"||i==="image"||i==="video"}h(Xw,"isRasterType");R();R();R();var Ko=It(di(),1);R();var $s=It(di(),1);function Q$(i,e,t,r,n){let a=[];for(let o=0;o<i.length;o++){let s=i[o],l;for(let u=0;u<s.length-1;u++){let c=s[u],p=s[u+1];c.x<e&&p.x<e||(c.x<e?c=new $s.default(e,c.y+(p.y-c.y)*((e-c.x)/(p.x-c.x)))._round():p.x<e&&(p=new $s.default(e,c.y+(p.y-c.y)*((e-c.x)/(p.x-c.x)))._round()),!(c.y<t&&p.y<t)&&(c.y<t?c=new $s.default(c.x+(p.x-c.x)*((t-c.y)/(p.y-c.y)),t)._round():p.y<t&&(p=new $s.default(c.x+(p.x-c.x)*((t-c.y)/(p.y-c.y)),t)._round()),!(c.x>=r&&p.x>=r)&&(c.x>=r?c=new $s.default(r,c.y+(p.y-c.y)*((r-c.x)/(p.x-c.x)))._round():p.x>=r&&(p=new $s.default(r,c.y+(p.y-c.y)*((r-c.x)/(p.x-c.x)))._round()),!(c.y>=n&&p.y>=n)&&(c.y>=n?c=new $s.default(c.x+(p.x-c.x)*((n-c.y)/(p.y-c.y)),n)._round():p.y>=n&&(p=new $s.default(c.x+(p.x-c.x)*((n-c.y)/(p.y-c.y)),n)._round()),(!l||!c.equals(l[l.length-1]))&&(l=[c],a.push(l)),l.push(p)))))}}return a}h(Q$,"clipLine");R();var eU=class{constructor(e,t){this.reset(e,t)}reset(e,t){this.points=e||[],this._distances=[0];for(let r=1;r<this.points.length;r++)this._distances[r]=this._distances[r-1]+this.points[r].dist(this.points[r-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(t||0,this.length*.5),this.paddedLength=this.length-this.padding*2}lerp(e){if(this.points.length===1)return this.points[0];e=Tr(e,0,1);let t=1,r=this._distances[t],n=e*this.paddedLength+this.padding;for(;r<n&&t<this._distances.length;)r=this._distances[++t];let a=t-1,o=this._distances[a],s=r-o,l=s>0?(n-o)/s:0;return this.points[a].mult(1-l).add(this.points[t].mult(l))}};h(eU,"PathInterpolator");var Kle=eU;R();function Qd(i,e){let t=!0;return i==="always"||(i==="never"||e==="never")&&(t=!1),t}h(Qd,"overlapAllowed");var tU=class{constructor(e,t,r){let n=this.boxCells=[],a=this.circleCells=[];this.xCellCount=Math.ceil(e/r),this.yCellCount=Math.ceil(t/r);for(let o=0;o<this.xCellCount*this.yCellCount;o++)n.push([]),a.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=e,this.height=t,this.xScale=this.xCellCount/e,this.yScale=this.yCellCount/t,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(e,t,r,n,a){this._forEachCell(t,r,n,a,this._insertBoxCell,this.boxUid++),this.boxKeys.push(e),this.bboxes.push(t),this.bboxes.push(r),this.bboxes.push(n),this.bboxes.push(a)}insertCircle(e,t,r,n){this._forEachCell(t-n,r-n,t+n,r+n,this._insertCircleCell,this.circleUid++),this.circleKeys.push(e),this.circles.push(t),this.circles.push(r),this.circles.push(n)}_insertBoxCell(e,t,r,n,a,o){this.boxCells[a].push(o)}_insertCircleCell(e,t,r,n,a,o){this.circleCells[a].push(o)}_query(e,t,r,n,a,o,s){if(r<0||e>this.width||n<0||t>this.height)return[];let l=[];if(e<=0&&t<=0&&this.width<=r&&this.height<=n){if(a)return[{key:null,x1:e,y1:t,x2:r,y2:n}];for(let u=0;u<this.boxKeys.length;u++)l.push({key:this.boxKeys[u],x1:this.bboxes[u*4],y1:this.bboxes[u*4+1],x2:this.bboxes[u*4+2],y2:this.bboxes[u*4+3]});for(let u=0;u<this.circleKeys.length;u++){let c=this.circles[u*3],p=this.circles[u*3+1],d=this.circles[u*3+2];l.push({key:this.circleKeys[u],x1:c-d,y1:p-d,x2:c+d,y2:p+d})}}else{let u={hitTest:a,overlapMode:o,seenUids:{box:{},circle:{}}};this._forEachCell(e,t,r,n,this._queryCell,l,u,s)}return l}query(e,t,r,n){return this._query(e,t,r,n,!1,null)}hitTest(e,t,r,n,a,o){return this._query(e,t,r,n,!0,a,o).length>0}hitTestCircle(e,t,r,n,a){let o=e-r,s=e+r,l=t-r,u=t+r;if(s<0||o>this.width||u<0||l>this.height)return!1;let c=[],p={hitTest:!0,overlapMode:n,circle:{x:e,y:t,radius:r},seenUids:{box:{},circle:{}}};return this._forEachCell(o,l,s,u,this._queryCellCircle,c,p,a),c.length>0}_queryCell(e,t,r,n,a,o,s,l){let{seenUids:u,hitTest:c,overlapMode:p}=s,d=this.boxCells[a];if(d!==null){let g=this.bboxes;for(let b of d)if(!u.box[b]){u.box[b]=!0;let x=b*4,v=this.boxKeys[b];if(e<=g[x+2]&&t<=g[x+3]&&r>=g[x+0]&&n>=g[x+1]&&(!l||l(v))&&(!c||!Qd(p,v.overlapMode))&&(o.push({key:v,x1:g[x],y1:g[x+1],x2:g[x+2],y2:g[x+3]}),c))return!0}}let m=this.circleCells[a];if(m!==null){let g=this.circles;for(let b of m)if(!u.circle[b]){u.circle[b]=!0;let x=b*3,v=this.circleKeys[b];if(this._circleAndRectCollide(g[x],g[x+1],g[x+2],e,t,r,n)&&(!l||l(v))&&(!c||!Qd(p,v.overlapMode))){let w=g[x],_=g[x+1],C=g[x+2];if(o.push({key:v,x1:w-C,y1:_-C,x2:w+C,y2:_+C}),c)return!0}}}return!1}_queryCellCircle(e,t,r,n,a,o,s,l){let{circle:u,seenUids:c,overlapMode:p}=s,d=this.boxCells[a];if(d!==null){let g=this.bboxes;for(let b of d)if(!c.box[b]){c.box[b]=!0;let x=b*4,v=this.boxKeys[b];if(this._circleAndRectCollide(u.x,u.y,u.radius,g[x+0],g[x+1],g[x+2],g[x+3])&&(!l||l(v))&&!Qd(p,v.overlapMode))return o.push(!0),!0}}let m=this.circleCells[a];if(m!==null){let g=this.circles;for(let b of m)if(!c.circle[b]){c.circle[b]=!0;let x=b*3,v=this.circleKeys[b];if(this._circlesCollide(g[x],g[x+1],g[x+2],u.x,u.y,u.radius)&&(!l||l(v))&&!Qd(p,v.overlapMode))return o.push(!0),!0}}}_forEachCell(e,t,r,n,a,o,s,l){let u=this._convertToXCellCoord(e),c=this._convertToYCellCoord(t),p=this._convertToXCellCoord(r),d=this._convertToYCellCoord(n);for(let m=u;m<=p;m++)for(let g=c;g<=d;g++){let b=this.xCellCount*g+m;if(a.call(this,e,t,r,n,b,o,s,l))return}}_convertToXCellCoord(e){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(e*this.xScale)))}_convertToYCellCoord(e){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(e*this.yScale)))}_circlesCollide(e,t,r,n,a,o){let s=n-e,l=a-t,u=r+o;return u*u>s*s+l*l}_circleAndRectCollide(e,t,r,n,a,o,s){let l=(o-n)/2,u=Math.abs(e-(n+l));if(u>l+r)return!1;let c=(s-a)/2,p=Math.abs(t-(a+c));if(p>c+r)return!1;if(u<=l||p<=c)return!0;let d=u-l,m=p-c;return d*d+m*m<=r*r}};h(tU,"GridIndex");var rA=tU;R();var Mm=It(di(),1);function Rx(i,e,t,r,n){let a=lt.create();return e?(lt.scale(a,a,[1/n,1/n,1]),t||lt.rotateZ(a,a,r.angle)):lt.multiply(a,r.labelPlaneMatrix,i),a}h(Rx,"getLabelPlaneMatrix");function q5(i,e,t,r,n){if(e){let a=lt.clone(i);return lt.scale(a,a,[n,n,1]),t||lt.rotateZ(a,a,-r.angle),a}else return r.glCoordMatrix}h(q5,"getGlCoordMatrix");function la(i,e,t){let r;t?(r=[i.x,i.y,t(i.x,i.y),1],wn.transformMat4(r,r,e)):(r=[i.x,i.y,0,1],zx(r,r,e));let n=r[3];return{point:new Mm.default(r[0]/n,r[1]/n),signedDistanceFromCamera:n}}h(la,"project");function Fx(i,e){return .5+.5*(i/e)}h(Fx,"getPerspectiveRatio");function iU(i,e){let t=i[0]/i[3],r=i[1]/i[3];return t>=-e[0]&&t<=e[0]&&r>=-e[1]&&r<=e[1]}h(iU,"isVisible");function rU(i,e,t,r,n,a,o,s,l,u){let c=r?i.textSizeData:i.iconSizeData,p=Km(c,t.transform.zoom),d=[256/t.width*2+1,256/t.height*2+1],m=r?i.text.dynamicLayoutVertexArray:i.icon.dynamicLayoutVertexArray;m.clear();let g=i.lineVertexArray,b=r?i.text.placedSymbolArray:i.icon.placedSymbolArray,x=t.transform.width/t.transform.height,v=!1;for(let w=0;w<b.length;w++){let _=b.get(w);if(_.hidden||_.writingMode===2&&!v){Fu(_.numGlyphs,m);continue}v=!1;let C;if(u?(C=[_.anchorX,_.anchorY,u(_.anchorX,_.anchorY),1],wn.transformMat4(C,C,e)):(C=[_.anchorX,_.anchorY,0,1],zx(C,C,e)),!iU(C,d)){Fu(_.numGlyphs,m);continue}let E=C[3],T=Fx(t.transform.cameraToCenterDistance,E),L=Ix(c,p,_),D=o?L/T:L*T,B=new Mm.default(_.anchorX,_.anchorY),A=la(B,n,u).point,k={projections:{},offsets:{}},$=Zw(_,D,!1,s,e,n,a,i.glyphOffsetArray,g,m,A,B,k,x,l,u);v=$.useVertical,($.notEnoughRoom||v||$.needsFlipping&&Zw(_,D,!0,s,e,n,a,i.glyphOffsetArray,g,m,A,B,k,x,l,u).notEnoughRoom)&&Fu(_.numGlyphs,m)}r?i.text.dynamicLayoutVertexBuffer.updateData(m):i.icon.dynamicLayoutVertexBuffer.updateData(m)}h(rU,"updateLineLabels");function Z5(i,e,t,r,n,a,o,s,l,u,c,p,d){let m=s.glyphStartIndex+s.numGlyphs,g=s.lineStartIndex,b=s.lineStartIndex+s.lineLength,x=e.getoffsetX(s.glyphStartIndex),v=e.getoffsetX(m-1),w=Cm(i*x,t,r,n,a,o,s.segment,g,b,l,u,c,p,d);if(!w)return null;let _=Cm(i*v,t,r,n,a,o,s.segment,g,b,l,u,c,p,d);return _?{first:w,last:_}:null}h(Z5,"placeFirstAndLastGlyph");function qw(i,e,t,r){if(i===1){let n=Math.abs(t.y-e.y),a=Math.abs(t.x-e.x)*r;if(n>a)return{useVertical:!0}}return(i===2?e.y<t.y:e.x>t.x)?{needsFlipping:!0}:null}h(qw,"requiresOrientationChange");function Zw(i,e,t,r,n,a,o,s,l,u,c,p,d,m,g,b){let x=e/24,v=i.lineOffsetX*x,w=i.lineOffsetY*x,_;if(i.numGlyphs>1){let C=i.glyphStartIndex+i.numGlyphs,E=i.lineStartIndex,T=i.lineStartIndex+i.lineLength,L=Z5(x,s,v,w,t,c,p,i,l,a,d,g,b);if(!L)return{notEnoughRoom:!0};let D=la(L.first.point,o,b).point,B=la(L.last.point,o,b).point;if(r&&!t){let A=qw(i.writingMode,D,B,m);if(A)return A}_=[L.first];for(let A=i.glyphStartIndex+1;A<C-1;A++)_.push(Cm(x*s.getoffsetX(A),v,w,t,c,p,i.segment,E,T,l,a,d,g,b));_.push(L.last)}else{if(r&&!t){let E=la(p,n,b).point,T=i.lineStartIndex+i.segment+1,L=new Mm.default(l.getx(T),l.gety(T)),D=la(L,n,b),B=D.signedDistanceFromCamera>0?D.point:Y5(p,L,E,1,n,b),A=qw(i.writingMode,E,B,m);if(A)return A}let C=Cm(x*s.getoffsetX(i.glyphStartIndex),v,w,t,c,p,i.segment,i.lineStartIndex,i.lineStartIndex+i.lineLength,l,a,d,g,b);if(!C)return{notEnoughRoom:!0};_=[C]}for(let C of _)Fp(u,C.point,C.angle);return{}}h(Zw,"placeGlyphsAlongLine");function Y5(i,e,t,r,n,a){let o=la(i.add(i.sub(e)._unit()),n,a).point,s=t.sub(o);return t.add(s._mult(r/s.mag()))}h(Y5,"projectTruncatedLineSegment");function cv(i,e){let{projectionCache:t,lineVertexArray:r,labelPlaneMatrix:n,tileAnchorPoint:a,distanceFromAnchor:o,getElevation:s,previousVertex:l,direction:u,absOffsetX:c}=e;if(t.projections[i])return t.projections[i];let p=new Mm.default(r.getx(i),r.gety(i)),d=la(p,n,s);if(d.signedDistanceFromCamera>0)return t.projections[i]=d.point,d.point;let m=i-u,g=o===0?a:new Mm.default(r.getx(m),r.gety(m));return Y5(g,p,l,c-o+1,n,s)}h(cv,"projectVertexToViewport");function pv(i,e,t){return i._unit()._perp()._mult(e*t)}h(pv,"transformToOffsetNormal");function nU(i,e,t,r,n,a,o,s){let{projectionCache:l,direction:u}=s;if(l.offsets[i])return l.offsets[i];let c=t.add(e);if(i+u<r||i+u>=n)return l.offsets[i]=c,c;let p=cv(i+u,s),d=pv(p.sub(t),o,u),m=t.add(d),g=p.add(d);return l.offsets[i]=sL(a,c,m,g)||c,l.offsets[i]}h(nU,"findOffsetIntersectionPoint");function Cm(i,e,t,r,n,a,o,s,l,u,c,p,d,m){let g=r?i-e:i+e,b=g>0?1:-1,x=0;r&&(b*=-1,x=Math.PI),b<0&&(x+=Math.PI);let v=b>0?s+o:s+o+1,w=n,_=n,C,E,T=0,L=0,D=Math.abs(g),B=[],A;for(;T+L<=D;){if(v+=b,v<s||v>=l)return null;T+=L,_=w,E=C;let P={projectionCache:p,lineVertexArray:u,labelPlaneMatrix:c,tileAnchorPoint:a,distanceFromAnchor:T,getElevation:m,previousVertex:_,direction:b,absOffsetX:D};if(w=cv(v,P),t===0)B.push(_),A=w.sub(_);else{let U,G=w.sub(_);if(G.mag()===0){let K=cv(v+b,P);U=pv(K.sub(w),t,b)}else U=pv(G,t,b);E||(E=_.add(U)),C=nU(v,U,w,s,l,E,t,P),B.push(E),A=C.sub(E)}L=A.mag()}let k=(D-T)/L,$=A._mult(k)._add(E||_),O=x+Math.atan2(w.y-_.y,w.x-_.x);return B.push($),{point:$,angle:d?O:0,path:B}}h(Cm,"placeGlyphAlongLine");var Qle=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Fu(i,e){for(let t=0;t<i;t++){let r=e.length;e.resize(r+4),e.float32.set(Qle,r*3)}}h(Fu,"hideGlyphs");function zx(i,e,t){let r=e[0],n=e[1];return i[0]=t[0]*r+t[4]*n+t[12],i[1]=t[1]*r+t[5]*n+t[13],i[3]=t[3]*r+t[7]*n+t[15],i}h(zx,"xyTransformMat4");var br=100,aU=class{constructor(e,t=new rA(e.width+2*br,e.height+2*br,25),r=new rA(e.width+2*br,e.height+2*br,25)){this.transform=e,this.grid=t,this.ignoredGrid=r,this.pitchfactor=Math.cos(e._pitch)*e.cameraToCenterDistance,this.screenRightBoundary=e.width+br,this.screenBottomBoundary=e.height+br,this.gridRightBoundary=e.width+2*br,this.gridBottomBoundary=e.height+2*br,this.perspectiveRatioCutoff=.6}placeCollisionBox(e,t,r,n,a,o){let s=this.projectAndGetPerspectiveRatio(n,e.anchorPointX,e.anchorPointY,o),l=r*s.perspectiveRatio,u=e.x1*l+s.point.x,c=e.y1*l+s.point.y,p=e.x2*l+s.point.x,d=e.y2*l+s.point.y;return!this.isInsideGrid(u,c,p,d)||t!=="always"&&this.grid.hitTest(u,c,p,d,t,a)||s.perspectiveRatio<this.perspectiveRatioCutoff?{box:[],offscreen:!1}:{box:[u,c,p,d],offscreen:this.isOffscreen(u,c,p,d)}}placeCollisionCircles(e,t,r,n,a,o,s,l,u,c,p,d,m,g){let b=[],x=new Ko.default(t.anchorX,t.anchorY),v=la(x,o,g),w=Fx(this.transform.cameraToCenterDistance,v.signedDistanceFromCamera),_=(c?a/w:a*w)/CN,C=la(x,s,g).point,E={projections:{},offsets:{}},T=t.lineOffsetX*_,L=t.lineOffsetY*_,D=Z5(_,n,T,L,!1,C,x,t,r,s,E,!1,g),B=!1,A=!1,k=!0;if(D){let $=d*.5*w+m,O=new Ko.default(-br,-br),P=new Ko.default(this.screenRightBoundary,this.screenBottomBoundary),U=new Kle,G=D.first,K=D.last,z=[];for(let q=G.path.length-1;q>=1;q--)z.push(G.path[q]);for(let q=1;q<K.path.length;q++)z.push(K.path[q]);let V=$*2.5;if(l){let q=z.map(ee=>la(ee,l,g));q.some(ee=>ee.signedDistanceFromCamera<=0)?z=[]:z=q.map(ee=>ee.point)}let j=[];if(z.length>0){let q=z[0].clone(),ee=z[0].clone();for(let ae=1;ae<z.length;ae++)q.x=Math.min(q.x,z[ae].x),q.y=Math.min(q.y,z[ae].y),ee.x=Math.max(ee.x,z[ae].x),ee.y=Math.max(ee.y,z[ae].y);q.x>=O.x&&ee.x<=P.x&&q.y>=O.y&&ee.y<=P.y?j=[z]:ee.x<O.x||q.x>P.x||ee.y<O.y||q.y>P.y?j=[]:j=Q$([z],O.x,O.y,P.x,P.y)}for(let q of j){U.reset(q,$*.25);let ee=0;U.length<=.5*$?ee=1:ee=Math.ceil(U.paddedLength/V)+1;for(let ae=0;ae<ee;ae++){let N=ae/Math.max(ee-1,1),J=U.lerp(N),Y=J.x+br,oe=J.y+br;b.push(Y,oe,$,0);let xe=Y-$,ge=oe-$,Te=Y+$,me=oe+$;if(k=k&&this.isOffscreen(xe,ge,Te,me),A=A||this.isInsideGrid(xe,ge,Te,me),e!=="always"&&this.grid.hitTestCircle(Y,oe,$,e,p)&&(B=!0,!u))return{circles:[],offscreen:!1,collisionDetected:B}}}}return{circles:!u&&B||!A||w<this.perspectiveRatioCutoff?[]:b,offscreen:k,collisionDetected:B}}queryRenderedSymbols(e){if(e.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};let t=[],r=1/0,n=1/0,a=-1/0,o=-1/0;for(let c of e){let p=new Ko.default(c.x+br,c.y+br);r=Math.min(r,p.x),n=Math.min(n,p.y),a=Math.max(a,p.x),o=Math.max(o,p.y),t.push(p)}let s=this.grid.query(r,n,a,o).concat(this.ignoredGrid.query(r,n,a,o)),l={},u={};for(let c of s){let p=c.key;if(l[p.bucketInstanceId]===void 0&&(l[p.bucketInstanceId]={}),l[p.bucketInstanceId][p.featureIndex])continue;let d=[new Ko.default(c.x1,c.y1),new Ko.default(c.x2,c.y1),new Ko.default(c.x2,c.y2),new Ko.default(c.x1,c.y2)];X4(t,d)&&(l[p.bucketInstanceId][p.featureIndex]=!0,u[p.bucketInstanceId]===void 0&&(u[p.bucketInstanceId]=[]),u[p.bucketInstanceId].push(p.featureIndex))}return u}insertCollisionBox(e,t,r,n,a,o){let s=r?this.ignoredGrid:this.grid,l={bucketInstanceId:n,featureIndex:a,collisionGroupID:o,overlapMode:t};s.insert(l,e[0],e[1],e[2],e[3])}insertCollisionCircles(e,t,r,n,a,o){let s=r?this.ignoredGrid:this.grid,l={bucketInstanceId:n,featureIndex:a,collisionGroupID:o,overlapMode:t};for(let u=0;u<e.length;u+=4)s.insertCircle(l,e[u],e[u+1],e[u+2])}projectAndGetPerspectiveRatio(e,t,r,n){let a;return n?(a=[t,r,n(t,r),1],wn.transformMat4(a,a,e)):(a=[t,r,0,1],zx(a,a,e)),{point:new Ko.default((a[0]/a[3]+1)/2*this.transform.width+br,(-a[1]/a[3]+1)/2*this.transform.height+br),perspectiveRatio:.5+.5*(this.transform.cameraToCenterDistance/a[3])}}isOffscreen(e,t,r,n){return r<br||e>=this.screenRightBoundary||n<br||t>this.screenBottomBoundary}isInsideGrid(e,t,r,n){return r>=0&&e<this.gridRightBoundary&&n>=0&&t<this.gridBottomBoundary}getViewportMatrix(){let e=lt.identity([]);return lt.translate(e,e,[-br,-br,0]),e}};h(aU,"CollisionIndex");var eue=aU;R();R();var tue=It(di(),1),oU=class sU extends tue.default{constructor(e,t,r,n){super(e,t),this.angle=r,n!==void 0&&(this.segment=n)}clone(){return new sU(this.x,this.y,this.angle,this.segment)}};h(oU,"Anchor");var iue=oU;st("Anchor",iue);R();R();R();It(di(),1);R();It(di(),1);R();R();It(di(),1);It(Z7(),1);R();var Yw=(i=>(i[i.center=1]="center",i[i.left=2]="left",i[i.right=3]="right",i[i.top=4]="top",i[i.bottom=5]="bottom",i[i["top-left"]=6]="top-left",i[i["top-right"]=7]="top-right",i[i["bottom-left"]=8]="bottom-left",i[i["bottom-right"]=9]="bottom-right",i))(Yw||{});function lU(i){switch(i){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}h(lU,"getAnchorJustification");R();function qn(i,e,t){return e*(8192/(i.tileSize*Math.pow(2,t-i.tileID.overscaledZ)))}h(qn,"pixelsToTileUnits");var J5=It(di(),1),uU=class{constructor(e,t,r,n){e?this.opacity=Math.max(0,Math.min(1,e.opacity+(e.placed?t:-t))):this.opacity=n&&r?1:0,this.placed=r}isHidden(){return this.opacity===0&&!this.placed}};h(uU,"OpacityState");var nA=uU,hU=class{constructor(e,t,r,n,a){this.text=new nA(e?e.text:null,t,r,a),this.icon=new nA(e?e.icon:null,t,n,a)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}};h(hU,"JointOpacityState");var xd=hU,cU=class{constructor(e,t,r){this.text=e,this.icon=t,this.skipFade=r}};h(cU,"JointPlacement");var aA=cU,pU=class{constructor(){this.invProjMatrix=lt.create(),this.viewportMatrix=lt.create(),this.circles=[]}};h(pU,"CollisionCircleArray");var rue=pU,dU=class{constructor(e,t,r,n,a){this.bucketInstanceId=e,this.featureIndex=t,this.sourceLayerIndex=r,this.bucketIndex=n,this.tileID=a}};h(dU,"RetainedQueryData");var nue=dU,fU=class{constructor(e){this.crossSourceCollisions=e,this.maxGroupID=0,this.collisionGroups={}}get(e){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[e]){let t=++this.maxGroupID;this.collisionGroups[e]={ID:t,predicate:r=>r.collisionGroupID===t}}return this.collisionGroups[e]}};h(fU,"CollisionGroups");var aue=fU;function Jw(i,e,t,r,n){let{horizontalAlign:a,verticalAlign:o}=$5(i),s=-(a-.5)*e,l=-(o-.5)*t;return new J5.default(s+r[0]*n,l+r[1]*n)}h(Jw,"calculateVariableLayoutShift");function cy(i,e,t,r,n,a){let{x1:o,x2:s,y1:l,y2:u,anchorPointX:c,anchorPointY:p}=i,d=new J5.default(e,t);return r&&d._rotate(n?a:-a),{x1:o+d.x,y1:l+d.y,x2:s+d.x,y2:u+d.y,anchorPointX:c,anchorPointY:p}}h(cy,"shiftVariableCollisionBox");var mU=class{constructor(e,t,r,n,a){this.transform=e.clone(),this.terrain=t,this.collisionIndex=new eue(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=r,this.retainedQueryData={},this.collisionGroups=new aue(n),this.collisionCircleArrays={},this.prevPlacement=a,a&&(a.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(e,t,r,n){let a=r.getBucket(t),o=r.latestFeatureIndex;if(!a||!o||t.id!==a.layerIds[0])return;let s=r.collisionBoxArray,l=a.layers[0].layout,u=Math.pow(2,this.transform.zoom-r.tileID.overscaledZ),c=r.tileSize/8192,p=this.transform.calculatePosMatrix(r.tileID.toUnwrapped()),d=l.get("text-pitch-alignment")==="map",m=l.get("text-rotation-alignment")==="map",g=qn(r,1,this.transform.zoom),b=Rx(p,d,m,this.transform,g),x=null;if(d){let w=q5(p,d,m,this.transform,g);x=lt.multiply([],this.transform.labelPlaneMatrix,w)}this.retainedQueryData[a.bucketInstanceId]=new nue(a.bucketInstanceId,o,a.sourceLayerIndex,a.index,r.tileID);let v={bucket:a,layout:l,posMatrix:p,textLabelPlaneMatrix:b,labelToScreenMatrix:x,scale:u,textPixelRatio:c,holdingForFade:r.holdingForFade(),collisionBoxArray:s,partiallyEvaluatedTextSize:Km(a.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(a.sourceID)};if(n)for(let w of a.sortKeyRanges){let{sortKey:_,symbolInstanceStart:C,symbolInstanceEnd:E}=w;e.push({sortKey:_,symbolInstanceStart:C,symbolInstanceEnd:E,parameters:v})}else e.push({symbolInstanceStart:0,symbolInstanceEnd:a.symbolInstances.length,parameters:v})}attemptAnchorPlacement(e,t,r,n,a,o,s,l,u,c,p,d,m,g,b,x){let v=Yw[e.textAnchor],w=[e.textOffset0,e.textOffset1],_=Jw(v,r,n,w,a),C=this.collisionIndex.placeCollisionBox(cy(t,_.x,_.y,o,s,this.transform.angle),p,l,u,c.predicate,x);if(!(b&&this.collisionIndex.placeCollisionBox(cy(b,_.x,_.y,o,s,this.transform.angle),p,l,u,c.predicate,x).box.length===0)&&C.box.length>0){let E;if(this.prevPlacement&&this.prevPlacement.variableOffsets[d.crossTileID]&&this.prevPlacement.placements[d.crossTileID]&&this.prevPlacement.placements[d.crossTileID].text&&(E=this.prevPlacement.variableOffsets[d.crossTileID].anchor),d.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[d.crossTileID]={textOffset:w,width:r,height:n,anchor:v,textBoxScale:a,prevAnchor:E},this.markUsedJustification(m,v,d,g),m.allowVerticalPlacement&&(this.markUsedOrientation(m,g,d),this.placedOrientations[d.crossTileID]=g),{shift:_,placedGlyphBoxes:C}}}placeLayerBucketPart(e,t,r){let{bucket:n,layout:a,posMatrix:o,textLabelPlaneMatrix:s,labelToScreenMatrix:l,textPixelRatio:u,holdingForFade:c,collisionBoxArray:p,partiallyEvaluatedTextSize:d,collisionGroup:m}=e.parameters,g=a.get("text-optional"),b=a.get("icon-optional"),x=bm(a,"text-overlap","text-allow-overlap"),v=x==="always",w=bm(a,"icon-overlap","icon-allow-overlap"),_=w==="always",C=a.get("text-rotation-alignment")==="map",E=a.get("text-pitch-alignment")==="map",T=a.get("icon-text-fit")!=="none",L=a.get("symbol-z-order")==="viewport-y",D=v&&(_||!n.hasIconData()||b),B=_&&(v||!n.hasTextData()||g);!n.collisionArrays&&p&&n.deserializeCollisionBoxes(p);let A=this.retainedQueryData[n.bucketInstanceId].tileID,k=this.terrain?(O,P)=>this.terrain.getElevation(A,O,P):null,$=h((O,P)=>{var U,G;if(t[O.crossTileID])return;if(c){this.placements[O.crossTileID]=new aA(!1,!1,!1);return}let K=!1,z=!1,V=!0,j=null,q={box:null,offscreen:null},ee={box:null,offscreen:null},ae=null,N=null,J=null,Y=0,oe=0,xe=0;P.textFeatureIndex?Y=P.textFeatureIndex:O.useRuntimeCollisionCircles&&(Y=O.featureIndex),P.verticalTextFeatureIndex&&(oe=P.verticalTextFeatureIndex);let ge=P.textBox;if(ge){let Q=h(De=>{let we=1;if(n.allowVerticalPlacement&&!De&&this.prevPlacement){let Fe=this.prevPlacement.placedOrientations[O.crossTileID];Fe&&(this.placedOrientations[O.crossTileID]=Fe,we=Fe,this.markUsedOrientation(n,we,O))}return we},"updatePreviousOrientationIfNotPlaced"),Me=h((De,we)=>{if(n.allowVerticalPlacement&&O.numVerticalGlyphVertices>0&&P.verticalTextBox){for(let Fe of n.writingModes)if(Fe===2?(q=we(),ee=q):q=De(),q&&q.box&&q.box.length)break}else q=De()},"placeTextForPlacementModes"),ve=O.textAnchorOffsetStartIndex,Ie=O.textAnchorOffsetEndIndex;if(Ie===ve){let De=h((we,Fe)=>{let Ze=this.collisionIndex.placeCollisionBox(we,x,u,o,m.predicate,k);return Ze&&Ze.box&&Ze.box.length&&(this.markUsedOrientation(n,Fe,O),this.placedOrientations[O.crossTileID]=Fe),Ze},"placeBox");Me(h(()=>De(ge,1),"placeHorizontal"),h(()=>{let we=P.verticalTextBox;return n.allowVerticalPlacement&&O.numVerticalGlyphVertices>0&&we?De(we,2):{box:null,offscreen:null}},"placeVertical")),Q(q&&q.box&&q.box.length)}else{let De=Yw[(G=(U=this.prevPlacement)==null?void 0:U.variableOffsets[O.crossTileID])==null?void 0:G.anchor],we=h((Ze,yt,ne)=>{let W=Ze.x2-Ze.x1,_e=Ze.y2-Ze.y1,Re=O.textBoxScale,Ne=T&&w==="never"?yt:null,ze={box:[],offscreen:!1},xt=x==="never"?1:2,ot="never";De&&xt++;for(let je=0;je<xt;je++){for(let He=ve;He<Ie;He++){let bt=n.textAnchorOffsets.get(He);if(De&&bt.textAnchor!==De)continue;let Xe=this.attemptAnchorPlacement(bt,Ze,W,_e,Re,C,E,u,o,m,ot,O,n,ne,Ne,k);if(Xe&&(ze=Xe.placedGlyphBoxes,ze&&ze.box&&ze.box.length))return K=!0,j=Xe.shift,ze}De?De=null:ot=x}return ze},"placeBoxForVariableAnchors");Me(h(()=>we(ge,P.iconBox,1),"placeHorizontal"),h(()=>{let Ze=P.verticalTextBox,yt=q&&q.box&&q.box.length;return n.allowVerticalPlacement&&!yt&&O.numVerticalGlyphVertices>0&&Ze?we(Ze,P.verticalIconBox,2):{box:null,offscreen:null}},"placeVertical")),q&&(K=q.box,V=q.offscreen);let Fe=Q(q&&q.box);if(!K&&this.prevPlacement){let Ze=this.prevPlacement.variableOffsets[O.crossTileID];Ze&&(this.variableOffsets[O.crossTileID]=Ze,this.markUsedJustification(n,Ze.anchor,O,Fe))}}}if(ae=q,K=ae&&ae.box&&ae.box.length>0,V=ae&&ae.offscreen,O.useRuntimeCollisionCircles){let Q=n.text.placedSymbolArray.get(O.centerJustifiedTextSymbolIndex),Me=Ix(n.textSizeData,d,Q),ve=a.get("text-padding"),Ie=O.collisionCircleDiameter;N=this.collisionIndex.placeCollisionCircles(x,Q,n.lineVertexArray,n.glyphOffsetArray,Me,o,s,l,r,E,m.predicate,Ie,ve,k),N.circles.length&&N.collisionDetected&&!r&&ln("Collisions detected, but collision boxes are not shown"),K=v||N.circles.length>0&&!N.collisionDetected,V=V&&N.offscreen}if(P.iconFeatureIndex&&(xe=P.iconFeatureIndex),P.iconBox){let Q=h(Me=>{let ve=T&&j?cy(Me,j.x,j.y,C,E,this.transform.angle):Me;return this.collisionIndex.placeCollisionBox(ve,w,u,o,m.predicate,k)},"placeIconFeature");ee&&ee.box&&ee.box.length&&P.verticalIconBox?(J=Q(P.verticalIconBox),z=J.box.length>0):(J=Q(P.iconBox),z=J.box.length>0),V=V&&J.offscreen}let Te=g||O.numHorizontalGlyphVertices===0&&O.numVerticalGlyphVertices===0,me=b||O.numIconVertices===0;if(!Te&&!me?z=K=z&&K:me?Te||(z=z&&K):K=z&&K,K&&ae&&ae.box&&(ee&&ee.box&&oe?this.collisionIndex.insertCollisionBox(ae.box,x,a.get("text-ignore-placement"),n.bucketInstanceId,oe,m.ID):this.collisionIndex.insertCollisionBox(ae.box,x,a.get("text-ignore-placement"),n.bucketInstanceId,Y,m.ID)),z&&J&&this.collisionIndex.insertCollisionBox(J.box,w,a.get("icon-ignore-placement"),n.bucketInstanceId,xe,m.ID),N&&(K&&this.collisionIndex.insertCollisionCircles(N.circles,x,a.get("text-ignore-placement"),n.bucketInstanceId,Y,m.ID),r)){let Q=n.bucketInstanceId,Me=this.collisionCircleArrays[Q];Me===void 0&&(Me=this.collisionCircleArrays[Q]=new rue);for(let ve=0;ve<N.circles.length;ve+=4)Me.circles.push(N.circles[ve+0]),Me.circles.push(N.circles[ve+1]),Me.circles.push(N.circles[ve+2]),Me.circles.push(N.collisionDetected?1:0)}if(O.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(n.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[O.crossTileID]=new aA(K||D,z||B,V||n.justReloaded),t[O.crossTileID]=!0},"placeSymbol");if(L){if(e.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");let O=n.getSortedSymbolIndexes(this.transform.angle);for(let P=O.length-1;P>=0;--P){let U=O[P];$(n.symbolInstances.get(U),n.collisionArrays[U])}}else for(let O=e.symbolInstanceStart;O<e.symbolInstanceEnd;O++)$(n.symbolInstances.get(O),n.collisionArrays[O]);if(r&&n.bucketInstanceId in this.collisionCircleArrays){let O=this.collisionCircleArrays[n.bucketInstanceId];lt.invert(O.invProjMatrix,o),O.viewportMatrix=this.collisionIndex.getViewportMatrix()}n.justReloaded=!1}markUsedJustification(e,t,r,n){let a={left:r.leftJustifiedTextSymbolIndex,center:r.centerJustifiedTextSymbolIndex,right:r.rightJustifiedTextSymbolIndex},o;n===2?o=r.verticalPlacedTextSymbolIndex:o=a[lU(t)];let s=[r.leftJustifiedTextSymbolIndex,r.centerJustifiedTextSymbolIndex,r.rightJustifiedTextSymbolIndex,r.verticalPlacedTextSymbolIndex];for(let l of s)l>=0&&(o>=0&&l!==o?e.text.placedSymbolArray.get(l).crossTileID=0:e.text.placedSymbolArray.get(l).crossTileID=r.crossTileID)}markUsedOrientation(e,t,r){let n=t===1||t===3?t:0,a=t===2?t:0,o=[r.leftJustifiedTextSymbolIndex,r.centerJustifiedTextSymbolIndex,r.rightJustifiedTextSymbolIndex];for(let s of o)e.text.placedSymbolArray.get(s).placedOrientation=n;r.verticalPlacedTextSymbolIndex&&(e.text.placedSymbolArray.get(r.verticalPlacedTextSymbolIndex).placedOrientation=a)}commit(e){this.commitTime=e,this.zoomAtLastRecencyCheck=this.transform.zoom;let t=this.prevPlacement,r=!1;this.prevZoomAdjustment=t?t.zoomAdjustment(this.transform.zoom):0;let n=t?t.symbolFadeChange(e):1,a=t?t.opacities:{},o=t?t.variableOffsets:{},s=t?t.placedOrientations:{};for(let l in this.placements){let u=this.placements[l],c=a[l];c?(this.opacities[l]=new xd(c,n,u.text,u.icon),r=r||u.text!==c.text.placed||u.icon!==c.icon.placed):(this.opacities[l]=new xd(null,n,u.text,u.icon,u.skipFade),r=r||u.text||u.icon)}for(let l in a){let u=a[l];if(!this.opacities[l]){let c=new xd(u,n,!1,!1);c.isHidden()||(this.opacities[l]=c,r=r||u.text.placed||u.icon.placed)}}for(let l in o)!this.variableOffsets[l]&&this.opacities[l]&&!this.opacities[l].isHidden()&&(this.variableOffsets[l]=o[l]);for(let l in s)!this.placedOrientations[l]&&this.opacities[l]&&!this.opacities[l].isHidden()&&(this.placedOrientations[l]=s[l]);if(t&&t.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");r?this.lastPlacementChangeTime=e:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=t?t.lastPlacementChangeTime:e)}updateLayerOpacities(e,t){let r={};for(let n of t){let a=n.getBucket(e);a&&n.latestFeatureIndex&&e.id===a.layerIds[0]&&this.updateBucketOpacities(a,r,n.collisionBoxArray)}}updateBucketOpacities(e,t,r){e.hasTextData()&&(e.text.opacityVertexArray.clear(),e.text.hasVisibleVertices=!1),e.hasIconData()&&(e.icon.opacityVertexArray.clear(),e.icon.hasVisibleVertices=!1),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexArray.clear(),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexArray.clear();let n=e.layers[0],a=n.layout,o=new xd(null,0,!1,!1,!0),s=a.get("text-allow-overlap"),l=a.get("icon-allow-overlap"),u=n._unevaluatedLayout.hasValue("text-variable-anchor")||n._unevaluatedLayout.hasValue("text-variable-anchor-offset"),c=a.get("text-rotation-alignment")==="map",p=a.get("text-pitch-alignment")==="map",d=a.get("icon-text-fit")!=="none",m=new xd(null,0,s&&(l||!e.hasIconData()||a.get("icon-optional")),l&&(s||!e.hasTextData()||a.get("text-optional")),!0);!e.collisionArrays&&r&&(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData())&&e.deserializeCollisionBoxes(r);let g=h((b,x,v)=>{for(let w=0;w<x/4;w++)b.opacityVertexArray.emplaceBack(v);b.hasVisibleVertices=b.hasVisibleVertices||v!==_d},"addOpacities");for(let b=0;b<e.symbolInstances.length;b++){let x=e.symbolInstances.get(b),{numHorizontalGlyphVertices:v,numVerticalGlyphVertices:w,crossTileID:_}=x,C=t[_],E=this.opacities[_];C?E=o:E||(E=m,this.opacities[_]=E),t[_]=!0;let T=v>0||w>0,L=x.numIconVertices>0,D=this.placedOrientations[x.crossTileID],B=D===2,A=D===1||D===3;if(T){let k=Kw(E.text),$=B?_d:k;g(e.text,v,$);let O=A?_d:k;g(e.text,w,O);let P=E.text.isHidden();[x.rightJustifiedTextSymbolIndex,x.centerJustifiedTextSymbolIndex,x.leftJustifiedTextSymbolIndex].forEach(K=>{K>=0&&(e.text.placedSymbolArray.get(K).hidden=P||B?1:0)}),x.verticalPlacedTextSymbolIndex>=0&&(e.text.placedSymbolArray.get(x.verticalPlacedTextSymbolIndex).hidden=P||A?1:0);let U=this.variableOffsets[x.crossTileID];U&&this.markUsedJustification(e,U.anchor,x,D);let G=this.placedOrientations[x.crossTileID];G&&(this.markUsedJustification(e,"left",x,G),this.markUsedOrientation(e,G,x))}if(L){let k=Kw(E.icon),$=!(d&&x.verticalPlacedIconSymbolIndex&&B);if(x.placedIconSymbolIndex>=0){let O=$?k:_d;g(e.icon,x.numIconVertices,O),e.icon.placedSymbolArray.get(x.placedIconSymbolIndex).hidden=E.icon.isHidden()}if(x.verticalPlacedIconSymbolIndex>=0){let O=$?_d:k;g(e.icon,x.numVerticalIconVertices,O),e.icon.placedSymbolArray.get(x.verticalPlacedIconSymbolIndex).hidden=E.icon.isHidden()}}if(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData()){let k=e.collisionArrays[b];if(k){let $=new J5.default(0,0);if(k.textBox||k.verticalTextBox){let P=!0;if(u){let U=this.variableOffsets[_];U?($=Jw(U.anchor,U.width,U.height,U.textOffset,U.textBoxScale),c&&$._rotate(p?this.transform.angle:-this.transform.angle)):P=!1}k.textBox&&ef(e.textCollisionBox.collisionVertexArray,E.text.placed,!P||B,$.x,$.y),k.verticalTextBox&&ef(e.textCollisionBox.collisionVertexArray,E.text.placed,!P||A,$.x,$.y)}let O=!!(!A&&k.verticalIconBox);k.iconBox&&ef(e.iconCollisionBox.collisionVertexArray,E.icon.placed,O,d?$.x:0,d?$.y:0),k.verticalIconBox&&ef(e.iconCollisionBox.collisionVertexArray,E.icon.placed,!O,d?$.x:0,d?$.y:0)}}}if(e.sortFeatures(this.transform.angle),this.retainedQueryData[e.bucketInstanceId]&&(this.retainedQueryData[e.bucketInstanceId].featureSortOrder=e.featureSortOrder),e.hasTextData()&&e.text.opacityVertexBuffer&&e.text.opacityVertexBuffer.updateData(e.text.opacityVertexArray),e.hasIconData()&&e.icon.opacityVertexBuffer&&e.icon.opacityVertexBuffer.updateData(e.icon.opacityVertexArray),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexBuffer&&e.iconCollisionBox.collisionVertexBuffer.updateData(e.iconCollisionBox.collisionVertexArray),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexBuffer&&e.textCollisionBox.collisionVertexBuffer.updateData(e.textCollisionBox.collisionVertexArray),e.text.opacityVertexArray.length!==e.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${e.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${e.text.layoutVertexArray.length}) / 4`);if(e.icon.opacityVertexArray.length!==e.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${e.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${e.icon.layoutVertexArray.length}) / 4`);if(e.bucketInstanceId in this.collisionCircleArrays){let b=this.collisionCircleArrays[e.bucketInstanceId];e.placementInvProjMatrix=b.invProjMatrix,e.placementViewportMatrix=b.viewportMatrix,e.collisionCircleArray=b.circles,delete this.collisionCircleArrays[e.bucketInstanceId]}}symbolFadeChange(e){return this.fadeDuration===0?1:(e-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(e){return Math.max(0,(this.transform.zoom-e)/1.5)}hasTransitions(e){return this.stale||e-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(e,t){let r=this.zoomAtLastRecencyCheck===t?1-this.zoomAdjustment(t):1;return this.zoomAtLastRecencyCheck=t,this.commitTime+this.fadeDuration*r>e}setStale(){this.stale=!0}};h(mU,"Placement");var oue=mU;function ef(i,e,t,r,n){i.emplaceBack(e?1:0,t?1:0,r||0,n||0),i.emplaceBack(e?1:0,t?1:0,r||0,n||0),i.emplaceBack(e?1:0,t?1:0,r||0,n||0),i.emplaceBack(e?1:0,t?1:0,r||0,n||0)}h(ef,"updateCollisionVertices");var sue=Math.pow(2,25),lue=Math.pow(2,24),uue=Math.pow(2,17),hue=Math.pow(2,16),cue=Math.pow(2,9),pue=Math.pow(2,8),due=Math.pow(2,1);function Kw(i){if(i.opacity===0&&!i.placed)return 0;if(i.opacity===1&&i.placed)return 4294967295;let e=i.placed?1:0,t=Math.floor(i.opacity*127);return t*sue+e*lue+t*uue+e*hue+t*cue+e*pue+t*due+e}h(Kw,"packOpacity");var _d=0,gU=class{constructor(e){this._sortAcrossTiles=e.layout.get("symbol-z-order")!=="viewport-y"&&!e.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(e,t,r,n,a){let o=this._bucketParts;for(;this._currentTileIndex<e.length;){let s=e[this._currentTileIndex];if(t.getBucketParts(o,n,s,this._sortAcrossTiles),this._currentTileIndex++,a())return!0}for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,o.sort((s,l)=>s.sortKey-l.sortKey));this._currentPartIndex<o.length;){let s=o[this._currentPartIndex];if(t.placeLayerBucketPart(s,this._seenCrossTileIDs,r),this._currentPartIndex++,a())return!0}return!1}};h(gU,"LayerPlacement");var fue=gU,yU=class{constructor(e,t,r,n,a,o,s,l){this.placement=new oue(e,t,o,s,l),this._currentPlacementIndex=r.length-1,this._forceFullPlacement=n,this._showCollisionBoxes=a,this._done=!1}isDone(){return this._done}continuePlacement(e,t,r){let n=ai.now(),a=h(()=>this._forceFullPlacement?!1:ai.now()-n>2,"shouldPausePlacement");for(;this._currentPlacementIndex>=0;){let o=e[this._currentPlacementIndex],s=t[o],l=this.placement.collisionIndex.transform.zoom;if(s.type==="symbol"&&(!s.minzoom||s.minzoom<=l)&&(!s.maxzoom||s.maxzoom>l)){if(this._inProgressLayer||(this._inProgressLayer=new fue(s)),this._inProgressLayer.continuePlacement(r[s.source],this.placement,this._showCollisionBoxes,s,a))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(e){return this.placement.commit(e),this.placement}};h(yU,"PauseablePlacement");var mue=yU;R();R();var oA=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],H_=1,bd=8,vU=class xU{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");let[t,r]=new Uint8Array(e,0,2);if(t!==219)throw new Error("Data does not appear to be in a KDBush format.");let n=r>>4;if(n!==H_)throw new Error(`Got v${n} data when expected v${H_}.`);let a=oA[r&15];if(!a)throw new Error("Unrecognized array type.");let[o]=new Uint16Array(e,2,1),[s]=new Uint32Array(e,4,1);return new xU(s,o,a,e)}constructor(e,t=64,r=Float64Array,n){if(isNaN(e)||e<0)throw new Error(`Unpexpected numItems value: ${e}.`);this.numItems=+e,this.nodeSize=Math.min(Math.max(+t,2),65535),this.ArrayType=r,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;let a=oA.indexOf(this.ArrayType),o=e*2*this.ArrayType.BYTES_PER_ELEMENT,s=e*this.IndexArrayType.BYTES_PER_ELEMENT,l=(8-s%8)%8;if(a<0)throw new Error(`Unexpected typed array class: ${r}.`);n&&n instanceof ArrayBuffer?(this.data=n,this.ids=new this.IndexArrayType(this.data,bd,e),this.coords=new this.ArrayType(this.data,bd+s+l,e*2),this._pos=e*2,this._finished=!0):(this.data=new ArrayBuffer(bd+o+s+l),this.ids=new this.IndexArrayType(this.data,bd,e),this.coords=new this.ArrayType(this.data,bd+s+l,e*2),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,(H_<<4)+a]),new Uint16Array(this.data,2,1)[0]=t,new Uint32Array(this.data,4,1)[0]=e)}add(e,t){let r=this._pos>>1;return this.ids[r]=r,this.coords[this._pos++]=e,this.coords[this._pos++]=t,r}finish(){let e=this._pos>>1;if(e!==this.numItems)throw new Error(`Added ${e} items when expected ${this.numItems}.`);return dv(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,t,r,n){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");let{ids:a,coords:o,nodeSize:s}=this,l=[0,a.length-1,0],u=[];for(;l.length;){let c=l.pop()||0,p=l.pop()||0,d=l.pop()||0;if(p-d<=s){for(let x=d;x<=p;x++){let v=o[2*x],w=o[2*x+1];v>=e&&v<=r&&w>=t&&w<=n&&u.push(a[x])}continue}let m=d+p>>1,g=o[2*m],b=o[2*m+1];g>=e&&g<=r&&b>=t&&b<=n&&u.push(a[m]),(c===0?e<=g:t<=b)&&(l.push(d),l.push(m-1),l.push(1-c)),(c===0?r>=g:n>=b)&&(l.push(m+1),l.push(p),l.push(1-c))}return u}within(e,t,r){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");let{ids:n,coords:a,nodeSize:o}=this,s=[0,n.length-1,0],l=[],u=r*r;for(;s.length;){let c=s.pop()||0,p=s.pop()||0,d=s.pop()||0;if(p-d<=o){for(let x=d;x<=p;x++)Qw(a[2*x],a[2*x+1],e,t)<=u&&l.push(n[x]);continue}let m=d+p>>1,g=a[2*m],b=a[2*m+1];Qw(g,b,e,t)<=u&&l.push(n[m]),(c===0?e-r<=g:t-r<=b)&&(s.push(d),s.push(m-1),s.push(1-c)),(c===0?e+r>=g:t+r>=b)&&(s.push(m+1),s.push(p),s.push(1-c))}return l}};h(vU,"KDBush");var gue=vU;function dv(i,e,t,r,n,a){if(n-r<=t)return;let o=r+n>>1;K5(i,e,o,r,n,a),dv(i,e,t,r,o-1,1-a),dv(i,e,t,o+1,n,1-a)}h(dv,"sort");function K5(i,e,t,r,n,a){for(;n>r;){if(n-r>600){let u=n-r+1,c=t-r+1,p=Math.log(u),d=.5*Math.exp(2*p/3),m=.5*Math.sqrt(p*d*(u-d)/u)*(c-u/2<0?-1:1),g=Math.max(r,Math.floor(t-c*d/u+m)),b=Math.min(n,Math.floor(t+(u-c)*d/u+m));K5(i,e,t,g,b,a)}let o=e[2*t+a],s=r,l=n;for(Jh(i,e,r,t),e[2*n+a]>o&&Jh(i,e,r,n);s<l;){for(Jh(i,e,s,l),s++,l--;e[2*s+a]<o;)s++;for(;e[2*l+a]>o;)l--}e[2*r+a]===o?Jh(i,e,r,l):(l++,Jh(i,e,l,n)),l<=t&&(r=l+1),t<=l&&(n=l-1)}}h(K5,"select");function Jh(i,e,t,r){py(i,t,r),py(e,2*t,2*r),py(e,2*t+1,2*r+1)}h(Jh,"swapItem");function py(i,e,t){let r=i[e];i[e]=i[t],i[t]=r}h(py,"swap");function Qw(i,e,t,r){let n=i-t,a=e-r;return n*n+a*a}h(Qw,"sqDist");var wd=512/8192/2,yue=128,_U=class{constructor(e,t,r){this.tileID=e,this.bucketInstanceId=r,this._symbolsByKey={};let n=new Map;for(let a=0;a<t.length;a++){let o=t.get(a),s=o.key,l=n.get(s);l?l.push(o):n.set(s,[o])}for(let[a,o]of n){let s=o.map(c=>({x:Math.floor(c.anchorX*wd),y:Math.floor(c.anchorY*wd)})),l=o.map(c=>c.crossTileID),u={positions:s,crossTileIDs:l};if(u.positions.length>yue){let c=new gue(u.positions.length,16,Uint16Array);for(let{x:p,y:d}of u.positions)c.add(p,d);c.finish(),delete u.positions,u.index=c}this._symbolsByKey[a]=u}}getScaledCoordinates(e,t){let{x:r,y:n,z:a}=this.tileID.canonical,{x:o,y:s,z:l}=t.canonical,u=l-a,c=wd/Math.pow(2,u),p=(o*8192+e.anchorX)*c,d=(s*8192+e.anchorY)*c,m=r*8192*wd,g=n*8192*wd;return{x:Math.floor(p-m),y:Math.floor(d-g)}}findMatches(e,t,r){let n=this.tileID.canonical.z<t.canonical.z?1:Math.pow(2,this.tileID.canonical.z-t.canonical.z);for(let a=0;a<e.length;a++){let o=e.get(a);if(o.crossTileID)continue;let s=this._symbolsByKey[o.key];if(!s)continue;let l=this.getScaledCoordinates(o,t);if(s.index){let u=s.index.range(l.x-n,l.y-n,l.x+n,l.y+n).sort();for(let c of u){let p=s.crossTileIDs[c];if(!r[p]){r[p]=!0,o.crossTileID=p;break}}}else if(s.positions)for(let u=0;u<s.positions.length;u++){let c=s.positions[u],p=s.crossTileIDs[u];if(Math.abs(c.x-l.x)<=n&&Math.abs(c.y-l.y)<=n&&!r[p]){r[p]=!0,o.crossTileID=p;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:e})=>e)}};h(_U,"TileLayerIndex");var vue=_U,bU=class{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}};h(bU,"CrossTileIDs");var xue=bU,wU=class{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(e){let t=Math.round((e-this.lng)/360);if(t!==0)for(let r in this.indexes){let n=this.indexes[r],a={};for(let o in n){let s=n[o];s.tileID=s.tileID.unwrapTo(s.tileID.wrap+t),a[s.tileID.key]=s}this.indexes[r]=a}this.lng=e}addBucket(e,t,r){if(this.indexes[e.overscaledZ]&&this.indexes[e.overscaledZ][e.key]){if(this.indexes[e.overscaledZ][e.key].bucketInstanceId===t.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(e.overscaledZ,this.indexes[e.overscaledZ][e.key])}for(let a=0;a<t.symbolInstances.length;a++){let o=t.symbolInstances.get(a);o.crossTileID=0}this.usedCrossTileIDs[e.overscaledZ]||(this.usedCrossTileIDs[e.overscaledZ]={});let n=this.usedCrossTileIDs[e.overscaledZ];for(let a in this.indexes){let o=this.indexes[a];if(Number(a)>e.overscaledZ)for(let s in o){let l=o[s];l.tileID.isChildOf(e)&&l.findMatches(t.symbolInstances,e,n)}else{let s=e.scaledTo(Number(a)),l=o[s.key];l&&l.findMatches(t.symbolInstances,e,n)}}for(let a=0;a<t.symbolInstances.length;a++){let o=t.symbolInstances.get(a);o.crossTileID||(o.crossTileID=r.generate(),n[o.crossTileID]=!0)}return this.indexes[e.overscaledZ]===void 0&&(this.indexes[e.overscaledZ]={}),this.indexes[e.overscaledZ][e.key]=new vue(e,t.symbolInstances,t.bucketInstanceId),!0}removeBucketCrossTileIDs(e,t){for(let r of t.getCrossTileIDsLists())for(let n of r)delete this.usedCrossTileIDs[e][n]}removeStaleBuckets(e){let t=!1;for(let r in this.indexes){let n=this.indexes[r];for(let a in n)e[n[a].bucketInstanceId]||(this.removeBucketCrossTileIDs(r,n[a]),delete n[a],t=!0)}return t}};h(wU,"CrossTileSymbolLayerIndex");var _ue=wU,SU=class{constructor(){this.layerIndexes={},this.crossTileIDs=new xue,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(e,t,r){let n=this.layerIndexes[e.id];n===void 0&&(n=this.layerIndexes[e.id]=new _ue);let a=!1,o={};n.handleWrapJump(r);for(let s of t){let l=s.getBucket(e);!l||e.id!==l.layerIds[0]||(l.bucketInstanceId||(l.bucketInstanceId=++this.maxBucketInstanceId),n.addBucket(s.tileID,l,this.crossTileIDs)&&(a=!0),o[l.bucketInstanceId]=!0)}return n.removeStaleBuckets(o)&&(a=!0),a}pruneUnusedLayers(e){let t={};e.forEach(r=>{t[r]=!0});for(let r in this.layerIndexes)t[r]||delete this.layerIndexes[r]}};h(SU,"CrossTileSymbolIndex");var MU=SU,Ug=h((i,e)=>vx(i,e&&e.filter(t=>t.identifier!=="source.canvas")),"emitValidationErrors"),bue=nk(),CU=class extends hn{constructor(e,t={}){super(),this._rtlPluginLoaded=()=>{for(let r in this.sourceCaches){let n=this.sourceCaches[r].getSource().type;(n==="vector"||n==="geojson")&&this.sourceCaches[r].reload()}},this.map=e,this.dispatcher=new s$(Dx(),e._getMapId()),this.dispatcher.registerMessageHandler("GG",(r,n)=>this.getGlyphs(r,n)),this.dispatcher.registerMessageHandler("GI",(r,n)=>this.getImages(r,n)),this.imageManager=new wle,this.imageManager.setEventedParent(this),this.glyphManager=new Mle(e._requestManager,t.localIdeographFontFamily),this.lineAtlas=new Tle(256,512),this.crossTileSymbolIndex=new MU,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new yk,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("SR",FC()),Bp().on(Gw,this._rtlPluginLoaded),this.on("data",r=>{if(r.dataType!=="source"||r.sourceDataType!=="metadata")return;let n=this.sourceCaches[r.sourceId];if(!n)return;let a=n.getSource();if(!(!a||!a.vectorLayerIds))for(let o in this._layers){let s=this._layers[o];s.source===a.id&&this._validateLayer(s)}})}loadURL(e,t={},r){this.fire(new qe("dataloading",{dataType:"style"})),t.validate=typeof t.validate=="boolean"?t.validate:!0;let n=this.map._requestManager.transformRequest(e,"Style");this._loadStyleRequest=new AbortController,rx(n,this._loadStyleRequest).then(a=>{this._loadStyleRequest=null,this._load(a.data,t,r)}).catch(a=>{this._loadStyleRequest=null,a&&this.fire(new Mt(a))})}loadJSON(e,t={},r){this.fire(new qe("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,ai.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,t.validate=t.validate!==!1,this._load(e,t,r)}).catch(()=>{})}loadEmpty(){this.fire(new qe("dataloading",{dataType:"style"})),this._load(bue,{validate:!1})}_load(e,t,r){var n;let a=t.transformStyle?t.transformStyle(r,e):e;if(!(t.validate&&Ug(this,Dr(a)))){this._loaded=!0,this.stylesheet=a;for(let o in a.sources)this.addSource(o,a.sources[o],{validate:!1});a.sprite?this._loadSprite(a.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(a.glyphs),this._createLayers(),this.light=new Ele(this.stylesheet.light),this.map.setTerrain((n=this.stylesheet.terrain)!=null?n:null),this.fire(new qe("data",{dataType:"style"})),this.fire(new qe("style.load"))}}_createLayers(){let e=Xb(this.stylesheet.layers);this.dispatcher.broadcast("SL",e),this._order=e.map(t=>t.id),this._layers={},this._serializedLayers=null;for(let t of e){let r=uy(t);r.setEventedParent(this,{layer:{id:t.id}}),this._layers[t.id]=r}}_loadSprite(e,t=!1,r=void 0){this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController;let n;GN(e,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(a=>{if(this._spriteRequest=null,a)for(let o in a){this._spritesImagesIds[o]=[];let s=this._spritesImagesIds[o]?this._spritesImagesIds[o].filter(l=>!(l in a)):[];for(let l of s)this.imageManager.removeImage(l),this._changedImages[l]=!0;for(let l in a[o]){let u=o==="default"?l:`${o}:${l}`;this._spritesImagesIds[o].push(u),u in this.imageManager.images?this.imageManager.updateImage(u,a[o][l],!1):this.imageManager.addImage(u,a[o][l]),t&&(this._changedImages[u]=!0)}}}).catch(a=>{this._spriteRequest=null,n=a,this.fire(new Mt(n))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),t&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new qe("data",{dataType:"style"})),r&&r(n)})}_unloadSprite(){for(let e of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(e),this._changedImages[e]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new qe("data",{dataType:"style"}))}_validateLayer(e){let t=this.sourceCaches[e.source];if(!t)return;let r=e.sourceLayer;if(!r)return;let n=t.getSource();(n.type==="geojson"||n.vectorLayerIds&&n.vectorLayerIds.indexOf(r)===-1)&&this.fire(new Mt(new Error(`Source layer "${r}" does not exist on source "${n.id}" as specified by style layer "${e.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(let e in this.sourceCaches)if(!this.sourceCaches[e].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(e){let t=this._serializedAllLayers();if(!e||e.length===0)return Object.values(t);let r=[];for(let n of e)t[n]&&r.push(t[n]);return r}_serializedAllLayers(){let e=this._serializedLayers;if(e)return e;e=this._serializedLayers={};let t=Object.keys(this._layers);for(let r of t){let n=this._layers[r];n.type!=="custom"&&(e[r]=n.serialize())}return e}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(let e in this.sourceCaches)if(this.sourceCaches[e].hasTransition())return!0;for(let e in this._layers)if(this._layers[e].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(e){if(!this._loaded)return;let t=this._changed;if(t){let n=Object.keys(this._updatedLayers),a=Object.keys(this._removedLayers);(n.length||a.length)&&this._updateWorkerLayers(n,a);for(let o in this._updatedSources){let s=this._updatedSources[o];if(s==="reload")this._reloadSource(o);else if(s==="clear")this._clearSource(o);else throw new Error(`Invalid action ${s}`)}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(let o in this._updatedPaintProps)this._layers[o].updateTransitions(e);this.light.updateTransitions(e),this._resetUpdates()}let r={};for(let n in this.sourceCaches){let a=this.sourceCaches[n];r[n]=a.used,a.used=!1}for(let n of this._order){let a=this._layers[n];a.recalculate(e,this._availableImages),!a.isHidden(e.zoom)&&a.source&&(this.sourceCaches[a.source].used=!0)}for(let n in r){let a=this.sourceCaches[n];!!r[n]!=!!a.used&&a.fire(new qe("data",{sourceDataType:"visibility",dataType:"source",sourceId:n}))}this.light.recalculate(e),this.z=e.zoom,t&&this.fire(new qe("data",{dataType:"style"}))}_updateTilesForChangedImages(){let e=Object.keys(this._changedImages);if(e.length){for(let t in this.sourceCaches)this.sourceCaches[t].reloadTilesForDependencies(["icons","patterns"],e);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(let e in this.sourceCaches)this.sourceCaches[e].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(e,t){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(e),removedIds:t})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(e,t={}){var r;this._checkLoaded();let n=this.serialize();if(e=t.transformStyle?t.transformStyle(n,e):e,((r=t.validate)!=null?r:!0)&&Ug(this,Dr(e)))return!1;e=oa(e),e.layers=Xb(e.layers);let a=LL(n,e),o=this._getOperationsToPerform(a);if(o.unimplemented.length>0)throw new Error(`Unimplemented: ${o.unimplemented.join(", ")}.`);if(o.operations.length===0)return!1;for(let s of o.operations)s();return this.stylesheet=e,this._serializedLayers=null,!0}_getOperationsToPerform(e){let t=[],r=[];for(let n of e)switch(n.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":continue;case"addLayer":t.push(()=>this.addLayer.apply(this,n.args));break;case"removeLayer":t.push(()=>this.removeLayer.apply(this,n.args));break;case"setPaintProperty":t.push(()=>this.setPaintProperty.apply(this,n.args));break;case"setLayoutProperty":t.push(()=>this.setLayoutProperty.apply(this,n.args));break;case"setFilter":t.push(()=>this.setFilter.apply(this,n.args));break;case"addSource":t.push(()=>this.addSource.apply(this,n.args));break;case"removeSource":t.push(()=>this.removeSource.apply(this,n.args));break;case"setLayerZoomRange":t.push(()=>this.setLayerZoomRange.apply(this,n.args));break;case"setLight":t.push(()=>this.setLight.apply(this,n.args));break;case"setGeoJSONSourceData":t.push(()=>this.setGeoJSONSourceData.apply(this,n.args));break;case"setGlyphs":t.push(()=>this.setGlyphs.apply(this,n.args));break;case"setSprite":t.push(()=>this.setSprite.apply(this,n.args));break;case"setTerrain":t.push(()=>this.map.setTerrain.apply(this,n.args));break;case"setTransition":t.push(()=>{});break;default:r.push(n.command);break}return{operations:t,unimplemented:r}}addImage(e,t){if(this.getImage(e))return this.fire(new Mt(new Error(`An image named "${e}" already exists.`)));this.imageManager.addImage(e,t),this._afterImageUpdated(e)}updateImage(e,t){this.imageManager.updateImage(e,t)}getImage(e){return this.imageManager.getImage(e)}removeImage(e){if(!this.getImage(e))return this.fire(new Mt(new Error(`An image named "${e}" does not exist.`)));this.imageManager.removeImage(e),this._afterImageUpdated(e)}_afterImageUpdated(e){this._availableImages=this.imageManager.listImages(),this._changedImages[e]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new qe("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(e,t,r={}){if(this._checkLoaded(),this.sourceCaches[e]!==void 0)throw new Error(`Source "${e}" already exists.`);if(!t.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(t).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(t.type)>=0&&this._validate(Dr.source,`sources.${e}`,t,null,r))return;this.map&&this.map._collectResourceTiming&&(t.collectResourceTiming=!0);let n=this.sourceCaches[e]=new Sm(e,t,this.dispatcher);n.style=this,n.setEventedParent(this,()=>({isSourceLoaded:n.loaded(),source:n.serialize(),sourceId:e})),n.onAdd(this.map),this._changed=!0}removeSource(e){if(this._checkLoaded(),this.sourceCaches[e]===void 0)throw new Error("There is no source with this ID");for(let r in this._layers)if(this._layers[r].source===e)return this.fire(new Mt(new Error(`Source "${e}" cannot be removed while layer "${r}" is using it.`)));let t=this.sourceCaches[e];delete this.sourceCaches[e],delete this._updatedSources[e],t.fire(new qe("data",{sourceDataType:"metadata",dataType:"source",sourceId:e})),t.setEventedParent(null),t.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(e,t){if(this._checkLoaded(),this.sourceCaches[e]===void 0)throw new Error(`There is no source with this ID=${e}`);let r=this.sourceCaches[e].getSource();if(r.type!=="geojson")throw new Error(`geojsonSource.type is ${r.type}, which is !== 'geojson`);r.setData(t),this._changed=!0}getSource(e){return this.sourceCaches[e]&&this.sourceCaches[e].getSource()}addLayer(e,t,r={}){this._checkLoaded();let n=e.id;if(this.getLayer(n)){this.fire(new Mt(new Error(`Layer "${n}" already exists on this map.`)));return}let a;if(e.type==="custom"){if(Ug(this,jN(e)))return;a=uy(e)}else{if("source"in e&&typeof e.source=="object"&&(this.addSource(n,e.source),e=oa(e),e=ht(e,{source:n})),this._validate(Dr.layer,`layers.${n}`,e,{arrayIndex:-1},r))return;a=uy(e),this._validateLayer(a),a.setEventedParent(this,{layer:{id:n}})}let o=t?this._order.indexOf(t):this._order.length;if(t&&o===-1){this.fire(new Mt(new Error(`Cannot add layer "${n}" before non-existing layer "${t}".`)));return}if(this._order.splice(o,0,n),this._layerOrderChanged=!0,this._layers[n]=a,this._removedLayers[n]&&a.source&&a.type!=="custom"){let s=this._removedLayers[n];delete this._removedLayers[n],s.type!==a.type?this._updatedSources[a.source]="clear":(this._updatedSources[a.source]="reload",this.sourceCaches[a.source].pause())}this._updateLayer(a),a.onAdd&&a.onAdd(this.map)}moveLayer(e,t){if(this._checkLoaded(),this._changed=!0,!this._layers[e]){this.fire(new Mt(new Error(`The layer '${e}' does not exist in the map's style and cannot be moved.`)));return}if(e===t)return;let r=this._order.indexOf(e);this._order.splice(r,1);let n=t?this._order.indexOf(t):this._order.length;if(t&&n===-1){this.fire(new Mt(new Error(`Cannot move layer "${e}" before non-existing layer "${t}".`)));return}this._order.splice(n,0,e),this._layerOrderChanged=!0}removeLayer(e){this._checkLoaded();let t=this._layers[e];if(!t){this.fire(new Mt(new Error(`Cannot remove non-existing layer "${e}".`)));return}t.setEventedParent(null);let r=this._order.indexOf(e);this._order.splice(r,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[e]=t,delete this._layers[e],this._serializedLayers&&delete this._serializedLayers[e],delete this._updatedLayers[e],delete this._updatedPaintProps[e],t.onRemove&&t.onRemove(this.map)}getLayer(e){return this._layers[e]}getLayersOrder(){return[...this._order]}hasLayer(e){return e in this._layers}setLayerZoomRange(e,t,r){this._checkLoaded();let n=this.getLayer(e);if(!n){this.fire(new Mt(new Error(`Cannot set the zoom range of non-existing layer "${e}".`)));return}n.minzoom===t&&n.maxzoom===r||(t!=null&&(n.minzoom=t),r!=null&&(n.maxzoom=r),this._updateLayer(n))}setFilter(e,t,r={}){this._checkLoaded();let n=this.getLayer(e);if(!n){this.fire(new Mt(new Error(`Cannot filter non-existing layer "${e}".`)));return}if(!ml(n.filter,t)){if(t==null){n.filter=void 0,this._updateLayer(n);return}this._validate(Dr.filter,`layers.${n.id}.filter`,t,null,r)||(n.filter=oa(t),this._updateLayer(n))}}getFilter(e){return oa(this.getLayer(e).filter)}setLayoutProperty(e,t,r,n={}){this._checkLoaded();let a=this.getLayer(e);if(!a){this.fire(new Mt(new Error(`Cannot style non-existing layer "${e}".`)));return}ml(a.getLayoutProperty(t),r)||(a.setLayoutProperty(t,r,n),this._updateLayer(a))}getLayoutProperty(e,t){let r=this.getLayer(e);if(!r){this.fire(new Mt(new Error(`Cannot get style of non-existing layer "${e}".`)));return}return r.getLayoutProperty(t)}setPaintProperty(e,t,r,n={}){this._checkLoaded();let a=this.getLayer(e);if(!a){this.fire(new Mt(new Error(`Cannot style non-existing layer "${e}".`)));return}ml(a.getPaintProperty(t),r)||(a.setPaintProperty(t,r,n)&&this._updateLayer(a),this._changed=!0,this._updatedPaintProps[e]=!0,this._serializedLayers=null)}getPaintProperty(e,t){return this.getLayer(e).getPaintProperty(t)}setFeatureState(e,t){this._checkLoaded();let r=e.source,n=e.sourceLayer,a=this.sourceCaches[r];if(a===void 0){this.fire(new Mt(new Error(`The source '${r}' does not exist in the map's style.`)));return}let o=a.getSource().type;if(o==="geojson"&&n){this.fire(new Mt(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));return}if(o==="vector"&&!n){this.fire(new Mt(new Error("The sourceLayer parameter must be provided for vector source types.")));return}e.id===void 0&&this.fire(new Mt(new Error("The feature id parameter must be provided."))),a.setFeatureState(n,e.id,t)}removeFeatureState(e,t){this._checkLoaded();let r=e.source,n=this.sourceCaches[r];if(n===void 0){this.fire(new Mt(new Error(`The source '${r}' does not exist in the map's style.`)));return}let a=n.getSource().type,o=a==="vector"?e.sourceLayer:void 0;if(a==="vector"&&!o){this.fire(new Mt(new Error("The sourceLayer parameter must be provided for vector source types.")));return}if(t&&typeof e.id!="string"&&typeof e.id!="number"){this.fire(new Mt(new Error("A feature id is required to remove its specific state property.")));return}n.removeFeatureState(o,e.id,t)}getFeatureState(e){this._checkLoaded();let t=e.source,r=e.sourceLayer,n=this.sourceCaches[t];if(n===void 0){this.fire(new Mt(new Error(`The source '${t}' does not exist in the map's style.`)));return}if(n.getSource().type==="vector"&&!r){this.fire(new Mt(new Error("The sourceLayer parameter must be provided for vector source types.")));return}return e.id===void 0&&this.fire(new Mt(new Error("The feature id parameter must be provided."))),n.getFeatureState(r,e.id)}getTransition(){return ht({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;let e=tx(this.sourceCaches,a=>a.serialize()),t=this._serializeByIds(this._order),r=this.map.getTerrain()||void 0,n=this.stylesheet;return DC({version:n.version,name:n.name,metadata:n.metadata,light:n.light,center:n.center,zoom:n.zoom,bearing:n.bearing,pitch:n.pitch,sprite:n.sprite,glyphs:n.glyphs,transition:n.transition,sources:e,layers:t,terrain:r},a=>a!==void 0)}_updateLayer(e){this._updatedLayers[e.id]=!0,e.source&&!this._updatedSources[e.source]&&this.sourceCaches[e.source].getSource().type!=="raster"&&(this._updatedSources[e.source]="reload",this.sourceCaches[e.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(e){let t=h(o=>this._layers[o].type==="fill-extrusion","isLayer3D"),r={},n=[];for(let o=this._order.length-1;o>=0;o--){let s=this._order[o];if(t(s)){r[s]=o;for(let l of e){let u=l[s];if(u)for(let c of u)n.push(c)}}}n.sort((o,s)=>s.intersectionZ-o.intersectionZ);let a=[];for(let o=this._order.length-1;o>=0;o--){let s=this._order[o];if(t(s))for(let l=n.length-1;l>=0;l--){let u=n[l].feature;if(r[u.layer.id]<o)break;a.push(u),n.pop()}else for(let l of e){let u=l[s];if(u)for(let c of u)a.push(c.feature)}}return a}queryRenderedFeatures(e,t,r){t&&t.filter&&this._validate(Dr.filter,"queryRenderedFeatures.filter",t.filter,null,t);let n={};if(t&&t.layers){if(!Array.isArray(t.layers))return this.fire(new Mt(new Error("parameters.layers must be an Array."))),[];for(let s of t.layers){let l=this._layers[s];if(!l)return this.fire(new Mt(new Error(`The layer '${s}' does not exist in the map's style and cannot be queried for features.`))),[];n[l.source]=!0}}let a=[];t.availableImages=this._availableImages;let o=this._serializedAllLayers();for(let s in this.sourceCaches)t.layers&&!n[s]||a.push(h$(this.sourceCaches[s],this._layers,o,e,t,r));return this.placement&&a.push(c$(this._layers,o,this.sourceCaches,e,t,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(a)}querySourceFeatures(e,t){t&&t.filter&&this._validate(Dr.filter,"querySourceFeatures.filter",t.filter,null,t);let r=this.sourceCaches[e];return r?p$(r,t):[]}getLight(){return this.light.getLight()}setLight(e,t={}){this._checkLoaded();let r=this.light.getLight(),n=!1;for(let o in e)if(!ml(e[o],r[o])){n=!0;break}if(!n)return;let a={now:ai.now(),transition:ht({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(e,t),this.light.updateTransitions(a)}_validate(e,t,r,n,a={}){return a&&a.validate===!1?!1:Ug(this,e.call(Dr,ht({key:t,style:this.serialize(),value:r,styleSpec:Le},n)))}_remove(e=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),Bp().off(Gw,this._rtlPluginLoaded);for(let t in this._layers)this._layers[t].setEventedParent(null);for(let t in this.sourceCaches){let r=this.sourceCaches[t];r.setEventedParent(null),r.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),e&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(e)}_clearSource(e){this.sourceCaches[e].clearTiles()}_reloadSource(e){this.sourceCaches[e].resume(),this.sourceCaches[e].reload()}_updateSources(e){for(let t in this.sourceCaches)this.sourceCaches[t].update(e,this.map.terrain)}_generateCollisionBoxes(){for(let e in this.sourceCaches)this._reloadSource(e)}_updatePlacement(e,t,r,n,a=!1){let o=!1,s=!1,l={};for(let u of this._order){let c=this._layers[u];if(c.type!=="symbol")continue;if(!l[c.source]){let d=this.sourceCaches[c.source];l[c.source]=d.getRenderableIds(!0).map(m=>d.getTileByID(m)).sort((m,g)=>g.tileID.overscaledZ-m.tileID.overscaledZ||(m.tileID.isLessThan(g.tileID)?-1:1))}let p=this.crossTileSymbolIndex.addLayer(c,l[c.source],e.center.lng);o=o||p}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),a=a||this._layerOrderChanged||r===0,(a||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(ai.now(),e.zoom))&&(this.pauseablePlacement=new mue(e,this.map.terrain,this._order,a,t,r,n,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,l),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(ai.now()),s=!0),o&&this.pauseablePlacement.placement.setStale()),s||o)for(let u of this._order){let c=this._layers[u];c.type==="symbol"&&this.placement.updateLayerOpacities(c,l[c.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(ai.now())}_releaseSymbolFadeTiles(){for(let e in this.sourceCaches)this.sourceCaches[e].releaseSymbolFadeTiles()}async getImages(e,t){let r=await this.imageManager.getImages(t.icons);this._updateTilesForChangedImages();let n=this.sourceCaches[t.source];return n&&n.setDependencies(t.tileID.key,t.type,t.icons),r}async getGlyphs(e,t){let r=await this.glyphManager.getGlyphs(t.stacks),n=this.sourceCaches[t.source];return n&&n.setDependencies(t.tileID.key,t.type,[""]),r}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(e,t={}){this._checkLoaded(),!(e&&this._validate(Dr.glyphs,"glyphs",e,null,t))&&(this._glyphsDidChange=!0,this.stylesheet.glyphs=e,this.glyphManager.entries={},this.glyphManager.setURL(e))}addSprite(e,t,r={},n){this._checkLoaded();let a=[{id:e,url:t}],o=[...Gf(this.stylesheet.sprite),...a];this._validate(Dr.sprite,"sprite",o,null,r)||(this.stylesheet.sprite=o,this._loadSprite(a,!0,n))}removeSprite(e){this._checkLoaded();let t=Gf(this.stylesheet.sprite);if(!t.find(r=>r.id===e)){this.fire(new Mt(new Error(`Sprite "${e}" doesn't exists on this map.`)));return}if(this._spritesImagesIds[e])for(let r of this._spritesImagesIds[e])this.imageManager.removeImage(r),this._changedImages[r]=!0;t.splice(t.findIndex(r=>r.id===e),1),this.stylesheet.sprite=t.length>0?t:void 0,delete this._spritesImagesIds[e],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new qe("data",{dataType:"style"}))}getSprite(){return Gf(this.stylesheet.sprite)}setSprite(e,t={},r){this._checkLoaded(),!(e&&this._validate(Dr.sprite,"sprite",e,null,t))&&(this.stylesheet.sprite=e,e?this._loadSprite(e,!0,r):(this._unloadSprite(),r&&r(null)))}};h(CU,"Style");var sA=CU;R();R();var G_=Xi([{name:"a_pos",type:"Int16",components:2}]);R();R();var wue=`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
`;R();var Sue=`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`;R();var Mue=`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;R();var Cue="attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}";R();var Eue=`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;R();var Tue="uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}";R();var Pue=`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;R();var Aue=`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`;R();var Iue="void main() {gl_FragColor=vec4(1.0);}";R();var Lue="attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}";R();var Due=`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;R();var kue=`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`;R();var Rue=`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`;R();var Fue="uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}";R();var zue="varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}";R();var Bue="attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}";R();var Oue="varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}";R();var Nue="attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}";R();var $ue="uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}";R();var Uue="attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}";R();var Vue=`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;R();var jue=`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`;R();var Hue=`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;R();var Gue=`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`;R();var Wue=`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;R();var Xue=`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`;R();var que=`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;R();var Zue=`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`;R();var Yue=`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;R();var Jue=`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`;R();var Kue=`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;R();var Que=`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`;R();var ehe=`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;R();var the="uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}";R();var ihe=`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;R();var rhe="uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}";R();var nhe=`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;R();var ahe=`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`;R();var ohe=`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;R();var she=`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`;R();var lhe=`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;R();var uhe=`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`;R();var hhe=`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;R();var che=`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`;R();var phe=`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;R();var dhe="uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}";R();var fhe=`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;R();var mhe=`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),z,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`;R();var ghe=`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;R();var yhe=`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`;R();var vhe=`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;R();var xhe=`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`;R();var _he="varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}";R();var bhe="precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}";R();var whe="uniform sampler2D u_texture;varying vec2 v_texture_pos;void main() {gl_FragColor=texture2D(u_texture,v_texture_pos);}";R();var W_="attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_depth;void main() {float extent=8192.0;float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/extent;gl_Position=u_matrix*vec4(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}",tf={prelude:gi(wue,Sue),background:gi(Mue,Cue),backgroundPattern:gi(Eue,Tue),circle:gi(Pue,Aue),clippingMask:gi(Iue,Lue),heatmap:gi(Due,kue),heatmapTexture:gi(Rue,Fue),collisionBox:gi(zue,Bue),collisionCircle:gi(Oue,Nue),debug:gi($ue,Uue),fill:gi(Vue,jue),fillOutline:gi(Hue,Gue),fillOutlinePattern:gi(Wue,Xue),fillPattern:gi(que,Zue),fillExtrusion:gi(Yue,Jue),fillExtrusionPattern:gi(Kue,Que),hillshadePrepare:gi(ehe,the),hillshade:gi(ihe,rhe),line:gi(nhe,ahe),lineGradient:gi(ohe,she),linePattern:gi(lhe,uhe),lineSDF:gi(hhe,che),raster:gi(phe,dhe),symbolIcon:gi(fhe,mhe),symbolSDF:gi(ghe,yhe),symbolTextAndIcon:gi(vhe,xhe),terrain:gi(whe,W_),terrainDepth:gi(_he,W_),terrainCoords:gi(bhe,W_)};function gi(i,e){let t=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,r=e.match(/attribute ([\w]+) ([\w]+)/g),n=i.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),a=e.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),o=a?a.concat(n):n,s={};return i=i.replace(t,(l,u,c,p,d)=>(s[d]=!0,u==="define"?`
#ifndef HAS_UNIFORM_u_${d}
varying ${c} ${p} ${d};
#else
uniform ${c} ${p} u_${d};
#endif
`:`
#ifdef HAS_UNIFORM_u_${d}
    ${c} ${p} ${d} = u_${d};
#endif
`)),e=e.replace(t,(l,u,c,p,d)=>{let m=p==="float"?"vec2":"vec4",g=d.match(/color/)?"color":m;return s[d]?u==="define"?`
#ifndef HAS_UNIFORM_u_${d}
uniform lowp float u_${d}_t;
attribute ${c} ${m} a_${d};
varying ${c} ${p} ${d};
#else
uniform ${c} ${p} u_${d};
#endif
`:g==="vec4"?`
#ifndef HAS_UNIFORM_u_${d}
    ${d} = a_${d};
#else
    ${c} ${p} ${d} = u_${d};
#endif
`:`
#ifndef HAS_UNIFORM_u_${d}
    ${d} = unpack_mix_${g}(a_${d}, u_${d}_t);
#else
    ${c} ${p} ${d} = u_${d};
#endif
`:u==="define"?`
#ifndef HAS_UNIFORM_u_${d}
uniform lowp float u_${d}_t;
attribute ${c} ${m} a_${d};
#else
uniform ${c} ${p} u_${d};
#endif
`:g==="vec4"?`
#ifndef HAS_UNIFORM_u_${d}
    ${c} ${p} ${d} = a_${d};
#else
    ${c} ${p} ${d} = u_${d};
#endif
`:`
#ifndef HAS_UNIFORM_u_${d}
    ${c} ${p} ${d} = unpack_mix_${g}(a_${d}, u_${d}_t);
#else
    ${c} ${p} ${d} = u_${d};
#endif
`}),{fragmentSource:i,vertexSource:e,staticAttributes:r,staticUniforms:o}}h(gi,"compile");R();R();var EU=class{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(e,t,r,n,a,o,s,l,u){this.context=e;let c=this.boundPaintVertexBuffers.length!==n.length;for(let p=0;!c&&p<n.length;p++)this.boundPaintVertexBuffers[p]!==n[p]&&(c=!0);!this.vao||this.boundProgram!==t||this.boundLayoutVertexBuffer!==r||c||this.boundIndexBuffer!==a||this.boundVertexOffset!==o||this.boundDynamicVertexBuffer!==s||this.boundDynamicVertexBuffer2!==l||this.boundDynamicVertexBuffer3!==u?this.freshBind(t,r,n,a,o,s,l,u):(e.bindVertexArray.set(this.vao),s&&s.bind(),a&&a.dynamicDraw&&a.bind(),l&&l.bind(),u&&u.bind())}freshBind(e,t,r,n,a,o,s,l){let u=e.numAttributes,c=this.context,p=c.gl;this.vao&&this.destroy(),this.vao=c.createVertexArray(),c.bindVertexArray.set(this.vao),this.boundProgram=e,this.boundLayoutVertexBuffer=t,this.boundPaintVertexBuffers=r,this.boundIndexBuffer=n,this.boundVertexOffset=a,this.boundDynamicVertexBuffer=o,this.boundDynamicVertexBuffer2=s,this.boundDynamicVertexBuffer3=l,t.enableAttributes(p,e);for(let d of r)d.enableAttributes(p,e);o&&o.enableAttributes(p,e),s&&s.enableAttributes(p,e),l&&l.enableAttributes(p,e),t.bind(),t.setVertexAttribPointers(p,e,a);for(let d of r)d.bind(),d.setVertexAttribPointers(p,e,a);o&&(o.bind(),o.setVertexAttribPointers(p,e,a)),n&&n.bind(),s&&(s.bind(),s.setVertexAttribPointers(p,e,a)),l&&(l.bind(),l.setVertexAttribPointers(p,e,a)),c.currentNumAttributes=u}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}};h(EU,"VertexArrayObject");var She=EU;R();var Mhe=h((i,e)=>({u_depth:new Zt(i,e.u_depth),u_terrain:new Zt(i,e.u_terrain),u_terrain_dim:new nt(i,e.u_terrain_dim),u_terrain_matrix:new oi(i,e.u_terrain_matrix),u_terrain_unpack:new G4(i,e.u_terrain_unpack),u_terrain_exaggeration:new nt(i,e.u_terrain_exaggeration)}),"terrainPreludeUniforms"),Che=h((i,e)=>({u_matrix:new oi(i,e.u_matrix),u_texture:new Zt(i,e.u_texture),u_ele_delta:new nt(i,e.u_ele_delta)}),"terrainUniforms"),Ehe=h((i,e)=>({u_matrix:new oi(i,e.u_matrix),u_ele_delta:new nt(i,e.u_ele_delta)}),"terrainDepthUniforms"),The=h((i,e)=>({u_matrix:new oi(i,e.u_matrix),u_texture:new Zt(i,e.u_texture),u_terrain_coords_id:new nt(i,e.u_terrain_coords_id),u_ele_delta:new nt(i,e.u_ele_delta)}),"terrainCoordsUniforms"),Phe=h((i,e)=>({u_matrix:i,u_texture:0,u_ele_delta:e}),"terrainUniformValues"),Ahe=h((i,e)=>({u_matrix:i,u_ele_delta:e}),"terrainDepthUniformValues"),Ihe=h((i,e,t)=>({u_matrix:i,u_terrain_coords_id:e/255,u_texture:0,u_ele_delta:t}),"terrainCoordsUniformValues");function dy(i){let e=[];for(let t=0;t<i.length;t++){if(i[t]===null)continue;let r=i[t].split(" ");e.push(r.pop())}return e}h(dy,"getTokenizedAttributesAndUniforms");var TU=class{constructor(e,t,r,n,a,o){let s=e.gl;this.program=s.createProgram();let l=dy(t.staticAttributes),u=r?r.getBinderAttributes():[],c=l.concat(u),p=tf.prelude.staticUniforms?dy(tf.prelude.staticUniforms):[],d=t.staticUniforms?dy(t.staticUniforms):[],m=r?r.getBinderUniforms():[],g=p.concat(d).concat(m),b=[];for(let T of g)b.indexOf(T)<0&&b.push(T);let x=r?r.defines():[];a&&x.push("#define OVERDRAW_INSPECTOR;"),o&&x.push("#define TERRAIN3D;");let v=x.concat(tf.prelude.fragmentSource,t.fragmentSource).join(`
`),w=x.concat(tf.prelude.vertexSource,t.vertexSource).join(`
`),_=s.createShader(s.FRAGMENT_SHADER);if(s.isContextLost()){this.failedToCreate=!0;return}if(s.shaderSource(_,v),s.compileShader(_),!s.getShaderParameter(_,s.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${s.getShaderInfoLog(_)}`);s.attachShader(this.program,_);let C=s.createShader(s.VERTEX_SHADER);if(s.isContextLost()){this.failedToCreate=!0;return}if(s.shaderSource(C,w),s.compileShader(C),!s.getShaderParameter(C,s.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${s.getShaderInfoLog(C)}`);s.attachShader(this.program,C),this.attributes={};let E={};this.numAttributes=c.length;for(let T=0;T<this.numAttributes;T++)c[T]&&(s.bindAttribLocation(this.program,T,c[T]),this.attributes[c[T]]=T);if(s.linkProgram(this.program),!s.getProgramParameter(this.program,s.LINK_STATUS))throw new Error(`Program failed to link: ${s.getProgramInfoLog(this.program)}`);s.deleteShader(C),s.deleteShader(_);for(let T=0;T<b.length;T++){let L=b[T];if(L&&!E[L]){let D=s.getUniformLocation(this.program,L);D&&(E[L]=D)}}this.fixedUniforms=n(e,E),this.terrainUniforms=Mhe(e,E),this.binderUniforms=r?r.getUniforms(e,E):[]}draw(e,t,r,n,a,o,s,l,u,c,p,d,m,g,b,x,v,w){let _=e.gl;if(this.failedToCreate)return;if(e.program.set(this.program),e.setDepthMode(r),e.setStencilMode(n),e.setColorMode(a),e.setCullFace(o),l){e.activeTexture.set(_.TEXTURE2),_.bindTexture(_.TEXTURE_2D,l.depthTexture),e.activeTexture.set(_.TEXTURE3),_.bindTexture(_.TEXTURE_2D,l.texture);for(let E in this.terrainUniforms)this.terrainUniforms[E].set(l[E])}for(let E in this.fixedUniforms)this.fixedUniforms[E].set(s[E]);b&&b.setUniforms(e,this.binderUniforms,m,{zoom:g});let C=0;switch(t){case _.LINES:C=2;break;case _.TRIANGLES:C=3;break;case _.LINE_STRIP:C=1;break}for(let E of d.get()){let T=E.vaos||(E.vaos={});(T[u]||(T[u]=new She)).bind(e,this,c,b?b.getPaintVertexBuffers():[],p,E.vertexOffset,x,v,w),_.drawElements(t,E.primitiveLength*C,_.UNSIGNED_SHORT,E.primitiveOffset*C*2)}}};h(TU,"Program");var Lhe=TU;R();R();R();function Q5(i,e,t){let r=1/qn(t,1,e.transform.tileZoom),n=Math.pow(2,t.tileID.overscaledZ),a=t.tileSize*Math.pow(2,e.transform.tileZoom)/n,o=a*(t.tileID.canonical.x+t.tileID.wrap*n),s=a*t.tileID.canonical.y;return{u_image:0,u_texsize:t.imageAtlasTexture.size,u_scale:[r,i.fromScale,i.toScale],u_fade:i.t,u_pixel_coord_upper:[o>>16,s>>16],u_pixel_coord_lower:[o&65535,s&65535]}}h(Q5,"patternUniformValues");function PU(i,e,t,r){let n=t.imageManager.getPattern(i.from.toString()),a=t.imageManager.getPattern(i.to.toString()),{width:o,height:s}=t.imageManager.getPixelSize(),l=Math.pow(2,r.tileID.overscaledZ),u=r.tileSize*Math.pow(2,t.transform.tileZoom)/l,c=u*(r.tileID.canonical.x+r.tileID.wrap*l),p=u*r.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:n.tl,u_pattern_br_a:n.br,u_pattern_tl_b:a.tl,u_pattern_br_b:a.br,u_texsize:[o,s],u_mix:e.t,u_pattern_size_a:n.displaySize,u_pattern_size_b:a.displaySize,u_scale_a:e.fromScale,u_scale_b:e.toScale,u_tile_units_to_pixels:1/qn(r,1,t.transform.tileZoom),u_pixel_coord_upper:[c>>16,p>>16],u_pixel_coord_lower:[c&65535,p&65535]}}h(PU,"bgPatternUniformValues");var Dhe=h((i,e)=>({u_matrix:new oi(i,e.u_matrix),u_lightpos:new Es(i,e.u_lightpos),u_lightintensity:new nt(i,e.u_lightintensity),u_lightcolor:new Es(i,e.u_lightcolor),u_vertical_gradient:new nt(i,e.u_vertical_gradient),u_opacity:new nt(i,e.u_opacity)}),"fillExtrusionUniforms"),khe=h((i,e)=>({u_matrix:new oi(i,e.u_matrix),u_lightpos:new Es(i,e.u_lightpos),u_lightintensity:new nt(i,e.u_lightintensity),u_lightcolor:new Es(i,e.u_lightcolor),u_vertical_gradient:new nt(i,e.u_vertical_gradient),u_height_factor:new nt(i,e.u_height_factor),u_image:new Zt(i,e.u_image),u_texsize:new Qt(i,e.u_texsize),u_pixel_coord_upper:new Qt(i,e.u_pixel_coord_upper),u_pixel_coord_lower:new Qt(i,e.u_pixel_coord_lower),u_scale:new Es(i,e.u_scale),u_fade:new nt(i,e.u_fade),u_opacity:new nt(i,e.u_opacity)}),"fillExtrusionPatternUniforms"),AU=h((i,e,t,r)=>{let n=e.style.light,a=n.properties.get("position"),o=[a.x,a.y,a.z],s=Iw.create();n.properties.get("anchor")==="viewport"&&Iw.fromRotation(s,-e.transform.angle),uo.transformMat3(o,o,s);let l=n.properties.get("color");return{u_matrix:i,u_lightpos:o,u_lightintensity:n.properties.get("intensity"),u_lightcolor:[l.r,l.g,l.b],u_vertical_gradient:+t,u_opacity:r}},"fillExtrusionUniformValues"),Rhe=h((i,e,t,r,n,a,o)=>ht(AU(i,e,t,r),Q5(a,e,o),{u_height_factor:-Math.pow(2,n.overscaledZ)/o.tileSize/8}),"fillExtrusionPatternUniformValues");R();var Fhe=h((i,e)=>({u_matrix:new oi(i,e.u_matrix)}),"fillUniforms"),zhe=h((i,e)=>({u_matrix:new oi(i,e.u_matrix),u_image:new Zt(i,e.u_image),u_texsize:new Qt(i,e.u_texsize),u_pixel_coord_upper:new Qt(i,e.u_pixel_coord_upper),u_pixel_coord_lower:new Qt(i,e.u_pixel_coord_lower),u_scale:new Es(i,e.u_scale),u_fade:new nt(i,e.u_fade)}),"fillPatternUniforms"),Bhe=h((i,e)=>({u_matrix:new oi(i,e.u_matrix),u_world:new Qt(i,e.u_world)}),"fillOutlineUniforms"),Ohe=h((i,e)=>({u_matrix:new oi(i,e.u_matrix),u_world:new Qt(i,e.u_world),u_image:new Zt(i,e.u_image),u_texsize:new Qt(i,e.u_texsize),u_pixel_coord_upper:new Qt(i,e.u_pixel_coord_upper),u_pixel_coord_lower:new Qt(i,e.u_pixel_coord_lower),u_scale:new Es(i,e.u_scale),u_fade:new nt(i,e.u_fade)}),"fillOutlinePatternUniforms"),IU=h(i=>({u_matrix:i}),"fillUniformValues"),LU=h((i,e,t,r)=>ht(IU(i),Q5(t,e,r)),"fillPatternUniformValues"),Nhe=h((i,e)=>({u_matrix:i,u_world:e}),"fillOutlineUniformValues"),$he=h((i,e,t,r,n)=>ht(LU(i,e,t,r),{u_world:n}),"fillOutlinePatternUniformValues");R();var Uhe=h((i,e)=>({u_camera_to_center_distance:new nt(i,e.u_camera_to_center_distance),u_scale_with_map:new Zt(i,e.u_scale_with_map),u_pitch_with_map:new Zt(i,e.u_pitch_with_map),u_extrude_scale:new Qt(i,e.u_extrude_scale),u_device_pixel_ratio:new nt(i,e.u_device_pixel_ratio),u_matrix:new oi(i,e.u_matrix)}),"circleUniforms"),Vhe=h((i,e,t,r)=>{let n=i.transform,a,o;if(r.paint.get("circle-pitch-alignment")==="map"){let s=qn(t,1,n.zoom);a=!0,o=[s,s]}else a=!1,o=n.pixelsToGLUnits;return{u_camera_to_center_distance:n.cameraToCenterDistance,u_scale_with_map:+(r.paint.get("circle-pitch-scale")==="map"),u_matrix:i.translatePosMatrix(e.posMatrix,t,r.paint.get("circle-translate"),r.paint.get("circle-translate-anchor")),u_pitch_with_map:+a,u_device_pixel_ratio:i.pixelRatio,u_extrude_scale:o}},"circleUniformValues");R();var jhe=h((i,e)=>({u_matrix:new oi(i,e.u_matrix),u_camera_to_center_distance:new nt(i,e.u_camera_to_center_distance),u_pixels_to_tile_units:new nt(i,e.u_pixels_to_tile_units),u_extrude_scale:new Qt(i,e.u_extrude_scale),u_overscale_factor:new nt(i,e.u_overscale_factor)}),"collisionUniforms"),Hhe=h((i,e)=>({u_matrix:new oi(i,e.u_matrix),u_inv_matrix:new oi(i,e.u_inv_matrix),u_camera_to_center_distance:new nt(i,e.u_camera_to_center_distance),u_viewport_size:new Qt(i,e.u_viewport_size)}),"collisionCircleUniforms"),Ghe=h((i,e,t)=>{let r=qn(t,1,e.zoom),n=Math.pow(2,e.zoom-t.tileID.overscaledZ),a=t.tileID.overscaleFactor();return{u_matrix:i,u_camera_to_center_distance:e.cameraToCenterDistance,u_pixels_to_tile_units:r,u_extrude_scale:[e.pixelsToGLUnits[0]/(r*n),e.pixelsToGLUnits[1]/(r*n)],u_overscale_factor:a}},"collisionUniformValues"),Whe=h((i,e,t)=>({u_matrix:i,u_inv_matrix:e,u_camera_to_center_distance:t.cameraToCenterDistance,u_viewport_size:[t.width,t.height]}),"collisionCircleUniformValues");R();var Xhe=h((i,e)=>({u_color:new up(i,e.u_color),u_matrix:new oi(i,e.u_matrix),u_overlay:new Zt(i,e.u_overlay),u_overlay_scale:new nt(i,e.u_overlay_scale)}),"debugUniforms"),lA=h((i,e,t=1)=>({u_matrix:i,u_color:e,u_overlay:0,u_overlay_scale:t}),"debugUniformValues");R();var qhe=h((i,e)=>({u_matrix:new oi(i,e.u_matrix)}),"clippingMaskUniforms"),uA=h(i=>({u_matrix:i}),"clippingMaskUniformValues");R();var Zhe=h((i,e)=>({u_extrude_scale:new nt(i,e.u_extrude_scale),u_intensity:new nt(i,e.u_intensity),u_matrix:new oi(i,e.u_matrix)}),"heatmapUniforms"),Yhe=h((i,e)=>({u_matrix:new oi(i,e.u_matrix),u_world:new Qt(i,e.u_world),u_image:new Zt(i,e.u_image),u_color_ramp:new Zt(i,e.u_color_ramp),u_opacity:new nt(i,e.u_opacity)}),"heatmapTextureUniforms"),Jhe=h((i,e,t,r)=>({u_matrix:i,u_extrude_scale:qn(e,1,t),u_intensity:r}),"heatmapUniformValues"),Khe=h((i,e,t,r)=>{let n=lt.create();lt.ortho(n,0,i.width,i.height,0,0,1);let a=i.context.gl;return{u_matrix:n,u_world:[a.drawingBufferWidth,a.drawingBufferHeight],u_image:t,u_color_ramp:r,u_opacity:e.paint.get("heatmap-opacity")}},"heatmapTextureUniformValues");R();var Qhe=h((i,e)=>({u_matrix:new oi(i,e.u_matrix),u_image:new Zt(i,e.u_image),u_latrange:new Qt(i,e.u_latrange),u_light:new Qt(i,e.u_light),u_shadow:new up(i,e.u_shadow),u_highlight:new up(i,e.u_highlight),u_accent:new up(i,e.u_accent)}),"hillshadeUniforms"),ece=h((i,e)=>({u_matrix:new oi(i,e.u_matrix),u_image:new Zt(i,e.u_image),u_dimension:new Qt(i,e.u_dimension),u_zoom:new nt(i,e.u_zoom),u_unpack:new G4(i,e.u_unpack)}),"hillshadePrepareUniforms"),tce=h((i,e,t,r)=>{let n=t.paint.get("hillshade-shadow-color"),a=t.paint.get("hillshade-highlight-color"),o=t.paint.get("hillshade-accent-color"),s=t.paint.get("hillshade-illumination-direction")*(Math.PI/180);t.paint.get("hillshade-illumination-anchor")==="viewport"&&(s-=i.transform.angle);let l=!i.options.moving;return{u_matrix:r?r.posMatrix:i.transform.calculatePosMatrix(e.tileID.toUnwrapped(),l),u_image:0,u_latrange:DU(i,e.tileID),u_light:[t.paint.get("hillshade-exaggeration"),s],u_shadow:n,u_highlight:a,u_accent:o}},"hillshadeUniformValues"),ice=h((i,e)=>{let t=e.stride,r=lt.create();return lt.ortho(r,0,8192,-8192,0,0,1),lt.translate(r,r,[0,-8192,0]),{u_matrix:r,u_image:1,u_dimension:[t,t],u_zoom:i.overscaledZ,u_unpack:e.getUnpackVector()}},"hillshadeUniformPrepareValues");function DU(i,e){let t=Math.pow(2,e.canonical.z),r=e.canonical.y;return[new qr(0,r/t).toLngLat().lat,new qr(0,(r+1)/t).toLngLat().lat]}h(DU,"getTileLatRange");R();var rce=h((i,e)=>({u_matrix:new oi(i,e.u_matrix),u_ratio:new nt(i,e.u_ratio),u_device_pixel_ratio:new nt(i,e.u_device_pixel_ratio),u_units_to_pixels:new Qt(i,e.u_units_to_pixels)}),"lineUniforms"),nce=h((i,e)=>({u_matrix:new oi(i,e.u_matrix),u_ratio:new nt(i,e.u_ratio),u_device_pixel_ratio:new nt(i,e.u_device_pixel_ratio),u_units_to_pixels:new Qt(i,e.u_units_to_pixels),u_image:new Zt(i,e.u_image),u_image_height:new nt(i,e.u_image_height)}),"lineGradientUniforms"),ace=h((i,e)=>({u_matrix:new oi(i,e.u_matrix),u_texsize:new Qt(i,e.u_texsize),u_ratio:new nt(i,e.u_ratio),u_device_pixel_ratio:new nt(i,e.u_device_pixel_ratio),u_image:new Zt(i,e.u_image),u_units_to_pixels:new Qt(i,e.u_units_to_pixels),u_scale:new Es(i,e.u_scale),u_fade:new nt(i,e.u_fade)}),"linePatternUniforms"),oce=h((i,e)=>({u_matrix:new oi(i,e.u_matrix),u_ratio:new nt(i,e.u_ratio),u_device_pixel_ratio:new nt(i,e.u_device_pixel_ratio),u_units_to_pixels:new Qt(i,e.u_units_to_pixels),u_patternscale_a:new Qt(i,e.u_patternscale_a),u_patternscale_b:new Qt(i,e.u_patternscale_b),u_sdfgamma:new nt(i,e.u_sdfgamma),u_image:new Zt(i,e.u_image),u_tex_y_a:new nt(i,e.u_tex_y_a),u_tex_y_b:new nt(i,e.u_tex_y_b),u_mix:new nt(i,e.u_mix)}),"lineSDFUniforms"),eE=h((i,e,t,r)=>{let n=i.transform;return{u_matrix:iE(i,e,t,r),u_ratio:1/qn(e,1,n.zoom),u_device_pixel_ratio:i.pixelRatio,u_units_to_pixels:[1/n.pixelsToGLUnits[0],1/n.pixelsToGLUnits[1]]}},"lineUniformValues"),sce=h((i,e,t,r,n)=>ht(eE(i,e,t,n),{u_image:0,u_image_height:r}),"lineGradientUniformValues"),lce=h((i,e,t,r,n)=>{let a=i.transform,o=tE(e,a);return{u_matrix:iE(i,e,t,n),u_texsize:e.imageAtlasTexture.size,u_ratio:1/qn(e,1,a.zoom),u_device_pixel_ratio:i.pixelRatio,u_image:0,u_scale:[o,r.fromScale,r.toScale],u_fade:r.t,u_units_to_pixels:[1/a.pixelsToGLUnits[0],1/a.pixelsToGLUnits[1]]}},"linePatternUniformValues"),uce=h((i,e,t,r,n,a)=>{let o=i.transform,s=i.lineAtlas,l=tE(e,o),u=t.layout.get("line-cap")==="round",c=s.getDash(r.from,u),p=s.getDash(r.to,u),d=c.width*n.fromScale,m=p.width*n.toScale;return ht(eE(i,e,t,a),{u_patternscale_a:[l/d,-c.height/2],u_patternscale_b:[l/m,-p.height/2],u_sdfgamma:s.width/(Math.min(d,m)*256*i.pixelRatio)/2,u_image:0,u_tex_y_a:c.y,u_tex_y_b:p.y,u_mix:n.t})},"lineSDFUniformValues");function tE(i,e){return 1/qn(i,1,e.tileZoom)}h(tE,"calculateTileRatio");function iE(i,e,t,r){return i.translatePosMatrix(r?r.posMatrix:e.tileID.posMatrix,e,t.paint.get("line-translate"),t.paint.get("line-translate-anchor"))}h(iE,"calculateMatrix");R();var hce=h((i,e)=>({u_matrix:new oi(i,e.u_matrix),u_tl_parent:new Qt(i,e.u_tl_parent),u_scale_parent:new nt(i,e.u_scale_parent),u_buffer_scale:new nt(i,e.u_buffer_scale),u_fade_t:new nt(i,e.u_fade_t),u_opacity:new nt(i,e.u_opacity),u_image0:new Zt(i,e.u_image0),u_image1:new Zt(i,e.u_image1),u_brightness_low:new nt(i,e.u_brightness_low),u_brightness_high:new nt(i,e.u_brightness_high),u_saturation_factor:new nt(i,e.u_saturation_factor),u_contrast_factor:new nt(i,e.u_contrast_factor),u_spin_weights:new Es(i,e.u_spin_weights)}),"rasterUniforms"),cce=h((i,e,t,r,n)=>({u_matrix:i,u_tl_parent:e,u_scale_parent:t,u_buffer_scale:1,u_fade_t:r.mix,u_opacity:r.opacity*n.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:n.paint.get("raster-brightness-min"),u_brightness_high:n.paint.get("raster-brightness-max"),u_saturation_factor:FU(n.paint.get("raster-saturation")),u_contrast_factor:RU(n.paint.get("raster-contrast")),u_spin_weights:kU(n.paint.get("raster-hue-rotate"))}),"rasterUniformValues");function kU(i){i*=Math.PI/180;let e=Math.sin(i),t=Math.cos(i);return[(2*t+1)/3,(-Math.sqrt(3)*e-t+1)/3,(Math.sqrt(3)*e-t+1)/3]}h(kU,"spinWeights");function RU(i){return i>0?1/(1-i):1+i}h(RU,"contrastFactor");function FU(i){return i>0?1-1/(1.001-i):-i}h(FU,"saturationFactor");R();var pce=h((i,e)=>({u_is_size_zoom_constant:new Zt(i,e.u_is_size_zoom_constant),u_is_size_feature_constant:new Zt(i,e.u_is_size_feature_constant),u_size_t:new nt(i,e.u_size_t),u_size:new nt(i,e.u_size),u_camera_to_center_distance:new nt(i,e.u_camera_to_center_distance),u_pitch:new nt(i,e.u_pitch),u_rotate_symbol:new Zt(i,e.u_rotate_symbol),u_aspect_ratio:new nt(i,e.u_aspect_ratio),u_fade_change:new nt(i,e.u_fade_change),u_matrix:new oi(i,e.u_matrix),u_label_plane_matrix:new oi(i,e.u_label_plane_matrix),u_coord_matrix:new oi(i,e.u_coord_matrix),u_is_text:new Zt(i,e.u_is_text),u_pitch_with_map:new Zt(i,e.u_pitch_with_map),u_texsize:new Qt(i,e.u_texsize),u_texture:new Zt(i,e.u_texture)}),"symbolIconUniforms"),dce=h((i,e)=>({u_is_size_zoom_constant:new Zt(i,e.u_is_size_zoom_constant),u_is_size_feature_constant:new Zt(i,e.u_is_size_feature_constant),u_size_t:new nt(i,e.u_size_t),u_size:new nt(i,e.u_size),u_camera_to_center_distance:new nt(i,e.u_camera_to_center_distance),u_pitch:new nt(i,e.u_pitch),u_rotate_symbol:new Zt(i,e.u_rotate_symbol),u_aspect_ratio:new nt(i,e.u_aspect_ratio),u_fade_change:new nt(i,e.u_fade_change),u_matrix:new oi(i,e.u_matrix),u_label_plane_matrix:new oi(i,e.u_label_plane_matrix),u_coord_matrix:new oi(i,e.u_coord_matrix),u_is_text:new Zt(i,e.u_is_text),u_pitch_with_map:new Zt(i,e.u_pitch_with_map),u_texsize:new Qt(i,e.u_texsize),u_texture:new Zt(i,e.u_texture),u_gamma_scale:new nt(i,e.u_gamma_scale),u_device_pixel_ratio:new nt(i,e.u_device_pixel_ratio),u_is_halo:new Zt(i,e.u_is_halo)}),"symbolSDFUniforms"),fce=h((i,e)=>({u_is_size_zoom_constant:new Zt(i,e.u_is_size_zoom_constant),u_is_size_feature_constant:new Zt(i,e.u_is_size_feature_constant),u_size_t:new nt(i,e.u_size_t),u_size:new nt(i,e.u_size),u_camera_to_center_distance:new nt(i,e.u_camera_to_center_distance),u_pitch:new nt(i,e.u_pitch),u_rotate_symbol:new Zt(i,e.u_rotate_symbol),u_aspect_ratio:new nt(i,e.u_aspect_ratio),u_fade_change:new nt(i,e.u_fade_change),u_matrix:new oi(i,e.u_matrix),u_label_plane_matrix:new oi(i,e.u_label_plane_matrix),u_coord_matrix:new oi(i,e.u_coord_matrix),u_is_text:new Zt(i,e.u_is_text),u_pitch_with_map:new Zt(i,e.u_pitch_with_map),u_texsize:new Qt(i,e.u_texsize),u_texsize_icon:new Qt(i,e.u_texsize_icon),u_texture:new Zt(i,e.u_texture),u_texture_icon:new Zt(i,e.u_texture_icon),u_gamma_scale:new nt(i,e.u_gamma_scale),u_device_pixel_ratio:new nt(i,e.u_device_pixel_ratio),u_is_halo:new Zt(i,e.u_is_halo)}),"symbolTextAndIconUniforms"),zU=h((i,e,t,r,n,a,o,s,l,u)=>{let c=n.transform;return{u_is_size_zoom_constant:+(i==="constant"||i==="source"),u_is_size_feature_constant:+(i==="constant"||i==="camera"),u_size_t:e?e.uSizeT:0,u_size:e?e.uSize:0,u_camera_to_center_distance:c.cameraToCenterDistance,u_pitch:c.pitch/360*2*Math.PI,u_rotate_symbol:+t,u_aspect_ratio:c.width/c.height,u_fade_change:n.options.fadeDuration?n.symbolFadeChange:1,u_matrix:a,u_label_plane_matrix:o,u_coord_matrix:s,u_is_text:+l,u_pitch_with_map:+r,u_texsize:u,u_texture:0}},"symbolIconUniformValues"),BU=h((i,e,t,r,n,a,o,s,l,u,c)=>{let p=n.transform;return ht(zU(i,e,t,r,n,a,o,s,l,u),{u_gamma_scale:r?Math.cos(p._pitch)*p.cameraToCenterDistance:1,u_device_pixel_ratio:n.pixelRatio,u_is_halo:+c})},"symbolSDFUniformValues"),mce=h((i,e,t,r,n,a,o,s,l,u)=>ht(BU(i,e,t,r,n,a,o,s,!0,l,!0),{u_texsize_icon:u,u_texture_icon:1}),"symbolTextAndIconUniformValues");R();var gce=h((i,e)=>({u_matrix:new oi(i,e.u_matrix),u_opacity:new nt(i,e.u_opacity),u_color:new up(i,e.u_color)}),"backgroundUniforms"),yce=h((i,e)=>({u_matrix:new oi(i,e.u_matrix),u_opacity:new nt(i,e.u_opacity),u_image:new Zt(i,e.u_image),u_pattern_tl_a:new Qt(i,e.u_pattern_tl_a),u_pattern_br_a:new Qt(i,e.u_pattern_br_a),u_pattern_tl_b:new Qt(i,e.u_pattern_tl_b),u_pattern_br_b:new Qt(i,e.u_pattern_br_b),u_texsize:new Qt(i,e.u_texsize),u_mix:new nt(i,e.u_mix),u_pattern_size_a:new Qt(i,e.u_pattern_size_a),u_pattern_size_b:new Qt(i,e.u_pattern_size_b),u_scale_a:new nt(i,e.u_scale_a),u_scale_b:new nt(i,e.u_scale_b),u_pixel_coord_upper:new Qt(i,e.u_pixel_coord_upper),u_pixel_coord_lower:new Qt(i,e.u_pixel_coord_lower),u_tile_units_to_pixels:new nt(i,e.u_tile_units_to_pixels)}),"backgroundPatternUniforms"),vce=h((i,e,t)=>({u_matrix:i,u_opacity:e,u_color:t}),"backgroundUniformValues"),xce=h((i,e,t,r,n,a)=>ht(PU(r,a,t,n),{u_matrix:i,u_opacity:e}),"backgroundPatternUniformValues"),_ce={fillExtrusion:Dhe,fillExtrusionPattern:khe,fill:Fhe,fillPattern:zhe,fillOutline:Bhe,fillOutlinePattern:Ohe,circle:Uhe,collisionBox:jhe,collisionCircle:Hhe,debug:Xhe,clippingMask:qhe,heatmap:Zhe,heatmapTexture:Yhe,hillshade:Qhe,hillshadePrepare:ece,line:rce,lineGradient:nce,linePattern:ace,lineSDF:oce,raster:hce,symbolIcon:pce,symbolSDF:dce,symbolTextAndIcon:fce,background:gce,backgroundPattern:yce,terrain:Che,terrainDepth:Ehe,terrainCoords:The};R();R();var OU=class{constructor(e,t,r){this.context=e;let n=e.gl;this.buffer=n.createBuffer(),this.dynamicDraw=!!r,this.context.unbindVAO(),e.bindElementBuffer.set(this.buffer),n.bufferData(n.ELEMENT_ARRAY_BUFFER,t.arrayBuffer,this.dynamicDraw?n.DYNAMIC_DRAW:n.STATIC_DRAW),this.dynamicDraw||delete t.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(e){let t=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),t.bufferSubData(t.ELEMENT_ARRAY_BUFFER,0,e.arrayBuffer)}destroy(){let e=this.context.gl;this.buffer&&(e.deleteBuffer(this.buffer),delete this.buffer)}};h(OU,"IndexBuffer");var bce=OU;R();var wce={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},NU=class{constructor(e,t,r,n){this.length=t.length,this.attributes=r,this.itemSize=t.bytesPerElement,this.dynamicDraw=n,this.context=e;let a=e.gl;this.buffer=a.createBuffer(),e.bindVertexBuffer.set(this.buffer),a.bufferData(a.ARRAY_BUFFER,t.arrayBuffer,this.dynamicDraw?a.DYNAMIC_DRAW:a.STATIC_DRAW),this.dynamicDraw||delete t.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(e){if(e.length!==this.length)throw new Error(`Length of new data is ${e.length}, which doesn't match current length of ${this.length}`);let t=this.context.gl;this.bind(),t.bufferSubData(t.ARRAY_BUFFER,0,e.arrayBuffer)}enableAttributes(e,t){for(let r=0;r<this.attributes.length;r++){let n=this.attributes[r],a=t.attributes[n.name];a!==void 0&&e.enableVertexAttribArray(a)}}setVertexAttribPointers(e,t,r){for(let n=0;n<this.attributes.length;n++){let a=this.attributes[n],o=t.attributes[a.name];o!==void 0&&e.vertexAttribPointer(o,a.components,e[wce[a.type]],!1,this.itemSize,a.offset+this.itemSize*(r||0))}}destroy(){let e=this.context.gl;this.buffer&&(e.deleteBuffer(this.buffer),delete this.buffer)}};h(NU,"VertexBuffer");var Sce=NU;R();R();R();var X_=new WeakMap;function Xf(i){var e;if(X_.has(i))return X_.get(i);{let t=(e=i.getParameter(i.VERSION))==null?void 0:e.startsWith("WebGL 2.0");return X_.set(i,t),t}}h(Xf,"isWebGL2");var $U=class{constructor(e){this.gl=e.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(e){}getDefault(){return this.default}setDefault(){this.set(this.default)}};h($U,"BaseValue");var fi=$U,UU=class extends fi{getDefault(){return zt.transparent}set(e){let t=this.current;e.r===t.r&&e.g===t.g&&e.b===t.b&&e.a===t.a&&!this.dirty||(this.gl.clearColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}};h(UU,"ClearColor");var Mce=UU,VU=class extends fi{getDefault(){return 1}set(e){e===this.current&&!this.dirty||(this.gl.clearDepth(e),this.current=e,this.dirty=!1)}};h(VU,"ClearDepth");var Cce=VU,jU=class extends fi{getDefault(){return 0}set(e){e===this.current&&!this.dirty||(this.gl.clearStencil(e),this.current=e,this.dirty=!1)}};h(jU,"ClearStencil");var Ece=jU,HU=class extends fi{getDefault(){return[!0,!0,!0,!0]}set(e){let t=this.current;e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&!this.dirty||(this.gl.colorMask(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}};h(HU,"ColorMask");var Tce=HU,GU=class extends fi{getDefault(){return!0}set(e){e===this.current&&!this.dirty||(this.gl.depthMask(e),this.current=e,this.dirty=!1)}};h(GU,"DepthMask");var Pce=GU,WU=class extends fi{getDefault(){return 255}set(e){e===this.current&&!this.dirty||(this.gl.stencilMask(e),this.current=e,this.dirty=!1)}};h(WU,"StencilMask");var Ace=WU,XU=class extends fi{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(e){let t=this.current;e.func===t.func&&e.ref===t.ref&&e.mask===t.mask&&!this.dirty||(this.gl.stencilFunc(e.func,e.ref,e.mask),this.current=e,this.dirty=!1)}};h(XU,"StencilFunc");var Ice=XU,qU=class extends fi{getDefault(){let e=this.gl;return[e.KEEP,e.KEEP,e.KEEP]}set(e){let t=this.current;e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&!this.dirty||(this.gl.stencilOp(e[0],e[1],e[2]),this.current=e,this.dirty=!1)}};h(qU,"StencilOp");var Lce=qU,ZU=class extends fi{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;let t=this.gl;e?t.enable(t.STENCIL_TEST):t.disable(t.STENCIL_TEST),this.current=e,this.dirty=!1}};h(ZU,"StencilTest");var Dce=ZU,YU=class extends fi{getDefault(){return[0,1]}set(e){let t=this.current;e[0]===t[0]&&e[1]===t[1]&&!this.dirty||(this.gl.depthRange(e[0],e[1]),this.current=e,this.dirty=!1)}};h(YU,"DepthRange");var kce=YU,JU=class extends fi{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;let t=this.gl;e?t.enable(t.DEPTH_TEST):t.disable(t.DEPTH_TEST),this.current=e,this.dirty=!1}};h(JU,"DepthTest");var Rce=JU,KU=class extends fi{getDefault(){return this.gl.LESS}set(e){e===this.current&&!this.dirty||(this.gl.depthFunc(e),this.current=e,this.dirty=!1)}};h(KU,"DepthFunc");var Fce=KU,QU=class extends fi{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;let t=this.gl;e?t.enable(t.BLEND):t.disable(t.BLEND),this.current=e,this.dirty=!1}};h(QU,"Blend");var zce=QU,eV=class extends fi{getDefault(){let e=this.gl;return[e.ONE,e.ZERO]}set(e){let t=this.current;e[0]===t[0]&&e[1]===t[1]&&!this.dirty||(this.gl.blendFunc(e[0],e[1]),this.current=e,this.dirty=!1)}};h(eV,"BlendFunc");var Bce=eV,tV=class extends fi{getDefault(){return zt.transparent}set(e){let t=this.current;e.r===t.r&&e.g===t.g&&e.b===t.b&&e.a===t.a&&!this.dirty||(this.gl.blendColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}};h(tV,"BlendColor");var Oce=tV,iV=class extends fi{getDefault(){return this.gl.FUNC_ADD}set(e){e===this.current&&!this.dirty||(this.gl.blendEquation(e),this.current=e,this.dirty=!1)}};h(iV,"BlendEquation");var Nce=iV,rV=class extends fi{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;let t=this.gl;e?t.enable(t.CULL_FACE):t.disable(t.CULL_FACE),this.current=e,this.dirty=!1}};h(rV,"CullFace");var $ce=rV,nV=class extends fi{getDefault(){return this.gl.BACK}set(e){e===this.current&&!this.dirty||(this.gl.cullFace(e),this.current=e,this.dirty=!1)}};h(nV,"CullFaceSide");var Uce=nV,aV=class extends fi{getDefault(){return this.gl.CCW}set(e){e===this.current&&!this.dirty||(this.gl.frontFace(e),this.current=e,this.dirty=!1)}};h(aV,"FrontFace");var Vce=aV,oV=class extends fi{getDefault(){return null}set(e){e===this.current&&!this.dirty||(this.gl.useProgram(e),this.current=e,this.dirty=!1)}};h(oV,"ProgramValue");var jce=oV,sV=class extends fi{getDefault(){return this.gl.TEXTURE0}set(e){e===this.current&&!this.dirty||(this.gl.activeTexture(e),this.current=e,this.dirty=!1)}};h(sV,"ActiveTextureUnit");var Hce=sV,lV=class extends fi{getDefault(){let e=this.gl;return[0,0,e.drawingBufferWidth,e.drawingBufferHeight]}set(e){let t=this.current;e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&!this.dirty||(this.gl.viewport(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}};h(lV,"Viewport");var Gce=lV,uV=class extends fi{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;let t=this.gl;t.bindFramebuffer(t.FRAMEBUFFER,e),this.current=e,this.dirty=!1}};h(uV,"BindFramebuffer");var Wce=uV,hV=class extends fi{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;let t=this.gl;t.bindRenderbuffer(t.RENDERBUFFER,e),this.current=e,this.dirty=!1}};h(hV,"BindRenderbuffer");var Xce=hV,cV=class extends fi{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;let t=this.gl;t.bindTexture(t.TEXTURE_2D,e),this.current=e,this.dirty=!1}};h(cV,"BindTexture");var qce=cV,pV=class extends fi{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;let t=this.gl;t.bindBuffer(t.ARRAY_BUFFER,e),this.current=e,this.dirty=!1}};h(pV,"BindVertexBuffer");var Zce=pV,dV=class extends fi{getDefault(){return null}set(e){let t=this.gl;t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,e),this.current=e,this.dirty=!1}};h(dV,"BindElementBuffer");var Yce=dV,fV=class extends fi{getDefault(){return null}set(e){var t;if(e===this.current&&!this.dirty)return;let r=this.gl;Xf(r)?r.bindVertexArray(e):(t=r.getExtension("OES_vertex_array_object"))==null||t.bindVertexArrayOES(e),this.current=e,this.dirty=!1}};h(fV,"BindVertexArray");var Jce=fV,mV=class extends fi{getDefault(){return 4}set(e){if(e===this.current&&!this.dirty)return;let t=this.gl;t.pixelStorei(t.UNPACK_ALIGNMENT,e),this.current=e,this.dirty=!1}};h(mV,"PixelStoreUnpack");var Kce=mV,gV=class extends fi{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;let t=this.gl;t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e),this.current=e,this.dirty=!1}};h(gV,"PixelStoreUnpackPremultiplyAlpha");var Qce=gV,yV=class extends fi{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;let t=this.gl;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,e),this.current=e,this.dirty=!1}};h(yV,"PixelStoreUnpackFlipY");var epe=yV,vV=class extends fi{constructor(e,t){super(e),this.context=e,this.parent=t}getDefault(){return null}};h(vV,"FramebufferAttachment");var rE=vV,xV=class extends rE{setDirty(){this.dirty=!0}set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);let t=this.gl;t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0),this.current=e,this.dirty=!1}};h(xV,"ColorAttachment");var tpe=xV,_V=class extends rE{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);let t=this.gl;t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,e),this.current=e,this.dirty=!1}};h(_V,"DepthAttachment");var ipe=_V,bV=class extends rE{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);let t=this.gl;t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,e),this.current=e,this.dirty=!1}};h(bV,"DepthStencilAttachment");var rpe=bV,wV=class{constructor(e,t,r,n,a){this.context=e,this.width=t,this.height=r;let o=e.gl,s=this.framebuffer=o.createFramebuffer();if(this.colorAttachment=new tpe(e,s),n)this.depthAttachment=a?new rpe(e,s):new ipe(e,s);else if(a)throw new Error("Stencil cannot be set without depth");if(o.checkFramebufferStatus(o.FRAMEBUFFER)!==o.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){let e=this.context.gl,t=this.colorAttachment.get();if(t&&e.deleteTexture(t),this.depthAttachment){let r=this.depthAttachment.get();r&&e.deleteRenderbuffer(r)}e.deleteFramebuffer(this.framebuffer)}};h(wV,"Framebuffer");var npe=wV;R();var ape=0,SV=1,ope=771,MV=class{constructor(e,t,r){this.blendFunction=e,this.blendColor=t,this.mask=r}};h(MV,"ColorMode");var yr=MV;yr.Replace=[SV,ape];yr.disabled=new yr(yr.Replace,zt.transparent,[!1,!1,!1,!1]);yr.unblended=new yr(yr.Replace,zt.transparent,[!0,!0,!0,!0]);yr.alphaBlended=new yr([SV,ope],zt.transparent,[!0,!0,!0,!0]);var CV=class{constructor(e){var t,r;if(this.gl=e,this.clearColor=new Mce(this),this.clearDepth=new Cce(this),this.clearStencil=new Ece(this),this.colorMask=new Tce(this),this.depthMask=new Pce(this),this.stencilMask=new Ace(this),this.stencilFunc=new Ice(this),this.stencilOp=new Lce(this),this.stencilTest=new Dce(this),this.depthRange=new kce(this),this.depthTest=new Rce(this),this.depthFunc=new Fce(this),this.blend=new zce(this),this.blendFunc=new Bce(this),this.blendColor=new Oce(this),this.blendEquation=new Nce(this),this.cullFace=new $ce(this),this.cullFaceSide=new Uce(this),this.frontFace=new Vce(this),this.program=new jce(this),this.activeTexture=new Hce(this),this.viewport=new Gce(this),this.bindFramebuffer=new Wce(this),this.bindRenderbuffer=new Xce(this),this.bindTexture=new qce(this),this.bindVertexBuffer=new Zce(this),this.bindElementBuffer=new Yce(this),this.bindVertexArray=new Jce(this),this.pixelStoreUnpack=new Kce(this),this.pixelStoreUnpackPremultiplyAlpha=new Qce(this),this.pixelStoreUnpackFlipY=new epe(this),this.extTextureFilterAnisotropic=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=e.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE),Xf(e)){this.HALF_FLOAT=e.HALF_FLOAT;let n=e.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(t=e.RGBA16F)!=null?t:n==null?void 0:n.RGBA16F_EXT,this.RGB16F=(r=e.RGB16F)!=null?r:n==null?void 0:n.RGB16F_EXT,e.getExtension("EXT_color_buffer_float")}else{e.getExtension("EXT_color_buffer_half_float"),e.getExtension("OES_texture_half_float_linear");let n=e.getExtension("OES_texture_half_float");this.HALF_FLOAT=n==null?void 0:n.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(e,t){return new bce(this,e,t)}createVertexBuffer(e,t,r){return new Sce(this,e,t,r)}createRenderbuffer(e,t,r){let n=this.gl,a=n.createRenderbuffer();return this.bindRenderbuffer.set(a),n.renderbufferStorage(n.RENDERBUFFER,e,t,r),this.bindRenderbuffer.set(null),a}createFramebuffer(e,t,r,n){return new npe(this,e,t,r,n)}clear({color:e,depth:t,stencil:r}){let n=this.gl,a=0;e&&(a|=n.COLOR_BUFFER_BIT,this.clearColor.set(e),this.colorMask.set([!0,!0,!0,!0])),typeof t<"u"&&(a|=n.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(t),this.depthMask.set(!0)),typeof r<"u"&&(a|=n.STENCIL_BUFFER_BIT,this.clearStencil.set(r),this.stencilMask.set(255)),n.clear(a)}setCullFace(e){e.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(e.mode),this.frontFace.set(e.frontFace))}setDepthMode(e){e.func===this.gl.ALWAYS&&!e.mask?this.depthTest.set(!1):(this.depthTest.set(!0),this.depthFunc.set(e.func),this.depthMask.set(e.mask),this.depthRange.set(e.range))}setStencilMode(e){e.test.func===this.gl.ALWAYS&&!e.mask?this.stencilTest.set(!1):(this.stencilTest.set(!0),this.stencilMask.set(e.mask),this.stencilOp.set([e.fail,e.depthFail,e.pass]),this.stencilFunc.set({func:e.test.func,ref:e.ref,mask:e.test.mask}))}setColorMode(e){ml(e.blendFunction,yr.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(e.blendFunction),this.blendColor.set(e.blendColor)),this.colorMask.set(e.mask)}createVertexArray(){var e;return Xf(this.gl)?this.gl.createVertexArray():(e=this.gl.getExtension("OES_vertex_array_object"))==null?void 0:e.createVertexArrayOES()}deleteVertexArray(e){var t;return Xf(this.gl)?this.gl.deleteVertexArray(e):(t=this.gl.getExtension("OES_vertex_array_object"))==null?void 0:t.deleteVertexArrayOES(e)}unbindVAO(){this.bindVertexArray.set(null)}};h(CV,"Context");var spe=CV;R();var EV=class{constructor(e,t,r){this.func=e,this.mask=t,this.range=r}};h(EV,"DepthMode");var ri=EV;ri.ReadOnly=!1;ri.ReadWrite=!0;ri.disabled=new ri(519,ri.ReadOnly,[0,1]);R();var TV=class{constructor(e,t,r,n,a,o){this.test=e,this.ref=t,this.mask=r,this.fail=n,this.depthFail=a,this.pass=o}};h(TV,"StencilMode");var Hi=TV;Hi.disabled=new Hi({func:519,mask:0},0,0,7680,7680,7680);R();var PV=class{constructor(e,t,r){this.enable=e,this.mode=t,this.frontFace=r}};h(PV,"CullFaceMode");var Bi=PV;Bi.disabled=new Bi(!1,1029,2305);Bi.backCCW=new Bi(!0,1029,2305);R();var AV=It(di(),1);R();var Vg;function e3(i,e,t,r,n,a,o){let s=i.context,l=s.gl,u=i.useProgram("collisionBox"),c=[],p=0,d=0;for(let w=0;w<r.length;w++){let _=r[w],C=e.getTile(_),E=C.getBucket(t);if(!E)continue;let T=_.posMatrix;(n[0]!==0||n[1]!==0)&&(T=i.translatePosMatrix(_.posMatrix,C,n,a));let L=o?E.textCollisionBox:E.iconCollisionBox,D=E.collisionCircleArray;if(D.length>0){let B=lt.create(),A=T;lt.mul(B,E.placementInvProjMatrix,i.transform.glCoordMatrix),lt.mul(B,B,E.placementViewportMatrix),c.push({circleArray:D,circleOffset:d,transform:A,invTransform:B,coord:_}),p+=D.length/4,d=p}L&&u.draw(s,l.LINES,ri.disabled,Hi.disabled,i.colorModeForRenderPass(),Bi.disabled,Ghe(T,i.transform,C),i.style.map.terrain&&i.style.map.terrain.getTerrainData(_),t.id,L.layoutVertexBuffer,L.indexBuffer,L.segments,null,i.transform.zoom,null,null,L.collisionVertexBuffer)}if(!o||!c.length)return;let m=i.useProgram("collisionCircle"),g=new Coe;g.resize(p*4),g._trim();let b=0;for(let w of c)for(let _=0;_<w.circleArray.length/4;_++){let C=_*4,E=w.circleArray[C+0],T=w.circleArray[C+1],L=w.circleArray[C+2],D=w.circleArray[C+3];g.emplace(b++,E,T,L,D,0),g.emplace(b++,E,T,L,D,1),g.emplace(b++,E,T,L,D,2),g.emplace(b++,E,T,L,D,3)}(!Vg||Vg.length<p*2)&&(Vg=IV(p));let x=s.createIndexBuffer(Vg,!0),v=s.createVertexBuffer(g,nle.members,!0);for(let w of c){let _=Whe(w.transform,w.invTransform,i.transform);m.draw(s,l.TRIANGLES,ri.disabled,Hi.disabled,i.colorModeForRenderPass(),Bi.disabled,_,i.style.map.terrain&&i.style.map.terrain.getTerrainData(w.coord),t.id,v,x,cr.simpleSegment(0,w.circleOffset*2,w.circleArray.length,w.circleArray.length/2),null,i.transform.zoom,null,null,null)}v.destroy(),x.destroy()}h(e3,"drawCollisionDebug");function IV(i){let e=i*2,t=new Toe;t.resize(e),t._trim();for(let r=0;r<e;r++){let n=r*6;t.uint16[n+0]=r*4+0,t.uint16[n+1]=r*4+1,t.uint16[n+2]=r*4+2,t.uint16[n+3]=r*4+2,t.uint16[n+4]=r*4+3,t.uint16[n+5]=r*4+0}return t}h(IV,"createQuadTriangles");var lpe=lt.identity(new Float32Array(16));function LV(i,e,t,r,n){if(i.renderPass!=="translucent")return;let a=Hi.disabled,o=i.colorModeForRenderPass();(t._unevaluatedLayout.hasValue("text-variable-anchor")||t._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&kV(r,i,t,e,t.layout.get("text-rotation-alignment"),t.layout.get("text-pitch-alignment"),n),t.paint.get("icon-opacity").constantOr(1)!==0&&t3(i,e,t,r,!1,t.paint.get("icon-translate"),t.paint.get("icon-translate-anchor"),t.layout.get("icon-rotation-alignment"),t.layout.get("icon-pitch-alignment"),t.layout.get("icon-keep-upright"),a,o),t.paint.get("text-opacity").constantOr(1)!==0&&t3(i,e,t,r,!0,t.paint.get("text-translate"),t.paint.get("text-translate-anchor"),t.layout.get("text-rotation-alignment"),t.layout.get("text-pitch-alignment"),t.layout.get("text-keep-upright"),a,o),e.map.showCollisionBoxes&&(e3(i,e,t,r,t.paint.get("text-translate"),t.paint.get("text-translate-anchor"),!0),e3(i,e,t,r,t.paint.get("icon-translate"),t.paint.get("icon-translate-anchor"),!1))}h(LV,"drawSymbols");function DV(i,e,t,r,n,a){let{horizontalAlign:o,verticalAlign:s}=$5(i),l=-(o-.5)*e,u=-(s-.5)*t;return new AV.default((l/n+r[0])*a,(u/n+r[1])*a)}h(DV,"calculateVariableRenderShift");function kV(i,e,t,r,n,a,o){let s=e.transform,l=n==="map",u=a==="map";for(let c of i){let p=r.getTile(c),d=p.getBucket(t);if(!d||!d.text||!d.text.segments.get().length)continue;let m=d.textSizeData,g=Km(m,s.zoom),b=qn(p,1,e.transform.zoom),x=Rx(c.posMatrix,u,l,e.transform,b),v=t.layout.get("icon-text-fit")!=="none"&&d.hasIconData();if(g){let w=Math.pow(2,s.zoom-p.tileID.overscaledZ),_=e.style.map.terrain?(C,E)=>e.style.map.terrain.getElevation(c,C,E):null;RV(d,l,u,o,s,x,c.posMatrix,w,g,v,_)}}}h(kV,"updateVariableAnchors");function RV(i,e,t,r,n,a,o,s,l,u,c){let p=i.text.placedSymbolArray,d=i.text.dynamicLayoutVertexArray,m=i.icon.dynamicLayoutVertexArray,g={};d.clear();for(let b=0;b<p.length;b++){let x=p.get(b),v=i.allowVerticalPlacement&&!x.placedOrientation,w=!x.hidden&&x.crossTileID&&!v?r[x.crossTileID]:null;if(!w)Fu(x.numGlyphs,d);else{let _=new AV.default(x.anchorX,x.anchorY),C=la(_,t?o:a,c),E=Fx(n.cameraToCenterDistance,C.signedDistanceFromCamera),T=Ix(i.textSizeData,l,x)*E/CN;t&&(T*=i.tilePixelRatio/s);let{width:L,height:D,anchor:B,textOffset:A,textBoxScale:k}=w,$=DV(B,L,D,A,k,T),O=t?la(_.add($),a,c).point:C.point.add(e?$.rotate(-n.angle):$),P=i.allowVerticalPlacement&&x.placedOrientation===2?Math.PI/2:0;for(let U=0;U<x.numGlyphs;U++)Fp(d,O,P);u&&x.associatedIconIndex>=0&&(g[x.associatedIconIndex]={shiftedAnchor:O,angle:P})}}if(u){m.clear();let b=i.icon.placedSymbolArray;for(let x=0;x<b.length;x++){let v=b.get(x);if(v.hidden)Fu(v.numGlyphs,m);else{let w=g[x];if(!w)Fu(v.numGlyphs,m);else for(let _=0;_<v.numGlyphs;_++)Fp(m,w.shiftedAnchor,w.angle)}}i.icon.dynamicLayoutVertexBuffer.updateData(m)}i.text.dynamicLayoutVertexBuffer.updateData(d)}h(RV,"updateVariableAnchorsForBucket");function FV(i,e,t){return t.iconsInText&&e?"symbolTextAndIcon":i?"symbolSDF":"symbolIcon"}h(FV,"getSymbolProgramName");function t3(i,e,t,r,n,a,o,s,l,u,c,p){let d=i.context,m=d.gl,g=i.transform,b=s==="map",x=l==="map",v=s!=="viewport"&&t.layout.get("symbol-placement")!=="point",w=b&&!x&&!v,_=!t.layout.get("symbol-sort-key").isConstant(),C=!1,E=i.depthModeForSublayer(0,ri.ReadOnly),T=t._unevaluatedLayout.hasValue("text-variable-anchor")||t._unevaluatedLayout.hasValue("text-variable-anchor-offset"),L=[];for(let D of r){let B=e.getTile(D),A=B.getBucket(t);if(!A)continue;let k=n?A.text:A.icon;if(!k||!k.segments.get().length||!k.hasVisibleVertices)continue;let $=k.programConfigurations.get(t.id),O=n||A.sdfIcons,P=n?A.textSizeData:A.iconSizeData,U=x||g.pitch!==0,G=i.useProgram(FV(O,n,A),$),K=Km(P,g.zoom),z=i.style.map.terrain&&i.style.map.terrain.getTerrainData(D),V,j=[0,0],q,ee,ae=null,N;if(n){if(q=B.glyphAtlasTexture,ee=m.LINEAR,V=B.glyphAtlasTexture.size,A.iconsInText){j=B.imageAtlasTexture.size,ae=B.imageAtlasTexture;let De=P.kind==="composite"||P.kind==="camera";N=U||i.options.rotating||i.options.zooming||De?m.LINEAR:m.NEAREST}}else{let De=t.layout.get("icon-size").constantOr(0)!==1||A.iconsNeedLinear;q=B.imageAtlasTexture,ee=O||i.options.rotating||i.options.zooming||De||U?m.LINEAR:m.NEAREST,V=B.imageAtlasTexture.size}let J=qn(B,1,i.transform.zoom),Y=Rx(D.posMatrix,x,b,i.transform,J),oe=q5(D.posMatrix,x,b,i.transform,J),xe=T&&A.hasTextData(),ge=t.layout.get("icon-text-fit")!=="none"&&xe&&A.hasIconData();if(v){let De=i.style.map.terrain?(Fe,Ze)=>i.style.map.terrain.getElevation(D,Fe,Ze):null,we=t.layout.get("text-rotation-alignment")==="map";rU(A,D.posMatrix,i,n,Y,oe,x,u,we,De)}let Te=i.translatePosMatrix(D.posMatrix,B,a,o),me=v||n&&T||ge?lpe:Y,Q=i.translatePosMatrix(oe,B,a,o,!0),Me=O&&t.paint.get(n?"text-halo-width":"icon-halo-width").constantOr(1)!==0,ve;O?A.iconsInText?ve=mce(P.kind,K,w,x,i,Te,me,Q,V,j):ve=BU(P.kind,K,w,x,i,Te,me,Q,n,V,!0):ve=zU(P.kind,K,w,x,i,Te,me,Q,n,V);let Ie={program:G,buffers:k,uniformValues:ve,atlasTexture:q,atlasTextureIcon:ae,atlasInterpolation:ee,atlasInterpolationIcon:N,isSDF:O,hasHalo:Me};if(_&&A.canOverlap){C=!0;let De=k.segments.get();for(let we of De)L.push({segments:new cr([we]),sortKey:we.sortKey,state:Ie,terrainData:z})}else L.push({segments:k.segments,sortKey:0,state:Ie,terrainData:z})}C&&L.sort((D,B)=>D.sortKey-B.sortKey);for(let D of L){let B=D.state;if(d.activeTexture.set(m.TEXTURE0),B.atlasTexture.bind(B.atlasInterpolation,m.CLAMP_TO_EDGE),B.atlasTextureIcon&&(d.activeTexture.set(m.TEXTURE1),B.atlasTextureIcon&&B.atlasTextureIcon.bind(B.atlasInterpolationIcon,m.CLAMP_TO_EDGE)),B.isSDF){let A=B.uniformValues;B.hasHalo&&(A.u_is_halo=1,i3(B.buffers,D.segments,t,i,B.program,E,c,p,A,D.terrainData)),A.u_is_halo=0}i3(B.buffers,D.segments,t,i,B.program,E,c,p,B.uniformValues,D.terrainData)}}h(t3,"drawLayerSymbols");function i3(i,e,t,r,n,a,o,s,l,u){let c=r.context,p=c.gl;n.draw(c,p.TRIANGLES,a,o,s,Bi.disabled,l,u,t.id,i.layoutVertexBuffer,i.indexBuffer,e,t.paint,r.transform.zoom,i.programConfigurations.get(t.id),i.dynamicLayoutVertexBuffer,i.opacityVertexBuffer)}h(i3,"drawSymbolElements");R();function zV(i,e,t,r){if(i.renderPass!=="translucent")return;let n=t.paint.get("circle-opacity"),a=t.paint.get("circle-stroke-width"),o=t.paint.get("circle-stroke-opacity"),s=!t.layout.get("circle-sort-key").isConstant();if(n.constantOr(1)===0&&(a.constantOr(1)===0||o.constantOr(1)===0))return;let l=i.context,u=l.gl,c=i.depthModeForSublayer(0,ri.ReadOnly),p=Hi.disabled,d=i.colorModeForRenderPass(),m=[];for(let g=0;g<r.length;g++){let b=r[g],x=e.getTile(b),v=x.getBucket(t);if(!v)continue;let w=v.programConfigurations.get(t.id),_=i.useProgram("circle",w),C=v.layoutVertexBuffer,E=v.indexBuffer,T=i.style.map.terrain&&i.style.map.terrain.getTerrainData(b),L=Vhe(i,b,x,t),D={programConfiguration:w,program:_,layoutVertexBuffer:C,indexBuffer:E,uniformValues:L,terrainData:T};if(s){let B=v.segments.get();for(let A of B)m.push({segments:new cr([A]),sortKey:A.sortKey,state:D})}else m.push({segments:v.segments,sortKey:0,state:D})}s&&m.sort((g,b)=>g.sortKey-b.sortKey);for(let g of m){let{programConfiguration:b,program:x,layoutVertexBuffer:v,indexBuffer:w,uniformValues:_,terrainData:C}=g.state,E=g.segments;x.draw(l,u.TRIANGLES,c,p,d,Bi.disabled,_,C,t.id,v,w,E,t.paint,i.transform.zoom,b)}}h(zV,"drawCircles");R();function BV(i,e,t,r){if(t.paint.get("heatmap-opacity")!==0)if(i.renderPass==="offscreen"){let n=i.context,a=n.gl,o=Hi.disabled,s=new yr([a.ONE,a.ONE],zt.transparent,[!0,!0,!0,!0]);OV(n,i,t),n.clear({color:zt.transparent});for(let l=0;l<r.length;l++){let u=r[l];if(e.hasRenderableParent(u))continue;let c=e.getTile(u),p=c.getBucket(t);if(!p)continue;let d=p.programConfigurations.get(t.id),m=i.useProgram("heatmap",d),{zoom:g}=i.transform;m.draw(n,a.TRIANGLES,ri.disabled,o,s,Bi.disabled,Jhe(u.posMatrix,c,g,t.paint.get("heatmap-intensity")),null,t.id,p.layoutVertexBuffer,p.indexBuffer,p.segments,t.paint,i.transform.zoom,d)}n.viewport.set([0,0,i.width,i.height])}else i.renderPass==="translucent"&&(i.context.setColorMode(i.colorModeForRenderPass()),$V(i,t))}h(BV,"drawHeatmap");function OV(i,e,t){let r=i.gl;i.activeTexture.set(r.TEXTURE1),i.viewport.set([0,0,e.width/4,e.height/4]);let n=t.heatmapFbo;if(n)r.bindTexture(r.TEXTURE_2D,n.colorAttachment.get()),i.bindFramebuffer.set(n.framebuffer);else{let a=r.createTexture();r.bindTexture(r.TEXTURE_2D,a),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),n=t.heatmapFbo=i.createFramebuffer(e.width/4,e.height/4,!1,!1),NV(i,e,a,n)}}h(OV,"bindFramebuffer");function NV(i,e,t,r){var n,a;let o=i.gl,s=(n=i.HALF_FLOAT)!=null?n:o.UNSIGNED_BYTE,l=(a=i.RGBA16F)!=null?a:o.RGBA;o.texImage2D(o.TEXTURE_2D,0,l,e.width/4,e.height/4,0,o.RGBA,s,null),r.colorAttachment.set(t)}h(NV,"bindTextureToFramebuffer");function $V(i,e){let t=i.context,r=t.gl,n=e.heatmapFbo;if(!n)return;t.activeTexture.set(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,n.colorAttachment.get()),t.activeTexture.set(r.TEXTURE1);let a=e.colorRampTexture;a||(a=e.colorRampTexture=new Rr(t,e.colorRamp,r.RGBA)),a.bind(r.LINEAR,r.CLAMP_TO_EDGE),i.useProgram("heatmapTexture").draw(t,r.TRIANGLES,ri.disabled,Hi.disabled,i.colorModeForRenderPass(),Bi.disabled,Khe(i,e,0,1),null,e.id,i.viewportBuffer,i.quadTriangleIndexBuffer,i.viewportSegments,e.paint,i.transform.zoom)}h($V,"renderTextureToMap");R();function UV(i,e,t,r){if(i.renderPass!=="translucent")return;let n=t.paint.get("line-opacity"),a=t.paint.get("line-width");if(n.constantOr(1)===0||a.constantOr(1)===0)return;let o=i.depthModeForSublayer(0,ri.ReadOnly),s=i.colorModeForRenderPass(),l=t.paint.get("line-dasharray"),u=t.paint.get("line-pattern"),c=u.constantOr(1),p=t.paint.get("line-gradient"),d=t.getCrossfadeParameters(),m=c?"linePattern":l?"lineSDF":p?"lineGradient":"line",g=i.context,b=g.gl,x=!0;for(let v of r){let w=e.getTile(v);if(c&&!w.patternsLoaded())continue;let _=w.getBucket(t);if(!_)continue;let C=_.programConfigurations.get(t.id),E=i.context.program.get(),T=i.useProgram(m,C),L=x||T.program!==E,D=i.style.map.terrain&&i.style.map.terrain.getTerrainData(v),B=u.constantOr(null);if(B&&w.imageAtlas){let $=w.imageAtlas,O=$.patternPositions[B.to.toString()],P=$.patternPositions[B.from.toString()];O&&P&&C.setConstantPatternPositions(O,P)}let A=D?v:null,k=c?lce(i,w,t,d,A):l?uce(i,w,t,l,d,A):p?sce(i,w,t,_.lineClipsArray.length,A):eE(i,w,t,A);if(c)g.activeTexture.set(b.TEXTURE0),w.imageAtlasTexture.bind(b.LINEAR,b.CLAMP_TO_EDGE),C.updatePaintBuffers(d);else if(l&&(L||i.lineAtlas.dirty))g.activeTexture.set(b.TEXTURE0),i.lineAtlas.bind(g);else if(p){let $=_.gradients[t.id],O=$.texture;if(t.gradientVersion!==$.version){let P=256;if(t.stepInterpolant){let U=e.getSource().maxzoom,G=v.canonical.z===U?Math.ceil(1<<i.transform.maxZoom-v.canonical.z):1,K=_.maxLineLength/8192*1024*G;P=Tr(aL(K),256,g.maxTextureSize)}$.gradient=F5({expression:t.gradientExpression(),evaluationKey:"lineProgress",resolution:P,image:$.gradient||void 0,clips:_.lineClipsArray}),$.texture?$.texture.update($.gradient):$.texture=new Rr(g,$.gradient,b.RGBA),$.version=t.gradientVersion,O=$.texture}g.activeTexture.set(b.TEXTURE0),O.bind(t.stepInterpolant?b.NEAREST:b.LINEAR,b.CLAMP_TO_EDGE)}T.draw(g,b.TRIANGLES,o,i.stencilModeForClipping(v),s,Bi.disabled,k,D,t.id,_.layoutVertexBuffer,_.indexBuffer,_.segments,t.paint,i.transform.zoom,C,_.layoutVertexBuffer2),x=!1}}h(UV,"drawLine");R();R();function nE(i,e,t,r,n){if(!t||!r||!r.imageAtlas)return;let a=r.imageAtlas.patternPositions,o=a[t.to.toString()],s=a[t.from.toString()];if(!o&&s&&(o=s),!s&&o&&(s=o),!o||!s){let l=n.getPaintProperty(e);o=a[l],s=a[l]}o&&s&&i.setConstantPatternPositions(o,s)}h(nE,"updatePatternPositionsInProgram");function VV(i,e,t,r){let n=t.paint.get("fill-color"),a=t.paint.get("fill-opacity");if(a.constantOr(1)===0)return;let o=i.colorModeForRenderPass(),s=t.paint.get("fill-pattern"),l=i.opaquePassEnabledForLayer()&&!s.constantOr(1)&&n.constantOr(zt.transparent).a===1&&a.constantOr(0)===1?"opaque":"translucent";if(i.renderPass===l){let u=i.depthModeForSublayer(1,i.renderPass==="opaque"?ri.ReadWrite:ri.ReadOnly);r3(i,e,t,r,u,o,!1)}if(i.renderPass==="translucent"&&t.paint.get("fill-antialias")){let u=i.depthModeForSublayer(t.getPaintProperty("fill-outline-color")?2:0,ri.ReadOnly);r3(i,e,t,r,u,o,!0)}}h(VV,"drawFill");function r3(i,e,t,r,n,a,o){let s=i.context.gl,l="fill-pattern",u=t.paint.get(l),c=u&&u.constantOr(1),p=t.getCrossfadeParameters(),d,m,g,b,x;o?(m=c&&!t.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",d=s.LINES):(m=c?"fillPattern":"fill",d=s.TRIANGLES);let v=u.constantOr(null);for(let w of r){let _=e.getTile(w);if(c&&!_.patternsLoaded())continue;let C=_.getBucket(t);if(!C)continue;let E=C.programConfigurations.get(t.id),T=i.useProgram(m,E),L=i.style.map.terrain&&i.style.map.terrain.getTerrainData(w);c&&(i.context.activeTexture.set(s.TEXTURE0),_.imageAtlasTexture.bind(s.LINEAR,s.CLAMP_TO_EDGE),E.updatePaintBuffers(p)),nE(E,l,v,_,t);let D=L?w:null,B=D?D.posMatrix:w.posMatrix,A=i.translatePosMatrix(B,_,t.paint.get("fill-translate"),t.paint.get("fill-translate-anchor"));if(!o)b=C.indexBuffer,x=C.segments,g=c?LU(A,i,p,_):IU(A);else{b=C.indexBuffer2,x=C.segments2;let k=[s.drawingBufferWidth,s.drawingBufferHeight];g=m==="fillOutlinePattern"&&c?$he(A,i,p,_,k):Nhe(A,k)}T.draw(i.context,d,n,i.stencilModeForClipping(w),a,Bi.disabled,g,L,t.id,C.layoutVertexBuffer,b,x,t.paint,i.transform.zoom,E)}}h(r3,"drawFillTiles");R();function jV(i,e,t,r){let n=t.paint.get("fill-extrusion-opacity");if(n!==0&&i.renderPass==="translucent"){let a=new ri(i.context.gl.LEQUAL,ri.ReadWrite,i.depthRangeFor3D);if(n===1&&!t.paint.get("fill-extrusion-pattern").constantOr(1)){let o=i.colorModeForRenderPass();fy(i,e,t,r,a,Hi.disabled,o)}else fy(i,e,t,r,a,Hi.disabled,yr.disabled),fy(i,e,t,r,a,i.stencilModeFor3D(),i.colorModeForRenderPass())}}h(jV,"drawFillExtrusion");function fy(i,e,t,r,n,a,o){let s=i.context,l=s.gl,u="fill-extrusion-pattern",c=t.paint.get(u),p=c.constantOr(1),d=t.getCrossfadeParameters(),m=t.paint.get("fill-extrusion-opacity"),g=c.constantOr(null);for(let b of r){let x=e.getTile(b),v=x.getBucket(t);if(!v)continue;let w=i.style.map.terrain&&i.style.map.terrain.getTerrainData(b),_=v.programConfigurations.get(t.id),C=i.useProgram(p?"fillExtrusionPattern":"fillExtrusion",_);p&&(i.context.activeTexture.set(l.TEXTURE0),x.imageAtlasTexture.bind(l.LINEAR,l.CLAMP_TO_EDGE),_.updatePaintBuffers(d)),nE(_,u,g,x,t);let E=i.translatePosMatrix(b.posMatrix,x,t.paint.get("fill-extrusion-translate"),t.paint.get("fill-extrusion-translate-anchor")),T=t.paint.get("fill-extrusion-vertical-gradient"),L=p?Rhe(E,i,T,m,b,d,x):AU(E,i,T,m);C.draw(s,s.gl.TRIANGLES,n,a,o,Bi.backCCW,L,w,t.id,v.layoutVertexBuffer,v.indexBuffer,v.segments,t.paint,i.transform.zoom,_,i.style.map.terrain&&v.centroidVertexBuffer)}}h(fy,"drawExtrusionTiles");R();function HV(i,e,t,r){if(i.renderPass!=="offscreen"&&i.renderPass!=="translucent")return;let n=i.context,a=i.depthModeForSublayer(0,ri.ReadOnly),o=i.colorModeForRenderPass(),[s,l]=i.renderPass==="translucent"?i.stencilConfigForOverlap(r):[{},r];for(let u of l){let c=e.getTile(u);typeof c.needsHillshadePrepare<"u"&&c.needsHillshadePrepare&&i.renderPass==="offscreen"?WV(i,c,t,a,Hi.disabled,o):i.renderPass==="translucent"&&GV(i,u,c,t,a,s[u.overscaledZ],o)}n.viewport.set([0,0,i.width,i.height])}h(HV,"drawHillshade");function GV(i,e,t,r,n,a,o){let s=i.context,l=s.gl,u=t.fbo;if(!u)return;let c=i.useProgram("hillshade"),p=i.style.map.terrain&&i.style.map.terrain.getTerrainData(e);s.activeTexture.set(l.TEXTURE0),l.bindTexture(l.TEXTURE_2D,u.colorAttachment.get());let d=p?e:null;c.draw(s,l.TRIANGLES,n,a,o,Bi.disabled,tce(i,t,r,d),p,r.id,i.rasterBoundsBuffer,i.quadTriangleIndexBuffer,i.rasterBoundsSegments)}h(GV,"renderHillshade");function WV(i,e,t,r,n,a){let o=i.context,s=o.gl,l=e.dem;if(l&&l.data){let u=l.dim,c=l.stride,p=l.getPixels();if(o.activeTexture.set(s.TEXTURE1),o.pixelStoreUnpackPremultiplyAlpha.set(!1),e.demTexture=e.demTexture||i.getTileTexture(c),e.demTexture){let m=e.demTexture;m.update(p,{premultiply:!1}),m.bind(s.NEAREST,s.CLAMP_TO_EDGE)}else e.demTexture=new Rr(o,p,s.RGBA,{premultiply:!1}),e.demTexture.bind(s.NEAREST,s.CLAMP_TO_EDGE);o.activeTexture.set(s.TEXTURE0);let d=e.fbo;if(!d){let m=new Rr(o,{width:u,height:u,data:null},s.RGBA);m.bind(s.LINEAR,s.CLAMP_TO_EDGE),d=e.fbo=o.createFramebuffer(u,u,!0,!1),d.colorAttachment.set(m.texture)}o.bindFramebuffer.set(d.framebuffer),o.viewport.set([0,0,u,u]),i.useProgram("hillshadePrepare").draw(o,s.TRIANGLES,r,n,a,Bi.disabled,ice(e.tileID,l),null,t.id,i.rasterBoundsBuffer,i.quadTriangleIndexBuffer,i.rasterBoundsSegments),e.needsHillshadePrepare=!1}}h(WV,"prepareHillshade");R();function XV(i,e,t,r){if(i.renderPass!=="translucent"||t.paint.get("raster-opacity")===0||!r.length)return;let n=i.context,a=n.gl,o=e.getSource(),s=i.useProgram("raster"),l=i.colorModeForRenderPass(),[u,c]=o instanceof wm?[{},r]:i.stencilConfigForOverlap(r),p=c[c.length-1].overscaledZ,d=!i.options.moving;for(let m of c){let g=i.depthModeForSublayer(m.overscaledZ-p,t.paint.get("raster-opacity")===1?ri.ReadWrite:ri.ReadOnly,a.LESS),b=e.getTile(m);b.registerFadeDuration(t.paint.get("raster-fade-duration"));let x=e.findLoadedParent(m,0),v=qV(b,x,e,t,i.transform,i.style.map.terrain),w,_,C=t.paint.get("raster-resampling")==="nearest"?a.NEAREST:a.LINEAR;n.activeTexture.set(a.TEXTURE0),b.texture.bind(C,a.CLAMP_TO_EDGE,a.LINEAR_MIPMAP_NEAREST),n.activeTexture.set(a.TEXTURE1),x?(x.texture.bind(C,a.CLAMP_TO_EDGE,a.LINEAR_MIPMAP_NEAREST),w=Math.pow(2,x.tileID.overscaledZ-b.tileID.overscaledZ),_=[b.tileID.canonical.x*w%1,b.tileID.canonical.y*w%1]):b.texture.bind(C,a.CLAMP_TO_EDGE,a.LINEAR_MIPMAP_NEAREST);let E=i.style.map.terrain&&i.style.map.terrain.getTerrainData(m),T=E?m:null,L=T?T.posMatrix:i.transform.calculatePosMatrix(m.toUnwrapped(),d),D=cce(L,_||[0,0],w||1,v,t);o instanceof wm?s.draw(n,a.TRIANGLES,g,Hi.disabled,l,Bi.disabled,D,E,t.id,o.boundsBuffer,i.quadTriangleIndexBuffer,o.boundsSegments):s.draw(n,a.TRIANGLES,g,u[m.overscaledZ],l,Bi.disabled,D,E,t.id,i.rasterBoundsBuffer,i.quadTriangleIndexBuffer,i.rasterBoundsSegments)}}h(XV,"drawRaster");function qV(i,e,t,r,n,a){let o=r.paint.get("raster-fade-duration");if(!a&&o>0){let s=ai.now(),l=(s-i.timeAdded)/o,u=e?(s-e.timeAdded)/o:-1,c=t.getSource(),p=n.coveringZoomLevel({tileSize:c.tileSize,roundZoom:c.roundZoom}),d=!e||Math.abs(e.tileID.overscaledZ-p)>Math.abs(i.tileID.overscaledZ-p),m=d&&i.refreshedUponExpiration?1:Tr(d?l:1-u,0,1);return i.refreshedUponExpiration&&l>=1&&(i.refreshedUponExpiration=!1),e?{opacity:1,mix:1-m}:{opacity:m,mix:0}}else return{opacity:1,mix:0}}h(qV,"getFadeValues");R();function ZV(i,e,t,r){let n=t.paint.get("background-color"),a=t.paint.get("background-opacity");if(a===0)return;let o=i.context,s=o.gl,l=i.transform,u=l.tileSize,c=t.paint.get("background-pattern");if(i.isPatternMissing(c))return;let p=!c&&n.a===1&&a===1&&i.opaquePassEnabledForLayer()?"opaque":"translucent";if(i.renderPass!==p)return;let d=Hi.disabled,m=i.depthModeForSublayer(0,p==="opaque"?ri.ReadWrite:ri.ReadOnly),g=i.colorModeForRenderPass(),b=i.useProgram(c?"backgroundPattern":"background"),x=r||l.coveringTiles({tileSize:u,terrain:i.style.map.terrain});c&&(o.activeTexture.set(s.TEXTURE0),i.imageManager.bind(i.context));let v=t.getCrossfadeParameters();for(let w of x){let _=r?w.posMatrix:i.transform.calculatePosMatrix(w.toUnwrapped()),C=c?xce(_,a,i,c,{tileID:w,tileSize:u},v):vce(_,a,n),E=i.style.map.terrain&&i.style.map.terrain.getTerrainData(w);b.draw(o,s.TRIANGLES,m,d,g,Bi.disabled,C,E,t.id,i.tileExtentBuffer,i.quadTriangleIndexBuffer,i.tileExtentSegments)}}h(ZV,"drawBackground");R();var upe=new zt(1,0,0,1),hpe=new zt(0,1,0,1),cpe=new zt(0,0,1,1),ppe=new zt(1,0,1,1),dpe=new zt(0,1,1,1);function YV(i){let e=i.transform.padding,t=3;n3(i,i.transform.height-(e.top||0),t,upe),n3(i,e.bottom||0,t,hpe),a3(i,e.left||0,t,cpe),a3(i,i.transform.width-(e.right||0),t,ppe);let r=i.transform.centerPoint;JV(i,r.x,i.transform.height-r.y,dpe)}h(YV,"drawDebugPadding");function JV(i,e,t,r){Em(i,e-2/2,t-20/2,2,20,r),Em(i,e-20/2,t-2/2,20,2,r)}h(JV,"drawCrosshair");function n3(i,e,t,r){Em(i,0,e+t/2,i.transform.width,t,r)}h(n3,"drawHorizontalLine");function a3(i,e,t,r){Em(i,e-t/2,0,t,i.transform.height,r)}h(a3,"drawVerticalLine");function Em(i,e,t,r,n,a){let o=i.context,s=o.gl;s.enable(s.SCISSOR_TEST),s.scissor(e*i.pixelRatio,t*i.pixelRatio,r*i.pixelRatio,n*i.pixelRatio),o.clear({color:a}),s.disable(s.SCISSOR_TEST)}h(Em,"drawDebugSSRect");function KV(i,e,t){for(let r=0;r<t.length;r++)QV(i,e,t[r])}h(KV,"drawDebug");function QV(i,e,t){let r=i.context,n=r.gl,a=t.posMatrix,o=i.useProgram("debug"),s=ri.disabled,l=Hi.disabled,u=i.colorModeForRenderPass(),c="$debug",p=i.style.map.terrain&&i.style.map.terrain.getTerrainData(t);r.activeTexture.set(n.TEXTURE0);let d=e.getTileByID(t.key).latestRawTileData,m=d&&d.byteLength||0,g=Math.floor(m/1024),b=e.getTile(t).tileSize,x=512/Math.min(b,512)*(t.overscaledZ/i.transform.zoom)*.5,v=t.canonical.toString();t.overscaledZ!==t.canonical.z&&(v+=` => ${t.overscaledZ}`);let w=`${v} ${g}kB`;ej(i,w),o.draw(r,n.TRIANGLES,s,l,yr.alphaBlended,Bi.disabled,lA(a,zt.transparent,x),null,c,i.debugBuffer,i.quadTriangleIndexBuffer,i.debugSegments),o.draw(r,n.LINE_STRIP,s,l,u,Bi.disabled,lA(a,zt.red),p,c,i.debugBuffer,i.tileBorderIndexBuffer,i.debugSegments)}h(QV,"drawDebugTile");function ej(i,e){i.initDebugOverlayCanvas();let t=i.debugOverlayCanvas,r=i.context.gl,n=i.debugOverlayCanvas.getContext("2d");n.clearRect(0,0,t.width,t.height),n.shadowColor="white",n.shadowBlur=2,n.lineWidth=1.5,n.strokeStyle="white",n.textBaseline="top",n.font="bold 36px Open Sans, sans-serif",n.fillText(e,5,5),n.strokeText(e,5,5),i.debugOverlayTexture.update(t),i.debugOverlayTexture.bind(r.LINEAR,r.CLAMP_TO_EDGE)}h(ej,"drawTextToOverlay");function tj(i,e){let t=null,r=Object.values(i._layers).flatMap(s=>s.source&&!s.isHidden(e)?[i.sourceCaches[s.source]]:[]),n=r.filter(s=>s.getSource().type==="vector"),a=r.filter(s=>s.getSource().type!=="vector"),o=h(s=>{(!t||t.getSource().maxzoom<s.getSource().maxzoom)&&(t=s)},"considerSource");return n.forEach(s=>o(s)),t||a.forEach(s=>o(s)),t}h(tj,"selectDebugSource");R();function ij(i,e,t){let r=i.context,n=t.implementation;if(i.renderPass==="offscreen"){let a=n.prerender;a&&(i.setCustomLayerDefaults(),r.setColorMode(i.colorModeForRenderPass()),a.call(n,r.gl,i.transform.customLayerMatrix()),r.setDirty(),i.setBaseState())}else if(i.renderPass==="translucent"){i.setCustomLayerDefaults(),r.setColorMode(i.colorModeForRenderPass()),r.setStencilMode(Hi.disabled);let a=n.renderingMode==="3d"?new ri(i.context.gl.LEQUAL,ri.ReadWrite,i.depthRangeFor3D):i.depthModeForSublayer(0,ri.ReadOnly);r.setDepthMode(a),n.render(r.gl,i.transform.customLayerMatrix()),r.setDirty(),i.setBaseState(),r.bindFramebuffer.set(null)}}h(ij,"drawCustom");R();function rj(i,e){let t=i.context,r=t.gl,n=yr.unblended,a=new ri(r.LEQUAL,ri.ReadWrite,[0,1]),o=e.getTerrainMesh(),s=e.sourceCache.getRenderableTiles(),l=i.useProgram("terrainDepth");t.bindFramebuffer.set(e.getFramebuffer("depth").framebuffer),t.viewport.set([0,0,i.width/devicePixelRatio,i.height/devicePixelRatio]),t.clear({color:zt.transparent,depth:1});for(let u of s){let c=e.getTerrainData(u.tileID),p=i.transform.calculatePosMatrix(u.tileID.toUnwrapped()),d=Ahe(p,e.getMeshFrameDelta(i.transform.zoom));l.draw(t,r.TRIANGLES,a,Hi.disabled,n,Bi.backCCW,d,c,"terrain",o.vertexBuffer,o.indexBuffer,o.segments)}t.bindFramebuffer.set(null),t.viewport.set([0,0,i.width,i.height])}h(rj,"drawDepth");function nj(i,e){let t=i.context,r=t.gl,n=yr.unblended,a=new ri(r.LEQUAL,ri.ReadWrite,[0,1]),o=e.getTerrainMesh(),s=e.getCoordsTexture(),l=e.sourceCache.getRenderableTiles(),u=i.useProgram("terrainCoords");t.bindFramebuffer.set(e.getFramebuffer("coords").framebuffer),t.viewport.set([0,0,i.width/devicePixelRatio,i.height/devicePixelRatio]),t.clear({color:zt.transparent,depth:1}),e.coordsIndex=[];for(let c of l){let p=e.getTerrainData(c.tileID);t.activeTexture.set(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,s.texture);let d=i.transform.calculatePosMatrix(c.tileID.toUnwrapped()),m=Ihe(d,255-e.coordsIndex.length,e.getMeshFrameDelta(i.transform.zoom));u.draw(t,r.TRIANGLES,a,Hi.disabled,n,Bi.backCCW,m,p,"terrain",o.vertexBuffer,o.indexBuffer,o.segments),e.coordsIndex.push(c.tileID.key)}t.bindFramebuffer.set(null),t.viewport.set([0,0,i.width,i.height])}h(nj,"drawCoords");function o3(i,e,t){let r=i.context,n=r.gl,a=i.colorModeForRenderPass(),o=new ri(n.LEQUAL,ri.ReadWrite,i.depthRangeFor3D),s=i.useProgram("terrain"),l=e.getTerrainMesh();r.bindFramebuffer.set(null),r.viewport.set([0,0,i.width,i.height]);for(let u of t){let c=i.renderToTexture.getTexture(u),p=e.getTerrainData(u.tileID);r.activeTexture.set(n.TEXTURE0),n.bindTexture(n.TEXTURE_2D,c.texture);let d=i.transform.calculatePosMatrix(u.tileID.toUnwrapped()),m=Phe(d,e.getMeshFrameDelta(i.transform.zoom));s.draw(r,n.TRIANGLES,o,Hi.disabled,a,Bi.backCCW,m,p,"terrain",l.vertexBuffer,l.indexBuffer,l.segments)}}h(o3,"drawTerrain");var aj=class{constructor(e,t){this.context=new spe(e),this.transform=t,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:lt.identity(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=Sm.maxUnderzooming+Sm.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new MU}resize(e,t,r){if(this.width=Math.floor(e*r),this.height=Math.floor(t*r),this.pixelRatio=r,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(let n of this.style._order)this.style._layers[n].resize()}setup(){let e=this.context,t=new sy;t.emplaceBack(0,0),t.emplaceBack(8192,0),t.emplaceBack(0,8192),t.emplaceBack(8192,8192),this.tileExtentBuffer=e.createVertexBuffer(t,G_.members),this.tileExtentSegments=cr.simpleSegment(0,0,4,2);let r=new sy;r.emplaceBack(0,0),r.emplaceBack(8192,0),r.emplaceBack(0,8192),r.emplaceBack(8192,8192),this.debugBuffer=e.createVertexBuffer(r,G_.members),this.debugSegments=cr.simpleSegment(0,0,4,5);let n=new $R;n.emplaceBack(0,0,0,0),n.emplaceBack(8192,0,8192,0),n.emplaceBack(0,8192,0,8192),n.emplaceBack(8192,8192,8192,8192),this.rasterBoundsBuffer=e.createVertexBuffer(n,kx.members),this.rasterBoundsSegments=cr.simpleSegment(0,0,4,2);let a=new sy;a.emplaceBack(0,0),a.emplaceBack(1,0),a.emplaceBack(0,1),a.emplaceBack(1,1),this.viewportBuffer=e.createVertexBuffer(a,G_.members),this.viewportSegments=cr.simpleSegment(0,0,4,2);let o=new Poe;o.emplaceBack(0),o.emplaceBack(1),o.emplaceBack(3),o.emplaceBack(2),o.emplaceBack(0),this.tileBorderIndexBuffer=e.createIndexBuffer(o);let s=new ch;s.emplaceBack(0,1,2),s.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=e.createIndexBuffer(s);let l=this.context.gl;this.stencilClearMode=new Hi({func:l.ALWAYS,mask:0},0,255,l.ZERO,l.ZERO,l.ZERO)}clearStencil(){let e=this.context,t=e.gl;this.nextStencilID=1,this.currentStencilSource=void 0;let r=lt.create();lt.ortho(r,0,this.width,this.height,0,0,1),lt.scale(r,r,[t.drawingBufferWidth,t.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(e,t.TRIANGLES,ri.disabled,this.stencilClearMode,yr.disabled,Bi.disabled,uA(r),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(e,t){if(this.currentStencilSource===e.source||!e.isTileClipped()||!t||!t.length)return;this.currentStencilSource=e.source;let r=this.context,n=r.gl;this.nextStencilID+t.length>256&&this.clearStencil(),r.setColorMode(yr.disabled),r.setDepthMode(ri.disabled);let a=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(let o of t){let s=this._tileClippingMaskIDs[o.key]=this.nextStencilID++,l=this.style.map.terrain&&this.style.map.terrain.getTerrainData(o);a.draw(r,n.TRIANGLES,ri.disabled,new Hi({func:n.ALWAYS,mask:0},s,255,n.KEEP,n.KEEP,n.REPLACE),yr.disabled,Bi.disabled,uA(o.posMatrix),l,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();let e=this.nextStencilID++,t=this.context.gl;return new Hi({func:t.NOTEQUAL,mask:255},e,255,t.KEEP,t.KEEP,t.REPLACE)}stencilModeForClipping(e){let t=this.context.gl;return new Hi({func:t.EQUAL,mask:255},this._tileClippingMaskIDs[e.key],0,t.KEEP,t.KEEP,t.REPLACE)}stencilConfigForOverlap(e){let t=this.context.gl,r=e.sort((o,s)=>s.overscaledZ-o.overscaledZ),n=r[r.length-1].overscaledZ,a=r[0].overscaledZ-n+1;if(a>1){this.currentStencilSource=void 0,this.nextStencilID+a>256&&this.clearStencil();let o={};for(let s=0;s<a;s++)o[s+n]=new Hi({func:t.GEQUAL,mask:255},s+this.nextStencilID,255,t.KEEP,t.KEEP,t.REPLACE);return this.nextStencilID+=a,[o,r]}return[{[n]:Hi.disabled},r]}colorModeForRenderPass(){let e=this.context.gl;return this._showOverdrawInspector?new yr([e.CONSTANT_COLOR,e.ONE],new zt(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?yr.unblended:yr.alphaBlended}depthModeForSublayer(e,t,r){if(!this.opaquePassEnabledForLayer())return ri.disabled;let n=1-((1+this.currentLayer)*this.numSublayers+e)*this.depthEpsilon;return new ri(r||this.context.gl.LEQUAL,t,[n,n])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(e,t){this.style=e,this.options=t,this.lineAtlas=e.lineAtlas,this.imageManager=e.imageManager,this.glyphManager=e.glyphManager,this.symbolFadeChange=e.placement.symbolFadeChange(ai.now()),this.imageManager.beginFrame();let r=this.style._order,n=this.style.sourceCaches,a={},o={},s={};for(let l in n){let u=n[l];u.used&&u.prepare(this.context),a[l]=u.getVisibleCoordinates(),o[l]=a[l].slice().reverse(),s[l]=u.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let l=0;l<r.length;l++){let u=r[l];if(this.style._layers[u].is3D()){this.opaquePassCutoff=l;break}}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(let l of r){let u=this.style._layers[l];if(!u.hasOffscreenPass()||u.isHidden(this.transform.zoom))continue;let c=o[u.source];u.type!=="custom"&&!c.length||this.renderLayer(this,n[u.source],u,c)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:t.showOverdrawInspector?zt.black:zt.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=t.showOverdrawInspector,this.depthRangeFor3D=[0,1-(e._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=r.length-1;this.currentLayer>=0;this.currentLayer--){let l=this.style._layers[r[this.currentLayer]],u=n[l.source],c=a[l.source];this._renderTileClippingMasks(l,c),this.renderLayer(this,u,l,c)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<r.length;this.currentLayer++){let l=this.style._layers[r[this.currentLayer]],u=n[l.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(l))continue;let c=(l.type==="symbol"?s:o)[l.source];this._renderTileClippingMasks(l,a[l.source]),this.renderLayer(this,u,l,c)}if(this.options.showTileBoundaries){let l=tj(this.style,this.transform.zoom);l&&KV(this,l,l.getVisibleCoordinates())}this.options.showPadding&&YV(this),this.context.setDefault()}maybeDrawDepthAndCoords(e){if(!this.style||!this.style.map||!this.style.map.terrain)return;let t=this.terrainFacilitator.matrix,r=this.transform.projMatrix,n=this.terrainFacilitator.dirty;n||(n=e?!lt.exactEquals(t,r):!lt.equals(t,r)),n||(n=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime).length>0),n&&(lt.copy(t,r),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,rj(this,this.style.map.terrain),nj(this,this.style.map.terrain))}renderLayer(e,t,r,n){if(!r.isHidden(this.transform.zoom)&&!(r.type!=="background"&&r.type!=="custom"&&!(n||[]).length))switch(this.id=r.id,r.type){case"symbol":LV(e,t,r,n,this.style.placement.variableOffsets);break;case"circle":zV(e,t,r,n);break;case"heatmap":BV(e,t,r,n);break;case"line":UV(e,t,r,n);break;case"fill":VV(e,t,r,n);break;case"fill-extrusion":jV(e,t,r,n);break;case"hillshade":HV(e,t,r,n);break;case"raster":XV(e,t,r,n);break;case"background":ZV(e,t,r,n);break;case"custom":ij(e,t,r);break}}translatePosMatrix(e,t,r,n,a){if(!r[0]&&!r[1])return e;let o=a?n==="map"?this.transform.angle:0:n==="viewport"?-this.transform.angle:0;if(o){let u=Math.sin(o),c=Math.cos(o);r=[r[0]*c-r[1]*u,r[0]*u+r[1]*c]}let s=[a?r[0]:qn(t,r[0],this.transform.zoom),a?r[1]:qn(t,r[1],this.transform.zoom),0],l=new Float32Array(16);return lt.translate(l,e,s),l}saveTileTexture(e){let t=this._tileTextures[e.size[0]];t?t.push(e):this._tileTextures[e.size[0]]=[e]}getTileTexture(e){let t=this._tileTextures[e];return t&&t.length>0?t.pop():null}isPatternMissing(e){if(!e)return!1;if(!e.from||!e.to)return!0;let t=this.imageManager.getPattern(e.from.toString()),r=this.imageManager.getPattern(e.to.toString());return!t||!r}useProgram(e,t){this.cache=this.cache||{};let r=e+(t?t.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[r]||(this.cache[r]=new Lhe(this.context,tf[e],t,_ce[e],this._showOverdrawInspector,this.style.map.terrain)),this.cache[r]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){let e=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(e.FUNC_ADD)}initDebugOverlayCanvas(){if(this.debugOverlayCanvas==null){this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512;let e=this.context.gl;this.debugOverlayTexture=new Rr(this.context,this.debugOverlayCanvas,e.RGBA)}}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){let{drawingBufferWidth:e,drawingBufferHeight:t}=this.context.gl;return this.width!==e||this.height!==t}};h(aj,"Painter");var fpe=aj;R();var wr=It(di(),1);R();var oj=class sj{constructor(e,t){this.points=e,this.planes=t}static fromInvProjectionMatrix(e,t,r){let n=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]],a=Math.pow(2,r),o=n.map(l=>{l=wn.transformMat4([],l,e);let u=1/l[3]/t*a;return wn.mul(l,l,[u,u,1/l[3],u])}),s=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(l=>{let u=uo.sub([],o[l[0]],o[l[1]]),c=uo.sub([],o[l[2]],o[l[1]]),p=uo.normalize([],uo.cross([],u,c)),d=-uo.dot(p,o[l[1]]);return p.concat(d)});return new sj(o,s)}};h(oj,"Frustum");var mpe=oj,lj=class uj{constructor(e,t){this.min=e,this.max=t,this.center=uo.scale([],uo.add([],this.min,this.max),.5)}quadrant(e){let t=[e%2===0,e<2],r=uo.clone(this.min),n=uo.clone(this.max);for(let a=0;a<t.length;a++)r[a]=t[a]?this.min[a]:this.center[a],n[a]=t[a]?this.center[a]:this.max[a];return n[2]=this.max[2],new uj(r,n)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}intersects(e){let t=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]],r=!0;for(let n=0;n<e.planes.length;n++){let a=e.planes[n],o=0;for(let s=0;s<t.length;s++)wn.dot(a,t[s])>=0&&o++;if(o===0)return 0;o!==t.length&&(r=!1)}if(r)return 2;for(let n=0;n<3;n++){let a=Number.MAX_VALUE,o=-Number.MAX_VALUE;for(let s=0;s<e.points.length;s++){let l=e.points[s][n]-this.min[n];a=Math.min(a,l),o=Math.max(o,l)}if(o<0||a>this.max[n]-this.min[n])return 0}return 1}};h(lj,"Aabb");var hA=lj;R();var gpe=It(di(),1),hj=class cj{constructor(e=0,t=0,r=0,n=0){if(isNaN(e)||e<0||isNaN(t)||t<0||isNaN(r)||r<0||isNaN(n)||n<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=e,this.bottom=t,this.left=r,this.right=n}interpolate(e,t,r){return t.top!=null&&e.top!=null&&(this.top=ji.number(e.top,t.top,r)),t.bottom!=null&&e.bottom!=null&&(this.bottom=ji.number(e.bottom,t.bottom,r)),t.left!=null&&e.left!=null&&(this.left=ji.number(e.left,t.left,r)),t.right!=null&&e.right!=null&&(this.right=ji.number(e.right,t.right,r)),this}getCenter(e,t){let r=Tr((this.left+e-this.right)/2,0,e),n=Tr((this.top+t-this.bottom)/2,0,t);return new gpe.default(r,n)}equals(e){return this.top===e.top&&this.bottom===e.bottom&&this.left===e.left&&this.right===e.right}clone(){return new cj(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}};h(hj,"EdgeInsets");var ype=hj,jg=85.051129,pj=class dj{constructor(e,t,r,n,a){this.tileSize=512,this._renderWorldCopies=a===void 0?!0:!!a,this._minZoom=e||0,this._maxZoom=t||22,this._minPitch=r??0,this._maxPitch=n??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new Jt(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new ype,this._posMatrixCache={},this._alignedPosMatrixCache={},this.minElevationForCurrentTile=0}clone(){let e=new dj(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return e.apply(this),e}apply(e){this.tileSize=e.tileSize,this.latRange=e.latRange,this.width=e.width,this.height=e.height,this._center=e._center,this._elevation=e._elevation,this.minElevationForCurrentTile=e.minElevationForCurrentTile,this.zoom=e.zoom,this.angle=e.angle,this._fov=e._fov,this._pitch=e._pitch,this._unmodified=e._unmodified,this._edgeInsets=e._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(e){this._minZoom!==e&&(this._minZoom=e,this.zoom=Math.max(this.zoom,e))}get maxZoom(){return this._maxZoom}set maxZoom(e){this._maxZoom!==e&&(this._maxZoom=e,this.zoom=Math.min(this.zoom,e))}get minPitch(){return this._minPitch}set minPitch(e){this._minPitch!==e&&(this._minPitch=e,this.pitch=Math.max(this.pitch,e))}get maxPitch(){return this._maxPitch}set maxPitch(e){this._maxPitch!==e&&(this._maxPitch=e,this.pitch=Math.min(this.pitch,e))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(e){e===void 0?e=!0:e===null&&(e=!1),this._renderWorldCopies=e}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new wr.default(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(e){let t=-Eu(e,-180,180)*Math.PI/180;this.angle!==t&&(this._unmodified=!1,this.angle=t,this._calcMatrices(),this.rotationMatrix=Aw.create(),Aw.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(e){let t=Tr(e,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==t&&(this._unmodified=!1,this._pitch=t,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(e){e=Math.max(.01,Math.min(60,e)),this._fov!==e&&(this._unmodified=!1,this._fov=e/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(e){let t=Math.min(Math.max(e,this.minZoom),this.maxZoom);this._zoom!==t&&(this._unmodified=!1,this._zoom=t,this.tileZoom=Math.max(0,Math.floor(t)),this.scale=this.zoomScale(t),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(e){e.lat===this._center.lat&&e.lng===this._center.lng||(this._unmodified=!1,this._center=e,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(e){e!==this._elevation&&(this._elevation=e,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(e){this._edgeInsets.equals(e)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,e,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(e){return this._edgeInsets.equals(e)}interpolatePadding(e,t,r){this._unmodified=!1,this._edgeInsets.interpolate(e,t,r),this._constrain(),this._calcMatrices()}coveringZoomLevel(e){let t=(e.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/e.tileSize));return Math.max(0,t)}getVisibleUnwrappedCoordinates(e){let t=[new Vw(0,e)];if(this._renderWorldCopies){let r=this.pointCoordinate(new wr.default(0,0)),n=this.pointCoordinate(new wr.default(this.width,0)),a=this.pointCoordinate(new wr.default(this.width,this.height)),o=this.pointCoordinate(new wr.default(0,this.height)),s=Math.floor(Math.min(r.x,n.x,a.x,o.x)),l=Math.floor(Math.max(r.x,n.x,a.x,o.x)),u=1;for(let c=s-u;c<=l+u;c++)c!==0&&t.push(new Vw(c,e))}return t}coveringTiles(e){var t,r;let n=this.coveringZoomLevel(e),a=n;if(e.minzoom!==void 0&&n<e.minzoom)return[];e.maxzoom!==void 0&&n>e.maxzoom&&(n=e.maxzoom);let o=this.pointCoordinate(this.getCameraPoint()),s=qr.fromLngLat(this.center),l=Math.pow(2,n),u=[l*o.x,l*o.y,0],c=[l*s.x,l*s.y,0],p=mpe.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,n),d=e.minzoom||0;!e.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(d=n);let m=e.terrain?2/Math.min(this.tileSize,e.tileSize)*this.tileSize:3,g=h(_=>({aabb:new hA([_*l,0,0],[(_+1)*l,l,0]),zoom:0,x:0,y:0,wrap:_,fullyVisible:!1}),"newRootTile"),b=[],x=[],v=n,w=e.reparseOverscaled?a:n;if(this._renderWorldCopies)for(let _=1;_<=3;_++)b.push(g(-_)),b.push(g(_));for(b.push(g(0));b.length>0;){let _=b.pop(),C=_.x,E=_.y,T=_.fullyVisible;if(!T){let $=_.aabb.intersects(p);if($===0)continue;T=$===2}let L=e.terrain?u:c,D=_.aabb.distanceX(L),B=_.aabb.distanceY(L),A=Math.max(Math.abs(D),Math.abs(B)),k=m+(1<<v-_.zoom)-2;if(_.zoom===v||A>k&&_.zoom>=d){let $=v-_.zoom,O=u[0]-.5-(C<<$),P=u[1]-.5-(E<<$);x.push({tileID:new ra(_.zoom===v?w:_.zoom,_.wrap,_.zoom,C,E),distanceSq:S5.sqrLen([c[0]-.5-C,c[1]-.5-E]),tileDistanceToCamera:Math.sqrt(O*O+P*P)});continue}for(let $=0;$<4;$++){let O=(C<<1)+$%2,P=(E<<1)+($>>1),U=_.zoom+1,G=_.aabb.quadrant($);if(e.terrain){let K=new ra(U,_.wrap,U,O,P),z=e.terrain.getMinMaxElevation(K),V=(t=z.minElevation)!=null?t:this.elevation,j=(r=z.maxElevation)!=null?r:this.elevation;G=new hA([G.min[0],G.min[1],V],[G.max[0],G.max[1],j])}b.push({aabb:G,zoom:U,x:O,y:P,wrap:_.wrap,fullyVisible:T})}}return x.sort((_,C)=>_.distanceSq-C.distanceSq).map(_=>_.tileID)}resize(e,t){this.width=e,this.height=t,this.pixelsToGLUnits=[2/e,-2/t],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(e){return Math.pow(2,e)}scaleZoom(e){return Math.log(e)/Math.LN2}project(e){let t=Tr(e.lat,-jg,jg);return new wr.default(ku(e.lng)*this.worldSize,Ru(t)*this.worldSize)}unproject(e){return new qr(e.x/this.worldSize,e.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}getCameraPosition(){let e=this.pointLocation(this.getCameraPoint()),t=Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter;return{lngLat:e,altitude:t+this.elevation}}recalculateZoom(e){let t=this.elevation,r=Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter,n=this.pointLocation(this.centerPoint,e),a=e.getElevationForLngLatZoom(n,this.tileZoom);if(!(this.elevation-a))return;let o=r+t-a,s=Math.cos(this._pitch)*this.cameraToCenterDistance/o/uv(1,n.lat)/this.tileSize,l=this.scaleZoom(s);this._elevation=a,this._center=n,this.zoom=l}setLocationAtPoint(e,t){let r=this.pointCoordinate(t),n=this.pointCoordinate(this.centerPoint),a=this.locationCoordinate(e),o=new qr(a.x-(r.x-n.x),a.y-(r.y-n.y));this.center=this.coordinateLocation(o),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(e,t){return t?this.coordinatePoint(this.locationCoordinate(e),t.getElevationForLngLatZoom(e,this.tileZoom),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(e))}pointLocation(e,t){return this.coordinateLocation(this.pointCoordinate(e,t))}locationCoordinate(e){return qr.fromLngLat(e)}coordinateLocation(e){return e&&e.toLngLat()}pointCoordinate(e,t){if(t){let b=t.pointCoordinate(e);if(b!=null)return b}let r=0,n=[e.x,e.y,0,1],a=[e.x,e.y,1,1];wn.transformMat4(n,n,this.pixelMatrixInverse),wn.transformMat4(a,a,this.pixelMatrixInverse);let o=n[3],s=a[3],l=n[0]/o,u=a[0]/s,c=n[1]/o,p=a[1]/s,d=n[2]/o,m=a[2]/s,g=d===m?0:(r-d)/(m-d);return new qr(ji.number(l,u,g)/this.worldSize,ji.number(c,p,g)/this.worldSize)}coordinatePoint(e,t=0,r=this.pixelMatrix){let n=[e.x*this.worldSize,e.y*this.worldSize,t,1];return wn.transformMat4(n,n,r),new wr.default(n[0]/n[3],n[1]/n[3])}getBounds(){let e=Math.max(0,this.height/2-this.getHorizon());return new zl().extend(this.pointLocation(new wr.default(0,e))).extend(this.pointLocation(new wr.default(this.width,e))).extend(this.pointLocation(new wr.default(this.width,this.height))).extend(this.pointLocation(new wr.default(0,this.height)))}getMaxBounds(){return!this.latRange||this.latRange.length!==2||!this.lngRange||this.lngRange.length!==2?null:new zl([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]])}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(e){e?(this.lngRange=[e.getWest(),e.getEast()],this.latRange=[e.getSouth(),e.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-jg,jg])}calculatePosMatrix(e,t=!1){let r=e.key,n=t?this._alignedPosMatrixCache:this._posMatrixCache;if(n[r])return n[r];let a=e.canonical,o=this.worldSize/this.zoomScale(a.z),s=a.x+Math.pow(2,a.z)*e.wrap,l=lt.identity(new Float64Array(16));return lt.translate(l,l,[s*o,a.y*o,0]),lt.scale(l,l,[o/8192,o/8192,1]),lt.multiply(l,t?this.alignedProjMatrix:this.projMatrix,l),n[r]=new Float32Array(l),n[r]}customLayerMatrix(){return this.mercatorMatrix.slice()}getConstrained(e,t){t=Tr(+t,this.minZoom,this.maxZoom);let r={center:new Jt(e.lng,e.lat),zoom:t},n=this.lngRange;if(!this._renderWorldCopies&&n===null){let _=179.9999999999;n=[-_,_]}let a=this.tileSize*this.zoomScale(r.zoom),o=0,s=a,l=0,u=a,c=0,p=0,{x:d,y:m}=this.size;if(this.latRange){let _=this.latRange;o=Ru(_[1])*a,s=Ru(_[0])*a,s-o<m&&(c=m/(s-o))}n&&(l=Eu(ku(n[0])*a,0,a),u=Eu(ku(n[1])*a,0,a),u<l&&(u+=a),u-l<d&&(p=d/(u-l)));let{x:g,y:b}=this.project.call({worldSize:a},e),x,v,w=Math.max(p||0,c||0);if(w){let _=new wr.default(p?(u+l)/2:g,c?(s+o)/2:b);return r.center=this.unproject.call({worldSize:a},_).wrap(),r.zoom+=this.scaleZoom(w),r}if(this.latRange){let _=m/2;b-_<o&&(v=o+_),b+_>s&&(v=s-_)}if(n){let _=(l+u)/2,C=g;this._renderWorldCopies&&(C=Eu(g,_-a/2,_+a/2));let E=d/2;C-E<l&&(x=l+E),C+E>u&&(x=u-E)}if(x!==void 0||v!==void 0){let _=new wr.default(x??g,v??b);r.center=this.unproject.call({worldSize:a},_).wrap()}return r}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;let e=this._unmodified,{center:t,zoom:r}=this.getConstrained(this.center,this.zoom);this.center=t,this.zoom=r,this._unmodified=e,this._constraining=!1}_calcMatrices(){if(!this.height)return;let e=this._fov/2,t=this.centerOffset,r=this.point.x,n=this.point.y;this.cameraToCenterDistance=.5/Math.tan(e)*this.height,this._pixelPerMeter=uv(1,this.center.lat)*this.worldSize;let a=lt.identity(new Float64Array(16));lt.scale(a,a,[this.width/2,-this.height/2,1]),lt.translate(a,a,[1,-1,0]),this.labelPlaneMatrix=a,a=lt.identity(new Float64Array(16)),lt.scale(a,a,[1,-1,1]),lt.translate(a,a,[-1,-1,0]),lt.scale(a,a,[2/this.width,2/this.height,1]),this.glCoordMatrix=a;let o=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch),s=Math.min(this.elevation,this.minElevationForCurrentTile),l=o-s*this._pixelPerMeter/Math.cos(this._pitch),u=s<0?l:o,c=Math.PI/2+this._pitch,p=this._fov*(.5+t.y/this.height),d=Math.sin(p)*u/Math.sin(Tr(Math.PI-c-p,.01,Math.PI-.01)),m=this.getHorizon(),g=2*Math.atan(m/this.cameraToCenterDistance)*(.5+t.y/(m*2)),b=Math.sin(g)*u/Math.sin(Tr(Math.PI-c-g,.01,Math.PI-.01)),x=Math.min(d,b),v=(Math.cos(Math.PI/2-this._pitch)*x+u)*1.01,w=this.height/50;a=new Float64Array(16),lt.perspective(a,this._fov,this.width/this.height,w,v),a[8]=-t.x*2/this.width,a[9]=t.y*2/this.height,lt.scale(a,a,[1,-1,1]),lt.translate(a,a,[0,0,-this.cameraToCenterDistance]),lt.rotateX(a,a,this._pitch),lt.rotateZ(a,a,this.angle),lt.translate(a,a,[-r,-n,0]),this.mercatorMatrix=lt.scale([],a,[this.worldSize,this.worldSize,this.worldSize]),lt.scale(a,a,[1,1,this._pixelPerMeter]),this.pixelMatrix=lt.multiply(new Float64Array(16),this.labelPlaneMatrix,a),lt.translate(a,a,[0,0,-this.elevation]),this.projMatrix=a,this.invProjMatrix=lt.invert([],a),this.pixelMatrix3D=lt.multiply(new Float64Array(16),this.labelPlaneMatrix,a);let _=this.width%2/2,C=this.height%2/2,E=Math.cos(this.angle),T=Math.sin(this.angle),L=r-Math.round(r)+E*_+T*C,D=n-Math.round(n)+E*C+T*_,B=new Float64Array(a);if(lt.translate(B,B,[L>.5?L-1:L,D>.5?D-1:D,0]),this.alignedProjMatrix=B,a=lt.invert(new Float64Array(16),this.pixelMatrix),!a)throw new Error("failed to invert matrix");this.pixelMatrixInverse=a,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;let e=this.pointCoordinate(new wr.default(0,0)),t=[e.x*this.worldSize,e.y*this.worldSize,0,1];return wn.transformMat4(t,t,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){let e=this._pitch,t=Math.tan(e)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new wr.default(0,t))}getCameraQueryGeometry(e){let t=this.getCameraPoint();if(e.length===1)return[e[0],t];{let r=t.x,n=t.y,a=t.x,o=t.y;for(let s of e)r=Math.min(r,s.x),n=Math.min(n,s.y),a=Math.max(a,s.x),o=Math.max(o,s.y);return[new wr.default(r,n),new wr.default(a,n),new wr.default(a,o),new wr.default(r,o),new wr.default(r,n)]}}lngLatToCameraDepth(e,t){let r=this.locationCoordinate(e),n=[r.x*this.worldSize,r.y*this.worldSize,t,1];return wn.transformMat4(n,n,this.projMatrix),n[2]/n[3]}};h(pj,"Transform");var vpe=pj;R();R();function aE(i,e){let t=!1,r=null,n=null,a,o=h(()=>{r=null,t&&(i.apply(n,a),r=setTimeout(o,e),t=!1)},"later");return(...s)=>(t=!0,n=this,a=s,r||o(),r)}h(aE,"throttle");var fj=class{constructor(e){this._getCurrentHash=()=>{let t=window.location.hash.replace("#","");if(this._hashName){let r;return t.split("&").map(n=>n.split("=")).forEach(n=>{n[0]===this._hashName&&(r=n)}),(r&&r[1]||"").split("/")}return t.split("/")},this._onHashChange=()=>{let t=this._getCurrentHash();if(t.length>=3&&!t.some(r=>isNaN(r))){let r=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(t[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+t[2],+t[1]],zoom:+t[0],bearing:r,pitch:+(t[4]||0)}),!0}return!1},this._updateHashUnthrottled=()=>{let t=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,t)}catch{}},this._updateHash=aE(this._updateHashUnthrottled,30*1e3/100),this._hashName=e&&encodeURIComponent(e)}addTo(e){return this._map=e,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(e){let t=this._map.getCenter(),r=Math.round(this._map.getZoom()*100)/100,n=Math.ceil((r*Math.LN2+Math.log(512/360/.5))/Math.LN10),a=Math.pow(10,n),o=Math.round(t.lng*a)/a,s=Math.round(t.lat*a)/a,l=this._map.getBearing(),u=this._map.getPitch(),c="";if(e?c+=`/${o}/${s}/${r}`:c+=`${r}/${s}/${o}`,(l||u)&&(c+=`/${Math.round(l*10)/10}`),u&&(c+=`/${Math.round(u)}`),this._hashName){let p=this._hashName,d=!1,m=window.location.hash.slice(1).split("&").map(g=>{let b=g.split("=")[0];return b===p?(d=!0,`${b}=${c}`):g}).filter(g=>g);return d||m.push(`${p}=${c}`),`#${m.join("&")}`}return`#${c}`}};h(fj,"Hash");var xpe=fj;R();R();var _pe=It(di(),1),Bx={linearity:.3,easing:ex(0,0,.3,1)},bpe=ht({deceleration:2500,maxSpeed:1400},Bx),wpe=ht({deceleration:20,maxSpeed:1400},Bx),Spe=ht({deceleration:1e3,maxSpeed:360},Bx),Mpe=ht({deceleration:1e3,maxSpeed:90},Bx),mj=class{constructor(e){this._map=e,this.clear()}clear(){this._inertiaBuffer=[]}record(e){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:ai.now(),settings:e})}_drainInertiaBuffer(){let e=this._inertiaBuffer,t=ai.now(),r=160;for(;e.length>0&&t-e[0].time>r;)e.shift()}_onMoveEnd(e){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;let t={zoom:0,bearing:0,pitch:0,pan:new _pe.default(0,0),pinchAround:void 0,around:void 0};for(let{settings:a}of this._inertiaBuffer)t.zoom+=a.zoomDelta||0,t.bearing+=a.bearingDelta||0,t.pitch+=a.pitchDelta||0,a.panDelta&&t.pan._add(a.panDelta),a.around&&(t.around=a.around),a.pinchAround&&(t.pinchAround=a.pinchAround);let r=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,n={};if(t.pan.mag()){let a=nf(t.pan.mag(),r,ht({},bpe,e||{}));n.offset=t.pan.mult(a.amount/t.pan.mag()),n.center=this._map.transform.center,rf(n,a)}if(t.zoom){let a=nf(t.zoom,r,wpe);n.zoom=this._map.transform.zoom+a.amount,rf(n,a)}if(t.bearing){let a=nf(t.bearing,r,Spe);n.bearing=this._map.transform.bearing+Tr(a.amount,-179,179),rf(n,a)}if(t.pitch){let a=nf(t.pitch,r,Mpe);n.pitch=this._map.transform.pitch+a.amount,rf(n,a)}if(n.zoom||n.bearing){let a=t.pinchAround===void 0?t.around:t.pinchAround;n.around=a?this._map.unproject(a):this._map.getCenter()}return this.clear(),ht(n,{noMoveStart:!0})}};h(mj,"HandlerInertia");var Cpe=mj;function rf(i,e){(!i.duration||i.duration<e.duration)&&(i.duration=e.duration,i.easing=e.easing)}h(rf,"extendDuration");function nf(i,e,t){let{maxSpeed:r,linearity:n,deceleration:a}=t,o=Tr(i*n/(e/1e3),-r,r),s=Math.abs(o)/(a*n);return{easing:t.easing,duration:s*1e3,amount:o*(s/2)}}h(nf,"calculateEasing");R();R();var Epe=It(di(),1),gj=class extends qe{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,t,r,n={}){let a=Ve.mousePos(t.getCanvas(),r),o=t.unproject(a);super(e,ht({point:a,lngLat:o,originalEvent:r},n)),this._defaultPrevented=!1,this.target=t}};h(gj,"MapMouseEvent");var Aa=gj,yj=class extends qe{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,t,r){let n=e==="touchend"?r.changedTouches:r.touches,a=Ve.touchPos(t.getCanvasContainer(),n),o=a.map(u=>t.unproject(u)),s=a.reduce((u,c,p,d)=>u.add(c.div(d.length)),new Epe.default(0,0)),l=t.unproject(s);super(e,{points:a,point:s,lngLats:o,lngLat:l,originalEvent:r}),this._defaultPrevented=!1}};h(yj,"MapTouchEvent");var Hg=yj,vj=class extends qe{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,t,r){super(e,{originalEvent:r}),this._defaultPrevented=!1}};h(vj,"MapWheelEvent");var Tpe=vj,xj=class{constructor(e,t){this._map=e,this._clickTolerance=t.clickTolerance}reset(){delete this._mousedownPos}wheel(e){return this._firePreventable(new Tpe(e.type,this._map,e))}mousedown(e,t){return this._mousedownPos=t,this._firePreventable(new Aa(e.type,this._map,e))}mouseup(e){this._map.fire(new Aa(e.type,this._map,e))}click(e,t){this._mousedownPos&&this._mousedownPos.dist(t)>=this._clickTolerance||this._map.fire(new Aa(e.type,this._map,e))}dblclick(e){return this._firePreventable(new Aa(e.type,this._map,e))}mouseover(e){this._map.fire(new Aa(e.type,this._map,e))}mouseout(e){this._map.fire(new Aa(e.type,this._map,e))}touchstart(e){return this._firePreventable(new Hg(e.type,this._map,e))}touchmove(e){this._map.fire(new Hg(e.type,this._map,e))}touchend(e){this._map.fire(new Hg(e.type,this._map,e))}touchcancel(e){this._map.fire(new Hg(e.type,this._map,e))}_firePreventable(e){if(this._map.fire(e),e.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}};h(xj,"MapEventHandler");var Ppe=xj,_j=class{constructor(e){this._map=e}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(e){this._map.fire(new Aa(e.type,this._map,e))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Aa("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(e){this._delayContextMenu?this._contextMenuEvent=e:this._ignoreContextMenu||this._map.fire(new Aa(e.type,this._map,e)),this._map.listens("contextmenu")&&e.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}};h(_j,"BlockableMapEventHandler");var Ape=_j;R();R();var Ipe=It(di(),1),bj=class{constructor(e){this._map=e}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(e){return this.transform.pointLocation(Ipe.default.convert(e),this._map.terrain)}};h(bj,"TransformProvider");var Qm=bj,wj=class{constructor(e,t){this._map=e,this._tr=new Qm(e),this._el=e.getCanvasContainer(),this._container=e.getContainer(),this._clickTolerance=t.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){console.warn("boxZoom will not work. Use SDK interaction events instead.")}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(e,t){this.isEnabled()&&e.shiftKey&&e.button===0&&(Ve.disableDrag(),this._startPos=this._lastPos=t,this._active=!0)}mousemoveWindow(e,t){if(!this._active)return;let r=t;if(this._lastPos.equals(r)||!this._box&&r.dist(this._startPos)<this._clickTolerance)return;let n=this._startPos;this._lastPos=r,this._box||(this._box=Ve.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",e));let a=Math.min(n.x,r.x),o=Math.max(n.x,r.x),s=Math.min(n.y,r.y),l=Math.max(n.y,r.y);Ve.setTransform(this._box,`translate(${a}px,${s}px)`),this._box.style.width=`${o-a}px`,this._box.style.height=`${l-s}px`}mouseupWindow(e,t){if(!this._active||e.button!==0)return;let r=this._startPos,n=t;if(this.reset(),Ve.suppressClick(),r.x===n.x&&r.y===n.y)this._fireEvent("boxzoomcancel",e);else return this._map.fire(new qe("boxzoomend",{originalEvent:e})),{cameraAnimation:a=>a.fitScreenCoordinates(r,n,this._tr.bearing,{linear:!0})}}keydown(e){this._active&&e.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",e))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(Ve.remove(this._box),this._box=null),Ve.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(e,t){return this._map.fire(new qe(e,{originalEvent:t}))}};h(wj,"BoxZoomHandler");var Lpe=wj;R();R();var Dpe=It(di(),1);R();function fv(i,e){if(i.length!==e.length)throw new Error(`The number of touches and points are not equal - touches ${i.length}, points ${e.length}`);let t={};for(let r=0;r<i.length;r++)t[i[r].identifier]=e[r];return t}h(fv,"indexTouches");function Sj(i){let e=new Dpe.default(0,0);for(let t of i)e._add(t);return e.div(i.length)}h(Sj,"getCentroid");var Mj=500,kpe=500,oE=30,Cj=class{constructor(e){this.reset(),this.numTouches=e.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(e,t,r){(this.centroid||r.length>this.numTouches)&&(this.aborted=!0),!this.aborted&&(this.startTime===void 0&&(this.startTime=e.timeStamp),r.length===this.numTouches&&(this.centroid=Sj(t),this.touches=fv(r,t)))}touchmove(e,t,r){if(this.aborted||!this.centroid)return;let n=fv(r,t);for(let a in this.touches){let o=this.touches[a],s=n[a];(!s||s.dist(o)>oE)&&(this.aborted=!0)}}touchend(e,t,r){if((!this.centroid||e.timeStamp-this.startTime>kpe)&&(this.aborted=!0),r.length===0){let n=!this.aborted&&this.centroid;if(this.reset(),n)return n}}};h(Cj,"SingleTapRecognizer");var Rpe=Cj,Ej=class{constructor(e){this.singleTap=new Rpe(e),this.numTaps=e.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(e,t,r){this.singleTap.touchstart(e,t,r)}touchmove(e,t,r){this.singleTap.touchmove(e,t,r)}touchend(e,t,r){let n=this.singleTap.touchend(e,t,r);if(n){let a=e.timeStamp-this.lastTime<Mj,o=!this.lastTap||this.lastTap.dist(n)<oE;if((!a||!o)&&this.reset(),this.count++,this.lastTime=e.timeStamp,this.lastTap=n,this.count===this.numTaps)return this.reset(),n}}};h(Ej,"TapRecognizer");var s3=Ej,Tj=class{constructor(e){this._tr=new Qm(e),this._zoomIn=new s3({numTouches:1,numTaps:2}),this._zoomOut=new s3({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(e,t,r){this._zoomIn.touchstart(e,t,r),this._zoomOut.touchstart(e,t,r)}touchmove(e,t,r){this._zoomIn.touchmove(e,t,r),this._zoomOut.touchmove(e,t,r)}touchend(e,t,r){let n=this._zoomIn.touchend(e,t,r),a=this._zoomOut.touchend(e,t,r),o=this._tr;if(n)return this._active=!0,e.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:s=>s.easeTo({duration:300,zoom:o.zoom+1,around:o.unproject(n)},{originalEvent:e})};if(a)return this._active=!0,e.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:s=>s.easeTo({duration:300,zoom:o.zoom-1,around:o.unproject(a)},{originalEvent:e})}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}};h(Tj,"TapZoomHandler");var Fpe=Tj;R();R();var Pj=class{constructor(e){this._enabled=!!e.enable,this._moveStateManager=e.moveStateManager,this._clickTolerance=e.clickTolerance||1,this._moveFunction=e.move,this._activateOnStart=!!e.activateOnStart,e.assignEvents(this),this.reset()}reset(e){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(e)}_move(...e){let t=this._moveFunction(...e);if(t.bearingDelta||t.pitchDelta||t.around||t.panDelta)return this._active=!0,t}dragStart(e,t){!this.isEnabled()||this._lastPoint||this._moveStateManager.isValidStartEvent(e)&&(this._moveStateManager.startMove(e),this._lastPoint=t.length?t[0]:t,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(e,t){if(!this.isEnabled())return;let r=this._lastPoint;if(!r)return;if(e.preventDefault(),!this._moveStateManager.isValidMoveEvent(e)){this.reset(e);return}let n=t.length?t[0]:t;if(!(!this._moved&&n.dist(r)<this._clickTolerance))return this._moved=!0,this._lastPoint=n,this._move(r,n)}dragEnd(e){!this.isEnabled()||!this._lastPoint||this._moveStateManager.isValidEndEvent(e)&&(this._moved&&Ve.suppressClick(),this.reset(e))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}};h(Pj,"DragHandler");var eg=Pj;R();var zpe=0,Bpe=2,Ope={[zpe]:1,[Bpe]:2};function Aj(i,e){let t=Ope[e];return i.buttons===void 0||(i.buttons&t)!==t}h(Aj,"buttonNoLongerPressed");var Ij=class{constructor(e){this._correctEvent=e.checkCorrectEvent}startMove(e){let t=Ve.mouseButton(e);this._eventButton=t}endMove(e){delete this._eventButton}isValidStartEvent(e){return this._correctEvent(e)}isValidMoveEvent(e){return!Aj(e,this._eventButton)}isValidEndEvent(e){return Ve.mouseButton(e)===this._eventButton}};h(Ij,"MouseMoveStateManager");var sE=Ij,Lj=class{constructor(){this._firstTouch=void 0}_isOneFingerTouch(e){return e.targetTouches.length===1}_isSameTouchEvent(e){return e.targetTouches[0].identifier===this._firstTouch}startMove(e){let t=e.targetTouches[0].identifier;this._firstTouch=t}endMove(e){delete this._firstTouch}isValidStartEvent(e){return this._isOneFingerTouch(e)}isValidMoveEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}isValidEndEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}};h(Lj,"OneFingerTouchMoveStateManager");var Dj=Lj,lE=0,kj=2,uE=h(i=>{i.mousedown=i.dragStart,i.mousemoveWindow=i.dragMove,i.mouseup=i.dragEnd,i.contextmenu=function(e){e.preventDefault()}},"assignEvents"),Npe=h(({enable:i,clickTolerance:e})=>{let t=new sE({checkCorrectEvent:r=>Ve.mouseButton(r)===lE&&!r.ctrlKey});return new eg({clickTolerance:e,move:(r,n)=>({around:n,panDelta:n.sub(r)}),activateOnStart:!0,moveStateManager:t,enable:i,assignEvents:uE})},"generateMousePanHandler"),Rj=h(({enable:i,clickTolerance:e,bearingDegreesPerPixelMoved:t=.8})=>{let r=new sE({checkCorrectEvent:n=>Ve.mouseButton(n)===lE&&n.ctrlKey||Ve.mouseButton(n)===kj});return new eg({clickTolerance:e,move:(n,a)=>({bearingDelta:(a.x-n.x)*t}),moveStateManager:r,enable:i,assignEvents:uE})},"generateMouseRotationHandler"),Fj=h(({enable:i,clickTolerance:e,pitchDegreesPerPixelMoved:t=-.5})=>{let r=new sE({checkCorrectEvent:n=>Ve.mouseButton(n)===lE&&n.ctrlKey||Ve.mouseButton(n)===kj});return new eg({clickTolerance:e,move:(n,a)=>({pitchDelta:(a.y-n.y)*t}),moveStateManager:r,enable:i,assignEvents:uE})},"generateMousePitchHandler");R();var q_=It(di(),1),zj=class{constructor(e,t){this._clickTolerance=e.clickTolerance||1,this._map=t,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new q_.default(0,0)}minTouchs(){return this._map.cooperativeGestures.isEnabled()?2:1}touchstart(e,t,r){return this._calculateTransform(e,t,r)}touchmove(e,t,r){if(!(!this._active||r.length<this.minTouchs()))return e.preventDefault(),this._calculateTransform(e,t,r)}touchend(e,t,r){this._calculateTransform(e,t,r),this._active&&r.length<this.minTouchs()&&this.reset()}touchcancel(){this.reset()}_calculateTransform(e,t,r){r.length>0&&(this._active=!0);let n=fv(r,t),a=new q_.default(0,0),o=new q_.default(0,0),s=0;for(let u in n){let c=n[u],p=this._touches[u];p&&(a._add(c),o._add(c.sub(p)),s++,n[u]=c)}if(this._touches=n,s<this.minTouchs()||!o.mag())return;let l=o.div(s);return this._sum._add(l),this._sum.mag()<this._clickTolerance?void 0:{around:a.div(s),panDelta:l}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}};h(zj,"TouchPanHandler");var $pe=zj;R();var Bj=class{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(e,t,r){this._firstTwoTouches||r.length<2||(this._firstTwoTouches=[r[0].identifier,r[1].identifier],this._start([t[0],t[1]]))}touchmove(e,t,r){if(!this._firstTwoTouches)return;e.preventDefault();let[n,a]=this._firstTwoTouches,o=af(r,t,n),s=af(r,t,a);if(!o||!s)return;let l=this._aroundCenter?null:o.add(s).div(2);return this._move([o,s],l,e)}touchend(e,t,r){if(!this._firstTwoTouches)return;let[n,a]=this._firstTwoTouches,o=af(r,t,n),s=af(r,t,a);o&&s||(this._active&&Ve.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(e){this._enabled=!0,this._aroundCenter=!!e&&e.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}};h(Bj,"TwoFingersTouchHandler");var hE=Bj;function af(i,e,t){for(let r=0;r<i.length;r++)if(i[r].identifier===t)return e[r]}h(af,"getTouchById");var Upe=.1;function l3(i,e){return Math.log(i/e)/Math.LN2}h(l3,"getZoomDelta");var Oj=class extends hE{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(e){this._startDistance=this._distance=e[0].dist(e[1])}_move(e,t){let r=this._distance;if(this._distance=e[0].dist(e[1]),!(!this._active&&Math.abs(l3(this._distance,this._startDistance))<Upe))return this._active=!0,{zoomDelta:l3(this._distance,r),pinchAround:t}}};h(Oj,"TwoFingersTouchZoomHandler");var Vpe=Oj,jpe=25;function u3(i,e){return i.angleWith(e)*180/Math.PI}h(u3,"getBearingDelta");var Nj=class extends hE{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(e){this._startVector=this._vector=e[0].sub(e[1]),this._minDiameter=e[0].dist(e[1])}_move(e,t,r){let n=this._vector;if(this._vector=e[0].sub(e[1]),!(!this._active&&this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:u3(this._vector,n),pinchAround:t}}_isBelowThreshold(e){this._minDiameter=Math.min(this._minDiameter,e.mag());let t=Math.PI*this._minDiameter,r=jpe/t*360,n=u3(e,this._startVector);return Math.abs(n)<r}};h(Nj,"TwoFingersTouchRotateHandler");var Hpe=Nj;function my(i){return Math.abs(i.y)>Math.abs(i.x)}h(my,"isVertical");var Gpe=100,$j=class extends hE{constructor(e){super(),this._currentTouchCount=0,this._map=e}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(e,t,r){super.touchstart(e,t,r),this._currentTouchCount=r.length}_start(e){this._lastPoints=e,my(e[0].sub(e[1]))&&(this._valid=!1)}_move(e,t,r){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;let n=e[0].sub(this._lastPoints[0]),a=e[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(n,a,r.timeStamp),this._valid?(this._lastPoints=e,this._active=!0,{pitchDelta:(n.y+a.y)/2*-.5}):void 0}gestureBeginsVertically(e,t,r){if(this._valid!==void 0)return this._valid;let n=2,a=e.mag()>=n,o=t.mag()>=n;if(!a&&!o)return;if(!a||!o)return this._firstMove===void 0&&(this._firstMove=r),r-this._firstMove<Gpe?void 0:!1;let s=e.y>0==t.y>0;return my(e)&&my(t)&&s}};h($j,"TwoFingersTouchPitchHandler");var Wpe=$j;R();var Xpe={panStep:100,bearingStep:15,pitchStep:10},Uj=class{constructor(e){this._tr=new Qm(e);let t=Xpe;this._panStep=t.panStep,this._bearingStep=t.bearingStep,this._pitchStep=t.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(e){if(e.altKey||e.ctrlKey||e.metaKey)return;let t=0,r=0,n=0,a=0,o=0;switch(e.keyCode){case 61:case 107:case 171:case 187:t=1;break;case 189:case 109:case 173:t=-1;break;case 37:e.shiftKey?r=-1:(e.preventDefault(),a=-1);break;case 39:e.shiftKey?r=1:(e.preventDefault(),a=1);break;case 38:e.shiftKey?n=1:(e.preventDefault(),o=-1);break;case 40:e.shiftKey?n=-1:(e.preventDefault(),o=1);break;default:return}return this._rotationDisabled&&(r=0,n=0),{cameraAnimation:s=>{let l=this._tr;s.easeTo({duration:300,easeId:"keyboardHandler",easing:Vj,zoom:t?Math.round(l.zoom)+t*(e.shiftKey?2:1):l.zoom,bearing:l.bearing+r*this._bearingStep,pitch:l.pitch+n*this._pitchStep,offset:[-a*this._panStep,-o*this._panStep],center:l.center},{originalEvent:e})}}}enable(){console.warn("maplibre keyboard events are not supported, use SDK keyboard events instead.")}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}};h(Uj,"KeyboardHandler");var qpe=Uj;function Vj(i){return i*(2-i)}h(Vj,"easeOut");R();var cA=4.000244140625,Zpe=1/100,Ype=1/450,Jpe=2,jj=class{constructor(e,t){this._onTimeout=r=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(r)},this._map=e,this._tr=new Qm(e),this._triggerRenderFrame=t,this._delta=0,this._defaultZoomRate=Zpe,this._wheelZoomRate=Ype}setZoomRate(e){this._defaultZoomRate=e}setWheelZoomRate(e){this._wheelZoomRate=e}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(e){console.log("Enable maplibre scrollZoom events will not work. Use Mappedin SDK interactions events instead.")}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(e){if(!this.isEnabled()||this._map.cooperativeGestures.isEnabled()&&!e[this._map.cooperativeGestures._bypassKey])return;let t=e.deltaMode===WheelEvent.DOM_DELTA_LINE?e.deltaY*40:e.deltaY,r=ai.now(),n=r-(this._lastWheelEventTime||0);this._lastWheelEventTime=r,t!==0&&t%cA===0?this._type="wheel":t!==0&&Math.abs(t)<4?this._type="trackpad":n>400?(this._type=null,this._lastValue=t,this._timeout=setTimeout(this._onTimeout,40,e)):this._type||(this._type=Math.abs(n*t)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,t+=this._lastValue)),e.shiftKey&&t&&(t=t/4),this._type&&(this._lastWheelEvent=e,this._delta-=t,this._active||this._start(e)),e.preventDefault()}_start(e){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);let t=Ve.mousePos(this._map.getCanvas(),e),r=this._tr;t.y>r.transform.height/2-r.transform.getHorizon()?this._around=Jt.convert(this._aroundCenter?r.center:r.unproject(t)):this._around=Jt.convert(r.center),this._aroundPoint=r.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;let e=this._tr.transform;if(this._delta!==0){let s=this._type==="wheel"&&Math.abs(this._delta)>cA?this._wheelZoomRate:this._defaultZoomRate,l=Jpe/(1+Math.exp(-Math.abs(this._delta*s)));this._delta<0&&l!==0&&(l=1/l);let u=typeof this._targetZoom=="number"?e.zoomScale(this._targetZoom):e.scale;this._targetZoom=Math.min(e.maxZoom,Math.max(e.minZoom,e.scaleZoom(u*l))),this._type==="wheel"&&(this._startZoom=e.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}let t=typeof this._targetZoom=="number"?this._targetZoom:e.zoom,r=this._startZoom,n=this._easing,a=!1,o;if(this._type==="wheel"&&r&&n){let s=Math.min((ai.now()-this._lastWheelEventTime)/200,1),l=n(s);o=ji.number(r,t,l),s<1?this._frameId||(this._frameId=!0):a=!0}else o=t,a=!0;return this._active=!0,a&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!a,zoomDelta:o-e.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(e){let t=jb;if(this._prevEase){let r=this._prevEase,n=(ai.now()-r.start)/r.duration,a=r.easing(n+.01)-r.easing(n),o=.27/Math.sqrt(a*a+1e-4)*.01,s=Math.sqrt(.27*.27-o*o);t=ex(o,s,.25,1)}return this._prevEase={start:ai.now(),duration:e,easing:t},t}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}};h(jj,"ScrollZoomHandler");var Kpe=jj;R();var Hj=class{constructor(e,t){this._clickZoom=e,this._tapZoom=t}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}};h(Hj,"DoubleClickZoomHandler");var Qpe=Hj;R();var Gj=class{constructor(e){this._tr=new Qm(e),this.reset()}reset(){this._active=!1}dblclick(e,t){return e.preventDefault(),{cameraAnimation:r=>{r.easeTo({duration:300,zoom:this._tr.zoom+(e.shiftKey?-1:1),around:this._tr.unproject(t)},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}};h(Gj,"ClickZoomHandler");var ede=Gj;R();var Wj=class{constructor(){this._tap=new s3({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(e,t,r){if(!this._swipePoint)if(!this._tapTime)this._tap.touchstart(e,t,r);else{let n=t[0],a=e.timeStamp-this._tapTime<Mj,o=this._tapPoint.dist(n)<oE;!a||!o?this.reset():r.length>0&&(this._swipePoint=n,this._swipeTouch=r[0].identifier)}}touchmove(e,t,r){if(!this._tapTime)this._tap.touchmove(e,t,r);else if(this._swipePoint){if(r[0].identifier!==this._swipeTouch)return;let n=t[0],a=n.y-this._swipePoint.y;return this._swipePoint=n,e.preventDefault(),this._active=!0,{zoomDelta:a/128}}}touchend(e,t,r){if(this._tapTime)this._swipePoint&&r.length===0&&this.reset();else{let n=this._tap.touchend(e,t,r);n&&(this._tapTime=e.timeStamp,this._tapPoint=n)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}};h(Wj,"TapDragZoomHandler");var tde=Wj;R();var Xj=class{constructor(e,t,r){this._el=e,this._mousePan=t,this._touchPan=r}enable(e){console.log("Maplibre interaction is not supported. Use Mappedin SDK interaction instead")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}};h(Xj,"DragPanHandler");var ide=Xj;R();var qj=class{constructor(e,t,r){this._pitchWithRotate=e.pitchWithRotate,this._mouseRotate=t,this._mousePitch=r}enable(){console.warn("dragRotate does not work. Use SDK interaction events instead.")}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}};h(qj,"DragRotateHandler");var rde=qj;R();var Zj=class{constructor(e,t,r,n){this._el=e,this._touchZoom=t,this._touchRotate=r,this._tapDragZoom=n,this._rotationDisabled=!1,this._enabled=!0}enable(e){this._touchZoom.enable(e),this._rotationDisabled||this._touchRotate.enable(e),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}};h(Zj,"TwoFingersTouchZoomRotateHandler");var nde=Zj;R();var Yj=class{constructor(e,t){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=e,this._options=t,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;let e=this._map.getCanvasContainer();e.classList.add("maplibregl-cooperative-gestures"),this._container=Ve.create("div","maplibregl-cooperative-gesture-screen",e);let t=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(t=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));let r=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),n=document.createElement("div");n.className="maplibregl-desktop-message",n.textContent=t,this._container.appendChild(n);let a=document.createElement("div");a.className="maplibregl-mobile-message",a.textContent=r,this._container.appendChild(a),this._container.setAttribute("aria-hidden","true")}_destoryUI(){this._container&&(Ve.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destoryUI()}isEnabled(){return this._enabled}touchmove(e){this._onCooperativeGesture(e.touches.length===1)}wheel(e){this._map.scrollZoom.isEnabled()&&this._onCooperativeGesture(!e[this._bypassKey])}_onCooperativeGesture(e){!this._enabled||!e||(this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}};h(Yj,"CooperativeGesturesHandler");var ade=Yj,ode=It(di(),1),Gg=h(i=>i.zoom||i.drag||i.pitch||i.rotate,"isMoving"),Jj=class extends qe{};h(Jj,"RenderFrameEvent");var sde=Jj;function gy(i){return i.panDelta&&i.panDelta.mag()||i.zoomDelta||i.bearingDelta||i.pitchDelta}h(gy,"hasChange");var Kj=class{constructor(e,t){this.handleWindowEvent=n=>{this.handleEvent(n,`${n.type}Window`)},this.handleEvent=(n,a)=>{if(n.type==="blur"){this.stop(!0);return}this._updatingCamera=!0;let o=n.type==="renderFrame"?void 0:n,s={needsRenderFrame:!1},l={},u={},c=n.touches,p=c?this._getMapTouches(c):void 0,d=p?Ve.touchPos(this._map.getCanvas(),p):Ve.mousePos(this._map.getCanvas(),n);for(let{handlerName:b,handler:x,allowed:v}of this._handlers){if(!x.isEnabled())continue;let w;this._blockedByActive(u,v,b)?x.reset():x[a||n.type]&&(w=x[a||n.type](n,d,p),this.mergeHandlerResult(s,l,w,b,o),w&&w.needsRenderFrame&&this._triggerRenderFrame()),(w||x.isActive())&&(u[b]=x)}let m={};for(let b in this._previousActiveHandlers)u[b]||(m[b]=o);this._previousActiveHandlers=u,(Object.keys(m).length||gy(s))&&(this._changes.push([s,l,m]),this._triggerRenderFrame()),(Object.keys(u).length||gy(s))&&this._map._stop(!0),this._updatingCamera=!1;let{cameraAnimation:g}=s;g&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],g(this._map))},this._map=e,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Cpe(e),this._bearingSnap=t.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(t);let r=this._el;this._listeners=[[r,"touchstart",{passive:!0}],[r,"touchmove",{passive:!1}],[r,"touchend",void 0],[r,"touchcancel",void 0],[r,"mousedown",void 0],[r,"mousemove",void 0],[r,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[r,"mouseover",void 0],[r,"mouseout",void 0],[r,"dblclick",void 0],[r,"click",void 0],[r,"keydown",{capture:!1}],[r,"keyup",void 0],[r,"wheel",{passive:!1}],[r,"contextmenu",void 0],[window,"blur",void 0]];for(let[n,a,o]of this._listeners);}destroy(){for(let[e,t,r]of this._listeners)Ve.removeEventListener(e,t,e===document?this.handleWindowEvent:this.handleEvent,r)}_addDefaultHandlers(e){let t=this._map,r=t.getCanvasContainer();this._add("mapEvent",new Ppe(t,e));let n=t.boxZoom=new Lpe(t,e);this._add("boxZoom",n),e.interactive&&e.boxZoom&&n.enable();let a=t.cooperativeGestures=new ade(t,e.cooperativeGestures);this._add("cooperativeGestures",a),e.cooperativeGestures&&a.enable();let o=new Fpe(t),s=new ede(t);t.doubleClickZoom=new Qpe(s,o),this._add("tapZoom",o),this._add("clickZoom",s),e.interactive&&e.doubleClickZoom&&t.doubleClickZoom.enable();let l=new tde;this._add("tapDragZoom",l);let u=t.touchPitch=new Wpe(t);this._add("touchPitch",u),e.interactive&&e.touchPitch&&t.touchPitch.enable(e.touchPitch);let c=Rj(e),p=Fj(e);t.dragRotate=new rde(e,c,p),this._add("mouseRotate",c,["mousePitch"]),this._add("mousePitch",p,["mouseRotate"]),e.interactive&&e.dragRotate&&t.dragRotate.enable();let d=Npe(e),m=new $pe(e,t);t.dragPan=new ide(r,d,m),this._add("mousePan",d),this._add("touchPan",m,["touchZoom","touchRotate"]),e.interactive&&e.dragPan&&t.dragPan.enable(e.dragPan);let g=new Hpe,b=new Vpe;t.touchZoomRotate=new nde(r,b,g,l),this._add("touchRotate",g,["touchPan","touchZoom"]),this._add("touchZoom",b,["touchPan","touchRotate"]),e.interactive&&e.touchZoomRotate&&t.touchZoomRotate.enable(e.touchZoomRotate);let x=t.scrollZoom=new Kpe(t,()=>this._triggerRenderFrame());this._add("scrollZoom",x,["mousePan"]),e.interactive&&e.scrollZoom&&t.scrollZoom.enable(e.scrollZoom);let v=t.keyboard=new qpe(t);this._add("keyboard",v),e.interactive&&e.keyboard&&t.keyboard.enable(),this._add("blockableMapEvent",new Ape(t))}_add(e,t,r){this._handlers.push({handlerName:e,handler:t,allowed:r}),this._handlersById[e]=t}stop(e){if(!this._updatingCamera){for(let{handler:t}of this._handlers)t.reset();this._inertia.clear(),this._fireEvents({},{},e),this._changes=[]}}isActive(){for(let{handler:e}of this._handlers)if(e.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Gg(this._eventsInProgress)||this.isZooming()}_blockedByActive(e,t,r){for(let n in e)if(n!==r&&(!t||t.indexOf(n)<0))return!0;return!1}_getMapTouches(e){let t=[];for(let r of e){let n=r.target;this._el.contains(n)&&t.push(r)}return t}mergeHandlerResult(e,t,r,n,a){if(!r)return;ht(e,r);let o={handlerName:n,originalEvent:r.originalEvent||a};r.zoomDelta!==void 0&&(t.zoom=o),r.panDelta!==void 0&&(t.drag=o),r.pitchDelta!==void 0&&(t.pitch=o),r.bearingDelta!==void 0&&(t.rotate=o)}_applyChanges(){let e={},t={},r={};for(let[n,a,o]of this._changes)n.panDelta&&(e.panDelta=(e.panDelta||new ode.default(0,0))._add(n.panDelta)),n.zoomDelta&&(e.zoomDelta=(e.zoomDelta||0)+n.zoomDelta),n.bearingDelta&&(e.bearingDelta=(e.bearingDelta||0)+n.bearingDelta),n.pitchDelta&&(e.pitchDelta=(e.pitchDelta||0)+n.pitchDelta),n.around!==void 0&&(e.around=n.around),n.pinchAround!==void 0&&(e.pinchAround=n.pinchAround),n.noInertia&&(e.noInertia=n.noInertia),ht(t,a),ht(r,o);this._updateMapTransform(e,t,r),this._changes=[]}_updateMapTransform(e,t,r){let n=this._map,a=n._getTransformForUpdate(),o=n.terrain;if(!gy(e)&&!(o&&this._terrainMovement))return this._fireEvents(t,r,!0);let{panDelta:s,zoomDelta:l,bearingDelta:u,pitchDelta:c,around:p,pinchAround:d}=e;d!==void 0&&(p=d),n._stop(!0),p=p||n.transform.centerPoint;let m=a.pointLocation(s?p.sub(s):p);u&&(a.bearing+=u),c&&(a.pitch+=c),l&&(a.zoom+=l),o?!this._terrainMovement&&(t.drag||t.zoom)?(this._terrainMovement=!0,this._map._elevationFreeze=!0,a.setLocationAtPoint(m,p),this._map.once("moveend",()=>{this._map._elevationFreeze=!1,this._terrainMovement=!1,a.recalculateZoom(n.terrain)})):t.drag&&this._terrainMovement?a.center=a.pointLocation(a.centerPoint.sub(s)):a.setLocationAtPoint(m,p):a.setLocationAtPoint(m,p),n._applyUpdatedTransform(a),this._map._update(),e.noInertia||this._inertia.record(e),this._fireEvents(t,r,!0)}_fireEvents(e,t,r){let n=Gg(this._eventsInProgress),a=Gg(e),o={};for(let c in e){let{originalEvent:p}=e[c];this._eventsInProgress[c]||(o[`${c}start`]=p),this._eventsInProgress[c]=e[c]}!n&&a&&this._fireEvent("movestart",a.originalEvent);for(let c in o)this._fireEvent(c,o[c]);a&&this._fireEvent("move",a.originalEvent);for(let c in e){let{originalEvent:p}=e[c];this._fireEvent(c,p)}let s={},l;for(let c in this._eventsInProgress){let{handlerName:p,originalEvent:d}=this._eventsInProgress[c];this._handlersById[p].isActive()||(delete this._eventsInProgress[c],l=t[p]||d,s[`${c}end`]=l)}for(let c in s)this._fireEvent(c,s[c]);let u=Gg(this._eventsInProgress);if(r&&(n||a)&&!u){this._updatingCamera=!0;let c=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),p=h(d=>d!==0&&-this._bearingSnap<d&&d<this._bearingSnap,"shouldSnapToNorth");c&&(c.essential||!ai.prefersReducedMotion)?(p(c.bearing||this._map.getBearing())&&(c.bearing=0),c.freezeElevation=!0,this._map.easeTo(c,{originalEvent:l})):(this._map.fire(new qe("moveend",{originalEvent:l})),p(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(e,t){this._map.fire(new qe(e,t?{originalEvent:t}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(e=>{delete this._frameId,this.handleEvent(new sde("renderFrame",{timeStamp:e})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}};h(Kj,"HandlerManager");var lde=Kj;R();var Qo=It(di(),1),Qj=class extends hn{constructor(e,t){super(),this._renderFrameCallback=()=>{let r=Math.min((ai.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(r)),r<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=e,this._bearingSnap=t.bearingSnap,this.on("moveend",()=>{delete this._requestedCameraState})}getCenter(){return new Jt(this.transform.center.lng,this.transform.center.lat)}setCenter(e,t){return this.jumpTo({center:e},t)}panBy(e,t,r){return e=Qo.default.convert(e).mult(-1),this.panTo(this.transform.center,ht({offset:e},t),r)}panTo(e,t,r){return this.easeTo(ht({center:e},t),r)}getZoom(){return this.transform.zoom}setZoom(e,t){return this.jumpTo({zoom:e},t),this}zoomTo(e,t,r){return this.easeTo(ht({zoom:e},t),r)}zoomIn(e,t){return this.zoomTo(this.getZoom()+1,e,t),this}zoomOut(e,t){return this.zoomTo(this.getZoom()-1,e,t),this}getBearing(){return this.transform.bearing}setBearing(e,t){return this.jumpTo({bearing:e},t),this}getPadding(){return this.transform.padding}setPadding(e,t){return this.jumpTo({padding:e},t),this}rotateTo(e,t,r){return this.easeTo(ht({bearing:e},t),r)}resetNorth(e,t){return this.rotateTo(0,ht({duration:1e3},e),t),this}resetNorthPitch(e,t){return this.easeTo(ht({bearing:0,pitch:0,duration:1e3},e),t),this}snapToNorth(e,t){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(e,t):this}getPitch(){return this.transform.pitch}setPitch(e,t){return this.jumpTo({pitch:e},t),this}cameraForBounds(e,t){e=zl.convert(e);let r=t&&t.bearing||0;return this._cameraForBoxAndBearing(e.getNorthWest(),e.getSouthEast(),r,t)}_cameraForBoxAndBearing(e,t,r,n){let a={top:0,bottom:0,right:0,left:0};if(n=ht({padding:a,offset:[0,0],maxZoom:this.transform.maxZoom},n),typeof n.padding=="number"){let O=n.padding;n.padding={top:O,bottom:O,right:O,left:O}}n.padding=ht(a,n.padding);let o=this.transform,s=o.padding,l=new zl(e,t),u=o.project(l.getNorthWest()),c=o.project(l.getNorthEast()),p=o.project(l.getSouthEast()),d=o.project(l.getSouthWest()),m=Hb(-r),g=u.rotate(m),b=c.rotate(m),x=p.rotate(m),v=d.rotate(m),w=new Qo.default(Math.max(g.x,b.x,v.x,x.x),Math.max(g.y,b.y,v.y,x.y)),_=new Qo.default(Math.min(g.x,b.x,v.x,x.x),Math.min(g.y,b.y,v.y,x.y)),C=w.sub(_),E=(o.width-(s.left+s.right+n.padding.left+n.padding.right))/C.x,T=(o.height-(s.top+s.bottom+n.padding.top+n.padding.bottom))/C.y;if(T<0||E<0){ln("Map cannot fit within canvas with the given bounds, padding, and/or offset.");return}let L=Math.min(o.scaleZoom(o.scale*Math.min(E,T)),n.maxZoom),D=Qo.default.convert(n.offset),B=(n.padding.left-n.padding.right)/2,A=(n.padding.top-n.padding.bottom)/2,k=new Qo.default(B,A).rotate(Hb(r)),$=D.add(k).mult(o.scale/o.zoomScale(L));return{center:o.unproject(u.add(p).div(2).sub($)),zoom:L,bearing:r}}fitBounds(e,t,r){return this._fitInternal(this.cameraForBounds(e,t),t,r)}fitScreenCoordinates(e,t,r,n,a){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(Qo.default.convert(e)),this.transform.pointLocation(Qo.default.convert(t)),r,n),n,a)}_fitInternal(e,t,r){return e?(t=ht(e,t),delete t.padding,t.linear?this.easeTo(t,r):this.flyTo(t,r)):this}jumpTo(e,t){this.stop();let r=this._getTransformForUpdate(),n=!1,a=!1,o=!1;return"zoom"in e&&r.zoom!==+e.zoom&&(n=!0,r.zoom=+e.zoom),e.center!==void 0&&(r.center=Jt.convert(e.center)),"bearing"in e&&r.bearing!==+e.bearing&&(a=!0,r.bearing=+e.bearing),"pitch"in e&&r.pitch!==+e.pitch&&(o=!0,r.pitch=+e.pitch),e.padding!=null&&!r.isPaddingEqual(e.padding)&&(r.padding=e.padding),this._applyUpdatedTransform(r),this.fire(new qe("movestart",t)).fire(new qe("move",t)),n&&this.fire(new qe("zoomstart",t)).fire(new qe("zoom",t)).fire(new qe("zoomend",t)),a&&this.fire(new qe("rotatestart",t)).fire(new qe("rotate",t)).fire(new qe("rotateend",t)),o&&this.fire(new qe("pitchstart",t)).fire(new qe("pitch",t)).fire(new qe("pitchend",t)),this.fire(new qe("moveend",t))}calculateCameraOptionsFromTo(e,t,r,n=0){let a=qr.fromLngLat(e,t),o=qr.fromLngLat(r,n),s=o.x-a.x,l=o.y-a.y,u=o.z-a.z,c=Math.hypot(s,l,u);if(c===0)throw new Error("Can't calculate camera options with same From and To");let p=Math.hypot(s,l),d=this.transform.scaleZoom(this.transform.cameraToCenterDistance/c/this.transform.tileSize),m=Math.atan2(s,-l)*180/Math.PI,g=Math.acos(p/c)*180/Math.PI;return g=u<0?90-g:90+g,{center:o.toLngLat(),zoom:d,pitch:g,bearing:m}}easeTo(e,t){var r;this._stop(!1,e.easeId),e=ht({offset:[0,0],duration:500,easing:jb},e),(e.animate===!1||!e.essential&&ai.prefersReducedMotion)&&(e.duration=0);let n=this._getTransformForUpdate(),a=this.getZoom(),o=this.getBearing(),s=this.getPitch(),l=this.getPadding(),u="bearing"in e?this._normalizeBearing(e.bearing,o):o,c="pitch"in e?+e.pitch:s,p="padding"in e?e.padding:n.padding,d=Qo.default.convert(e.offset),m=n.centerPoint.add(d),g=n.pointLocation(m),{center:b,zoom:x}=n.getConstrained(Jt.convert(e.center||g),(r=e.zoom)!=null?r:a);this._normalizeCenter(b);let v=n.project(g),w=n.project(b).sub(v),_=n.zoomScale(x-a),C,E;e.around&&(C=Jt.convert(e.around),E=n.locationPoint(C));let T={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||x!==a,this._rotating=this._rotating||o!==u,this._pitching=this._pitching||c!==s,this._padding=!n.isPaddingEqual(p),this._easeId=e.easeId,this._prepareEase(t,e.noMoveStart,T),this.terrain&&this._prepareElevation(b),this._ease(L=>{if(this._zooming&&(n.zoom=ji.number(a,x,L)),this._rotating&&(n.bearing=ji.number(o,u,L)),this._pitching&&(n.pitch=ji.number(s,c,L)),this._padding&&(n.interpolatePadding(l,p,L),m=n.centerPoint.add(d)),this.terrain&&!e.freezeElevation&&this._updateElevation(L),C)n.setLocationAtPoint(C,E);else{let D=n.zoomScale(n.zoom-a),B=x>a?Math.min(2,_):Math.max(.5,_),A=Math.pow(B,1-L),k=n.unproject(v.add(w.mult(L*A)).mult(D));n.setLocationAtPoint(n.renderWorldCopies?k.wrap():k,m)}this._applyUpdatedTransform(n),this._fireMoveEvents(t)},L=>{this.terrain&&this._finalizeElevation(),this._afterEase(t,L)},e),this}_prepareEase(e,t,r={}){this._moving=!0,!t&&!r.moving&&this.fire(new qe("movestart",e)),this._zooming&&!r.zooming&&this.fire(new qe("zoomstart",e)),this._rotating&&!r.rotating&&this.fire(new qe("rotatestart",e)),this._pitching&&!r.pitching&&this.fire(new qe("pitchstart",e))}_prepareElevation(e){this._elevationCenter=e,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(e,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(e){this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);let t=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(e<1&&t!==this._elevationTarget){let r=this._elevationTarget-this._elevationStart,n=(t-(r*e+this._elevationStart))/(1-e);this._elevationStart+=e*(r-n),this._elevationTarget=t}this.transform.elevation=ji.number(this._elevationStart,this._elevationTarget,e)}_finalizeElevation(){this._elevationFreeze=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_applyUpdatedTransform(e){if(!this.transformCameraUpdate)return;let t=e.clone(),{center:r,zoom:n,pitch:a,bearing:o,elevation:s}=this.transformCameraUpdate(t);r&&(t.center=r),n!==void 0&&(t.zoom=n),a!==void 0&&(t.pitch=a),o!==void 0&&(t.bearing=o),s!==void 0&&(t.elevation=s),this.transform.apply(t)}_fireMoveEvents(e){this.fire(new qe("move",e)),this._zooming&&this.fire(new qe("zoom",e)),this._rotating&&this.fire(new qe("rotate",e)),this._pitching&&this.fire(new qe("pitch",e))}_afterEase(e,t){if(this._easeId&&t&&this._easeId===t)return;delete this._easeId;let r=this._zooming,n=this._rotating,a=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,r&&this.fire(new qe("zoomend",e)),n&&this.fire(new qe("rotateend",e)),a&&this.fire(new qe("pitchend",e)),this.fire(new qe("moveend",e))}flyTo(e,t){var r;if(!e.essential&&ai.prefersReducedMotion){let K=Om(e,["center","zoom","bearing","pitch","around"]);return this.jumpTo(K,t)}this.stop(),e=ht({offset:[0,0],speed:1.2,curve:1.42,easing:jb},e);let n=this._getTransformForUpdate(),a=this.getZoom(),o=this.getBearing(),s=this.getPitch(),l=this.getPadding(),u="bearing"in e?this._normalizeBearing(e.bearing,o):o,c="pitch"in e?+e.pitch:s,p="padding"in e?e.padding:n.padding,d=Qo.default.convert(e.offset),m=n.centerPoint.add(d),g=n.pointLocation(m),{center:b,zoom:x}=n.getConstrained(Jt.convert(e.center||g),(r=e.zoom)!=null?r:a);this._normalizeCenter(b);let v=n.zoomScale(x-a),w=n.project(g),_=n.project(b).sub(w),C=e.curve,E=Math.max(n.width,n.height),T=E/v,L=_.mag();if("minZoom"in e){let K=Tr(Math.min(e.minZoom,a,x),n.minZoom,n.maxZoom),z=E/n.zoomScale(K-a);C=Math.sqrt(z/L*2)}let D=C*C;function B(K){let z=(T*T-E*E+(K?-1:1)*D*D*L*L)/(2*(K?T:E)*D*L);return Math.log(Math.sqrt(z*z+1)-z)}h(B,"zoomOutFactor");function A(K){return(Math.exp(K)-Math.exp(-K))/2}h(A,"sinh");function k(K){return(Math.exp(K)+Math.exp(-K))/2}h(k,"cosh");function $(K){return A(K)/k(K)}h($,"tanh");let O=B(!1),P=h(function(K){return k(O)/k(O+C*K)},"w"),U=h(function(K){return E*((k(O)*$(O+C*K)-A(O))/D)/L},"u"),G=(B(!0)-O)/C;if(Math.abs(L)<1e-6||!isFinite(G)){if(Math.abs(E-T)<1e-6)return this.easeTo(e,t);let K=T<E?-1:1;G=Math.abs(Math.log(T/E))/C,U=h(function(){return 0},"u"),P=h(function(z){return Math.exp(K*C*z)},"w")}if("duration"in e)e.duration=+e.duration;else{let K="screenSpeed"in e?+e.screenSpeed/C:+e.speed;e.duration=1e3*G/K}return e.maxDuration&&e.duration>e.maxDuration&&(e.duration=0),this._zooming=!0,this._rotating=o!==u,this._pitching=c!==s,this._padding=!n.isPaddingEqual(p),this._prepareEase(t,!1),this.terrain&&this._prepareElevation(b),this._ease(K=>{let z=K*G,V=1/P(z);n.zoom=K===1?x:a+n.scaleZoom(V),this._rotating&&(n.bearing=ji.number(o,u,K)),this._pitching&&(n.pitch=ji.number(s,c,K)),this._padding&&(n.interpolatePadding(l,p,K),m=n.centerPoint.add(d)),this.terrain&&!e.freezeElevation&&this._updateElevation(K);let j=K===1?b:n.unproject(w.add(_.mult(U(z))).mult(V));n.setLocationAtPoint(n.renderWorldCopies?j.wrap():j,m),this._applyUpdatedTransform(n),this._fireMoveEvents(t)},()=>{this.terrain&&this._finalizeElevation(),this._afterEase(t)},e),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(e,t){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){let r=this._onEaseEnd;delete this._onEaseEnd,r.call(this,t)}if(!e){let r=this.handlers;r&&r.stop(!1)}return this}_ease(e,t,r){r.animate===!1||r.duration===0?(e(1),t()):(this._easeStart=ai.now(),this._easeOptions=r,this._onEaseFrame=e,this._onEaseEnd=t,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(e,t){e=Eu(e,-180,180);let r=Math.abs(e-t);return Math.abs(e-360-t)<r&&(e-=360),Math.abs(e+360-t)<r&&(e+=360),e}_normalizeCenter(e){let t=this.transform;if(!t.renderWorldCopies||t.lngRange)return;let r=e.lng-t.center.lng;e.lng+=r>180?-360:r<-180?360:0}queryTerrainElevation(e){return this.terrain?this.terrain.getElevationForLngLatZoom(Jt.convert(e),this.transform.tileZoom)-this.transform.elevation:null}};h(Qj,"Camera");var ude=Qj,Us=It(di(),1);R();var eH={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'},tH=class{constructor(e=eH){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=t=>{t&&(t.sourceDataType==="metadata"||t.sourceDataType==="visibility"||t.dataType==="style"||t.type==="terrain")&&this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):!this._container.classList.contains("maplibregl-compact")&&!this._container.classList.contains("maplibregl-attrib-empty")&&(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=e}getDefaultPosition(){return"bottom-right"}onAdd(e){return this._map=e,this._compact=this.options.compact,this._container=Ve.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=Ve.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=Ve.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){Ve.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(e,t){let r=this._map._getUIString(`AttributionControl.${t}`);e.title=r,e.setAttribute("aria-label",r)}_updateAttributions(){if(!this._map.style)return;let e=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?e=e.concat(this.options.customAttribution.map(n=>typeof n!="string"?"":n)):typeof this.options.customAttribution=="string"&&e.push(this.options.customAttribution)),this._map.style.stylesheet){let n=this._map.style.stylesheet;this.styleOwner=n.owner,this.styleId=n.id}let t=this._map.style.sourceCaches;for(let n in t){let a=t[n];if(a.used||a.usedForTerrain){let o=a.getSource();o.attribution&&e.indexOf(o.attribution)<0&&e.push(o.attribution)}}e=e.filter(n=>String(n).trim()),e.sort((n,a)=>n.length-a.length),e=e.filter((n,a)=>{for(let o=a+1;o<e.length;o++)if(e[o].indexOf(n)>=0)return!1;return!0});let r=e.join(" | ");r!==this._attribHTML&&(this._attribHTML=r,e.length?(this._innerContainer.innerHTML=r,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}};h(tH,"AttributionControl");var hde=tH;R();var iH=class{constructor(e={}){this._updateCompact=()=>{let t=this._container.children;if(t.length){let r=t[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&r.classList.add("maplibregl-compact"):r.classList.remove("maplibregl-compact")}},this.options=e}getDefaultPosition(){return"bottom-left"}onAdd(e){this._map=e,this._compact=this.options&&this.options.compact,this._container=Ve.create("div","maplibregl-ctrl");let t=Ve.create("a","maplibregl-ctrl-logo");return t.target="_blank",t.rel="noopener nofollow",t.href="https://maplibre.org/",t.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),t.setAttribute("rel","noopener nofollow"),this._container.appendChild(t),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){Ve.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}};h(iH,"LogoControl");var cde=iH;R();var rH=class{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(e){let t=++this._id;return this._queue.push({callback:e,id:t,cancelled:!1}),t}remove(e){let t=this._currentlyRunning,r=t?this._queue.concat(t):this._queue;for(let n of r)if(n.id===e){n.cancelled=!0;return}}run(e=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");let t=this._currentlyRunning=this._queue;this._queue=[];for(let r of t)if(!r.cancelled&&(r.callback(e),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}};h(rH,"TaskQueue");var pde=rH;R();var h3=(i=>(i.create="create",i.load="load",i.fullLoad="fullLoad",i))(h3||{}),Wg=null,Sd=[],dde=60,Z_=1e3/dde,Y_="loadTime",J_="fullLoadTime",Md={mark(i){performance.mark(i)},frame(i){let e=i;if(Wg!=null){let t=e-Wg;Sd.push(t)}Wg=e},clearMetrics(){Wg=null,Sd=[],performance.clearMeasures(Y_),performance.clearMeasures(J_);for(let i in h3)performance.clearMarks(h3[i])},getPerformanceMetrics(){performance.measure(Y_,"create","load"),performance.measure(J_,"create","fullLoad");let i=performance.getEntriesByName(Y_)[0].duration,e=performance.getEntriesByName(J_)[0].duration,t=Sd.length,r=1/(Sd.reduce((o,s)=>o+s,0)/t/1e3),n=Sd.filter(o=>o>Z_).reduce((o,s)=>o+(s-Z_)/Z_,0),a=n/(t+n)*100;return{loadTime:i,fullLoadTime:e,fps:r,percentDroppedFrames:a,totalFrames:t}}};R();R();var fde=Xi([{name:"a_pos3d",type:"Int16",components:3}]);R();var nH=class extends hn{constructor(e){super(),this.sourceCache=e,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,e.usedForTerrain=!0,e.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(e,t){this.sourceCache.update(e,t),this._renderableTilesKeys=[];let r={};for(let n of e.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:t}))r[n.key]=!0,this._renderableTilesKeys.push(n.key),this._tiles[n.key]||(n.posMatrix=new Float64Array(16),lt.ortho(n.posMatrix,0,8192,0,8192,0,1),this._tiles[n.key]=new Z$(n,this.tileSize));for(let n in this._tiles)r[n]||delete this._tiles[n]}freeRtt(e){for(let t in this._tiles){let r=this._tiles[t];(!e||r.tileID.equals(e)||r.tileID.isChildOf(e)||e.isChildOf(r.tileID))&&(r.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(e=>this.getTileByID(e))}getTileByID(e){return this._tiles[e]}getTerrainCoords(e){let t={};for(let r of this._renderableTilesKeys){let n=this._tiles[r].tileID;if(n.canonical.equals(e.canonical)){let a=e.clone();a.posMatrix=new Float64Array(16),lt.ortho(a.posMatrix,0,8192,0,8192,0,1),t[r]=a}else if(n.canonical.isChildOf(e.canonical)){let a=e.clone();a.posMatrix=new Float64Array(16);let o=n.canonical.z-e.canonical.z,s=n.canonical.x-(n.canonical.x>>o<<o),l=n.canonical.y-(n.canonical.y>>o<<o),u=8192>>o;lt.ortho(a.posMatrix,0,u,0,u,0,1),lt.translate(a.posMatrix,a.posMatrix,[-s*u,-l*u,0]),t[r]=a}else if(e.canonical.isChildOf(n.canonical)){let a=e.clone();a.posMatrix=new Float64Array(16);let o=e.canonical.z-n.canonical.z,s=e.canonical.x-(e.canonical.x>>o<<o),l=e.canonical.y-(e.canonical.y>>o<<o),u=8192>>o;lt.ortho(a.posMatrix,0,8192,0,8192,0,1),lt.translate(a.posMatrix,a.posMatrix,[s*u,l*u,0]),lt.scale(a.posMatrix,a.posMatrix,[1/2**o,1/2**o,0]),t[r]=a}}return t}getSourceTile(e,t){let r=this.sourceCache._source,n=e.overscaledZ-this.deltaZoom;if(n>r.maxzoom&&(n=r.maxzoom),n<r.minzoom)return null;this._sourceTileCache[e.key]||(this._sourceTileCache[e.key]=e.scaledTo(n).key);let a=this.sourceCache.getTileByID(this._sourceTileCache[e.key]);if(!(a&&a.dem)&&t)for(;n>=r.minzoom&&!(a&&a.dem);)a=this.sourceCache.getTileByID(e.scaledTo(n--).key);return a}tilesAfterTime(e=Date.now()){return Object.values(this._tiles).filter(t=>t.timeAdded>=e)}};h(nH,"TerrainSourceCache");var mde=nH,aH=class{constructor(e,t,r){this.painter=e,this.sourceCache=new mde(t),this.options=r,this.exaggeration=typeof r.exaggeration=="number"?r.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(e,t,r,n=8192){var a;if(!(t>=0&&t<n&&r>=0&&r<n))return 0;let o=this.getTerrainData(e),s=(a=o.tile)==null?void 0:a.dem;if(!s)return 0;let l=S5.transformMat4([],[t/n*8192,r/n*8192],o.u_terrain_matrix),u=[l[0]*s.dim,l[1]*s.dim],c=Math.floor(u[0]),p=Math.floor(u[1]),d=u[0]-c,m=u[1]-p;return s.get(c,p)*(1-d)*(1-m)+s.get(c+1,p)*d*(1-m)+s.get(c,p+1)*(1-d)*m+s.get(c+1,p+1)*d*m}getElevationForLngLatZoom(e,t){let{tileID:r,mercatorX:n,mercatorY:a}=this._getOverscaledTileIDFromLngLatZoom(e,t);return this.getElevation(r,n%8192,a%8192,8192)}getElevation(e,t,r,n=8192){return this.getDEMElevation(e,t,r,n)*this.exaggeration}getTerrainData(e){if(!this._emptyDemTexture){let n=this.painter.context,a=new Qi({width:1,height:1},new Uint8Array(1*4));this._emptyDepthTexture=new Rr(n,a,n.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new Rr(n,new Qi({width:1,height:1}),n.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(n.gl.NEAREST,n.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=lt.identity([])}let t=this.sourceCache.getSourceTile(e,!0);if(t&&t.dem&&(!t.demTexture||t.needsTerrainPrepare)){let n=this.painter.context;t.demTexture=this.painter.getTileTexture(t.dem.stride),t.demTexture?t.demTexture.update(t.dem.getPixels(),{premultiply:!1}):t.demTexture=new Rr(n,t.dem.getPixels(),n.gl.RGBA,{premultiply:!1}),t.demTexture.bind(n.gl.NEAREST,n.gl.CLAMP_TO_EDGE),t.needsTerrainPrepare=!1}let r=t&&t+t.tileID.key+e.key;if(r&&!this._demMatrixCache[r]){let n=this.sourceCache.sourceCache._source.maxzoom,a=e.canonical.z-t.tileID.canonical.z;e.overscaledZ>e.canonical.z&&(e.canonical.z>=n?a=e.canonical.z-n:ln("cannot calculate elevation if elevation maxzoom > source.maxzoom"));let o=e.canonical.x-(e.canonical.x>>a<<a),s=e.canonical.y-(e.canonical.y>>a<<a),l=lt.fromScaling(new Float64Array(16),[1/(8192<<a),1/(8192<<a),0]);lt.translate(l,l,[o*8192,s*8192,0]),this._demMatrixCache[e.key]={matrix:l,coord:e}}return{u_depth:2,u_terrain:3,u_terrain_dim:t&&t.dem&&t.dem.dim||1,u_terrain_matrix:r?this._demMatrixCache[e.key].matrix:this._emptyDemMatrix,u_terrain_unpack:t&&t.dem&&t.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(t&&t.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:t}}getFramebuffer(e){let t=this.painter,r=t.width/devicePixelRatio,n=t.height/devicePixelRatio;return this._fbo&&(this._fbo.width!==r||this._fbo.height!==n)&&(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new Rr(t.context,{width:r,height:n,data:null},t.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(t.context.gl.NEAREST,t.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new Rr(t.context,{width:r,height:n,data:null},t.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(t.context.gl.NEAREST,t.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=t.context.createFramebuffer(r,n,!0,!1),this._fbo.depthAttachment.set(t.context.createRenderbuffer(t.context.gl.DEPTH_COMPONENT16,r,n))),this._fbo.colorAttachment.set(e==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){let e=this.painter.context;if(this._coordsTexture)return this._coordsTexture;let t=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let a=0,o=0;a<this._coordsTextureSize;a++)for(let s=0;s<this._coordsTextureSize;s++,o+=4)t[o+0]=s&255,t[o+1]=a&255,t[o+2]=s>>8<<4|a>>8,t[o+3]=0;let r=new Qi({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(t.buffer)),n=new Rr(e,r,e.gl.RGBA,{premultiply:!1});return n.bind(e.gl.NEAREST,e.gl.CLAMP_TO_EDGE),this._coordsTexture=n,n}pointCoordinate(e){this.painter.maybeDrawDepthAndCoords(!0);let t=new Uint8Array(4),r=this.painter.context,n=r.gl,a=Math.round(e.x*this.painter.pixelRatio/devicePixelRatio),o=Math.round(e.y*this.painter.pixelRatio/devicePixelRatio),s=Math.round(this.painter.height/devicePixelRatio);r.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),n.readPixels(a,s-o-1,1,1,n.RGBA,n.UNSIGNED_BYTE,t),r.bindFramebuffer.set(null);let l=t[0]+(t[2]>>4<<8),u=t[1]+((t[2]&15)<<8),c=this.coordsIndex[255-t[3]],p=c&&this.sourceCache.getTileByID(c);if(!p)return null;let d=this._coordsTextureSize,m=(1<<p.tileID.canonical.z)*d;return new qr((p.tileID.canonical.x*d+l)/m+p.tileID.wrap,(p.tileID.canonical.y*d+u)/m,this.getElevation(p.tileID,l,u,d))}depthAtPoint(e){let t=new Uint8Array(4),r=this.painter.context,n=r.gl;return r.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),n.readPixels(e.x,this.painter.height/devicePixelRatio-e.y-1,1,1,n.RGBA,n.UNSIGNED_BYTE,t),r.bindFramebuffer.set(null),(t[0]/(256*256*256)+t[1]/(256*256)+t[2]/256+t[3])/256}getTerrainMesh(){if(this._mesh)return this._mesh;let e=this.painter.context,t=new goe,r=new ch,n=this.meshSize,a=8192/n,o=n*n;for(let p=0;p<=n;p++)for(let d=0;d<=n;d++)t.emplaceBack(d*a,p*a,0);for(let p=0;p<o;p+=n+1)for(let d=0;d<n;d++)r.emplaceBack(d+p,n+d+p+1,n+d+p+2),r.emplaceBack(d+p,n+d+p+2,d+p+1);let s=t.length,l=s+(n+1)*2;for(let p of[0,1])for(let d=0;d<=n;d++)for(let m of[0,1])t.emplaceBack(d*a,p*8192,m);for(let p=0;p<n*2;p+=2)r.emplaceBack(l+p,l+p+1,l+p+3),r.emplaceBack(l+p,l+p+3,l+p+2),r.emplaceBack(s+p,s+p+3,s+p+1),r.emplaceBack(s+p,s+p+2,s+p+3);let u=t.length,c=u+(n+1)*2;for(let p of[0,1])for(let d=0;d<=n;d++)for(let m of[0,1])t.emplaceBack(p*8192,d*a,m);for(let p=0;p<n*2;p+=2)r.emplaceBack(u+p,u+p+1,u+p+3),r.emplaceBack(u+p,u+p+3,u+p+2),r.emplaceBack(c+p,c+p+3,c+p+1),r.emplaceBack(c+p,c+p+2,c+p+3);return this._mesh={indexBuffer:e.createIndexBuffer(r),vertexBuffer:e.createVertexBuffer(t,fde.members),segments:cr.simpleSegment(0,0,t.length,r.length)},this._mesh}getMeshFrameDelta(e){return 2*Math.PI*G5/Math.pow(2,e)/5}getMinTileElevationForLngLatZoom(e,t){var r;let{tileID:n}=this._getOverscaledTileIDFromLngLatZoom(e,t);return(r=this.getMinMaxElevation(n).minElevation)!=null?r:0}getMinMaxElevation(e){let t=this.getTerrainData(e).tile,r={minElevation:null,maxElevation:null};return t&&t.dem&&(r.minElevation=t.dem.min*this.exaggeration,r.maxElevation=t.dem.max*this.exaggeration),r}_getOverscaledTileIDFromLngLatZoom(e,t){let r=qr.fromLngLat(e.wrap()),n=(1<<t)*8192,a=r.x*n,o=r.y*n,s=Math.floor(a/8192),l=Math.floor(o/8192);return{tileID:new ra(t,0,t,s,l),mercatorX:a,mercatorY:o}}};h(aH,"Terrain");var gde=aH;R();R();var oH=class{constructor(e,t,r){this._context=e,this._size=t,this._tileSize=r,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(let e of this._objects)e.texture.destroy(),e.fbo.destroy()}_createObject(e){let t=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),r=new Rr(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return r.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),t.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),t.colorAttachment.set(r.texture),{id:e,fbo:t,texture:r,stamp:-1,inUse:!1}}getObjectForId(e){return this._objects[e]}useObject(e){e.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(t=>e.id!==t),this._recentlyUsed.push(e.id)}stampObject(e){e.stamp=++this._stamp}getOrCreateFreeObject(){for(let t of this._recentlyUsed)if(!this._objects[t].inUse)return this._objects[t];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");let e=this._createObject(this._objects.length);return this._objects.push(e),e}freeObject(e){e.inUse=!1}freeAllObjects(){for(let e of this._objects)this.freeObject(e)}isFull(){return this._objects.length<this._size?!1:this._objects.some(e=>!e.inUse)===!1}};h(oH,"RenderPool");var yde=oH,Sh={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0},sH=class{constructor(e,t){this.painter=e,this.terrain=t,this.pool=new yde(e.context,30,t.sourceCache.tileSize*t.qualityFactor)}destruct(){this.pool.destruct()}getTexture(e){return this.pool.getObjectForId(e.rtt[this._stacks.length-1].id).texture}prepareForRender(e,t){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=e._order.filter(r=>!e._layers[r].isHidden(t)),this._coordsDescendingInv={};for(let r in e.sourceCaches){this._coordsDescendingInv[r]={};let n=e.sourceCaches[r].getVisibleCoordinates();for(let a of n){let o=this.terrain.sourceCache.getTerrainCoords(a);for(let s in o)this._coordsDescendingInv[r][s]||(this._coordsDescendingInv[r][s]=[]),this._coordsDescendingInv[r][s].push(o[s])}}this._coordsDescendingInvStr={};for(let r of e._order){let n=e._layers[r],a=n.source;if(Sh[n.type]&&!this._coordsDescendingInvStr[a]){this._coordsDescendingInvStr[a]={};for(let o in this._coordsDescendingInv[a])this._coordsDescendingInvStr[a][o]=this._coordsDescendingInv[a][o].map(s=>s.key).sort().join()}}for(let r of this._renderableTiles)for(let n in this._coordsDescendingInvStr){let a=this._coordsDescendingInvStr[n][r.tileID.key];a&&a!==r.rttCoords[n]&&(r.rtt=[])}}renderLayer(e){if(e.isHidden(this.painter.transform.zoom))return!1;let t=e.type,r=this.painter,n=this._renderableLayerIds[this._renderableLayerIds.length-1]===e.id;if(Sh[t]&&((!this._prevType||!Sh[this._prevType])&&this._stacks.push([]),this._prevType=t,this._stacks[this._stacks.length-1].push(e.id),!n))return!0;if(Sh[this._prevType]||Sh[t]&&n){this._prevType=t;let a=this._stacks.length-1,o=this._stacks[a]||[];for(let s of this._renderableTiles){if(this.pool.isFull()&&(o3(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(s),s.rtt[a]){let u=this.pool.getObjectForId(s.rtt[a].id);if(u.stamp===s.rtt[a].stamp){this.pool.useObject(u);continue}}let l=this.pool.getOrCreateFreeObject();this.pool.useObject(l),this.pool.stampObject(l),s.rtt[a]={id:l.id,stamp:l.stamp},r.context.bindFramebuffer.set(l.fbo.framebuffer),r.context.clear({color:zt.transparent,stencil:0}),r.currentStencilSource=void 0;for(let u=0;u<o.length;u++){let c=r.style._layers[o[u]],p=c.source?this._coordsDescendingInv[c.source][s.tileID.key]:[s.tileID];r.context.viewport.set([0,0,l.fbo.width,l.fbo.height]),r._renderTileClippingMasks(c,p),r.renderLayer(r,r.style.sourceCaches[c.source],c,p),c.source&&(s.rttCoords[c.source]=this._coordsDescendingInvStr[c.source][s.tileID.key])}}return o3(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),Sh[t]}return!1}};h(sH,"RenderToTexture");var vde=sH;R();var xde={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use ⌘ + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},_de=eL.version,yy=-2,lH=22,Js=0,uH=80,Xg=85,bde={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:yy,maxZoom:lH,minPitch:Js,maxPitch:uH,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:eH,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:vo.MAX_TILE_CACHE_ZOOM_LEVELS,localIdeographFontFamily:"sans-serif",transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,validateStyle:!0,maxCanvasSize:[4096,4096]},hH=class extends ude{constructor(e){if(Md.mark("create"),e=ht({},bde,e),e.minZoom!=null&&e.maxZoom!=null&&e.minZoom>e.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(e.minPitch!=null&&e.maxPitch!=null&&e.minPitch>e.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(e.minPitch!=null&&e.minPitch<Js)throw new Error(`minPitch must be greater than or equal to ${Js}`);if(e.maxPitch!=null&&e.maxPitch>Xg)throw new Error(`maxPitch must be less than or equal to ${Xg}`);let t=new vpe(e.minZoom,e.maxZoom,e.minPitch,e.maxPitch,e.renderWorldCopies);if(super(t,{bearingSnap:e.bearingSnap}),this._contextLost=n=>{n.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new qe("webglcontextlost",{originalEvent:n}))},this._contextRestored=n=>{this._setupPainter(),this.resize(),this._update(),this.fire(new qe("webglcontextrestored",{originalEvent:n}))},this._onMapScroll=n=>{if(n.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=e.interactive,this._maxTileCacheSize=e.maxTileCacheSize,this._maxTileCacheZoomLevels=e.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=e.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=e.preserveDrawingBuffer,this._antialias=e.antialias,this._trackResize=e.trackResize,this._bearingSnap=e.bearingSnap,this._refreshExpiredTiles=e.refreshExpiredTiles,this._fadeDuration=e.fadeDuration,this._crossSourceCollisions=e.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=e.collectResourceTiming,this._renderTaskQueue=new pde,this._controls=[],this._mapId=LC(),this._locale=ht({},xde,e.locale),this._clickTolerance=e.clickTolerance,this._overridePixelRatio=e.pixelRatio,this._maxCanvasSize=e.maxCanvasSize,this.transformCameraUpdate=e.transformCameraUpdate,this._imageQueueHandle=Uo.addThrottleControl(()=>this.isMoving()),this._requestManager=new Hne(e.transformRequest),typeof e.container=="string"){if(this._container=document.getElementById(e.container),!this._container)throw new Error(`Container '${e.container}' not found.`)}else if(e.container instanceof HTMLElement)this._container=e.container;else throw new Error("Invalid type: 'container' must be a String or HTMLElement.");if(e.maxBounds&&this.setMaxBounds(e.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let n=!1,a=aE(o=>{this._trackResize&&!this._removed&&this.resize(o)._update()},50);this._resizeObserver=new ResizeObserver(o=>{if(!n){n=!0;return}a(o)}),this._resizeObserver.observe(this._container)}this.handlers=new lde(this,e);let r=typeof e.hash=="string"&&e.hash||void 0;this._hash=e.hash&&new xpe(r).addTo(this),(!this._hash||!this._hash._onHashChange())&&(this.jumpTo({center:e.center,zoom:e.zoom,bearing:e.bearing,pitch:e.pitch}),e.bounds&&(this.resize(),this.fitBounds(e.bounds,ht({},e.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=e.localIdeographFontFamily,this._validateStyle=e.validateStyle,e.style&&this.setStyle(e.style,{localIdeographFontFamily:e.localIdeographFontFamily}),e.attributionControl&&this.addControl(new hde(typeof e.attributionControl=="boolean"?void 0:e.attributionControl)),e.maplibreLogo&&this.addControl(new cde,e.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",n=>{this._update(n.dataType==="style"),this.fire(new qe(`${n.dataType}data`,n))}),this.on("dataloading",n=>{this.fire(new qe(`${n.dataType}dataloading`,n))}),this.on("dataabort",n=>{this.fire(new qe("sourcedataabort",n))})}_getMapId(){return this._mapId}addControl(e,t){if(t===void 0&&(e.getDefaultPosition?t=e.getDefaultPosition():t="top-right"),!e||!e.onAdd)return this.fire(new Mt(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));let r=e.onAdd(this);this._controls.push(e);let n=this._controlPositions[t];return t.indexOf("bottom")!==-1?n.insertBefore(r,n.firstChild):n.appendChild(r),this}removeControl(e){if(!e||!e.onRemove)return this.fire(new Mt(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));let t=this._controls.indexOf(e);return t>-1&&this._controls.splice(t,1),e.onRemove(this),this}hasControl(e){return this._controls.indexOf(e)>-1}calculateCameraOptionsFromTo(e,t,r,n){return n==null&&this.terrain&&(n=this.terrain.getElevationForLngLatZoom(r,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(e,t,r,n)}resize(e){var t;let r=this._containerDimensions(),n=r[0],a=r[1],o=this._getClampedPixelRatio(n,a);if(this._resizeCanvas(n,a,o),this.painter.resize(n,a,o),this.painter.overLimit()){let l=this.painter.context.gl;this._maxCanvasSize=[l.drawingBufferWidth,l.drawingBufferHeight];let u=this._getClampedPixelRatio(n,a);this._resizeCanvas(n,a,u),this.painter.resize(n,a,u)}this.transform.resize(n,a),(t=this._requestedCameraState)==null||t.resize(n,a);let s=!this._moving;return s&&(this.stop(),this.fire(new qe("movestart",e)).fire(new qe("move",e))),this.fire(new qe("resize",e)),s&&this.fire(new qe("moveend",e)),this}_getClampedPixelRatio(e,t){let{0:r,1:n}=this._maxCanvasSize,a=this.getPixelRatio(),o=e*a,s=t*a,l=o>r?r/o:1,u=s>n?n/s:1;return Math.min(l,u)*a}getPixelRatio(){var e;return(e=this._overridePixelRatio)!=null?e:devicePixelRatio}setPixelRatio(e){this._overridePixelRatio=e,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(e){return this.transform.setMaxBounds(zl.convert(e)),this._update()}setMinZoom(e){if(e=e??yy,e>=yy&&e<=this.transform.maxZoom)return this.transform.minZoom=e,this._update(),this.getZoom()<e&&this.setZoom(e),this;throw new Error(`minZoom must be between ${yy} and the current maxZoom, inclusive`)}getMinZoom(){return this.transform.minZoom}setMaxZoom(e){if(e=e??lH,e>=this.transform.minZoom)return this.transform.maxZoom=e,this._update(),this.getZoom()>e&&this.setZoom(e),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(e){if(e=e??Js,e<Js)throw new Error(`minPitch must be greater than or equal to ${Js}`);if(e>=Js&&e<=this.transform.maxPitch)return this.transform.minPitch=e,this._update(),this.getPitch()<e&&this.setPitch(e),this;throw new Error(`minPitch must be between ${Js} and the current maxPitch, inclusive`)}getMinPitch(){return this.transform.minPitch}setMaxPitch(e){if(e=e??uH,e>Xg)throw new Error(`maxPitch must be less than or equal to ${Xg}`);if(e>=this.transform.minPitch)return this.transform.maxPitch=e,this._update(),this.getPitch()>e&&this.setPitch(e),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(e){return this.transform.renderWorldCopies=e,this._update()}project(e){return this.transform.locationPoint(Jt.convert(e),this.style&&this.terrain)}unproject(e){return this.transform.pointLocation(Us.default.convert(e),this.terrain)}isMoving(){var e;return this._moving||((e=this.handlers)==null?void 0:e.isMoving())}isZooming(){var e;return this._zooming||((e=this.handlers)==null?void 0:e.isZooming())}isRotating(){var e;return this._rotating||((e=this.handlers)==null?void 0:e.isRotating())}_createDelegatedListener(e,t,r){if(e==="mouseenter"||e==="mouseover"){let n=!1;return{layer:t,listener:r,delegates:{mousemove:h(a=>{let o=this.getLayer(t)?this.queryRenderedFeatures(a.point,{layers:[t]}):[];o.length?n||(n=!0,r.call(this,new Aa(e,this,a.originalEvent,{features:o}))):n=!1},"mousemove"),mouseout:h(()=>{n=!1},"mouseout")}}}else if(e==="mouseleave"||e==="mouseout"){let n=!1;return{layer:t,listener:r,delegates:{mousemove:h(a=>{(this.getLayer(t)?this.queryRenderedFeatures(a.point,{layers:[t]}):[]).length?n=!0:n&&(n=!1,r.call(this,new Aa(e,this,a.originalEvent)))},"mousemove"),mouseout:h(a=>{n&&(n=!1,r.call(this,new Aa(e,this,a.originalEvent)))},"mouseout")}}}else{let n=h(a=>{let o=this.getLayer(t)?this.queryRenderedFeatures(a.point,{layers:[t]}):[];o.length&&(a.features=o,r.call(this,a),delete a.features)},"delegate");return{layer:t,listener:r,delegates:{[e]:n}}}}on(e,t,r){if(r===void 0)return super.on(e,t);let n=this._createDelegatedListener(e,t,r);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[e]=this._delegatedListeners[e]||[],this._delegatedListeners[e].push(n);for(let a in n.delegates)this.on(a,n.delegates[a]);return this}once(e,t,r){if(r===void 0)return super.once(e,t);let n=this._createDelegatedListener(e,t,r);for(let a in n.delegates)this.once(a,n.delegates[a]);return this}off(e,t,r){if(r===void 0)return super.off(e,t);let n=h(a=>{let o=a[e];for(let s=0;s<o.length;s++){let l=o[s];if(l.layer===t&&l.listener===r){for(let u in l.delegates)this.off(u,l.delegates[u]);return o.splice(s,1),this}}},"removeDelegatedListener");return this._delegatedListeners&&this._delegatedListeners[e]&&n(this._delegatedListeners),this}queryRenderedFeatures(e,t){if(!this.style)return[];let r,n=e instanceof Us.default||Array.isArray(e),a=n?e:[[0,0],[this.transform.width,this.transform.height]];if(t=t||(n?{}:e)||{},a instanceof Us.default||typeof a[0]=="number")r=[Us.default.convert(a)];else{let o=Us.default.convert(a[0]),s=Us.default.convert(a[1]);r=[o,new Us.default(s.x,o.y),s,new Us.default(o.x,s.y),o]}return this.style.queryRenderedFeatures(r,t,this.transform)}querySourceFeatures(e,t){return this.style.querySourceFeatures(e,t)}setStyle(e,t){return t=ht({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},t),t.diff!==!1&&t.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&e?(this._diffStyle(e,t),this):(this._localIdeographFontFamily=t.localIdeographFontFamily,this._updateStyle(e,t))}setTransformRequest(e){return this._requestManager.setTransformRequest(e),this}_getUIString(e){let t=this._locale[e];if(t==null)throw new Error(`Missing UI string '${e}'`);return t}_updateStyle(e,t){if(t.transformStyle&&this.style&&!this.style._loaded){this.style.once("style.load",()=>this._updateStyle(e,t));return}let r=this.style&&t.transformStyle?this.style.serialize():void 0;if(this.style&&(this.style.setEventedParent(null),this.style._remove(!e)),e)this.style=new sA(this,t||{});else return delete this.style,this;return this.style.setEventedParent(this,{style:this.style}),typeof e=="string"?this.style.loadURL(e,t,r):this.style.loadJSON(e,t,r),this}_lazyInitEmptyStyle(){this.style||(this.style=new sA(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(e,t){if(typeof e=="string"){let r=e,n=this._requestManager.transformRequest(r,"Style");rx(n,new AbortController).then(a=>{this._updateDiff(a.data,t)}).catch(a=>{a&&this.fire(new Mt(a))})}else typeof e=="object"&&this._updateDiff(e,t)}_updateDiff(e,t){try{this.style.setState(e,t)&&this._update(!0)}catch(r){ln(`Unable to perform style diff: ${r.message||r.error||r}.  Rebuilding the style from scratch.`),this._updateStyle(e,t)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():ln("There is no style added to the map.")}addSource(e,t){return this._lazyInitEmptyStyle(),this.style.addSource(e,t),this._update(!0)}isSourceLoaded(e){let t=this.style&&this.style.sourceCaches[e];if(t===void 0){this.fire(new Mt(new Error(`There is no source with ID '${e}'`)));return}return t.loaded()}setTerrain(e){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),!e)this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.minElevationForCurrentTile=0,this.transform.elevation=0;else{let t=this.style.sourceCaches[e.source];if(!t)throw new Error(`cannot load terrain, because there exists no source with ID: ${e.source}`);this.terrain===null&&t.reload();for(let r in this.style._layers){let n=this.style._layers[r];n.type==="hillshade"&&n.source===e.source&&ln("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new gde(this.painter,t,e),this.painter.renderToTexture=new vde(this.painter,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._terrainDataCallback=r=>{r.dataType==="style"?this.terrain.sourceCache.freeRtt():r.dataType==="source"&&r.tile&&(r.sourceId===e.source&&!this._elevationFreeze&&(this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.terrain.sourceCache.freeRtt(r.tile.tileID))},this.style.on("data",this._terrainDataCallback)}return this.fire(new qe("terrain",{terrain:e})),this}getTerrain(){var e,t;return(t=(e=this.terrain)==null?void 0:e.options)!=null?t:null}areTilesLoaded(){let e=this.style&&this.style.sourceCaches;for(let t in e){let r=e[t]._tiles;for(let n in r){let a=r[n];if(!(a.state==="loaded"||a.state==="errored"))return!1}}return!0}removeSource(e){return this.style.removeSource(e),this._update(!0)}getSource(e){return this.style.getSource(e)}addImage(e,t,r={}){let{pixelRatio:n=1,sdf:a=!1,stretchX:o,stretchY:s,content:l}=r;this._lazyInitEmptyStyle();let u=0;if(t instanceof HTMLImageElement||$o(t)){let{width:c,height:p,data:d}=ai.getImageData(t);this.style.addImage(e,{data:new Qi({width:c,height:p},d),pixelRatio:n,stretchX:o,stretchY:s,content:l,sdf:a,version:u})}else{if(t.width===void 0||t.height===void 0)return this.fire(new Mt(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{let{width:c,height:p,data:d}=t,m=t;return this.style.addImage(e,{data:new Qi({width:c,height:p},new Uint8Array(d)),pixelRatio:n,stretchX:o,stretchY:s,content:l,sdf:a,version:u,userImage:m}),m.onAdd&&m.onAdd(this,e),this}}}updateImage(e,t){let r=this.style.getImage(e);if(!r)return this.fire(new Mt(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));let n=t instanceof HTMLImageElement||$o(t)?ai.getImageData(t):t,{width:a,height:o,data:s}=n;if(a===void 0||o===void 0)return this.fire(new Mt(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(a!==r.data.width||o!==r.data.height)return this.fire(new Mt(new Error("The width and height of the updated image must be that same as the previous version of the image")));let l=!(t instanceof HTMLImageElement||$o(t));return r.data.replace(s,l),this.style.updateImage(e,r),this}getImage(e){return this.style.getImage(e)}hasImage(e){return e?!!this.style.getImage(e):(this.fire(new Mt(new Error("Missing required image id"))),!1)}removeImage(e){this.style.removeImage(e)}loadImage(e){return Uo.getImage(this._requestManager.transformRequest(e,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(e,t){return this._lazyInitEmptyStyle(),this.style.addLayer(e,t),this._update(!0)}moveLayer(e,t){return this.style.moveLayer(e,t),this._update(!0)}removeLayer(e){return this.style.removeLayer(e),this._update(!0)}getLayer(e){return this.style.getLayer(e)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(e,t,r){return this.style.setLayerZoomRange(e,t,r),this._update(!0)}setFilter(e,t,r={}){return this.style.setFilter(e,t,r),this._update(!0)}getFilter(e){return this.style.getFilter(e)}setPaintProperty(e,t,r,n={}){return this.style.setPaintProperty(e,t,r,n),this._update(!0)}getPaintProperty(e,t){return this.style.getPaintProperty(e,t)}setLayoutProperty(e,t,r,n={}){return this.style.setLayoutProperty(e,t,r,n),this._update(!0)}getLayoutProperty(e,t){return this.style.getLayoutProperty(e,t)}setGlyphs(e,t={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(e,t),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(e,t,r={}){return this._lazyInitEmptyStyle(),this.style.addSprite(e,t,r,n=>{n||this._update(!0)}),this}removeSprite(e){return this._lazyInitEmptyStyle(),this.style.removeSprite(e),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(e,t={}){return this._lazyInitEmptyStyle(),this.style.setSprite(e,t,r=>{r||this._update(!0)}),this}setLight(e,t={}){return this._lazyInitEmptyStyle(),this.style.setLight(e,t),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(e,t){return this.style.setFeatureState(e,t),this._update()}removeFeatureState(e,t){return this.style.removeFeatureState(e,t),this._update()}getFeatureState(e){return this.style.getFeatureState(e)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let e=0,t=0;return this._container&&(e=this._container.clientWidth||400,t=this._container.clientHeight||300),[e,t]}_setupContainer(){let e=this._container;e.classList.add("maplibregl-map");let t=this._canvasContainer=Ve.create("div","maplibregl-canvas-container",e);this._interactive&&t.classList.add("maplibregl-interactive"),this._canvas=Ve.create("canvas","maplibregl-canvas",t),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");let r=this._containerDimensions(),n=this._getClampedPixelRatio(r[0],r[1]);this._resizeCanvas(r[0],r[1],n);let a=this._controlContainer=Ve.create("div","maplibregl-control-container",e),o=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(s=>{o[s]=Ve.create("div",`maplibregl-ctrl-${s} `,a)})}_resizeCanvas(e,t,r){this._canvas.width=Math.floor(r*e),this._canvas.height=Math.floor(r*t),this._canvas.style.width=`${e}px`,this._canvas.style.height=`${t}px`}_setupPainter(){let e={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1},t=null;this._canvas.addEventListener("webglcontextcreationerror",n=>{t={requestedAttributes:e},n&&(t.statusMessage=n.statusMessage,t.type=n.type)},{once:!0});let r=this._canvas.getContext("webgl2",e)||this._canvas.getContext("webgl",e);if(!r){let n="Failed to initialize WebGL";throw t?(t.message=n,new Error(JSON.stringify(t))):new Error(n)}this.painter=new fpe(r,this.transform),BC.testSupport(r)}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(e){return!this.style||!this.style._loaded?this:(this._styleDirty=this._styleDirty||e,this._sourcesDirty=!0,this.triggerRepaint(),this)}_requestRenderFrame(e){return this._update(),this._renderTaskQueue.add(e)}_cancelRenderFrame(e){this._renderTaskQueue.remove(e)}_render(e){let t=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(e),this._removed)return;let r=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;let a=this.transform.zoom,o=ai.now();this.style.zoomHistory.update(a,o);let s=new Pr(a,{now:o,fadeDuration:t,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),l=s.crossFadingFactor();(l!==1||l!==this._crossFadingFactor)&&(r=!0,this._crossFadingFactor=l),this.style.update(s)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain&&(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._elevationFreeze||(this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,t,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:t,showPadding:this.showPadding}),this.fire(new qe("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,Md.mark("load"),this.fire(new qe("load"))),this.style&&(this.style.hasTransitions()||r)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();let n=this._sourcesDirty||this._styleDirty||this._placementDirty;return n||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new qe("idle")),this._loaded&&!this._fullyLoaded&&!n&&(this._fullyLoaded=!0,Md.mark("fullLoad")),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var e;this._hash&&this._hash.remove();for(let r of this._controls)r.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),Uo.removeThrottleControl(this._imageQueueHandle),(e=this._resizeObserver)==null||e.disconnect();let t=this.painter.context.gl.getExtension("WEBGL_lose_context");t&&t.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),Ve.remove(this._canvasContainer),Ve.remove(this._controlContainer),this._container.classList.remove("maplibregl-map"),Md.clearMetrics(),this._removed=!0,this.fire(new qe("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,ai.frameAsync(this._frameRequest).then(e=>{Md.frame(e),this._frameRequest=null,this._render(e)}).catch(()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(e){this._showTileBoundaries!==e&&(this._showTileBoundaries=e,this._update())}get showPadding(){return!!this._showPadding}set showPadding(e){this._showPadding!==e&&(this._showPadding=e,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(e){this._showCollisionBoxes!==e&&(this._showCollisionBoxes=e,e?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(e){this._showOverdrawInspector!==e&&(this._showOverdrawInspector=e,this._update())}get repaint(){return!!this._repaint}set repaint(e){this._repaint!==e&&(this._repaint=e,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(e){this._vertices=e,this._update()}get version(){return _de}getCameraTargetElevation(){return this.transform.elevation}};h(hH,"Map");var kMe=hH;R();R();var cH=h(i=>{i.touchstart=i.dragStart,i.touchmoveWindow=i.dragMove,i.touchend=i.dragEnd},"assignEvents"),wde=h(({enable:i,clickTolerance:e,bearingDegreesPerPixelMoved:t=.8})=>{let r=new Dj;return new eg({clickTolerance:e,move:(n,a)=>({bearingDelta:(a.x-n.x)*t}),moveStateManager:r,enable:i,assignEvents:cH})},"generateOneFingerTouchRotationHandler"),Sde=h(({enable:i,clickTolerance:e,pitchDegreesPerPixelMoved:t=-.5})=>{let r=new Dj;return new eg({clickTolerance:e,move:(n,a)=>({pitchDelta:(a.y-n.y)*t}),moveStateManager:r,enable:i,assignEvents:cH})},"generateOneFingerTouchPitchHandler"),Mde={showCompass:!0,showZoom:!0,visualizePitch:!1},pH=class{constructor(e){this._updateZoomButtons=()=>{let t=this._map.getZoom(),r=t===this._map.getMaxZoom(),n=t===this._map.getMinZoom();this._zoomInButton.disabled=r,this._zoomOutButton.disabled=n,this._zoomInButton.setAttribute("aria-disabled",r.toString()),this._zoomOutButton.setAttribute("aria-disabled",n.toString())},this._rotateCompassArrow=()=>{let t=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=t},this._setButtonTitle=(t,r)=>{let n=this._map._getUIString(`NavigationControl.${r}`);t.title=n,t.setAttribute("aria-label",n)},this.options=ht({},Mde,e),this._container=Ve.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",t=>t.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",t=>this._map.zoomIn({},{originalEvent:t})),Ve.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",t=>this._map.zoomOut({},{originalEvent:t})),Ve.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",t=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:t}):this._map.resetNorth({},{originalEvent:t})}),this._compassIcon=Ve.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(e){return this._map=e,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Cde(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){Ve.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(e,t){let r=Ve.create("button",e,this._container);return r.type="button",r.addEventListener("click",t),r}};h(pH,"NavigationControl");var FMe=pH,dH=class{constructor(e,t,r=!1){this.mousedown=o=>{this.startMouse(ht({},o,{ctrlKey:!0,preventDefault:()=>o.preventDefault()}),Ve.mousePos(this.element,o)),Ve.addEventListener(window,"mousemove",this.mousemove),Ve.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=o=>{this.moveMouse(o,Ve.mousePos(this.element,o))},this.mouseup=o=>{this.mouseRotate.dragEnd(o),this.mousePitch&&this.mousePitch.dragEnd(o),this.offTemp()},this.touchstart=o=>{o.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=Ve.touchPos(this.element,o.targetTouches)[0],this.startTouch(o,this._startPos),Ve.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),Ve.addEventListener(window,"touchend",this.touchend))},this.touchmove=o=>{o.targetTouches.length!==1?this.reset():(this._lastPos=Ve.touchPos(this.element,o.targetTouches)[0],this.moveTouch(o,this._lastPos))},this.touchend=o=>{o.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10;let n=e.dragRotate._mouseRotate.getClickTolerance(),a=e.dragRotate._mousePitch.getClickTolerance();this.element=t,this.mouseRotate=Rj({clickTolerance:n,enable:!0}),this.touchRotate=wde({clickTolerance:n,enable:!0}),this.map=e,r&&(this.mousePitch=Fj({clickTolerance:a,enable:!0}),this.touchPitch=Sde({clickTolerance:a,enable:!0})),Ve.addEventListener(t,"mousedown",this.mousedown),Ve.addEventListener(t,"touchstart",this.touchstart,{passive:!1}),Ve.addEventListener(t,"touchcancel",this.reset)}startMouse(e,t){this.mouseRotate.dragStart(e,t),this.mousePitch&&this.mousePitch.dragStart(e,t),Ve.disableDrag()}startTouch(e,t){this.touchRotate.dragStart(e,t),this.touchPitch&&this.touchPitch.dragStart(e,t),Ve.disableDrag()}moveMouse(e,t){let r=this.map,{bearingDelta:n}=this.mouseRotate.dragMove(e,t)||{};if(n&&r.setBearing(r.getBearing()+n),this.mousePitch){let{pitchDelta:a}=this.mousePitch.dragMove(e,t)||{};a&&r.setPitch(r.getPitch()+a)}}moveTouch(e,t){let r=this.map,{bearingDelta:n}=this.touchRotate.dragMove(e,t)||{};if(n&&r.setBearing(r.getBearing()+n),this.touchPitch){let{pitchDelta:a}=this.touchPitch.dragMove(e,t)||{};a&&r.setPitch(r.getPitch()+a)}}off(){let e=this.element;Ve.removeEventListener(e,"mousedown",this.mousedown),Ve.removeEventListener(e,"touchstart",this.touchstart,{passive:!1}),Ve.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),Ve.removeEventListener(window,"touchend",this.touchend),Ve.removeEventListener(e,"touchcancel",this.reset),this.offTemp()}offTemp(){Ve.enableDrag(),Ve.removeEventListener(window,"mousemove",this.mousemove),Ve.removeEventListener(window,"mouseup",this.mouseup),Ve.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),Ve.removeEventListener(window,"touchend",this.touchend)}};h(dH,"MouseRotateWrapper");var Cde=dH;R();R();var Zl;async function fH(i=!1){if(Zl!==void 0&&!i)return Zl;if(window.navigator.permissions===void 0)return Zl=!!window.navigator.geolocation,Zl;try{Zl=(await window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{Zl=!!window.navigator.geolocation}return Zl}h(fH,"checkGeolocationSupport");R();var qg=It(di(),1);R();function cE(i,e,t){let r=new Jt(i.lng,i.lat);if(i=new Jt(i.lng,i.lat),e){let n=new Jt(i.lng-360,i.lat),a=new Jt(i.lng+360,i.lat),o=t.locationPoint(i).distSqr(e);t.locationPoint(n).distSqr(e)<o?i=n:t.locationPoint(a).distSqr(e)<o&&(i=a)}for(;Math.abs(i.lng-t.center.lng)>180;){let n=t.locationPoint(i);if(n.x>=0&&n.y>=0&&n.x<=t.width&&n.y<=t.height)break;i.lng>t.center.lng?i.lng-=360:i.lng+=360}return i.lng!==r.lng&&t.locationPoint(i).y>t.height/2-t.getHorizon()?i:r}h(cE,"smartWrap");R();var pE={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function dE(i,e,t){let r=i.classList;for(let n in pE)r.remove(`maplibregl-${t}-anchor-${n}`);r.add(`maplibregl-${t}-anchor-${e}`)}h(dE,"applyAnchorClass");var mH=class extends hn{constructor(e){if(super(),this._onKeyPress=t=>{let r=t.code,n=t.charCode||t.keyCode;(r==="Space"||r==="Enter"||n===32||n===13)&&this.togglePopup()},this._onMapClick=t=>{let r=t.originalEvent.target,n=this._element;this._popup&&(r===n||n.contains(r))&&this.togglePopup()},this._update=t=>{var r;if(!this._map)return;let n=this._map.loaded()&&!this._map.isMoving();((t==null?void 0:t.type)==="terrain"||(t==null?void 0:t.type)==="render"&&!n)&&this._map.once("render",this._update),this._map.transform.renderWorldCopies?this._lngLat=cE(this._lngLat,this._flatPos,this._map.transform):this._lngLat=(r=this._lngLat)==null?void 0:r.wrap(),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationPoint(this._lngLat)._add(this._offset));let a="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?a=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(a=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let o="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?o="rotateX(0deg)":this._pitchAlignment==="map"&&(o=`rotateX(${this._map.getPitch()}deg)`),(!t||t.type==="moveend")&&(this._pos=this._pos.round()),Ve.setTransform(this._element,`${pE[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${o} ${a}`),ai.frameAsync(new AbortController).then(()=>{this._updateOpacity(t&&t.type==="moveend")}).catch(()=>{})},this._onMove=t=>{if(!this._isDragging){let r=this._clickTolerance||this._map._clickTolerance;this._isDragging=t.point.dist(this._pointerdownPos)>=r}this._isDragging&&(this._pos=t.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new qe("dragstart"))),this.fire(new qe("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new qe("dragend")),this._state="inactive"},this._addDragHandler=t=>{this._element.contains(t.originalEvent.target)&&(t.preventDefault(),this._positionDelta=t.point.sub(this._pos).add(this._offset),this._pointerdownPos=t.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=e&&e.anchor||"center",this._color=e&&e.color||"#3FB1CE",this._scale=e&&e.scale||1,this._draggable=e&&e.draggable||!1,this._clickTolerance=e&&e.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=e&&e.rotation||0,this._rotationAlignment=e&&e.rotationAlignment||"auto",this._pitchAlignment=e&&e.pitchAlignment&&e.pitchAlignment!=="auto"?e.pitchAlignment:this._rotationAlignment,this.setOpacity(),this.setOpacity(e==null?void 0:e.opacity,e==null?void 0:e.opacityWhenCovered),!e||!e.element){this._defaultMarker=!0,this._element=Ve.create("div"),this._element.setAttribute("aria-label","Map marker");let t=Ve.createNS("http://www.w3.org/2000/svg","svg"),r=41,n=27;t.setAttributeNS(null,"display","block"),t.setAttributeNS(null,"height",`${r}px`),t.setAttributeNS(null,"width",`${n}px`),t.setAttributeNS(null,"viewBox",`0 0 ${n} ${r}`);let a=Ve.createNS("http://www.w3.org/2000/svg","g");a.setAttributeNS(null,"stroke","none"),a.setAttributeNS(null,"stroke-width","1"),a.setAttributeNS(null,"fill","none"),a.setAttributeNS(null,"fill-rule","evenodd");let o=Ve.createNS("http://www.w3.org/2000/svg","g");o.setAttributeNS(null,"fill-rule","nonzero");let s=Ve.createNS("http://www.w3.org/2000/svg","g");s.setAttributeNS(null,"transform","translate(3.0, 29.0)"),s.setAttributeNS(null,"fill","#000000");let l=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(let v of l){let w=Ve.createNS("http://www.w3.org/2000/svg","ellipse");w.setAttributeNS(null,"opacity","0.04"),w.setAttributeNS(null,"cx","10.5"),w.setAttributeNS(null,"cy","5.80029008"),w.setAttributeNS(null,"rx",v.rx),w.setAttributeNS(null,"ry",v.ry),s.appendChild(w)}let u=Ve.createNS("http://www.w3.org/2000/svg","g");u.setAttributeNS(null,"fill",this._color);let c=Ve.createNS("http://www.w3.org/2000/svg","path");c.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),u.appendChild(c);let p=Ve.createNS("http://www.w3.org/2000/svg","g");p.setAttributeNS(null,"opacity","0.25"),p.setAttributeNS(null,"fill","#000000");let d=Ve.createNS("http://www.w3.org/2000/svg","path");d.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),p.appendChild(d);let m=Ve.createNS("http://www.w3.org/2000/svg","g");m.setAttributeNS(null,"transform","translate(6.0, 7.0)"),m.setAttributeNS(null,"fill","#FFFFFF");let g=Ve.createNS("http://www.w3.org/2000/svg","g");g.setAttributeNS(null,"transform","translate(8.0, 8.0)");let b=Ve.createNS("http://www.w3.org/2000/svg","circle");b.setAttributeNS(null,"fill","#000000"),b.setAttributeNS(null,"opacity","0.25"),b.setAttributeNS(null,"cx","5.5"),b.setAttributeNS(null,"cy","5.5"),b.setAttributeNS(null,"r","5.4999962");let x=Ve.createNS("http://www.w3.org/2000/svg","circle");x.setAttributeNS(null,"fill","#FFFFFF"),x.setAttributeNS(null,"cx","5.5"),x.setAttributeNS(null,"cy","5.5"),x.setAttributeNS(null,"r","5.4999962"),g.appendChild(b),g.appendChild(x),o.appendChild(s),o.appendChild(u),o.appendChild(p),o.appendChild(m),o.appendChild(g),t.appendChild(o),t.setAttributeNS(null,"height",`${r*this._scale}px`),t.setAttributeNS(null,"width",`${n*this._scale}px`),this._element.appendChild(t),this._offset=qg.default.convert(e&&e.offset||[0,-14])}else this._element=e.element,this._offset=qg.default.convert(e&&e.offset||[0,0]);if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",t=>{t.preventDefault()}),this._element.addEventListener("mousedown",t=>{t.preventDefault()}),dE(this._element,this._anchor,"marker"),e&&e.className)for(let t of e.className.split(" "))this._element.classList.add(t);this._popup=null}addTo(e){return this.remove(),this._map=e,e.getCanvasContainer().appendChild(this._element),e.on("move",this._update),e.on("moveend",this._update),e.on("terrain",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),Ve.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(e){return this._lngLat=Jt.convert(e),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(e){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),e){if(!("offset"in e.options)){let t=Math.abs(13.5)/Math.SQRT2;e.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[t,(38.1-13.5+t)*-1],"bottom-right":[-t,(38.1-13.5+t)*-1],left:[13.5,(38.1-13.5)*-1],right:[-13.5,(38.1-13.5)*-1]}:this._offset}this._popup=e,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}getPopup(){return this._popup}togglePopup(){let e=this._popup;if(this._element.style.opacity===this._opacityWhenCovered)return this;if(e)e.isOpen()?e.remove():(e.setLngLat(this._lngLat),e.addTo(this._map));else return this;return this}_updateOpacity(e=!1){var t,r;if(!((t=this._map)!=null&&t.terrain)){this._element.style.opacity!==this._opacity&&(this._element.style.opacity=this._opacity);return}if(e)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}let n=this._map,a=n.terrain.depthAtPoint(this._pos),o=n.terrain.getElevationForLngLatZoom(this._lngLat,n.transform.tileZoom),s=n.transform.lngLatToCameraDepth(this._lngLat,o),l=.006;if(s-a<l){this._element.style.opacity=this._opacity;return}let u=-this._offset.y/n.transform._pixelPerMeter,c=Math.sin(n.getPitch()*Math.PI/180)*u,p=n.terrain.depthAtPoint(new qg.default(this._pos.x,this._pos.y-this._offset.y)),d=n.transform.lngLatToCameraDepth(this._lngLat,o+c)-p>l;(r=this._popup)!=null&&r.isOpen()&&d&&this._popup.remove(),this._element.style.opacity=d?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(e){return this._offset=qg.default.convert(e),this._update(),this}addClassName(e){this._element.classList.add(e)}removeClassName(e){this._element.classList.remove(e)}toggleClassName(e){return this._element.classList.toggle(e)}setDraggable(e){return this._draggable=!!e,this._map&&(e?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(e){return this._rotation=e||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(e){return this._rotationAlignment=e||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(e){return this._pitchAlignment=e&&e!=="auto"?e:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(e,t){return e===void 0&&t===void 0&&(this._opacity="1",this._opacityWhenCovered="0.2"),e!==void 0&&(this._opacity=e),t!==void 0&&(this._opacityWhenCovered=t),this._map&&this._updateOpacity(!0),this}};h(mH,"Marker");var pA=mH,Ede={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},Zg=0,Cd=!1,gH=class extends hn{constructor(e){super(),this._onSuccess=t=>{if(this._map){if(this._isOutOfMapMaxBounds(t)){this._setErrorState(),this.fire(new qe("outofmaxbounds",t)),this._updateMarker(),this._finish();return}if(this.options.trackUserLocation)switch(this._lastKnownPosition=t,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(t),(!this.options.trackUserLocation||this._watchState==="ACTIVE_LOCK")&&this._updateCamera(t),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new qe("geolocate",t)),this._finish()}},this._updateCamera=t=>{let r=new Jt(t.coords.longitude,t.coords.latitude),n=t.coords.accuracy,a=this._map.getBearing(),o=ht({bearing:a},this.options.fitBoundsOptions),s=zl.fromLngLat(r,n);this._map.fitBounds(s,o,{geolocateSource:!0})},this._updateMarker=t=>{if(t){let r=new Jt(t.coords.longitude,t.coords.latitude);this._accuracyCircleMarker.setLngLat(r).addTo(this._map),this._userLocationDotMarker.setLngLat(r).addTo(this._map),this._accuracy=t.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=t=>{if(this._map){if(this.options.trackUserLocation)if(t.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;let r=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=r,this._geolocateButton.setAttribute("aria-label",r),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(t.code===3&&Cd)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new qe("error",t)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=t=>{if(this._map){if(this._container.addEventListener("contextmenu",r=>r.preventDefault()),this._geolocateButton=Ve.create("button","maplibregl-ctrl-geolocate",this._container),Ve.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",t===!1){ln("Geolocation support is not available so the GeolocateControl will be disabled.");let r=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=r,this._geolocateButton.setAttribute("aria-label",r)}else{let r=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=r,this._geolocateButton.setAttribute("aria-label",r)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=Ve.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new pA({element:this._dotElement}),this._circleElement=Ve.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new pA({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",r=>{let n=r.originalEvent&&r.originalEvent.type==="resize";!r.geolocateSource&&this._watchState==="ACTIVE_LOCK"&&!n&&(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new qe("trackuserlocationend")))})}},this.options=ht({},Ede,e)}onAdd(e){return this._map=e,this._container=Ve.create("div","maplibregl-ctrl maplibregl-ctrl-group"),fH().then(t=>this._setupUI(t)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),Ve.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Zg=0,Cd=!1}_isOutOfMapMaxBounds(e){let t=this._map.getMaxBounds(),r=e.coords;return t&&(r.longitude<t.getWest()||r.longitude>t.getEast()||r.latitude<t.getSouth()||r.latitude>t.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){let e=this._map.getBounds(),t=e.getSouthEast(),r=e.getNorthEast(),n=t.distanceTo(r),a=this._map._container.clientHeight,o=Math.ceil(2*(this._accuracy/(n/a)));this._circleElement.style.width=`${o}px`,this._circleElement.style.height=`${o}px`}trigger(){if(!this._setup)return ln("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new qe("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Zg--,Cd=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new qe("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new qe("trackuserlocationstart"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Zg++;let e;Zg>1?(e={maximumAge:6e5,timeout:0},Cd=!0):(e=this.options.positionOptions,Cd=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,e)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}};h(gH,"GeolocateControl");var NMe=gH;R();var Tde={maxWidth:100,unit:"metric"},yH=class{constructor(e){this._onMove=()=>{c3(this._map,this._container,this.options)},this.setUnit=t=>{this.options.unit=t,c3(this._map,this._container,this.options)},this.options={...Tde,...e}}getDefaultPosition(){return"bottom-left"}onAdd(e){return this._map=e,this._container=Ve.create("div","maplibregl-ctrl maplibregl-ctrl-scale",e.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){Ve.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}};h(yH,"ScaleControl");var UMe=yH;function c3(i,e,t){let r=t&&t.maxWidth||100,n=i._container.clientHeight/2,a=i.unproject([0,n]),o=i.unproject([r,n]),s=a.distanceTo(o);if(t&&t.unit==="imperial"){let l=3.2808*s;if(l>5280){let u=l/5280;Kh(e,r,u,i._getUIString("ScaleControl.Miles"))}else Kh(e,r,l,i._getUIString("ScaleControl.Feet"))}else if(t&&t.unit==="nautical"){let l=s/1852;Kh(e,r,l,i._getUIString("ScaleControl.NauticalMiles"))}else s>=1e3?Kh(e,r,s/1e3,i._getUIString("ScaleControl.Kilometers")):Kh(e,r,s,i._getUIString("ScaleControl.Meters"))}h(c3,"updateScale");function Kh(i,e,t,r){let n=xH(t),a=n/t;i.style.width=`${e*a}px`,i.innerHTML=`${n}&nbsp;${r}`}h(Kh,"setScale");function vH(i){let e=Math.pow(10,Math.ceil(-Math.log(i)/Math.LN10));return Math.round(i*e)/e}h(vH,"getDecimalRoundNum");function xH(i){let e=Math.pow(10,`${Math.floor(i)}`.length-1),t=i/e;return t=t>=10?10:t>=5?5:t>=3?3:t>=2?2:t>=1?1:vH(t),e*t}h(xH,"getRoundNum");R();var _H=class extends hn{constructor(e={}){super(),this._onFullscreenChange=()=>{var t;let r=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;(t=r==null?void 0:r.shadowRoot)!=null&&t.fullscreenElement;)r=r.shadowRoot.fullscreenElement;r===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,e&&e.container&&(e.container instanceof HTMLElement?this._container=e.container:ln("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(e){return this._map=e,this._container||(this._container=this._map.getContainer()),this._controlContainer=Ve.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){Ve.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){let e=this._fullscreenButton=Ve.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);Ve.create("span","maplibregl-ctrl-icon",e).setAttribute("aria-hidden","true"),e.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){let e=this._getTitle();this._fullscreenButton.setAttribute("aria-label",e),this._fullscreenButton.title=e}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new qe("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new qe("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}};h(_H,"FullscreenControl");var jMe=_H;R();var bH=class{constructor(e){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=e}onAdd(e){return this._map=e,this._container=Ve.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=Ve.create("button","maplibregl-ctrl-terrain",this._container),Ve.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){Ve.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}};h(bH,"TerrainControl");var GMe=bH;R();var fr=It(di(),1),Pde={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1},Ade=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", "),wH=class extends hn{constructor(e){super(),this.remove=()=>(this._content&&Ve.remove(this._content),this._container&&(Ve.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new qe("close"))),this),this._onMouseUp=t=>{this._update(t.point)},this._onMouseMove=t=>{this._update(t.point)},this._onDrag=t=>{this._update(t.point)},this._update=t=>{var r;let n=this._lngLat||this._trackPointer;if(!this._map||!n||!this._content)return;if(!this._container){if(this._container=Ve.create("div","maplibregl-popup",this._map.getContainer()),this._tip=Ve.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(let u of this.options.className.split(" "))this._container.classList.add(u);this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer?this._lngLat=cE(this._lngLat,this._flatPos,this._map.transform):this._lngLat=(r=this._lngLat)==null?void 0:r.wrap(),this._trackPointer&&!t)return;let a=this._flatPos=this._pos=this._trackPointer&&t?t:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&t?t:this._map.transform.locationPoint(this._lngLat));let o=this.options.anchor,s=fE(this.options.offset);if(!o){let u=this._container.offsetWidth,c=this._container.offsetHeight,p;a.y+s.bottom.y<c?p=["top"]:a.y>this._map.transform.height-c?p=["bottom"]:p=[],a.x<u/2?p.push("left"):a.x>this._map.transform.width-u/2&&p.push("right"),p.length===0?o="bottom":o=p.join("-")}let l=a.add(s[o]);this.options.subpixelPositioning||(l=l.round()),Ve.setTransform(this._container,`${pE[o]} translate(${l.x}px,${l.y}px)`),dE(this._container,o,"popup")},this._onClose=()=>{this.remove()},this.options=ht(Object.create(Pde),e)}addTo(e){return this._map&&this.remove(),this._map=e,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new qe("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(e){return this._lngLat=Jt.convert(e),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(e){return this.setDOMContent(document.createTextNode(e))}setHTML(e){let t=document.createDocumentFragment(),r=document.createElement("body"),n;for(r.innerHTML=e;n=r.firstChild,!!n;)t.appendChild(n);return this.setDOMContent(t)}getMaxWidth(){var e;return(e=this._container)==null?void 0:e.style.maxWidth}setMaxWidth(e){return this.options.maxWidth=e,this._update(),this}setDOMContent(e){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=Ve.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(e),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(e){this._container&&this._container.classList.add(e)}removeClassName(e){this._container&&this._container.classList.remove(e)}setOffset(e){return this.options.offset=e,this._update(),this}toggleClassName(e){if(this._container)return this._container.classList.toggle(e)}setSubpixelPositioning(e){this.options.subpixelPositioning=e}_createCloseButton(){this.options.closeButton&&(this._closeButton=Ve.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;let e=this._container.querySelector(Ade);e&&e.focus()}};h(wH,"Popup");var XMe=wH;function fE(i){if(i)if(typeof i=="number"){let e=Math.round(Math.abs(i)/Math.SQRT2);return{center:new fr.default(0,0),top:new fr.default(0,i),"top-left":new fr.default(e,e),"top-right":new fr.default(-e,e),bottom:new fr.default(0,-i),"bottom-left":new fr.default(e,-e),"bottom-right":new fr.default(-e,-e),left:new fr.default(i,0),right:new fr.default(-i,0)}}else if(i instanceof fr.default||Array.isArray(i)){let e=fr.default.convert(i);return{center:e,top:e,"top-left":e,"top-right":e,bottom:e,"bottom-left":e,"bottom-right":e,left:e,right:e}}else return{center:fr.default.convert(i.center||[0,0]),top:fr.default.convert(i.top||[0,0]),"top-left":fr.default.convert(i["top-left"]||[0,0]),"top-right":fr.default.convert(i["top-right"]||[0,0]),bottom:fr.default.convert(i.bottom||[0,0]),"bottom-left":fr.default.convert(i["bottom-left"]||[0,0]),"bottom-right":fr.default.convert(i["bottom-right"]||[0,0]),left:fr.default.convert(i.left||[0,0]),right:fr.default.convert(i.right||[0,0])};else return fE(new fr.default(0,0))}h(fE,"normalizeOffset");var qMe=It(di(),1),Ide=eL.version;function Lde(i,e){return Bp().setRTLTextPlugin(i,e)}h(Lde,"setRTLTextPlugin");function Dde(){return Bp().getRTLTextPluginStatus()}h(Dde,"getRTLTextPluginStatus");function kde(){return Ide}h(kde,"getVersion");function Rde(){return Lx.workerCount}h(Rde,"getWorkerCount");function Fde(i){Lx.workerCount=i}h(Fde,"setWorkerCount");function zde(){return vo.MAX_PARALLEL_IMAGE_REQUESTS}h(zde,"getMaxParallelImageRequests");function Bde(i){vo.MAX_PARALLEL_IMAGE_REQUESTS=i}h(Bde,"setMaxParallelImageRequests");function Ode(){return vo.WORKER_URL}h(Ode,"getWorkerUrl");function Nde(i){vo.WORKER_URL=i}h(Nde,"setWorkerUrl");function $de(i){return V5().broadcast("IS",i)}h($de,"importScriptInWorkers");R();var mE="162",K_={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},Ude=0,dA=1,Vde=2,SH=1,jde=2,ss=3,Bl=0,Wn=1,Da=2,Al=0,pp=1,fA=2,mA=3,gA=4,Hde=5,bu=100,Gde=101,Wde=102,yA=103,vA=104,Xde=200,qde=201,Zde=202,Yde=203,p3=204,d3=205,Jde=206,Kde=207,Qde=208,efe=209,tfe=210,ife=211,rfe=212,nfe=213,afe=214,ofe=0,sfe=1,lfe=2,mv=3,ufe=4,hfe=5,cfe=6,pfe=7,gE=0,dfe=1,ffe=2,Il=0,mfe=1,gfe=2,yfe=3,vfe=4,xfe=5,_fe=6,bfe=7,xA="attached",wfe="detached",MH=300,Op=301,Np=302,f3=303,m3=304,Ox=306,po=1e3,ho=1001,g3=1002,Xr=1003,_A=1004,Ed=1005,Fn=1006,Q_=1007,Pu=1008,Ll=1009,Sfe=1010,Mfe=1011,yE=1012,CH=1013,yl=1014,na=1015,Tm=1016,EH=1017,TH=1018,zu=1020,Cfe=1021,$n=1023,Efe=1024,Tfe=1025,Bu=1026,$p=1027,PH=1028,AH=1029,Pfe=1030,IH=1031,LH=1033,e2=33776,t2=33777,i2=33778,r2=33779,bA=35840,wA=35841,SA=35842,MA=35843,DH=36196,CA=37492,EA=37496,TA=37808,PA=37809,AA=37810,IA=37811,LA=37812,DA=37813,kA=37814,RA=37815,FA=37816,zA=37817,BA=37818,OA=37819,NA=37820,$A=37821,n2=36492,UA=36494,VA=36495,Afe=36283,jA=36284,HA=36285,GA=36286,gv=2300,yv=2301,a2=2302,WA=2400,XA=2401,qA=2402,Ife=2500,Lfe=0,Dfe=1,ZA=2,kfe=3200,Rfe=3201,vE=0,Ffe=1,pl="",zn="srgb",Gl="srgb-linear",xE="display-p3",Nx="display-p3-linear",vv="linear",Di="srgb",xv="rec709",_v="p3",Mh=7680,YA=519,zfe=512,Bfe=513,Ofe=514,kH=515,Nfe=516,$fe=517,Ufe=518,Vfe=519,y3=35044,JA="300 es",v3=1035,Ms=2e3,bv=2001,RH=class{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});let r=this._listeners;r[e]===void 0&&(r[e]=[]),r[e].indexOf(t)===-1&&r[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;let r=this._listeners;return r[e]!==void 0&&r[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;let r=this._listeners[e];if(r!==void 0){let n=r.indexOf(t);n!==-1&&r.splice(n,1)}}dispatchEvent(e){if(this._listeners===void 0)return;let t=this._listeners[e.type];if(t!==void 0){e.target=this;let r=t.slice(0);for(let n=0,a=r.length;n<a;n++)r[n].call(this,e);e.target=null}}};h(RH,"EventDispatcher");var id=RH,en=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],KA=1234567,dp=Math.PI/180,Up=180/Math.PI;function ha(){let i=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,r=Math.random()*4294967295|0;return(en[i&255]+en[i>>8&255]+en[i>>16&255]+en[i>>24&255]+"-"+en[e&255]+en[e>>8&255]+"-"+en[e>>16&15|64]+en[e>>24&255]+"-"+en[t&63|128]+en[t>>8&255]+"-"+en[t>>16&255]+en[t>>24&255]+en[r&255]+en[r>>8&255]+en[r>>16&255]+en[r>>24&255]).toLowerCase()}h(ha,"generateUUID");function Fr(i,e,t){return Math.max(e,Math.min(t,i))}h(Fr,"clamp");function $x(i,e){return(i%e+e)%e}h($x,"euclideanModulo");function FH(i,e,t,r,n){return r+(i-e)*(n-r)/(t-e)}h(FH,"mapLinear");function zH(i,e,t){return i!==e?(t-i)/(e-i):0}h(zH,"inverseLerp");function fp(i,e,t){return(1-t)*i+t*e}h(fp,"lerp");function BH(i,e,t,r){return fp(i,e,1-Math.exp(-t*r))}h(BH,"damp");function OH(i,e=1){return e-Math.abs($x(i,e*2)-e)}h(OH,"pingpong");function NH(i,e,t){return i<=e?0:i>=t?1:(i=(i-e)/(t-e),i*i*(3-2*i))}h(NH,"smoothstep");function $H(i,e,t){return i<=e?0:i>=t?1:(i=(i-e)/(t-e),i*i*i*(i*(i*6-15)+10))}h($H,"smootherstep");function UH(i,e){return i+Math.floor(Math.random()*(e-i+1))}h(UH,"randInt");function VH(i,e){return i+Math.random()*(e-i)}h(VH,"randFloat");function jH(i){return i*(.5-Math.random())}h(jH,"randFloatSpread");function HH(i){i!==void 0&&(KA=i);let e=KA+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}h(HH,"seededRandom");function GH(i){return i*dp}h(GH,"degToRad");function WH(i){return i*Up}h(WH,"radToDeg");function wv(i){return(i&i-1)===0&&i!==0}h(wv,"isPowerOfTwo");function XH(i){return Math.pow(2,Math.ceil(Math.log(i)/Math.LN2))}h(XH,"ceilPowerOfTwo");function Pm(i){return Math.pow(2,Math.floor(Math.log(i)/Math.LN2))}h(Pm,"floorPowerOfTwo");function qH(i,e,t,r,n){let a=Math.cos,o=Math.sin,s=a(t/2),l=o(t/2),u=a((e+r)/2),c=o((e+r)/2),p=a((e-r)/2),d=o((e-r)/2),m=a((r-e)/2),g=o((r-e)/2);switch(n){case"XYX":i.set(s*c,l*p,l*d,s*u);break;case"YZY":i.set(l*d,s*c,l*p,s*u);break;case"ZXZ":i.set(l*p,l*d,s*c,s*u);break;case"XZX":i.set(s*c,l*g,l*m,s*u);break;case"YXY":i.set(l*m,s*c,l*g,s*u);break;case"ZYZ":i.set(l*g,l*m,s*c,s*u);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+n)}}h(qH,"setQuaternionFromProperEuler");function ka(i,e){switch(e.constructor){case Float32Array:return i;case Uint32Array:return i/4294967295;case Uint16Array:return i/65535;case Uint8Array:return i/255;case Int32Array:return Math.max(i/2147483647,-1);case Int16Array:return Math.max(i/32767,-1);case Int8Array:return Math.max(i/127,-1);default:throw new Error("Invalid component type.")}}h(ka,"denormalize");function yi(i,e){switch(e.constructor){case Float32Array:return i;case Uint32Array:return Math.round(i*4294967295);case Uint16Array:return Math.round(i*65535);case Uint8Array:return Math.round(i*255);case Int32Array:return Math.round(i*2147483647);case Int16Array:return Math.round(i*32767);case Int8Array:return Math.round(i*127);default:throw new Error("Invalid component type.")}}h(yi,"normalize");var ki={DEG2RAD:dp,RAD2DEG:Up,generateUUID:ha,clamp:Fr,euclideanModulo:$x,mapLinear:FH,inverseLerp:zH,lerp:fp,damp:BH,pingpong:OH,smoothstep:NH,smootherstep:$H,randInt:UH,randFloat:VH,randFloatSpread:jH,seededRandom:HH,degToRad:GH,radToDeg:WH,isPowerOfTwo:wv,ceilPowerOfTwo:XH,floorPowerOfTwo:Pm,setQuaternionFromProperEuler:qH,normalize:yi,denormalize:ka},ZH=class YH{constructor(e=0,t=0){YH.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){let t=this.x,r=this.y,n=e.elements;return this.x=n[0]*t+n[3]*r+n[6],this.y=n[1]*t+n[4]*r+n[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){let r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){let t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;let r=this.dot(e)/t;return Math.acos(Fr(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let t=this.x-e.x,r=this.y-e.y;return t*t+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){let r=Math.cos(t),n=Math.sin(t),a=this.x-e.x,o=this.y-e.y;return this.x=a*r-o*n+e.x,this.y=a*n+o*r+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}};h(ZH,"Vector2");var Oe=ZH,JH=class KH{constructor(e,t,r,n,a,o,s,l,u){KH.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,t,r,n,a,o,s,l,u)}set(e,t,r,n,a,o,s,l,u){let c=this.elements;return c[0]=e,c[1]=n,c[2]=s,c[3]=t,c[4]=a,c[5]=l,c[6]=r,c[7]=o,c[8]=u,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){let t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],this}extractBasis(e,t,r){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),r.setFromMatrix3Column(this,2),this}setFromMatrix4(e){let t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){let r=e.elements,n=t.elements,a=this.elements,o=r[0],s=r[3],l=r[6],u=r[1],c=r[4],p=r[7],d=r[2],m=r[5],g=r[8],b=n[0],x=n[3],v=n[6],w=n[1],_=n[4],C=n[7],E=n[2],T=n[5],L=n[8];return a[0]=o*b+s*w+l*E,a[3]=o*x+s*_+l*T,a[6]=o*v+s*C+l*L,a[1]=u*b+c*w+p*E,a[4]=u*x+c*_+p*T,a[7]=u*v+c*C+p*L,a[2]=d*b+m*w+g*E,a[5]=d*x+m*_+g*T,a[8]=d*v+m*C+g*L,this}multiplyScalar(e){let t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){let e=this.elements,t=e[0],r=e[1],n=e[2],a=e[3],o=e[4],s=e[5],l=e[6],u=e[7],c=e[8];return t*o*c-t*s*u-r*a*c+r*s*l+n*a*u-n*o*l}invert(){let e=this.elements,t=e[0],r=e[1],n=e[2],a=e[3],o=e[4],s=e[5],l=e[6],u=e[7],c=e[8],p=c*o-s*u,d=s*l-c*a,m=u*a-o*l,g=t*p+r*d+n*m;if(g===0)return this.set(0,0,0,0,0,0,0,0,0);let b=1/g;return e[0]=p*b,e[1]=(n*u-c*r)*b,e[2]=(s*r-n*o)*b,e[3]=d*b,e[4]=(c*t-n*l)*b,e[5]=(n*a-s*t)*b,e[6]=m*b,e[7]=(r*l-u*t)*b,e[8]=(o*t-r*a)*b,this}transpose(){let e,t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){let t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,r,n,a,o,s){let l=Math.cos(a),u=Math.sin(a);return this.set(r*l,r*u,-r*(l*o+u*s)+o+e,-n*u,n*l,-n*(-u*o+l*s)+s+t,0,0,1),this}scale(e,t){return this.premultiply(o2.makeScale(e,t)),this}rotate(e){return this.premultiply(o2.makeRotation(-e)),this}translate(e,t){return this.premultiply(o2.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){let t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,r,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){let t=this.elements,r=e.elements;for(let n=0;n<9;n++)if(t[n]!==r[n])return!1;return!0}fromArray(e,t=0){for(let r=0;r<9;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){let r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e}clone(){return new this.constructor().fromArray(this.elements)}};h(JH,"Matrix3");var ei=JH,o2=new ei;function _E(i){for(let e=i.length-1;e>=0;--e)if(i[e]>=65535)return!0;return!1}h(_E,"arrayNeedsUint32");function Vp(i){return document.createElementNS("http://www.w3.org/1999/xhtml",i)}h(Vp,"createElementNS");function QH(){let i=Vp("canvas");return i.style.display="block",i}h(QH,"createCanvasElement");var QA={};function bE(i){i in QA||(QA[i]=!0,console.warn(i))}h(bE,"warnOnce");var e6=new ei().set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),t6=new ei().set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),Yg={[Gl]:{transfer:vv,primaries:xv,toReference:i=>i,fromReference:i=>i},[zn]:{transfer:Di,primaries:xv,toReference:i=>i.convertSRGBToLinear(),fromReference:i=>i.convertLinearToSRGB()},[Nx]:{transfer:vv,primaries:_v,toReference:i=>i.applyMatrix3(t6),fromReference:i=>i.applyMatrix3(e6)},[xE]:{transfer:Di,primaries:_v,toReference:i=>i.convertSRGBToLinear().applyMatrix3(t6),fromReference:i=>i.applyMatrix3(e6).convertLinearToSRGB()}},jfe=new Set([Gl,Nx]),Si={enabled:!0,_workingColorSpace:Gl,get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(i){if(!jfe.has(i))throw new Error(`Unsupported working color space, "${i}".`);this._workingColorSpace=i},convert:function(i,e,t){if(this.enabled===!1||e===t||!e||!t)return i;let r=Yg[e].toReference,n=Yg[t].fromReference;return n(r(i))},fromWorkingColorSpace:function(i,e){return this.convert(i,this._workingColorSpace,e)},toWorkingColorSpace:function(i,e){return this.convert(i,e,this._workingColorSpace)},getPrimaries:function(i){return Yg[i].primaries},getTransfer:function(i){return i===pl?vv:Yg[i].transfer}};function Ou(i){return i<.04045?i*.0773993808:Math.pow(i*.9478672986+.0521327014,2.4)}h(Ou,"SRGBToLinear");function vy(i){return i<.0031308?i*12.92:1.055*Math.pow(i,.41666)-.055}h(vy,"LinearToSRGB");var Ch,eG=class{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{Ch===void 0&&(Ch=Vp("canvas")),Ch.width=e.width,Ch.height=e.height;let r=Ch.getContext("2d");e instanceof ImageData?r.putImageData(e,0,0):r.drawImage(e,0,0,e.width,e.height),t=Ch}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){let t=Vp("canvas");t.width=e.width,t.height=e.height;let r=t.getContext("2d");r.drawImage(e,0,0,e.width,e.height);let n=r.getImageData(0,0,e.width,e.height),a=n.data;for(let o=0;o<a.length;o++)a[o]=Ou(a[o]/255)*255;return r.putImageData(n,0,0),t}else if(e.data){let t=e.data.slice(0);for(let r=0;r<t.length;r++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[r]=Math.floor(Ou(t[r]/255)*255):t[r]=Ou(t[r]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}};h(eG,"ImageUtils");var tG=eG,Hfe=0,iG=class{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:Hfe++}),this.uuid=ha(),this.data=e,this.dataReady=!0,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){let t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];let r={uuid:this.uuid,url:""},n=this.data;if(n!==null){let a;if(Array.isArray(n)){a=[];for(let o=0,s=n.length;o<s;o++)n[o].isDataTexture?a.push(xy(n[o].image)):a.push(xy(n[o]))}else a=xy(n);r.url=a}return t||(e.images[this.uuid]=r),r}};h(iG,"Source");var rG=iG;function xy(i){return typeof HTMLImageElement<"u"&&i instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&i instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&i instanceof ImageBitmap?tG.getDataURL(i):i.data?{data:Array.from(i.data),width:i.width,height:i.height,type:i.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}h(xy,"serializeImage");var Gfe=0,nG=class _y extends id{constructor(e=_y.DEFAULT_IMAGE,t=_y.DEFAULT_MAPPING,r=ho,n=ho,a=Fn,o=Pu,s=$n,l=Ll,u=_y.DEFAULT_ANISOTROPY,c=pl){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:Gfe++}),this.uuid=ha(),this.name="",this.source=new rG(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=r,this.wrapT=n,this.magFilter=a,this.minFilter=o,this.anisotropy=u,this.format=s,this.internalFormat=null,this.type=l,this.offset=new Oe(0,0),this.repeat=new Oe(1,1),this.center=new Oe(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new ei,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=c,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){let t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];let r={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(r.userData=this.userData),t||(e.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==MH)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case po:e.x=e.x-Math.floor(e.x);break;case ho:e.x=e.x<0?0:1;break;case g3:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case po:e.y=e.y-Math.floor(e.y);break;case ho:e.y=e.y<0?0:1;break;case g3:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}};h(nG,"Texture");var En=nG;En.DEFAULT_IMAGE=null;En.DEFAULT_MAPPING=MH;En.DEFAULT_ANISOTROPY=1;var aG=class oG{constructor(e=0,t=0,r=0,n=1){oG.prototype.isVector4=!0,this.x=e,this.y=t,this.z=r,this.w=n}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,r,n){return this.x=e,this.y=t,this.z=r,this.w=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){let t=this.x,r=this.y,n=this.z,a=this.w,o=e.elements;return this.x=o[0]*t+o[4]*r+o[8]*n+o[12]*a,this.y=o[1]*t+o[5]*r+o[9]*n+o[13]*a,this.z=o[2]*t+o[6]*r+o[10]*n+o[14]*a,this.w=o[3]*t+o[7]*r+o[11]*n+o[15]*a,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);let t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,r,n,a,o=e.elements,s=o[0],l=o[4],u=o[8],c=o[1],p=o[5],d=o[9],m=o[2],g=o[6],b=o[10];if(Math.abs(l-c)<.01&&Math.abs(u-m)<.01&&Math.abs(d-g)<.01){if(Math.abs(l+c)<.1&&Math.abs(u+m)<.1&&Math.abs(d+g)<.1&&Math.abs(s+p+b-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;let v=(s+1)/2,w=(p+1)/2,_=(b+1)/2,C=(l+c)/4,E=(u+m)/4,T=(d+g)/4;return v>w&&v>_?v<.01?(r=0,n=.707106781,a=.707106781):(r=Math.sqrt(v),n=C/r,a=E/r):w>_?w<.01?(r=.707106781,n=0,a=.707106781):(n=Math.sqrt(w),r=C/n,a=T/n):_<.01?(r=.707106781,n=.707106781,a=0):(a=Math.sqrt(_),r=E/a,n=T/a),this.set(r,n,a,t),this}let x=Math.sqrt((g-d)*(g-d)+(u-m)*(u-m)+(c-l)*(c-l));return Math.abs(x)<.001&&(x=1),this.x=(g-d)/x,this.y=(u-m)/x,this.z=(c-l)/x,this.w=Math.acos((s+p+b-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){let r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this.w=e.w+(t.w-e.w)*r,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}};h(aG,"Vector4");var Ei=aG,sG=class extends id{constructor(e=1,t=1,r={}){super(),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new Ei(0,0,e,t),this.scissorTest=!1,this.viewport=new Ei(0,0,e,t);let n={width:e,height:t,depth:1};r=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:Fn,depthBuffer:!0,stencilBuffer:!1,depthTexture:null,samples:0,count:1},r);let a=new En(n,r.mapping,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.colorSpace);a.flipY=!1,a.generateMipmaps=r.generateMipmaps,a.internalFormat=r.internalFormat,this.textures=[];let o=r.count;for(let s=0;s<o;s++)this.textures[s]=a.clone(),this.textures[s].isRenderTargetTexture=!0;this.depthBuffer=r.depthBuffer,this.stencilBuffer=r.stencilBuffer,this.depthTexture=r.depthTexture,this.samples=r.samples}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}setSize(e,t,r=1){if(this.width!==e||this.height!==t||this.depth!==r){this.width=e,this.height=t,this.depth=r;for(let n=0,a=this.textures.length;n<a;n++)this.textures[n].image.width=e,this.textures[n].image.height=t,this.textures[n].image.depth=r;this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let r=0,n=e.textures.length;r<n;r++)this.textures[r]=e.textures[r].clone(),this.textures[r].isRenderTargetTexture=!0;let t=Object.assign({},e.texture.image);return this.texture.source=new rG(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}};h(sG,"RenderTarget");var Wfe=sG,lG=class extends Wfe{constructor(e=1,t=1,r={}){super(e,t,r),this.isWebGLRenderTarget=!0}};h(lG,"WebGLRenderTarget");var Qu=lG,uG=class extends En{constructor(e=null,t=1,r=1,n=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:r,depth:n},this.magFilter=Xr,this.minFilter=Xr,this.wrapR=ho,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}};h(uG,"DataArrayTexture");var hG=uG,cG=class extends En{constructor(e=null,t=1,r=1,n=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:r,depth:n},this.magFilter=Xr,this.minFilter=Xr,this.wrapR=ho,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}};h(cG,"Data3DTexture");var Xfe=cG,pG=class{constructor(e=0,t=0,r=0,n=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=r,this._w=n}static slerpFlat(e,t,r,n,a,o,s){let l=r[n+0],u=r[n+1],c=r[n+2],p=r[n+3],d=a[o+0],m=a[o+1],g=a[o+2],b=a[o+3];if(s===0){e[t+0]=l,e[t+1]=u,e[t+2]=c,e[t+3]=p;return}if(s===1){e[t+0]=d,e[t+1]=m,e[t+2]=g,e[t+3]=b;return}if(p!==b||l!==d||u!==m||c!==g){let x=1-s,v=l*d+u*m+c*g+p*b,w=v>=0?1:-1,_=1-v*v;if(_>Number.EPSILON){let E=Math.sqrt(_),T=Math.atan2(E,v*w);x=Math.sin(x*T)/E,s=Math.sin(s*T)/E}let C=s*w;if(l=l*x+d*C,u=u*x+m*C,c=c*x+g*C,p=p*x+b*C,x===1-s){let E=1/Math.sqrt(l*l+u*u+c*c+p*p);l*=E,u*=E,c*=E,p*=E}}e[t]=l,e[t+1]=u,e[t+2]=c,e[t+3]=p}static multiplyQuaternionsFlat(e,t,r,n,a,o){let s=r[n],l=r[n+1],u=r[n+2],c=r[n+3],p=a[o],d=a[o+1],m=a[o+2],g=a[o+3];return e[t]=s*g+c*p+l*m-u*d,e[t+1]=l*g+c*d+u*p-s*m,e[t+2]=u*g+c*m+s*d-l*p,e[t+3]=c*g-s*p-l*d-u*m,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,r,n){return this._x=e,this._y=t,this._z=r,this._w=n,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){let r=e._x,n=e._y,a=e._z,o=e._order,s=Math.cos,l=Math.sin,u=s(r/2),c=s(n/2),p=s(a/2),d=l(r/2),m=l(n/2),g=l(a/2);switch(o){case"XYZ":this._x=d*c*p+u*m*g,this._y=u*m*p-d*c*g,this._z=u*c*g+d*m*p,this._w=u*c*p-d*m*g;break;case"YXZ":this._x=d*c*p+u*m*g,this._y=u*m*p-d*c*g,this._z=u*c*g-d*m*p,this._w=u*c*p+d*m*g;break;case"ZXY":this._x=d*c*p-u*m*g,this._y=u*m*p+d*c*g,this._z=u*c*g+d*m*p,this._w=u*c*p-d*m*g;break;case"ZYX":this._x=d*c*p-u*m*g,this._y=u*m*p+d*c*g,this._z=u*c*g-d*m*p,this._w=u*c*p+d*m*g;break;case"YZX":this._x=d*c*p+u*m*g,this._y=u*m*p+d*c*g,this._z=u*c*g-d*m*p,this._w=u*c*p-d*m*g;break;case"XZY":this._x=d*c*p-u*m*g,this._y=u*m*p-d*c*g,this._z=u*c*g+d*m*p,this._w=u*c*p+d*m*g;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return t===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,t){let r=t/2,n=Math.sin(r);return this._x=e.x*n,this._y=e.y*n,this._z=e.z*n,this._w=Math.cos(r),this._onChangeCallback(),this}setFromRotationMatrix(e){let t=e.elements,r=t[0],n=t[4],a=t[8],o=t[1],s=t[5],l=t[9],u=t[2],c=t[6],p=t[10],d=r+s+p;if(d>0){let m=.5/Math.sqrt(d+1);this._w=.25/m,this._x=(c-l)*m,this._y=(a-u)*m,this._z=(o-n)*m}else if(r>s&&r>p){let m=2*Math.sqrt(1+r-s-p);this._w=(c-l)/m,this._x=.25*m,this._y=(n+o)/m,this._z=(a+u)/m}else if(s>p){let m=2*Math.sqrt(1+s-r-p);this._w=(a-u)/m,this._x=(n+o)/m,this._y=.25*m,this._z=(l+c)/m}else{let m=2*Math.sqrt(1+p-r-s);this._w=(o-n)/m,this._x=(a+u)/m,this._y=(l+c)/m,this._z=.25*m}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let r=e.dot(t)+1;return r<Number.EPSILON?(r=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=r):(this._x=0,this._y=-e.z,this._z=e.y,this._w=r)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=r),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Fr(this.dot(e),-1,1)))}rotateTowards(e,t){let r=this.angleTo(e);if(r===0)return this;let n=Math.min(1,t/r);return this.slerp(e,n),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){let r=e._x,n=e._y,a=e._z,o=e._w,s=t._x,l=t._y,u=t._z,c=t._w;return this._x=r*c+o*s+n*u-a*l,this._y=n*c+o*l+a*s-r*u,this._z=a*c+o*u+r*l-n*s,this._w=o*c-r*s-n*l-a*u,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);let r=this._x,n=this._y,a=this._z,o=this._w,s=o*e._w+r*e._x+n*e._y+a*e._z;if(s<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,s=-s):this.copy(e),s>=1)return this._w=o,this._x=r,this._y=n,this._z=a,this;let l=1-s*s;if(l<=Number.EPSILON){let m=1-t;return this._w=m*o+t*this._w,this._x=m*r+t*this._x,this._y=m*n+t*this._y,this._z=m*a+t*this._z,this.normalize(),this}let u=Math.sqrt(l),c=Math.atan2(u,s),p=Math.sin((1-t)*c)/u,d=Math.sin(t*c)/u;return this._w=o*p+this._w*d,this._x=r*p+this._x*d,this._y=n*p+this._y*d,this._z=a*p+this._z*d,this._onChangeCallback(),this}slerpQuaternions(e,t,r){return this.copy(e).slerp(t,r)}random(){let e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),r=Math.random(),n=Math.sqrt(1-r),a=Math.sqrt(r);return this.set(n*Math.sin(e),n*Math.cos(e),a*Math.sin(t),a*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}};h(pG,"Quaternion");var dh=pG,dG=class fG{constructor(e=0,t=0,r=0){fG.prototype.isVector3=!0,this.x=e,this.y=t,this.z=r}set(e,t,r){return r===void 0&&(r=this.z),this.x=e,this.y=t,this.z=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(i6.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(i6.setFromAxisAngle(e,t))}applyMatrix3(e){let t=this.x,r=this.y,n=this.z,a=e.elements;return this.x=a[0]*t+a[3]*r+a[6]*n,this.y=a[1]*t+a[4]*r+a[7]*n,this.z=a[2]*t+a[5]*r+a[8]*n,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){let t=this.x,r=this.y,n=this.z,a=e.elements,o=1/(a[3]*t+a[7]*r+a[11]*n+a[15]);return this.x=(a[0]*t+a[4]*r+a[8]*n+a[12])*o,this.y=(a[1]*t+a[5]*r+a[9]*n+a[13])*o,this.z=(a[2]*t+a[6]*r+a[10]*n+a[14])*o,this}applyQuaternion(e){let t=this.x,r=this.y,n=this.z,a=e.x,o=e.y,s=e.z,l=e.w,u=2*(o*n-s*r),c=2*(s*t-a*n),p=2*(a*r-o*t);return this.x=t+l*u+o*p-s*c,this.y=r+l*c+s*u-a*p,this.z=n+l*p+a*c-o*u,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){let t=this.x,r=this.y,n=this.z,a=e.elements;return this.x=a[0]*t+a[4]*r+a[8]*n,this.y=a[1]*t+a[5]*r+a[9]*n,this.z=a[2]*t+a[6]*r+a[10]*n,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){let r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){let r=e.x,n=e.y,a=e.z,o=t.x,s=t.y,l=t.z;return this.x=n*l-a*s,this.y=a*o-r*l,this.z=r*s-n*o,this}projectOnVector(e){let t=e.lengthSq();if(t===0)return this.set(0,0,0);let r=e.dot(this)/t;return this.copy(e).multiplyScalar(r)}projectOnPlane(e){return s2.copy(this).projectOnVector(e),this.sub(s2)}reflect(e){return this.sub(s2.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){let t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;let r=this.dot(e)/t;return Math.acos(Fr(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let t=this.x-e.x,r=this.y-e.y,n=this.z-e.z;return t*t+r*r+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,r){let n=Math.sin(t)*e;return this.x=n*Math.sin(r),this.y=Math.cos(t)*e,this.z=n*Math.cos(r),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,r){return this.x=e*Math.sin(t),this.y=r,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){let t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){let t=this.setFromMatrixColumn(e,0).length(),r=this.setFromMatrixColumn(e,1).length(),n=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=r,this.z=n,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){let e=Math.random()*Math.PI*2,t=Math.random()*2-1,r=Math.sqrt(1-t*t);return this.x=r*Math.cos(e),this.y=t,this.z=r*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}};h(dG,"Vector3");var le=dG,s2=new le,i6=new dh,mG=class{constructor(e=new le(1/0,1/0,1/0),t=new le(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t+=3)this.expandByPoint(qa.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,r=e.count;t<r;t++)this.expandByPoint(qa.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){let r=qa.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);let r=e.geometry;if(r!==void 0){let a=r.getAttribute("position");if(t===!0&&a!==void 0&&e.isInstancedMesh!==!0)for(let o=0,s=a.count;o<s;o++)e.isMesh===!0?e.getVertexPosition(o,qa):qa.fromBufferAttribute(a,o),qa.applyMatrix4(e.matrixWorld),this.expandByPoint(qa);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),Jg.copy(e.boundingBox)):(r.boundingBox===null&&r.computeBoundingBox(),Jg.copy(r.boundingBox)),Jg.applyMatrix4(e.matrixWorld),this.union(Jg)}let n=e.children;for(let a=0,o=n.length;a<o;a++)this.expandByObject(n[a],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,qa),qa.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,r;return e.normal.x>0?(t=e.normal.x*this.min.x,r=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,r=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,r+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,r+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,r+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,r+=e.normal.z*this.min.z),t<=-e.constant&&r>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Td),Kg.subVectors(this.max,Td),Eh.subVectors(e.a,Td),Th.subVectors(e.b,Td),Ph.subVectors(e.c,Td),Vs.subVectors(Th,Eh),js.subVectors(Ph,Th),Yl.subVectors(Eh,Ph);let t=[0,-Vs.z,Vs.y,0,-js.z,js.y,0,-Yl.z,Yl.y,Vs.z,0,-Vs.x,js.z,0,-js.x,Yl.z,0,-Yl.x,-Vs.y,Vs.x,0,-js.y,js.x,0,-Yl.y,Yl.x,0];return!by(t,Eh,Th,Ph,Kg)||(t=[1,0,0,0,1,0,0,0,1],!by(t,Eh,Th,Ph,Kg))?!1:(Qg.crossVectors(Vs,js),t=[Qg.x,Qg.y,Qg.z],by(t,Eh,Th,Ph,Kg))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,qa).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(qa).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(es[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),es[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),es[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),es[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),es[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),es[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),es[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),es[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(es),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}};h(mG,"Box3");var Yr=mG,es=[new le,new le,new le,new le,new le,new le,new le,new le],qa=new le,Jg=new Yr,Eh=new le,Th=new le,Ph=new le,Vs=new le,js=new le,Yl=new le,Td=new le,Kg=new le,Qg=new le,Jl=new le;function by(i,e,t,r,n){for(let a=0,o=i.length-3;a<=o;a+=3){Jl.fromArray(i,a);let s=n.x*Math.abs(Jl.x)+n.y*Math.abs(Jl.y)+n.z*Math.abs(Jl.z),l=e.dot(Jl),u=t.dot(Jl),c=r.dot(Jl);if(Math.max(-Math.max(l,u,c),Math.min(l,u,c))>s)return!1}return!0}h(by,"satForAxes");var qfe=new Yr,Pd=new le,l2=new le,gG=class{constructor(e=new le,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){let r=this.center;t!==void 0?r.copy(t):qfe.setFromPoints(e).getCenter(r);let n=0;for(let a=0,o=e.length;a<o;a++)n=Math.max(n,r.distanceToSquared(e[a]));return this.radius=Math.sqrt(n),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){let t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){let r=this.center.distanceToSquared(e);return t.copy(e),r>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;Pd.subVectors(e,this.center);let t=Pd.lengthSq();if(t>this.radius*this.radius){let r=Math.sqrt(t),n=(r-this.radius)*.5;this.center.addScaledVector(Pd,n/r),this.radius+=n}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(l2.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(Pd.copy(e.center).add(l2)),this.expandByPoint(Pd.copy(e.center).sub(l2))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}};h(gG,"Sphere");var Xn=gG,ts=new le,u2=new le,e1=new le,Hs=new le,h2=new le,t1=new le,c2=new le,yG=class{constructor(e=new le,t=new le(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,ts)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);let r=t.dot(this.direction);return r<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,r)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){let t=ts.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(ts.copy(this.origin).addScaledVector(this.direction,t),ts.distanceToSquared(e))}distanceSqToSegment(e,t,r,n){u2.copy(e).add(t).multiplyScalar(.5),e1.copy(t).sub(e).normalize(),Hs.copy(this.origin).sub(u2);let a=e.distanceTo(t)*.5,o=-this.direction.dot(e1),s=Hs.dot(this.direction),l=-Hs.dot(e1),u=Hs.lengthSq(),c=Math.abs(1-o*o),p,d,m,g;if(c>0)if(p=o*l-s,d=o*s-l,g=a*c,p>=0)if(d>=-g)if(d<=g){let b=1/c;p*=b,d*=b,m=p*(p+o*d+2*s)+d*(o*p+d+2*l)+u}else d=a,p=Math.max(0,-(o*d+s)),m=-p*p+d*(d+2*l)+u;else d=-a,p=Math.max(0,-(o*d+s)),m=-p*p+d*(d+2*l)+u;else d<=-g?(p=Math.max(0,-(-o*a+s)),d=p>0?-a:Math.min(Math.max(-a,-l),a),m=-p*p+d*(d+2*l)+u):d<=g?(p=0,d=Math.min(Math.max(-a,-l),a),m=d*(d+2*l)+u):(p=Math.max(0,-(o*a+s)),d=p>0?a:Math.min(Math.max(-a,-l),a),m=-p*p+d*(d+2*l)+u);else d=o>0?-a:a,p=Math.max(0,-(o*d+s)),m=-p*p+d*(d+2*l)+u;return r&&r.copy(this.origin).addScaledVector(this.direction,p),n&&n.copy(u2).addScaledVector(e1,d),m}intersectSphere(e,t){ts.subVectors(e.center,this.origin);let r=ts.dot(this.direction),n=ts.dot(ts)-r*r,a=e.radius*e.radius;if(n>a)return null;let o=Math.sqrt(a-n),s=r-o,l=r+o;return l<0?null:s<0?this.at(l,t):this.at(s,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){let t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;let r=-(this.origin.dot(e.normal)+e.constant)/t;return r>=0?r:null}intersectPlane(e,t){let r=this.distanceToPlane(e);return r===null?null:this.at(r,t)}intersectsPlane(e){let t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let r,n,a,o,s,l,u=1/this.direction.x,c=1/this.direction.y,p=1/this.direction.z,d=this.origin;return u>=0?(r=(e.min.x-d.x)*u,n=(e.max.x-d.x)*u):(r=(e.max.x-d.x)*u,n=(e.min.x-d.x)*u),c>=0?(a=(e.min.y-d.y)*c,o=(e.max.y-d.y)*c):(a=(e.max.y-d.y)*c,o=(e.min.y-d.y)*c),r>o||a>n||((a>r||isNaN(r))&&(r=a),(o<n||isNaN(n))&&(n=o),p>=0?(s=(e.min.z-d.z)*p,l=(e.max.z-d.z)*p):(s=(e.max.z-d.z)*p,l=(e.min.z-d.z)*p),r>l||s>n)||((s>r||r!==r)&&(r=s),(l<n||n!==n)&&(n=l),n<0)?null:this.at(r>=0?r:n,t)}intersectsBox(e){return this.intersectBox(e,ts)!==null}intersectTriangle(e,t,r,n,a){h2.subVectors(t,e),t1.subVectors(r,e),c2.crossVectors(h2,t1);let o=this.direction.dot(c2),s;if(o>0){if(n)return null;s=1}else if(o<0)s=-1,o=-o;else return null;Hs.subVectors(this.origin,e);let l=s*this.direction.dot(t1.crossVectors(Hs,t1));if(l<0)return null;let u=s*this.direction.dot(h2.cross(Hs));if(u<0||l+u>o)return null;let c=-s*Hs.dot(c2);return c<0?null:this.at(c/o,a)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}};h(yG,"Ray");var tg=yG,vG=class x3{constructor(e,t,r,n,a,o,s,l,u,c,p,d,m,g,b,x){x3.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,t,r,n,a,o,s,l,u,c,p,d,m,g,b,x)}set(e,t,r,n,a,o,s,l,u,c,p,d,m,g,b,x){let v=this.elements;return v[0]=e,v[4]=t,v[8]=r,v[12]=n,v[1]=a,v[5]=o,v[9]=s,v[13]=l,v[2]=u,v[6]=c,v[10]=p,v[14]=d,v[3]=m,v[7]=g,v[11]=b,v[15]=x,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new x3().fromArray(this.elements)}copy(e){let t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],this}copyPosition(e){let t=this.elements,r=e.elements;return t[12]=r[12],t[13]=r[13],t[14]=r[14],this}setFromMatrix3(e){let t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,r){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this}makeBasis(e,t,r){return this.set(e.x,t.x,r.x,0,e.y,t.y,r.y,0,e.z,t.z,r.z,0,0,0,0,1),this}extractRotation(e){let t=this.elements,r=e.elements,n=1/Ah.setFromMatrixColumn(e,0).length(),a=1/Ah.setFromMatrixColumn(e,1).length(),o=1/Ah.setFromMatrixColumn(e,2).length();return t[0]=r[0]*n,t[1]=r[1]*n,t[2]=r[2]*n,t[3]=0,t[4]=r[4]*a,t[5]=r[5]*a,t[6]=r[6]*a,t[7]=0,t[8]=r[8]*o,t[9]=r[9]*o,t[10]=r[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){let t=this.elements,r=e.x,n=e.y,a=e.z,o=Math.cos(r),s=Math.sin(r),l=Math.cos(n),u=Math.sin(n),c=Math.cos(a),p=Math.sin(a);if(e.order==="XYZ"){let d=o*c,m=o*p,g=s*c,b=s*p;t[0]=l*c,t[4]=-l*p,t[8]=u,t[1]=m+g*u,t[5]=d-b*u,t[9]=-s*l,t[2]=b-d*u,t[6]=g+m*u,t[10]=o*l}else if(e.order==="YXZ"){let d=l*c,m=l*p,g=u*c,b=u*p;t[0]=d+b*s,t[4]=g*s-m,t[8]=o*u,t[1]=o*p,t[5]=o*c,t[9]=-s,t[2]=m*s-g,t[6]=b+d*s,t[10]=o*l}else if(e.order==="ZXY"){let d=l*c,m=l*p,g=u*c,b=u*p;t[0]=d-b*s,t[4]=-o*p,t[8]=g+m*s,t[1]=m+g*s,t[5]=o*c,t[9]=b-d*s,t[2]=-o*u,t[6]=s,t[10]=o*l}else if(e.order==="ZYX"){let d=o*c,m=o*p,g=s*c,b=s*p;t[0]=l*c,t[4]=g*u-m,t[8]=d*u+b,t[1]=l*p,t[5]=b*u+d,t[9]=m*u-g,t[2]=-u,t[6]=s*l,t[10]=o*l}else if(e.order==="YZX"){let d=o*l,m=o*u,g=s*l,b=s*u;t[0]=l*c,t[4]=b-d*p,t[8]=g*p+m,t[1]=p,t[5]=o*c,t[9]=-s*c,t[2]=-u*c,t[6]=m*p+g,t[10]=d-b*p}else if(e.order==="XZY"){let d=o*l,m=o*u,g=s*l,b=s*u;t[0]=l*c,t[4]=-p,t[8]=u*c,t[1]=d*p+b,t[5]=o*c,t[9]=m*p-g,t[2]=g*p-m,t[6]=s*c,t[10]=b*p+d}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(Zfe,e,Yfe)}lookAt(e,t,r){let n=this.elements;return Kn.subVectors(e,t),Kn.lengthSq()===0&&(Kn.z=1),Kn.normalize(),Gs.crossVectors(r,Kn),Gs.lengthSq()===0&&(Math.abs(r.z)===1?Kn.x+=1e-4:Kn.z+=1e-4,Kn.normalize(),Gs.crossVectors(r,Kn)),Gs.normalize(),i1.crossVectors(Kn,Gs),n[0]=Gs.x,n[4]=i1.x,n[8]=Kn.x,n[1]=Gs.y,n[5]=i1.y,n[9]=Kn.y,n[2]=Gs.z,n[6]=i1.z,n[10]=Kn.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){let r=e.elements,n=t.elements,a=this.elements,o=r[0],s=r[4],l=r[8],u=r[12],c=r[1],p=r[5],d=r[9],m=r[13],g=r[2],b=r[6],x=r[10],v=r[14],w=r[3],_=r[7],C=r[11],E=r[15],T=n[0],L=n[4],D=n[8],B=n[12],A=n[1],k=n[5],$=n[9],O=n[13],P=n[2],U=n[6],G=n[10],K=n[14],z=n[3],V=n[7],j=n[11],q=n[15];return a[0]=o*T+s*A+l*P+u*z,a[4]=o*L+s*k+l*U+u*V,a[8]=o*D+s*$+l*G+u*j,a[12]=o*B+s*O+l*K+u*q,a[1]=c*T+p*A+d*P+m*z,a[5]=c*L+p*k+d*U+m*V,a[9]=c*D+p*$+d*G+m*j,a[13]=c*B+p*O+d*K+m*q,a[2]=g*T+b*A+x*P+v*z,a[6]=g*L+b*k+x*U+v*V,a[10]=g*D+b*$+x*G+v*j,a[14]=g*B+b*O+x*K+v*q,a[3]=w*T+_*A+C*P+E*z,a[7]=w*L+_*k+C*U+E*V,a[11]=w*D+_*$+C*G+E*j,a[15]=w*B+_*O+C*K+E*q,this}multiplyScalar(e){let t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){let e=this.elements,t=e[0],r=e[4],n=e[8],a=e[12],o=e[1],s=e[5],l=e[9],u=e[13],c=e[2],p=e[6],d=e[10],m=e[14],g=e[3],b=e[7],x=e[11],v=e[15];return g*(+a*l*p-n*u*p-a*s*d+r*u*d+n*s*m-r*l*m)+b*(+t*l*m-t*u*d+a*o*d-n*o*m+n*u*c-a*l*c)+x*(+t*u*p-t*s*m-a*o*p+r*o*m+a*s*c-r*u*c)+v*(-n*s*c-t*l*p+t*s*d+n*o*p-r*o*d+r*l*c)}transpose(){let e=this.elements,t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,r){let n=this.elements;return e.isVector3?(n[12]=e.x,n[13]=e.y,n[14]=e.z):(n[12]=e,n[13]=t,n[14]=r),this}invert(){let e=this.elements,t=e[0],r=e[1],n=e[2],a=e[3],o=e[4],s=e[5],l=e[6],u=e[7],c=e[8],p=e[9],d=e[10],m=e[11],g=e[12],b=e[13],x=e[14],v=e[15],w=p*x*u-b*d*u+b*l*m-s*x*m-p*l*v+s*d*v,_=g*d*u-c*x*u-g*l*m+o*x*m+c*l*v-o*d*v,C=c*b*u-g*p*u+g*s*m-o*b*m-c*s*v+o*p*v,E=g*p*l-c*b*l-g*s*d+o*b*d+c*s*x-o*p*x,T=t*w+r*_+n*C+a*E;if(T===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);let L=1/T;return e[0]=w*L,e[1]=(b*d*a-p*x*a-b*n*m+r*x*m+p*n*v-r*d*v)*L,e[2]=(s*x*a-b*l*a+b*n*u-r*x*u-s*n*v+r*l*v)*L,e[3]=(p*l*a-s*d*a-p*n*u+r*d*u+s*n*m-r*l*m)*L,e[4]=_*L,e[5]=(c*x*a-g*d*a+g*n*m-t*x*m-c*n*v+t*d*v)*L,e[6]=(g*l*a-o*x*a-g*n*u+t*x*u+o*n*v-t*l*v)*L,e[7]=(o*d*a-c*l*a+c*n*u-t*d*u-o*n*m+t*l*m)*L,e[8]=C*L,e[9]=(g*p*a-c*b*a-g*r*m+t*b*m+c*r*v-t*p*v)*L,e[10]=(o*b*a-g*s*a+g*r*u-t*b*u-o*r*v+t*s*v)*L,e[11]=(c*s*a-o*p*a-c*r*u+t*p*u+o*r*m-t*s*m)*L,e[12]=E*L,e[13]=(c*b*n-g*p*n+g*r*d-t*b*d-c*r*x+t*p*x)*L,e[14]=(g*s*n-o*b*n-g*r*l+t*b*l+o*r*x-t*s*x)*L,e[15]=(o*p*n-c*s*n+c*r*l-t*p*l-o*r*d+t*s*d)*L,this}scale(e){let t=this.elements,r=e.x,n=e.y,a=e.z;return t[0]*=r,t[4]*=n,t[8]*=a,t[1]*=r,t[5]*=n,t[9]*=a,t[2]*=r,t[6]*=n,t[10]*=a,t[3]*=r,t[7]*=n,t[11]*=a,this}getMaxScaleOnAxis(){let e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],r=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],n=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,r,n))}makeTranslation(e,t,r){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,r,0,0,0,1),this}makeRotationX(e){let t=Math.cos(e),r=Math.sin(e);return this.set(1,0,0,0,0,t,-r,0,0,r,t,0,0,0,0,1),this}makeRotationY(e){let t=Math.cos(e),r=Math.sin(e);return this.set(t,0,r,0,0,1,0,0,-r,0,t,0,0,0,0,1),this}makeRotationZ(e){let t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,0,r,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){let r=Math.cos(t),n=Math.sin(t),a=1-r,o=e.x,s=e.y,l=e.z,u=a*o,c=a*s;return this.set(u*o+r,u*s-n*l,u*l+n*s,0,u*s+n*l,c*s+r,c*l-n*o,0,u*l-n*s,c*l+n*o,a*l*l+r,0,0,0,0,1),this}makeScale(e,t,r){return this.set(e,0,0,0,0,t,0,0,0,0,r,0,0,0,0,1),this}makeShear(e,t,r,n,a,o){return this.set(1,r,a,0,e,1,o,0,t,n,1,0,0,0,0,1),this}compose(e,t,r){let n=this.elements,a=t._x,o=t._y,s=t._z,l=t._w,u=a+a,c=o+o,p=s+s,d=a*u,m=a*c,g=a*p,b=o*c,x=o*p,v=s*p,w=l*u,_=l*c,C=l*p,E=r.x,T=r.y,L=r.z;return n[0]=(1-(b+v))*E,n[1]=(m+C)*E,n[2]=(g-_)*E,n[3]=0,n[4]=(m-C)*T,n[5]=(1-(d+v))*T,n[6]=(x+w)*T,n[7]=0,n[8]=(g+_)*L,n[9]=(x-w)*L,n[10]=(1-(d+b))*L,n[11]=0,n[12]=e.x,n[13]=e.y,n[14]=e.z,n[15]=1,this}decompose(e,t,r){let n=this.elements,a=Ah.set(n[0],n[1],n[2]).length(),o=Ah.set(n[4],n[5],n[6]).length(),s=Ah.set(n[8],n[9],n[10]).length();this.determinant()<0&&(a=-a),e.x=n[12],e.y=n[13],e.z=n[14],Za.copy(this);let l=1/a,u=1/o,c=1/s;return Za.elements[0]*=l,Za.elements[1]*=l,Za.elements[2]*=l,Za.elements[4]*=u,Za.elements[5]*=u,Za.elements[6]*=u,Za.elements[8]*=c,Za.elements[9]*=c,Za.elements[10]*=c,t.setFromRotationMatrix(Za),r.x=a,r.y=o,r.z=s,this}makePerspective(e,t,r,n,a,o,s=Ms){let l=this.elements,u=2*a/(t-e),c=2*a/(r-n),p=(t+e)/(t-e),d=(r+n)/(r-n),m,g;if(s===Ms)m=-(o+a)/(o-a),g=-2*o*a/(o-a);else if(s===bv)m=-o/(o-a),g=-o*a/(o-a);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+s);return l[0]=u,l[4]=0,l[8]=p,l[12]=0,l[1]=0,l[5]=c,l[9]=d,l[13]=0,l[2]=0,l[6]=0,l[10]=m,l[14]=g,l[3]=0,l[7]=0,l[11]=-1,l[15]=0,this}makeOrthographic(e,t,r,n,a,o,s=Ms){let l=this.elements,u=1/(t-e),c=1/(r-n),p=1/(o-a),d=(t+e)*u,m=(r+n)*c,g,b;if(s===Ms)g=(o+a)*p,b=-2*p;else if(s===bv)g=a*p,b=-1*p;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+s);return l[0]=2*u,l[4]=0,l[8]=0,l[12]=-d,l[1]=0,l[5]=2*c,l[9]=0,l[13]=-m,l[2]=0,l[6]=0,l[10]=b,l[14]=-g,l[3]=0,l[7]=0,l[11]=0,l[15]=1,this}equals(e){let t=this.elements,r=e.elements;for(let n=0;n<16;n++)if(t[n]!==r[n])return!1;return!0}fromArray(e,t=0){for(let r=0;r<16;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){let r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e[t+9]=r[9],e[t+10]=r[10],e[t+11]=r[11],e[t+12]=r[12],e[t+13]=r[13],e[t+14]=r[14],e[t+15]=r[15],e}};h(vG,"Matrix4");var jt=vG,Ah=new le,Za=new jt,Zfe=new le(0,0,0),Yfe=new le(1,1,1),Gs=new le,i1=new le,Kn=new le,r6=new jt,n6=new dh,xG=class _G{constructor(e=0,t=0,r=0,n=_G.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=r,this._order=n}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,r,n=this._order){return this._x=e,this._y=t,this._z=r,this._order=n,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,r=!0){let n=e.elements,a=n[0],o=n[4],s=n[8],l=n[1],u=n[5],c=n[9],p=n[2],d=n[6],m=n[10];switch(t){case"XYZ":this._y=Math.asin(Fr(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(-c,m),this._z=Math.atan2(-o,a)):(this._x=Math.atan2(d,u),this._z=0);break;case"YXZ":this._x=Math.asin(-Fr(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(s,m),this._z=Math.atan2(l,u)):(this._y=Math.atan2(-p,a),this._z=0);break;case"ZXY":this._x=Math.asin(Fr(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(-p,m),this._z=Math.atan2(-o,u)):(this._y=0,this._z=Math.atan2(l,a));break;case"ZYX":this._y=Math.asin(-Fr(p,-1,1)),Math.abs(p)<.9999999?(this._x=Math.atan2(d,m),this._z=Math.atan2(l,a)):(this._x=0,this._z=Math.atan2(-o,u));break;case"YZX":this._z=Math.asin(Fr(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-c,u),this._y=Math.atan2(-p,a)):(this._x=0,this._y=Math.atan2(s,m));break;case"XZY":this._z=Math.asin(-Fr(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(d,u),this._y=Math.atan2(s,a)):(this._x=Math.atan2(-c,m),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,r===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,r){return r6.makeRotationFromQuaternion(e),this.setFromRotationMatrix(r6,t,r)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return n6.setFromEuler(this),this.setFromQuaternion(n6,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}};h(xG,"Euler");var $a=xG;$a.DEFAULT_ORDER="XYZ";var bG=class{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}};h(bG,"Layers");var wE=bG,Jfe=0,a6=new le,Ih=new dh,is=new jt,r1=new le,Ad=new le,Kfe=new le,Qfe=new dh,o6=new le(1,0,0),s6=new le(0,1,0),l6=new le(0,0,1),eme={type:"added"},tme={type:"removed"},p2={type:"childadded",child:null},d2={type:"childremoved",child:null},wG=class wy extends id{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:Jfe++}),this.uuid=ha(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=wy.DEFAULT_UP.clone();let e=new le,t=new $a,r=new dh,n=new le(1,1,1);function a(){r.setFromEuler(t,!1)}h(a,"onRotationChange");function o(){t.setFromQuaternion(r,void 0,!1)}h(o,"onQuaternionChange"),t._onChange(a),r._onChange(o),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:n},modelViewMatrix:{value:new jt},normalMatrix:{value:new ei}}),this.matrix=new jt,this.matrixWorld=new jt,this.matrixAutoUpdate=wy.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=wy.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new wE,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return Ih.setFromAxisAngle(e,t),this.quaternion.multiply(Ih),this}rotateOnWorldAxis(e,t){return Ih.setFromAxisAngle(e,t),this.quaternion.premultiply(Ih),this}rotateX(e){return this.rotateOnAxis(o6,e)}rotateY(e){return this.rotateOnAxis(s6,e)}rotateZ(e){return this.rotateOnAxis(l6,e)}translateOnAxis(e,t){return a6.copy(e).applyQuaternion(this.quaternion),this.position.add(a6.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(o6,e)}translateY(e){return this.translateOnAxis(s6,e)}translateZ(e){return this.translateOnAxis(l6,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(is.copy(this.matrixWorld).invert())}lookAt(e,t,r){e.isVector3?r1.copy(e):r1.set(e,t,r);let n=this.parent;this.updateWorldMatrix(!0,!1),Ad.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?is.lookAt(Ad,r1,this.up):is.lookAt(r1,Ad,this.up),this.quaternion.setFromRotationMatrix(is),n&&(is.extractRotation(n.matrixWorld),Ih.setFromRotationMatrix(is),this.quaternion.premultiply(Ih.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(eme),p2.child=e,this.dispatchEvent(p2),p2.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}let t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(tme),d2.child=e,this.dispatchEvent(d2),d2.child=null),this}removeFromParent(){let e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),is.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),is.multiply(e.parent.matrixWorld)),e.applyMatrix4(is),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let r=0,n=this.children.length;r<n;r++){let a=this.children[r].getObjectByProperty(e,t);if(a!==void 0)return a}}getObjectsByProperty(e,t,r=[]){this[e]===t&&r.push(this);let n=this.children;for(let a=0,o=n.length;a<o;a++)n[a].getObjectsByProperty(e,t,r);return r}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Ad,e,Kfe),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Ad,Qfe,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);let t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);let t=this.children;for(let r=0,n=t.length;r<n;r++)t[r].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);let t=this.children;for(let r=0,n=t.length;r<n;r++)t[r].traverseVisible(e)}traverseAncestors(e){let t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);let t=this.children;for(let r=0,n=t.length;r<n;r++){let a=t[r];(a.matrixWorldAutoUpdate===!0||e===!0)&&a.updateMatrixWorld(e)}}updateWorldMatrix(e,t){let r=this.parent;if(e===!0&&r!==null&&r.matrixWorldAutoUpdate===!0&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),t===!0){let n=this.children;for(let a=0,o=n.length;a<o;a++){let s=n[a];s.matrixWorldAutoUpdate===!0&&s.updateWorldMatrix(!1,!0)}}}toJSON(e){let t=e===void 0||typeof e=="string",r={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});let n={};n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.castShadow===!0&&(n.castShadow=!0),this.receiveShadow===!0&&(n.receiveShadow=!0),this.visible===!1&&(n.visible=!1),this.frustumCulled===!1&&(n.frustumCulled=!1),this.renderOrder!==0&&(n.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(n.userData=this.userData),n.layers=this.layers.mask,n.matrix=this.matrix.toArray(),n.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(n.matrixAutoUpdate=!1),this.isInstancedMesh&&(n.type="InstancedMesh",n.count=this.count,n.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(n.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(n.type="BatchedMesh",n.perObjectFrustumCulled=this.perObjectFrustumCulled,n.sortObjects=this.sortObjects,n.drawRanges=this._drawRanges,n.reservedRanges=this._reservedRanges,n.visibility=this._visibility,n.active=this._active,n.bounds=this._bounds.map(s=>({boxInitialized:s.boxInitialized,boxMin:s.box.min.toArray(),boxMax:s.box.max.toArray(),sphereInitialized:s.sphereInitialized,sphereRadius:s.sphere.radius,sphereCenter:s.sphere.center.toArray()})),n.maxGeometryCount=this._maxGeometryCount,n.maxVertexCount=this._maxVertexCount,n.maxIndexCount=this._maxIndexCount,n.geometryInitialized=this._geometryInitialized,n.geometryCount=this._geometryCount,n.matricesTexture=this._matricesTexture.toJSON(e),this.boundingSphere!==null&&(n.boundingSphere={center:n.boundingSphere.center.toArray(),radius:n.boundingSphere.radius}),this.boundingBox!==null&&(n.boundingBox={min:n.boundingBox.min.toArray(),max:n.boundingBox.max.toArray()}));function a(s,l){return s[l.uuid]===void 0&&(s[l.uuid]=l.toJSON(e)),l.uuid}if(h(a,"serialize"),this.isScene)this.background&&(this.background.isColor?n.background=this.background.toJSON():this.background.isTexture&&(n.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(n.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){n.geometry=a(e.geometries,this.geometry);let s=this.geometry.parameters;if(s!==void 0&&s.shapes!==void 0){let l=s.shapes;if(Array.isArray(l))for(let u=0,c=l.length;u<c;u++){let p=l[u];a(e.shapes,p)}else a(e.shapes,l)}}if(this.isSkinnedMesh&&(n.bindMode=this.bindMode,n.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(a(e.skeletons,this.skeleton),n.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){let s=[];for(let l=0,u=this.material.length;l<u;l++)s.push(a(e.materials,this.material[l]));n.material=s}else n.material=a(e.materials,this.material);if(this.children.length>0){n.children=[];for(let s=0;s<this.children.length;s++)n.children.push(this.children[s].toJSON(e).object)}if(this.animations.length>0){n.animations=[];for(let s=0;s<this.animations.length;s++){let l=this.animations[s];n.animations.push(a(e.animations,l))}}if(t){let s=o(e.geometries),l=o(e.materials),u=o(e.textures),c=o(e.images),p=o(e.shapes),d=o(e.skeletons),m=o(e.animations),g=o(e.nodes);s.length>0&&(r.geometries=s),l.length>0&&(r.materials=l),u.length>0&&(r.textures=u),c.length>0&&(r.images=c),p.length>0&&(r.shapes=p),d.length>0&&(r.skeletons=d),m.length>0&&(r.animations=m),g.length>0&&(r.nodes=g)}return r.object=n,r;function o(s){let l=[];for(let u in s){let c=s[u];delete c.metadata,l.push(c)}return l}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let r=0;r<e.children.length;r++){let n=e.children[r];this.add(n.clone())}return this}};h(wG,"Object3D");var rr=wG;rr.DEFAULT_UP=new le(0,1,0);rr.DEFAULT_MATRIX_AUTO_UPDATE=!0;rr.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;var Ya=new le,rs=new le,f2=new le,ns=new le,Lh=new le,Dh=new le,u6=new le,m2=new le,g2=new le,y2=new le,SG=class Qh{constructor(e=new le,t=new le,r=new le){this.a=e,this.b=t,this.c=r}static getNormal(e,t,r,n){n.subVectors(r,t),Ya.subVectors(e,t),n.cross(Ya);let a=n.lengthSq();return a>0?n.multiplyScalar(1/Math.sqrt(a)):n.set(0,0,0)}static getBarycoord(e,t,r,n,a){Ya.subVectors(n,t),rs.subVectors(r,t),f2.subVectors(e,t);let o=Ya.dot(Ya),s=Ya.dot(rs),l=Ya.dot(f2),u=rs.dot(rs),c=rs.dot(f2),p=o*u-s*s;if(p===0)return a.set(0,0,0),null;let d=1/p,m=(u*l-s*c)*d,g=(o*c-s*l)*d;return a.set(1-m-g,g,m)}static containsPoint(e,t,r,n){return this.getBarycoord(e,t,r,n,ns)===null?!1:ns.x>=0&&ns.y>=0&&ns.x+ns.y<=1}static getInterpolation(e,t,r,n,a,o,s,l){return this.getBarycoord(e,t,r,n,ns)===null?(l.x=0,l.y=0,"z"in l&&(l.z=0),"w"in l&&(l.w=0),null):(l.setScalar(0),l.addScaledVector(a,ns.x),l.addScaledVector(o,ns.y),l.addScaledVector(s,ns.z),l)}static isFrontFacing(e,t,r,n){return Ya.subVectors(r,t),rs.subVectors(e,t),Ya.cross(rs).dot(n)<0}set(e,t,r){return this.a.copy(e),this.b.copy(t),this.c.copy(r),this}setFromPointsAndIndices(e,t,r,n){return this.a.copy(e[t]),this.b.copy(e[r]),this.c.copy(e[n]),this}setFromAttributeAndIndices(e,t,r,n){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,r),this.c.fromBufferAttribute(e,n),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Ya.subVectors(this.c,this.b),rs.subVectors(this.a,this.b),Ya.cross(rs).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Qh.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return Qh.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,r,n,a){return Qh.getInterpolation(e,this.a,this.b,this.c,t,r,n,a)}containsPoint(e){return Qh.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Qh.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){let r=this.a,n=this.b,a=this.c,o,s;Lh.subVectors(n,r),Dh.subVectors(a,r),m2.subVectors(e,r);let l=Lh.dot(m2),u=Dh.dot(m2);if(l<=0&&u<=0)return t.copy(r);g2.subVectors(e,n);let c=Lh.dot(g2),p=Dh.dot(g2);if(c>=0&&p<=c)return t.copy(n);let d=l*p-c*u;if(d<=0&&l>=0&&c<=0)return o=l/(l-c),t.copy(r).addScaledVector(Lh,o);y2.subVectors(e,a);let m=Lh.dot(y2),g=Dh.dot(y2);if(g>=0&&m<=g)return t.copy(a);let b=m*u-l*g;if(b<=0&&u>=0&&g<=0)return s=u/(u-g),t.copy(r).addScaledVector(Dh,s);let x=c*g-m*p;if(x<=0&&p-c>=0&&m-g>=0)return u6.subVectors(a,n),s=(p-c)/(p-c+(m-g)),t.copy(n).addScaledVector(u6,s);let v=1/(x+b+d);return o=b*v,s=d*v,t.copy(r).addScaledVector(Lh,o).addScaledVector(Dh,s)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}};h(SG,"Triangle");var of=SG,MG={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Ws={h:0,s:0,l:0},n1={h:0,s:0,l:0};function Sy(i,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?i+(e-i)*6*t:t<1/2?e:t<2/3?i+(e-i)*6*(2/3-t):i}h(Sy,"hue2rgb");var CG=class{constructor(e,t,r){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,r)}set(e,t,r){if(t===void 0&&r===void 0){let n=e;n&&n.isColor?this.copy(n):typeof n=="number"?this.setHex(n):typeof n=="string"&&this.setStyle(n)}else this.setRGB(e,t,r);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=zn){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,Si.toWorkingColorSpace(this,t),this}setRGB(e,t,r,n=Si.workingColorSpace){return this.r=e,this.g=t,this.b=r,Si.toWorkingColorSpace(this,n),this}setHSL(e,t,r,n=Si.workingColorSpace){if(e=$x(e,1),t=Fr(t,0,1),r=Fr(r,0,1),t===0)this.r=this.g=this.b=r;else{let a=r<=.5?r*(1+t):r+t-r*t,o=2*r-a;this.r=Sy(o,a,e+1/3),this.g=Sy(o,a,e),this.b=Sy(o,a,e-1/3)}return Si.toWorkingColorSpace(this,n),this}setStyle(e,t=zn){function r(a){a!==void 0&&parseFloat(a)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}h(r,"handleAlpha");let n;if(n=/^(\w+)\(([^\)]*)\)/.exec(e)){let a,o=n[1],s=n[2];switch(o){case"rgb":case"rgba":if(a=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return r(a[4]),this.setRGB(Math.min(255,parseInt(a[1],10))/255,Math.min(255,parseInt(a[2],10))/255,Math.min(255,parseInt(a[3],10))/255,t);if(a=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return r(a[4]),this.setRGB(Math.min(100,parseInt(a[1],10))/100,Math.min(100,parseInt(a[2],10))/100,Math.min(100,parseInt(a[3],10))/100,t);break;case"hsl":case"hsla":if(a=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return r(a[4]),this.setHSL(parseFloat(a[1])/360,parseFloat(a[2])/100,parseFloat(a[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(n=/^\#([A-Fa-f\d]+)$/.exec(e)){let a=n[1],o=a.length;if(o===3)return this.setRGB(parseInt(a.charAt(0),16)/15,parseInt(a.charAt(1),16)/15,parseInt(a.charAt(2),16)/15,t);if(o===6)return this.setHex(parseInt(a,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=zn){let r=MG[e.toLowerCase()];return r!==void 0?this.setHex(r,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Ou(e.r),this.g=Ou(e.g),this.b=Ou(e.b),this}copyLinearToSRGB(e){return this.r=vy(e.r),this.g=vy(e.g),this.b=vy(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=zn){return Si.fromWorkingColorSpace(tn.copy(this),e),Math.round(Fr(tn.r*255,0,255))*65536+Math.round(Fr(tn.g*255,0,255))*256+Math.round(Fr(tn.b*255,0,255))}getHexString(e=zn){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=Si.workingColorSpace){Si.fromWorkingColorSpace(tn.copy(this),t);let r=tn.r,n=tn.g,a=tn.b,o=Math.max(r,n,a),s=Math.min(r,n,a),l,u,c=(s+o)/2;if(s===o)l=0,u=0;else{let p=o-s;switch(u=c<=.5?p/(o+s):p/(2-o-s),o){case r:l=(n-a)/p+(n<a?6:0);break;case n:l=(a-r)/p+2;break;case a:l=(r-n)/p+4;break}l/=6}return e.h=l,e.s=u,e.l=c,e}getRGB(e,t=Si.workingColorSpace){return Si.fromWorkingColorSpace(tn.copy(this),t),e.r=tn.r,e.g=tn.g,e.b=tn.b,e}getStyle(e=zn){Si.fromWorkingColorSpace(tn.copy(this),e);let t=tn.r,r=tn.g,n=tn.b;return e!==zn?`color(${e} ${t.toFixed(3)} ${r.toFixed(3)} ${n.toFixed(3)})`:`rgb(${Math.round(t*255)},${Math.round(r*255)},${Math.round(n*255)})`}offsetHSL(e,t,r){return this.getHSL(Ws),this.setHSL(Ws.h+e,Ws.s+t,Ws.l+r)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,r){return this.r=e.r+(t.r-e.r)*r,this.g=e.g+(t.g-e.g)*r,this.b=e.b+(t.b-e.b)*r,this}lerpHSL(e,t){this.getHSL(Ws),e.getHSL(n1);let r=fp(Ws.h,n1.h,t),n=fp(Ws.s,n1.s,t),a=fp(Ws.l,n1.l,t);return this.setHSL(r,n,a),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){let t=this.r,r=this.g,n=this.b,a=e.elements;return this.r=a[0]*t+a[3]*r+a[6]*n,this.g=a[1]*t+a[4]*r+a[7]*n,this.b=a[2]*t+a[5]*r+a[8]*n,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}};h(CG,"Color");var Lt=CG,tn=new Lt;Lt.NAMES=MG;var ime=0,EG=class extends id{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:ime++}),this.uuid=ha(),this.name="",this.type="Material",this.blending=pp,this.side=Bl,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=p3,this.blendDst=d3,this.blendEquation=bu,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new Lt(0,0,0),this.blendAlpha=0,this.depthFunc=mv,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=YA,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Mh,this.stencilZFail=Mh,this.stencilZPass=Mh,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(let t in e){let r=e[t];if(r===void 0){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}let n=this[t];if(n===void 0){console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`);continue}n&&n.isColor?n.set(r):n&&n.isVector3&&r&&r.isVector3?n.copy(r):this[t]=r}}toJSON(e){let t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});let r={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.color&&this.color.isColor&&(r.color=this.color.getHex()),this.roughness!==void 0&&(r.roughness=this.roughness),this.metalness!==void 0&&(r.metalness=this.metalness),this.sheen!==void 0&&(r.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(r.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(r.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(r.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(r.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(r.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(r.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(r.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(r.shininess=this.shininess),this.clearcoat!==void 0&&(r.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(r.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(r.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(r.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(r.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,r.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(r.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(r.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(r.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(r.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(r.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(r.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(r.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(r.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(r.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(r.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(r.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(r.lightMap=this.lightMap.toJSON(e).uuid,r.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(r.aoMap=this.aoMap.toJSON(e).uuid,r.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(r.bumpMap=this.bumpMap.toJSON(e).uuid,r.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(r.normalMap=this.normalMap.toJSON(e).uuid,r.normalMapType=this.normalMapType,r.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(r.displacementMap=this.displacementMap.toJSON(e).uuid,r.displacementScale=this.displacementScale,r.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(r.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(r.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(r.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(r.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(r.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(r.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(r.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(r.combine=this.combine)),this.envMapRotation!==void 0&&(r.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(r.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(r.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(r.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(r.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(r.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(r.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(r.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(r.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(r.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(r.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(r.size=this.size),this.shadowSide!==null&&(r.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(r.sizeAttenuation=this.sizeAttenuation),this.blending!==pp&&(r.blending=this.blending),this.side!==Bl&&(r.side=this.side),this.vertexColors===!0&&(r.vertexColors=!0),this.opacity<1&&(r.opacity=this.opacity),this.transparent===!0&&(r.transparent=!0),this.blendSrc!==p3&&(r.blendSrc=this.blendSrc),this.blendDst!==d3&&(r.blendDst=this.blendDst),this.blendEquation!==bu&&(r.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(r.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(r.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(r.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(r.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(r.blendAlpha=this.blendAlpha),this.depthFunc!==mv&&(r.depthFunc=this.depthFunc),this.depthTest===!1&&(r.depthTest=this.depthTest),this.depthWrite===!1&&(r.depthWrite=this.depthWrite),this.colorWrite===!1&&(r.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(r.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==YA&&(r.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(r.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(r.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==Mh&&(r.stencilFail=this.stencilFail),this.stencilZFail!==Mh&&(r.stencilZFail=this.stencilZFail),this.stencilZPass!==Mh&&(r.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(r.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(r.rotation=this.rotation),this.polygonOffset===!0&&(r.polygonOffset=!0),this.polygonOffsetFactor!==0&&(r.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(r.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(r.linewidth=this.linewidth),this.dashSize!==void 0&&(r.dashSize=this.dashSize),this.gapSize!==void 0&&(r.gapSize=this.gapSize),this.scale!==void 0&&(r.scale=this.scale),this.dithering===!0&&(r.dithering=!0),this.alphaTest>0&&(r.alphaTest=this.alphaTest),this.alphaHash===!0&&(r.alphaHash=!0),this.alphaToCoverage===!0&&(r.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(r.premultipliedAlpha=!0),this.forceSinglePass===!0&&(r.forceSinglePass=!0),this.wireframe===!0&&(r.wireframe=!0),this.wireframeLinewidth>1&&(r.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(r.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(r.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(r.flatShading=!0),this.visible===!1&&(r.visible=!1),this.toneMapped===!1&&(r.toneMapped=!1),this.fog===!1&&(r.fog=!1),Object.keys(this.userData).length>0&&(r.userData=this.userData);function n(a){let o=[];for(let s in a){let l=a[s];delete l.metadata,o.push(l)}return o}if(h(n,"extractFromCache"),t){let a=n(e.textures),o=n(e.images);a.length>0&&(r.textures=a),o.length>0&&(r.images=o)}return r}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;let t=e.clippingPlanes,r=null;if(t!==null){let n=t.length;r=new Array(n);for(let a=0;a!==n;++a)r[a]=t[a].clone()}return this.clippingPlanes=r,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}};h(EG,"Material");var Wl=EG,TG=class extends Wl{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Lt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new $a,this.combine=gE,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}};h(TG,"MeshBasicMaterial");var rd=TG,Sr=new le,a1=new Oe,PG=class{constructor(e,t,r=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=r,this.usage=y3,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.gpuType=na,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}get updateRange(){return bE("THREE.BufferAttribute: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,r){e*=this.itemSize,r*=t.itemSize;for(let n=0,a=this.itemSize;n<a;n++)this.array[e+n]=t.array[r+n];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,r=this.count;t<r;t++)a1.fromBufferAttribute(this,t),a1.applyMatrix3(e),this.setXY(t,a1.x,a1.y);else if(this.itemSize===3)for(let t=0,r=this.count;t<r;t++)Sr.fromBufferAttribute(this,t),Sr.applyMatrix3(e),this.setXYZ(t,Sr.x,Sr.y,Sr.z);return this}applyMatrix4(e){for(let t=0,r=this.count;t<r;t++)Sr.fromBufferAttribute(this,t),Sr.applyMatrix4(e),this.setXYZ(t,Sr.x,Sr.y,Sr.z);return this}applyNormalMatrix(e){for(let t=0,r=this.count;t<r;t++)Sr.fromBufferAttribute(this,t),Sr.applyNormalMatrix(e),this.setXYZ(t,Sr.x,Sr.y,Sr.z);return this}transformDirection(e){for(let t=0,r=this.count;t<r;t++)Sr.fromBufferAttribute(this,t),Sr.transformDirection(e),this.setXYZ(t,Sr.x,Sr.y,Sr.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let r=this.array[e*this.itemSize+t];return this.normalized&&(r=ka(r,this.array)),r}setComponent(e,t,r){return this.normalized&&(r=yi(r,this.array)),this.array[e*this.itemSize+t]=r,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=ka(t,this.array)),t}setX(e,t){return this.normalized&&(t=yi(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=ka(t,this.array)),t}setY(e,t){return this.normalized&&(t=yi(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=ka(t,this.array)),t}setZ(e,t){return this.normalized&&(t=yi(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=ka(t,this.array)),t}setW(e,t){return this.normalized&&(t=yi(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,r){return e*=this.itemSize,this.normalized&&(t=yi(t,this.array),r=yi(r,this.array)),this.array[e+0]=t,this.array[e+1]=r,this}setXYZ(e,t,r,n){return e*=this.itemSize,this.normalized&&(t=yi(t,this.array),r=yi(r,this.array),n=yi(n,this.array)),this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=n,this}setXYZW(e,t,r,n,a){return e*=this.itemSize,this.normalized&&(t=yi(t,this.array),r=yi(r,this.array),n=yi(n,this.array),a=yi(a,this.array)),this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=n,this.array[e+3]=a,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){let e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==y3&&(e.usage=this.usage),e}};h(PG,"BufferAttribute");var Br=PG,AG=class extends Br{constructor(e,t,r){super(new Uint16Array(e),t,r)}};h(AG,"Uint16BufferAttribute");var IG=AG,LG=class extends Br{constructor(e,t,r){super(new Uint32Array(e),t,r)}};h(LG,"Uint32BufferAttribute");var DG=LG,kG=class extends Br{constructor(e,t,r){super(new Float32Array(e),t,r)}};h(kG,"Float32BufferAttribute");var jr=kG,rme=0,wa=new jt,v2=new rr,kh=new le,Qn=new Yr,Id=new Yr,$r=new le,RG=class FG extends id{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:rme++}),this.uuid=ha(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(_E(e)?DG:IG)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,r=0){this.groups.push({start:e,count:t,materialIndex:r})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){let t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);let r=this.attributes.normal;if(r!==void 0){let a=new ei().getNormalMatrix(e);r.applyNormalMatrix(a),r.needsUpdate=!0}let n=this.attributes.tangent;return n!==void 0&&(n.transformDirection(e),n.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return wa.makeRotationFromQuaternion(e),this.applyMatrix4(wa),this}rotateX(e){return wa.makeRotationX(e),this.applyMatrix4(wa),this}rotateY(e){return wa.makeRotationY(e),this.applyMatrix4(wa),this}rotateZ(e){return wa.makeRotationZ(e),this.applyMatrix4(wa),this}translate(e,t,r){return wa.makeTranslation(e,t,r),this.applyMatrix4(wa),this}scale(e,t,r){return wa.makeScale(e,t,r),this.applyMatrix4(wa),this}lookAt(e){return v2.lookAt(e),v2.updateMatrix(),this.applyMatrix4(v2.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(kh).negate(),this.translate(kh.x,kh.y,kh.z),this}setFromPoints(e){let t=[];for(let r=0,n=e.length;r<n;r++){let a=e[r];t.push(a.x,a.y,a.z||0)}return this.setAttribute("position",new jr(t,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Yr);let e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new le(-1/0,-1/0,-1/0),new le(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let r=0,n=t.length;r<n;r++){let a=t[r];Qn.setFromBufferAttribute(a),this.morphTargetsRelative?($r.addVectors(this.boundingBox.min,Qn.min),this.boundingBox.expandByPoint($r),$r.addVectors(this.boundingBox.max,Qn.max),this.boundingBox.expandByPoint($r)):(this.boundingBox.expandByPoint(Qn.min),this.boundingBox.expandByPoint(Qn.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Xn);let e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new le,1/0);return}if(e){let r=this.boundingSphere.center;if(Qn.setFromBufferAttribute(e),t)for(let a=0,o=t.length;a<o;a++){let s=t[a];Id.setFromBufferAttribute(s),this.morphTargetsRelative?($r.addVectors(Qn.min,Id.min),Qn.expandByPoint($r),$r.addVectors(Qn.max,Id.max),Qn.expandByPoint($r)):(Qn.expandByPoint(Id.min),Qn.expandByPoint(Id.max))}Qn.getCenter(r);let n=0;for(let a=0,o=e.count;a<o;a++)$r.fromBufferAttribute(e,a),n=Math.max(n,r.distanceToSquared($r));if(t)for(let a=0,o=t.length;a<o;a++){let s=t[a],l=this.morphTargetsRelative;for(let u=0,c=s.count;u<c;u++)$r.fromBufferAttribute(s,u),l&&(kh.fromBufferAttribute(e,u),$r.add(kh)),n=Math.max(n,r.distanceToSquared($r))}this.boundingSphere.radius=Math.sqrt(n),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){let e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}let r=t.position,n=t.normal,a=t.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Br(new Float32Array(4*r.count),4));let o=this.getAttribute("tangent"),s=[],l=[];for(let D=0;D<r.count;D++)s[D]=new le,l[D]=new le;let u=new le,c=new le,p=new le,d=new Oe,m=new Oe,g=new Oe,b=new le,x=new le;function v(D,B,A){u.fromBufferAttribute(r,D),c.fromBufferAttribute(r,B),p.fromBufferAttribute(r,A),d.fromBufferAttribute(a,D),m.fromBufferAttribute(a,B),g.fromBufferAttribute(a,A),c.sub(u),p.sub(u),m.sub(d),g.sub(d);let k=1/(m.x*g.y-g.x*m.y);isFinite(k)&&(b.copy(c).multiplyScalar(g.y).addScaledVector(p,-m.y).multiplyScalar(k),x.copy(p).multiplyScalar(m.x).addScaledVector(c,-g.x).multiplyScalar(k),s[D].add(b),s[B].add(b),s[A].add(b),l[D].add(x),l[B].add(x),l[A].add(x))}h(v,"handleTriangle");let w=this.groups;w.length===0&&(w=[{start:0,count:e.count}]);for(let D=0,B=w.length;D<B;++D){let A=w[D],k=A.start,$=A.count;for(let O=k,P=k+$;O<P;O+=3)v(e.getX(O+0),e.getX(O+1),e.getX(O+2))}let _=new le,C=new le,E=new le,T=new le;function L(D){E.fromBufferAttribute(n,D),T.copy(E);let B=s[D];_.copy(B),_.sub(E.multiplyScalar(E.dot(B))).normalize(),C.crossVectors(T,B);let A=C.dot(l[D])<0?-1:1;o.setXYZW(D,_.x,_.y,_.z,A)}h(L,"handleVertex");for(let D=0,B=w.length;D<B;++D){let A=w[D],k=A.start,$=A.count;for(let O=k,P=k+$;O<P;O+=3)L(e.getX(O+0)),L(e.getX(O+1)),L(e.getX(O+2))}}computeVertexNormals(){let e=this.index,t=this.getAttribute("position");if(t!==void 0){let r=this.getAttribute("normal");if(r===void 0)r=new Br(new Float32Array(t.count*3),3),this.setAttribute("normal",r);else for(let d=0,m=r.count;d<m;d++)r.setXYZ(d,0,0,0);let n=new le,a=new le,o=new le,s=new le,l=new le,u=new le,c=new le,p=new le;if(e)for(let d=0,m=e.count;d<m;d+=3){let g=e.getX(d+0),b=e.getX(d+1),x=e.getX(d+2);n.fromBufferAttribute(t,g),a.fromBufferAttribute(t,b),o.fromBufferAttribute(t,x),c.subVectors(o,a),p.subVectors(n,a),c.cross(p),s.fromBufferAttribute(r,g),l.fromBufferAttribute(r,b),u.fromBufferAttribute(r,x),s.add(c),l.add(c),u.add(c),r.setXYZ(g,s.x,s.y,s.z),r.setXYZ(b,l.x,l.y,l.z),r.setXYZ(x,u.x,u.y,u.z)}else for(let d=0,m=t.count;d<m;d+=3)n.fromBufferAttribute(t,d+0),a.fromBufferAttribute(t,d+1),o.fromBufferAttribute(t,d+2),c.subVectors(o,a),p.subVectors(n,a),c.cross(p),r.setXYZ(d+0,c.x,c.y,c.z),r.setXYZ(d+1,c.x,c.y,c.z),r.setXYZ(d+2,c.x,c.y,c.z);this.normalizeNormals(),r.needsUpdate=!0}}normalizeNormals(){let e=this.attributes.normal;for(let t=0,r=e.count;t<r;t++)$r.fromBufferAttribute(e,t),$r.normalize(),e.setXYZ(t,$r.x,$r.y,$r.z)}toNonIndexed(){function e(s,l){let u=s.array,c=s.itemSize,p=s.normalized,d=new u.constructor(l.length*c),m=0,g=0;for(let b=0,x=l.length;b<x;b++){s.isInterleavedBufferAttribute?m=l[b]*s.data.stride+s.offset:m=l[b]*c;for(let v=0;v<c;v++)d[g++]=u[m++]}return new Br(d,c,p)}if(h(e,"convertBufferAttribute"),this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;let t=new FG,r=this.index.array,n=this.attributes;for(let s in n){let l=n[s],u=e(l,r);t.setAttribute(s,u)}let a=this.morphAttributes;for(let s in a){let l=[],u=a[s];for(let c=0,p=u.length;c<p;c++){let d=u[c],m=e(d,r);l.push(m)}t.morphAttributes[s]=l}t.morphTargetsRelative=this.morphTargetsRelative;let o=this.groups;for(let s=0,l=o.length;s<l;s++){let u=o[s];t.addGroup(u.start,u.count,u.materialIndex)}return t}toJSON(){let e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){let l=this.parameters;for(let u in l)l[u]!==void 0&&(e[u]=l[u]);return e}e.data={attributes:{}};let t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});let r=this.attributes;for(let l in r){let u=r[l];e.data.attributes[l]=u.toJSON(e.data)}let n={},a=!1;for(let l in this.morphAttributes){let u=this.morphAttributes[l],c=[];for(let p=0,d=u.length;p<d;p++){let m=u[p];c.push(m.toJSON(e.data))}c.length>0&&(n[l]=c,a=!0)}a&&(e.data.morphAttributes=n,e.data.morphTargetsRelative=this.morphTargetsRelative);let o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));let s=this.boundingSphere;return s!==null&&(e.data.boundingSphere={center:s.center.toArray(),radius:s.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;let t={};this.name=e.name;let r=e.index;r!==null&&this.setIndex(r.clone(t));let n=e.attributes;for(let u in n){let c=n[u];this.setAttribute(u,c.clone(t))}let a=e.morphAttributes;for(let u in a){let c=[],p=a[u];for(let d=0,m=p.length;d<m;d++)c.push(p[d].clone(t));this.morphAttributes[u]=c}this.morphTargetsRelative=e.morphTargetsRelative;let o=e.groups;for(let u=0,c=o.length;u<c;u++){let p=o[u];this.addGroup(p.start,p.count,p.materialIndex)}let s=e.boundingBox;s!==null&&(this.boundingBox=s.clone());let l=e.boundingSphere;return l!==null&&(this.boundingSphere=l.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}};h(RG,"BufferGeometry");var ma=RG,h6=new jt,Kl=new tg,o1=new Xn,c6=new le,Rh=new le,Fh=new le,zh=new le,x2=new le,s1=new le,l1=new Oe,u1=new Oe,h1=new Oe,p6=new le,d6=new le,f6=new le,c1=new le,p1=new le,zG=class extends rr{constructor(e=new ma,t=new rd){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){let e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){let r=e[t[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let n=0,a=r.length;n<a;n++){let o=r[n].name||String(n);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=n}}}}getVertexPosition(e,t){let r=this.geometry,n=r.attributes.position,a=r.morphAttributes.position,o=r.morphTargetsRelative;t.fromBufferAttribute(n,e);let s=this.morphTargetInfluences;if(a&&s){s1.set(0,0,0);for(let l=0,u=a.length;l<u;l++){let c=s[l],p=a[l];c!==0&&(x2.fromBufferAttribute(p,e),o?s1.addScaledVector(x2,c):s1.addScaledVector(x2.sub(t),c))}t.add(s1)}return t}raycast(e,t){let r=this.geometry,n=this.material,a=this.matrixWorld;n!==void 0&&(r.boundingSphere===null&&r.computeBoundingSphere(),o1.copy(r.boundingSphere),o1.applyMatrix4(a),Kl.copy(e.ray).recast(e.near),!(o1.containsPoint(Kl.origin)===!1&&(Kl.intersectSphere(o1,c6)===null||Kl.origin.distanceToSquared(c6)>(e.far-e.near)**2))&&(h6.copy(a).invert(),Kl.copy(e.ray).applyMatrix4(h6),!(r.boundingBox!==null&&Kl.intersectsBox(r.boundingBox)===!1)&&this._computeIntersections(e,t,Kl)))}_computeIntersections(e,t,r){let n,a=this.geometry,o=this.material,s=a.index,l=a.attributes.position,u=a.attributes.uv,c=a.attributes.uv1,p=a.attributes.normal,d=a.groups,m=a.drawRange;if(s!==null)if(Array.isArray(o))for(let g=0,b=d.length;g<b;g++){let x=d[g],v=o[x.materialIndex],w=Math.max(x.start,m.start),_=Math.min(s.count,Math.min(x.start+x.count,m.start+m.count));for(let C=w,E=_;C<E;C+=3){let T=s.getX(C),L=s.getX(C+1),D=s.getX(C+2);n=sf(this,v,e,r,u,c,p,T,L,D),n&&(n.faceIndex=Math.floor(C/3),n.face.materialIndex=x.materialIndex,t.push(n))}}else{let g=Math.max(0,m.start),b=Math.min(s.count,m.start+m.count);for(let x=g,v=b;x<v;x+=3){let w=s.getX(x),_=s.getX(x+1),C=s.getX(x+2);n=sf(this,o,e,r,u,c,p,w,_,C),n&&(n.faceIndex=Math.floor(x/3),t.push(n))}}else if(l!==void 0)if(Array.isArray(o))for(let g=0,b=d.length;g<b;g++){let x=d[g],v=o[x.materialIndex],w=Math.max(x.start,m.start),_=Math.min(l.count,Math.min(x.start+x.count,m.start+m.count));for(let C=w,E=_;C<E;C+=3){let T=C,L=C+1,D=C+2;n=sf(this,v,e,r,u,c,p,T,L,D),n&&(n.faceIndex=Math.floor(C/3),n.face.materialIndex=x.materialIndex,t.push(n))}}else{let g=Math.max(0,m.start),b=Math.min(l.count,m.start+m.count);for(let x=g,v=b;x<v;x+=3){let w=x,_=x+1,C=x+2;n=sf(this,o,e,r,u,c,p,w,_,C),n&&(n.faceIndex=Math.floor(x/3),t.push(n))}}}};h(zG,"Mesh");var Wi=zG;function BG(i,e,t,r,n,a,o,s){let l;if(e.side===Wn?l=r.intersectTriangle(o,a,n,!0,s):l=r.intersectTriangle(n,a,o,e.side===Bl,s),l===null)return null;p1.copy(s),p1.applyMatrix4(i.matrixWorld);let u=t.ray.origin.distanceTo(p1);return u<t.near||u>t.far?null:{distance:u,point:p1.clone(),object:i}}h(BG,"checkIntersection");function sf(i,e,t,r,n,a,o,s,l,u){i.getVertexPosition(s,Rh),i.getVertexPosition(l,Fh),i.getVertexPosition(u,zh);let c=BG(i,e,t,r,Rh,Fh,zh,c1);if(c){n&&(l1.fromBufferAttribute(n,s),u1.fromBufferAttribute(n,l),h1.fromBufferAttribute(n,u),c.uv=of.getInterpolation(c1,Rh,Fh,zh,l1,u1,h1,new Oe)),a&&(l1.fromBufferAttribute(a,s),u1.fromBufferAttribute(a,l),h1.fromBufferAttribute(a,u),c.uv1=of.getInterpolation(c1,Rh,Fh,zh,l1,u1,h1,new Oe)),o&&(p6.fromBufferAttribute(o,s),d6.fromBufferAttribute(o,l),f6.fromBufferAttribute(o,u),c.normal=of.getInterpolation(c1,Rh,Fh,zh,p6,d6,f6,new le),c.normal.dot(r.direction)>0&&c.normal.multiplyScalar(-1));let p={a:s,b:l,c:u,normal:new le,materialIndex:0};of.getNormal(Rh,Fh,zh,p.normal),c.face=p}return c}h(sf,"checkGeometryIntersection");var OG=class NG extends ma{constructor(e=1,t=1,r=1,n=1,a=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:r,widthSegments:n,heightSegments:a,depthSegments:o};let s=this;n=Math.floor(n),a=Math.floor(a),o=Math.floor(o);let l=[],u=[],c=[],p=[],d=0,m=0;g("z","y","x",-1,-1,r,t,e,o,a,0),g("z","y","x",1,-1,r,t,-e,o,a,1),g("x","z","y",1,1,e,r,t,n,o,2),g("x","z","y",1,-1,e,r,-t,n,o,3),g("x","y","z",1,-1,e,t,r,n,a,4),g("x","y","z",-1,-1,e,t,-r,n,a,5),this.setIndex(l),this.setAttribute("position",new jr(u,3)),this.setAttribute("normal",new jr(c,3)),this.setAttribute("uv",new jr(p,2));function g(b,x,v,w,_,C,E,T,L,D,B){let A=C/L,k=E/D,$=C/2,O=E/2,P=T/2,U=L+1,G=D+1,K=0,z=0,V=new le;for(let j=0;j<G;j++){let q=j*k-O;for(let ee=0;ee<U;ee++){let ae=ee*A-$;V[b]=ae*w,V[x]=q*_,V[v]=P,u.push(V.x,V.y,V.z),V[b]=0,V[x]=0,V[v]=T>0?1:-1,c.push(V.x,V.y,V.z),p.push(ee/L),p.push(1-j/D),K+=1}}for(let j=0;j<D;j++)for(let q=0;q<L;q++){let ee=d+q+U*j,ae=d+q+U*(j+1),N=d+(q+1)+U*(j+1),J=d+(q+1)+U*j;l.push(ee,ae,J),l.push(ae,N,J),z+=6}s.addGroup(m,z,B),m+=z,d+=K}h(g,"buildPlane")}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new NG(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}};h(OG,"BoxGeometry");var Ux=OG;function eh(i){let e={};for(let t in i){e[t]={};for(let r in i[t]){let n=i[t][r];n&&(n.isColor||n.isMatrix3||n.isMatrix4||n.isVector2||n.isVector3||n.isVector4||n.isTexture||n.isQuaternion)?n.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][r]=null):e[t][r]=n.clone():Array.isArray(n)?e[t][r]=n.slice():e[t][r]=n}}return e}h(eh,"cloneUniforms");function an(i){let e={};for(let t=0;t<i.length;t++){let r=eh(i[t]);for(let n in r)e[n]=r[n]}return e}h(an,"mergeUniforms");function $G(i){let e=[];for(let t=0;t<i.length;t++)e.push(i[t].clone());return e}h($G,"cloneUniformsGroups");function SE(i){return i.getRenderTarget()===null?i.outputColorSpace:Si.workingColorSpace}h(SE,"getUnlitUniformColorSpace");var nme={clone:eh,merge:an},ame=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,ome=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`,UG=class extends Wl{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=ame,this.fragmentShader=ome,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1,clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=eh(e.uniforms),this.uniformsGroups=$G(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){let t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(let n in this.uniforms){let a=this.uniforms[n].value;a&&a.isTexture?t.uniforms[n]={type:"t",value:a.toJSON(e).uuid}:a&&a.isColor?t.uniforms[n]={type:"c",value:a.getHex()}:a&&a.isVector2?t.uniforms[n]={type:"v2",value:a.toArray()}:a&&a.isVector3?t.uniforms[n]={type:"v3",value:a.toArray()}:a&&a.isVector4?t.uniforms[n]={type:"v4",value:a.toArray()}:a&&a.isMatrix3?t.uniforms[n]={type:"m3",value:a.toArray()}:a&&a.isMatrix4?t.uniforms[n]={type:"m4",value:a.toArray()}:t.uniforms[n]={value:a}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;let r={};for(let n in this.extensions)this.extensions[n]===!0&&(r[n]=!0);return Object.keys(r).length>0&&(t.extensions=r),t}};h(UG,"ShaderMaterial");var xo=UG,VG=class extends rr{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new jt,this.projectionMatrix=new jt,this.projectionMatrixInverse=new jt,this.coordinateSystem=Ms}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}};h(VG,"Camera");var ME=VG,Xs=new le,m6=new Oe,g6=new Oe,jG=class extends ME{constructor(e=50,t=1,r=.1,n=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=r,this.far=n,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){let t=.5*this.getFilmHeight()/e;this.fov=Up*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){let e=Math.tan(dp*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return Up*2*Math.atan(Math.tan(dp*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,t,r){Xs.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set(Xs.x,Xs.y).multiplyScalar(-e/Xs.z),Xs.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),r.set(Xs.x,Xs.y).multiplyScalar(-e/Xs.z)}getViewSize(e,t){return this.getViewBounds(e,m6,g6),t.subVectors(g6,m6)}setViewOffset(e,t,r,n,a,o){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=n,this.view.width=a,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=this.near,t=e*Math.tan(dp*.5*this.fov)/this.zoom,r=2*t,n=this.aspect*r,a=-.5*n,o=this.view;if(this.view!==null&&this.view.enabled){let l=o.fullWidth,u=o.fullHeight;a+=o.offsetX*n/l,t-=o.offsetY*r/u,n*=o.width/l,r*=o.height/u}let s=this.filmOffset;s!==0&&(a+=e*s/this.getFilmWidth()),this.projectionMatrix.makePerspective(a,a+n,t,t-r,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){let t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}};h(jG,"PerspectiveCamera");var On=jG,Bh=-90,Oh=1,HG=class extends rr{constructor(e,t,r){super(),this.type="CubeCamera",this.renderTarget=r,this.coordinateSystem=null,this.activeMipmapLevel=0;let n=new On(Bh,Oh,e,t);n.layers=this.layers,this.add(n);let a=new On(Bh,Oh,e,t);a.layers=this.layers,this.add(a);let o=new On(Bh,Oh,e,t);o.layers=this.layers,this.add(o);let s=new On(Bh,Oh,e,t);s.layers=this.layers,this.add(s);let l=new On(Bh,Oh,e,t);l.layers=this.layers,this.add(l);let u=new On(Bh,Oh,e,t);u.layers=this.layers,this.add(u)}updateCoordinateSystem(){let e=this.coordinateSystem,t=this.children.concat(),[r,n,a,o,s,l]=t;for(let u of t)this.remove(u);if(e===Ms)r.up.set(0,1,0),r.lookAt(1,0,0),n.up.set(0,1,0),n.lookAt(-1,0,0),a.up.set(0,0,-1),a.lookAt(0,1,0),o.up.set(0,0,1),o.lookAt(0,-1,0),s.up.set(0,1,0),s.lookAt(0,0,1),l.up.set(0,1,0),l.lookAt(0,0,-1);else if(e===bv)r.up.set(0,-1,0),r.lookAt(-1,0,0),n.up.set(0,-1,0),n.lookAt(1,0,0),a.up.set(0,0,1),a.lookAt(0,1,0),o.up.set(0,0,-1),o.lookAt(0,-1,0),s.up.set(0,-1,0),s.lookAt(0,0,1),l.up.set(0,-1,0),l.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(let u of t)this.add(u),u.updateMatrixWorld()}update(e,t){this.parent===null&&this.updateMatrixWorld();let{renderTarget:r,activeMipmapLevel:n}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());let[a,o,s,l,u,c]=this.children,p=e.getRenderTarget(),d=e.getActiveCubeFace(),m=e.getActiveMipmapLevel(),g=e.xr.enabled;e.xr.enabled=!1;let b=r.texture.generateMipmaps;r.texture.generateMipmaps=!1,e.setRenderTarget(r,0,n),e.render(t,a),e.setRenderTarget(r,1,n),e.render(t,o),e.setRenderTarget(r,2,n),e.render(t,s),e.setRenderTarget(r,3,n),e.render(t,l),e.setRenderTarget(r,4,n),e.render(t,u),r.texture.generateMipmaps=b,e.setRenderTarget(r,5,n),e.render(t,c),e.setRenderTarget(p,d,m),e.xr.enabled=g,r.texture.needsPMREMUpdate=!0}};h(HG,"CubeCamera");var sme=HG,GG=class extends En{constructor(e,t,r,n,a,o,s,l,u,c){e=e!==void 0?e:[],t=t!==void 0?t:Op,super(e,t,r,n,a,o,s,l,u,c),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}};h(GG,"CubeTexture");var WG=GG,XG=class extends Qu{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;let r={width:e,height:e,depth:1},n=[r,r,r,r,r,r];this.texture=new WG(n,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=t.generateMipmaps!==void 0?t.generateMipmaps:!1,this.texture.minFilter=t.minFilter!==void 0?t.minFilter:Fn}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;let r={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},n=new Ux(5,5,5),a=new xo({name:"CubemapFromEquirect",uniforms:eh(r.uniforms),vertexShader:r.vertexShader,fragmentShader:r.fragmentShader,side:Wn,blending:Al});a.uniforms.tEquirect.value=t;let o=new Wi(n,a),s=t.minFilter;return t.minFilter===Pu&&(t.minFilter=Fn),new sme(1,10,this).update(e,o),t.minFilter=s,o.geometry.dispose(),o.material.dispose(),this}clear(e,t,r,n){let a=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(t,r,n);e.setRenderTarget(a)}};h(XG,"WebGLCubeRenderTarget");var lme=XG,_2=new le,ume=new le,hme=new ei,qG=class{constructor(e=new le(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,r,n){return this.normal.set(e,t,r),this.constant=n,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,r){let n=_2.subVectors(r,t).cross(ume.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(n,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){let e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){let r=e.delta(_2),n=this.normal.dot(r);if(n===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;let a=-(e.start.dot(this.normal)+this.constant)/n;return a<0||a>1?null:t.copy(e.start).addScaledVector(r,a)}intersectsLine(e){let t=this.distanceToPoint(e.start),r=this.distanceToPoint(e.end);return t<0&&r>0||r<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){let r=t||hme.getNormalMatrix(e),n=this.coplanarPoint(_2).applyMatrix4(e),a=this.normal.applyMatrix3(r).normalize();return this.constant=-n.dot(a),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}};h(qG,"Plane");var su=qG,Ql=new Xn,d1=new le,ZG=class{constructor(e=new su,t=new su,r=new su,n=new su,a=new su,o=new su){this.planes=[e,t,r,n,a,o]}set(e,t,r,n,a,o){let s=this.planes;return s[0].copy(e),s[1].copy(t),s[2].copy(r),s[3].copy(n),s[4].copy(a),s[5].copy(o),this}copy(e){let t=this.planes;for(let r=0;r<6;r++)t[r].copy(e.planes[r]);return this}setFromProjectionMatrix(e,t=Ms){let r=this.planes,n=e.elements,a=n[0],o=n[1],s=n[2],l=n[3],u=n[4],c=n[5],p=n[6],d=n[7],m=n[8],g=n[9],b=n[10],x=n[11],v=n[12],w=n[13],_=n[14],C=n[15];if(r[0].setComponents(l-a,d-u,x-m,C-v).normalize(),r[1].setComponents(l+a,d+u,x+m,C+v).normalize(),r[2].setComponents(l+o,d+c,x+g,C+w).normalize(),r[3].setComponents(l-o,d-c,x-g,C-w).normalize(),r[4].setComponents(l-s,d-p,x-b,C-_).normalize(),t===Ms)r[5].setComponents(l+s,d+p,x+b,C+_).normalize();else if(t===bv)r[5].setComponents(s,p,b,_).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),Ql.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{let t=e.geometry;t.boundingSphere===null&&t.computeBoundingSphere(),Ql.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(Ql)}intersectsSprite(e){return Ql.center.set(0,0,0),Ql.radius=.7071067811865476,Ql.applyMatrix4(e.matrixWorld),this.intersectsSphere(Ql)}intersectsSphere(e){let t=this.planes,r=e.center,n=-e.radius;for(let a=0;a<6;a++)if(t[a].distanceToPoint(r)<n)return!1;return!0}intersectsBox(e){let t=this.planes;for(let r=0;r<6;r++){let n=t[r];if(d1.x=n.normal.x>0?e.max.x:e.min.x,d1.y=n.normal.y>0?e.max.y:e.min.y,d1.z=n.normal.z>0?e.max.z:e.min.z,n.distanceToPoint(d1)<0)return!1}return!0}containsPoint(e){let t=this.planes;for(let r=0;r<6;r++)if(t[r].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}};h(ZG,"Frustum");var ig=ZG;function CE(){let i=null,e=!1,t=null,r=null;function n(a,o){t(a,o),r=i.requestAnimationFrame(n)}return h(n,"onAnimationFrame"),{start:function(){e!==!0&&t!==null&&(r=i.requestAnimationFrame(n),e=!0)},stop:function(){i.cancelAnimationFrame(r),e=!1},setAnimationLoop:function(a){t=a},setContext:function(a){i=a}}}h(CE,"WebGLAnimation");function YG(i,e){let t=e.isWebGL2,r=new WeakMap;function n(u,c){let p=u.array,d=u.usage,m=p.byteLength,g=i.createBuffer();i.bindBuffer(c,g),i.bufferData(c,p,d),u.onUploadCallback();let b;if(p instanceof Float32Array)b=i.FLOAT;else if(p instanceof Uint16Array)if(u.isFloat16BufferAttribute)if(t)b=i.HALF_FLOAT;else throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");else b=i.UNSIGNED_SHORT;else if(p instanceof Int16Array)b=i.SHORT;else if(p instanceof Uint32Array)b=i.UNSIGNED_INT;else if(p instanceof Int32Array)b=i.INT;else if(p instanceof Int8Array)b=i.BYTE;else if(p instanceof Uint8Array)b=i.UNSIGNED_BYTE;else if(p instanceof Uint8ClampedArray)b=i.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+p);return{buffer:g,type:b,bytesPerElement:p.BYTES_PER_ELEMENT,version:u.version,size:m}}h(n,"createBuffer");function a(u,c,p){let d=c.array,m=c._updateRange,g=c.updateRanges;if(i.bindBuffer(p,u),m.count===-1&&g.length===0&&i.bufferSubData(p,0,d),g.length!==0){for(let b=0,x=g.length;b<x;b++){let v=g[b];t?i.bufferSubData(p,v.start*d.BYTES_PER_ELEMENT,d,v.start,v.count):i.bufferSubData(p,v.start*d.BYTES_PER_ELEMENT,d.subarray(v.start,v.start+v.count))}c.clearUpdateRanges()}m.count!==-1&&(t?i.bufferSubData(p,m.offset*d.BYTES_PER_ELEMENT,d,m.offset,m.count):i.bufferSubData(p,m.offset*d.BYTES_PER_ELEMENT,d.subarray(m.offset,m.offset+m.count)),m.count=-1),c.onUploadCallback()}h(a,"updateBuffer");function o(u){return u.isInterleavedBufferAttribute&&(u=u.data),r.get(u)}h(o,"get");function s(u){u.isInterleavedBufferAttribute&&(u=u.data);let c=r.get(u);c&&(i.deleteBuffer(c.buffer),r.delete(u))}h(s,"remove");function l(u,c){if(u.isGLBufferAttribute){let d=r.get(u);(!d||d.version<u.version)&&r.set(u,{buffer:u.buffer,type:u.type,bytesPerElement:u.elementSize,version:u.version});return}u.isInterleavedBufferAttribute&&(u=u.data);let p=r.get(u);if(p===void 0)r.set(u,n(u,c));else if(p.version<u.version){if(p.size!==u.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");a(p.buffer,u,c),p.version=u.version}}return h(l,"update"),{get:o,remove:s,update:l}}h(YG,"WebGLAttributes");var JG=class KG extends ma{constructor(e=1,t=1,r=1,n=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:r,heightSegments:n};let a=e/2,o=t/2,s=Math.floor(r),l=Math.floor(n),u=s+1,c=l+1,p=e/s,d=t/l,m=[],g=[],b=[],x=[];for(let v=0;v<c;v++){let w=v*d-o;for(let _=0;_<u;_++){let C=_*p-a;g.push(C,-w,0),b.push(0,0,1),x.push(_/s),x.push(1-v/l)}}for(let v=0;v<l;v++)for(let w=0;w<s;w++){let _=w+u*v,C=w+u*(v+1),E=w+1+u*(v+1),T=w+1+u*v;m.push(_,C,T),m.push(C,E,T)}this.setIndex(m),this.setAttribute("position",new jr(g,3)),this.setAttribute("normal",new jr(b,3)),this.setAttribute("uv",new jr(x,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new KG(e.width,e.height,e.widthSegments,e.heightSegments)}};h(JG,"PlaneGeometry");var rg=JG,cme=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,pme=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,dme=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,fme=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,mme=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,gme=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,yme=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,vme=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,xme=`#ifdef USE_BATCHING
	attribute float batchId;
	uniform highp sampler2D batchingTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,_me=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( batchId );
#endif`,bme=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,wme=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,Sme=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,Mme=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,Cme=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,Eme=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,Tme=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,Pme=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,Ame=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,Ime=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,Lme=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,Dme=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,kme=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,Rme=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,Fme=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,zme=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,Bme=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,Ome=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,Nme=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,$me=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,Ume="gl_FragColor = linearToOutputTexel( gl_FragColor );",Vme=`
const mat3 LINEAR_SRGB_TO_LINEAR_DISPLAY_P3 = mat3(
	vec3( 0.8224621, 0.177538, 0.0 ),
	vec3( 0.0331941, 0.9668058, 0.0 ),
	vec3( 0.0170827, 0.0723974, 0.9105199 )
);
const mat3 LINEAR_DISPLAY_P3_TO_LINEAR_SRGB = mat3(
	vec3( 1.2249401, - 0.2249404, 0.0 ),
	vec3( - 0.0420569, 1.0420571, 0.0 ),
	vec3( - 0.0196376, - 0.0786361, 1.0982735 )
);
vec4 LinearSRGBToLinearDisplayP3( in vec4 value ) {
	return vec4( value.rgb * LINEAR_SRGB_TO_LINEAR_DISPLAY_P3, value.a );
}
vec4 LinearDisplayP3ToLinearSRGB( in vec4 value ) {
	return vec4( value.rgb * LINEAR_DISPLAY_P3_TO_LINEAR_SRGB, value.a );
}
vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}
vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return sRGBTransferOETF( value );
}`,jme=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,Hme=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,Gme=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,Wme=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,Xme=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,qme=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,Zme=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,Yme=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,Jme=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,Kme=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,Qme=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,ege=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,tge=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,ige=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,rge=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( LEGACY_LIGHTS )
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#else
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,nge=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,age=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,oge=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,sge=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,lge=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,uge=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,hge=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,cge=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,pge=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,dge=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,fge=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,mge=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,gge=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,yge=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,vge=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,xge=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,_ge=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,bge=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,wge=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,Sge=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,Mge=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[MORPHTARGETS_COUNT];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,Cge=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,Ege=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,Tge=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
	#endif
	#ifdef MORPHTARGETS_TEXTURE
		#ifndef USE_INSTANCING_MORPH
			uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		#endif
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,Pge=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,Age=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,Ige=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,Lge=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,Dge=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,kge=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,Rge=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,Fge=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,zge=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,Bge=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,Oge=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,Nge=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,$ge=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}
float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,Uge=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,Vge=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,jge=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,Hge=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,Gge=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,Wge=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,Xge=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,qge=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,Zge=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,Yge=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,Jge=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,Kge=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,Qge=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,e1e=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,t1e=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,i1e=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,r1e=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,n1e=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	float startCompression = 0.8 - 0.04;
	float desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min(color.r, min(color.g, color.b));
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max(color.r, max(color.g, color.b));
	if (peak < startCompression) return color;
	float d = 1. - startCompression;
	float newPeak = 1. - d * d / (peak + d - startCompression);
	color *= newPeak / peak;
	float g = 1. - 1. / (desaturation * (peak - newPeak) + 1.);
	return mix(color, vec3(1, 1, 1), g);
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,a1e=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,o1e=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,s1e=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,l1e=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,u1e=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,h1e=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`,c1e=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,p1e=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,d1e=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,f1e=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,m1e=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,g1e=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,y1e=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,v1e=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,x1e=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,_1e=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,b1e=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,w1e=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,S1e=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,M1e=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,C1e=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,E1e=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,T1e=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,P1e=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,A1e=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,I1e=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,L1e=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,D1e=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,k1e=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,R1e=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,F1e=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,z1e=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,B1e=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,O1e=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,N1e=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,$1e=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,U1e=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,V1e=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,j1e=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,H1e=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,Yt={alphahash_fragment:cme,alphahash_pars_fragment:pme,alphamap_fragment:dme,alphamap_pars_fragment:fme,alphatest_fragment:mme,alphatest_pars_fragment:gme,aomap_fragment:yme,aomap_pars_fragment:vme,batching_pars_vertex:xme,batching_vertex:_me,begin_vertex:bme,beginnormal_vertex:wme,bsdfs:Sme,iridescence_fragment:Mme,bumpmap_pars_fragment:Cme,clipping_planes_fragment:Eme,clipping_planes_pars_fragment:Tme,clipping_planes_pars_vertex:Pme,clipping_planes_vertex:Ame,color_fragment:Ime,color_pars_fragment:Lme,color_pars_vertex:Dme,color_vertex:kme,common:Rme,cube_uv_reflection_fragment:Fme,defaultnormal_vertex:zme,displacementmap_pars_vertex:Bme,displacementmap_vertex:Ome,emissivemap_fragment:Nme,emissivemap_pars_fragment:$me,colorspace_fragment:Ume,colorspace_pars_fragment:Vme,envmap_fragment:jme,envmap_common_pars_fragment:Hme,envmap_pars_fragment:Gme,envmap_pars_vertex:Wme,envmap_physical_pars_fragment:nge,envmap_vertex:Xme,fog_vertex:qme,fog_pars_vertex:Zme,fog_fragment:Yme,fog_pars_fragment:Jme,gradientmap_pars_fragment:Kme,lightmap_fragment:Qme,lightmap_pars_fragment:ege,lights_lambert_fragment:tge,lights_lambert_pars_fragment:ige,lights_pars_begin:rge,lights_toon_fragment:age,lights_toon_pars_fragment:oge,lights_phong_fragment:sge,lights_phong_pars_fragment:lge,lights_physical_fragment:uge,lights_physical_pars_fragment:hge,lights_fragment_begin:cge,lights_fragment_maps:pge,lights_fragment_end:dge,logdepthbuf_fragment:fge,logdepthbuf_pars_fragment:mge,logdepthbuf_pars_vertex:gge,logdepthbuf_vertex:yge,map_fragment:vge,map_pars_fragment:xge,map_particle_fragment:_ge,map_particle_pars_fragment:bge,metalnessmap_fragment:wge,metalnessmap_pars_fragment:Sge,morphinstance_vertex:Mge,morphcolor_vertex:Cge,morphnormal_vertex:Ege,morphtarget_pars_vertex:Tge,morphtarget_vertex:Pge,normal_fragment_begin:Age,normal_fragment_maps:Ige,normal_pars_fragment:Lge,normal_pars_vertex:Dge,normal_vertex:kge,normalmap_pars_fragment:Rge,clearcoat_normal_fragment_begin:Fge,clearcoat_normal_fragment_maps:zge,clearcoat_pars_fragment:Bge,iridescence_pars_fragment:Oge,opaque_fragment:Nge,packing:$ge,premultiplied_alpha_fragment:Uge,project_vertex:Vge,dithering_fragment:jge,dithering_pars_fragment:Hge,roughnessmap_fragment:Gge,roughnessmap_pars_fragment:Wge,shadowmap_pars_fragment:Xge,shadowmap_pars_vertex:qge,shadowmap_vertex:Zge,shadowmask_pars_fragment:Yge,skinbase_vertex:Jge,skinning_pars_vertex:Kge,skinning_vertex:Qge,skinnormal_vertex:e1e,specularmap_fragment:t1e,specularmap_pars_fragment:i1e,tonemapping_fragment:r1e,tonemapping_pars_fragment:n1e,transmission_fragment:a1e,transmission_pars_fragment:o1e,uv_pars_fragment:s1e,uv_pars_vertex:l1e,uv_vertex:u1e,worldpos_vertex:h1e,background_vert:c1e,background_frag:p1e,backgroundCube_vert:d1e,backgroundCube_frag:f1e,cube_vert:m1e,cube_frag:g1e,depth_vert:y1e,depth_frag:v1e,distanceRGBA_vert:x1e,distanceRGBA_frag:_1e,equirect_vert:b1e,equirect_frag:w1e,linedashed_vert:S1e,linedashed_frag:M1e,meshbasic_vert:C1e,meshbasic_frag:E1e,meshlambert_vert:T1e,meshlambert_frag:P1e,meshmatcap_vert:A1e,meshmatcap_frag:I1e,meshnormal_vert:L1e,meshnormal_frag:D1e,meshphong_vert:k1e,meshphong_frag:R1e,meshphysical_vert:F1e,meshphysical_frag:z1e,meshtoon_vert:B1e,meshtoon_frag:O1e,points_vert:N1e,points_frag:$1e,shadow_vert:U1e,shadow_frag:V1e,sprite_vert:j1e,sprite_frag:H1e},at={common:{diffuse:{value:new Lt(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new ei},alphaMap:{value:null},alphaMapTransform:{value:new ei},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new ei}},envmap:{envMap:{value:null},envMapRotation:{value:new ei},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new ei}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new ei}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new ei},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new ei},normalScale:{value:new Oe(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new ei},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new ei}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new ei}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new ei}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Lt(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Lt(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new ei},alphaTest:{value:0},uvTransform:{value:new ei}},sprite:{diffuse:{value:new Lt(16777215)},opacity:{value:1},center:{value:new Oe(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new ei},alphaMap:{value:null},alphaMapTransform:{value:new ei},alphaTest:{value:0}}},Fo={basic:{uniforms:an([at.common,at.specularmap,at.envmap,at.aomap,at.lightmap,at.fog]),vertexShader:Yt.meshbasic_vert,fragmentShader:Yt.meshbasic_frag},lambert:{uniforms:an([at.common,at.specularmap,at.envmap,at.aomap,at.lightmap,at.emissivemap,at.bumpmap,at.normalmap,at.displacementmap,at.fog,at.lights,{emissive:{value:new Lt(0)}}]),vertexShader:Yt.meshlambert_vert,fragmentShader:Yt.meshlambert_frag},phong:{uniforms:an([at.common,at.specularmap,at.envmap,at.aomap,at.lightmap,at.emissivemap,at.bumpmap,at.normalmap,at.displacementmap,at.fog,at.lights,{emissive:{value:new Lt(0)},specular:{value:new Lt(1118481)},shininess:{value:30}}]),vertexShader:Yt.meshphong_vert,fragmentShader:Yt.meshphong_frag},standard:{uniforms:an([at.common,at.envmap,at.aomap,at.lightmap,at.emissivemap,at.bumpmap,at.normalmap,at.displacementmap,at.roughnessmap,at.metalnessmap,at.fog,at.lights,{emissive:{value:new Lt(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Yt.meshphysical_vert,fragmentShader:Yt.meshphysical_frag},toon:{uniforms:an([at.common,at.aomap,at.lightmap,at.emissivemap,at.bumpmap,at.normalmap,at.displacementmap,at.gradientmap,at.fog,at.lights,{emissive:{value:new Lt(0)}}]),vertexShader:Yt.meshtoon_vert,fragmentShader:Yt.meshtoon_frag},matcap:{uniforms:an([at.common,at.bumpmap,at.normalmap,at.displacementmap,at.fog,{matcap:{value:null}}]),vertexShader:Yt.meshmatcap_vert,fragmentShader:Yt.meshmatcap_frag},points:{uniforms:an([at.points,at.fog]),vertexShader:Yt.points_vert,fragmentShader:Yt.points_frag},dashed:{uniforms:an([at.common,at.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Yt.linedashed_vert,fragmentShader:Yt.linedashed_frag},depth:{uniforms:an([at.common,at.displacementmap]),vertexShader:Yt.depth_vert,fragmentShader:Yt.depth_frag},normal:{uniforms:an([at.common,at.bumpmap,at.normalmap,at.displacementmap,{opacity:{value:1}}]),vertexShader:Yt.meshnormal_vert,fragmentShader:Yt.meshnormal_frag},sprite:{uniforms:an([at.sprite,at.fog]),vertexShader:Yt.sprite_vert,fragmentShader:Yt.sprite_frag},background:{uniforms:{uvTransform:{value:new ei},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Yt.background_vert,fragmentShader:Yt.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new ei}},vertexShader:Yt.backgroundCube_vert,fragmentShader:Yt.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Yt.cube_vert,fragmentShader:Yt.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Yt.equirect_vert,fragmentShader:Yt.equirect_frag},distanceRGBA:{uniforms:an([at.common,at.displacementmap,{referencePosition:{value:new le},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Yt.distanceRGBA_vert,fragmentShader:Yt.distanceRGBA_frag},shadow:{uniforms:an([at.lights,at.fog,{color:{value:new Lt(0)},opacity:{value:1}}]),vertexShader:Yt.shadow_vert,fragmentShader:Yt.shadow_frag}};Fo.physical={uniforms:an([Fo.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new ei},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new ei},clearcoatNormalScale:{value:new Oe(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new ei},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new ei},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new ei},sheen:{value:0},sheenColor:{value:new Lt(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new ei},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new ei},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new ei},transmissionSamplerSize:{value:new Oe},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new ei},attenuationDistance:{value:0},attenuationColor:{value:new Lt(0)},specularColor:{value:new Lt(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new ei},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new ei},anisotropyVector:{value:new Oe},anisotropyMap:{value:null},anisotropyMapTransform:{value:new ei}}]),vertexShader:Yt.meshphysical_vert,fragmentShader:Yt.meshphysical_frag};var f1={r:0,b:0,g:0},eu=new $a,G1e=new jt;function QG(i,e,t,r,n,a,o){let s=new Lt(0),l=a===!0?0:1,u,c,p=null,d=0,m=null;function g(x,v){let w=!1,_=v.isScene===!0?v.background:null;_&&_.isTexture&&(_=(v.backgroundBlurriness>0?t:e).get(_)),_===null?b(s,l):_&&_.isColor&&(b(_,1),w=!0);let C=i.xr.getEnvironmentBlendMode();C==="additive"?r.buffers.color.setClear(0,0,0,1,o):C==="alpha-blend"&&r.buffers.color.setClear(0,0,0,0,o),(i.autoClear||w)&&i.clear(i.autoClearColor,i.autoClearDepth,i.autoClearStencil),_&&(_.isCubeTexture||_.mapping===Ox)?(c===void 0&&(c=new Wi(new Ux(1,1,1),new xo({name:"BackgroundCubeMaterial",uniforms:eh(Fo.backgroundCube.uniforms),vertexShader:Fo.backgroundCube.vertexShader,fragmentShader:Fo.backgroundCube.fragmentShader,side:Wn,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),c.geometry.deleteAttribute("uv"),c.onBeforeRender=function(E,T,L){this.matrixWorld.copyPosition(L.matrixWorld)},Object.defineProperty(c.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),n.update(c)),eu.copy(v.backgroundRotation),eu.x*=-1,eu.y*=-1,eu.z*=-1,_.isCubeTexture&&_.isRenderTargetTexture===!1&&(eu.y*=-1,eu.z*=-1),c.material.uniforms.envMap.value=_,c.material.uniforms.flipEnvMap.value=_.isCubeTexture&&_.isRenderTargetTexture===!1?-1:1,c.material.uniforms.backgroundBlurriness.value=v.backgroundBlurriness,c.material.uniforms.backgroundIntensity.value=v.backgroundIntensity,c.material.uniforms.backgroundRotation.value.setFromMatrix4(G1e.makeRotationFromEuler(eu)),c.material.toneMapped=Si.getTransfer(_.colorSpace)!==Di,(p!==_||d!==_.version||m!==i.toneMapping)&&(c.material.needsUpdate=!0,p=_,d=_.version,m=i.toneMapping),c.layers.enableAll(),x.unshift(c,c.geometry,c.material,0,0,null)):_&&_.isTexture&&(u===void 0&&(u=new Wi(new rg(2,2),new xo({name:"BackgroundMaterial",uniforms:eh(Fo.background.uniforms),vertexShader:Fo.background.vertexShader,fragmentShader:Fo.background.fragmentShader,side:Bl,depthTest:!1,depthWrite:!1,fog:!1})),u.geometry.deleteAttribute("normal"),Object.defineProperty(u.material,"map",{get:function(){return this.uniforms.t2D.value}}),n.update(u)),u.material.uniforms.t2D.value=_,u.material.uniforms.backgroundIntensity.value=v.backgroundIntensity,u.material.toneMapped=Si.getTransfer(_.colorSpace)!==Di,_.matrixAutoUpdate===!0&&_.updateMatrix(),u.material.uniforms.uvTransform.value.copy(_.matrix),(p!==_||d!==_.version||m!==i.toneMapping)&&(u.material.needsUpdate=!0,p=_,d=_.version,m=i.toneMapping),u.layers.enableAll(),x.unshift(u,u.geometry,u.material,0,0,null))}h(g,"render");function b(x,v){x.getRGB(f1,SE(i)),r.buffers.color.setClear(f1.r,f1.g,f1.b,v,o)}return h(b,"setClear"),{getClearColor:function(){return s},setClearColor:function(x,v=1){s.set(x),l=v,b(s,l)},getClearAlpha:function(){return l},setClearAlpha:function(x){l=x,b(s,l)},render:g}}h(QG,"WebGLBackground");function eW(i,e,t,r){let n=i.getParameter(i.MAX_VERTEX_ATTRIBS),a=r.isWebGL2?null:e.get("OES_vertex_array_object"),o=r.isWebGL2||a!==null,s={},l=x(null),u=l,c=!1;function p(P,U,G,K,z){let V=!1;if(o){let j=b(K,G,U);u!==j&&(u=j,m(u.object)),V=v(P,K,G,z),V&&w(P,K,G,z)}else{let j=U.wireframe===!0;(u.geometry!==K.id||u.program!==G.id||u.wireframe!==j)&&(u.geometry=K.id,u.program=G.id,u.wireframe=j,V=!0)}z!==null&&t.update(z,i.ELEMENT_ARRAY_BUFFER),(V||c)&&(c=!1,D(P,U,G,K),z!==null&&i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,t.get(z).buffer))}h(p,"setup");function d(){return r.isWebGL2?i.createVertexArray():a.createVertexArrayOES()}h(d,"createVertexArrayObject");function m(P){return r.isWebGL2?i.bindVertexArray(P):a.bindVertexArrayOES(P)}h(m,"bindVertexArrayObject");function g(P){return r.isWebGL2?i.deleteVertexArray(P):a.deleteVertexArrayOES(P)}h(g,"deleteVertexArrayObject");function b(P,U,G){let K=G.wireframe===!0,z=s[P.id];z===void 0&&(z={},s[P.id]=z);let V=z[U.id];V===void 0&&(V={},z[U.id]=V);let j=V[K];return j===void 0&&(j=x(d()),V[K]=j),j}h(b,"getBindingState");function x(P){let U=[],G=[],K=[];for(let z=0;z<n;z++)U[z]=0,G[z]=0,K[z]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:U,enabledAttributes:G,attributeDivisors:K,object:P,attributes:{},index:null}}h(x,"createBindingState");function v(P,U,G,K){let z=u.attributes,V=U.attributes,j=0,q=G.getAttributes();for(let ee in q)if(q[ee].location>=0){let ae=z[ee],N=V[ee];if(N===void 0&&(ee==="instanceMatrix"&&P.instanceMatrix&&(N=P.instanceMatrix),ee==="instanceColor"&&P.instanceColor&&(N=P.instanceColor)),ae===void 0||ae.attribute!==N||N&&ae.data!==N.data)return!0;j++}return u.attributesNum!==j||u.index!==K}h(v,"needsUpdate");function w(P,U,G,K){let z={},V=U.attributes,j=0,q=G.getAttributes();for(let ee in q)if(q[ee].location>=0){let ae=V[ee];ae===void 0&&(ee==="instanceMatrix"&&P.instanceMatrix&&(ae=P.instanceMatrix),ee==="instanceColor"&&P.instanceColor&&(ae=P.instanceColor));let N={};N.attribute=ae,ae&&ae.data&&(N.data=ae.data),z[ee]=N,j++}u.attributes=z,u.attributesNum=j,u.index=K}h(w,"saveCache");function _(){let P=u.newAttributes;for(let U=0,G=P.length;U<G;U++)P[U]=0}h(_,"initAttributes");function C(P){E(P,0)}h(C,"enableAttribute");function E(P,U){let G=u.newAttributes,K=u.enabledAttributes,z=u.attributeDivisors;G[P]=1,K[P]===0&&(i.enableVertexAttribArray(P),K[P]=1),z[P]!==U&&((r.isWebGL2?i:e.get("ANGLE_instanced_arrays"))[r.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](P,U),z[P]=U)}h(E,"enableAttributeAndDivisor");function T(){let P=u.newAttributes,U=u.enabledAttributes;for(let G=0,K=U.length;G<K;G++)U[G]!==P[G]&&(i.disableVertexAttribArray(G),U[G]=0)}h(T,"disableUnusedAttributes");function L(P,U,G,K,z,V,j){j===!0?i.vertexAttribIPointer(P,U,G,z,V):i.vertexAttribPointer(P,U,G,K,z,V)}h(L,"vertexAttribPointer");function D(P,U,G,K){if(r.isWebGL2===!1&&(P.isInstancedMesh||K.isInstancedBufferGeometry)&&e.get("ANGLE_instanced_arrays")===null)return;_();let z=K.attributes,V=G.getAttributes(),j=U.defaultAttributeValues;for(let q in V){let ee=V[q];if(ee.location>=0){let ae=z[q];if(ae===void 0&&(q==="instanceMatrix"&&P.instanceMatrix&&(ae=P.instanceMatrix),q==="instanceColor"&&P.instanceColor&&(ae=P.instanceColor)),ae!==void 0){let N=ae.normalized,J=ae.itemSize,Y=t.get(ae);if(Y===void 0)continue;let oe=Y.buffer,xe=Y.type,ge=Y.bytesPerElement,Te=r.isWebGL2===!0&&(xe===i.INT||xe===i.UNSIGNED_INT||ae.gpuType===CH);if(ae.isInterleavedBufferAttribute){let me=ae.data,Q=me.stride,Me=ae.offset;if(me.isInstancedInterleavedBuffer){for(let ve=0;ve<ee.locationSize;ve++)E(ee.location+ve,me.meshPerAttribute);P.isInstancedMesh!==!0&&K._maxInstanceCount===void 0&&(K._maxInstanceCount=me.meshPerAttribute*me.count)}else for(let ve=0;ve<ee.locationSize;ve++)C(ee.location+ve);i.bindBuffer(i.ARRAY_BUFFER,oe);for(let ve=0;ve<ee.locationSize;ve++)L(ee.location+ve,J/ee.locationSize,xe,N,Q*ge,(Me+J/ee.locationSize*ve)*ge,Te)}else{if(ae.isInstancedBufferAttribute){for(let me=0;me<ee.locationSize;me++)E(ee.location+me,ae.meshPerAttribute);P.isInstancedMesh!==!0&&K._maxInstanceCount===void 0&&(K._maxInstanceCount=ae.meshPerAttribute*ae.count)}else for(let me=0;me<ee.locationSize;me++)C(ee.location+me);i.bindBuffer(i.ARRAY_BUFFER,oe);for(let me=0;me<ee.locationSize;me++)L(ee.location+me,J/ee.locationSize,xe,N,J*ge,J/ee.locationSize*me*ge,Te)}}else if(j!==void 0){let N=j[q];if(N!==void 0)switch(N.length){case 2:i.vertexAttrib2fv(ee.location,N);break;case 3:i.vertexAttrib3fv(ee.location,N);break;case 4:i.vertexAttrib4fv(ee.location,N);break;default:i.vertexAttrib1fv(ee.location,N)}}}}T()}h(D,"setupVertexAttributes");function B(){$();for(let P in s){let U=s[P];for(let G in U){let K=U[G];for(let z in K)g(K[z].object),delete K[z];delete U[G]}delete s[P]}}h(B,"dispose");function A(P){if(s[P.id]===void 0)return;let U=s[P.id];for(let G in U){let K=U[G];for(let z in K)g(K[z].object),delete K[z];delete U[G]}delete s[P.id]}h(A,"releaseStatesOfGeometry");function k(P){for(let U in s){let G=s[U];if(G[P.id]===void 0)continue;let K=G[P.id];for(let z in K)g(K[z].object),delete K[z];delete G[P.id]}}h(k,"releaseStatesOfProgram");function $(){O(),c=!0,u!==l&&(u=l,m(u.object))}h($,"reset");function O(){l.geometry=null,l.program=null,l.wireframe=!1}return h(O,"resetDefaultState"),{setup:p,reset:$,resetDefaultState:O,dispose:B,releaseStatesOfGeometry:A,releaseStatesOfProgram:k,initAttributes:_,enableAttribute:C,disableUnusedAttributes:T}}h(eW,"WebGLBindingStates");function tW(i,e,t,r){let n=r.isWebGL2,a;function o(c){a=c}h(o,"setMode");function s(c,p){i.drawArrays(a,c,p),t.update(p,a,1)}h(s,"render");function l(c,p,d){if(d===0)return;let m,g;if(n)m=i,g="drawArraysInstanced";else if(m=e.get("ANGLE_instanced_arrays"),g="drawArraysInstancedANGLE",m===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}m[g](a,c,p,d),t.update(p,a,d)}h(l,"renderInstances");function u(c,p,d){if(d===0)return;let m=e.get("WEBGL_multi_draw");if(m===null)for(let g=0;g<d;g++)this.render(c[g],p[g]);else{m.multiDrawArraysWEBGL(a,c,0,p,0,d);let g=0;for(let b=0;b<d;b++)g+=p[b];t.update(g,a,1)}}h(u,"renderMultiDraw"),this.setMode=o,this.render=s,this.renderInstances=l,this.renderMultiDraw=u}h(tW,"WebGLBufferRenderer");function iW(i,e,t){let r;function n(){if(r!==void 0)return r;if(e.has("EXT_texture_filter_anisotropic")===!0){let L=e.get("EXT_texture_filter_anisotropic");r=i.getParameter(L.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r}h(n,"getMaxAnisotropy");function a(L){if(L==="highp"){if(i.getShaderPrecisionFormat(i.VERTEX_SHADER,i.HIGH_FLOAT).precision>0&&i.getShaderPrecisionFormat(i.FRAGMENT_SHADER,i.HIGH_FLOAT).precision>0)return"highp";L="mediump"}return L==="mediump"&&i.getShaderPrecisionFormat(i.VERTEX_SHADER,i.MEDIUM_FLOAT).precision>0&&i.getShaderPrecisionFormat(i.FRAGMENT_SHADER,i.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}h(a,"getMaxPrecision");let o=typeof WebGL2RenderingContext<"u"&&i.constructor.name==="WebGL2RenderingContext",s=t.precision!==void 0?t.precision:"highp",l=a(s);l!==s&&(console.warn("THREE.WebGLRenderer:",s,"not supported, using",l,"instead."),s=l);let u=o||e.has("WEBGL_draw_buffers"),c=t.logarithmicDepthBuffer===!0,p=i.getParameter(i.MAX_TEXTURE_IMAGE_UNITS),d=i.getParameter(i.MAX_VERTEX_TEXTURE_IMAGE_UNITS),m=i.getParameter(i.MAX_TEXTURE_SIZE),g=i.getParameter(i.MAX_CUBE_MAP_TEXTURE_SIZE),b=i.getParameter(i.MAX_VERTEX_ATTRIBS),x=i.getParameter(i.MAX_VERTEX_UNIFORM_VECTORS),v=i.getParameter(i.MAX_VARYING_VECTORS),w=i.getParameter(i.MAX_FRAGMENT_UNIFORM_VECTORS),_=d>0,C=o||e.has("OES_texture_float"),E=_&&C,T=o?i.getParameter(i.MAX_SAMPLES):0;return{isWebGL2:o,drawBuffers:u,getMaxAnisotropy:n,getMaxPrecision:a,precision:s,logarithmicDepthBuffer:c,maxTextures:p,maxVertexTextures:d,maxTextureSize:m,maxCubemapSize:g,maxAttributes:b,maxVertexUniforms:x,maxVaryings:v,maxFragmentUniforms:w,vertexTextures:_,floatFragmentTextures:C,floatVertexTextures:E,maxSamples:T}}h(iW,"WebGLCapabilities");function rW(i){let e=this,t=null,r=0,n=!1,a=!1,o=new su,s=new ei,l={value:null,needsUpdate:!1};this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(p,d){let m=p.length!==0||d||r!==0||n;return n=d,r=p.length,m},this.beginShadows=function(){a=!0,c(null)},this.endShadows=function(){a=!1},this.setGlobalState=function(p,d){t=c(p,d,0)},this.setState=function(p,d,m){let g=p.clippingPlanes,b=p.clipIntersection,x=p.clipShadows,v=i.get(p);if(!n||g===null||g.length===0||a&&!x)a?c(null):u();else{let w=a?0:r,_=w*4,C=v.clippingState||null;l.value=C,C=c(g,d,_,m);for(let E=0;E!==_;++E)C[E]=t[E];v.clippingState=C,this.numIntersection=b?this.numPlanes:0,this.numPlanes+=w}};function u(){l.value!==t&&(l.value=t,l.needsUpdate=r>0),e.numPlanes=r,e.numIntersection=0}h(u,"resetGlobalState");function c(p,d,m,g){let b=p!==null?p.length:0,x=null;if(b!==0){if(x=l.value,g!==!0||x===null){let v=m+b*4,w=d.matrixWorldInverse;s.getNormalMatrix(w),(x===null||x.length<v)&&(x=new Float32Array(v));for(let _=0,C=m;_!==b;++_,C+=4)o.copy(p[_]).applyMatrix4(w,s),o.normal.toArray(x,C),x[C+3]=o.constant}l.value=x,l.needsUpdate=!0}return e.numPlanes=b,e.numIntersection=0,x}h(c,"projectPlanes")}h(rW,"WebGLClipping");function nW(i){let e=new WeakMap;function t(o,s){return s===f3?o.mapping=Op:s===m3&&(o.mapping=Np),o}h(t,"mapTextureMapping");function r(o){if(o&&o.isTexture){let s=o.mapping;if(s===f3||s===m3)if(e.has(o)){let l=e.get(o).texture;return t(l,o.mapping)}else{let l=o.image;if(l&&l.height>0){let u=new lme(l.height);return u.fromEquirectangularTexture(i,o),e.set(o,u),o.addEventListener("dispose",n),t(u.texture,o.mapping)}else return null}}return o}h(r,"get");function n(o){let s=o.target;s.removeEventListener("dispose",n);let l=e.get(s);l!==void 0&&(e.delete(s),l.dispose())}h(n,"onTextureDispose");function a(){e=new WeakMap}return h(a,"dispose"),{get:r,dispose:a}}h(nW,"WebGLCubeMaps");var aW=class extends ME{constructor(e=-1,t=1,r=1,n=-1,a=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=r,this.bottom=n,this.near=a,this.far=o,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,r,n,a,o){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=n,this.view.width=a,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),r=(this.right+this.left)/2,n=(this.top+this.bottom)/2,a=r-e,o=r+e,s=n+t,l=n-t;if(this.view!==null&&this.view.enabled){let u=(this.right-this.left)/this.view.fullWidth/this.zoom,c=(this.top-this.bottom)/this.view.fullHeight/this.zoom;a+=u*this.view.offsetX,o=a+u*this.view.width,s-=c*this.view.offsetY,l=s-c*this.view.height}this.projectionMatrix.makeOrthographic(a,o,s,l,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){let t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}};h(aW,"OrthographicCamera");var oW=aW,jc=4,y6=[.125,.215,.35,.446,.526,.582],wu=20,b2=new oW,v6=new Lt,w2=null,S2=0,M2=0,lu=(1+Math.sqrt(5))/2,Nh=1/lu,x6=[new le(1,1,1),new le(-1,1,1),new le(1,1,-1),new le(-1,1,-1),new le(0,lu,Nh),new le(0,lu,-Nh),new le(Nh,0,lu),new le(-Nh,0,lu),new le(lu,Nh,0),new le(-lu,Nh,0)],sW=class{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,r=.1,n=100){w2=this._renderer.getRenderTarget(),S2=this._renderer.getActiveCubeFace(),M2=this._renderer.getActiveMipmapLevel(),this._setSize(256);let a=this._allocateTargets();return a.depthBuffer=!0,this._sceneToCubeUV(e,r,n,a),t>0&&this._blur(a,0,0,t),this._applyPMREM(a),this._cleanup(a),a}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=w3(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=b3(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(w2,S2,M2),e.scissorTest=!1,lf(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===Op||e.mapping===Np?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),w2=this._renderer.getRenderTarget(),S2=this._renderer.getActiveCubeFace(),M2=this._renderer.getActiveMipmapLevel();let r=t||this._allocateTargets();return this._textureToCubeUV(e,r),this._applyPMREM(r),this._cleanup(r),r}_allocateTargets(){let e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,r={magFilter:Fn,minFilter:Fn,generateMipmaps:!1,type:Tm,format:$n,colorSpace:Gl,depthBuffer:!1},n=_3(e,t,r);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=_3(e,t,r);let{_lodMax:a}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=lW(a)),this._blurMaterial=uW(a,e,t)}return n}_compileMaterial(e){let t=new Wi(this._lodPlanes[0],e);this._renderer.compile(t,b2)}_sceneToCubeUV(e,t,r,n){let a=new On(90,1,t,r),o=[1,-1,1,1,1,1],s=[1,1,1,-1,-1,-1],l=this._renderer,u=l.autoClear,c=l.toneMapping;l.getClearColor(v6),l.toneMapping=Il,l.autoClear=!1;let p=new rd({name:"PMREM.Background",side:Wn,depthWrite:!1,depthTest:!1}),d=new Wi(new Ux,p),m=!1,g=e.background;g?g.isColor&&(p.color.copy(g),e.background=null,m=!0):(p.color.copy(v6),m=!0);for(let b=0;b<6;b++){let x=b%3;x===0?(a.up.set(0,o[b],0),a.lookAt(s[b],0,0)):x===1?(a.up.set(0,0,o[b]),a.lookAt(0,s[b],0)):(a.up.set(0,o[b],0),a.lookAt(0,0,s[b]));let v=this._cubeSize;lf(n,x*v,b>2?v:0,v,v),l.setRenderTarget(n),m&&l.render(d,a),l.render(e,a)}d.geometry.dispose(),d.material.dispose(),l.toneMapping=c,l.autoClear=u,e.background=g}_textureToCubeUV(e,t){let r=this._renderer,n=e.mapping===Op||e.mapping===Np;n?(this._cubemapMaterial===null&&(this._cubemapMaterial=w3()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=b3());let a=n?this._cubemapMaterial:this._equirectMaterial,o=new Wi(this._lodPlanes[0],a),s=a.uniforms;s.envMap.value=e;let l=this._cubeSize;lf(t,0,0,3*l,2*l),r.setRenderTarget(t),r.render(o,b2)}_applyPMREM(e){let t=this._renderer,r=t.autoClear;t.autoClear=!1;for(let n=1;n<this._lodPlanes.length;n++){let a=Math.sqrt(this._sigmas[n]*this._sigmas[n]-this._sigmas[n-1]*this._sigmas[n-1]),o=x6[(n-1)%x6.length];this._blur(e,n-1,n,a,o)}t.autoClear=r}_blur(e,t,r,n,a){let o=this._pingPongRenderTarget;this._halfBlur(e,o,t,r,n,"latitudinal",a),this._halfBlur(o,e,r,r,n,"longitudinal",a)}_halfBlur(e,t,r,n,a,o,s){let l=this._renderer,u=this._blurMaterial;o!=="latitudinal"&&o!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");let c=3,p=new Wi(this._lodPlanes[n],u),d=u.uniforms,m=this._sizeLods[r]-1,g=isFinite(a)?Math.PI/(2*m):2*Math.PI/(2*wu-1),b=a/g,x=isFinite(a)?1+Math.floor(c*b):wu;x>wu&&console.warn(`sigmaRadians, ${a}, is too large and will clip, as it requested ${x} samples when the maximum is set to ${wu}`);let v=[],w=0;for(let L=0;L<wu;++L){let D=L/b,B=Math.exp(-D*D/2);v.push(B),L===0?w+=B:L<x&&(w+=2*B)}for(let L=0;L<v.length;L++)v[L]=v[L]/w;d.envMap.value=e.texture,d.samples.value=x,d.weights.value=v,d.latitudinal.value=o==="latitudinal",s&&(d.poleAxis.value=s);let{_lodMax:_}=this;d.dTheta.value=g,d.mipInt.value=_-r;let C=this._sizeLods[n],E=3*C*(n>_-jc?n-_+jc:0),T=4*(this._cubeSize-C);lf(t,E,T,3*C,2*C),l.setRenderTarget(t),l.render(p,b2)}};h(sW,"PMREMGenerator");var _6=sW;function lW(i){let e=[],t=[],r=[],n=i,a=i-jc+1+y6.length;for(let o=0;o<a;o++){let s=Math.pow(2,n);t.push(s);let l=1/s;o>i-jc?l=y6[o-i+jc-1]:o===0&&(l=0),r.push(l);let u=1/(s-2),c=-u,p=1+u,d=[c,c,p,c,p,p,c,c,p,p,c,p],m=6,g=6,b=3,x=2,v=1,w=new Float32Array(b*g*m),_=new Float32Array(x*g*m),C=new Float32Array(v*g*m);for(let T=0;T<m;T++){let L=T%3*2/3-1,D=T>2?0:-1,B=[L,D,0,L+2/3,D,0,L+2/3,D+1,0,L,D,0,L+2/3,D+1,0,L,D+1,0];w.set(B,b*g*T),_.set(d,x*g*T);let A=[T,T,T,T,T,T];C.set(A,v*g*T)}let E=new ma;E.setAttribute("position",new Br(w,b)),E.setAttribute("uv",new Br(_,x)),E.setAttribute("faceIndex",new Br(C,v)),e.push(E),n>jc&&n--}return{lodPlanes:e,sizeLods:t,sigmas:r}}h(lW,"_createPlanes");function _3(i,e,t){let r=new Qu(i,e,t);return r.texture.mapping=Ox,r.texture.name="PMREM.cubeUv",r.scissorTest=!0,r}h(_3,"_createRenderTarget");function lf(i,e,t,r,n){i.viewport.set(e,t,r,n),i.scissor.set(e,t,r,n)}h(lf,"_setViewport");function uW(i,e,t){let r=new Float32Array(wu),n=new le(0,1,0);return new xo({name:"SphericalGaussianBlur",defines:{n:wu,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${i}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:r},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:n}},vertexShader:Vx(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:Al,depthTest:!1,depthWrite:!1})}h(uW,"_getBlurShader");function b3(){return new xo({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:Vx(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:Al,depthTest:!1,depthWrite:!1})}h(b3,"_getEquirectMaterial");function w3(){return new xo({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:Vx(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:Al,depthTest:!1,depthWrite:!1})}h(w3,"_getCubemapMaterial");function Vx(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}h(Vx,"_getCommonVertexShader");function hW(i){let e=new WeakMap,t=null;function r(s){if(s&&s.isTexture){let l=s.mapping,u=l===f3||l===m3,c=l===Op||l===Np;if(u||c)if(s.isRenderTargetTexture&&s.needsPMREMUpdate===!0){s.needsPMREMUpdate=!1;let p=e.get(s);return t===null&&(t=new _6(i)),p=u?t.fromEquirectangular(s,p):t.fromCubemap(s,p),e.set(s,p),p.texture}else{if(e.has(s))return e.get(s).texture;{let p=s.image;if(u&&p&&p.height>0||c&&p&&n(p)){t===null&&(t=new _6(i));let d=u?t.fromEquirectangular(s):t.fromCubemap(s);return e.set(s,d),s.addEventListener("dispose",a),d.texture}else return null}}}return s}h(r,"get");function n(s){let l=0,u=6;for(let c=0;c<u;c++)s[c]!==void 0&&l++;return l===u}h(n,"isCubeTextureComplete");function a(s){let l=s.target;l.removeEventListener("dispose",a);let u=e.get(l);u!==void 0&&(e.delete(l),u.dispose())}h(a,"onTextureDispose");function o(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return h(o,"dispose"),{get:r,dispose:o}}h(hW,"WebGLCubeUVMaps");function cW(i){let e={};function t(r){if(e[r]!==void 0)return e[r];let n;switch(r){case"WEBGL_depth_texture":n=i.getExtension("WEBGL_depth_texture")||i.getExtension("MOZ_WEBGL_depth_texture")||i.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":n=i.getExtension("EXT_texture_filter_anisotropic")||i.getExtension("MOZ_EXT_texture_filter_anisotropic")||i.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":n=i.getExtension("WEBGL_compressed_texture_s3tc")||i.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||i.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":n=i.getExtension("WEBGL_compressed_texture_pvrtc")||i.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:n=i.getExtension(r)}return e[r]=n,n}return h(t,"getExtension"),{has:function(r){return t(r)!==null},init:function(r){r.isWebGL2?(t("EXT_color_buffer_float"),t("WEBGL_clip_cull_distance")):(t("WEBGL_depth_texture"),t("OES_texture_float"),t("OES_texture_half_float"),t("OES_texture_half_float_linear"),t("OES_standard_derivatives"),t("OES_element_index_uint"),t("OES_vertex_array_object"),t("ANGLE_instanced_arrays")),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture")},get:function(r){let n=t(r);return n===null&&console.warn("THREE.WebGLRenderer: "+r+" extension not supported."),n}}}h(cW,"WebGLExtensions");function pW(i,e,t,r){let n={},a=new WeakMap;function o(p){let d=p.target;d.index!==null&&e.remove(d.index);for(let g in d.attributes)e.remove(d.attributes[g]);for(let g in d.morphAttributes){let b=d.morphAttributes[g];for(let x=0,v=b.length;x<v;x++)e.remove(b[x])}d.removeEventListener("dispose",o),delete n[d.id];let m=a.get(d);m&&(e.remove(m),a.delete(d)),r.releaseStatesOfGeometry(d),d.isInstancedBufferGeometry===!0&&delete d._maxInstanceCount,t.memory.geometries--}h(o,"onGeometryDispose");function s(p,d){return n[d.id]===!0||(d.addEventListener("dispose",o),n[d.id]=!0,t.memory.geometries++),d}h(s,"get");function l(p){let d=p.attributes;for(let g in d)e.update(d[g],i.ARRAY_BUFFER);let m=p.morphAttributes;for(let g in m){let b=m[g];for(let x=0,v=b.length;x<v;x++)e.update(b[x],i.ARRAY_BUFFER)}}h(l,"update");function u(p){let d=[],m=p.index,g=p.attributes.position,b=0;if(m!==null){let w=m.array;b=m.version;for(let _=0,C=w.length;_<C;_+=3){let E=w[_+0],T=w[_+1],L=w[_+2];d.push(E,T,T,L,L,E)}}else if(g!==void 0){let w=g.array;b=g.version;for(let _=0,C=w.length/3-1;_<C;_+=3){let E=_+0,T=_+1,L=_+2;d.push(E,T,T,L,L,E)}}else return;let x=new(_E(d)?DG:IG)(d,1);x.version=b;let v=a.get(p);v&&e.remove(v),a.set(p,x)}h(u,"updateWireframeAttribute");function c(p){let d=a.get(p);if(d){let m=p.index;m!==null&&d.version<m.version&&u(p)}else u(p);return a.get(p)}return h(c,"getWireframeAttribute"),{get:s,update:l,getWireframeAttribute:c}}h(pW,"WebGLGeometries");function dW(i,e,t,r){let n=r.isWebGL2,a;function o(m){a=m}h(o,"setMode");let s,l;function u(m){s=m.type,l=m.bytesPerElement}h(u,"setIndex");function c(m,g){i.drawElements(a,g,s,m*l),t.update(g,a,1)}h(c,"render");function p(m,g,b){if(b===0)return;let x,v;if(n)x=i,v="drawElementsInstanced";else if(x=e.get("ANGLE_instanced_arrays"),v="drawElementsInstancedANGLE",x===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}x[v](a,g,s,m*l,b),t.update(g,a,b)}h(p,"renderInstances");function d(m,g,b){if(b===0)return;let x=e.get("WEBGL_multi_draw");if(x===null)for(let v=0;v<b;v++)this.render(m[v]/l,g[v]);else{x.multiDrawElementsWEBGL(a,g,0,s,m,0,b);let v=0;for(let w=0;w<b;w++)v+=g[w];t.update(v,a,1)}}h(d,"renderMultiDraw"),this.setMode=o,this.setIndex=u,this.render=c,this.renderInstances=p,this.renderMultiDraw=d}h(dW,"WebGLIndexedBufferRenderer");function fW(i){let e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function r(a,o,s){switch(t.calls++,o){case i.TRIANGLES:t.triangles+=s*(a/3);break;case i.LINES:t.lines+=s*(a/2);break;case i.LINE_STRIP:t.lines+=s*(a-1);break;case i.LINE_LOOP:t.lines+=s*a;break;case i.POINTS:t.points+=s*a;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o);break}}h(r,"update");function n(){t.calls=0,t.triangles=0,t.points=0,t.lines=0}return h(n,"reset"),{memory:e,render:t,programs:null,autoReset:!0,reset:n,update:r}}h(fW,"WebGLInfo");function mW(i,e){return i[0]-e[0]}h(mW,"numericalSort");function gW(i,e){return Math.abs(e[1])-Math.abs(i[1])}h(gW,"absNumericalSort");function yW(i,e,t){let r={},n=new Float32Array(8),a=new WeakMap,o=new Ei,s=[];for(let u=0;u<8;u++)s[u]=[u,0];function l(u,c,p){let d=u.morphTargetInfluences;if(e.isWebGL2===!0){let m=c.morphAttributes.position||c.morphAttributes.normal||c.morphAttributes.color,g=m!==void 0?m.length:0,b=a.get(c);if(b===void 0||b.count!==g){let x=function(){k.dispose(),a.delete(c),c.removeEventListener("dispose",x)};h(x,"disposeTexture"),b!==void 0&&b.texture.dispose();let v=c.morphAttributes.position!==void 0,w=c.morphAttributes.normal!==void 0,_=c.morphAttributes.color!==void 0,C=c.morphAttributes.position||[],E=c.morphAttributes.normal||[],T=c.morphAttributes.color||[],L=0;v===!0&&(L=1),w===!0&&(L=2),_===!0&&(L=3);let D=c.attributes.position.count*L,B=1;D>e.maxTextureSize&&(B=Math.ceil(D/e.maxTextureSize),D=e.maxTextureSize);let A=new Float32Array(D*B*4*g),k=new hG(A,D,B,g);k.type=na,k.needsUpdate=!0;let $=L*4;for(let O=0;O<g;O++){let P=C[O],U=E[O],G=T[O],K=D*B*4*O;for(let z=0;z<P.count;z++){let V=z*$;v===!0&&(o.fromBufferAttribute(P,z),A[K+V+0]=o.x,A[K+V+1]=o.y,A[K+V+2]=o.z,A[K+V+3]=0),w===!0&&(o.fromBufferAttribute(U,z),A[K+V+4]=o.x,A[K+V+5]=o.y,A[K+V+6]=o.z,A[K+V+7]=0),_===!0&&(o.fromBufferAttribute(G,z),A[K+V+8]=o.x,A[K+V+9]=o.y,A[K+V+10]=o.z,A[K+V+11]=G.itemSize===4?o.w:1)}}b={count:g,texture:k,size:new Oe(D,B)},a.set(c,b),c.addEventListener("dispose",x)}if(u.isInstancedMesh===!0&&u.morphTexture!==null)p.getUniforms().setValue(i,"morphTexture",u.morphTexture,t);else{let x=0;for(let w=0;w<d.length;w++)x+=d[w];let v=c.morphTargetsRelative?1:1-x;p.getUniforms().setValue(i,"morphTargetBaseInfluence",v),p.getUniforms().setValue(i,"morphTargetInfluences",d)}p.getUniforms().setValue(i,"morphTargetsTexture",b.texture,t),p.getUniforms().setValue(i,"morphTargetsTextureSize",b.size)}else{let m=d===void 0?0:d.length,g=r[c.id];if(g===void 0||g.length!==m){g=[];for(let _=0;_<m;_++)g[_]=[_,0];r[c.id]=g}for(let _=0;_<m;_++){let C=g[_];C[0]=_,C[1]=d[_]}g.sort(gW);for(let _=0;_<8;_++)_<m&&g[_][1]?(s[_][0]=g[_][0],s[_][1]=g[_][1]):(s[_][0]=Number.MAX_SAFE_INTEGER,s[_][1]=0);s.sort(mW);let b=c.morphAttributes.position,x=c.morphAttributes.normal,v=0;for(let _=0;_<8;_++){let C=s[_],E=C[0],T=C[1];E!==Number.MAX_SAFE_INTEGER&&T?(b&&c.getAttribute("morphTarget"+_)!==b[E]&&c.setAttribute("morphTarget"+_,b[E]),x&&c.getAttribute("morphNormal"+_)!==x[E]&&c.setAttribute("morphNormal"+_,x[E]),n[_]=T,v+=T):(b&&c.hasAttribute("morphTarget"+_)===!0&&c.deleteAttribute("morphTarget"+_),x&&c.hasAttribute("morphNormal"+_)===!0&&c.deleteAttribute("morphNormal"+_),n[_]=0)}let w=c.morphTargetsRelative?1:1-v;p.getUniforms().setValue(i,"morphTargetBaseInfluence",w),p.getUniforms().setValue(i,"morphTargetInfluences",n)}}return h(l,"update"),{update:l}}h(yW,"WebGLMorphtargets");function vW(i,e,t,r){let n=new WeakMap;function a(l){let u=r.render.frame,c=l.geometry,p=e.get(l,c);if(n.get(p)!==u&&(e.update(p),n.set(p,u)),l.isInstancedMesh&&(l.hasEventListener("dispose",s)===!1&&l.addEventListener("dispose",s),n.get(l)!==u&&(t.update(l.instanceMatrix,i.ARRAY_BUFFER),l.instanceColor!==null&&t.update(l.instanceColor,i.ARRAY_BUFFER),n.set(l,u))),l.isSkinnedMesh){let d=l.skeleton;n.get(d)!==u&&(d.update(),n.set(d,u))}return p}h(a,"update");function o(){n=new WeakMap}h(o,"dispose");function s(l){let u=l.target;u.removeEventListener("dispose",s),t.remove(u.instanceMatrix),u.instanceColor!==null&&t.remove(u.instanceColor)}return h(s,"onInstancedMeshDispose"),{update:a,dispose:o}}h(vW,"WebGLObjects");var xW=class extends En{constructor(e,t,r,n,a,o,s,l,u,c){if(c=c!==void 0?c:Bu,c!==Bu&&c!==$p)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");r===void 0&&c===Bu&&(r=yl),r===void 0&&c===$p&&(r=zu),super(null,n,a,o,s,l,c,r,u),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=s!==void 0?s:Xr,this.minFilter=l!==void 0?l:Xr,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){let t=super.toJSON(e);return this.compareFunction!==null&&(t.compareFunction=this.compareFunction),t}};h(xW,"DepthTexture");var _W=xW,bW=new En,wW=new _W(1,1);wW.compareFunction=kH;var SW=new hG,MW=new Xfe,CW=new WG,b6=[],w6=[],S6=new Float32Array(16),M6=new Float32Array(9),C6=new Float32Array(4);function fh(i,e,t){let r=i[0];if(r<=0||r>0)return i;let n=e*t,a=b6[n];if(a===void 0&&(a=new Float32Array(n),b6[n]=a),e!==0){r.toArray(a,0);for(let o=1,s=0;o!==e;++o)s+=t,i[o].toArray(a,s)}return a}h(fh,"flatten");function Ar(i,e){if(i.length!==e.length)return!1;for(let t=0,r=i.length;t<r;t++)if(i[t]!==e[t])return!1;return!0}h(Ar,"arraysEqual");function Ir(i,e){for(let t=0,r=e.length;t<r;t++)i[t]=e[t]}h(Ir,"copyArray");function ng(i,e){let t=w6[e];t===void 0&&(t=new Int32Array(e),w6[e]=t);for(let r=0;r!==e;++r)t[r]=i.allocateTextureUnit();return t}h(ng,"allocTexUnits");function EW(i,e){let t=this.cache;t[0]!==e&&(i.uniform1f(this.addr,e),t[0]=e)}h(EW,"setValueV1f");function TW(i,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Ar(t,e))return;i.uniform2fv(this.addr,e),Ir(t,e)}}h(TW,"setValueV2f");function PW(i,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(i.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(Ar(t,e))return;i.uniform3fv(this.addr,e),Ir(t,e)}}h(PW,"setValueV3f");function AW(i,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Ar(t,e))return;i.uniform4fv(this.addr,e),Ir(t,e)}}h(AW,"setValueV4f");function IW(i,e){let t=this.cache,r=e.elements;if(r===void 0){if(Ar(t,e))return;i.uniformMatrix2fv(this.addr,!1,e),Ir(t,e)}else{if(Ar(t,r))return;C6.set(r),i.uniformMatrix2fv(this.addr,!1,C6),Ir(t,r)}}h(IW,"setValueM2");function LW(i,e){let t=this.cache,r=e.elements;if(r===void 0){if(Ar(t,e))return;i.uniformMatrix3fv(this.addr,!1,e),Ir(t,e)}else{if(Ar(t,r))return;M6.set(r),i.uniformMatrix3fv(this.addr,!1,M6),Ir(t,r)}}h(LW,"setValueM3");function DW(i,e){let t=this.cache,r=e.elements;if(r===void 0){if(Ar(t,e))return;i.uniformMatrix4fv(this.addr,!1,e),Ir(t,e)}else{if(Ar(t,r))return;S6.set(r),i.uniformMatrix4fv(this.addr,!1,S6),Ir(t,r)}}h(DW,"setValueM4");function kW(i,e){let t=this.cache;t[0]!==e&&(i.uniform1i(this.addr,e),t[0]=e)}h(kW,"setValueV1i");function RW(i,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Ar(t,e))return;i.uniform2iv(this.addr,e),Ir(t,e)}}h(RW,"setValueV2i");function FW(i,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Ar(t,e))return;i.uniform3iv(this.addr,e),Ir(t,e)}}h(FW,"setValueV3i");function zW(i,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Ar(t,e))return;i.uniform4iv(this.addr,e),Ir(t,e)}}h(zW,"setValueV4i");function BW(i,e){let t=this.cache;t[0]!==e&&(i.uniform1ui(this.addr,e),t[0]=e)}h(BW,"setValueV1ui");function OW(i,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Ar(t,e))return;i.uniform2uiv(this.addr,e),Ir(t,e)}}h(OW,"setValueV2ui");function NW(i,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Ar(t,e))return;i.uniform3uiv(this.addr,e),Ir(t,e)}}h(NW,"setValueV3ui");function $W(i,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Ar(t,e))return;i.uniform4uiv(this.addr,e),Ir(t,e)}}h($W,"setValueV4ui");function UW(i,e,t){let r=this.cache,n=t.allocateTextureUnit();r[0]!==n&&(i.uniform1i(this.addr,n),r[0]=n);let a=this.type===i.SAMPLER_2D_SHADOW?wW:bW;t.setTexture2D(e||a,n)}h(UW,"setValueT1");function VW(i,e,t){let r=this.cache,n=t.allocateTextureUnit();r[0]!==n&&(i.uniform1i(this.addr,n),r[0]=n),t.setTexture3D(e||MW,n)}h(VW,"setValueT3D1");function jW(i,e,t){let r=this.cache,n=t.allocateTextureUnit();r[0]!==n&&(i.uniform1i(this.addr,n),r[0]=n),t.setTextureCube(e||CW,n)}h(jW,"setValueT6");function HW(i,e,t){let r=this.cache,n=t.allocateTextureUnit();r[0]!==n&&(i.uniform1i(this.addr,n),r[0]=n),t.setTexture2DArray(e||SW,n)}h(HW,"setValueT2DArray1");function GW(i){switch(i){case 5126:return EW;case 35664:return TW;case 35665:return PW;case 35666:return AW;case 35674:return IW;case 35675:return LW;case 35676:return DW;case 5124:case 35670:return kW;case 35667:case 35671:return RW;case 35668:case 35672:return FW;case 35669:case 35673:return zW;case 5125:return BW;case 36294:return OW;case 36295:return NW;case 36296:return $W;case 35678:case 36198:case 36298:case 36306:case 35682:return UW;case 35679:case 36299:case 36307:return VW;case 35680:case 36300:case 36308:case 36293:return jW;case 36289:case 36303:case 36311:case 36292:return HW}}h(GW,"getSingularSetter");function WW(i,e){i.uniform1fv(this.addr,e)}h(WW,"setValueV1fArray");function XW(i,e){let t=fh(e,this.size,2);i.uniform2fv(this.addr,t)}h(XW,"setValueV2fArray");function qW(i,e){let t=fh(e,this.size,3);i.uniform3fv(this.addr,t)}h(qW,"setValueV3fArray");function ZW(i,e){let t=fh(e,this.size,4);i.uniform4fv(this.addr,t)}h(ZW,"setValueV4fArray");function YW(i,e){let t=fh(e,this.size,4);i.uniformMatrix2fv(this.addr,!1,t)}h(YW,"setValueM2Array");function JW(i,e){let t=fh(e,this.size,9);i.uniformMatrix3fv(this.addr,!1,t)}h(JW,"setValueM3Array");function KW(i,e){let t=fh(e,this.size,16);i.uniformMatrix4fv(this.addr,!1,t)}h(KW,"setValueM4Array");function QW(i,e){i.uniform1iv(this.addr,e)}h(QW,"setValueV1iArray");function eX(i,e){i.uniform2iv(this.addr,e)}h(eX,"setValueV2iArray");function tX(i,e){i.uniform3iv(this.addr,e)}h(tX,"setValueV3iArray");function iX(i,e){i.uniform4iv(this.addr,e)}h(iX,"setValueV4iArray");function rX(i,e){i.uniform1uiv(this.addr,e)}h(rX,"setValueV1uiArray");function nX(i,e){i.uniform2uiv(this.addr,e)}h(nX,"setValueV2uiArray");function aX(i,e){i.uniform3uiv(this.addr,e)}h(aX,"setValueV3uiArray");function oX(i,e){i.uniform4uiv(this.addr,e)}h(oX,"setValueV4uiArray");function sX(i,e,t){let r=this.cache,n=e.length,a=ng(t,n);Ar(r,a)||(i.uniform1iv(this.addr,a),Ir(r,a));for(let o=0;o!==n;++o)t.setTexture2D(e[o]||bW,a[o])}h(sX,"setValueT1Array");function lX(i,e,t){let r=this.cache,n=e.length,a=ng(t,n);Ar(r,a)||(i.uniform1iv(this.addr,a),Ir(r,a));for(let o=0;o!==n;++o)t.setTexture3D(e[o]||MW,a[o])}h(lX,"setValueT3DArray");function uX(i,e,t){let r=this.cache,n=e.length,a=ng(t,n);Ar(r,a)||(i.uniform1iv(this.addr,a),Ir(r,a));for(let o=0;o!==n;++o)t.setTextureCube(e[o]||CW,a[o])}h(uX,"setValueT6Array");function hX(i,e,t){let r=this.cache,n=e.length,a=ng(t,n);Ar(r,a)||(i.uniform1iv(this.addr,a),Ir(r,a));for(let o=0;o!==n;++o)t.setTexture2DArray(e[o]||SW,a[o])}h(hX,"setValueT2DArrayArray");function cX(i){switch(i){case 5126:return WW;case 35664:return XW;case 35665:return qW;case 35666:return ZW;case 35674:return YW;case 35675:return JW;case 35676:return KW;case 5124:case 35670:return QW;case 35667:case 35671:return eX;case 35668:case 35672:return tX;case 35669:case 35673:return iX;case 5125:return rX;case 36294:return nX;case 36295:return aX;case 36296:return oX;case 35678:case 36198:case 36298:case 36306:case 35682:return sX;case 35679:case 36299:case 36307:return lX;case 35680:case 36300:case 36308:case 36293:return uX;case 36289:case 36303:case 36311:case 36292:return hX}}h(cX,"getPureArraySetter");var pX=class{constructor(e,t,r){this.id=e,this.addr=r,this.cache=[],this.type=t.type,this.setValue=GW(t.type)}};h(pX,"SingleUniform");var W1e=pX,dX=class{constructor(e,t,r){this.id=e,this.addr=r,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=cX(t.type)}};h(dX,"PureArrayUniform");var X1e=dX,fX=class{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,r){let n=this.seq;for(let a=0,o=n.length;a!==o;++a){let s=n[a];s.setValue(e,t[s.id],r)}}};h(fX,"StructuredUniform");var q1e=fX,C2=/(\w+)(\])?(\[|\.)?/g;function S3(i,e){i.seq.push(e),i.map[e.id]=e}h(S3,"addUniform");function mX(i,e,t){let r=i.name,n=r.length;for(C2.lastIndex=0;;){let a=C2.exec(r),o=C2.lastIndex,s=a[1],l=a[2]==="]",u=a[3];if(l&&(s=s|0),u===void 0||u==="["&&o+2===n){S3(t,u===void 0?new W1e(s,i,e):new X1e(s,i,e));break}else{let c=t.map[s];c===void 0&&(c=new q1e(s),S3(t,c)),t=c}}}h(mX,"parseUniform");var gX=class{constructor(e,t){this.seq=[],this.map={};let r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let n=0;n<r;++n){let a=e.getActiveUniform(t,n),o=e.getUniformLocation(t,a.name);mX(a,o,this)}}setValue(e,t,r,n){let a=this.map[t];a!==void 0&&a.setValue(e,r,n)}setOptional(e,t,r){let n=t[r];n!==void 0&&this.setValue(e,r,n)}static upload(e,t,r,n){for(let a=0,o=t.length;a!==o;++a){let s=t[a],l=r[s.id];l.needsUpdate!==!1&&s.setValue(e,l.value,n)}}static seqWithValue(e,t){let r=[];for(let n=0,a=e.length;n!==a;++n){let o=e[n];o.id in t&&r.push(o)}return r}};h(gX,"WebGLUniforms");var My=gX;function M3(i,e,t){let r=i.createShader(e);return i.shaderSource(r,t),i.compileShader(r),r}h(M3,"WebGLShader");var Z1e=37297,Y1e=0;function yX(i,e){let t=i.split(`
`),r=[],n=Math.max(e-6,0),a=Math.min(e+6,t.length);for(let o=n;o<a;o++){let s=o+1;r.push(`${s===e?">":" "} ${s}: ${t[o]}`)}return r.join(`
`)}h(yX,"handleSource");function vX(i){let e=Si.getPrimaries(Si.workingColorSpace),t=Si.getPrimaries(i),r;switch(e===t?r="":e===_v&&t===xv?r="LinearDisplayP3ToLinearSRGB":e===xv&&t===_v&&(r="LinearSRGBToLinearDisplayP3"),i){case Gl:case Nx:return[r,"LinearTransferOETF"];case zn:case xE:return[r,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",i),[r,"LinearTransferOETF"]}}h(vX,"getEncodingComponents");function C3(i,e,t){let r=i.getShaderParameter(e,i.COMPILE_STATUS),n=i.getShaderInfoLog(e).trim();if(r&&n==="")return"";let a=/ERROR: 0:(\d+)/.exec(n);if(a){let o=parseInt(a[1]);return t.toUpperCase()+`

`+n+`

`+yX(i.getShaderSource(e),o)}else return n}h(C3,"getShaderErrors");function xX(i,e){let t=vX(e);return`vec4 ${i}( vec4 value ) { return ${t[0]}( ${t[1]}( value ) ); }`}h(xX,"getTexelEncodingFunction");function _X(i,e){let t;switch(e){case mfe:t="Linear";break;case gfe:t="Reinhard";break;case yfe:t="OptimizedCineon";break;case vfe:t="ACESFilmic";break;case _fe:t="AgX";break;case bfe:t="Neutral";break;case xfe:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+i+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}h(_X,"getToneMappingFunction");function bX(i){return[i.extensionDerivatives||i.envMapCubeUVHeight||i.bumpMap||i.normalMapTangentSpace||i.clearcoatNormalMap||i.flatShading||i.alphaToCoverage||i.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(i.extensionFragDepth||i.logarithmicDepthBuffer)&&i.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",i.extensionDrawBuffers&&i.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(i.extensionShaderTextureLOD||i.envMap||i.transmission)&&i.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Au).join(`
`)}h(bX,"generateExtensions");function wX(i){return[i.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",i.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(Au).join(`
`)}h(wX,"generateVertexExtensions");function SX(i){let e=[];for(let t in i){let r=i[t];r!==!1&&e.push("#define "+t+" "+r)}return e.join(`
`)}h(SX,"generateDefines");function MX(i,e){let t={},r=i.getProgramParameter(e,i.ACTIVE_ATTRIBUTES);for(let n=0;n<r;n++){let a=i.getActiveAttrib(e,n),o=a.name,s=1;a.type===i.FLOAT_MAT2&&(s=2),a.type===i.FLOAT_MAT3&&(s=3),a.type===i.FLOAT_MAT4&&(s=4),t[o]={type:a.type,location:i.getAttribLocation(e,o),locationSize:s}}return t}h(MX,"fetchAttributeLocations");function Au(i){return i!==""}h(Au,"filterEmptyLine");function E3(i,e){let t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return i.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}h(E3,"replaceLightNums");function T3(i,e){return i.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}h(T3,"replaceClippingPlaneNums");var J1e=/^[ \t]*#include +<([\w\d./]+)>/gm;function Sv(i){return i.replace(J1e,CX)}h(Sv,"resolveIncludes");var K1e=new Map([["encodings_fragment","colorspace_fragment"],["encodings_pars_fragment","colorspace_pars_fragment"],["output_fragment","opaque_fragment"]]);function CX(i,e){let t=Yt[e];if(t===void 0){let r=K1e.get(e);if(r!==void 0)t=Yt[r],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,r);else throw new Error("Can not resolve #include <"+e+">")}return Sv(t)}h(CX,"includeReplacer");var Q1e=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function P3(i){return i.replace(Q1e,EX)}h(P3,"unrollLoops");function EX(i,e,t,r){let n="";for(let a=parseInt(e);a<parseInt(t);a++)n+=r.replace(/\[\s*i\s*\]/g,"[ "+a+" ]").replace(/UNROLLED_LOOP_INDEX/g,a);return n}h(EX,"loopReplacer");function A3(i){let e=`precision ${i.precision} float;
	precision ${i.precision} int;
	precision ${i.precision} sampler2D;
	precision ${i.precision} samplerCube;
	`;return i.isWebGL2&&(e+=`precision ${i.precision} sampler3D;
		precision ${i.precision} sampler2DArray;
		precision ${i.precision} sampler2DShadow;
		precision ${i.precision} samplerCubeShadow;
		precision ${i.precision} sampler2DArrayShadow;
		precision ${i.precision} isampler2D;
		precision ${i.precision} isampler3D;
		precision ${i.precision} isamplerCube;
		precision ${i.precision} isampler2DArray;
		precision ${i.precision} usampler2D;
		precision ${i.precision} usampler3D;
		precision ${i.precision} usamplerCube;
		precision ${i.precision} usampler2DArray;
		`),i.precision==="highp"?e+=`
#define HIGH_PRECISION`:i.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:i.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}h(A3,"generatePrecision");function TX(i){let e="SHADOWMAP_TYPE_BASIC";return i.shadowMapType===SH?e="SHADOWMAP_TYPE_PCF":i.shadowMapType===jde?e="SHADOWMAP_TYPE_PCF_SOFT":i.shadowMapType===ss&&(e="SHADOWMAP_TYPE_VSM"),e}h(TX,"generateShadowMapTypeDefine");function PX(i){let e="ENVMAP_TYPE_CUBE";if(i.envMap)switch(i.envMapMode){case Op:case Np:e="ENVMAP_TYPE_CUBE";break;case Ox:e="ENVMAP_TYPE_CUBE_UV";break}return e}h(PX,"generateEnvMapTypeDefine");function AX(i){let e="ENVMAP_MODE_REFLECTION";if(i.envMap)switch(i.envMapMode){case Np:e="ENVMAP_MODE_REFRACTION";break}return e}h(AX,"generateEnvMapModeDefine");function IX(i){let e="ENVMAP_BLENDING_NONE";if(i.envMap)switch(i.combine){case gE:e="ENVMAP_BLENDING_MULTIPLY";break;case dfe:e="ENVMAP_BLENDING_MIX";break;case ffe:e="ENVMAP_BLENDING_ADD";break}return e}h(IX,"generateEnvMapBlendingDefine");function LX(i){let e=i.envMapCubeUVHeight;if(e===null)return null;let t=Math.log2(e)-2,r=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),7*16)),texelHeight:r,maxMip:t}}h(LX,"generateCubeUVSize");function DX(i,e,t,r){let n=i.getContext(),a=t.defines,o=t.vertexShader,s=t.fragmentShader,l=TX(t),u=PX(t),c=AX(t),p=IX(t),d=LX(t),m=t.isWebGL2?"":bX(t),g=wX(t),b=SX(a),x=n.createProgram(),v,w,_=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(v=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,b].filter(Au).join(`
`),v.length>0&&(v+=`
`),w=[m,"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,b].filter(Au).join(`
`),w.length>0&&(w+=`
`)):(v=[A3(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,b,t.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",t.batching?"#define USE_BATCHING":"",t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.instancingMorph?"#define USE_INSTANCING_MORPH":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+c:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphColors&&t.isWebGL2?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(Au).join(`
`),w=[m,A3(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,b,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+u:"",t.envMap?"#define "+c:"",t.envMap?"#define "+p:"",d?"#define CUBEUV_TEXEL_WIDTH "+d.texelWidth:"",d?"#define CUBEUV_TEXEL_HEIGHT "+d.texelHeight:"",d?"#define CUBEUV_MAX_MIP "+d.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==Il?"#define TONE_MAPPING":"",t.toneMapping!==Il?Yt.tonemapping_pars_fragment:"",t.toneMapping!==Il?_X("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",Yt.colorspace_pars_fragment,xX("linearToOutputTexel",t.outputColorSpace),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(Au).join(`
`)),o=Sv(o),o=E3(o,t),o=T3(o,t),s=Sv(s),s=E3(s,t),s=T3(s,t),o=P3(o),s=P3(s),t.isWebGL2&&t.isRawShaderMaterial!==!0&&(_=`#version 300 es
`,v=[g,"precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+v,w=["precision mediump sampler2DArray;","#define varying in",t.glslVersion===JA?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===JA?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+w);let C=_+v+o,E=_+w+s,T=M3(n,n.VERTEX_SHADER,C),L=M3(n,n.FRAGMENT_SHADER,E);n.attachShader(x,T),n.attachShader(x,L),t.index0AttributeName!==void 0?n.bindAttribLocation(x,0,t.index0AttributeName):t.morphTargets===!0&&n.bindAttribLocation(x,0,"position"),n.linkProgram(x);function D($){if(i.debug.checkShaderErrors){let O=n.getProgramInfoLog(x).trim(),P=n.getShaderInfoLog(T).trim(),U=n.getShaderInfoLog(L).trim(),G=!0,K=!0;if(n.getProgramParameter(x,n.LINK_STATUS)===!1)if(G=!1,typeof i.debug.onShaderError=="function")i.debug.onShaderError(n,x,T,L);else{let z=C3(n,T,"vertex"),V=C3(n,L,"fragment");console.error("THREE.WebGLProgram: Shader Error "+n.getError()+" - VALIDATE_STATUS "+n.getProgramParameter(x,n.VALIDATE_STATUS)+`

Material Name: `+$.name+`
Material Type: `+$.type+`

Program Info Log: `+O+`
`+z+`
`+V)}else O!==""?console.warn("THREE.WebGLProgram: Program Info Log:",O):(P===""||U==="")&&(K=!1);K&&($.diagnostics={runnable:G,programLog:O,vertexShader:{log:P,prefix:v},fragmentShader:{log:U,prefix:w}})}n.deleteShader(T),n.deleteShader(L),B=new My(n,x),A=MX(n,x)}h(D,"onFirstUse");let B;this.getUniforms=function(){return B===void 0&&D(this),B};let A;this.getAttributes=function(){return A===void 0&&D(this),A};let k=t.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return k===!1&&(k=n.getProgramParameter(x,Z1e)),k},this.destroy=function(){r.releaseStatesOfProgram(this),n.deleteProgram(x),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=Y1e++,this.cacheKey=e,this.usedTimes=1,this.program=x,this.vertexShader=T,this.fragmentShader=L,this}h(DX,"WebGLProgram");var eye=0,kX=class{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){let t=e.vertexShader,r=e.fragmentShader,n=this._getShaderStage(t),a=this._getShaderStage(r),o=this._getShaderCacheForMaterial(e);return o.has(n)===!1&&(o.add(n),n.usedTimes++),o.has(a)===!1&&(o.add(a),a.usedTimes++),this}remove(e){let t=this.materialCache.get(e);for(let r of t)r.usedTimes--,r.usedTimes===0&&this.shaderCache.delete(r.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){let t=this.materialCache,r=t.get(e);return r===void 0&&(r=new Set,t.set(e,r)),r}_getShaderStage(e){let t=this.shaderCache,r=t.get(e);return r===void 0&&(r=new iye(e),t.set(e,r)),r}};h(kX,"WebGLShaderCache");var tye=kX,RX=class{constructor(e){this.id=eye++,this.code=e,this.usedTimes=0}};h(RX,"WebGLShaderStage");var iye=RX;function FX(i,e,t,r,n,a,o){let s=new wE,l=new tye,u=new Set,c=[],p=n.isWebGL2,d=n.logarithmicDepthBuffer,m=n.vertexTextures,g=n.precision,b={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function x(A){return u.add(A),A===0?"uv":`uv${A}`}h(x,"getChannel");function v(A,k,$,O,P){let U=O.fog,G=P.geometry,K=A.isMeshStandardMaterial?O.environment:null,z=(A.isMeshStandardMaterial?t:e).get(A.envMap||K),V=z&&z.mapping===Ox?z.image.height:null,j=b[A.type];A.precision!==null&&(g=n.getMaxPrecision(A.precision),g!==A.precision&&console.warn("THREE.WebGLProgram.getParameters:",A.precision,"not supported, using",g,"instead."));let q=G.morphAttributes.position||G.morphAttributes.normal||G.morphAttributes.color,ee=q!==void 0?q.length:0,ae=0;G.morphAttributes.position!==void 0&&(ae=1),G.morphAttributes.normal!==void 0&&(ae=2),G.morphAttributes.color!==void 0&&(ae=3);let N,J,Y,oe;if(j){let Nt=Fo[j];N=Nt.vertexShader,J=Nt.fragmentShader}else N=A.vertexShader,J=A.fragmentShader,l.update(A),Y=l.getVertexShaderID(A),oe=l.getFragmentShaderID(A);let xe=i.getRenderTarget(),ge=P.isInstancedMesh===!0,Te=P.isBatchedMesh===!0,me=!!A.map,Q=!!A.matcap,Me=!!z,ve=!!A.aoMap,Ie=!!A.lightMap,De=!!A.bumpMap,we=!!A.normalMap,Fe=!!A.displacementMap,Ze=!!A.emissiveMap,yt=!!A.metalnessMap,ne=!!A.roughnessMap,W=A.anisotropy>0,_e=A.clearcoat>0,Re=A.iridescence>0,Ne=A.sheen>0,ze=A.transmission>0,xt=W&&!!A.anisotropyMap,ot=_e&&!!A.clearcoatMap,je=_e&&!!A.clearcoatNormalMap,He=_e&&!!A.clearcoatRoughnessMap,bt=Re&&!!A.iridescenceMap,Xe=Re&&!!A.iridescenceThicknessMap,ti=Ne&&!!A.sheenColorMap,At=Ne&&!!A.sheenRoughnessMap,ue=!!A.specularMap,he=!!A.specularColorMap,We=!!A.specularIntensityMap,pt=ze&&!!A.transmissionMap,ut=ze&&!!A.thicknessMap,ct=!!A.gradientMap,ce=!!A.alphaMap,et=A.alphaTest>0,be=!!A.alphaHash,Ge=!!A.extensions,tt=Il;A.toneMapped&&(xe===null||xe.isXRRenderTarget===!0)&&(tt=i.toneMapping);let Ht={isWebGL2:p,shaderID:j,shaderType:A.type,shaderName:A.name,vertexShader:N,fragmentShader:J,defines:A.defines,customVertexShaderID:Y,customFragmentShaderID:oe,isRawShaderMaterial:A.isRawShaderMaterial===!0,glslVersion:A.glslVersion,precision:g,batching:Te,instancing:ge,instancingColor:ge&&P.instanceColor!==null,instancingMorph:ge&&P.morphTexture!==null,supportsVertexTextures:m,outputColorSpace:xe===null?i.outputColorSpace:xe.isXRRenderTarget===!0?xe.texture.colorSpace:Gl,alphaToCoverage:!!A.alphaToCoverage,map:me,matcap:Q,envMap:Me,envMapMode:Me&&z.mapping,envMapCubeUVHeight:V,aoMap:ve,lightMap:Ie,bumpMap:De,normalMap:we,displacementMap:m&&Fe,emissiveMap:Ze,normalMapObjectSpace:we&&A.normalMapType===Ffe,normalMapTangentSpace:we&&A.normalMapType===vE,metalnessMap:yt,roughnessMap:ne,anisotropy:W,anisotropyMap:xt,clearcoat:_e,clearcoatMap:ot,clearcoatNormalMap:je,clearcoatRoughnessMap:He,iridescence:Re,iridescenceMap:bt,iridescenceThicknessMap:Xe,sheen:Ne,sheenColorMap:ti,sheenRoughnessMap:At,specularMap:ue,specularColorMap:he,specularIntensityMap:We,transmission:ze,transmissionMap:pt,thicknessMap:ut,gradientMap:ct,opaque:A.transparent===!1&&A.blending===pp&&A.alphaToCoverage===!1,alphaMap:ce,alphaTest:et,alphaHash:be,combine:A.combine,mapUv:me&&x(A.map.channel),aoMapUv:ve&&x(A.aoMap.channel),lightMapUv:Ie&&x(A.lightMap.channel),bumpMapUv:De&&x(A.bumpMap.channel),normalMapUv:we&&x(A.normalMap.channel),displacementMapUv:Fe&&x(A.displacementMap.channel),emissiveMapUv:Ze&&x(A.emissiveMap.channel),metalnessMapUv:yt&&x(A.metalnessMap.channel),roughnessMapUv:ne&&x(A.roughnessMap.channel),anisotropyMapUv:xt&&x(A.anisotropyMap.channel),clearcoatMapUv:ot&&x(A.clearcoatMap.channel),clearcoatNormalMapUv:je&&x(A.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:He&&x(A.clearcoatRoughnessMap.channel),iridescenceMapUv:bt&&x(A.iridescenceMap.channel),iridescenceThicknessMapUv:Xe&&x(A.iridescenceThicknessMap.channel),sheenColorMapUv:ti&&x(A.sheenColorMap.channel),sheenRoughnessMapUv:At&&x(A.sheenRoughnessMap.channel),specularMapUv:ue&&x(A.specularMap.channel),specularColorMapUv:he&&x(A.specularColorMap.channel),specularIntensityMapUv:We&&x(A.specularIntensityMap.channel),transmissionMapUv:pt&&x(A.transmissionMap.channel),thicknessMapUv:ut&&x(A.thicknessMap.channel),alphaMapUv:ce&&x(A.alphaMap.channel),vertexTangents:!!G.attributes.tangent&&(we||W),vertexColors:A.vertexColors,vertexAlphas:A.vertexColors===!0&&!!G.attributes.color&&G.attributes.color.itemSize===4,pointsUvs:P.isPoints===!0&&!!G.attributes.uv&&(me||ce),fog:!!U,useFog:A.fog===!0,fogExp2:!!U&&U.isFogExp2,flatShading:A.flatShading===!0,sizeAttenuation:A.sizeAttenuation===!0,logarithmicDepthBuffer:d,skinning:P.isSkinnedMesh===!0,morphTargets:G.morphAttributes.position!==void 0,morphNormals:G.morphAttributes.normal!==void 0,morphColors:G.morphAttributes.color!==void 0,morphTargetsCount:ee,morphTextureStride:ae,numDirLights:k.directional.length,numPointLights:k.point.length,numSpotLights:k.spot.length,numSpotLightMaps:k.spotLightMap.length,numRectAreaLights:k.rectArea.length,numHemiLights:k.hemi.length,numDirLightShadows:k.directionalShadowMap.length,numPointLightShadows:k.pointShadowMap.length,numSpotLightShadows:k.spotShadowMap.length,numSpotLightShadowsWithMaps:k.numSpotLightShadowsWithMaps,numLightProbes:k.numLightProbes,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:A.dithering,shadowMapEnabled:i.shadowMap.enabled&&$.length>0,shadowMapType:i.shadowMap.type,toneMapping:tt,useLegacyLights:i._useLegacyLights,decodeVideoTexture:me&&A.map.isVideoTexture===!0&&Si.getTransfer(A.map.colorSpace)===Di,premultipliedAlpha:A.premultipliedAlpha,doubleSided:A.side===Da,flipSided:A.side===Wn,useDepthPacking:A.depthPacking>=0,depthPacking:A.depthPacking||0,index0AttributeName:A.index0AttributeName,extensionDerivatives:Ge&&A.extensions.derivatives===!0,extensionFragDepth:Ge&&A.extensions.fragDepth===!0,extensionDrawBuffers:Ge&&A.extensions.drawBuffers===!0,extensionShaderTextureLOD:Ge&&A.extensions.shaderTextureLOD===!0,extensionClipCullDistance:Ge&&A.extensions.clipCullDistance===!0&&r.has("WEBGL_clip_cull_distance"),extensionMultiDraw:Ge&&A.extensions.multiDraw===!0&&r.has("WEBGL_multi_draw"),rendererExtensionFragDepth:p||r.has("EXT_frag_depth"),rendererExtensionDrawBuffers:p||r.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:p||r.has("EXT_shader_texture_lod"),rendererExtensionParallelShaderCompile:r.has("KHR_parallel_shader_compile"),customProgramCacheKey:A.customProgramCacheKey()};return Ht.vertexUv1s=u.has(1),Ht.vertexUv2s=u.has(2),Ht.vertexUv3s=u.has(3),u.clear(),Ht}h(v,"getParameters");function w(A){let k=[];if(A.shaderID?k.push(A.shaderID):(k.push(A.customVertexShaderID),k.push(A.customFragmentShaderID)),A.defines!==void 0)for(let $ in A.defines)k.push($),k.push(A.defines[$]);return A.isRawShaderMaterial===!1&&(_(k,A),C(k,A),k.push(i.outputColorSpace)),k.push(A.customProgramCacheKey),k.join()}h(w,"getProgramCacheKey");function _(A,k){A.push(k.precision),A.push(k.outputColorSpace),A.push(k.envMapMode),A.push(k.envMapCubeUVHeight),A.push(k.mapUv),A.push(k.alphaMapUv),A.push(k.lightMapUv),A.push(k.aoMapUv),A.push(k.bumpMapUv),A.push(k.normalMapUv),A.push(k.displacementMapUv),A.push(k.emissiveMapUv),A.push(k.metalnessMapUv),A.push(k.roughnessMapUv),A.push(k.anisotropyMapUv),A.push(k.clearcoatMapUv),A.push(k.clearcoatNormalMapUv),A.push(k.clearcoatRoughnessMapUv),A.push(k.iridescenceMapUv),A.push(k.iridescenceThicknessMapUv),A.push(k.sheenColorMapUv),A.push(k.sheenRoughnessMapUv),A.push(k.specularMapUv),A.push(k.specularColorMapUv),A.push(k.specularIntensityMapUv),A.push(k.transmissionMapUv),A.push(k.thicknessMapUv),A.push(k.combine),A.push(k.fogExp2),A.push(k.sizeAttenuation),A.push(k.morphTargetsCount),A.push(k.morphAttributeCount),A.push(k.numDirLights),A.push(k.numPointLights),A.push(k.numSpotLights),A.push(k.numSpotLightMaps),A.push(k.numHemiLights),A.push(k.numRectAreaLights),A.push(k.numDirLightShadows),A.push(k.numPointLightShadows),A.push(k.numSpotLightShadows),A.push(k.numSpotLightShadowsWithMaps),A.push(k.numLightProbes),A.push(k.shadowMapType),A.push(k.toneMapping),A.push(k.numClippingPlanes),A.push(k.numClipIntersection),A.push(k.depthPacking)}h(_,"getProgramCacheKeyParameters");function C(A,k){s.disableAll(),k.isWebGL2&&s.enable(0),k.supportsVertexTextures&&s.enable(1),k.instancing&&s.enable(2),k.instancingColor&&s.enable(3),k.instancingMorph&&s.enable(4),k.matcap&&s.enable(5),k.envMap&&s.enable(6),k.normalMapObjectSpace&&s.enable(7),k.normalMapTangentSpace&&s.enable(8),k.clearcoat&&s.enable(9),k.iridescence&&s.enable(10),k.alphaTest&&s.enable(11),k.vertexColors&&s.enable(12),k.vertexAlphas&&s.enable(13),k.vertexUv1s&&s.enable(14),k.vertexUv2s&&s.enable(15),k.vertexUv3s&&s.enable(16),k.vertexTangents&&s.enable(17),k.anisotropy&&s.enable(18),k.alphaHash&&s.enable(19),k.batching&&s.enable(20),A.push(s.mask),s.disableAll(),k.fog&&s.enable(0),k.useFog&&s.enable(1),k.flatShading&&s.enable(2),k.logarithmicDepthBuffer&&s.enable(3),k.skinning&&s.enable(4),k.morphTargets&&s.enable(5),k.morphNormals&&s.enable(6),k.morphColors&&s.enable(7),k.premultipliedAlpha&&s.enable(8),k.shadowMapEnabled&&s.enable(9),k.useLegacyLights&&s.enable(10),k.doubleSided&&s.enable(11),k.flipSided&&s.enable(12),k.useDepthPacking&&s.enable(13),k.dithering&&s.enable(14),k.transmission&&s.enable(15),k.sheen&&s.enable(16),k.opaque&&s.enable(17),k.pointsUvs&&s.enable(18),k.decodeVideoTexture&&s.enable(19),k.alphaToCoverage&&s.enable(20),A.push(s.mask)}h(C,"getProgramCacheKeyBooleans");function E(A){let k=b[A.type],$;if(k){let O=Fo[k];$=nme.clone(O.uniforms)}else $=A.uniforms;return $}h(E,"getUniforms");function T(A,k){let $;for(let O=0,P=c.length;O<P;O++){let U=c[O];if(U.cacheKey===k){$=U,++$.usedTimes;break}}return $===void 0&&($=new DX(i,k,A,a),c.push($)),$}h(T,"acquireProgram");function L(A){if(--A.usedTimes===0){let k=c.indexOf(A);c[k]=c[c.length-1],c.pop(),A.destroy()}}h(L,"releaseProgram");function D(A){l.remove(A)}h(D,"releaseShaderCache");function B(){l.dispose()}return h(B,"dispose"),{getParameters:v,getProgramCacheKey:w,getUniforms:E,acquireProgram:T,releaseProgram:L,releaseShaderCache:D,programs:c,dispose:B}}h(FX,"WebGLPrograms");function zX(){let i=new WeakMap;function e(a){let o=i.get(a);return o===void 0&&(o={},i.set(a,o)),o}h(e,"get");function t(a){i.delete(a)}h(t,"remove");function r(a,o,s){i.get(a)[o]=s}h(r,"update");function n(){i=new WeakMap}return h(n,"dispose"),{get:e,remove:t,update:r,dispose:n}}h(zX,"WebGLProperties");function BX(i,e){return i.groupOrder!==e.groupOrder?i.groupOrder-e.groupOrder:i.renderOrder!==e.renderOrder?i.renderOrder-e.renderOrder:i.material.id!==e.material.id?i.material.id-e.material.id:i.z!==e.z?i.z-e.z:i.id-e.id}h(BX,"painterSortStable");function I3(i,e){return i.groupOrder!==e.groupOrder?i.groupOrder-e.groupOrder:i.renderOrder!==e.renderOrder?i.renderOrder-e.renderOrder:i.z!==e.z?e.z-i.z:i.id-e.id}h(I3,"reversePainterSortStable");function L3(){let i=[],e=0,t=[],r=[],n=[];function a(){e=0,t.length=0,r.length=0,n.length=0}h(a,"init");function o(p,d,m,g,b,x){let v=i[e];return v===void 0?(v={id:p.id,object:p,geometry:d,material:m,groupOrder:g,renderOrder:p.renderOrder,z:b,group:x},i[e]=v):(v.id=p.id,v.object=p,v.geometry=d,v.material=m,v.groupOrder=g,v.renderOrder=p.renderOrder,v.z=b,v.group=x),e++,v}h(o,"getNextRenderItem");function s(p,d,m,g,b,x){let v=o(p,d,m,g,b,x);m.transmission>0?r.push(v):m.transparent===!0?n.push(v):t.push(v)}h(s,"push");function l(p,d,m,g,b,x){let v=o(p,d,m,g,b,x);m.transmission>0?r.unshift(v):m.transparent===!0?n.unshift(v):t.unshift(v)}h(l,"unshift");function u(p,d){t.length>1&&t.sort(p||BX),r.length>1&&r.sort(d||I3),n.length>1&&n.sort(d||I3)}h(u,"sort");function c(){for(let p=e,d=i.length;p<d;p++){let m=i[p];if(m.id===null)break;m.id=null,m.object=null,m.geometry=null,m.material=null,m.group=null}}return h(c,"finish"),{opaque:t,transmissive:r,transparent:n,init:a,push:s,unshift:l,finish:c,sort:u}}h(L3,"WebGLRenderList");function OX(){let i=new WeakMap;function e(r,n){let a=i.get(r),o;return a===void 0?(o=new L3,i.set(r,[o])):n>=a.length?(o=new L3,a.push(o)):o=a[n],o}h(e,"get");function t(){i=new WeakMap}return h(t,"dispose"),{get:e,dispose:t}}h(OX,"WebGLRenderLists");function NX(){let i={};return{get:function(e){if(i[e.id]!==void 0)return i[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new le,color:new Lt};break;case"SpotLight":t={position:new le,direction:new le,color:new Lt,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new le,color:new Lt,distance:0,decay:0};break;case"HemisphereLight":t={direction:new le,skyColor:new Lt,groundColor:new Lt};break;case"RectAreaLight":t={color:new Lt,position:new le,halfWidth:new le,halfHeight:new le};break}return i[e.id]=t,t}}}h(NX,"UniformsCache");function $X(){let i={};return{get:function(e){if(i[e.id]!==void 0)return i[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Oe};break;case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Oe};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Oe,shadowCameraNear:1,shadowCameraFar:1e3};break}return i[e.id]=t,t}}}h($X,"ShadowUniformsCache");var rye=0;function UX(i,e){return(e.castShadow?2:0)-(i.castShadow?2:0)+(e.map?1:0)-(i.map?1:0)}h(UX,"shadowCastingAndTexturingLightsFirst");function VX(i,e){let t=new NX,r=$X(),n={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let c=0;c<9;c++)n.probe.push(new le);let a=new le,o=new jt,s=new jt;function l(c,p){let d=0,m=0,g=0;for(let $=0;$<9;$++)n.probe[$].set(0,0,0);let b=0,x=0,v=0,w=0,_=0,C=0,E=0,T=0,L=0,D=0,B=0;c.sort(UX);let A=p===!0?Math.PI:1;for(let $=0,O=c.length;$<O;$++){let P=c[$],U=P.color,G=P.intensity,K=P.distance,z=P.shadow&&P.shadow.map?P.shadow.map.texture:null;if(P.isAmbientLight)d+=U.r*G*A,m+=U.g*G*A,g+=U.b*G*A;else if(P.isLightProbe){for(let V=0;V<9;V++)n.probe[V].addScaledVector(P.sh.coefficients[V],G);B++}else if(P.isDirectionalLight){let V=t.get(P);if(V.color.copy(P.color).multiplyScalar(P.intensity*A),P.castShadow){let j=P.shadow,q=r.get(P);q.shadowBias=j.bias,q.shadowNormalBias=j.normalBias,q.shadowRadius=j.radius,q.shadowMapSize=j.mapSize,n.directionalShadow[b]=q,n.directionalShadowMap[b]=z,n.directionalShadowMatrix[b]=P.shadow.matrix,C++}n.directional[b]=V,b++}else if(P.isSpotLight){let V=t.get(P);V.position.setFromMatrixPosition(P.matrixWorld),V.color.copy(U).multiplyScalar(G*A),V.distance=K,V.coneCos=Math.cos(P.angle),V.penumbraCos=Math.cos(P.angle*(1-P.penumbra)),V.decay=P.decay,n.spot[v]=V;let j=P.shadow;if(P.map&&(n.spotLightMap[L]=P.map,L++,j.updateMatrices(P),P.castShadow&&D++),n.spotLightMatrix[v]=j.matrix,P.castShadow){let q=r.get(P);q.shadowBias=j.bias,q.shadowNormalBias=j.normalBias,q.shadowRadius=j.radius,q.shadowMapSize=j.mapSize,n.spotShadow[v]=q,n.spotShadowMap[v]=z,T++}v++}else if(P.isRectAreaLight){let V=t.get(P);V.color.copy(U).multiplyScalar(G),V.halfWidth.set(P.width*.5,0,0),V.halfHeight.set(0,P.height*.5,0),n.rectArea[w]=V,w++}else if(P.isPointLight){let V=t.get(P);if(V.color.copy(P.color).multiplyScalar(P.intensity*A),V.distance=P.distance,V.decay=P.decay,P.castShadow){let j=P.shadow,q=r.get(P);q.shadowBias=j.bias,q.shadowNormalBias=j.normalBias,q.shadowRadius=j.radius,q.shadowMapSize=j.mapSize,q.shadowCameraNear=j.camera.near,q.shadowCameraFar=j.camera.far,n.pointShadow[x]=q,n.pointShadowMap[x]=z,n.pointShadowMatrix[x]=P.shadow.matrix,E++}n.point[x]=V,x++}else if(P.isHemisphereLight){let V=t.get(P);V.skyColor.copy(P.color).multiplyScalar(G*A),V.groundColor.copy(P.groundColor).multiplyScalar(G*A),n.hemi[_]=V,_++}}w>0&&(e.isWebGL2?i.has("OES_texture_float_linear")===!0?(n.rectAreaLTC1=at.LTC_FLOAT_1,n.rectAreaLTC2=at.LTC_FLOAT_2):(n.rectAreaLTC1=at.LTC_HALF_1,n.rectAreaLTC2=at.LTC_HALF_2):i.has("OES_texture_float_linear")===!0?(n.rectAreaLTC1=at.LTC_FLOAT_1,n.rectAreaLTC2=at.LTC_FLOAT_2):i.has("OES_texture_half_float_linear")===!0?(n.rectAreaLTC1=at.LTC_HALF_1,n.rectAreaLTC2=at.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),n.ambient[0]=d,n.ambient[1]=m,n.ambient[2]=g;let k=n.hash;(k.directionalLength!==b||k.pointLength!==x||k.spotLength!==v||k.rectAreaLength!==w||k.hemiLength!==_||k.numDirectionalShadows!==C||k.numPointShadows!==E||k.numSpotShadows!==T||k.numSpotMaps!==L||k.numLightProbes!==B)&&(n.directional.length=b,n.spot.length=v,n.rectArea.length=w,n.point.length=x,n.hemi.length=_,n.directionalShadow.length=C,n.directionalShadowMap.length=C,n.pointShadow.length=E,n.pointShadowMap.length=E,n.spotShadow.length=T,n.spotShadowMap.length=T,n.directionalShadowMatrix.length=C,n.pointShadowMatrix.length=E,n.spotLightMatrix.length=T+L-D,n.spotLightMap.length=L,n.numSpotLightShadowsWithMaps=D,n.numLightProbes=B,k.directionalLength=b,k.pointLength=x,k.spotLength=v,k.rectAreaLength=w,k.hemiLength=_,k.numDirectionalShadows=C,k.numPointShadows=E,k.numSpotShadows=T,k.numSpotMaps=L,k.numLightProbes=B,n.version=rye++)}h(l,"setup");function u(c,p){let d=0,m=0,g=0,b=0,x=0,v=p.matrixWorldInverse;for(let w=0,_=c.length;w<_;w++){let C=c[w];if(C.isDirectionalLight){let E=n.directional[d];E.direction.setFromMatrixPosition(C.matrixWorld),a.setFromMatrixPosition(C.target.matrixWorld),E.direction.sub(a),E.direction.transformDirection(v),d++}else if(C.isSpotLight){let E=n.spot[g];E.position.setFromMatrixPosition(C.matrixWorld),E.position.applyMatrix4(v),E.direction.setFromMatrixPosition(C.matrixWorld),a.setFromMatrixPosition(C.target.matrixWorld),E.direction.sub(a),E.direction.transformDirection(v),g++}else if(C.isRectAreaLight){let E=n.rectArea[b];E.position.setFromMatrixPosition(C.matrixWorld),E.position.applyMatrix4(v),s.identity(),o.copy(C.matrixWorld),o.premultiply(v),s.extractRotation(o),E.halfWidth.set(C.width*.5,0,0),E.halfHeight.set(0,C.height*.5,0),E.halfWidth.applyMatrix4(s),E.halfHeight.applyMatrix4(s),b++}else if(C.isPointLight){let E=n.point[m];E.position.setFromMatrixPosition(C.matrixWorld),E.position.applyMatrix4(v),m++}else if(C.isHemisphereLight){let E=n.hemi[x];E.direction.setFromMatrixPosition(C.matrixWorld),E.direction.transformDirection(v),x++}}}return h(u,"setupView"),{setup:l,setupView:u,state:n}}h(VX,"WebGLLights");function D3(i,e){let t=new VX(i,e),r=[],n=[];function a(){r.length=0,n.length=0}h(a,"init");function o(c){r.push(c)}h(o,"pushLight");function s(c){n.push(c)}h(s,"pushShadow");function l(c){t.setup(r,c)}h(l,"setupLights");function u(c){t.setupView(r,c)}return h(u,"setupLightsView"),{init:a,state:{lightsArray:r,shadowsArray:n,lights:t},setupLights:l,setupLightsView:u,pushLight:o,pushShadow:s}}h(D3,"WebGLRenderState");function jX(i,e){let t=new WeakMap;function r(a,o=0){let s=t.get(a),l;return s===void 0?(l=new D3(i,e),t.set(a,[l])):o>=s.length?(l=new D3(i,e),s.push(l)):l=s[o],l}h(r,"get");function n(){t=new WeakMap}return h(n,"dispose"),{get:r,dispose:n}}h(jX,"WebGLRenderStates");var HX=class extends Wl{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=kfe,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}};h(HX,"MeshDepthMaterial");var nye=HX,GX=class extends Wl{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}};h(GX,"MeshDistanceMaterial");var aye=GX,oye=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,sye=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function WX(i,e,t){let r=new ig,n=new Oe,a=new Oe,o=new Ei,s=new nye({depthPacking:Rfe}),l=new aye,u={},c=t.maxTextureSize,p={[Bl]:Wn,[Wn]:Bl,[Da]:Da},d=new xo({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Oe},radius:{value:4}},vertexShader:oye,fragmentShader:sye}),m=d.clone();m.defines.HORIZONTAL_PASS=1;let g=new ma;g.setAttribute("position",new Br(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));let b=new Wi(g,d),x=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=SH;let v=this.type;this.render=function(T,L,D){if(x.enabled===!1||x.autoUpdate===!1&&x.needsUpdate===!1||T.length===0)return;let B=i.getRenderTarget(),A=i.getActiveCubeFace(),k=i.getActiveMipmapLevel(),$=i.state;$.setBlending(Al),$.buffers.color.setClear(1,1,1,1),$.buffers.depth.setTest(!0),$.setScissorTest(!1);let O=v!==ss&&this.type===ss,P=v===ss&&this.type!==ss;for(let U=0,G=T.length;U<G;U++){let K=T[U],z=K.shadow;if(z===void 0){console.warn("THREE.WebGLShadowMap:",K,"has no shadow.");continue}if(z.autoUpdate===!1&&z.needsUpdate===!1)continue;n.copy(z.mapSize);let V=z.getFrameExtents();if(n.multiply(V),a.copy(z.mapSize),(n.x>c||n.y>c)&&(n.x>c&&(a.x=Math.floor(c/V.x),n.x=a.x*V.x,z.mapSize.x=a.x),n.y>c&&(a.y=Math.floor(c/V.y),n.y=a.y*V.y,z.mapSize.y=a.y)),z.map===null||O===!0||P===!0){let q=this.type!==ss?{minFilter:Xr,magFilter:Xr}:{};z.map!==null&&z.map.dispose(),z.map=new Qu(n.x,n.y,q),z.map.texture.name=K.name+".shadowMap",z.camera.updateProjectionMatrix()}i.setRenderTarget(z.map),i.clear();let j=z.getViewportCount();for(let q=0;q<j;q++){let ee=z.getViewport(q);o.set(a.x*ee.x,a.y*ee.y,a.x*ee.z,a.y*ee.w),$.viewport(o),z.updateMatrices(K,q),r=z.getFrustum(),C(L,D,z.camera,K,this.type)}z.isPointLightShadow!==!0&&this.type===ss&&w(z,D),z.needsUpdate=!1}v=this.type,x.needsUpdate=!1,i.setRenderTarget(B,A,k)};function w(T,L){let D=e.update(b);d.defines.VSM_SAMPLES!==T.blurSamples&&(d.defines.VSM_SAMPLES=T.blurSamples,m.defines.VSM_SAMPLES=T.blurSamples,d.needsUpdate=!0,m.needsUpdate=!0),T.mapPass===null&&(T.mapPass=new Qu(n.x,n.y)),d.uniforms.shadow_pass.value=T.map.texture,d.uniforms.resolution.value=T.mapSize,d.uniforms.radius.value=T.radius,i.setRenderTarget(T.mapPass),i.clear(),i.renderBufferDirect(L,null,D,d,b,null),m.uniforms.shadow_pass.value=T.mapPass.texture,m.uniforms.resolution.value=T.mapSize,m.uniforms.radius.value=T.radius,i.setRenderTarget(T.map),i.clear(),i.renderBufferDirect(L,null,D,m,b,null)}h(w,"VSMPass");function _(T,L,D,B){let A=null,k=D.isPointLight===!0?T.customDistanceMaterial:T.customDepthMaterial;if(k!==void 0)A=k;else if(A=D.isPointLight===!0?l:s,i.localClippingEnabled&&L.clipShadows===!0&&Array.isArray(L.clippingPlanes)&&L.clippingPlanes.length!==0||L.displacementMap&&L.displacementScale!==0||L.alphaMap&&L.alphaTest>0||L.map&&L.alphaTest>0){let $=A.uuid,O=L.uuid,P=u[$];P===void 0&&(P={},u[$]=P);let U=P[O];U===void 0&&(U=A.clone(),P[O]=U,L.addEventListener("dispose",E)),A=U}if(A.visible=L.visible,A.wireframe=L.wireframe,B===ss?A.side=L.shadowSide!==null?L.shadowSide:L.side:A.side=L.shadowSide!==null?L.shadowSide:p[L.side],A.alphaMap=L.alphaMap,A.alphaTest=L.alphaTest,A.map=L.map,A.clipShadows=L.clipShadows,A.clippingPlanes=L.clippingPlanes,A.clipIntersection=L.clipIntersection,A.displacementMap=L.displacementMap,A.displacementScale=L.displacementScale,A.displacementBias=L.displacementBias,A.wireframeLinewidth=L.wireframeLinewidth,A.linewidth=L.linewidth,D.isPointLight===!0&&A.isMeshDistanceMaterial===!0){let $=i.properties.get(A);$.light=D}return A}h(_,"getDepthMaterial");function C(T,L,D,B,A){if(T.visible===!1)return;if(T.layers.test(L.layers)&&(T.isMesh||T.isLine||T.isPoints)&&(T.castShadow||T.receiveShadow&&A===ss)&&(!T.frustumCulled||r.intersectsObject(T))){T.modelViewMatrix.multiplyMatrices(D.matrixWorldInverse,T.matrixWorld);let $=e.update(T),O=T.material;if(Array.isArray(O)){let P=$.groups;for(let U=0,G=P.length;U<G;U++){let K=P[U],z=O[K.materialIndex];if(z&&z.visible){let V=_(T,z,B,A);T.onBeforeShadow(i,T,L,D,$,V,K),i.renderBufferDirect(D,null,$,V,T,K),T.onAfterShadow(i,T,L,D,$,V,K)}}}else if(O.visible){let P=_(T,O,B,A);T.onBeforeShadow(i,T,L,D,$,P,null),i.renderBufferDirect(D,null,$,P,T,null),T.onAfterShadow(i,T,L,D,$,P,null)}}let k=T.children;for(let $=0,O=k.length;$<O;$++)C(k[$],L,D,B,A)}h(C,"renderObject");function E(T){T.target.removeEventListener("dispose",E);for(let L in u){let D=u[L],B=T.target.uuid;B in D&&(D[B].dispose(),delete D[B])}}h(E,"onMaterialDispose")}h(WX,"WebGLShadowMap");function XX(i,e,t){let r=t.isWebGL2;function n(){let ce=!1,et=new Ei,be=null,Ge=new Ei(0,0,0,0);return{setMask:function(tt){be!==tt&&!ce&&(i.colorMask(tt,tt,tt,tt),be=tt)},setLocked:function(tt){ce=tt},setClear:function(tt,Ht,Nt,Mi,ar){ar===!0&&(tt*=Mi,Ht*=Mi,Nt*=Mi),et.set(tt,Ht,Nt,Mi),Ge.equals(et)===!1&&(i.clearColor(tt,Ht,Nt,Mi),Ge.copy(et))},reset:function(){ce=!1,be=null,Ge.set(-1,0,0,0)}}}h(n,"ColorBuffer");function a(){let ce=!1,et=null,be=null,Ge=null;return{setTest:function(tt){tt?ge(i.DEPTH_TEST):Te(i.DEPTH_TEST)},setMask:function(tt){et!==tt&&!ce&&(i.depthMask(tt),et=tt)},setFunc:function(tt){if(be!==tt){switch(tt){case ofe:i.depthFunc(i.NEVER);break;case sfe:i.depthFunc(i.ALWAYS);break;case lfe:i.depthFunc(i.LESS);break;case mv:i.depthFunc(i.LEQUAL);break;case ufe:i.depthFunc(i.EQUAL);break;case hfe:i.depthFunc(i.GEQUAL);break;case cfe:i.depthFunc(i.GREATER);break;case pfe:i.depthFunc(i.NOTEQUAL);break;default:i.depthFunc(i.LEQUAL)}be=tt}},setLocked:function(tt){ce=tt},setClear:function(tt){Ge!==tt&&(i.clearDepth(tt),Ge=tt)},reset:function(){ce=!1,et=null,be=null,Ge=null}}}h(a,"DepthBuffer");function o(){let ce=!1,et=null,be=null,Ge=null,tt=null,Ht=null,Nt=null,Mi=null,ar=null;return{setTest:function(Ut){ce||(Ut?ge(i.STENCIL_TEST):Te(i.STENCIL_TEST))},setMask:function(Ut){et!==Ut&&!ce&&(i.stencilMask(Ut),et=Ut)},setFunc:function(Ut,Ci,pr){(be!==Ut||Ge!==Ci||tt!==pr)&&(i.stencilFunc(Ut,Ci,pr),be=Ut,Ge=Ci,tt=pr)},setOp:function(Ut,Ci,pr){(Ht!==Ut||Nt!==Ci||Mi!==pr)&&(i.stencilOp(Ut,Ci,pr),Ht=Ut,Nt=Ci,Mi=pr)},setLocked:function(Ut){ce=Ut},setClear:function(Ut){ar!==Ut&&(i.clearStencil(Ut),ar=Ut)},reset:function(){ce=!1,et=null,be=null,Ge=null,tt=null,Ht=null,Nt=null,Mi=null,ar=null}}}h(o,"StencilBuffer");let s=new n,l=new a,u=new o,c=new WeakMap,p=new WeakMap,d={},m={},g=new WeakMap,b=[],x=null,v=!1,w=null,_=null,C=null,E=null,T=null,L=null,D=null,B=new Lt(0,0,0),A=0,k=!1,$=null,O=null,P=null,U=null,G=null,K=i.getParameter(i.MAX_COMBINED_TEXTURE_IMAGE_UNITS),z=!1,V=0,j=i.getParameter(i.VERSION);j.indexOf("WebGL")!==-1?(V=parseFloat(/^WebGL (\d)/.exec(j)[1]),z=V>=1):j.indexOf("OpenGL ES")!==-1&&(V=parseFloat(/^OpenGL ES (\d)/.exec(j)[1]),z=V>=2);let q=null,ee={},ae=i.getParameter(i.SCISSOR_BOX),N=i.getParameter(i.VIEWPORT),J=new Ei().fromArray(ae),Y=new Ei().fromArray(N);function oe(ce,et,be,Ge){let tt=new Uint8Array(4),Ht=i.createTexture();i.bindTexture(ce,Ht),i.texParameteri(ce,i.TEXTURE_MIN_FILTER,i.NEAREST),i.texParameteri(ce,i.TEXTURE_MAG_FILTER,i.NEAREST);for(let Nt=0;Nt<be;Nt++)r&&(ce===i.TEXTURE_3D||ce===i.TEXTURE_2D_ARRAY)?i.texImage3D(et,0,i.RGBA,1,1,Ge,0,i.RGBA,i.UNSIGNED_BYTE,tt):i.texImage2D(et+Nt,0,i.RGBA,1,1,0,i.RGBA,i.UNSIGNED_BYTE,tt);return Ht}h(oe,"createTexture");let xe={};xe[i.TEXTURE_2D]=oe(i.TEXTURE_2D,i.TEXTURE_2D,1),xe[i.TEXTURE_CUBE_MAP]=oe(i.TEXTURE_CUBE_MAP,i.TEXTURE_CUBE_MAP_POSITIVE_X,6),r&&(xe[i.TEXTURE_2D_ARRAY]=oe(i.TEXTURE_2D_ARRAY,i.TEXTURE_2D_ARRAY,1,1),xe[i.TEXTURE_3D]=oe(i.TEXTURE_3D,i.TEXTURE_3D,1,1)),s.setClear(0,0,0,1),l.setClear(1),u.setClear(0),ge(i.DEPTH_TEST),l.setFunc(mv),Fe(!1),Ze(dA),ge(i.CULL_FACE),De(Al);function ge(ce){d[ce]!==!0&&(i.enable(ce),d[ce]=!0)}h(ge,"enable");function Te(ce){d[ce]!==!1&&(i.disable(ce),d[ce]=!1)}h(Te,"disable");function me(ce,et){return m[ce]!==et?(i.bindFramebuffer(ce,et),m[ce]=et,r&&(ce===i.DRAW_FRAMEBUFFER&&(m[i.FRAMEBUFFER]=et),ce===i.FRAMEBUFFER&&(m[i.DRAW_FRAMEBUFFER]=et)),!0):!1}h(me,"bindFramebuffer");function Q(ce,et){let be=b,Ge=!1;if(ce){be=g.get(et),be===void 0&&(be=[],g.set(et,be));let tt=ce.textures;if(be.length!==tt.length||be[0]!==i.COLOR_ATTACHMENT0){for(let Ht=0,Nt=tt.length;Ht<Nt;Ht++)be[Ht]=i.COLOR_ATTACHMENT0+Ht;be.length=tt.length,Ge=!0}}else be[0]!==i.BACK&&(be[0]=i.BACK,Ge=!0);if(Ge)if(t.isWebGL2)i.drawBuffers(be);else if(e.has("WEBGL_draw_buffers")===!0)e.get("WEBGL_draw_buffers").drawBuffersWEBGL(be);else throw new Error("THREE.WebGLState: Usage of gl.drawBuffers() require WebGL2 or WEBGL_draw_buffers extension")}h(Q,"drawBuffers");function Me(ce){return x!==ce?(i.useProgram(ce),x=ce,!0):!1}h(Me,"useProgram");let ve={[bu]:i.FUNC_ADD,[Gde]:i.FUNC_SUBTRACT,[Wde]:i.FUNC_REVERSE_SUBTRACT};if(r)ve[yA]=i.MIN,ve[vA]=i.MAX;else{let ce=e.get("EXT_blend_minmax");ce!==null&&(ve[yA]=ce.MIN_EXT,ve[vA]=ce.MAX_EXT)}let Ie={[Xde]:i.ZERO,[qde]:i.ONE,[Zde]:i.SRC_COLOR,[p3]:i.SRC_ALPHA,[tfe]:i.SRC_ALPHA_SATURATE,[Qde]:i.DST_COLOR,[Jde]:i.DST_ALPHA,[Yde]:i.ONE_MINUS_SRC_COLOR,[d3]:i.ONE_MINUS_SRC_ALPHA,[efe]:i.ONE_MINUS_DST_COLOR,[Kde]:i.ONE_MINUS_DST_ALPHA,[ife]:i.CONSTANT_COLOR,[rfe]:i.ONE_MINUS_CONSTANT_COLOR,[nfe]:i.CONSTANT_ALPHA,[afe]:i.ONE_MINUS_CONSTANT_ALPHA};function De(ce,et,be,Ge,tt,Ht,Nt,Mi,ar,Ut){if(ce===Al){v===!0&&(Te(i.BLEND),v=!1);return}if(v===!1&&(ge(i.BLEND),v=!0),ce!==Hde){if(ce!==w||Ut!==k){if((_!==bu||T!==bu)&&(i.blendEquation(i.FUNC_ADD),_=bu,T=bu),Ut)switch(ce){case pp:i.blendFuncSeparate(i.ONE,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA);break;case fA:i.blendFunc(i.ONE,i.ONE);break;case mA:i.blendFuncSeparate(i.ZERO,i.ONE_MINUS_SRC_COLOR,i.ZERO,i.ONE);break;case gA:i.blendFuncSeparate(i.ZERO,i.SRC_COLOR,i.ZERO,i.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",ce);break}else switch(ce){case pp:i.blendFuncSeparate(i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA);break;case fA:i.blendFunc(i.SRC_ALPHA,i.ONE);break;case mA:i.blendFuncSeparate(i.ZERO,i.ONE_MINUS_SRC_COLOR,i.ZERO,i.ONE);break;case gA:i.blendFunc(i.ZERO,i.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",ce);break}C=null,E=null,L=null,D=null,B.set(0,0,0),A=0,w=ce,k=Ut}return}tt=tt||et,Ht=Ht||be,Nt=Nt||Ge,(et!==_||tt!==T)&&(i.blendEquationSeparate(ve[et],ve[tt]),_=et,T=tt),(be!==C||Ge!==E||Ht!==L||Nt!==D)&&(i.blendFuncSeparate(Ie[be],Ie[Ge],Ie[Ht],Ie[Nt]),C=be,E=Ge,L=Ht,D=Nt),(Mi.equals(B)===!1||ar!==A)&&(i.blendColor(Mi.r,Mi.g,Mi.b,ar),B.copy(Mi),A=ar),w=ce,k=!1}h(De,"setBlending");function we(ce,et){ce.side===Da?Te(i.CULL_FACE):ge(i.CULL_FACE);let be=ce.side===Wn;et&&(be=!be),Fe(be),ce.blending===pp&&ce.transparent===!1?De(Al):De(ce.blending,ce.blendEquation,ce.blendSrc,ce.blendDst,ce.blendEquationAlpha,ce.blendSrcAlpha,ce.blendDstAlpha,ce.blendColor,ce.blendAlpha,ce.premultipliedAlpha),l.setFunc(ce.depthFunc),l.setTest(ce.depthTest),l.setMask(ce.depthWrite),s.setMask(ce.colorWrite);let Ge=ce.stencilWrite;u.setTest(Ge),Ge&&(u.setMask(ce.stencilWriteMask),u.setFunc(ce.stencilFunc,ce.stencilRef,ce.stencilFuncMask),u.setOp(ce.stencilFail,ce.stencilZFail,ce.stencilZPass)),ne(ce.polygonOffset,ce.polygonOffsetFactor,ce.polygonOffsetUnits),ce.alphaToCoverage===!0?ge(i.SAMPLE_ALPHA_TO_COVERAGE):Te(i.SAMPLE_ALPHA_TO_COVERAGE)}h(we,"setMaterial");function Fe(ce){$!==ce&&(ce?i.frontFace(i.CW):i.frontFace(i.CCW),$=ce)}h(Fe,"setFlipSided");function Ze(ce){ce!==Ude?(ge(i.CULL_FACE),ce!==O&&(ce===dA?i.cullFace(i.BACK):ce===Vde?i.cullFace(i.FRONT):i.cullFace(i.FRONT_AND_BACK))):Te(i.CULL_FACE),O=ce}h(Ze,"setCullFace");function yt(ce){ce!==P&&(z&&i.lineWidth(ce),P=ce)}h(yt,"setLineWidth");function ne(ce,et,be){ce?(ge(i.POLYGON_OFFSET_FILL),(U!==et||G!==be)&&(i.polygonOffset(et,be),U=et,G=be)):Te(i.POLYGON_OFFSET_FILL)}h(ne,"setPolygonOffset");function W(ce){ce?ge(i.SCISSOR_TEST):Te(i.SCISSOR_TEST)}h(W,"setScissorTest");function _e(ce){ce===void 0&&(ce=i.TEXTURE0+K-1),q!==ce&&(i.activeTexture(ce),q=ce)}h(_e,"activeTexture");function Re(ce,et,be){be===void 0&&(q===null?be=i.TEXTURE0+K-1:be=q);let Ge=ee[be];Ge===void 0&&(Ge={type:void 0,texture:void 0},ee[be]=Ge),(Ge.type!==ce||Ge.texture!==et)&&(q!==be&&(i.activeTexture(be),q=be),i.bindTexture(ce,et||xe[ce]),Ge.type=ce,Ge.texture=et)}h(Re,"bindTexture");function Ne(){let ce=ee[q];ce!==void 0&&ce.type!==void 0&&(i.bindTexture(ce.type,null),ce.type=void 0,ce.texture=void 0)}h(Ne,"unbindTexture");function ze(){try{i.compressedTexImage2D.apply(i,arguments)}catch(ce){console.error("THREE.WebGLState:",ce)}}h(ze,"compressedTexImage2D");function xt(){try{i.compressedTexImage3D.apply(i,arguments)}catch(ce){console.error("THREE.WebGLState:",ce)}}h(xt,"compressedTexImage3D");function ot(){try{i.texSubImage2D.apply(i,arguments)}catch(ce){console.error("THREE.WebGLState:",ce)}}h(ot,"texSubImage2D");function je(){try{i.texSubImage3D.apply(i,arguments)}catch(ce){console.error("THREE.WebGLState:",ce)}}h(je,"texSubImage3D");function He(){try{i.compressedTexSubImage2D.apply(i,arguments)}catch(ce){console.error("THREE.WebGLState:",ce)}}h(He,"compressedTexSubImage2D");function bt(){try{i.compressedTexSubImage3D.apply(i,arguments)}catch(ce){console.error("THREE.WebGLState:",ce)}}h(bt,"compressedTexSubImage3D");function Xe(){try{i.texStorage2D.apply(i,arguments)}catch(ce){console.error("THREE.WebGLState:",ce)}}h(Xe,"texStorage2D");function ti(){try{i.texStorage3D.apply(i,arguments)}catch(ce){console.error("THREE.WebGLState:",ce)}}h(ti,"texStorage3D");function At(){try{i.texImage2D.apply(i,arguments)}catch(ce){console.error("THREE.WebGLState:",ce)}}h(At,"texImage2D");function ue(){try{i.texImage3D.apply(i,arguments)}catch(ce){console.error("THREE.WebGLState:",ce)}}h(ue,"texImage3D");function he(ce){J.equals(ce)===!1&&(i.scissor(ce.x,ce.y,ce.z,ce.w),J.copy(ce))}h(he,"scissor");function We(ce){Y.equals(ce)===!1&&(i.viewport(ce.x,ce.y,ce.z,ce.w),Y.copy(ce))}h(We,"viewport");function pt(ce,et){let be=p.get(et);be===void 0&&(be=new WeakMap,p.set(et,be));let Ge=be.get(ce);Ge===void 0&&(Ge=i.getUniformBlockIndex(et,ce.name),be.set(ce,Ge))}h(pt,"updateUBOMapping");function ut(ce,et){let be=p.get(et).get(ce);c.get(et)!==be&&(i.uniformBlockBinding(et,be,ce.__bindingPointIndex),c.set(et,be))}h(ut,"uniformBlockBinding");function ct(){i.disable(i.BLEND),i.disable(i.CULL_FACE),i.disable(i.DEPTH_TEST),i.disable(i.POLYGON_OFFSET_FILL),i.disable(i.SCISSOR_TEST),i.disable(i.STENCIL_TEST),i.disable(i.SAMPLE_ALPHA_TO_COVERAGE),i.blendEquation(i.FUNC_ADD),i.blendFunc(i.ONE,i.ZERO),i.blendFuncSeparate(i.ONE,i.ZERO,i.ONE,i.ZERO),i.blendColor(0,0,0,0),i.colorMask(!0,!0,!0,!0),i.clearColor(0,0,0,0),i.depthMask(!0),i.depthFunc(i.LESS),i.clearDepth(1),i.stencilMask(4294967295),i.stencilFunc(i.ALWAYS,0,4294967295),i.stencilOp(i.KEEP,i.KEEP,i.KEEP),i.clearStencil(0),i.cullFace(i.BACK),i.frontFace(i.CCW),i.polygonOffset(0,0),i.activeTexture(i.TEXTURE0),i.bindFramebuffer(i.FRAMEBUFFER,null),r===!0&&(i.bindFramebuffer(i.DRAW_FRAMEBUFFER,null),i.bindFramebuffer(i.READ_FRAMEBUFFER,null)),i.useProgram(null),i.lineWidth(1),i.scissor(0,0,i.canvas.width,i.canvas.height),i.viewport(0,0,i.canvas.width,i.canvas.height),d={},q=null,ee={},m={},g=new WeakMap,b=[],x=null,v=!1,w=null,_=null,C=null,E=null,T=null,L=null,D=null,B=new Lt(0,0,0),A=0,k=!1,$=null,O=null,P=null,U=null,G=null,J.set(0,0,i.canvas.width,i.canvas.height),Y.set(0,0,i.canvas.width,i.canvas.height),s.reset(),l.reset(),u.reset()}return h(ct,"reset"),{buffers:{color:s,depth:l,stencil:u},enable:ge,disable:Te,bindFramebuffer:me,drawBuffers:Q,useProgram:Me,setBlending:De,setMaterial:we,setFlipSided:Fe,setCullFace:Ze,setLineWidth:yt,setPolygonOffset:ne,setScissorTest:W,activeTexture:_e,bindTexture:Re,unbindTexture:Ne,compressedTexImage2D:ze,compressedTexImage3D:xt,texImage2D:At,texImage3D:ue,updateUBOMapping:pt,uniformBlockBinding:ut,texStorage2D:Xe,texStorage3D:ti,texSubImage2D:ot,texSubImage3D:je,compressedTexSubImage2D:He,compressedTexSubImage3D:bt,scissor:he,viewport:We,reset:ct}}h(XX,"WebGLState");function qX(i,e,t,r,n,a,o){let s=n.isWebGL2,l=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,u=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),c=new Oe,p=new WeakMap,d,m=new WeakMap,g=!1;try{g=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function b(ne,W){return g?new OffscreenCanvas(ne,W):Vp("canvas")}h(b,"createCanvas");function x(ne,W,_e,Re){let Ne=1,ze=yt(ne);if((ze.width>Re||ze.height>Re)&&(Ne=Re/Math.max(ze.width,ze.height)),Ne<1||W===!0)if(typeof HTMLImageElement<"u"&&ne instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&ne instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&ne instanceof ImageBitmap||typeof VideoFrame<"u"&&ne instanceof VideoFrame){let xt=W?Pm:Math.floor,ot=xt(Ne*ze.width),je=xt(Ne*ze.height);d===void 0&&(d=b(ot,je));let He=_e?b(ot,je):d;return He.width=ot,He.height=je,He.getContext("2d").drawImage(ne,0,0,ot,je),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+ze.width+"x"+ze.height+") to ("+ot+"x"+je+")."),He}else return"data"in ne&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+ze.width+"x"+ze.height+")."),ne;return ne}h(x,"resizeImage");function v(ne){let W=yt(ne);return wv(W.width)&&wv(W.height)}h(v,"isPowerOfTwo$1");function w(ne){return s?!1:ne.wrapS!==ho||ne.wrapT!==ho||ne.minFilter!==Xr&&ne.minFilter!==Fn}h(w,"textureNeedsPowerOfTwo");function _(ne,W){return ne.generateMipmaps&&W&&ne.minFilter!==Xr&&ne.minFilter!==Fn}h(_,"textureNeedsGenerateMipmaps");function C(ne){i.generateMipmap(ne)}h(C,"generateMipmap");function E(ne,W,_e,Re,Ne=!1){if(s===!1)return W;if(ne!==null){if(i[ne]!==void 0)return i[ne];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+ne+"'")}let ze=W;if(W===i.RED&&(_e===i.FLOAT&&(ze=i.R32F),_e===i.HALF_FLOAT&&(ze=i.R16F),_e===i.UNSIGNED_BYTE&&(ze=i.R8)),W===i.RED_INTEGER&&(_e===i.UNSIGNED_BYTE&&(ze=i.R8UI),_e===i.UNSIGNED_SHORT&&(ze=i.R16UI),_e===i.UNSIGNED_INT&&(ze=i.R32UI),_e===i.BYTE&&(ze=i.R8I),_e===i.SHORT&&(ze=i.R16I),_e===i.INT&&(ze=i.R32I)),W===i.RG&&(_e===i.FLOAT&&(ze=i.RG32F),_e===i.HALF_FLOAT&&(ze=i.RG16F),_e===i.UNSIGNED_BYTE&&(ze=i.RG8)),W===i.RG_INTEGER&&(_e===i.UNSIGNED_BYTE&&(ze=i.RG8UI),_e===i.UNSIGNED_SHORT&&(ze=i.RG16UI),_e===i.UNSIGNED_INT&&(ze=i.RG32UI),_e===i.BYTE&&(ze=i.RG8I),_e===i.SHORT&&(ze=i.RG16I),_e===i.INT&&(ze=i.RG32I)),W===i.RGBA){let xt=Ne?vv:Si.getTransfer(Re);_e===i.FLOAT&&(ze=i.RGBA32F),_e===i.HALF_FLOAT&&(ze=i.RGBA16F),_e===i.UNSIGNED_BYTE&&(ze=xt===Di?i.SRGB8_ALPHA8:i.RGBA8),_e===i.UNSIGNED_SHORT_4_4_4_4&&(ze=i.RGBA4),_e===i.UNSIGNED_SHORT_5_5_5_1&&(ze=i.RGB5_A1)}return(ze===i.R16F||ze===i.R32F||ze===i.RG16F||ze===i.RG32F||ze===i.RGBA16F||ze===i.RGBA32F)&&e.get("EXT_color_buffer_float"),ze}h(E,"getInternalFormat");function T(ne,W,_e){return _(ne,_e)===!0||ne.isFramebufferTexture&&ne.minFilter!==Xr&&ne.minFilter!==Fn?Math.log2(Math.max(W.width,W.height))+1:ne.mipmaps!==void 0&&ne.mipmaps.length>0?ne.mipmaps.length:ne.isCompressedTexture&&Array.isArray(ne.image)?W.mipmaps.length:1}h(T,"getMipLevels");function L(ne){return ne===Xr||ne===_A||ne===Ed?i.NEAREST:i.LINEAR}h(L,"filterFallback");function D(ne){let W=ne.target;W.removeEventListener("dispose",D),A(W),W.isVideoTexture&&p.delete(W)}h(D,"onTextureDispose");function B(ne){let W=ne.target;W.removeEventListener("dispose",B),$(W)}h(B,"onRenderTargetDispose");function A(ne){let W=r.get(ne);if(W.__webglInit===void 0)return;let _e=ne.source,Re=m.get(_e);if(Re){let Ne=Re[W.__cacheKey];Ne.usedTimes--,Ne.usedTimes===0&&k(ne),Object.keys(Re).length===0&&m.delete(_e)}r.remove(ne)}h(A,"deallocateTexture");function k(ne){let W=r.get(ne);i.deleteTexture(W.__webglTexture);let _e=ne.source,Re=m.get(_e);delete Re[W.__cacheKey],o.memory.textures--}h(k,"deleteTexture");function $(ne){let W=r.get(ne);if(ne.depthTexture&&ne.depthTexture.dispose(),ne.isWebGLCubeRenderTarget)for(let Re=0;Re<6;Re++){if(Array.isArray(W.__webglFramebuffer[Re]))for(let Ne=0;Ne<W.__webglFramebuffer[Re].length;Ne++)i.deleteFramebuffer(W.__webglFramebuffer[Re][Ne]);else i.deleteFramebuffer(W.__webglFramebuffer[Re]);W.__webglDepthbuffer&&i.deleteRenderbuffer(W.__webglDepthbuffer[Re])}else{if(Array.isArray(W.__webglFramebuffer))for(let Re=0;Re<W.__webglFramebuffer.length;Re++)i.deleteFramebuffer(W.__webglFramebuffer[Re]);else i.deleteFramebuffer(W.__webglFramebuffer);if(W.__webglDepthbuffer&&i.deleteRenderbuffer(W.__webglDepthbuffer),W.__webglMultisampledFramebuffer&&i.deleteFramebuffer(W.__webglMultisampledFramebuffer),W.__webglColorRenderbuffer)for(let Re=0;Re<W.__webglColorRenderbuffer.length;Re++)W.__webglColorRenderbuffer[Re]&&i.deleteRenderbuffer(W.__webglColorRenderbuffer[Re]);W.__webglDepthRenderbuffer&&i.deleteRenderbuffer(W.__webglDepthRenderbuffer)}let _e=ne.textures;for(let Re=0,Ne=_e.length;Re<Ne;Re++){let ze=r.get(_e[Re]);ze.__webglTexture&&(i.deleteTexture(ze.__webglTexture),o.memory.textures--),r.remove(_e[Re])}r.remove(ne)}h($,"deallocateRenderTarget");let O=0;function P(){O=0}h(P,"resetTextureUnits");function U(){let ne=O;return ne>=n.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+ne+" texture units while this GPU supports only "+n.maxTextures),O+=1,ne}h(U,"allocateTextureUnit");function G(ne){let W=[];return W.push(ne.wrapS),W.push(ne.wrapT),W.push(ne.wrapR||0),W.push(ne.magFilter),W.push(ne.minFilter),W.push(ne.anisotropy),W.push(ne.internalFormat),W.push(ne.format),W.push(ne.type),W.push(ne.generateMipmaps),W.push(ne.premultiplyAlpha),W.push(ne.flipY),W.push(ne.unpackAlignment),W.push(ne.colorSpace),W.join()}h(G,"getTextureCacheKey");function K(ne,W){let _e=r.get(ne);if(ne.isVideoTexture&&Fe(ne),ne.isRenderTargetTexture===!1&&ne.version>0&&_e.__version!==ne.version){let Re=ne.image;if(Re===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(Re.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{Y(_e,ne,W);return}}t.bindTexture(i.TEXTURE_2D,_e.__webglTexture,i.TEXTURE0+W)}h(K,"setTexture2D");function z(ne,W){let _e=r.get(ne);if(ne.version>0&&_e.__version!==ne.version){Y(_e,ne,W);return}t.bindTexture(i.TEXTURE_2D_ARRAY,_e.__webglTexture,i.TEXTURE0+W)}h(z,"setTexture2DArray");function V(ne,W){let _e=r.get(ne);if(ne.version>0&&_e.__version!==ne.version){Y(_e,ne,W);return}t.bindTexture(i.TEXTURE_3D,_e.__webglTexture,i.TEXTURE0+W)}h(V,"setTexture3D");function j(ne,W){let _e=r.get(ne);if(ne.version>0&&_e.__version!==ne.version){oe(_e,ne,W);return}t.bindTexture(i.TEXTURE_CUBE_MAP,_e.__webglTexture,i.TEXTURE0+W)}h(j,"setTextureCube");let q={[po]:i.REPEAT,[ho]:i.CLAMP_TO_EDGE,[g3]:i.MIRRORED_REPEAT},ee={[Xr]:i.NEAREST,[_A]:i.NEAREST_MIPMAP_NEAREST,[Ed]:i.NEAREST_MIPMAP_LINEAR,[Fn]:i.LINEAR,[Q_]:i.LINEAR_MIPMAP_NEAREST,[Pu]:i.LINEAR_MIPMAP_LINEAR},ae={[zfe]:i.NEVER,[Vfe]:i.ALWAYS,[Bfe]:i.LESS,[kH]:i.LEQUAL,[Ofe]:i.EQUAL,[Ufe]:i.GEQUAL,[Nfe]:i.GREATER,[$fe]:i.NOTEQUAL};function N(ne,W,_e){if(W.type===na&&e.has("OES_texture_float_linear")===!1&&(W.magFilter===Fn||W.magFilter===Q_||W.magFilter===Ed||W.magFilter===Pu||W.minFilter===Fn||W.minFilter===Q_||W.minFilter===Ed||W.minFilter===Pu)&&console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),_e?(i.texParameteri(ne,i.TEXTURE_WRAP_S,q[W.wrapS]),i.texParameteri(ne,i.TEXTURE_WRAP_T,q[W.wrapT]),(ne===i.TEXTURE_3D||ne===i.TEXTURE_2D_ARRAY)&&i.texParameteri(ne,i.TEXTURE_WRAP_R,q[W.wrapR]),i.texParameteri(ne,i.TEXTURE_MAG_FILTER,ee[W.magFilter]),i.texParameteri(ne,i.TEXTURE_MIN_FILTER,ee[W.minFilter])):(i.texParameteri(ne,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(ne,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),(ne===i.TEXTURE_3D||ne===i.TEXTURE_2D_ARRAY)&&i.texParameteri(ne,i.TEXTURE_WRAP_R,i.CLAMP_TO_EDGE),(W.wrapS!==ho||W.wrapT!==ho)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),i.texParameteri(ne,i.TEXTURE_MAG_FILTER,L(W.magFilter)),i.texParameteri(ne,i.TEXTURE_MIN_FILTER,L(W.minFilter)),W.minFilter!==Xr&&W.minFilter!==Fn&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),W.compareFunction&&(i.texParameteri(ne,i.TEXTURE_COMPARE_MODE,i.COMPARE_REF_TO_TEXTURE),i.texParameteri(ne,i.TEXTURE_COMPARE_FUNC,ae[W.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){if(W.magFilter===Xr||W.minFilter!==Ed&&W.minFilter!==Pu||W.type===na&&e.has("OES_texture_float_linear")===!1||s===!1&&W.type===Tm&&e.has("OES_texture_half_float_linear")===!1)return;if(W.anisotropy>1||r.get(W).__currentAnisotropy){let Re=e.get("EXT_texture_filter_anisotropic");i.texParameterf(ne,Re.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(W.anisotropy,n.getMaxAnisotropy())),r.get(W).__currentAnisotropy=W.anisotropy}}}h(N,"setTextureParameters");function J(ne,W){let _e=!1;ne.__webglInit===void 0&&(ne.__webglInit=!0,W.addEventListener("dispose",D));let Re=W.source,Ne=m.get(Re);Ne===void 0&&(Ne={},m.set(Re,Ne));let ze=G(W);if(ze!==ne.__cacheKey){Ne[ze]===void 0&&(Ne[ze]={texture:i.createTexture(),usedTimes:0},o.memory.textures++,_e=!0),Ne[ze].usedTimes++;let xt=Ne[ne.__cacheKey];xt!==void 0&&(Ne[ne.__cacheKey].usedTimes--,xt.usedTimes===0&&k(W)),ne.__cacheKey=ze,ne.__webglTexture=Ne[ze].texture}return _e}h(J,"initTexture");function Y(ne,W,_e){let Re=i.TEXTURE_2D;(W.isDataArrayTexture||W.isCompressedArrayTexture)&&(Re=i.TEXTURE_2D_ARRAY),W.isData3DTexture&&(Re=i.TEXTURE_3D);let Ne=J(ne,W),ze=W.source;t.bindTexture(Re,ne.__webglTexture,i.TEXTURE0+_e);let xt=r.get(ze);if(ze.version!==xt.__version||Ne===!0){t.activeTexture(i.TEXTURE0+_e);let ot=Si.getPrimaries(Si.workingColorSpace),je=W.colorSpace===pl?null:Si.getPrimaries(W.colorSpace),He=W.colorSpace===pl||ot===je?i.NONE:i.BROWSER_DEFAULT_WEBGL;i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,W.flipY),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,W.premultiplyAlpha),i.pixelStorei(i.UNPACK_ALIGNMENT,W.unpackAlignment),i.pixelStorei(i.UNPACK_COLORSPACE_CONVERSION_WEBGL,He);let bt=w(W)&&v(W.image)===!1,Xe=x(W.image,bt,!1,n.maxTextureSize);Xe=Ze(W,Xe);let ti=v(Xe)||s,At=a.convert(W.format,W.colorSpace),ue=a.convert(W.type),he=E(W.internalFormat,At,ue,W.colorSpace,W.isVideoTexture);N(Re,W,ti);let We,pt=W.mipmaps,ut=s&&W.isVideoTexture!==!0&&he!==DH,ct=xt.__version===void 0||Ne===!0,ce=ze.dataReady,et=T(W,Xe,ti);if(W.isDepthTexture)he=i.DEPTH_COMPONENT,s?W.type===na?he=i.DEPTH_COMPONENT32F:W.type===yl?he=i.DEPTH_COMPONENT24:W.type===zu?he=i.DEPTH24_STENCIL8:he=i.DEPTH_COMPONENT16:W.type===na&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),W.format===Bu&&he===i.DEPTH_COMPONENT&&W.type!==yE&&W.type!==yl&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),W.type=yl,ue=a.convert(W.type)),W.format===$p&&he===i.DEPTH_COMPONENT&&(he=i.DEPTH_STENCIL,W.type!==zu&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),W.type=zu,ue=a.convert(W.type))),ct&&(ut?t.texStorage2D(i.TEXTURE_2D,1,he,Xe.width,Xe.height):t.texImage2D(i.TEXTURE_2D,0,he,Xe.width,Xe.height,0,At,ue,null));else if(W.isDataTexture)if(pt.length>0&&ti){ut&&ct&&t.texStorage2D(i.TEXTURE_2D,et,he,pt[0].width,pt[0].height);for(let be=0,Ge=pt.length;be<Ge;be++)We=pt[be],ut?ce&&t.texSubImage2D(i.TEXTURE_2D,be,0,0,We.width,We.height,At,ue,We.data):t.texImage2D(i.TEXTURE_2D,be,he,We.width,We.height,0,At,ue,We.data);W.generateMipmaps=!1}else ut?(ct&&t.texStorage2D(i.TEXTURE_2D,et,he,Xe.width,Xe.height),ce&&t.texSubImage2D(i.TEXTURE_2D,0,0,0,Xe.width,Xe.height,At,ue,Xe.data)):t.texImage2D(i.TEXTURE_2D,0,he,Xe.width,Xe.height,0,At,ue,Xe.data);else if(W.isCompressedTexture)if(W.isCompressedArrayTexture){ut&&ct&&t.texStorage3D(i.TEXTURE_2D_ARRAY,et,he,pt[0].width,pt[0].height,Xe.depth);for(let be=0,Ge=pt.length;be<Ge;be++)We=pt[be],W.format!==$n?At!==null?ut?ce&&t.compressedTexSubImage3D(i.TEXTURE_2D_ARRAY,be,0,0,0,We.width,We.height,Xe.depth,At,We.data,0,0):t.compressedTexImage3D(i.TEXTURE_2D_ARRAY,be,he,We.width,We.height,Xe.depth,0,We.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):ut?ce&&t.texSubImage3D(i.TEXTURE_2D_ARRAY,be,0,0,0,We.width,We.height,Xe.depth,At,ue,We.data):t.texImage3D(i.TEXTURE_2D_ARRAY,be,he,We.width,We.height,Xe.depth,0,At,ue,We.data)}else{ut&&ct&&t.texStorage2D(i.TEXTURE_2D,et,he,pt[0].width,pt[0].height);for(let be=0,Ge=pt.length;be<Ge;be++)We=pt[be],W.format!==$n?At!==null?ut?ce&&t.compressedTexSubImage2D(i.TEXTURE_2D,be,0,0,We.width,We.height,At,We.data):t.compressedTexImage2D(i.TEXTURE_2D,be,he,We.width,We.height,0,We.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):ut?ce&&t.texSubImage2D(i.TEXTURE_2D,be,0,0,We.width,We.height,At,ue,We.data):t.texImage2D(i.TEXTURE_2D,be,he,We.width,We.height,0,At,ue,We.data)}else if(W.isDataArrayTexture)ut?(ct&&t.texStorage3D(i.TEXTURE_2D_ARRAY,et,he,Xe.width,Xe.height,Xe.depth),ce&&t.texSubImage3D(i.TEXTURE_2D_ARRAY,0,0,0,0,Xe.width,Xe.height,Xe.depth,At,ue,Xe.data)):t.texImage3D(i.TEXTURE_2D_ARRAY,0,he,Xe.width,Xe.height,Xe.depth,0,At,ue,Xe.data);else if(W.isData3DTexture)ut?(ct&&t.texStorage3D(i.TEXTURE_3D,et,he,Xe.width,Xe.height,Xe.depth),ce&&t.texSubImage3D(i.TEXTURE_3D,0,0,0,0,Xe.width,Xe.height,Xe.depth,At,ue,Xe.data)):t.texImage3D(i.TEXTURE_3D,0,he,Xe.width,Xe.height,Xe.depth,0,At,ue,Xe.data);else if(W.isFramebufferTexture){if(ct)if(ut)t.texStorage2D(i.TEXTURE_2D,et,he,Xe.width,Xe.height);else{let be=Xe.width,Ge=Xe.height;for(let tt=0;tt<et;tt++)t.texImage2D(i.TEXTURE_2D,tt,he,be,Ge,0,At,ue,null),be>>=1,Ge>>=1}}else if(pt.length>0&&ti){if(ut&&ct){let be=yt(pt[0]);t.texStorage2D(i.TEXTURE_2D,et,he,be.width,be.height)}for(let be=0,Ge=pt.length;be<Ge;be++)We=pt[be],ut?ce&&t.texSubImage2D(i.TEXTURE_2D,be,0,0,At,ue,We):t.texImage2D(i.TEXTURE_2D,be,he,At,ue,We);W.generateMipmaps=!1}else if(ut){if(ct){let be=yt(Xe);t.texStorage2D(i.TEXTURE_2D,et,he,be.width,be.height)}ce&&t.texSubImage2D(i.TEXTURE_2D,0,0,0,At,ue,Xe)}else t.texImage2D(i.TEXTURE_2D,0,he,At,ue,Xe);_(W,ti)&&C(Re),xt.__version=ze.version,W.onUpdate&&W.onUpdate(W)}ne.__version=W.version}h(Y,"uploadTexture");function oe(ne,W,_e){if(W.image.length!==6)return;let Re=J(ne,W),Ne=W.source;t.bindTexture(i.TEXTURE_CUBE_MAP,ne.__webglTexture,i.TEXTURE0+_e);let ze=r.get(Ne);if(Ne.version!==ze.__version||Re===!0){t.activeTexture(i.TEXTURE0+_e);let xt=Si.getPrimaries(Si.workingColorSpace),ot=W.colorSpace===pl?null:Si.getPrimaries(W.colorSpace),je=W.colorSpace===pl||xt===ot?i.NONE:i.BROWSER_DEFAULT_WEBGL;i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,W.flipY),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,W.premultiplyAlpha),i.pixelStorei(i.UNPACK_ALIGNMENT,W.unpackAlignment),i.pixelStorei(i.UNPACK_COLORSPACE_CONVERSION_WEBGL,je);let He=W.isCompressedTexture||W.image[0].isCompressedTexture,bt=W.image[0]&&W.image[0].isDataTexture,Xe=[];for(let be=0;be<6;be++)!He&&!bt?Xe[be]=x(W.image[be],!1,!0,n.maxCubemapSize):Xe[be]=bt?W.image[be].image:W.image[be],Xe[be]=Ze(W,Xe[be]);let ti=Xe[0],At=v(ti)||s,ue=a.convert(W.format,W.colorSpace),he=a.convert(W.type),We=E(W.internalFormat,ue,he,W.colorSpace),pt=s&&W.isVideoTexture!==!0,ut=ze.__version===void 0||Re===!0,ct=Ne.dataReady,ce=T(W,ti,At);N(i.TEXTURE_CUBE_MAP,W,At);let et;if(He){pt&&ut&&t.texStorage2D(i.TEXTURE_CUBE_MAP,ce,We,ti.width,ti.height);for(let be=0;be<6;be++){et=Xe[be].mipmaps;for(let Ge=0;Ge<et.length;Ge++){let tt=et[Ge];W.format!==$n?ue!==null?pt?ct&&t.compressedTexSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+be,Ge,0,0,tt.width,tt.height,ue,tt.data):t.compressedTexImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+be,Ge,We,tt.width,tt.height,0,tt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):pt?ct&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+be,Ge,0,0,tt.width,tt.height,ue,he,tt.data):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+be,Ge,We,tt.width,tt.height,0,ue,he,tt.data)}}}else{if(et=W.mipmaps,pt&&ut){et.length>0&&ce++;let be=yt(Xe[0]);t.texStorage2D(i.TEXTURE_CUBE_MAP,ce,We,be.width,be.height)}for(let be=0;be<6;be++)if(bt){pt?ct&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+be,0,0,0,Xe[be].width,Xe[be].height,ue,he,Xe[be].data):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+be,0,We,Xe[be].width,Xe[be].height,0,ue,he,Xe[be].data);for(let Ge=0;Ge<et.length;Ge++){let tt=et[Ge].image[be].image;pt?ct&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+be,Ge+1,0,0,tt.width,tt.height,ue,he,tt.data):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+be,Ge+1,We,tt.width,tt.height,0,ue,he,tt.data)}}else{pt?ct&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+be,0,0,0,ue,he,Xe[be]):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+be,0,We,ue,he,Xe[be]);for(let Ge=0;Ge<et.length;Ge++){let tt=et[Ge];pt?ct&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+be,Ge+1,0,0,ue,he,tt.image[be]):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+be,Ge+1,We,ue,he,tt.image[be])}}}_(W,At)&&C(i.TEXTURE_CUBE_MAP),ze.__version=Ne.version,W.onUpdate&&W.onUpdate(W)}ne.__version=W.version}h(oe,"uploadCubeTexture");function xe(ne,W,_e,Re,Ne,ze){let xt=a.convert(_e.format,_e.colorSpace),ot=a.convert(_e.type),je=E(_e.internalFormat,xt,ot,_e.colorSpace);if(!r.get(W).__hasExternalTextures){let He=Math.max(1,W.width>>ze),bt=Math.max(1,W.height>>ze);Ne===i.TEXTURE_3D||Ne===i.TEXTURE_2D_ARRAY?t.texImage3D(Ne,ze,je,He,bt,W.depth,0,xt,ot,null):t.texImage2D(Ne,ze,je,He,bt,0,xt,ot,null)}t.bindFramebuffer(i.FRAMEBUFFER,ne),we(W)?l.framebufferTexture2DMultisampleEXT(i.FRAMEBUFFER,Re,Ne,r.get(_e).__webglTexture,0,De(W)):(Ne===i.TEXTURE_2D||Ne>=i.TEXTURE_CUBE_MAP_POSITIVE_X&&Ne<=i.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&i.framebufferTexture2D(i.FRAMEBUFFER,Re,Ne,r.get(_e).__webglTexture,ze),t.bindFramebuffer(i.FRAMEBUFFER,null)}h(xe,"setupFrameBufferTexture");function ge(ne,W,_e){if(i.bindRenderbuffer(i.RENDERBUFFER,ne),W.depthBuffer&&!W.stencilBuffer){let Re=s===!0?i.DEPTH_COMPONENT24:i.DEPTH_COMPONENT16;if(_e||we(W)){let Ne=W.depthTexture;Ne&&Ne.isDepthTexture&&(Ne.type===na?Re=i.DEPTH_COMPONENT32F:Ne.type===yl&&(Re=i.DEPTH_COMPONENT24));let ze=De(W);we(W)?l.renderbufferStorageMultisampleEXT(i.RENDERBUFFER,ze,Re,W.width,W.height):i.renderbufferStorageMultisample(i.RENDERBUFFER,ze,Re,W.width,W.height)}else i.renderbufferStorage(i.RENDERBUFFER,Re,W.width,W.height);i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.RENDERBUFFER,ne)}else if(W.depthBuffer&&W.stencilBuffer){let Re=De(W);_e&&we(W)===!1?i.renderbufferStorageMultisample(i.RENDERBUFFER,Re,i.DEPTH24_STENCIL8,W.width,W.height):we(W)?l.renderbufferStorageMultisampleEXT(i.RENDERBUFFER,Re,i.DEPTH24_STENCIL8,W.width,W.height):i.renderbufferStorage(i.RENDERBUFFER,i.DEPTH_STENCIL,W.width,W.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.RENDERBUFFER,ne)}else{let Re=W.textures;for(let Ne=0;Ne<Re.length;Ne++){let ze=Re[Ne],xt=a.convert(ze.format,ze.colorSpace),ot=a.convert(ze.type),je=E(ze.internalFormat,xt,ot,ze.colorSpace),He=De(W);_e&&we(W)===!1?i.renderbufferStorageMultisample(i.RENDERBUFFER,He,je,W.width,W.height):we(W)?l.renderbufferStorageMultisampleEXT(i.RENDERBUFFER,He,je,W.width,W.height):i.renderbufferStorage(i.RENDERBUFFER,je,W.width,W.height)}}i.bindRenderbuffer(i.RENDERBUFFER,null)}h(ge,"setupRenderBufferStorage");function Te(ne,W){if(W&&W.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(i.FRAMEBUFFER,ne),!(W.depthTexture&&W.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!r.get(W.depthTexture).__webglTexture||W.depthTexture.image.width!==W.width||W.depthTexture.image.height!==W.height)&&(W.depthTexture.image.width=W.width,W.depthTexture.image.height=W.height,W.depthTexture.needsUpdate=!0),K(W.depthTexture,0);let _e=r.get(W.depthTexture).__webglTexture,Re=De(W);if(W.depthTexture.format===Bu)we(W)?l.framebufferTexture2DMultisampleEXT(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.TEXTURE_2D,_e,0,Re):i.framebufferTexture2D(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.TEXTURE_2D,_e,0);else if(W.depthTexture.format===$p)we(W)?l.framebufferTexture2DMultisampleEXT(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.TEXTURE_2D,_e,0,Re):i.framebufferTexture2D(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.TEXTURE_2D,_e,0);else throw new Error("Unknown depthTexture format")}h(Te,"setupDepthTexture");function me(ne){let W=r.get(ne),_e=ne.isWebGLCubeRenderTarget===!0;if(ne.depthTexture&&!W.__autoAllocateDepthBuffer){if(_e)throw new Error("target.depthTexture not supported in Cube render targets");Te(W.__webglFramebuffer,ne)}else if(_e){W.__webglDepthbuffer=[];for(let Re=0;Re<6;Re++)t.bindFramebuffer(i.FRAMEBUFFER,W.__webglFramebuffer[Re]),W.__webglDepthbuffer[Re]=i.createRenderbuffer(),ge(W.__webglDepthbuffer[Re],ne,!1)}else t.bindFramebuffer(i.FRAMEBUFFER,W.__webglFramebuffer),W.__webglDepthbuffer=i.createRenderbuffer(),ge(W.__webglDepthbuffer,ne,!1);t.bindFramebuffer(i.FRAMEBUFFER,null)}h(me,"setupDepthRenderbuffer");function Q(ne,W,_e){let Re=r.get(ne);W!==void 0&&xe(Re.__webglFramebuffer,ne,ne.texture,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,0),_e!==void 0&&me(ne)}h(Q,"rebindTextures");function Me(ne){let W=ne.texture,_e=r.get(ne),Re=r.get(W);ne.addEventListener("dispose",B);let Ne=ne.textures,ze=ne.isWebGLCubeRenderTarget===!0,xt=Ne.length>1,ot=v(ne)||s;if(xt||(Re.__webglTexture===void 0&&(Re.__webglTexture=i.createTexture()),Re.__version=W.version,o.memory.textures++),ze){_e.__webglFramebuffer=[];for(let je=0;je<6;je++)if(s&&W.mipmaps&&W.mipmaps.length>0){_e.__webglFramebuffer[je]=[];for(let He=0;He<W.mipmaps.length;He++)_e.__webglFramebuffer[je][He]=i.createFramebuffer()}else _e.__webglFramebuffer[je]=i.createFramebuffer()}else{if(s&&W.mipmaps&&W.mipmaps.length>0){_e.__webglFramebuffer=[];for(let je=0;je<W.mipmaps.length;je++)_e.__webglFramebuffer[je]=i.createFramebuffer()}else _e.__webglFramebuffer=i.createFramebuffer();if(xt)if(n.drawBuffers)for(let je=0,He=Ne.length;je<He;je++){let bt=r.get(Ne[je]);bt.__webglTexture===void 0&&(bt.__webglTexture=i.createTexture(),o.memory.textures++)}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(s&&ne.samples>0&&we(ne)===!1){_e.__webglMultisampledFramebuffer=i.createFramebuffer(),_e.__webglColorRenderbuffer=[],t.bindFramebuffer(i.FRAMEBUFFER,_e.__webglMultisampledFramebuffer);for(let je=0;je<Ne.length;je++){let He=Ne[je];_e.__webglColorRenderbuffer[je]=i.createRenderbuffer(),i.bindRenderbuffer(i.RENDERBUFFER,_e.__webglColorRenderbuffer[je]);let bt=a.convert(He.format,He.colorSpace),Xe=a.convert(He.type),ti=E(He.internalFormat,bt,Xe,He.colorSpace,ne.isXRRenderTarget===!0),At=De(ne);i.renderbufferStorageMultisample(i.RENDERBUFFER,At,ti,ne.width,ne.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+je,i.RENDERBUFFER,_e.__webglColorRenderbuffer[je])}i.bindRenderbuffer(i.RENDERBUFFER,null),ne.depthBuffer&&(_e.__webglDepthRenderbuffer=i.createRenderbuffer(),ge(_e.__webglDepthRenderbuffer,ne,!0)),t.bindFramebuffer(i.FRAMEBUFFER,null)}}if(ze){t.bindTexture(i.TEXTURE_CUBE_MAP,Re.__webglTexture),N(i.TEXTURE_CUBE_MAP,W,ot);for(let je=0;je<6;je++)if(s&&W.mipmaps&&W.mipmaps.length>0)for(let He=0;He<W.mipmaps.length;He++)xe(_e.__webglFramebuffer[je][He],ne,W,i.COLOR_ATTACHMENT0,i.TEXTURE_CUBE_MAP_POSITIVE_X+je,He);else xe(_e.__webglFramebuffer[je],ne,W,i.COLOR_ATTACHMENT0,i.TEXTURE_CUBE_MAP_POSITIVE_X+je,0);_(W,ot)&&C(i.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(xt){for(let je=0,He=Ne.length;je<He;je++){let bt=Ne[je],Xe=r.get(bt);t.bindTexture(i.TEXTURE_2D,Xe.__webglTexture),N(i.TEXTURE_2D,bt,ot),xe(_e.__webglFramebuffer,ne,bt,i.COLOR_ATTACHMENT0+je,i.TEXTURE_2D,0),_(bt,ot)&&C(i.TEXTURE_2D)}t.unbindTexture()}else{let je=i.TEXTURE_2D;if((ne.isWebGL3DRenderTarget||ne.isWebGLArrayRenderTarget)&&(s?je=ne.isWebGL3DRenderTarget?i.TEXTURE_3D:i.TEXTURE_2D_ARRAY:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),t.bindTexture(je,Re.__webglTexture),N(je,W,ot),s&&W.mipmaps&&W.mipmaps.length>0)for(let He=0;He<W.mipmaps.length;He++)xe(_e.__webglFramebuffer[He],ne,W,i.COLOR_ATTACHMENT0,je,He);else xe(_e.__webglFramebuffer,ne,W,i.COLOR_ATTACHMENT0,je,0);_(W,ot)&&C(je),t.unbindTexture()}ne.depthBuffer&&me(ne)}h(Me,"setupRenderTarget");function ve(ne){let W=v(ne)||s,_e=ne.textures;for(let Re=0,Ne=_e.length;Re<Ne;Re++){let ze=_e[Re];if(_(ze,W)){let xt=ne.isWebGLCubeRenderTarget?i.TEXTURE_CUBE_MAP:i.TEXTURE_2D,ot=r.get(ze).__webglTexture;t.bindTexture(xt,ot),C(xt),t.unbindTexture()}}}h(ve,"updateRenderTargetMipmap");function Ie(ne){if(s&&ne.samples>0&&we(ne)===!1){let W=ne.textures,_e=ne.width,Re=ne.height,Ne=i.COLOR_BUFFER_BIT,ze=[],xt=ne.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT,ot=r.get(ne),je=W.length>1;if(je)for(let He=0;He<W.length;He++)t.bindFramebuffer(i.FRAMEBUFFER,ot.__webglMultisampledFramebuffer),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+He,i.RENDERBUFFER,null),t.bindFramebuffer(i.FRAMEBUFFER,ot.__webglFramebuffer),i.framebufferTexture2D(i.DRAW_FRAMEBUFFER,i.COLOR_ATTACHMENT0+He,i.TEXTURE_2D,null,0);t.bindFramebuffer(i.READ_FRAMEBUFFER,ot.__webglMultisampledFramebuffer),t.bindFramebuffer(i.DRAW_FRAMEBUFFER,ot.__webglFramebuffer);for(let He=0;He<W.length;He++){ze.push(i.COLOR_ATTACHMENT0+He),ne.depthBuffer&&ze.push(xt);let bt=ot.__ignoreDepthValues!==void 0?ot.__ignoreDepthValues:!1;if(bt===!1&&(ne.depthBuffer&&(Ne|=i.DEPTH_BUFFER_BIT),ne.stencilBuffer&&(Ne|=i.STENCIL_BUFFER_BIT)),je&&i.framebufferRenderbuffer(i.READ_FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.RENDERBUFFER,ot.__webglColorRenderbuffer[He]),bt===!0&&(i.invalidateFramebuffer(i.READ_FRAMEBUFFER,[xt]),i.invalidateFramebuffer(i.DRAW_FRAMEBUFFER,[xt])),je){let Xe=r.get(W[He]).__webglTexture;i.framebufferTexture2D(i.DRAW_FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,Xe,0)}i.blitFramebuffer(0,0,_e,Re,0,0,_e,Re,Ne,i.NEAREST),u&&i.invalidateFramebuffer(i.READ_FRAMEBUFFER,ze)}if(t.bindFramebuffer(i.READ_FRAMEBUFFER,null),t.bindFramebuffer(i.DRAW_FRAMEBUFFER,null),je)for(let He=0;He<W.length;He++){t.bindFramebuffer(i.FRAMEBUFFER,ot.__webglMultisampledFramebuffer),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+He,i.RENDERBUFFER,ot.__webglColorRenderbuffer[He]);let bt=r.get(W[He]).__webglTexture;t.bindFramebuffer(i.FRAMEBUFFER,ot.__webglFramebuffer),i.framebufferTexture2D(i.DRAW_FRAMEBUFFER,i.COLOR_ATTACHMENT0+He,i.TEXTURE_2D,bt,0)}t.bindFramebuffer(i.DRAW_FRAMEBUFFER,ot.__webglMultisampledFramebuffer)}}h(Ie,"updateMultisampleRenderTarget");function De(ne){return Math.min(n.maxSamples,ne.samples)}h(De,"getRenderTargetSamples");function we(ne){let W=r.get(ne);return s&&ne.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&W.__useRenderToTexture!==!1}h(we,"useMultisampledRTT");function Fe(ne){let W=o.render.frame;p.get(ne)!==W&&(p.set(ne,W),ne.update())}h(Fe,"updateVideoTexture");function Ze(ne,W){let _e=ne.colorSpace,Re=ne.format,Ne=ne.type;return ne.isCompressedTexture===!0||ne.isVideoTexture===!0||ne.format===v3||_e!==Gl&&_e!==pl&&(Si.getTransfer(_e)===Di?s===!1?e.has("EXT_sRGB")===!0&&Re===$n?(ne.format=v3,ne.minFilter=Fn,ne.generateMipmaps=!1):W=tG.sRGBToLinear(W):(Re!==$n||Ne!==Ll)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",_e)),W}h(Ze,"verifyColorSpace");function yt(ne){return typeof HTMLImageElement<"u"&&ne instanceof HTMLImageElement?(c.width=ne.naturalWidth||ne.width,c.height=ne.naturalHeight||ne.height):typeof VideoFrame<"u"&&ne instanceof VideoFrame?(c.width=ne.displayWidth,c.height=ne.displayHeight):(c.width=ne.width,c.height=ne.height),c}h(yt,"getDimensions"),this.allocateTextureUnit=U,this.resetTextureUnits=P,this.setTexture2D=K,this.setTexture2DArray=z,this.setTexture3D=V,this.setTextureCube=j,this.rebindTextures=Q,this.setupRenderTarget=Me,this.updateRenderTargetMipmap=ve,this.updateMultisampleRenderTarget=Ie,this.setupDepthRenderbuffer=me,this.setupFrameBufferTexture=xe,this.useMultisampledRTT=we}h(qX,"WebGLTextures");function ZX(i,e,t){let r=t.isWebGL2;function n(a,o=pl){let s,l=Si.getTransfer(o);if(a===Ll)return i.UNSIGNED_BYTE;if(a===EH)return i.UNSIGNED_SHORT_4_4_4_4;if(a===TH)return i.UNSIGNED_SHORT_5_5_5_1;if(a===Sfe)return i.BYTE;if(a===Mfe)return i.SHORT;if(a===yE)return i.UNSIGNED_SHORT;if(a===CH)return i.INT;if(a===yl)return i.UNSIGNED_INT;if(a===na)return i.FLOAT;if(a===Tm)return r?i.HALF_FLOAT:(s=e.get("OES_texture_half_float"),s!==null?s.HALF_FLOAT_OES:null);if(a===Cfe)return i.ALPHA;if(a===$n)return i.RGBA;if(a===Efe)return i.LUMINANCE;if(a===Tfe)return i.LUMINANCE_ALPHA;if(a===Bu)return i.DEPTH_COMPONENT;if(a===$p)return i.DEPTH_STENCIL;if(a===v3)return s=e.get("EXT_sRGB"),s!==null?s.SRGB_ALPHA_EXT:null;if(a===PH)return i.RED;if(a===AH)return i.RED_INTEGER;if(a===Pfe)return i.RG;if(a===IH)return i.RG_INTEGER;if(a===LH)return i.RGBA_INTEGER;if(a===e2||a===t2||a===i2||a===r2)if(l===Di)if(s=e.get("WEBGL_compressed_texture_s3tc_srgb"),s!==null){if(a===e2)return s.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(a===t2)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(a===i2)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(a===r2)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(s=e.get("WEBGL_compressed_texture_s3tc"),s!==null){if(a===e2)return s.COMPRESSED_RGB_S3TC_DXT1_EXT;if(a===t2)return s.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(a===i2)return s.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(a===r2)return s.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(a===bA||a===wA||a===SA||a===MA)if(s=e.get("WEBGL_compressed_texture_pvrtc"),s!==null){if(a===bA)return s.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(a===wA)return s.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(a===SA)return s.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(a===MA)return s.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(a===DH)return s=e.get("WEBGL_compressed_texture_etc1"),s!==null?s.COMPRESSED_RGB_ETC1_WEBGL:null;if(a===CA||a===EA)if(s=e.get("WEBGL_compressed_texture_etc"),s!==null){if(a===CA)return l===Di?s.COMPRESSED_SRGB8_ETC2:s.COMPRESSED_RGB8_ETC2;if(a===EA)return l===Di?s.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:s.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(a===TA||a===PA||a===AA||a===IA||a===LA||a===DA||a===kA||a===RA||a===FA||a===zA||a===BA||a===OA||a===NA||a===$A)if(s=e.get("WEBGL_compressed_texture_astc"),s!==null){if(a===TA)return l===Di?s.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:s.COMPRESSED_RGBA_ASTC_4x4_KHR;if(a===PA)return l===Di?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:s.COMPRESSED_RGBA_ASTC_5x4_KHR;if(a===AA)return l===Di?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:s.COMPRESSED_RGBA_ASTC_5x5_KHR;if(a===IA)return l===Di?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:s.COMPRESSED_RGBA_ASTC_6x5_KHR;if(a===LA)return l===Di?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:s.COMPRESSED_RGBA_ASTC_6x6_KHR;if(a===DA)return l===Di?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:s.COMPRESSED_RGBA_ASTC_8x5_KHR;if(a===kA)return l===Di?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:s.COMPRESSED_RGBA_ASTC_8x6_KHR;if(a===RA)return l===Di?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:s.COMPRESSED_RGBA_ASTC_8x8_KHR;if(a===FA)return l===Di?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:s.COMPRESSED_RGBA_ASTC_10x5_KHR;if(a===zA)return l===Di?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:s.COMPRESSED_RGBA_ASTC_10x6_KHR;if(a===BA)return l===Di?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:s.COMPRESSED_RGBA_ASTC_10x8_KHR;if(a===OA)return l===Di?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:s.COMPRESSED_RGBA_ASTC_10x10_KHR;if(a===NA)return l===Di?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:s.COMPRESSED_RGBA_ASTC_12x10_KHR;if(a===$A)return l===Di?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:s.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(a===n2||a===UA||a===VA)if(s=e.get("EXT_texture_compression_bptc"),s!==null){if(a===n2)return l===Di?s.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:s.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(a===UA)return s.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(a===VA)return s.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(a===Afe||a===jA||a===HA||a===GA)if(s=e.get("EXT_texture_compression_rgtc"),s!==null){if(a===n2)return s.COMPRESSED_RED_RGTC1_EXT;if(a===jA)return s.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(a===HA)return s.COMPRESSED_RED_GREEN_RGTC2_EXT;if(a===GA)return s.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return a===zu?r?i.UNSIGNED_INT_24_8:(s=e.get("WEBGL_depth_texture"),s!==null?s.UNSIGNED_INT_24_8_WEBGL:null):i[a]!==void 0?i[a]:null}return h(n,"convert"),{convert:n}}h(ZX,"WebGLUtils");var YX=class extends On{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}};h(YX,"ArrayCamera");var lye=YX,JX=class extends rr{constructor(){super(),this.isGroup=!0,this.type="Group"}};h(JX,"Group");var m1=JX,uye={type:"move"},KX=class{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new m1,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new m1,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new le,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new le),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new m1,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new le,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new le),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){let t=this._hand;if(t)for(let r of e.hand.values())this._getHandJoint(t,r)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,r){let n=null,a=null,o=null,s=this._targetRay,l=this._grip,u=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(u&&e.hand){o=!0;for(let b of e.hand.values()){let x=t.getJointPose(b,r),v=this._getHandJoint(u,b);x!==null&&(v.matrix.fromArray(x.transform.matrix),v.matrix.decompose(v.position,v.rotation,v.scale),v.matrixWorldNeedsUpdate=!0,v.jointRadius=x.radius),v.visible=x!==null}let c=u.joints["index-finger-tip"],p=u.joints["thumb-tip"],d=c.position.distanceTo(p.position),m=.02,g=.005;u.inputState.pinching&&d>m+g?(u.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!u.inputState.pinching&&d<=m-g&&(u.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else l!==null&&e.gripSpace&&(a=t.getPose(e.gripSpace,r),a!==null&&(l.matrix.fromArray(a.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),l.matrixWorldNeedsUpdate=!0,a.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(a.linearVelocity)):l.hasLinearVelocity=!1,a.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(a.angularVelocity)):l.hasAngularVelocity=!1));s!==null&&(n=t.getPose(e.targetRaySpace,r),n===null&&a!==null&&(n=a),n!==null&&(s.matrix.fromArray(n.transform.matrix),s.matrix.decompose(s.position,s.rotation,s.scale),s.matrixWorldNeedsUpdate=!0,n.linearVelocity?(s.hasLinearVelocity=!0,s.linearVelocity.copy(n.linearVelocity)):s.hasLinearVelocity=!1,n.angularVelocity?(s.hasAngularVelocity=!0,s.angularVelocity.copy(n.angularVelocity)):s.hasAngularVelocity=!1,this.dispatchEvent(uye)))}return s!==null&&(s.visible=n!==null),l!==null&&(l.visible=a!==null),u!==null&&(u.visible=o!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){let r=new m1;r.matrixAutoUpdate=!1,r.visible=!1,e.joints[t.jointName]=r,e.add(r)}return e.joints[t.jointName]}};h(KX,"WebXRController");var E2=KX,hye=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,cye=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepthEXT = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepthEXT = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`,QX=class{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,t,r){if(this.texture===null){let n=new En,a=e.properties.get(n);a.__webglTexture=t.texture,(t.depthNear!=r.depthNear||t.depthFar!=r.depthFar)&&(this.depthNear=t.depthNear,this.depthFar=t.depthFar),this.texture=n}}render(e,t){if(this.texture!==null){if(this.mesh===null){let r=t.cameras[0].viewport,n=new xo({extensions:{fragDepth:!0},vertexShader:hye,fragmentShader:cye,uniforms:{depthColor:{value:this.texture},depthWidth:{value:r.z},depthHeight:{value:r.w}}});this.mesh=new Wi(new rg(20,20),n)}e.render(this.mesh,t)}}reset(){this.texture=null,this.mesh=null}};h(QX,"WebXRDepthSensing");var pye=QX,eq=class extends id{constructor(e,t){super();let r=this,n=null,a=1,o=null,s="local-floor",l=1,u=null,c=null,p=null,d=null,m=null,g=null,b=new pye,x=t.getContextAttributes(),v=null,w=null,_=[],C=[],E=new Oe,T=null,L=new On;L.layers.enable(1),L.viewport=new Ei;let D=new On;D.layers.enable(2),D.viewport=new Ei;let B=[L,D],A=new lye;A.layers.enable(1),A.layers.enable(2);let k=null,$=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(N){let J=_[N];return J===void 0&&(J=new E2,_[N]=J),J.getTargetRaySpace()},this.getControllerGrip=function(N){let J=_[N];return J===void 0&&(J=new E2,_[N]=J),J.getGripSpace()},this.getHand=function(N){let J=_[N];return J===void 0&&(J=new E2,_[N]=J),J.getHandSpace()};function O(N){let J=C.indexOf(N.inputSource);if(J===-1)return;let Y=_[J];Y!==void 0&&(Y.update(N.inputSource,N.frame,u||o),Y.dispatchEvent({type:N.type,data:N.inputSource}))}h(O,"onSessionEvent");function P(){n.removeEventListener("select",O),n.removeEventListener("selectstart",O),n.removeEventListener("selectend",O),n.removeEventListener("squeeze",O),n.removeEventListener("squeezestart",O),n.removeEventListener("squeezeend",O),n.removeEventListener("end",P),n.removeEventListener("inputsourceschange",U);for(let N=0;N<_.length;N++){let J=C[N];J!==null&&(C[N]=null,_[N].disconnect(J))}k=null,$=null,b.reset(),e.setRenderTarget(v),m=null,d=null,p=null,n=null,w=null,ae.stop(),r.isPresenting=!1,e.setPixelRatio(T),e.setSize(E.width,E.height,!1),r.dispatchEvent({type:"sessionend"})}h(P,"onSessionEnd"),this.setFramebufferScaleFactor=function(N){a=N,r.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(N){s=N,r.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return u||o},this.setReferenceSpace=function(N){u=N},this.getBaseLayer=function(){return d!==null?d:m},this.getBinding=function(){return p},this.getFrame=function(){return g},this.getSession=function(){return n},this.setSession=async function(N){if(n=N,n!==null){if(v=e.getRenderTarget(),n.addEventListener("select",O),n.addEventListener("selectstart",O),n.addEventListener("selectend",O),n.addEventListener("squeeze",O),n.addEventListener("squeezestart",O),n.addEventListener("squeezeend",O),n.addEventListener("end",P),n.addEventListener("inputsourceschange",U),x.xrCompatible!==!0&&await t.makeXRCompatible(),T=e.getPixelRatio(),e.getSize(E),n.renderState.layers===void 0||e.capabilities.isWebGL2===!1){let J={antialias:n.renderState.layers===void 0?x.antialias:!0,alpha:!0,depth:x.depth,stencil:x.stencil,framebufferScaleFactor:a};m=new XRWebGLLayer(n,t,J),n.updateRenderState({baseLayer:m}),e.setPixelRatio(1),e.setSize(m.framebufferWidth,m.framebufferHeight,!1),w=new Qu(m.framebufferWidth,m.framebufferHeight,{format:$n,type:Ll,colorSpace:e.outputColorSpace,stencilBuffer:x.stencil})}else{let J=null,Y=null,oe=null;x.depth&&(oe=x.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,J=x.stencil?$p:Bu,Y=x.stencil?zu:yl);let xe={colorFormat:t.RGBA8,depthFormat:oe,scaleFactor:a};p=new XRWebGLBinding(n,t),d=p.createProjectionLayer(xe),n.updateRenderState({layers:[d]}),e.setPixelRatio(1),e.setSize(d.textureWidth,d.textureHeight,!1),w=new Qu(d.textureWidth,d.textureHeight,{format:$n,type:Ll,depthTexture:new _W(d.textureWidth,d.textureHeight,Y,void 0,void 0,void 0,void 0,void 0,void 0,J),stencilBuffer:x.stencil,colorSpace:e.outputColorSpace,samples:x.antialias?4:0});let ge=e.properties.get(w);ge.__ignoreDepthValues=d.ignoreDepthValues}w.isXRRenderTarget=!0,this.setFoveation(l),u=null,o=await n.requestReferenceSpace(s),ae.setContext(n),ae.start(),r.isPresenting=!0,r.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(n!==null)return n.environmentBlendMode};function U(N){for(let J=0;J<N.removed.length;J++){let Y=N.removed[J],oe=C.indexOf(Y);oe>=0&&(C[oe]=null,_[oe].disconnect(Y))}for(let J=0;J<N.added.length;J++){let Y=N.added[J],oe=C.indexOf(Y);if(oe===-1){for(let ge=0;ge<_.length;ge++)if(ge>=C.length){C.push(Y),oe=ge;break}else if(C[ge]===null){C[ge]=Y,oe=ge;break}if(oe===-1)break}let xe=_[oe];xe&&xe.connect(Y)}}h(U,"onInputSourcesChange");let G=new le,K=new le;function z(N,J,Y){G.setFromMatrixPosition(J.matrixWorld),K.setFromMatrixPosition(Y.matrixWorld);let oe=G.distanceTo(K),xe=J.projectionMatrix.elements,ge=Y.projectionMatrix.elements,Te=xe[14]/(xe[10]-1),me=xe[14]/(xe[10]+1),Q=(xe[9]+1)/xe[5],Me=(xe[9]-1)/xe[5],ve=(xe[8]-1)/xe[0],Ie=(ge[8]+1)/ge[0],De=Te*ve,we=Te*Ie,Fe=oe/(-ve+Ie),Ze=Fe*-ve;J.matrixWorld.decompose(N.position,N.quaternion,N.scale),N.translateX(Ze),N.translateZ(Fe),N.matrixWorld.compose(N.position,N.quaternion,N.scale),N.matrixWorldInverse.copy(N.matrixWorld).invert();let yt=Te+Fe,ne=me+Fe,W=De-Ze,_e=we+(oe-Ze),Re=Q*me/ne*yt,Ne=Me*me/ne*yt;N.projectionMatrix.makePerspective(W,_e,Re,Ne,yt,ne),N.projectionMatrixInverse.copy(N.projectionMatrix).invert()}h(z,"setProjectionFromUnion");function V(N,J){J===null?N.matrixWorld.copy(N.matrix):N.matrixWorld.multiplyMatrices(J.matrixWorld,N.matrix),N.matrixWorldInverse.copy(N.matrixWorld).invert()}h(V,"updateCamera"),this.updateCamera=function(N){if(n===null)return;b.texture!==null&&(N.near=b.depthNear,N.far=b.depthFar),A.near=D.near=L.near=N.near,A.far=D.far=L.far=N.far,(k!==A.near||$!==A.far)&&(n.updateRenderState({depthNear:A.near,depthFar:A.far}),k=A.near,$=A.far,L.near=k,L.far=$,D.near=k,D.far=$,L.updateProjectionMatrix(),D.updateProjectionMatrix(),N.updateProjectionMatrix());let J=N.parent,Y=A.cameras;V(A,J);for(let oe=0;oe<Y.length;oe++)V(Y[oe],J);Y.length===2?z(A,L,D):A.projectionMatrix.copy(L.projectionMatrix),j(N,A,J)};function j(N,J,Y){Y===null?N.matrix.copy(J.matrixWorld):(N.matrix.copy(Y.matrixWorld),N.matrix.invert(),N.matrix.multiply(J.matrixWorld)),N.matrix.decompose(N.position,N.quaternion,N.scale),N.updateMatrixWorld(!0),N.projectionMatrix.copy(J.projectionMatrix),N.projectionMatrixInverse.copy(J.projectionMatrixInverse),N.isPerspectiveCamera&&(N.fov=Up*2*Math.atan(1/N.projectionMatrix.elements[5]),N.zoom=1)}h(j,"updateUserCamera"),this.getCamera=function(){return A},this.getFoveation=function(){if(!(d===null&&m===null))return l},this.setFoveation=function(N){l=N,d!==null&&(d.fixedFoveation=N),m!==null&&m.fixedFoveation!==void 0&&(m.fixedFoveation=N)},this.hasDepthSensing=function(){return b.texture!==null};let q=null;function ee(N,J){if(c=J.getViewerPose(u||o),g=J,c!==null){let Y=c.views;m!==null&&(e.setRenderTargetFramebuffer(w,m.framebuffer),e.setRenderTarget(w));let oe=!1;Y.length!==A.cameras.length&&(A.cameras.length=0,oe=!0);for(let ge=0;ge<Y.length;ge++){let Te=Y[ge],me=null;if(m!==null)me=m.getViewport(Te);else{let Me=p.getViewSubImage(d,Te);me=Me.viewport,ge===0&&(e.setRenderTargetTextures(w,Me.colorTexture,d.ignoreDepthValues?void 0:Me.depthStencilTexture),e.setRenderTarget(w))}let Q=B[ge];Q===void 0&&(Q=new On,Q.layers.enable(ge),Q.viewport=new Ei,B[ge]=Q),Q.matrix.fromArray(Te.transform.matrix),Q.matrix.decompose(Q.position,Q.quaternion,Q.scale),Q.projectionMatrix.fromArray(Te.projectionMatrix),Q.projectionMatrixInverse.copy(Q.projectionMatrix).invert(),Q.viewport.set(me.x,me.y,me.width,me.height),ge===0&&(A.matrix.copy(Q.matrix),A.matrix.decompose(A.position,A.quaternion,A.scale)),oe===!0&&A.cameras.push(Q)}let xe=n.enabledFeatures;if(xe&&xe.includes("depth-sensing")){let ge=p.getDepthInformation(Y[0]);ge&&ge.isValid&&ge.texture&&b.init(e,ge,n.renderState)}}for(let Y=0;Y<_.length;Y++){let oe=C[Y],xe=_[Y];oe!==null&&xe!==void 0&&xe.update(oe,J,u||o)}b.render(e,A),q&&q(N,J),J.detectedPlanes&&r.dispatchEvent({type:"planesdetected",data:J}),g=null}h(ee,"onAnimationFrame");let ae=new CE;ae.setAnimationLoop(ee),this.setAnimationLoop=function(N){q=N},this.dispose=function(){}}};h(eq,"WebXRManager");var dye=eq,tu=new $a,fye=new jt;function tq(i,e){function t(x,v){x.matrixAutoUpdate===!0&&x.updateMatrix(),v.value.copy(x.matrix)}h(t,"refreshTransformUniform");function r(x,v){v.color.getRGB(x.fogColor.value,SE(i)),v.isFog?(x.fogNear.value=v.near,x.fogFar.value=v.far):v.isFogExp2&&(x.fogDensity.value=v.density)}h(r,"refreshFogUniforms");function n(x,v,w,_,C){v.isMeshBasicMaterial||v.isMeshLambertMaterial?a(x,v):v.isMeshToonMaterial?(a(x,v),p(x,v)):v.isMeshPhongMaterial?(a(x,v),c(x,v)):v.isMeshStandardMaterial?(a(x,v),d(x,v),v.isMeshPhysicalMaterial&&m(x,v,C)):v.isMeshMatcapMaterial?(a(x,v),g(x,v)):v.isMeshDepthMaterial?a(x,v):v.isMeshDistanceMaterial?(a(x,v),b(x,v)):v.isMeshNormalMaterial?a(x,v):v.isLineBasicMaterial?(o(x,v),v.isLineDashedMaterial&&s(x,v)):v.isPointsMaterial?l(x,v,w,_):v.isSpriteMaterial?u(x,v):v.isShadowMaterial?(x.color.value.copy(v.color),x.opacity.value=v.opacity):v.isShaderMaterial&&(v.uniformsNeedUpdate=!1)}h(n,"refreshMaterialUniforms");function a(x,v){x.opacity.value=v.opacity,v.color&&x.diffuse.value.copy(v.color),v.emissive&&x.emissive.value.copy(v.emissive).multiplyScalar(v.emissiveIntensity),v.map&&(x.map.value=v.map,t(v.map,x.mapTransform)),v.alphaMap&&(x.alphaMap.value=v.alphaMap,t(v.alphaMap,x.alphaMapTransform)),v.bumpMap&&(x.bumpMap.value=v.bumpMap,t(v.bumpMap,x.bumpMapTransform),x.bumpScale.value=v.bumpScale,v.side===Wn&&(x.bumpScale.value*=-1)),v.normalMap&&(x.normalMap.value=v.normalMap,t(v.normalMap,x.normalMapTransform),x.normalScale.value.copy(v.normalScale),v.side===Wn&&x.normalScale.value.negate()),v.displacementMap&&(x.displacementMap.value=v.displacementMap,t(v.displacementMap,x.displacementMapTransform),x.displacementScale.value=v.displacementScale,x.displacementBias.value=v.displacementBias),v.emissiveMap&&(x.emissiveMap.value=v.emissiveMap,t(v.emissiveMap,x.emissiveMapTransform)),v.specularMap&&(x.specularMap.value=v.specularMap,t(v.specularMap,x.specularMapTransform)),v.alphaTest>0&&(x.alphaTest.value=v.alphaTest);let w=e.get(v),_=w.envMap,C=w.envMapRotation;if(_&&(x.envMap.value=_,tu.copy(C),tu.x*=-1,tu.y*=-1,tu.z*=-1,_.isCubeTexture&&_.isRenderTargetTexture===!1&&(tu.y*=-1,tu.z*=-1),x.envMapRotation.value.setFromMatrix4(fye.makeRotationFromEuler(tu)),x.flipEnvMap.value=_.isCubeTexture&&_.isRenderTargetTexture===!1?-1:1,x.reflectivity.value=v.reflectivity,x.ior.value=v.ior,x.refractionRatio.value=v.refractionRatio),v.lightMap){x.lightMap.value=v.lightMap;let E=i._useLegacyLights===!0?Math.PI:1;x.lightMapIntensity.value=v.lightMapIntensity*E,t(v.lightMap,x.lightMapTransform)}v.aoMap&&(x.aoMap.value=v.aoMap,x.aoMapIntensity.value=v.aoMapIntensity,t(v.aoMap,x.aoMapTransform))}h(a,"refreshUniformsCommon");function o(x,v){x.diffuse.value.copy(v.color),x.opacity.value=v.opacity,v.map&&(x.map.value=v.map,t(v.map,x.mapTransform))}h(o,"refreshUniformsLine");function s(x,v){x.dashSize.value=v.dashSize,x.totalSize.value=v.dashSize+v.gapSize,x.scale.value=v.scale}h(s,"refreshUniformsDash");function l(x,v,w,_){x.diffuse.value.copy(v.color),x.opacity.value=v.opacity,x.size.value=v.size*w,x.scale.value=_*.5,v.map&&(x.map.value=v.map,t(v.map,x.uvTransform)),v.alphaMap&&(x.alphaMap.value=v.alphaMap,t(v.alphaMap,x.alphaMapTransform)),v.alphaTest>0&&(x.alphaTest.value=v.alphaTest)}h(l,"refreshUniformsPoints");function u(x,v){x.diffuse.value.copy(v.color),x.opacity.value=v.opacity,x.rotation.value=v.rotation,v.map&&(x.map.value=v.map,t(v.map,x.mapTransform)),v.alphaMap&&(x.alphaMap.value=v.alphaMap,t(v.alphaMap,x.alphaMapTransform)),v.alphaTest>0&&(x.alphaTest.value=v.alphaTest)}h(u,"refreshUniformsSprites");function c(x,v){x.specular.value.copy(v.specular),x.shininess.value=Math.max(v.shininess,1e-4)}h(c,"refreshUniformsPhong");function p(x,v){v.gradientMap&&(x.gradientMap.value=v.gradientMap)}h(p,"refreshUniformsToon");function d(x,v){x.metalness.value=v.metalness,v.metalnessMap&&(x.metalnessMap.value=v.metalnessMap,t(v.metalnessMap,x.metalnessMapTransform)),x.roughness.value=v.roughness,v.roughnessMap&&(x.roughnessMap.value=v.roughnessMap,t(v.roughnessMap,x.roughnessMapTransform)),e.get(v).envMap&&(x.envMapIntensity.value=v.envMapIntensity)}h(d,"refreshUniformsStandard");function m(x,v,w){x.ior.value=v.ior,v.sheen>0&&(x.sheenColor.value.copy(v.sheenColor).multiplyScalar(v.sheen),x.sheenRoughness.value=v.sheenRoughness,v.sheenColorMap&&(x.sheenColorMap.value=v.sheenColorMap,t(v.sheenColorMap,x.sheenColorMapTransform)),v.sheenRoughnessMap&&(x.sheenRoughnessMap.value=v.sheenRoughnessMap,t(v.sheenRoughnessMap,x.sheenRoughnessMapTransform))),v.clearcoat>0&&(x.clearcoat.value=v.clearcoat,x.clearcoatRoughness.value=v.clearcoatRoughness,v.clearcoatMap&&(x.clearcoatMap.value=v.clearcoatMap,t(v.clearcoatMap,x.clearcoatMapTransform)),v.clearcoatRoughnessMap&&(x.clearcoatRoughnessMap.value=v.clearcoatRoughnessMap,t(v.clearcoatRoughnessMap,x.clearcoatRoughnessMapTransform)),v.clearcoatNormalMap&&(x.clearcoatNormalMap.value=v.clearcoatNormalMap,t(v.clearcoatNormalMap,x.clearcoatNormalMapTransform),x.clearcoatNormalScale.value.copy(v.clearcoatNormalScale),v.side===Wn&&x.clearcoatNormalScale.value.negate())),v.iridescence>0&&(x.iridescence.value=v.iridescence,x.iridescenceIOR.value=v.iridescenceIOR,x.iridescenceThicknessMinimum.value=v.iridescenceThicknessRange[0],x.iridescenceThicknessMaximum.value=v.iridescenceThicknessRange[1],v.iridescenceMap&&(x.iridescenceMap.value=v.iridescenceMap,t(v.iridescenceMap,x.iridescenceMapTransform)),v.iridescenceThicknessMap&&(x.iridescenceThicknessMap.value=v.iridescenceThicknessMap,t(v.iridescenceThicknessMap,x.iridescenceThicknessMapTransform))),v.transmission>0&&(x.transmission.value=v.transmission,x.transmissionSamplerMap.value=w.texture,x.transmissionSamplerSize.value.set(w.width,w.height),v.transmissionMap&&(x.transmissionMap.value=v.transmissionMap,t(v.transmissionMap,x.transmissionMapTransform)),x.thickness.value=v.thickness,v.thicknessMap&&(x.thicknessMap.value=v.thicknessMap,t(v.thicknessMap,x.thicknessMapTransform)),x.attenuationDistance.value=v.attenuationDistance,x.attenuationColor.value.copy(v.attenuationColor)),v.anisotropy>0&&(x.anisotropyVector.value.set(v.anisotropy*Math.cos(v.anisotropyRotation),v.anisotropy*Math.sin(v.anisotropyRotation)),v.anisotropyMap&&(x.anisotropyMap.value=v.anisotropyMap,t(v.anisotropyMap,x.anisotropyMapTransform))),x.specularIntensity.value=v.specularIntensity,x.specularColor.value.copy(v.specularColor),v.specularColorMap&&(x.specularColorMap.value=v.specularColorMap,t(v.specularColorMap,x.specularColorMapTransform)),v.specularIntensityMap&&(x.specularIntensityMap.value=v.specularIntensityMap,t(v.specularIntensityMap,x.specularIntensityMapTransform))}h(m,"refreshUniformsPhysical");function g(x,v){v.matcap&&(x.matcap.value=v.matcap)}h(g,"refreshUniformsMatcap");function b(x,v){let w=e.get(v).light;x.referencePosition.value.setFromMatrixPosition(w.matrixWorld),x.nearDistance.value=w.shadow.camera.near,x.farDistance.value=w.shadow.camera.far}return h(b,"refreshUniformsDistance"),{refreshFogUniforms:r,refreshMaterialUniforms:n}}h(tq,"WebGLMaterials");function iq(i,e,t,r){let n={},a={},o=[],s=t.isWebGL2?i.getParameter(i.MAX_UNIFORM_BUFFER_BINDINGS):0;function l(w,_){let C=_.program;r.uniformBlockBinding(w,C)}h(l,"bind");function u(w,_){let C=n[w.id];C===void 0&&(g(w),C=c(w),n[w.id]=C,w.addEventListener("dispose",x));let E=_.program;r.updateUBOMapping(w,E);let T=e.render.frame;a[w.id]!==T&&(d(w),a[w.id]=T)}h(u,"update");function c(w){let _=p();w.__bindingPointIndex=_;let C=i.createBuffer(),E=w.__size,T=w.usage;return i.bindBuffer(i.UNIFORM_BUFFER,C),i.bufferData(i.UNIFORM_BUFFER,E,T),i.bindBuffer(i.UNIFORM_BUFFER,null),i.bindBufferBase(i.UNIFORM_BUFFER,_,C),C}h(c,"createBuffer");function p(){for(let w=0;w<s;w++)if(o.indexOf(w)===-1)return o.push(w),w;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}h(p,"allocateBindingPointIndex");function d(w){let _=n[w.id],C=w.uniforms,E=w.__cache;i.bindBuffer(i.UNIFORM_BUFFER,_);for(let T=0,L=C.length;T<L;T++){let D=Array.isArray(C[T])?C[T]:[C[T]];for(let B=0,A=D.length;B<A;B++){let k=D[B];if(m(k,T,B,E)===!0){let $=k.__offset,O=Array.isArray(k.value)?k.value:[k.value],P=0;for(let U=0;U<O.length;U++){let G=O[U],K=b(G);typeof G=="number"||typeof G=="boolean"?(k.__data[0]=G,i.bufferSubData(i.UNIFORM_BUFFER,$+P,k.__data)):G.isMatrix3?(k.__data[0]=G.elements[0],k.__data[1]=G.elements[1],k.__data[2]=G.elements[2],k.__data[3]=0,k.__data[4]=G.elements[3],k.__data[5]=G.elements[4],k.__data[6]=G.elements[5],k.__data[7]=0,k.__data[8]=G.elements[6],k.__data[9]=G.elements[7],k.__data[10]=G.elements[8],k.__data[11]=0):(G.toArray(k.__data,P),P+=K.storage/Float32Array.BYTES_PER_ELEMENT)}i.bufferSubData(i.UNIFORM_BUFFER,$,k.__data)}}}i.bindBuffer(i.UNIFORM_BUFFER,null)}h(d,"updateBufferData");function m(w,_,C,E){let T=w.value,L=_+"_"+C;if(E[L]===void 0)return typeof T=="number"||typeof T=="boolean"?E[L]=T:E[L]=T.clone(),!0;{let D=E[L];if(typeof T=="number"||typeof T=="boolean"){if(D!==T)return E[L]=T,!0}else if(D.equals(T)===!1)return D.copy(T),!0}return!1}h(m,"hasUniformChanged");function g(w){let _=w.uniforms,C=0,E=16;for(let L=0,D=_.length;L<D;L++){let B=Array.isArray(_[L])?_[L]:[_[L]];for(let A=0,k=B.length;A<k;A++){let $=B[A],O=Array.isArray($.value)?$.value:[$.value];for(let P=0,U=O.length;P<U;P++){let G=O[P],K=b(G),z=C%E;z!==0&&E-z<K.boundary&&(C+=E-z),$.__data=new Float32Array(K.storage/Float32Array.BYTES_PER_ELEMENT),$.__offset=C,C+=K.storage}}}let T=C%E;return T>0&&(C+=E-T),w.__size=C,w.__cache={},this}h(g,"prepareUniformsGroup");function b(w){let _={boundary:0,storage:0};return typeof w=="number"||typeof w=="boolean"?(_.boundary=4,_.storage=4):w.isVector2?(_.boundary=8,_.storage=8):w.isVector3||w.isColor?(_.boundary=16,_.storage=12):w.isVector4?(_.boundary=16,_.storage=16):w.isMatrix3?(_.boundary=48,_.storage=48):w.isMatrix4?(_.boundary=64,_.storage=64):w.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",w),_}h(b,"getUniformSize");function x(w){let _=w.target;_.removeEventListener("dispose",x);let C=o.indexOf(_.__bindingPointIndex);o.splice(C,1),i.deleteBuffer(n[_.id]),delete n[_.id],delete a[_.id]}h(x,"onUniformsGroupsDispose");function v(){for(let w in n)i.deleteBuffer(n[w]);o=[],n={},a={}}return h(v,"dispose"),{bind:l,update:u,dispose:v}}h(iq,"WebGLUniformsGroups");var rq=class{constructor(e={}){let{canvas:t=QH(),context:r=null,depth:n=!0,stencil:a=!0,alpha:o=!1,antialias:s=!1,premultipliedAlpha:l=!0,preserveDrawingBuffer:u=!1,powerPreference:c="default",failIfMajorPerformanceCaveat:p=!1}=e;this.isWebGLRenderer=!0;let d;r!==null?d=r.getContextAttributes().alpha:d=o;let m=new Uint32Array(4),g=new Int32Array(4),b=null,x=null,v=[],w=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=zn,this._useLegacyLights=!1,this.toneMapping=Il,this.toneMappingExposure=1;let _=this,C=!1,E=0,T=0,L=null,D=-1,B=null,A=new Ei,k=new Ei,$=null,O=new Lt(0),P=0,U=t.width,G=t.height,K=1,z=null,V=null,j=new Ei(0,0,U,G),q=new Ei(0,0,U,G),ee=!1,ae=new ig,N=!1,J=!1,Y=null,oe=new jt,xe=new Oe,ge=new le,Te={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function me(){return L===null?K:1}h(me,"getTargetPixelRatio");let Q=r;function Me(te,ye){for(let Ce=0;Ce<te.length;Ce++){let Pe=te[Ce],Se=t.getContext(Pe,ye);if(Se!==null)return Se}return null}h(Me,"getContext");try{let te={alpha:!0,depth:n,stencil:a,antialias:s,premultipliedAlpha:l,preserveDrawingBuffer:u,powerPreference:c,failIfMajorPerformanceCaveat:p};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${mE}`),t.addEventListener("webglcontextlost",ct,!1),t.addEventListener("webglcontextrestored",ce,!1),t.addEventListener("webglcontextcreationerror",et,!1),Q===null){let ye=["webgl2","webgl","experimental-webgl"];if(_.isWebGL1Renderer===!0&&ye.shift(),Q=Me(ye,te),Q===null)throw Me(ye)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}typeof WebGLRenderingContext<"u"&&Q instanceof WebGLRenderingContext&&console.warn("THREE.WebGLRenderer: WebGL 1 support was deprecated in r153 and will be removed in r163."),Q.getShaderPrecisionFormat===void 0&&(Q.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(te){throw console.error("THREE.WebGLRenderer: "+te.message),te}let ve,Ie,De,we,Fe,Ze,yt,ne,W,_e,Re,Ne,ze,xt,ot,je,He,bt,Xe,ti,At,ue,he,We;function pt(){ve=new cW(Q),Ie=new iW(Q,ve,e),ve.init(Ie),ue=new ZX(Q,ve,Ie),De=new XX(Q,ve,Ie),we=new fW(Q),Fe=new zX,Ze=new qX(Q,ve,De,Fe,Ie,ue,we),yt=new nW(_),ne=new hW(_),W=new YG(Q,Ie),he=new eW(Q,ve,W,Ie),_e=new pW(Q,W,we,he),Re=new vW(Q,_e,W,we),Xe=new yW(Q,Ie,Ze),je=new rW(Fe),Ne=new FX(_,yt,ne,ve,Ie,he,je),ze=new tq(_,Fe),xt=new OX,ot=new jX(ve,Ie),bt=new QG(_,yt,ne,De,Re,d,l),He=new WX(_,Re,Ie),We=new iq(Q,we,Ie,De),ti=new tW(Q,ve,we,Ie),At=new dW(Q,ve,we,Ie),we.programs=Ne.programs,_.capabilities=Ie,_.extensions=ve,_.properties=Fe,_.renderLists=xt,_.shadowMap=He,_.state=De,_.info=we}h(pt,"initGLContext"),pt();let ut=new dye(_,Q);this.xr=ut,this.getContext=function(){return Q},this.getContextAttributes=function(){return Q.getContextAttributes()},this.forceContextLoss=function(){let te=ve.get("WEBGL_lose_context");te&&te.loseContext()},this.forceContextRestore=function(){let te=ve.get("WEBGL_lose_context");te&&te.restoreContext()},this.getPixelRatio=function(){return K},this.setPixelRatio=function(te){te!==void 0&&(K=te,this.setSize(U,G,!1))},this.getSize=function(te){return te.set(U,G)},this.setSize=function(te,ye,Ce=!0){if(ut.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}U=te,G=ye,t.width=Math.floor(te*K),t.height=Math.floor(ye*K),Ce===!0&&(t.style.width=te+"px",t.style.height=ye+"px"),this.setViewport(0,0,te,ye)},this.getDrawingBufferSize=function(te){return te.set(U*K,G*K).floor()},this.setDrawingBufferSize=function(te,ye,Ce){U=te,G=ye,K=Ce,t.width=Math.floor(te*Ce),t.height=Math.floor(ye*Ce),this.setViewport(0,0,te,ye)},this.getCurrentViewport=function(te){return te.copy(A)},this.getViewport=function(te){return te.copy(j)},this.setViewport=function(te,ye,Ce,Pe){te.isVector4?j.set(te.x,te.y,te.z,te.w):j.set(te,ye,Ce,Pe),De.viewport(A.copy(j).multiplyScalar(K).round())},this.getScissor=function(te){return te.copy(q)},this.setScissor=function(te,ye,Ce,Pe){te.isVector4?q.set(te.x,te.y,te.z,te.w):q.set(te,ye,Ce,Pe),De.scissor(k.copy(q).multiplyScalar(K).round())},this.getScissorTest=function(){return ee},this.setScissorTest=function(te){De.setScissorTest(ee=te)},this.setOpaqueSort=function(te){z=te},this.setTransparentSort=function(te){V=te},this.getClearColor=function(te){return te.copy(bt.getClearColor())},this.setClearColor=function(){bt.setClearColor.apply(bt,arguments)},this.getClearAlpha=function(){return bt.getClearAlpha()},this.setClearAlpha=function(){bt.setClearAlpha.apply(bt,arguments)},this.clear=function(te=!0,ye=!0,Ce=!0){let Pe=0;if(te){let Se=!1;if(L!==null){let rt=L.texture.format;Se=rt===LH||rt===IH||rt===AH}if(Se){let rt=L.texture.type,_t=rt===Ll||rt===yl||rt===yE||rt===zu||rt===EH||rt===TH,Et=bt.getClearColor(),Tt=bt.getClearAlpha(),Dt=Et.r,Vt=Et.g,Rt=Et.b;_t?(m[0]=Dt,m[1]=Vt,m[2]=Rt,m[3]=Tt,Q.clearBufferuiv(Q.COLOR,0,m)):(g[0]=Dt,g[1]=Vt,g[2]=Rt,g[3]=Tt,Q.clearBufferiv(Q.COLOR,0,g))}else Pe|=Q.COLOR_BUFFER_BIT}ye&&(Pe|=Q.DEPTH_BUFFER_BIT),Ce&&(Pe|=Q.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),Q.clear(Pe)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",ct,!1),t.removeEventListener("webglcontextrestored",ce,!1),t.removeEventListener("webglcontextcreationerror",et,!1),xt.dispose(),ot.dispose(),Fe.dispose(),yt.dispose(),ne.dispose(),Re.dispose(),he.dispose(),We.dispose(),Ne.dispose(),ut.dispose(),ut.removeEventListener("sessionstart",ar),ut.removeEventListener("sessionend",Ut),Y&&(Y.dispose(),Y=null),Ci.stop()};function ct(te){te.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),C=!0}h(ct,"onContextLost");function ce(){console.log("THREE.WebGLRenderer: Context Restored."),C=!1;let te=we.autoReset,ye=He.enabled,Ce=He.autoUpdate,Pe=He.needsUpdate,Se=He.type;pt(),we.autoReset=te,He.enabled=ye,He.autoUpdate=Ce,He.needsUpdate=Pe,He.type=Se}h(ce,"onContextRestore");function et(te){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",te.statusMessage)}h(et,"onContextCreationError");function be(te){let ye=te.target;ye.removeEventListener("dispose",be),Ge(ye)}h(be,"onMaterialDispose");function Ge(te){tt(te),Fe.remove(te)}h(Ge,"deallocateMaterial");function tt(te){let ye=Fe.get(te).programs;ye!==void 0&&(ye.forEach(function(Ce){Ne.releaseProgram(Ce)}),te.isShaderMaterial&&Ne.releaseShaderCache(te))}h(tt,"releaseMaterialProgramReferences"),this.renderBufferDirect=function(te,ye,Ce,Pe,Se,rt){ye===null&&(ye=Te);let _t=Se.isMesh&&Se.matrixWorld.determinant()<0,Et=va(te,ye,Ce,Pe,Se);De.setMaterial(Pe,_t);let Tt=Ce.index,Dt=1;if(Pe.wireframe===!0){if(Tt=_e.getWireframeAttribute(Ce),Tt===void 0)return;Dt=2}let Vt=Ce.drawRange,Rt=Ce.attributes.position,qi=Vt.start*Dt,Ai=(Vt.start+Vt.count)*Dt;rt!==null&&(qi=Math.max(qi,rt.start*Dt),Ai=Math.min(Ai,(rt.start+rt.count)*Dt)),Tt!==null?(qi=Math.max(qi,0),Ai=Math.min(Ai,Tt.count)):Rt!=null&&(qi=Math.max(qi,0),Ai=Math.min(Ai,Rt.count));let Or=Ai-qi;if(Or<0||Or===1/0)return;he.setup(Se,Pe,Et,Ce,Tt);let dn,vi=ti;if(Tt!==null&&(dn=W.get(Tt),vi=At,vi.setIndex(dn)),Se.isMesh)Pe.wireframe===!0?(De.setLineWidth(Pe.wireframeLinewidth*me()),vi.setMode(Q.LINES)):vi.setMode(Q.TRIANGLES);else if(Se.isLine){let Bt=Pe.linewidth;Bt===void 0&&(Bt=1),De.setLineWidth(Bt*me()),Se.isLineSegments?vi.setMode(Q.LINES):Se.isLineLoop?vi.setMode(Q.LINE_LOOP):vi.setMode(Q.LINE_STRIP)}else Se.isPoints?vi.setMode(Q.POINTS):Se.isSprite&&vi.setMode(Q.TRIANGLES);if(Se.isBatchedMesh)vi.renderMultiDraw(Se._multiDrawStarts,Se._multiDrawCounts,Se._multiDrawCount);else if(Se.isInstancedMesh)vi.renderInstances(qi,Or,Se.count);else if(Ce.isInstancedBufferGeometry){let Bt=Ce._maxInstanceCount!==void 0?Ce._maxInstanceCount:1/0,wo=Math.min(Ce.instanceCount,Bt);vi.renderInstances(qi,Or,wo)}else vi.render(qi,Or)};function Ht(te,ye,Ce){te.transparent===!0&&te.side===Da&&te.forceSinglePass===!1?(te.side=Wn,te.needsUpdate=!0,An(te,ye,Ce),te.side=Bl,te.needsUpdate=!0,An(te,ye,Ce),te.side=Da):An(te,ye,Ce)}h(Ht,"prepareMaterial"),this.compile=function(te,ye,Ce=null){Ce===null&&(Ce=te),x=ot.get(Ce),x.init(),w.push(x),Ce.traverseVisible(function(Se){Se.isLight&&Se.layers.test(ye.layers)&&(x.pushLight(Se),Se.castShadow&&x.pushShadow(Se))}),te!==Ce&&te.traverseVisible(function(Se){Se.isLight&&Se.layers.test(ye.layers)&&(x.pushLight(Se),Se.castShadow&&x.pushShadow(Se))}),x.setupLights(_._useLegacyLights);let Pe=new Set;return te.traverse(function(Se){let rt=Se.material;if(rt)if(Array.isArray(rt))for(let _t=0;_t<rt.length;_t++){let Et=rt[_t];Ht(Et,Ce,Se),Pe.add(Et)}else Ht(rt,Ce,Se),Pe.add(rt)}),w.pop(),x=null,Pe},this.compileAsync=function(te,ye,Ce=null){let Pe=this.compile(te,ye,Ce);return new Promise(Se=>{function rt(){if(Pe.forEach(function(_t){Fe.get(_t).currentProgram.isReady()&&Pe.delete(_t)}),Pe.size===0){Se(te);return}setTimeout(rt,10)}h(rt,"checkMaterialsReady"),ve.get("KHR_parallel_shader_compile")!==null?rt():setTimeout(rt,10)})};let Nt=null;function Mi(te){Nt&&Nt(te)}h(Mi,"onAnimationFrame");function ar(){Ci.stop()}h(ar,"onXRSessionStart");function Ut(){Ci.start()}h(Ut,"onXRSessionEnd");let Ci=new CE;Ci.setAnimationLoop(Mi),typeof self<"u"&&Ci.setContext(self),this.setAnimationLoop=function(te){Nt=te,ut.setAnimationLoop(te),te===null?Ci.stop():Ci.start()},ut.addEventListener("sessionstart",ar),ut.addEventListener("sessionend",Ut),this.render=function(te,ye){if(ye!==void 0&&ye.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(C===!0)return;te.matrixWorldAutoUpdate===!0&&te.updateMatrixWorld(),ye.parent===null&&ye.matrixWorldAutoUpdate===!0&&ye.updateMatrixWorld(),ut.enabled===!0&&ut.isPresenting===!0&&(ut.cameraAutoUpdate===!0&&ut.updateCamera(ye),ye=ut.getCamera()),te.isScene===!0&&te.onBeforeRender(_,te,ye,L),x=ot.get(te,w.length),x.init(),w.push(x),oe.multiplyMatrices(ye.projectionMatrix,ye.matrixWorldInverse),ae.setFromProjectionMatrix(oe),J=this.localClippingEnabled,N=je.init(this.clippingPlanes,J),b=xt.get(te,v.length),b.init(),v.push(b),pr(te,ye,0,_.sortObjects),b.finish(),_.sortObjects===!0&&b.sort(z,V),this.info.render.frame++,N===!0&&je.beginShadows();let Ce=x.state.shadowsArray;if(He.render(Ce,te,ye),N===!0&&je.endShadows(),this.info.autoReset===!0&&this.info.reset(),(ut.enabled===!1||ut.isPresenting===!1||ut.hasDepthSensing()===!1)&&bt.render(b,te),x.setupLights(_._useLegacyLights),ye.isArrayCamera){let Pe=ye.cameras;for(let Se=0,rt=Pe.length;Se<rt;Se++){let _t=Pe[Se];Pn(b,te,_t,_t.viewport)}}else Pn(b,te,ye);L!==null&&(Ze.updateMultisampleRenderTarget(L),Ze.updateRenderTargetMipmap(L)),te.isScene===!0&&te.onAfterRender(_,te,ye),he.resetDefaultState(),D=-1,B=null,w.pop(),w.length>0?x=w[w.length-1]:x=null,v.pop(),v.length>0?b=v[v.length-1]:b=null};function pr(te,ye,Ce,Pe){if(te.visible===!1)return;if(te.layers.test(ye.layers)){if(te.isGroup)Ce=te.renderOrder;else if(te.isLOD)te.autoUpdate===!0&&te.update(ye);else if(te.isLight)x.pushLight(te),te.castShadow&&x.pushShadow(te);else if(te.isSprite){if(!te.frustumCulled||ae.intersectsSprite(te)){Pe&&ge.setFromMatrixPosition(te.matrixWorld).applyMatrix4(oe);let rt=Re.update(te),_t=te.material;_t.visible&&b.push(te,rt,_t,Ce,ge.z,null)}}else if((te.isMesh||te.isLine||te.isPoints)&&(!te.frustumCulled||ae.intersectsObject(te))){let rt=Re.update(te),_t=te.material;if(Pe&&(te.boundingSphere!==void 0?(te.boundingSphere===null&&te.computeBoundingSphere(),ge.copy(te.boundingSphere.center)):(rt.boundingSphere===null&&rt.computeBoundingSphere(),ge.copy(rt.boundingSphere.center)),ge.applyMatrix4(te.matrixWorld).applyMatrix4(oe)),Array.isArray(_t)){let Et=rt.groups;for(let Tt=0,Dt=Et.length;Tt<Dt;Tt++){let Vt=Et[Tt],Rt=_t[Vt.materialIndex];Rt&&Rt.visible&&b.push(te,rt,Rt,Ce,ge.z,Vt)}}else _t.visible&&b.push(te,rt,_t,Ce,ge.z,null)}}let Se=te.children;for(let rt=0,_t=Se.length;rt<_t;rt++)pr(Se[rt],ye,Ce,Pe)}h(pr,"projectObject");function Pn(te,ye,Ce,Pe){let Se=te.opaque,rt=te.transmissive,_t=te.transparent;x.setupLightsView(Ce),N===!0&&je.setGlobalState(_.clippingPlanes,Ce),rt.length>0&&ga(Se,rt,ye,Ce),Pe&&De.viewport(A.copy(Pe)),Se.length>0&&cn(Se,ye,Ce),rt.length>0&&cn(rt,ye,Ce),_t.length>0&&cn(_t,ye,Ce),De.buffers.depth.setTest(!0),De.buffers.depth.setMask(!0),De.buffers.color.setMask(!0),De.setPolygonOffset(!1)}h(Pn,"renderScene");function ga(te,ye,Ce,Pe){if((Ce.isScene===!0?Ce.overrideMaterial:null)!==null)return;let Se=Ie.isWebGL2;Y===null&&(Y=new Qu(1,1,{generateMipmaps:!0,type:ve.has("EXT_color_buffer_half_float")?Tm:Ll,minFilter:Pu,samples:Se?4:0})),_.getDrawingBufferSize(xe),Se?Y.setSize(xe.x,xe.y):Y.setSize(Pm(xe.x),Pm(xe.y));let rt=_.getRenderTarget();_.setRenderTarget(Y),_.getClearColor(O),P=_.getClearAlpha(),P<1&&_.setClearColor(16777215,.5),_.clear();let _t=_.toneMapping;_.toneMapping=Il,cn(te,Ce,Pe),Ze.updateMultisampleRenderTarget(Y),Ze.updateRenderTargetMipmap(Y);let Et=!1;for(let Tt=0,Dt=ye.length;Tt<Dt;Tt++){let Vt=ye[Tt],Rt=Vt.object,qi=Vt.geometry,Ai=Vt.material,Or=Vt.group;if(Ai.side===Da&&Rt.layers.test(Pe.layers)){let dn=Ai.side;Ai.side=Wn,Ai.needsUpdate=!0,Gr(Rt,Ce,Pe,qi,Ai,Or),Ai.side=dn,Ai.needsUpdate=!0,Et=!0}}Et===!0&&(Ze.updateMultisampleRenderTarget(Y),Ze.updateRenderTargetMipmap(Y)),_.setRenderTarget(rt),_.setClearColor(O,P),_.toneMapping=_t}h(ga,"renderTransmissionPass");function cn(te,ye,Ce){let Pe=ye.isScene===!0?ye.overrideMaterial:null;for(let Se=0,rt=te.length;Se<rt;Se++){let _t=te[Se],Et=_t.object,Tt=_t.geometry,Dt=Pe===null?_t.material:Pe,Vt=_t.group;Et.layers.test(Ce.layers)&&Gr(Et,ye,Ce,Tt,Dt,Vt)}}h(cn,"renderObjects");function Gr(te,ye,Ce,Pe,Se,rt){te.onBeforeRender(_,ye,Ce,Pe,Se,rt),te.modelViewMatrix.multiplyMatrices(Ce.matrixWorldInverse,te.matrixWorld),te.normalMatrix.getNormalMatrix(te.modelViewMatrix),Se.onBeforeRender(_,ye,Ce,Pe,te,rt),Se.transparent===!0&&Se.side===Da&&Se.forceSinglePass===!1?(Se.side=Wn,Se.needsUpdate=!0,_.renderBufferDirect(Ce,ye,Pe,Se,te,rt),Se.side=Bl,Se.needsUpdate=!0,_.renderBufferDirect(Ce,ye,Pe,Se,te,rt),Se.side=Da):_.renderBufferDirect(Ce,ye,Pe,Se,te,rt),te.onAfterRender(_,ye,Ce,Pe,Se,rt)}h(Gr,"renderObject");function An(te,ye,Ce){ye.isScene!==!0&&(ye=Te);let Pe=Fe.get(te),Se=x.state.lights,rt=x.state.shadowsArray,_t=Se.state.version,Et=Ne.getParameters(te,Se.state,rt,ye,Ce),Tt=Ne.getProgramCacheKey(Et),Dt=Pe.programs;Pe.environment=te.isMeshStandardMaterial?ye.environment:null,Pe.fog=ye.fog,Pe.envMap=(te.isMeshStandardMaterial?ne:yt).get(te.envMap||Pe.environment),Pe.envMapRotation=Pe.environment!==null&&te.envMap===null?ye.environmentRotation:te.envMapRotation,Dt===void 0&&(te.addEventListener("dispose",be),Dt=new Map,Pe.programs=Dt);let Vt=Dt.get(Tt);if(Vt!==void 0){if(Pe.currentProgram===Vt&&Pe.lightsStateVersion===_t)return ya(te,Et),Vt}else Et.uniforms=Ne.getUniforms(te),te.onBuild(Ce,Et,_),te.onBeforeCompile(Et,_),Vt=Ne.acquireProgram(Et,Tt),Dt.set(Tt,Vt),Pe.uniforms=Et.uniforms;let Rt=Pe.uniforms;return(!te.isShaderMaterial&&!te.isRawShaderMaterial||te.clipping===!0)&&(Rt.clippingPlanes=je.uniform),ya(te,Et),Pe.needsLights=pn(te),Pe.lightsStateVersion=_t,Pe.needsLights&&(Rt.ambientLightColor.value=Se.state.ambient,Rt.lightProbe.value=Se.state.probe,Rt.directionalLights.value=Se.state.directional,Rt.directionalLightShadows.value=Se.state.directionalShadow,Rt.spotLights.value=Se.state.spot,Rt.spotLightShadows.value=Se.state.spotShadow,Rt.rectAreaLights.value=Se.state.rectArea,Rt.ltc_1.value=Se.state.rectAreaLTC1,Rt.ltc_2.value=Se.state.rectAreaLTC2,Rt.pointLights.value=Se.state.point,Rt.pointLightShadows.value=Se.state.pointShadow,Rt.hemisphereLights.value=Se.state.hemi,Rt.directionalShadowMap.value=Se.state.directionalShadowMap,Rt.directionalShadowMatrix.value=Se.state.directionalShadowMatrix,Rt.spotShadowMap.value=Se.state.spotShadowMap,Rt.spotLightMatrix.value=Se.state.spotLightMatrix,Rt.spotLightMap.value=Se.state.spotLightMap,Rt.pointShadowMap.value=Se.state.pointShadowMap,Rt.pointShadowMatrix.value=Se.state.pointShadowMatrix),Pe.currentProgram=Vt,Pe.uniformsList=null,Vt}h(An,"getProgram");function Yn(te){if(te.uniformsList===null){let ye=te.currentProgram.getUniforms();te.uniformsList=My.seqWithValue(ye.seq,te.uniforms)}return te.uniformsList}h(Yn,"getUniformList");function ya(te,ye){let Ce=Fe.get(te);Ce.outputColorSpace=ye.outputColorSpace,Ce.batching=ye.batching,Ce.instancing=ye.instancing,Ce.instancingColor=ye.instancingColor,Ce.instancingMorph=ye.instancingMorph,Ce.skinning=ye.skinning,Ce.morphTargets=ye.morphTargets,Ce.morphNormals=ye.morphNormals,Ce.morphColors=ye.morphColors,Ce.morphTargetsCount=ye.morphTargetsCount,Ce.numClippingPlanes=ye.numClippingPlanes,Ce.numIntersection=ye.numClipIntersection,Ce.vertexAlphas=ye.vertexAlphas,Ce.vertexTangents=ye.vertexTangents,Ce.toneMapping=ye.toneMapping}h(ya,"updateCommonMaterialProperties");function va(te,ye,Ce,Pe,Se){ye.isScene!==!0&&(ye=Te),Ze.resetTextureUnits();let rt=ye.fog,_t=Pe.isMeshStandardMaterial?ye.environment:null,Et=L===null?_.outputColorSpace:L.isXRRenderTarget===!0?L.texture.colorSpace:Gl,Tt=(Pe.isMeshStandardMaterial?ne:yt).get(Pe.envMap||_t),Dt=Pe.vertexColors===!0&&!!Ce.attributes.color&&Ce.attributes.color.itemSize===4,Vt=!!Ce.attributes.tangent&&(!!Pe.normalMap||Pe.anisotropy>0),Rt=!!Ce.morphAttributes.position,qi=!!Ce.morphAttributes.normal,Ai=!!Ce.morphAttributes.color,Or=Il;Pe.toneMapped&&(L===null||L.isXRRenderTarget===!0)&&(Or=_.toneMapping);let dn=Ce.morphAttributes.position||Ce.morphAttributes.normal||Ce.morphAttributes.color,vi=dn!==void 0?dn.length:0,Bt=Fe.get(Pe),wo=x.state.lights;if(N===!0&&(J===!0||te!==B)){let Nr=te===B&&Pe.id===D;je.setState(Pe,te,Nr)}let dr=!1;Pe.version===Bt.__version?(Bt.needsLights&&Bt.lightsStateVersion!==wo.state.version||Bt.outputColorSpace!==Et||Se.isBatchedMesh&&Bt.batching===!1||!Se.isBatchedMesh&&Bt.batching===!0||Se.isInstancedMesh&&Bt.instancing===!1||!Se.isInstancedMesh&&Bt.instancing===!0||Se.isSkinnedMesh&&Bt.skinning===!1||!Se.isSkinnedMesh&&Bt.skinning===!0||Se.isInstancedMesh&&Bt.instancingColor===!0&&Se.instanceColor===null||Se.isInstancedMesh&&Bt.instancingColor===!1&&Se.instanceColor!==null||Se.isInstancedMesh&&Bt.instancingMorph===!0&&Se.morphTexture===null||Se.isInstancedMesh&&Bt.instancingMorph===!1&&Se.morphTexture!==null||Bt.envMap!==Tt||Pe.fog===!0&&Bt.fog!==rt||Bt.numClippingPlanes!==void 0&&(Bt.numClippingPlanes!==je.numPlanes||Bt.numIntersection!==je.numIntersection)||Bt.vertexAlphas!==Dt||Bt.vertexTangents!==Vt||Bt.morphTargets!==Rt||Bt.morphNormals!==qi||Bt.morphColors!==Ai||Bt.toneMapping!==Or||Ie.isWebGL2===!0&&Bt.morphTargetsCount!==vi)&&(dr=!0):(dr=!0,Bt.__version=Pe.version);let xa=Bt.currentProgram;dr===!0&&(xa=An(Pe,ye,Se));let Bs=!1,Ha=!1,$t=!1,Oi=xa.getUniforms(),_a=Bt.uniforms;if(De.useProgram(xa.program)&&(Bs=!0,Ha=!0,$t=!0),Pe.id!==D&&(D=Pe.id,Ha=!0),Bs||B!==te){Oi.setValue(Q,"projectionMatrix",te.projectionMatrix),Oi.setValue(Q,"viewMatrix",te.matrixWorldInverse);let Nr=Oi.map.cameraPosition;Nr!==void 0&&Nr.setValue(Q,ge.setFromMatrixPosition(te.matrixWorld)),Ie.logarithmicDepthBuffer&&Oi.setValue(Q,"logDepthBufFC",2/(Math.log(te.far+1)/Math.LN2)),(Pe.isMeshPhongMaterial||Pe.isMeshToonMaterial||Pe.isMeshLambertMaterial||Pe.isMeshBasicMaterial||Pe.isMeshStandardMaterial||Pe.isShaderMaterial)&&Oi.setValue(Q,"isOrthographic",te.isOrthographicCamera===!0),B!==te&&(B=te,Ha=!0,$t=!0)}if(Se.isSkinnedMesh){Oi.setOptional(Q,Se,"bindMatrix"),Oi.setOptional(Q,Se,"bindMatrixInverse");let Nr=Se.skeleton;Nr&&(Ie.floatVertexTextures?(Nr.boneTexture===null&&Nr.computeBoneTexture(),Oi.setValue(Q,"boneTexture",Nr.boneTexture,Ze)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}Se.isBatchedMesh&&(Oi.setOptional(Q,Se,"batchingTexture"),Oi.setValue(Q,"batchingTexture",Se._matricesTexture,Ze));let Os=Ce.morphAttributes;if((Os.position!==void 0||Os.normal!==void 0||Os.color!==void 0&&Ie.isWebGL2===!0)&&Xe.update(Se,Ce,xa),(Ha||Bt.receiveShadow!==Se.receiveShadow)&&(Bt.receiveShadow=Se.receiveShadow,Oi.setValue(Q,"receiveShadow",Se.receiveShadow)),Pe.isMeshGouraudMaterial&&Pe.envMap!==null&&(_a.envMap.value=Tt,_a.flipEnvMap.value=Tt.isCubeTexture&&Tt.isRenderTargetTexture===!1?-1:1),Ha&&(Oi.setValue(Q,"toneMappingExposure",_.toneMappingExposure),Bt.needsLights&&ja(_a,$t),rt&&Pe.fog===!0&&ze.refreshFogUniforms(_a,rt),ze.refreshMaterialUniforms(_a,Pe,K,G,Y),My.upload(Q,Yn(Bt),_a,Ze)),Pe.isShaderMaterial&&Pe.uniformsNeedUpdate===!0&&(My.upload(Q,Yn(Bt),_a,Ze),Pe.uniformsNeedUpdate=!1),Pe.isSpriteMaterial&&Oi.setValue(Q,"center",Se.center),Oi.setValue(Q,"modelViewMatrix",Se.modelViewMatrix),Oi.setValue(Q,"normalMatrix",Se.normalMatrix),Oi.setValue(Q,"modelMatrix",Se.matrixWorld),Pe.isShaderMaterial||Pe.isRawShaderMaterial){let Nr=Pe.uniformsGroups;for(let Ga=0,f=Nr.length;Ga<f;Ga++)if(Ie.isWebGL2){let y=Nr[Ga];We.update(y,xa),We.bind(y,xa)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return xa}h(va,"setProgram");function ja(te,ye){te.ambientLightColor.needsUpdate=ye,te.lightProbe.needsUpdate=ye,te.directionalLights.needsUpdate=ye,te.directionalLightShadows.needsUpdate=ye,te.pointLights.needsUpdate=ye,te.pointLightShadows.needsUpdate=ye,te.spotLights.needsUpdate=ye,te.spotLightShadows.needsUpdate=ye,te.rectAreaLights.needsUpdate=ye,te.hemisphereLights.needsUpdate=ye}h(ja,"markUniformsLightsNeedsUpdate");function pn(te){return te.isMeshLambertMaterial||te.isMeshToonMaterial||te.isMeshPhongMaterial||te.isMeshStandardMaterial||te.isShadowMaterial||te.isShaderMaterial&&te.lights===!0}h(pn,"materialNeedsLights"),this.getActiveCubeFace=function(){return E},this.getActiveMipmapLevel=function(){return T},this.getRenderTarget=function(){return L},this.setRenderTargetTextures=function(te,ye,Ce){Fe.get(te.texture).__webglTexture=ye,Fe.get(te.depthTexture).__webglTexture=Ce;let Pe=Fe.get(te);Pe.__hasExternalTextures=!0,Pe.__autoAllocateDepthBuffer=Ce===void 0,Pe.__autoAllocateDepthBuffer||ve.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),Pe.__useRenderToTexture=!1)},this.setRenderTargetFramebuffer=function(te,ye){let Ce=Fe.get(te);Ce.__webglFramebuffer=ye,Ce.__useDefaultFramebuffer=ye===void 0},this.setRenderTarget=function(te,ye=0,Ce=0){L=te,E=ye,T=Ce;let Pe=!0,Se=null,rt=!1,_t=!1;if(te){let Et=Fe.get(te);Et.__useDefaultFramebuffer!==void 0?(De.bindFramebuffer(Q.FRAMEBUFFER,null),Pe=!1):Et.__webglFramebuffer===void 0?Ze.setupRenderTarget(te):Et.__hasExternalTextures&&Ze.rebindTextures(te,Fe.get(te.texture).__webglTexture,Fe.get(te.depthTexture).__webglTexture);let Tt=te.texture;(Tt.isData3DTexture||Tt.isDataArrayTexture||Tt.isCompressedArrayTexture)&&(_t=!0);let Dt=Fe.get(te).__webglFramebuffer;te.isWebGLCubeRenderTarget?(Array.isArray(Dt[ye])?Se=Dt[ye][Ce]:Se=Dt[ye],rt=!0):Ie.isWebGL2&&te.samples>0&&Ze.useMultisampledRTT(te)===!1?Se=Fe.get(te).__webglMultisampledFramebuffer:Array.isArray(Dt)?Se=Dt[Ce]:Se=Dt,A.copy(te.viewport),k.copy(te.scissor),$=te.scissorTest}else A.copy(j).multiplyScalar(K).floor(),k.copy(q).multiplyScalar(K).floor(),$=ee;if(De.bindFramebuffer(Q.FRAMEBUFFER,Se)&&Ie.drawBuffers&&Pe&&De.drawBuffers(te,Se),De.viewport(A),De.scissor(k),De.setScissorTest($),rt){let Et=Fe.get(te.texture);Q.framebufferTexture2D(Q.FRAMEBUFFER,Q.COLOR_ATTACHMENT0,Q.TEXTURE_CUBE_MAP_POSITIVE_X+ye,Et.__webglTexture,Ce)}else if(_t){let Et=Fe.get(te.texture),Tt=ye||0;Q.framebufferTextureLayer(Q.FRAMEBUFFER,Q.COLOR_ATTACHMENT0,Et.__webglTexture,Ce||0,Tt)}D=-1},this.readRenderTargetPixels=function(te,ye,Ce,Pe,Se,rt,_t){if(!(te&&te.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let Et=Fe.get(te).__webglFramebuffer;if(te.isWebGLCubeRenderTarget&&_t!==void 0&&(Et=Et[_t]),Et){De.bindFramebuffer(Q.FRAMEBUFFER,Et);try{let Tt=te.texture,Dt=Tt.format,Vt=Tt.type;if(Dt!==$n&&ue.convert(Dt)!==Q.getParameter(Q.IMPLEMENTATION_COLOR_READ_FORMAT)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}let Rt=Vt===Tm&&(ve.has("EXT_color_buffer_half_float")||Ie.isWebGL2&&ve.has("EXT_color_buffer_float"));if(Vt!==Ll&&ue.convert(Vt)!==Q.getParameter(Q.IMPLEMENTATION_COLOR_READ_TYPE)&&!(Vt===na&&(Ie.isWebGL2||ve.has("OES_texture_float")||ve.has("WEBGL_color_buffer_float")))&&!Rt){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}ye>=0&&ye<=te.width-Pe&&Ce>=0&&Ce<=te.height-Se&&Q.readPixels(ye,Ce,Pe,Se,ue.convert(Dt),ue.convert(Vt),rt)}finally{let Tt=L!==null?Fe.get(L).__webglFramebuffer:null;De.bindFramebuffer(Q.FRAMEBUFFER,Tt)}}},this.copyFramebufferToTexture=function(te,ye,Ce=0){let Pe=Math.pow(2,-Ce),Se=Math.floor(ye.image.width*Pe),rt=Math.floor(ye.image.height*Pe);Ze.setTexture2D(ye,0),Q.copyTexSubImage2D(Q.TEXTURE_2D,Ce,0,0,te.x,te.y,Se,rt),De.unbindTexture()},this.copyTextureToTexture=function(te,ye,Ce,Pe=0){let Se=ye.image.width,rt=ye.image.height,_t=ue.convert(Ce.format),Et=ue.convert(Ce.type);Ze.setTexture2D(Ce,0),Q.pixelStorei(Q.UNPACK_FLIP_Y_WEBGL,Ce.flipY),Q.pixelStorei(Q.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Ce.premultiplyAlpha),Q.pixelStorei(Q.UNPACK_ALIGNMENT,Ce.unpackAlignment),ye.isDataTexture?Q.texSubImage2D(Q.TEXTURE_2D,Pe,te.x,te.y,Se,rt,_t,Et,ye.image.data):ye.isCompressedTexture?Q.compressedTexSubImage2D(Q.TEXTURE_2D,Pe,te.x,te.y,ye.mipmaps[0].width,ye.mipmaps[0].height,_t,ye.mipmaps[0].data):Q.texSubImage2D(Q.TEXTURE_2D,Pe,te.x,te.y,_t,Et,ye.image),Pe===0&&Ce.generateMipmaps&&Q.generateMipmap(Q.TEXTURE_2D),De.unbindTexture()},this.copyTextureToTexture3D=function(te,ye,Ce,Pe,Se=0){if(_.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}let rt=Math.round(te.max.x-te.min.x),_t=Math.round(te.max.y-te.min.y),Et=te.max.z-te.min.z+1,Tt=ue.convert(Pe.format),Dt=ue.convert(Pe.type),Vt;if(Pe.isData3DTexture)Ze.setTexture3D(Pe,0),Vt=Q.TEXTURE_3D;else if(Pe.isDataArrayTexture||Pe.isCompressedArrayTexture)Ze.setTexture2DArray(Pe,0),Vt=Q.TEXTURE_2D_ARRAY;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}Q.pixelStorei(Q.UNPACK_FLIP_Y_WEBGL,Pe.flipY),Q.pixelStorei(Q.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Pe.premultiplyAlpha),Q.pixelStorei(Q.UNPACK_ALIGNMENT,Pe.unpackAlignment);let Rt=Q.getParameter(Q.UNPACK_ROW_LENGTH),qi=Q.getParameter(Q.UNPACK_IMAGE_HEIGHT),Ai=Q.getParameter(Q.UNPACK_SKIP_PIXELS),Or=Q.getParameter(Q.UNPACK_SKIP_ROWS),dn=Q.getParameter(Q.UNPACK_SKIP_IMAGES),vi=Ce.isCompressedTexture?Ce.mipmaps[Se]:Ce.image;Q.pixelStorei(Q.UNPACK_ROW_LENGTH,vi.width),Q.pixelStorei(Q.UNPACK_IMAGE_HEIGHT,vi.height),Q.pixelStorei(Q.UNPACK_SKIP_PIXELS,te.min.x),Q.pixelStorei(Q.UNPACK_SKIP_ROWS,te.min.y),Q.pixelStorei(Q.UNPACK_SKIP_IMAGES,te.min.z),Ce.isDataTexture||Ce.isData3DTexture?Q.texSubImage3D(Vt,Se,ye.x,ye.y,ye.z,rt,_t,Et,Tt,Dt,vi.data):Pe.isCompressedArrayTexture?Q.compressedTexSubImage3D(Vt,Se,ye.x,ye.y,ye.z,rt,_t,Et,Tt,vi.data):Q.texSubImage3D(Vt,Se,ye.x,ye.y,ye.z,rt,_t,Et,Tt,Dt,vi),Q.pixelStorei(Q.UNPACK_ROW_LENGTH,Rt),Q.pixelStorei(Q.UNPACK_IMAGE_HEIGHT,qi),Q.pixelStorei(Q.UNPACK_SKIP_PIXELS,Ai),Q.pixelStorei(Q.UNPACK_SKIP_ROWS,Or),Q.pixelStorei(Q.UNPACK_SKIP_IMAGES,dn),Se===0&&Pe.generateMipmaps&&Q.generateMipmap(Vt),De.unbindTexture()},this.initTexture=function(te){te.isCubeTexture?Ze.setTextureCube(te,0):te.isData3DTexture?Ze.setTexture3D(te,0):te.isDataArrayTexture||te.isCompressedArrayTexture?Ze.setTexture2DArray(te,0):Ze.setTexture2D(te,0),De.unbindTexture()},this.resetState=function(){E=0,T=0,L=null,De.reset(),he.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return Ms}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;let t=this.getContext();t.drawingBufferColorSpace=e===xE?"display-p3":"srgb",t.unpackColorSpace=Si.workingColorSpace===Nx?"display-p3":"srgb"}get useLegacyLights(){return console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights}set useLegacyLights(e){console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights=e}};h(rq,"WebGLRenderer");var nq=rq,aq=class extends nq{};h(aq,"WebGL1Renderer");var oq=aq;oq.prototype.isWebGL1Renderer=!0;var sq=class extends rr{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new $a,this.environmentRotation=new $a,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentRotation.copy(e.environmentRotation),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){let t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity),t.object.backgroundRotation=this.backgroundRotation.toArray(),t.object.environmentRotation=this.environmentRotation.toArray(),t}};h(sq,"Scene");var lq=sq,uq=class{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=y3,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.version=0,this.uuid=ha()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}get updateRange(){return bE("THREE.InterleavedBuffer: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,r){e*=this.stride,r*=t.stride;for(let n=0,a=this.stride;n<a;n++)this.array[e+n]=t.array[r+n];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=ha()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);let t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),r=new this.constructor(t,this.stride);return r.setUsage(this.usage),r}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=ha()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}};h(uq,"InterleavedBuffer");var jCe=uq,mn=new le,hq=class cq{constructor(e,t,r,n=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=r,this.normalized=n}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,r=this.data.count;t<r;t++)mn.fromBufferAttribute(this,t),mn.applyMatrix4(e),this.setXYZ(t,mn.x,mn.y,mn.z);return this}applyNormalMatrix(e){for(let t=0,r=this.count;t<r;t++)mn.fromBufferAttribute(this,t),mn.applyNormalMatrix(e),this.setXYZ(t,mn.x,mn.y,mn.z);return this}transformDirection(e){for(let t=0,r=this.count;t<r;t++)mn.fromBufferAttribute(this,t),mn.transformDirection(e),this.setXYZ(t,mn.x,mn.y,mn.z);return this}getComponent(e,t){let r=this.array[e*this.data.stride+this.offset+t];return this.normalized&&(r=ka(r,this.array)),r}setComponent(e,t,r){return this.normalized&&(r=yi(r,this.array)),this.data.array[e*this.data.stride+this.offset+t]=r,this}setX(e,t){return this.normalized&&(t=yi(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=yi(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=yi(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=yi(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=ka(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=ka(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=ka(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=ka(t,this.array)),t}setXY(e,t,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=yi(t,this.array),r=yi(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this}setXYZ(e,t,r,n){return e=e*this.data.stride+this.offset,this.normalized&&(t=yi(t,this.array),r=yi(r,this.array),n=yi(n,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=n,this}setXYZW(e,t,r,n,a){return e=e*this.data.stride+this.offset,this.normalized&&(t=yi(t,this.array),r=yi(r,this.array),n=yi(n,this.array),a=yi(a,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=n,this.data.array[e+3]=a,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");let t=[];for(let r=0;r<this.count;r++){let n=r*this.data.stride+this.offset;for(let a=0;a<this.itemSize;a++)t.push(this.data.array[n+a])}return new Br(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new cq(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");let t=[];for(let r=0;r<this.count;r++){let n=r*this.data.stride+this.offset;for(let a=0;a<this.itemSize;a++)t.push(this.data.array[n+a])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}};h(hq,"InterleavedBufferAttribute");var HCe=hq,E6=new le,T6=new Ei,P6=new Ei,mye=new le,A6=new jt,g1=new le,T2=new Xn,I6=new jt,P2=new tg,pq=class extends Wi{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=xA,this.bindMatrix=new jt,this.bindMatrixInverse=new jt,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){let e=this.geometry;this.boundingBox===null&&(this.boundingBox=new Yr),this.boundingBox.makeEmpty();let t=e.getAttribute("position");for(let r=0;r<t.count;r++)this.getVertexPosition(r,g1),this.boundingBox.expandByPoint(g1)}computeBoundingSphere(){let e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new Xn),this.boundingSphere.makeEmpty();let t=e.getAttribute("position");for(let r=0;r<t.count;r++)this.getVertexPosition(r,g1),this.boundingSphere.expandByPoint(g1)}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,t){let r=this.material,n=this.matrixWorld;r!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),T2.copy(this.boundingSphere),T2.applyMatrix4(n),e.ray.intersectsSphere(T2)!==!1&&(I6.copy(n).invert(),P2.copy(e.ray).applyMatrix4(I6),!(this.boundingBox!==null&&P2.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(e,t,P2)))}getVertexPosition(e,t){return super.getVertexPosition(e,t),this.applyBoneTransform(e,t),t}bind(e,t){this.skeleton=e,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){let e=new Ei,t=this.geometry.attributes.skinWeight;for(let r=0,n=t.count;r<n;r++){e.fromBufferAttribute(t,r);let a=1/e.manhattanLength();a!==1/0?e.multiplyScalar(a):e.set(1,0,0,0),t.setXYZW(r,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===xA?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===wfe?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,t){let r=this.skeleton,n=this.geometry;T6.fromBufferAttribute(n.attributes.skinIndex,e),P6.fromBufferAttribute(n.attributes.skinWeight,e),E6.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let a=0;a<4;a++){let o=P6.getComponent(a);if(o!==0){let s=T6.getComponent(a);A6.multiplyMatrices(r.bones[s].matrixWorld,r.boneInverses[s]),t.addScaledVector(mye.copy(E6).applyMatrix4(A6),o)}}return t.applyMatrix4(this.bindMatrixInverse)}};h(pq,"SkinnedMesh");var WCe=pq,dq=class extends rr{constructor(){super(),this.isBone=!0,this.type="Bone"}};h(dq,"Bone");var gye=dq,fq=class extends En{constructor(e=null,t=1,r=1,n,a,o,s,l,u=Xr,c=Xr,p,d){super(null,o,s,l,u,c,n,a,p,d),this.isDataTexture=!0,this.image={data:e,width:t,height:r},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}};h(fq,"DataTexture");var jx=fq,L6=new jt,yye=new jt,mq=class gq{constructor(e=[],t=[]){this.uuid=ha(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){let e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),t.length===0)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let r=0,n=this.bones.length;r<n;r++)this.boneInverses.push(new jt)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){let r=new jt;this.bones[e]&&r.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(r)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){let r=this.bones[e];r&&r.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){let r=this.bones[e];r&&(r.parent&&r.parent.isBone?(r.matrix.copy(r.parent.matrixWorld).invert(),r.matrix.multiply(r.matrixWorld)):r.matrix.copy(r.matrixWorld),r.matrix.decompose(r.position,r.quaternion,r.scale))}}update(){let e=this.bones,t=this.boneInverses,r=this.boneMatrices,n=this.boneTexture;for(let a=0,o=e.length;a<o;a++){let s=e[a]?e[a].matrixWorld:yye;L6.multiplyMatrices(s,t[a]),L6.toArray(r,a*16)}n!==null&&(n.needsUpdate=!0)}clone(){return new gq(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);let t=new Float32Array(e*e*4);t.set(this.boneMatrices);let r=new jx(t,e,e,$n,na);return r.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=r,this}getBoneByName(e){for(let t=0,r=this.bones.length;t<r;t++){let n=this.bones[t];if(n.name===e)return n}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let r=0,n=e.bones.length;r<n;r++){let a=e.bones[r],o=t[a];o===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",a),o=new gye),this.bones.push(o),this.boneInverses.push(new jt().fromArray(e.boneInverses[r]))}return this.init(),this}toJSON(){let e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;let t=this.bones,r=this.boneInverses;for(let n=0,a=t.length;n<a;n++){let o=t[n];e.bones.push(o.uuid);let s=r[n];e.boneInverses.push(s.toArray())}return e}};h(mq,"Skeleton");var ZCe=mq,yq=class extends Br{constructor(e,t,r,n=1){super(e,t,r),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=n}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){let e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}};h(yq,"InstancedBufferAttribute");var D6=yq,$h=new jt,k6=new jt,y1=[],R6=new Yr,vye=new jt,Ld=new Wi,Dd=new Xn,vq=class extends Wi{constructor(e,t,r){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new D6(new Float32Array(r*16),16),this.instanceColor=null,this.morphTexture=null,this.count=r,this.boundingBox=null,this.boundingSphere=null;for(let n=0;n<r;n++)this.setMatrixAt(n,vye)}computeBoundingBox(){let e=this.geometry,t=this.count;this.boundingBox===null&&(this.boundingBox=new Yr),e.boundingBox===null&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let r=0;r<t;r++)this.getMatrixAt(r,$h),R6.copy(e.boundingBox).applyMatrix4($h),this.boundingBox.union(R6)}computeBoundingSphere(){let e=this.geometry,t=this.count;this.boundingSphere===null&&(this.boundingSphere=new Xn),e.boundingSphere===null&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let r=0;r<t;r++)this.getMatrixAt(r,$h),Dd.copy(e.boundingSphere).applyMatrix4($h),this.boundingSphere.union(Dd)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,t){t.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,e*16)}getMorphAt(e,t){let r=t.morphTargetInfluences,n=this.morphTexture.source.data.data,a=r.length+1,o=e*a+1;for(let s=0;s<r.length;s++)r[s]=n[o+s]}raycast(e,t){let r=this.matrixWorld,n=this.count;if(Ld.geometry=this.geometry,Ld.material=this.material,Ld.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),Dd.copy(this.boundingSphere),Dd.applyMatrix4(r),e.ray.intersectsSphere(Dd)!==!1))for(let a=0;a<n;a++){this.getMatrixAt(a,$h),k6.multiplyMatrices(r,$h),Ld.matrixWorld=k6,Ld.raycast(e,y1);for(let o=0,s=y1.length;o<s;o++){let l=y1[o];l.instanceId=a,l.object=this,t.push(l)}y1.length=0}}setColorAt(e,t){this.instanceColor===null&&(this.instanceColor=new D6(new Float32Array(this.instanceMatrix.count*3),3)),t.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,e*16)}setMorphAt(e,t){let r=t.morphTargetInfluences,n=r.length+1;this.morphTexture===null&&(this.morphTexture=new jx(new Float32Array(n*this.count),n,this.count,PH,na));let a=this.morphTexture.source.data.data,o=0;for(let u=0;u<r.length;u++)o+=r[u];let s=this.geometry.morphTargetsRelative?1:1-o,l=n*e;a[l]=s,a.set(r,l+1)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}};h(vq,"InstancedMesh");var xq=vq;function _q(i,e){return i.z-e.z}h(_q,"sortOpaque");function bq(i,e){return e.z-i.z}h(bq,"sortTransparent");var wq=class{constructor(){this.index=0,this.pool=[],this.list=[]}push(e,t){let r=this.pool,n=this.list;this.index>=r.length&&r.push({start:-1,count:-1,z:-1});let a=r[this.index];n.push(a),this.index++,a.start=e.start,a.count=e.count,a.z=t}reset(){this.list.length=0,this.index=0}};h(wq,"MultiDrawRenderList");var xye=wq,Uh="batchId",qs=new jt,F6=new jt,_ye=new jt,z6=new jt,A2=new ig,v1=new Yr,iu=new Xn,kd=new le,I2=new xye,rn=new Wi,x1=[];function Sq(i,e,t=0){let r=e.itemSize;if(i.isInterleavedBufferAttribute||i.array.constructor!==e.array.constructor){let n=i.count;for(let a=0;a<n;a++)for(let o=0;o<r;o++)e.setComponent(a+t,o,i.getComponent(a,o))}else e.array.set(i.array,t*r);e.needsUpdate=!0}h(Sq,"copyAttributeData");var Mq=class extends Wi{get maxGeometryCount(){return this._maxGeometryCount}constructor(e,t,r=t*2,n){super(new ma,n),this.isBatchedMesh=!0,this.perObjectFrustumCulled=!0,this.sortObjects=!0,this.boundingBox=null,this.boundingSphere=null,this.customSort=null,this._drawRanges=[],this._reservedRanges=[],this._visibility=[],this._active=[],this._bounds=[],this._maxGeometryCount=e,this._maxVertexCount=t,this._maxIndexCount=r,this._geometryInitialized=!1,this._geometryCount=0,this._multiDrawCounts=new Int32Array(e),this._multiDrawStarts=new Int32Array(e),this._multiDrawCount=0,this._visibilityChanged=!0,this._matricesTexture=null,this._initMatricesTexture()}_initMatricesTexture(){let e=Math.sqrt(this._maxGeometryCount*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);let t=new Float32Array(e*e*4),r=new jx(t,e,e,$n,na);this._matricesTexture=r}_initializeGeometry(e){let t=this.geometry,r=this._maxVertexCount,n=this._maxGeometryCount,a=this._maxIndexCount;if(this._geometryInitialized===!1){for(let s in e.attributes){let l=e.getAttribute(s),{array:u,itemSize:c,normalized:p}=l,d=new u.constructor(r*c),m=new l.constructor(d,c,p);m.setUsage(l.usage),t.setAttribute(s,m)}if(e.getIndex()!==null){let s=r>65536?new Uint32Array(a):new Uint16Array(a);t.setIndex(new Br(s,1))}let o=n>65536?new Uint32Array(r):new Uint16Array(r);t.setAttribute(Uh,new Br(o,1)),this._geometryInitialized=!0}}_validateGeometry(e){if(e.getAttribute(Uh))throw new Error(`BatchedMesh: Geometry cannot use attribute "${Uh}"`);let t=this.geometry;if(!!e.getIndex()!=!!t.getIndex())throw new Error('BatchedMesh: All geometries must consistently have "index".');for(let r in t.attributes){if(r===Uh)continue;if(!e.hasAttribute(r))throw new Error(`BatchedMesh: Added geometry missing "${r}". All geometries must have consistent attributes.`);let n=e.getAttribute(r),a=t.getAttribute(r);if(n.itemSize!==a.itemSize||n.normalized!==a.normalized)throw new Error("BatchedMesh: All attributes must have a consistent itemSize and normalized value.")}}setCustomSort(e){return this.customSort=e,this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Yr);let e=this._geometryCount,t=this.boundingBox,r=this._active;t.makeEmpty();for(let n=0;n<e;n++)r[n]!==!1&&(this.getMatrixAt(n,qs),this.getBoundingBoxAt(n,v1).applyMatrix4(qs),t.union(v1))}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Xn);let e=this._geometryCount,t=this.boundingSphere,r=this._active;t.makeEmpty();for(let n=0;n<e;n++)r[n]!==!1&&(this.getMatrixAt(n,qs),this.getBoundingSphereAt(n,iu).applyMatrix4(qs),t.union(iu))}addGeometry(e,t=-1,r=-1){if(this._initializeGeometry(e),this._validateGeometry(e),this._geometryCount>=this._maxGeometryCount)throw new Error("BatchedMesh: Maximum geometry count reached.");let n={vertexStart:-1,vertexCount:-1,indexStart:-1,indexCount:-1},a=null,o=this._reservedRanges,s=this._drawRanges,l=this._bounds;this._geometryCount!==0&&(a=o[o.length-1]),t===-1?n.vertexCount=e.getAttribute("position").count:n.vertexCount=t,a===null?n.vertexStart=0:n.vertexStart=a.vertexStart+a.vertexCount;let u=e.getIndex(),c=u!==null;if(c&&(r===-1?n.indexCount=u.count:n.indexCount=r,a===null?n.indexStart=0:n.indexStart=a.indexStart+a.indexCount),n.indexStart!==-1&&n.indexStart+n.indexCount>this._maxIndexCount||n.vertexStart+n.vertexCount>this._maxVertexCount)throw new Error("BatchedMesh: Reserved space request exceeds the maximum buffer size.");let p=this._visibility,d=this._active,m=this._matricesTexture,g=this._matricesTexture.image.data;p.push(!0),d.push(!0);let b=this._geometryCount;this._geometryCount++,_ye.toArray(g,b*16),m.needsUpdate=!0,o.push(n),s.push({start:c?n.indexStart:n.vertexStart,count:-1}),l.push({boxInitialized:!1,box:new Yr,sphereInitialized:!1,sphere:new Xn});let x=this.geometry.getAttribute(Uh);for(let v=0;v<n.vertexCount;v++)x.setX(n.vertexStart+v,b);return x.needsUpdate=!0,this.setGeometryAt(b,e),b}setGeometryAt(e,t){if(e>=this._geometryCount)throw new Error("BatchedMesh: Maximum geometry count reached.");this._validateGeometry(t);let r=this.geometry,n=r.getIndex()!==null,a=r.getIndex(),o=t.getIndex(),s=this._reservedRanges[e];if(n&&o.count>s.indexCount||t.attributes.position.count>s.vertexCount)throw new Error("BatchedMesh: Reserved space not large enough for provided geometry.");let l=s.vertexStart,u=s.vertexCount;for(let m in r.attributes){if(m===Uh)continue;let g=t.getAttribute(m),b=r.getAttribute(m);Sq(g,b,l);let x=g.itemSize;for(let v=g.count,w=u;v<w;v++){let _=l+v;for(let C=0;C<x;C++)b.setComponent(_,C,0)}b.needsUpdate=!0}if(n){let m=s.indexStart;for(let g=0;g<o.count;g++)a.setX(m+g,l+o.getX(g));for(let g=o.count,b=s.indexCount;g<b;g++)a.setX(m+g,l);a.needsUpdate=!0}let c=this._bounds[e];t.boundingBox!==null?(c.box.copy(t.boundingBox),c.boxInitialized=!0):c.boxInitialized=!1,t.boundingSphere!==null?(c.sphere.copy(t.boundingSphere),c.sphereInitialized=!0):c.sphereInitialized=!1;let p=this._drawRanges[e],d=t.getAttribute("position");return p.count=n?o.count:d.count,this._visibilityChanged=!0,e}deleteGeometry(e){let t=this._active;return e>=t.length||t[e]===!1?this:(t[e]=!1,this._visibilityChanged=!0,this)}getBoundingBoxAt(e,t){if(this._active[e]===!1)return null;let r=this._bounds[e],n=r.box,a=this.geometry;if(r.boxInitialized===!1){n.makeEmpty();let o=a.index,s=a.attributes.position,l=this._drawRanges[e];for(let u=l.start,c=l.start+l.count;u<c;u++){let p=u;o&&(p=o.getX(p)),n.expandByPoint(kd.fromBufferAttribute(s,p))}r.boxInitialized=!0}return t.copy(n),t}getBoundingSphereAt(e,t){if(this._active[e]===!1)return null;let r=this._bounds[e],n=r.sphere,a=this.geometry;if(r.sphereInitialized===!1){n.makeEmpty(),this.getBoundingBoxAt(e,v1),v1.getCenter(n.center);let o=a.index,s=a.attributes.position,l=this._drawRanges[e],u=0;for(let c=l.start,p=l.start+l.count;c<p;c++){let d=c;o&&(d=o.getX(d)),kd.fromBufferAttribute(s,d),u=Math.max(u,n.center.distanceToSquared(kd))}n.radius=Math.sqrt(u),r.sphereInitialized=!0}return t.copy(n),t}setMatrixAt(e,t){let r=this._active,n=this._matricesTexture,a=this._matricesTexture.image.data,o=this._geometryCount;return e>=o||r[e]===!1?this:(t.toArray(a,e*16),n.needsUpdate=!0,this)}getMatrixAt(e,t){let r=this._active,n=this._matricesTexture.image.data,a=this._geometryCount;return e>=a||r[e]===!1?null:t.fromArray(n,e*16)}setVisibleAt(e,t){let r=this._visibility,n=this._active,a=this._geometryCount;return e>=a||n[e]===!1||r[e]===t?this:(r[e]=t,this._visibilityChanged=!0,this)}getVisibleAt(e){let t=this._visibility,r=this._active,n=this._geometryCount;return e>=n||r[e]===!1?!1:t[e]}raycast(e,t){let r=this._visibility,n=this._active,a=this._drawRanges,o=this._geometryCount,s=this.matrixWorld,l=this.geometry;rn.material=this.material,rn.geometry.index=l.index,rn.geometry.attributes=l.attributes,rn.geometry.boundingBox===null&&(rn.geometry.boundingBox=new Yr),rn.geometry.boundingSphere===null&&(rn.geometry.boundingSphere=new Xn);for(let u=0;u<o;u++){if(!r[u]||!n[u])continue;let c=a[u];rn.geometry.setDrawRange(c.start,c.count),this.getMatrixAt(u,rn.matrixWorld).premultiply(s),this.getBoundingBoxAt(u,rn.geometry.boundingBox),this.getBoundingSphereAt(u,rn.geometry.boundingSphere),rn.raycast(e,x1);for(let p=0,d=x1.length;p<d;p++){let m=x1[p];m.object=this,m.batchId=u,t.push(m)}x1.length=0}rn.material=null,rn.geometry.index=null,rn.geometry.attributes={},rn.geometry.setDrawRange(0,1/0)}copy(e){return super.copy(e),this.geometry=e.geometry.clone(),this.perObjectFrustumCulled=e.perObjectFrustumCulled,this.sortObjects=e.sortObjects,this.boundingBox=e.boundingBox!==null?e.boundingBox.clone():null,this.boundingSphere=e.boundingSphere!==null?e.boundingSphere.clone():null,this._drawRanges=e._drawRanges.map(t=>({...t})),this._reservedRanges=e._reservedRanges.map(t=>({...t})),this._visibility=e._visibility.slice(),this._active=e._active.slice(),this._bounds=e._bounds.map(t=>({boxInitialized:t.boxInitialized,box:t.box.clone(),sphereInitialized:t.sphereInitialized,sphere:t.sphere.clone()})),this._maxGeometryCount=e._maxGeometryCount,this._maxVertexCount=e._maxVertexCount,this._maxIndexCount=e._maxIndexCount,this._geometryInitialized=e._geometryInitialized,this._geometryCount=e._geometryCount,this._multiDrawCounts=e._multiDrawCounts.slice(),this._multiDrawStarts=e._multiDrawStarts.slice(),this._matricesTexture=e._matricesTexture.clone(),this._matricesTexture.image.data=this._matricesTexture.image.slice(),this}dispose(){return this.geometry.dispose(),this._matricesTexture.dispose(),this._matricesTexture=null,this}onBeforeRender(e,t,r,n,a){if(!this._visibilityChanged&&!this.perObjectFrustumCulled&&!this.sortObjects)return;let o=n.getIndex(),s=o===null?1:o.array.BYTES_PER_ELEMENT,l=this._active,u=this._visibility,c=this._multiDrawStarts,p=this._multiDrawCounts,d=this._drawRanges,m=this.perObjectFrustumCulled;m&&(z6.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse).multiply(this.matrixWorld),A2.setFromProjectionMatrix(z6,e.coordinateSystem));let g=0;if(this.sortObjects){F6.copy(this.matrixWorld).invert(),kd.setFromMatrixPosition(r.matrixWorld).applyMatrix4(F6);for(let v=0,w=u.length;v<w;v++)if(u[v]&&l[v]){this.getMatrixAt(v,qs),this.getBoundingSphereAt(v,iu).applyMatrix4(qs);let _=!1;if(m&&(_=!A2.intersectsSphere(iu)),!_){let C=kd.distanceTo(iu.center);I2.push(d[v],C)}}let b=I2.list,x=this.customSort;x===null?b.sort(a.transparent?bq:_q):x.call(this,b,r);for(let v=0,w=b.length;v<w;v++){let _=b[v];c[g]=_.start*s,p[g]=_.count,g++}I2.reset()}else for(let b=0,x=u.length;b<x;b++)if(u[b]&&l[b]){let v=!1;if(m&&(this.getMatrixAt(b,qs),this.getBoundingSphereAt(b,iu).applyMatrix4(qs),v=!A2.intersectsSphere(iu)),!v){let w=d[b];c[g]=w.start*s,p[g]=w.count,g++}}this._multiDrawCount=g,this._visibilityChanged=!1}onBeforeShadow(e,t,r,n,a,o){this.onBeforeRender(e,null,n,a,o)}};h(Mq,"BatchedMesh");var EE=Mq,Cq=class extends Wl{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Lt(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}};h(Cq,"LineBasicMaterial");var Eq=Cq,B6=new le,O6=new le,N6=new jt,L2=new tg,_1=new Xn,Tq=class extends rr{constructor(e=new ma,t=new Eq){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){let e=this.geometry;if(e.index===null){let t=e.attributes.position,r=[0];for(let n=1,a=t.count;n<a;n++)B6.fromBufferAttribute(t,n-1),O6.fromBufferAttribute(t,n),r[n]=r[n-1],r[n]+=B6.distanceTo(O6);e.setAttribute("lineDistance",new jr(r,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){let r=this.geometry,n=this.matrixWorld,a=e.params.Line.threshold,o=r.drawRange;if(r.boundingSphere===null&&r.computeBoundingSphere(),_1.copy(r.boundingSphere),_1.applyMatrix4(n),_1.radius+=a,e.ray.intersectsSphere(_1)===!1)return;N6.copy(n).invert(),L2.copy(e.ray).applyMatrix4(N6);let s=a/((this.scale.x+this.scale.y+this.scale.z)/3),l=s*s,u=new le,c=new le,p=new le,d=new le,m=this.isLineSegments?2:1,g=r.index,b=r.attributes.position;if(g!==null){let x=Math.max(0,o.start),v=Math.min(g.count,o.start+o.count);for(let w=x,_=v-1;w<_;w+=m){let C=g.getX(w),E=g.getX(w+1);if(u.fromBufferAttribute(b,C),c.fromBufferAttribute(b,E),L2.distanceSqToSegment(u,c,d,p)>l)continue;d.applyMatrix4(this.matrixWorld);let T=e.ray.origin.distanceTo(d);T<e.near||T>e.far||t.push({distance:T,point:p.clone().applyMatrix4(this.matrixWorld),index:w,face:null,faceIndex:null,object:this})}}else{let x=Math.max(0,o.start),v=Math.min(b.count,o.start+o.count);for(let w=x,_=v-1;w<_;w+=m){if(u.fromBufferAttribute(b,w),c.fromBufferAttribute(b,w+1),L2.distanceSqToSegment(u,c,d,p)>l)continue;d.applyMatrix4(this.matrixWorld);let C=e.ray.origin.distanceTo(d);C<e.near||C>e.far||t.push({distance:C,point:p.clone().applyMatrix4(this.matrixWorld),index:w,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){let e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){let r=e[t[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let n=0,a=r.length;n<a;n++){let o=r[n].name||String(n);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=n}}}}};h(Tq,"Line");var Pq=Tq,$6=new le,U6=new le,Aq=class extends Pq{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){let e=this.geometry;if(e.index===null){let t=e.attributes.position,r=[];for(let n=0,a=t.count;n<a;n+=2)$6.fromBufferAttribute(t,n),U6.fromBufferAttribute(t,n+1),r[n]=n===0?0:r[n-1],r[n+1]=r[n]+$6.distanceTo(U6);e.setAttribute("lineDistance",new jr(r,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}};h(Aq,"LineSegments");var Hx=Aq,Iq=class extends Pq{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}};h(Iq,"LineLoop");var n4e=Iq,Lq=class extends Wl{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new Lt(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}};h(Lq,"PointsMaterial");var bye=Lq,V6=new jt,k3=new tg,b1=new Xn,w1=new le,Dq=class extends rr{constructor(e=new ma,t=new bye){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){let r=this.geometry,n=this.matrixWorld,a=e.params.Points.threshold,o=r.drawRange;if(r.boundingSphere===null&&r.computeBoundingSphere(),b1.copy(r.boundingSphere),b1.applyMatrix4(n),b1.radius+=a,e.ray.intersectsSphere(b1)===!1)return;V6.copy(n).invert(),k3.copy(e.ray).applyMatrix4(V6);let s=a/((this.scale.x+this.scale.y+this.scale.z)/3),l=s*s,u=r.index,c=r.attributes.position;if(u!==null){let p=Math.max(0,o.start),d=Math.min(u.count,o.start+o.count);for(let m=p,g=d;m<g;m++){let b=u.getX(m);w1.fromBufferAttribute(c,b),R3(w1,b,l,n,e,t,this)}}else{let p=Math.max(0,o.start),d=Math.min(c.count,o.start+o.count);for(let m=p,g=d;m<g;m++)w1.fromBufferAttribute(c,m),R3(w1,m,l,n,e,t,this)}}updateMorphTargets(){let e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){let r=e[t[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let n=0,a=r.length;n<a;n++){let o=r[n].name||String(n);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=n}}}}};h(Dq,"Points");var s4e=Dq;function R3(i,e,t,r,n,a,o){let s=k3.distanceSqToPoint(i);if(s<t){let l=new le;k3.closestPointToPoint(i,l),l.applyMatrix4(r);let u=n.ray.origin.distanceTo(l);if(u<n.near||u>n.far)return;a.push({distance:u,distanceToRay:Math.sqrt(s),point:l,index:e,face:null,object:o})}}h(R3,"testPoint");var kq=class extends En{constructor(e,t,r,n,a,o,s,l,u,c,p,d){super(null,o,s,l,u,c,n,a,p,d),this.isCompressedTexture=!0,this.image={width:t,height:r},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}};h(kq,"CompressedTexture");var u4e=kq,Rq=class extends En{constructor(e,t,r,n,a,o,s,l,u){super(e,t,r,n,a,o,s,l,u),this.isCanvasTexture=!0,this.needsUpdate=!0}};h(Rq,"CanvasTexture");var c4e=Rq,Fq=class{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){let r=this.getUtoTmapping(e);return this.getPoint(r,t)}getPoints(e=5){let t=[];for(let r=0;r<=e;r++)t.push(this.getPoint(r/e));return t}getSpacedPoints(e=5){let t=[];for(let r=0;r<=e;r++)t.push(this.getPointAt(r/e));return t}getLength(){let e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;let t=[],r,n=this.getPoint(0),a=0;t.push(0);for(let o=1;o<=e;o++)r=this.getPoint(o/e),a+=r.distanceTo(n),t.push(a),n=r;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){let r=this.getLengths(),n=0,a=r.length,o;t?o=t:o=e*r[a-1];let s=0,l=a-1,u;for(;s<=l;)if(n=Math.floor(s+(l-s)/2),u=r[n]-o,u<0)s=n+1;else if(u>0)l=n-1;else{l=n;break}if(n=l,r[n]===o)return n/(a-1);let c=r[n],p=r[n+1]-c,d=(o-c)/p;return(n+d)/(a-1)}getTangent(e,t){let r=e-1e-4,n=e+1e-4;r<0&&(r=0),n>1&&(n=1);let a=this.getPoint(r),o=this.getPoint(n),s=t||(a.isVector2?new Oe:new le);return s.copy(o).sub(a).normalize(),s}getTangentAt(e,t){let r=this.getUtoTmapping(e);return this.getTangent(r,t)}computeFrenetFrames(e,t){let r=new le,n=[],a=[],o=[],s=new le,l=new jt;for(let m=0;m<=e;m++){let g=m/e;n[m]=this.getTangentAt(g,new le)}a[0]=new le,o[0]=new le;let u=Number.MAX_VALUE,c=Math.abs(n[0].x),p=Math.abs(n[0].y),d=Math.abs(n[0].z);c<=u&&(u=c,r.set(1,0,0)),p<=u&&(u=p,r.set(0,1,0)),d<=u&&r.set(0,0,1),s.crossVectors(n[0],r).normalize(),a[0].crossVectors(n[0],s),o[0].crossVectors(n[0],a[0]);for(let m=1;m<=e;m++){if(a[m]=a[m-1].clone(),o[m]=o[m-1].clone(),s.crossVectors(n[m-1],n[m]),s.length()>Number.EPSILON){s.normalize();let g=Math.acos(Fr(n[m-1].dot(n[m]),-1,1));a[m].applyMatrix4(l.makeRotationAxis(s,g))}o[m].crossVectors(n[m],a[m])}if(t===!0){let m=Math.acos(Fr(a[0].dot(a[e]),-1,1));m/=e,n[0].dot(s.crossVectors(a[0],a[e]))>0&&(m=-m);for(let g=1;g<=e;g++)a[g].applyMatrix4(l.makeRotationAxis(n[g],m*g)),o[g].crossVectors(n[g],a[g])}return{tangents:n,normals:a,binormals:o}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){let e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}};h(Fq,"Curve");var Zo=Fq,zq=class extends Zo{constructor(e=0,t=0,r=1,n=1,a=0,o=Math.PI*2,s=!1,l=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=r,this.yRadius=n,this.aStartAngle=a,this.aEndAngle=o,this.aClockwise=s,this.aRotation=l}getPoint(e,t=new Oe){let r=t,n=Math.PI*2,a=this.aEndAngle-this.aStartAngle,o=Math.abs(a)<Number.EPSILON;for(;a<0;)a+=n;for(;a>n;)a-=n;a<Number.EPSILON&&(o?a=0:a=n),this.aClockwise===!0&&!o&&(a===n?a=-n:a=a-n);let s=this.aStartAngle+e*a,l=this.aX+this.xRadius*Math.cos(s),u=this.aY+this.yRadius*Math.sin(s);if(this.aRotation!==0){let c=Math.cos(this.aRotation),p=Math.sin(this.aRotation),d=l-this.aX,m=u-this.aY;l=d*c-m*p+this.aX,u=d*p+m*c+this.aY}return r.set(l,u)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){let e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}};h(zq,"EllipseCurve");var TE=zq,Bq=class extends TE{constructor(e,t,r,n,a,o){super(e,t,r,r,n,a,o),this.isArcCurve=!0,this.type="ArcCurve"}};h(Bq,"ArcCurve");var wye=Bq;function Gx(){let i=0,e=0,t=0,r=0;function n(a,o,s,l){i=a,e=s,t=-3*a+3*o-2*s-l,r=2*a-2*o+s+l}return h(n,"init"),{initCatmullRom:function(a,o,s,l,u){n(o,s,u*(s-a),u*(l-o))},initNonuniformCatmullRom:function(a,o,s,l,u,c,p){let d=(o-a)/u-(s-a)/(u+c)+(s-o)/c,m=(s-o)/c-(l-o)/(c+p)+(l-s)/p;d*=c,m*=c,n(o,s,d,m)},calc:function(a){let o=a*a,s=o*a;return i+e*a+t*o+r*s}}}h(Gx,"CubicPoly");var S1=new le,D2=new Gx,k2=new Gx,R2=new Gx,Oq=class extends Zo{constructor(e=[],t=!1,r="centripetal",n=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=r,this.tension=n}getPoint(e,t=new le){let r=t,n=this.points,a=n.length,o=(a-(this.closed?0:1))*e,s=Math.floor(o),l=o-s;this.closed?s+=s>0?0:(Math.floor(Math.abs(s)/a)+1)*a:l===0&&s===a-1&&(s=a-2,l=1);let u,c;this.closed||s>0?u=n[(s-1)%a]:(S1.subVectors(n[0],n[1]).add(n[0]),u=S1);let p=n[s%a],d=n[(s+1)%a];if(this.closed||s+2<a?c=n[(s+2)%a]:(S1.subVectors(n[a-1],n[a-2]).add(n[a-1]),c=S1),this.curveType==="centripetal"||this.curveType==="chordal"){let m=this.curveType==="chordal"?.5:.25,g=Math.pow(u.distanceToSquared(p),m),b=Math.pow(p.distanceToSquared(d),m),x=Math.pow(d.distanceToSquared(c),m);b<1e-4&&(b=1),g<1e-4&&(g=b),x<1e-4&&(x=b),D2.initNonuniformCatmullRom(u.x,p.x,d.x,c.x,g,b,x),k2.initNonuniformCatmullRom(u.y,p.y,d.y,c.y,g,b,x),R2.initNonuniformCatmullRom(u.z,p.z,d.z,c.z,g,b,x)}else this.curveType==="catmullrom"&&(D2.initCatmullRom(u.x,p.x,d.x,c.x,this.tension),k2.initCatmullRom(u.y,p.y,d.y,c.y,this.tension),R2.initCatmullRom(u.z,p.z,d.z,c.z,this.tension));return r.set(D2.calc(l),k2.calc(l),R2.calc(l)),r}copy(e){super.copy(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){let n=e.points[t];this.points.push(n.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){let e=super.toJSON();e.points=[];for(let t=0,r=this.points.length;t<r;t++){let n=this.points[t];e.points.push(n.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){let n=e.points[t];this.points.push(new le().fromArray(n))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}};h(Oq,"CatmullRomCurve3");var Nq=Oq;function F3(i,e,t,r,n){let a=(r-e)*.5,o=(n-t)*.5,s=i*i,l=i*s;return(2*t-2*r+a+o)*l+(-3*t+3*r-2*a-o)*s+a*i+t}h(F3,"CatmullRom");function $q(i,e){let t=1-i;return t*t*e}h($q,"QuadraticBezierP0");function Uq(i,e){return 2*(1-i)*i*e}h(Uq,"QuadraticBezierP1");function Vq(i,e){return i*i*e}h(Vq,"QuadraticBezierP2");function mp(i,e,t,r){return $q(i,e)+Uq(i,t)+Vq(i,r)}h(mp,"QuadraticBezier");function jq(i,e){let t=1-i;return t*t*t*e}h(jq,"CubicBezierP0");function Hq(i,e){let t=1-i;return 3*t*t*i*e}h(Hq,"CubicBezierP1");function Gq(i,e){return 3*(1-i)*i*i*e}h(Gq,"CubicBezierP2");function Wq(i,e){return i*i*i*e}h(Wq,"CubicBezierP3");function gp(i,e,t,r,n){return jq(i,e)+Hq(i,t)+Gq(i,r)+Wq(i,n)}h(gp,"CubicBezier");var Xq=class extends Zo{constructor(e=new Oe,t=new Oe,r=new Oe,n=new Oe){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=r,this.v3=n}getPoint(e,t=new Oe){let r=t,n=this.v0,a=this.v1,o=this.v2,s=this.v3;return r.set(gp(e,n.x,a.x,o.x,s.x),gp(e,n.y,a.y,o.y,s.y)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}};h(Xq,"CubicBezierCurve");var qq=Xq,Zq=class extends Zo{constructor(e=new le,t=new le,r=new le,n=new le){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=r,this.v3=n}getPoint(e,t=new le){let r=t,n=this.v0,a=this.v1,o=this.v2,s=this.v3;return r.set(gp(e,n.x,a.x,o.x,s.x),gp(e,n.y,a.y,o.y,s.y),gp(e,n.z,a.z,o.z,s.z)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}};h(Zq,"CubicBezierCurve3");var Sye=Zq,Yq=class extends Zo{constructor(e=new Oe,t=new Oe){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new Oe){let r=t;return e===1?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(e).add(this.v1)),r}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new Oe){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}};h(Yq,"LineCurve");var Jq=Yq,Kq=class extends Zo{constructor(e=new le,t=new le){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new le){let r=t;return e===1?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(e).add(this.v1)),r}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new le){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}};h(Kq,"LineCurve3");var Mye=Kq,Qq=class extends Zo{constructor(e=new Oe,t=new Oe,r=new Oe){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=r}getPoint(e,t=new Oe){let r=t,n=this.v0,a=this.v1,o=this.v2;return r.set(mp(e,n.x,a.x,o.x),mp(e,n.y,a.y,o.y)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}};h(Qq,"QuadraticBezierCurve");var eZ=Qq,tZ=class extends Zo{constructor(e=new le,t=new le,r=new le){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=r}getPoint(e,t=new le){let r=t,n=this.v0,a=this.v1,o=this.v2;return r.set(mp(e,n.x,a.x,o.x),mp(e,n.y,a.y,o.y),mp(e,n.z,a.z,o.z)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}};h(tZ,"QuadraticBezierCurve3");var iZ=tZ,rZ=class extends Zo{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new Oe){let r=t,n=this.points,a=(n.length-1)*e,o=Math.floor(a),s=a-o,l=n[o===0?o:o-1],u=n[o],c=n[o>n.length-2?n.length-1:o+1],p=n[o>n.length-3?n.length-1:o+2];return r.set(F3(s,l.x,u.x,c.x,p.x),F3(s,l.y,u.y,c.y,p.y)),r}copy(e){super.copy(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){let n=e.points[t];this.points.push(n.clone())}return this}toJSON(){let e=super.toJSON();e.points=[];for(let t=0,r=this.points.length;t<r;t++){let n=this.points[t];e.points.push(n.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){let n=e.points[t];this.points.push(new Oe().fromArray(n))}return this}};h(rZ,"SplineCurve");var nZ=rZ,Mv=Object.freeze({__proto__:null,ArcCurve:wye,CatmullRomCurve3:Nq,CubicBezierCurve:qq,CubicBezierCurve3:Sye,EllipseCurve:TE,LineCurve:Jq,LineCurve3:Mye,QuadraticBezierCurve:eZ,QuadraticBezierCurve3:iZ,SplineCurve:nZ}),aZ=class extends Zo{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){let e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(t)){let r=e.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new Mv[r](t,e))}return this}getPoint(e,t){let r=e*this.getLength(),n=this.getCurveLengths(),a=0;for(;a<n.length;){if(n[a]>=r){let o=n[a]-r,s=this.curves[a],l=s.getLength(),u=l===0?0:1-o/l;return s.getPointAt(u,t)}a++}return null}getLength(){let e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;let e=[],t=0;for(let r=0,n=this.curves.length;r<n;r++)t+=this.curves[r].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){let t=[];for(let r=0;r<=e;r++)t.push(this.getPoint(r/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){let t=[],r;for(let n=0,a=this.curves;n<a.length;n++){let o=a[n],s=o.isEllipseCurve?e*2:o.isLineCurve||o.isLineCurve3?1:o.isSplineCurve?e*o.points.length:e,l=o.getPoints(s);for(let u=0;u<l.length;u++){let c=l[u];r&&r.equals(c)||(t.push(c),r=c)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,r=e.curves.length;t<r;t++){let n=e.curves[t];this.curves.push(n.clone())}return this.autoClose=e.autoClose,this}toJSON(){let e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,r=this.curves.length;t<r;t++){let n=this.curves[t];e.curves.push(n.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,r=e.curves.length;t<r;t++){let n=e.curves[t];this.curves.push(new Mv[n.type]().fromJSON(n))}return this}};h(aZ,"CurvePath");var Cye=aZ,oZ=class extends Cye{constructor(e){super(),this.type="Path",this.currentPoint=new Oe,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,r=e.length;t<r;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){let r=new Jq(this.currentPoint.clone(),new Oe(e,t));return this.curves.push(r),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,r,n){let a=new eZ(this.currentPoint.clone(),new Oe(e,t),new Oe(r,n));return this.curves.push(a),this.currentPoint.set(r,n),this}bezierCurveTo(e,t,r,n,a,o){let s=new qq(this.currentPoint.clone(),new Oe(e,t),new Oe(r,n),new Oe(a,o));return this.curves.push(s),this.currentPoint.set(a,o),this}splineThru(e){let t=[this.currentPoint.clone()].concat(e),r=new nZ(t);return this.curves.push(r),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,r,n,a,o){let s=this.currentPoint.x,l=this.currentPoint.y;return this.absarc(e+s,t+l,r,n,a,o),this}absarc(e,t,r,n,a,o){return this.absellipse(e,t,r,r,n,a,o),this}ellipse(e,t,r,n,a,o,s,l){let u=this.currentPoint.x,c=this.currentPoint.y;return this.absellipse(e+u,t+c,r,n,a,o,s,l),this}absellipse(e,t,r,n,a,o,s,l){let u=new TE(e,t,r,n,a,o,s,l);if(this.curves.length>0){let p=u.getPoint(0);p.equals(this.currentPoint)||this.lineTo(p.x,p.y)}this.curves.push(u);let c=u.getPoint(1);return this.currentPoint.copy(c),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){let e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}};h(oZ,"Path");var jp=oZ,sZ=class lZ extends ma{constructor(e=1,t=1,r=1,n=32,a=1,o=!1,s=0,l=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:r,radialSegments:n,heightSegments:a,openEnded:o,thetaStart:s,thetaLength:l};let u=this;n=Math.floor(n),a=Math.floor(a);let c=[],p=[],d=[],m=[],g=0,b=[],x=r/2,v=0;w(),o===!1&&(e>0&&_(!0),t>0&&_(!1)),this.setIndex(c),this.setAttribute("position",new jr(p,3)),this.setAttribute("normal",new jr(d,3)),this.setAttribute("uv",new jr(m,2));function w(){let C=new le,E=new le,T=0,L=(t-e)/r;for(let D=0;D<=a;D++){let B=[],A=D/a,k=A*(t-e)+e;for(let $=0;$<=n;$++){let O=$/n,P=O*l+s,U=Math.sin(P),G=Math.cos(P);E.x=k*U,E.y=-A*r+x,E.z=k*G,p.push(E.x,E.y,E.z),C.set(U,L,G).normalize(),d.push(C.x,C.y,C.z),m.push(O,1-A),B.push(g++)}b.push(B)}for(let D=0;D<n;D++)for(let B=0;B<a;B++){let A=b[B][D],k=b[B+1][D],$=b[B+1][D+1],O=b[B][D+1];c.push(A,k,O),c.push(k,$,O),T+=6}u.addGroup(v,T,0),v+=T}h(w,"generateTorso");function _(C){let E=g,T=new Oe,L=new le,D=0,B=C===!0?e:t,A=C===!0?1:-1;for(let $=1;$<=n;$++)p.push(0,x*A,0),d.push(0,A,0),m.push(.5,.5),g++;let k=g;for(let $=0;$<=n;$++){let O=$/n*l+s,P=Math.cos(O),U=Math.sin(O);L.x=B*U,L.y=x*A,L.z=B*P,p.push(L.x,L.y,L.z),d.push(0,A,0),T.x=P*.5+.5,T.y=U*.5*A+.5,m.push(T.x,T.y),g++}for(let $=0;$<n;$++){let O=E+$,P=k+$;C===!0?c.push(P,P+1,O):c.push(P+1,P,O),D+=3}u.addGroup(v,D,C===!0?1:2),v+=D}h(_,"generateCap")}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new lZ(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}};h(sZ,"CylinderGeometry");var j6=sZ,M1=new le,C1=new le,F2=new le,E1=new of,uZ=class extends ma{constructor(e=null,t=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:t},e!==null){let r=Math.pow(10,4),n=Math.cos(dp*t),a=e.getIndex(),o=e.getAttribute("position"),s=a?a.count:o.count,l=[0,0,0],u=["a","b","c"],c=new Array(3),p={},d=[];for(let m=0;m<s;m+=3){a?(l[0]=a.getX(m),l[1]=a.getX(m+1),l[2]=a.getX(m+2)):(l[0]=m,l[1]=m+1,l[2]=m+2);let{a:g,b,c:x}=E1;if(g.fromBufferAttribute(o,l[0]),b.fromBufferAttribute(o,l[1]),x.fromBufferAttribute(o,l[2]),E1.getNormal(F2),c[0]=`${Math.round(g.x*r)},${Math.round(g.y*r)},${Math.round(g.z*r)}`,c[1]=`${Math.round(b.x*r)},${Math.round(b.y*r)},${Math.round(b.z*r)}`,c[2]=`${Math.round(x.x*r)},${Math.round(x.y*r)},${Math.round(x.z*r)}`,!(c[0]===c[1]||c[1]===c[2]||c[2]===c[0]))for(let v=0;v<3;v++){let w=(v+1)%3,_=c[v],C=c[w],E=E1[u[v]],T=E1[u[w]],L=`${_}_${C}`,D=`${C}_${_}`;D in p&&p[D]?(F2.dot(p[D].normal)<=n&&(d.push(E.x,E.y,E.z),d.push(T.x,T.y,T.z)),p[D]=null):L in p||(p[L]={index0:l[v],index1:l[w],normal:F2.clone()})}}for(let m in p)if(p[m]){let{index0:g,index1:b}=p[m];M1.fromBufferAttribute(o,g),C1.fromBufferAttribute(o,b),d.push(M1.x,M1.y,M1.z),d.push(C1.x,C1.y,C1.z)}this.setAttribute("position",new jr(d,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}};h(uZ,"EdgesGeometry");var Eye=uZ,hZ=class extends jp{constructor(e){super(e),this.uuid=ha(),this.type="Shape",this.holes=[]}getPointsHoles(e){let t=[];for(let r=0,n=this.holes.length;r<n;r++)t[r]=this.holes[r].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,r=e.holes.length;t<r;t++){let n=e.holes[t];this.holes.push(n.clone())}return this}toJSON(){let e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,r=this.holes.length;t<r;t++){let n=this.holes[t];e.holes.push(n.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,r=e.holes.length;t<r;t++){let n=e.holes[t];this.holes.push(new jp().fromJSON(n))}return this}};h(hZ,"Shape");var nd=hZ,Tye={triangulate:function(i,e,t=2){let r=e&&e.length,n=r?e[0]*t:i.length,a=PE(i,0,n,t,!0),o=[];if(!a||a.next===a.prev)return o;let s,l,u,c,p,d,m;if(r&&(a=mZ(i,e,a,t)),i.length>80*t){s=u=i[0],l=c=i[1];for(let g=t;g<n;g+=t)p=i[g],d=i[g+1],p<s&&(s=p),d<l&&(l=d),p>u&&(u=p),d>c&&(c=d);m=Math.max(u-s,c-l),m=m!==0?32767/m:0}return Hp(a,o,t,s,l,m,0),o}};function PE(i,e,t,r,n){let a,o;if(n===EZ(i,e,t,r)>0)for(a=e;a<t;a+=r)o=z3(a,i[a],i[a+1],o);else for(a=t-r;a>=e;a-=r)o=z3(a,i[a],i[a+1],o);return o&&ag(o,o.next)&&(Wp(o),o=o.next),o}h(PE,"linkedList");function Ol(i,e){if(!i)return i;e||(e=i);let t=i,r;do if(r=!1,!t.steiner&&(ag(t,t.next)||Gi(t.prev,t,t.next)===0)){if(Wp(t),t=e=t.prev,t===t.next)break;r=!0}else t=t.next;while(r||t!==e);return e}h(Ol,"filterPoints");function Hp(i,e,t,r,n,a,o){if(!i)return;!o&&a&&_Z(i,r,n,a);let s=i,l,u;for(;i.prev!==i.next;){if(l=i.prev,u=i.next,a?pZ(i,r,n,a):cZ(i)){e.push(l.i/t|0),e.push(i.i/t|0),e.push(u.i/t|0),Wp(i),i=u.next,s=u.next;continue}if(i=u,i===s){o?o===1?(i=dZ(Ol(i),e,t),Hp(i,e,t,r,n,a,2)):o===2&&fZ(i,e,t,r,n,a):Hp(Ol(i),e,t,r,n,a,1);break}}}h(Hp,"earcutLinked");function cZ(i){let e=i.prev,t=i,r=i.next;if(Gi(e,t,r)>=0)return!1;let n=e.x,a=t.x,o=r.x,s=e.y,l=t.y,u=r.y,c=n<a?n<o?n:o:a<o?a:o,p=s<l?s<u?s:u:l<u?l:u,d=n>a?n>o?n:o:a>o?a:o,m=s>l?s>u?s:u:l>u?l:u,g=r.next;for(;g!==e;){if(g.x>=c&&g.x<=d&&g.y>=p&&g.y<=m&&Iu(n,s,a,l,o,u,g.x,g.y)&&Gi(g.prev,g,g.next)>=0)return!1;g=g.next}return!0}h(cZ,"isEar");function pZ(i,e,t,r){let n=i.prev,a=i,o=i.next;if(Gi(n,a,o)>=0)return!1;let s=n.x,l=a.x,u=o.x,c=n.y,p=a.y,d=o.y,m=s<l?s<u?s:u:l<u?l:u,g=c<p?c<d?c:d:p<d?p:d,b=s>l?s>u?s:u:l>u?l:u,x=c>p?c>d?c:d:p>d?p:d,v=Cv(m,g,e,t,r),w=Cv(b,x,e,t,r),_=i.prevZ,C=i.nextZ;for(;_&&_.z>=v&&C&&C.z<=w;){if(_.x>=m&&_.x<=b&&_.y>=g&&_.y<=x&&_!==n&&_!==o&&Iu(s,c,l,p,u,d,_.x,_.y)&&Gi(_.prev,_,_.next)>=0||(_=_.prevZ,C.x>=m&&C.x<=b&&C.y>=g&&C.y<=x&&C!==n&&C!==o&&Iu(s,c,l,p,u,d,C.x,C.y)&&Gi(C.prev,C,C.next)>=0))return!1;C=C.nextZ}for(;_&&_.z>=v;){if(_.x>=m&&_.x<=b&&_.y>=g&&_.y<=x&&_!==n&&_!==o&&Iu(s,c,l,p,u,d,_.x,_.y)&&Gi(_.prev,_,_.next)>=0)return!1;_=_.prevZ}for(;C&&C.z<=w;){if(C.x>=m&&C.x<=b&&C.y>=g&&C.y<=x&&C!==n&&C!==o&&Iu(s,c,l,p,u,d,C.x,C.y)&&Gi(C.prev,C,C.next)>=0)return!1;C=C.nextZ}return!0}h(pZ,"isEarHashed");function dZ(i,e,t){let r=i;do{let n=r.prev,a=r.next.next;!ag(n,a)&&AE(n,r,r.next,a)&&Gp(n,a)&&Gp(a,n)&&(e.push(n.i/t|0),e.push(r.i/t|0),e.push(a.i/t|0),Wp(r),Wp(r.next),r=i=a),r=r.next}while(r!==i);return Ol(r)}h(dZ,"cureLocalIntersections");function fZ(i,e,t,r,n,a){let o=i;do{let s=o.next.next;for(;s!==o.prev;){if(o.i!==s.i&&SZ(o,s)){let l=IE(o,s);o=Ol(o,o.next),l=Ol(l,l.next),Hp(o,e,t,r,n,a,0),Hp(l,e,t,r,n,a,0);return}s=s.next}o=o.next}while(o!==i)}h(fZ,"splitEarcut");function mZ(i,e,t,r){let n=[],a,o,s,l,u;for(a=0,o=e.length;a<o;a++)s=e[a]*r,l=a<o-1?e[a+1]*r:i.length,u=PE(i,s,l,r,!1),u===u.next&&(u.steiner=!0),n.push(wZ(u));for(n.sort(gZ),a=0;a<n.length;a++)t=yZ(n[a],t);return t}h(mZ,"eliminateHoles");function gZ(i,e){return i.x-e.x}h(gZ,"compareX");function yZ(i,e){let t=vZ(i,e);if(!t)return e;let r=IE(t,i);return Ol(r,r.next),Ol(t,t.next)}h(yZ,"eliminateHole");function vZ(i,e){let t=e,r=-1/0,n,a=i.x,o=i.y;do{if(o<=t.y&&o>=t.next.y&&t.next.y!==t.y){let d=t.x+(o-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(d<=a&&d>r&&(r=d,n=t.x<t.next.x?t:t.next,d===a))return n}t=t.next}while(t!==e);if(!n)return null;let s=n,l=n.x,u=n.y,c=1/0,p;t=n;do a>=t.x&&t.x>=l&&a!==t.x&&Iu(o<u?a:r,o,l,u,o<u?r:a,o,t.x,t.y)&&(p=Math.abs(o-t.y)/(a-t.x),Gp(t,i)&&(p<c||p===c&&(t.x>n.x||t.x===n.x&&xZ(n,t)))&&(n=t,c=p)),t=t.next;while(t!==s);return n}h(vZ,"findHoleBridge");function xZ(i,e){return Gi(i.prev,i,e.prev)<0&&Gi(e.next,i,i.next)<0}h(xZ,"sectorContainsSector");function _Z(i,e,t,r){let n=i;do n.z===0&&(n.z=Cv(n.x,n.y,e,t,r)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next;while(n!==i);n.prevZ.nextZ=null,n.prevZ=null,bZ(n)}h(_Z,"indexCurve");function bZ(i){let e,t,r,n,a,o,s,l,u=1;do{for(t=i,i=null,a=null,o=0;t;){for(o++,r=t,s=0,e=0;e<u&&(s++,r=r.nextZ,!!r);e++);for(l=u;s>0||l>0&&r;)s!==0&&(l===0||!r||t.z<=r.z)?(n=t,t=t.nextZ,s--):(n=r,r=r.nextZ,l--),a?a.nextZ=n:i=n,n.prevZ=a,a=n;t=r}a.nextZ=null,u*=2}while(o>1);return i}h(bZ,"sortLinked");function Cv(i,e,t,r,n){return i=(i-t)*n|0,e=(e-r)*n|0,i=(i|i<<8)&16711935,i=(i|i<<4)&252645135,i=(i|i<<2)&858993459,i=(i|i<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,i|e<<1}h(Cv,"zOrder");function wZ(i){let e=i,t=i;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==i);return t}h(wZ,"getLeftmost");function Iu(i,e,t,r,n,a,o,s){return(n-o)*(e-s)>=(i-o)*(a-s)&&(i-o)*(r-s)>=(t-o)*(e-s)&&(t-o)*(a-s)>=(n-o)*(r-s)}h(Iu,"pointInTriangle");function SZ(i,e){return i.next.i!==e.i&&i.prev.i!==e.i&&!MZ(i,e)&&(Gp(i,e)&&Gp(e,i)&&CZ(i,e)&&(Gi(i.prev,i,e.prev)||Gi(i,e.prev,e))||ag(i,e)&&Gi(i.prev,i,i.next)>0&&Gi(e.prev,e,e.next)>0)}h(SZ,"isValidDiagonal");function Gi(i,e,t){return(e.y-i.y)*(t.x-e.x)-(e.x-i.x)*(t.y-e.y)}h(Gi,"area");function ag(i,e){return i.x===e.x&&i.y===e.y}h(ag,"equals");function AE(i,e,t,r){let n=hf(Gi(i,e,t)),a=hf(Gi(i,e,r)),o=hf(Gi(t,r,i)),s=hf(Gi(t,r,e));return!!(n!==a&&o!==s||n===0&&uf(i,t,e)||a===0&&uf(i,r,e)||o===0&&uf(t,i,r)||s===0&&uf(t,e,r))}h(AE,"intersects");function uf(i,e,t){return e.x<=Math.max(i.x,t.x)&&e.x>=Math.min(i.x,t.x)&&e.y<=Math.max(i.y,t.y)&&e.y>=Math.min(i.y,t.y)}h(uf,"onSegment");function hf(i){return i>0?1:i<0?-1:0}h(hf,"sign");function MZ(i,e){let t=i;do{if(t.i!==i.i&&t.next.i!==i.i&&t.i!==e.i&&t.next.i!==e.i&&AE(t,t.next,i,e))return!0;t=t.next}while(t!==i);return!1}h(MZ,"intersectsPolygon");function Gp(i,e){return Gi(i.prev,i,i.next)<0?Gi(i,e,i.next)>=0&&Gi(i,i.prev,e)>=0:Gi(i,e,i.prev)<0||Gi(i,i.next,e)<0}h(Gp,"locallyInside");function CZ(i,e){let t=i,r=!1,n=(i.x+e.x)/2,a=(i.y+e.y)/2;do t.y>a!=t.next.y>a&&t.next.y!==t.y&&n<(t.next.x-t.x)*(a-t.y)/(t.next.y-t.y)+t.x&&(r=!r),t=t.next;while(t!==i);return r}h(CZ,"middleInside");function IE(i,e){let t=new Ev(i.i,i.x,i.y),r=new Ev(e.i,e.x,e.y),n=i.next,a=e.prev;return i.next=e,e.prev=i,t.next=n,n.prev=t,r.next=t,t.prev=r,a.next=r,r.prev=a,r}h(IE,"splitPolygon");function z3(i,e,t,r){let n=new Ev(i,e,t);return r?(n.next=r.next,n.prev=r,r.next.prev=n,r.next=n):(n.prev=n,n.next=n),n}h(z3,"insertNode");function Wp(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}h(Wp,"removeNode");function Ev(i,e,t){this.i=i,this.x=e,this.y=t,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}h(Ev,"Node");function EZ(i,e,t,r){let n=0;for(let a=e,o=t-r;a<t;a+=r)n+=(i[o]-i[a])*(i[a+1]+i[o+1]),o=a;return n}h(EZ,"signedArea");var TZ=class PZ{static area(e){let t=e.length,r=0;for(let n=t-1,a=0;a<t;n=a++)r+=e[n].x*e[a].y-e[a].x*e[n].y;return r*.5}static isClockWise(e){return PZ.area(e)<0}static triangulateShape(e,t){let r=[],n=[],a=[];B3(e),O3(r,e);let o=e.length;t.forEach(B3);for(let l=0;l<t.length;l++)n.push(o),o+=t[l].length,O3(r,t[l]);let s=Tye.triangulate(r,n);for(let l=0;l<s.length;l+=3)a.push(s.slice(l,l+3));return a}};h(TZ,"ShapeUtils");var z2=TZ;function B3(i){let e=i.length;e>2&&i[e-1].equals(i[0])&&i.pop()}h(B3,"removeDupEndPts");function O3(i,e){for(let t=0;t<e.length;t++)i.push(e[t].x),i.push(e[t].y)}h(O3,"addContour");var AZ=class IZ extends ma{constructor(e=new nd([new Oe(.5,.5),new Oe(-.5,.5),new Oe(-.5,-.5),new Oe(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];let r=this,n=[],a=[];for(let s=0,l=e.length;s<l;s++){let u=e[s];o(u)}this.setAttribute("position",new jr(n,3)),this.setAttribute("uv",new jr(a,2)),this.computeVertexNormals();function o(s){let l=[],u=t.curveSegments!==void 0?t.curveSegments:12,c=t.steps!==void 0?t.steps:1,p=t.depth!==void 0?t.depth:1,d=t.bevelEnabled!==void 0?t.bevelEnabled:!0,m=t.bevelThickness!==void 0?t.bevelThickness:.2,g=t.bevelSize!==void 0?t.bevelSize:m-.1,b=t.bevelOffset!==void 0?t.bevelOffset:0,x=t.bevelSegments!==void 0?t.bevelSegments:3,v=t.extrudePath,w=t.UVGenerator!==void 0?t.UVGenerator:Pye,_,C=!1,E,T,L,D;v&&(_=v.getSpacedPoints(c),C=!0,d=!1,E=v.computeFrenetFrames(c,!1),T=new le,L=new le,D=new le),d||(x=0,m=0,g=0,b=0);let B=s.extractPoints(u),A=B.shape,k=B.holes;if(!z2.isClockWise(A)){A=A.reverse();for(let me=0,Q=k.length;me<Q;me++){let Me=k[me];z2.isClockWise(Me)&&(k[me]=Me.reverse())}}let $=z2.triangulateShape(A,k),O=A;for(let me=0,Q=k.length;me<Q;me++){let Me=k[me];A=A.concat(Me)}function P(me,Q,Me){return Q||console.error("THREE.ExtrudeGeometry: vec does not exist"),me.clone().addScaledVector(Q,Me)}h(P,"scalePt2");let U=A.length,G=$.length;function K(me,Q,Me){let ve,Ie,De,we=me.x-Q.x,Fe=me.y-Q.y,Ze=Me.x-me.x,yt=Me.y-me.y,ne=we*we+Fe*Fe,W=we*yt-Fe*Ze;if(Math.abs(W)>Number.EPSILON){let _e=Math.sqrt(ne),Re=Math.sqrt(Ze*Ze+yt*yt),Ne=Q.x-Fe/_e,ze=Q.y+we/_e,xt=Me.x-yt/Re,ot=Me.y+Ze/Re,je=((xt-Ne)*yt-(ot-ze)*Ze)/(we*yt-Fe*Ze);ve=Ne+we*je-me.x,Ie=ze+Fe*je-me.y;let He=ve*ve+Ie*Ie;if(He<=2)return new Oe(ve,Ie);De=Math.sqrt(He/2)}else{let _e=!1;we>Number.EPSILON?Ze>Number.EPSILON&&(_e=!0):we<-Number.EPSILON?Ze<-Number.EPSILON&&(_e=!0):Math.sign(Fe)===Math.sign(yt)&&(_e=!0),_e?(ve=-Fe,Ie=we,De=Math.sqrt(ne)):(ve=we,Ie=Fe,De=Math.sqrt(ne/2))}return new Oe(ve/De,Ie/De)}h(K,"getBevelVec");let z=[];for(let me=0,Q=O.length,Me=Q-1,ve=me+1;me<Q;me++,Me++,ve++)Me===Q&&(Me=0),ve===Q&&(ve=0),z[me]=K(O[me],O[Me],O[ve]);let V=[],j,q=z.concat();for(let me=0,Q=k.length;me<Q;me++){let Me=k[me];j=[];for(let ve=0,Ie=Me.length,De=Ie-1,we=ve+1;ve<Ie;ve++,De++,we++)De===Ie&&(De=0),we===Ie&&(we=0),j[ve]=K(Me[ve],Me[De],Me[we]);V.push(j),q=q.concat(j)}for(let me=0;me<x;me++){let Q=me/x,Me=m*Math.cos(Q*Math.PI/2),ve=g*Math.sin(Q*Math.PI/2)+b;for(let Ie=0,De=O.length;Ie<De;Ie++){let we=P(O[Ie],z[Ie],ve);Y(we.x,we.y,-Me)}for(let Ie=0,De=k.length;Ie<De;Ie++){let we=k[Ie];j=V[Ie];for(let Fe=0,Ze=we.length;Fe<Ze;Fe++){let yt=P(we[Fe],j[Fe],ve);Y(yt.x,yt.y,-Me)}}}let ee=g+b;for(let me=0;me<U;me++){let Q=d?P(A[me],q[me],ee):A[me];C?(L.copy(E.normals[0]).multiplyScalar(Q.x),T.copy(E.binormals[0]).multiplyScalar(Q.y),D.copy(_[0]).add(L).add(T),Y(D.x,D.y,D.z)):Y(Q.x,Q.y,0)}for(let me=1;me<=c;me++)for(let Q=0;Q<U;Q++){let Me=d?P(A[Q],q[Q],ee):A[Q];C?(L.copy(E.normals[me]).multiplyScalar(Me.x),T.copy(E.binormals[me]).multiplyScalar(Me.y),D.copy(_[me]).add(L).add(T),Y(D.x,D.y,D.z)):Y(Me.x,Me.y,p/c*me)}for(let me=x-1;me>=0;me--){let Q=me/x,Me=m*Math.cos(Q*Math.PI/2),ve=g*Math.sin(Q*Math.PI/2)+b;for(let Ie=0,De=O.length;Ie<De;Ie++){let we=P(O[Ie],z[Ie],ve);Y(we.x,we.y,p+Me)}for(let Ie=0,De=k.length;Ie<De;Ie++){let we=k[Ie];j=V[Ie];for(let Fe=0,Ze=we.length;Fe<Ze;Fe++){let yt=P(we[Fe],j[Fe],ve);C?Y(yt.x,yt.y+_[c-1].y,_[c-1].x+Me):Y(yt.x,yt.y,p+Me)}}}ae(),N();function ae(){let me=n.length/3;if(d){let Q=0,Me=U*Q;for(let ve=0;ve<G;ve++){let Ie=$[ve];oe(Ie[2]+Me,Ie[1]+Me,Ie[0]+Me)}Q=c+x*2,Me=U*Q;for(let ve=0;ve<G;ve++){let Ie=$[ve];oe(Ie[0]+Me,Ie[1]+Me,Ie[2]+Me)}}else{for(let Q=0;Q<G;Q++){let Me=$[Q];oe(Me[2],Me[1],Me[0])}for(let Q=0;Q<G;Q++){let Me=$[Q];oe(Me[0]+U*c,Me[1]+U*c,Me[2]+U*c)}}r.addGroup(me,n.length/3-me,0)}h(ae,"buildLidFaces");function N(){let me=n.length/3,Q=0;J(O,Q),Q+=O.length;for(let Me=0,ve=k.length;Me<ve;Me++){let Ie=k[Me];J(Ie,Q),Q+=Ie.length}r.addGroup(me,n.length/3-me,1)}h(N,"buildSideFaces");function J(me,Q){let Me=me.length;for(;--Me>=0;){let ve=Me,Ie=Me-1;Ie<0&&(Ie=me.length-1);for(let De=0,we=c+x*2;De<we;De++){let Fe=U*De,Ze=U*(De+1),yt=Q+ve+Fe,ne=Q+Ie+Fe,W=Q+Ie+Ze,_e=Q+ve+Ze;xe(yt,ne,W,_e)}}}h(J,"sidewalls");function Y(me,Q,Me){l.push(me),l.push(Q),l.push(Me)}h(Y,"v");function oe(me,Q,Me){ge(me),ge(Q),ge(Me);let ve=n.length/3,Ie=w.generateTopUV(r,n,ve-3,ve-2,ve-1);Te(Ie[0]),Te(Ie[1]),Te(Ie[2])}h(oe,"f3");function xe(me,Q,Me,ve){ge(me),ge(Q),ge(ve),ge(Q),ge(Me),ge(ve);let Ie=n.length/3,De=w.generateSideWallUV(r,n,Ie-6,Ie-3,Ie-2,Ie-1);Te(De[0]),Te(De[1]),Te(De[3]),Te(De[1]),Te(De[2]),Te(De[3])}h(xe,"f4");function ge(me){n.push(l[me*3+0]),n.push(l[me*3+1]),n.push(l[me*3+2])}h(ge,"addVertex");function Te(me){a.push(me.x),a.push(me.y)}h(Te,"addUV")}h(o,"addShape")}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){let e=super.toJSON(),t=this.parameters.shapes,r=this.parameters.options;return LZ(t,r,e)}static fromJSON(e,t){let r=[];for(let a=0,o=e.shapes.length;a<o;a++){let s=t[e.shapes[a]];r.push(s)}let n=e.options.extrudePath;return n!==void 0&&(e.options.extrudePath=new Mv[n.type]().fromJSON(n)),new IZ(r,e.options)}};h(AZ,"ExtrudeGeometry");var og=AZ,Pye={generateTopUV:function(i,e,t,r,n){let a=e[t*3],o=e[t*3+1],s=e[r*3],l=e[r*3+1],u=e[n*3],c=e[n*3+1];return[new Oe(a,o),new Oe(s,l),new Oe(u,c)]},generateSideWallUV:function(i,e,t,r,n,a){let o=e[t*3],s=e[t*3+1],l=e[t*3+2],u=e[r*3],c=e[r*3+1],p=e[r*3+2],d=e[n*3],m=e[n*3+1],g=e[n*3+2],b=e[a*3],x=e[a*3+1],v=e[a*3+2];return Math.abs(s-c)<Math.abs(o-u)?[new Oe(o,1-l),new Oe(u,1-p),new Oe(d,1-g),new Oe(b,1-v)]:[new Oe(s,1-l),new Oe(c,1-p),new Oe(m,1-g),new Oe(x,1-v)]}};function LZ(i,e,t){if(t.shapes=[],Array.isArray(i))for(let r=0,n=i.length;r<n;r++){let a=i[r];t.shapes.push(a.uuid)}else t.shapes.push(i.uuid);return t.options=Object.assign({},e),e.extrudePath!==void 0&&(t.options.extrudePath=e.extrudePath.toJSON()),t}h(LZ,"toJSON$1");var DZ=class kZ extends ma{constructor(e=new iZ(new le(-1,-1,0),new le(-1,1,0),new le(1,1,0)),t=64,r=1,n=8,a=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:r,radialSegments:n,closed:a};let o=e.computeFrenetFrames(t,a);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals;let s=new le,l=new le,u=new Oe,c=new le,p=[],d=[],m=[],g=[];b(),this.setIndex(g),this.setAttribute("position",new jr(p,3)),this.setAttribute("normal",new jr(d,3)),this.setAttribute("uv",new jr(m,2));function b(){for(let _=0;_<t;_++)x(_);x(a===!1?t:0),w(),v()}h(b,"generateBufferData");function x(_){c=e.getPointAt(_/t,c);let C=o.normals[_],E=o.binormals[_];for(let T=0;T<=n;T++){let L=T/n*Math.PI*2,D=Math.sin(L),B=-Math.cos(L);l.x=B*C.x+D*E.x,l.y=B*C.y+D*E.y,l.z=B*C.z+D*E.z,l.normalize(),d.push(l.x,l.y,l.z),s.x=c.x+r*l.x,s.y=c.y+r*l.y,s.z=c.z+r*l.z,p.push(s.x,s.y,s.z)}}h(x,"generateSegment");function v(){for(let _=1;_<=t;_++)for(let C=1;C<=n;C++){let E=(n+1)*(_-1)+(C-1),T=(n+1)*_+(C-1),L=(n+1)*_+C,D=(n+1)*(_-1)+C;g.push(E,T,D),g.push(T,L,D)}}h(v,"generateIndices");function w(){for(let _=0;_<=t;_++)for(let C=0;C<=n;C++)u.x=_/t,u.y=C/n,m.push(u.x,u.y)}h(w,"generateUVs")}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){let e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new kZ(new Mv[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}};h(DZ,"TubeGeometry");var Aye=DZ,RZ=class extends Wl{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Lt(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Lt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=vE,this.normalScale=new Oe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new $a,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}};h(RZ,"MeshStandardMaterial");var FZ=RZ,zZ=class extends FZ{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Oe(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Fr(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new Lt(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new Lt(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Lt(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}};h(zZ,"MeshPhysicalMaterial");var A4e=zZ,BZ=class extends Wl{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new Lt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Lt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=vE,this.normalScale=new Oe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new $a,this.combine=gE,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}};h(BZ,"MeshLambertMaterial");var Tv=BZ;function cf(i,e,t){return!i||!t&&i.constructor===e?i:typeof e.BYTES_PER_ELEMENT=="number"?new e(i):Array.prototype.slice.call(i)}h(cf,"convertArray");function OZ(i){return ArrayBuffer.isView(i)&&!(i instanceof DataView)}h(OZ,"isTypedArray");function NZ(i){function e(n,a){return i[n]-i[a]}h(e,"compareTime");let t=i.length,r=new Array(t);for(let n=0;n!==t;++n)r[n]=n;return r.sort(e),r}h(NZ,"getKeyframeOrder");function N3(i,e,t){let r=i.length,n=new i.constructor(r);for(let a=0,o=0;o!==r;++a){let s=t[a]*e;for(let l=0;l!==e;++l)n[o++]=i[s+l]}return n}h(N3,"sortedArray");function LE(i,e,t,r){let n=1,a=i[0];for(;a!==void 0&&a[r]===void 0;)a=i[n++];if(a===void 0)return;let o=a[r];if(o!==void 0)if(Array.isArray(o))do o=a[r],o!==void 0&&(e.push(a.time),t.push.apply(t,o)),a=i[n++];while(a!==void 0);else if(o.toArray!==void 0)do o=a[r],o!==void 0&&(e.push(a.time),o.toArray(t,t.length)),a=i[n++];while(a!==void 0);else do o=a[r],o!==void 0&&(e.push(a.time),t.push(o)),a=i[n++];while(a!==void 0)}h(LE,"flattenJSON");var $Z=class{constructor(e,t,r,n){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=n!==void 0?n:new t.constructor(r),this.sampleValues=t,this.valueSize=r,this.settings=null,this.DefaultSettings_={}}evaluate(e){let t=this.parameterPositions,r=this._cachedIndex,n=t[r],a=t[r-1];e:{t:{let o;i:{r:if(!(e<n)){for(let s=r+2;;){if(n===void 0){if(e<a)break r;return r=t.length,this._cachedIndex=r,this.copySampleValue_(r-1)}if(r===s)break;if(a=n,n=t[++r],e<n)break t}o=t.length;break i}if(!(e>=a)){let s=t[1];e<s&&(r=2,a=s);for(let l=r-2;;){if(a===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(r===l)break;if(n=a,a=t[--r-1],e>=a)break t}o=r,r=0;break i}break e}for(;r<o;){let s=r+o>>>1;e<t[s]?o=s:r=s+1}if(n=t[r],a=t[r-1],a===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(n===void 0)return r=t.length,this._cachedIndex=r,this.copySampleValue_(r-1)}this._cachedIndex=r,this.intervalChanged_(r,a,n)}return this.interpolate_(r,a,e,n)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){let t=this.resultBuffer,r=this.sampleValues,n=this.valueSize,a=e*n;for(let o=0;o!==n;++o)t[o]=r[a+o];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}};h($Z,"Interpolant");var Wx=$Z,UZ=class extends Wx{constructor(e,t,r,n){super(e,t,r,n),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:WA,endingEnd:WA}}intervalChanged_(e,t,r){let n=this.parameterPositions,a=e-2,o=e+1,s=n[a],l=n[o];if(s===void 0)switch(this.getSettings_().endingStart){case XA:a=e,s=2*t-r;break;case qA:a=n.length-2,s=t+n[a]-n[a+1];break;default:a=e,s=r}if(l===void 0)switch(this.getSettings_().endingEnd){case XA:o=e,l=2*r-t;break;case qA:o=1,l=r+n[1]-n[0];break;default:o=e-1,l=t}let u=(r-t)*.5,c=this.valueSize;this._weightPrev=u/(t-s),this._weightNext=u/(l-r),this._offsetPrev=a*c,this._offsetNext=o*c}interpolate_(e,t,r,n){let a=this.resultBuffer,o=this.sampleValues,s=this.valueSize,l=e*s,u=l-s,c=this._offsetPrev,p=this._offsetNext,d=this._weightPrev,m=this._weightNext,g=(r-t)/(n-t),b=g*g,x=b*g,v=-d*x+2*d*b-d*g,w=(1+d)*x+(-1.5-2*d)*b+(-.5+d)*g+1,_=(-1-m)*x+(1.5+m)*b+.5*g,C=m*x-m*b;for(let E=0;E!==s;++E)a[E]=v*o[c+E]+w*o[u+E]+_*o[l+E]+C*o[p+E];return a}};h(UZ,"CubicInterpolant");var Iye=UZ,VZ=class extends Wx{constructor(e,t,r,n){super(e,t,r,n)}interpolate_(e,t,r,n){let a=this.resultBuffer,o=this.sampleValues,s=this.valueSize,l=e*s,u=l-s,c=(r-t)/(n-t),p=1-c;for(let d=0;d!==s;++d)a[d]=o[u+d]*p+o[l+d]*c;return a}};h(VZ,"LinearInterpolant");var Lye=VZ,jZ=class extends Wx{constructor(e,t,r,n){super(e,t,r,n)}interpolate_(e){return this.copySampleValue_(e-1)}};h(jZ,"DiscreteInterpolant");var Dye=jZ,HZ=class{constructor(e,t,r,n){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=cf(t,this.TimeBufferType),this.values=cf(r,this.ValueBufferType),this.setInterpolation(n||this.DefaultInterpolation)}static toJSON(e){let t=e.constructor,r;if(t.toJSON!==this.toJSON)r=t.toJSON(e);else{r={name:e.name,times:cf(e.times,Array),values:cf(e.values,Array)};let n=e.getInterpolation();n!==e.DefaultInterpolation&&(r.interpolation=n)}return r.type=e.ValueTypeName,r}InterpolantFactoryMethodDiscrete(e){return new Dye(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new Lye(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new Iye(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case gv:t=this.InterpolantFactoryMethodDiscrete;break;case yv:t=this.InterpolantFactoryMethodLinear;break;case a2:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){let r="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(r);return console.warn("THREE.KeyframeTrack:",r),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return gv;case this.InterpolantFactoryMethodLinear:return yv;case this.InterpolantFactoryMethodSmooth:return a2}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){let t=this.times;for(let r=0,n=t.length;r!==n;++r)t[r]+=e}return this}scale(e){if(e!==1){let t=this.times;for(let r=0,n=t.length;r!==n;++r)t[r]*=e}return this}trim(e,t){let r=this.times,n=r.length,a=0,o=n-1;for(;a!==n&&r[a]<e;)++a;for(;o!==-1&&r[o]>t;)--o;if(++o,a!==0||o!==n){a>=o&&(o=Math.max(o,1),a=o-1);let s=this.getValueSize();this.times=r.slice(a,o),this.values=this.values.slice(a*s,o*s)}return this}validate(){let e=!0,t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);let r=this.times,n=this.values,a=r.length;a===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let s=0;s!==a;s++){let l=r[s];if(typeof l=="number"&&isNaN(l)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,s,l),e=!1;break}if(o!==null&&o>l){console.error("THREE.KeyframeTrack: Out of order keys.",this,s,l,o),e=!1;break}o=l}if(n!==void 0&&OZ(n))for(let s=0,l=n.length;s!==l;++s){let u=n[s];if(isNaN(u)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,s,u),e=!1;break}}return e}optimize(){let e=this.times.slice(),t=this.values.slice(),r=this.getValueSize(),n=this.getInterpolation()===a2,a=e.length-1,o=1;for(let s=1;s<a;++s){let l=!1,u=e[s],c=e[s+1];if(u!==c&&(s!==1||u!==e[0]))if(n)l=!0;else{let p=s*r,d=p-r,m=p+r;for(let g=0;g!==r;++g){let b=t[p+g];if(b!==t[d+g]||b!==t[m+g]){l=!0;break}}}if(l){if(s!==o){e[o]=e[s];let p=s*r,d=o*r;for(let m=0;m!==r;++m)t[d+m]=t[p+m]}++o}}if(a>0){e[o]=e[a];for(let s=a*r,l=o*r,u=0;u!==r;++u)t[l+u]=t[s+u];++o}return o!==e.length?(this.times=e.slice(0,o),this.values=t.slice(0,o*r)):(this.times=e,this.values=t),this}clone(){let e=this.times.slice(),t=this.values.slice(),r=this.constructor,n=new r(this.name,e,t);return n.createInterpolant=this.createInterpolant,n}};h(HZ,"KeyframeTrack");var Yo=HZ;Yo.prototype.TimeBufferType=Float32Array;Yo.prototype.ValueBufferType=Float32Array;Yo.prototype.DefaultInterpolation=yv;var GZ=class extends Yo{};h(GZ,"BooleanKeyframeTrack");var ad=GZ;ad.prototype.ValueTypeName="bool";ad.prototype.ValueBufferType=Array;ad.prototype.DefaultInterpolation=gv;ad.prototype.InterpolantFactoryMethodLinear=void 0;ad.prototype.InterpolantFactoryMethodSmooth=void 0;var WZ=class extends Yo{};h(WZ,"ColorKeyframeTrack");var XZ=WZ;XZ.prototype.ValueTypeName="color";var qZ=class extends Yo{};h(qZ,"NumberKeyframeTrack");var Pv=qZ;Pv.prototype.ValueTypeName="number";var ZZ=class extends Wx{constructor(e,t,r,n){super(e,t,r,n)}interpolate_(e,t,r,n){let a=this.resultBuffer,o=this.sampleValues,s=this.valueSize,l=(r-t)/(n-t),u=e*s;for(let c=u+s;u!==c;u+=4)dh.slerpFlat(a,0,o,u-s,o,u,l);return a}};h(ZZ,"QuaternionLinearInterpolant");var kye=ZZ,YZ=class extends Yo{InterpolantFactoryMethodLinear(e){return new kye(this.times,this.values,this.getValueSize(),e)}};h(YZ,"QuaternionKeyframeTrack");var sg=YZ;sg.prototype.ValueTypeName="quaternion";sg.prototype.DefaultInterpolation=yv;sg.prototype.InterpolantFactoryMethodSmooth=void 0;var JZ=class extends Yo{};h(JZ,"StringKeyframeTrack");var od=JZ;od.prototype.ValueTypeName="string";od.prototype.ValueBufferType=Array;od.prototype.DefaultInterpolation=gv;od.prototype.InterpolantFactoryMethodLinear=void 0;od.prototype.InterpolantFactoryMethodSmooth=void 0;var KZ=class extends Yo{};h(KZ,"VectorKeyframeTrack");var Av=KZ;Av.prototype.ValueTypeName="vector";var QZ=class{constructor(e,t=-1,r,n=Ife){this.name=e,this.tracks=r,this.duration=t,this.blendMode=n,this.uuid=ha(),this.duration<0&&this.resetDuration()}static parse(e){let t=[],r=e.tracks,n=1/(e.fps||1);for(let o=0,s=r.length;o!==s;++o)t.push(tY(r[o]).scale(n));let a=new this(e.name,e.duration,t,e.blendMode);return a.uuid=e.uuid,a}static toJSON(e){let t=[],r=e.tracks,n={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let a=0,o=r.length;a!==o;++a)t.push(Yo.toJSON(r[a]));return n}static CreateFromMorphTargetSequence(e,t,r,n){let a=t.length,o=[];for(let s=0;s<a;s++){let l=[],u=[];l.push((s+a-1)%a,s,(s+1)%a),u.push(0,1,0);let c=NZ(l);l=N3(l,1,c),u=N3(u,1,c),!n&&l[0]===0&&(l.push(a),u.push(u[0])),o.push(new Pv(".morphTargetInfluences["+t[s].name+"]",l,u).scale(1/r))}return new this(e,-1,o)}static findByName(e,t){let r=e;if(!Array.isArray(e)){let n=e;r=n.geometry&&n.geometry.animations||n.animations}for(let n=0;n<r.length;n++)if(r[n].name===t)return r[n];return null}static CreateClipsFromMorphTargetSequences(e,t,r){let n={},a=/^([\w-]*?)([\d]+)$/;for(let s=0,l=e.length;s<l;s++){let u=e[s],c=u.name.match(a);if(c&&c.length>1){let p=c[1],d=n[p];d||(n[p]=d=[]),d.push(u)}}let o=[];for(let s in n)o.push(this.CreateFromMorphTargetSequence(s,n[s],t,r));return o}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;let r=h(function(c,p,d,m,g){if(d.length!==0){let b=[],x=[];LE(d,b,x,m),b.length!==0&&g.push(new c(p,b,x))}},"addNonemptyTrack"),n=[],a=e.name||"default",o=e.fps||30,s=e.blendMode,l=e.length||-1,u=e.hierarchy||[];for(let c=0;c<u.length;c++){let p=u[c].keys;if(!(!p||p.length===0))if(p[0].morphTargets){let d={},m;for(m=0;m<p.length;m++)if(p[m].morphTargets)for(let g=0;g<p[m].morphTargets.length;g++)d[p[m].morphTargets[g]]=-1;for(let g in d){let b=[],x=[];for(let v=0;v!==p[m].morphTargets.length;++v){let w=p[m];b.push(w.time),x.push(w.morphTarget===g?1:0)}n.push(new Pv(".morphTargetInfluence["+g+"]",b,x))}l=d.length*o}else{let d=".bones["+t[c].name+"]";r(Av,d+".position",p,"pos",n),r(sg,d+".quaternion",p,"rot",n),r(Av,d+".scale",p,"scl",n)}}return n.length===0?null:new this(a,l,n,s)}resetDuration(){let e=this.tracks,t=0;for(let r=0,n=e.length;r!==n;++r){let a=this.tracks[r];t=Math.max(t,a.times[a.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){let e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}};h(QZ,"AnimationClip");var H4e=QZ;function eY(i){switch(i.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Pv;case"vector":case"vector2":case"vector3":case"vector4":return Av;case"color":return XZ;case"quaternion":return sg;case"bool":case"boolean":return ad;case"string":return od}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+i)}h(eY,"getTrackTypeForValueTypeName");function tY(i){if(i.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");let e=eY(i.type);if(i.times===void 0){let t=[],r=[];LE(i.keys,t,r,"value"),i.times=t,i.values=r}return e.parse!==void 0?e.parse(i):new e(i.name,i.times,i.values,i.interpolation)}h(tY,"parseKeyframeTrack");var vl={enabled:!1,files:{},add:function(i,e){this.enabled!==!1&&(this.files[i]=e)},get:function(i){if(this.enabled!==!1)return this.files[i]},remove:function(i){delete this.files[i]},clear:function(){this.files={}}},iY=class{constructor(e,t,r){let n=this,a=!1,o=0,s=0,l,u=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=r,this.itemStart=function(c){s++,a===!1&&n.onStart!==void 0&&n.onStart(c,o,s),a=!0},this.itemEnd=function(c){o++,n.onProgress!==void 0&&n.onProgress(c,o,s),o===s&&(a=!1,n.onLoad!==void 0&&n.onLoad())},this.itemError=function(c){n.onError!==void 0&&n.onError(c)},this.resolveURL=function(c){return l?l(c):c},this.setURLModifier=function(c){return l=c,this},this.addHandler=function(c,p){return u.push(c,p),this},this.removeHandler=function(c){let p=u.indexOf(c);return p!==-1&&u.splice(p,2),this},this.getHandler=function(c){for(let p=0,d=u.length;p<d;p+=2){let m=u[p],g=u[p+1];if(m.global&&(m.lastIndex=0),m.test(c))return g}return null}}};h(iY,"LoadingManager");var Rye=iY,Fye=new Rye,rY=class{constructor(e){this.manager=e!==void 0?e:Fye,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){let r=this;return new Promise(function(n,a){r.load(e,n,t,a)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}};h(rY,"Loader");var lg=rY;lg.DEFAULT_MATERIAL_NAME="__DEFAULT";var as={},nY=class extends Error{constructor(e,t){super(e),this.response=t}};h(nY,"HttpError");var zye=nY,aY=class extends lg{constructor(e){super(e)}load(e,t,r,n){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);let a=vl.get(e);if(a!==void 0)return this.manager.itemStart(e),setTimeout(()=>{t&&t(a),this.manager.itemEnd(e)},0),a;if(as[e]!==void 0){as[e].push({onLoad:t,onProgress:r,onError:n});return}as[e]=[],as[e].push({onLoad:t,onProgress:r,onError:n});let o=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),s=this.mimeType,l=this.responseType;fetch(o).then(u=>{if(u.status===200||u.status===0){if(u.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||u.body===void 0||u.body.getReader===void 0)return u;let c=as[e],p=u.body.getReader(),d=u.headers.get("Content-Length")||u.headers.get("X-File-Size"),m=d?parseInt(d):0,g=m!==0,b=0,x=new ReadableStream({start(v){w();function w(){p.read().then(({done:_,value:C})=>{if(_)v.close();else{b+=C.byteLength;let E=new ProgressEvent("progress",{lengthComputable:g,loaded:b,total:m});for(let T=0,L=c.length;T<L;T++){let D=c[T];D.onProgress&&D.onProgress(E)}v.enqueue(C),w()}})}h(w,"readData")}});return new Response(x)}else throw new zye(`fetch for "${u.url}" responded with ${u.status}: ${u.statusText}`,u)}).then(u=>{switch(l){case"arraybuffer":return u.arrayBuffer();case"blob":return u.blob();case"document":return u.text().then(c=>new DOMParser().parseFromString(c,s));case"json":return u.json();default:if(s===void 0)return u.text();{let c=/charset="?([^;"\s]*)"?/i.exec(s),p=c&&c[1]?c[1].toLowerCase():void 0,d=new TextDecoder(p);return u.arrayBuffer().then(m=>d.decode(m))}}}).then(u=>{vl.add(e,u);let c=as[e];delete as[e];for(let p=0,d=c.length;p<d;p++){let m=c[p];m.onLoad&&m.onLoad(u)}}).catch(u=>{let c=as[e];if(c===void 0)throw this.manager.itemError(e),u;delete as[e];for(let p=0,d=c.length;p<d;p++){let m=c[p];m.onError&&m.onError(u)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}};h(aY,"FileLoader");var Z4e=aY,oY=class extends lg{constructor(e){super(e)}load(e,t,r,n){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);let a=this,o=vl.get(e);if(o!==void 0)return a.manager.itemStart(e),setTimeout(function(){t&&t(o),a.manager.itemEnd(e)},0),o;let s=Vp("img");function l(){c(),vl.add(e,this),t&&t(this),a.manager.itemEnd(e)}h(l,"onImageLoad");function u(p){c(),n&&n(p),a.manager.itemError(e),a.manager.itemEnd(e)}h(u,"onImageError");function c(){s.removeEventListener("load",l,!1),s.removeEventListener("error",u,!1)}return h(c,"removeEventListeners"),s.addEventListener("load",l,!1),s.addEventListener("error",u,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(s.crossOrigin=this.crossOrigin),a.manager.itemStart(e),s.src=e,s}};h(oY,"ImageLoader");var Bye=oY,sY=class extends lg{constructor(e){super(e)}load(e,t,r,n){let a=new En,o=new Bye(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(s){a.image=s,a.needsUpdate=!0,t!==void 0&&t(a)},r,n),a}};h(sY,"TextureLoader");var DE=sY,lY=class extends rr{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new Lt(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){let t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),t}};h(lY,"Light");var Xx=lY,B2=new jt,H6=new le,G6=new le,uY=class{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Oe(512,512),this.map=null,this.mapPass=null,this.matrix=new jt,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new ig,this._frameExtents=new Oe(1,1),this._viewportCount=1,this._viewports=[new Ei(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){let t=this.camera,r=this.matrix;H6.setFromMatrixPosition(e.matrixWorld),t.position.copy(H6),G6.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(G6),t.updateMatrixWorld(),B2.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(B2),r.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),r.multiply(B2)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){let e={};return this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}};h(uY,"LightShadow");var kE=uY,hY=class extends kE{constructor(){super(new On(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){let t=this.camera,r=Up*2*e.angle*this.focus,n=this.mapSize.width/this.mapSize.height,a=e.distance||t.far;(r!==t.fov||n!==t.aspect||a!==t.far)&&(t.fov=r,t.aspect=n,t.far=a,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}};h(hY,"SpotLightShadow");var Oye=hY,cY=class extends Xx{constructor(e,t,r=0,n=Math.PI/3,a=0,o=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(rr.DEFAULT_UP),this.updateMatrix(),this.target=new rr,this.distance=r,this.angle=n,this.penumbra=a,this.decay=o,this.map=null,this.shadow=new Oye}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}};h(cY,"SpotLight");var i5e=cY,W6=new jt,Rd=new le,O2=new le,pY=class extends kE{constructor(){super(new On(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Oe(4,2),this._viewportCount=6,this._viewports=[new Ei(2,1,1,1),new Ei(0,1,1,1),new Ei(3,1,1,1),new Ei(1,1,1,1),new Ei(3,0,1,1),new Ei(1,0,1,1)],this._cubeDirections=[new le(1,0,0),new le(-1,0,0),new le(0,0,1),new le(0,0,-1),new le(0,1,0),new le(0,-1,0)],this._cubeUps=[new le(0,1,0),new le(0,1,0),new le(0,1,0),new le(0,1,0),new le(0,0,1),new le(0,0,-1)]}updateMatrices(e,t=0){let r=this.camera,n=this.matrix,a=e.distance||r.far;a!==r.far&&(r.far=a,r.updateProjectionMatrix()),Rd.setFromMatrixPosition(e.matrixWorld),r.position.copy(Rd),O2.copy(r.position),O2.add(this._cubeDirections[t]),r.up.copy(this._cubeUps[t]),r.lookAt(O2),r.updateMatrixWorld(),n.makeTranslation(-Rd.x,-Rd.y,-Rd.z),W6.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),this._frustum.setFromProjectionMatrix(W6)}};h(pY,"PointLightShadow");var Nye=pY,dY=class extends Xx{constructor(e,t,r=0,n=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=r,this.decay=n,this.shadow=new Nye}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}};h(dY,"PointLight");var a5e=dY,fY=class extends kE{constructor(){super(new oW(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}};h(fY,"DirectionalLightShadow");var $ye=fY,mY=class extends Xx{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(rr.DEFAULT_UP),this.updateMatrix(),this.target=new rr,this.shadow=new $ye}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}};h(mY,"DirectionalLight");var gY=mY,yY=class extends Xx{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}};h(yY,"AmbientLight");var Uye=yY,vY=class{static decodeText(e){if(typeof TextDecoder<"u")return new TextDecoder().decode(e);let t="";for(let r=0,n=e.length;r<n;r++)t+=String.fromCharCode(e[r]);try{return decodeURIComponent(escape(t))}catch{return t}}static extractUrlBase(e){let t=e.lastIndexOf("/");return t===-1?"./":e.slice(0,t+1)}static resolveURL(e,t){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}};h(vY,"LoaderUtils");var h5e=vY,xY=class extends lg{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,r,n){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);let a=this,o=vl.get(e);if(o!==void 0){if(a.manager.itemStart(e),o.then){o.then(u=>{t&&t(u),a.manager.itemEnd(e)}).catch(u=>{n&&n(u)});return}return setTimeout(function(){t&&t(o),a.manager.itemEnd(e)},0),o}let s={};s.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",s.headers=this.requestHeader;let l=fetch(e,s).then(function(u){return u.blob()}).then(function(u){return createImageBitmap(u,Object.assign(a.options,{colorSpaceConversion:"none"}))}).then(function(u){return vl.add(e,u),t&&t(u),a.manager.itemEnd(e),u}).catch(function(u){n&&n(u),vl.remove(e),a.manager.itemError(e),a.manager.itemEnd(e)});vl.add(e,l),a.manager.itemStart(e)}};h(xY,"ImageBitmapLoader");var p5e=xY,_Y=class{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=$3(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){let t=$3();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}};h(_Y,"Clock");var Vye=_Y;function $3(){return(typeof performance>"u"?Date:performance).now()}h($3,"now");var RE="\\[\\]\\.:\\/",jye=new RegExp("["+RE+"]","g"),FE="[^"+RE+"]",Hye="[^"+RE.replace("\\.","")+"]",Gye=/((?:WC+[\/:])*)/.source.replace("WC",FE),Wye=/(WCOD+)?/.source.replace("WCOD",Hye),Xye=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",FE),qye=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",FE),Zye=new RegExp("^"+Gye+Wye+Xye+qye+"$"),Yye=["material","materials","bones","map"],bY=class{constructor(e,t,r){let n=r||lr.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,n)}getValue(e,t){this.bind();let r=this._targetGroup.nCachedObjects_,n=this._bindings[r];n!==void 0&&n.getValue(e,t)}setValue(e,t){let r=this._bindings;for(let n=this._targetGroup.nCachedObjects_,a=r.length;n!==a;++n)r[n].setValue(e,t)}bind(){let e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].bind()}unbind(){let e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].unbind()}};h(bY,"Composite");var Jye=bY,wY=class ec{constructor(e,t,r){this.path=t,this.parsedPath=r||ec.parseTrackName(t),this.node=ec.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,r){return e&&e.isAnimationObjectGroup?new ec.Composite(e,t,r):new ec(e,t,r)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(jye,"")}static parseTrackName(e){let t=Zye.exec(e);if(t===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);let r={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},n=r.nodeName&&r.nodeName.lastIndexOf(".");if(n!==void 0&&n!==-1){let a=r.nodeName.substring(n+1);Yye.indexOf(a)!==-1&&(r.nodeName=r.nodeName.substring(0,n),r.objectName=a)}if(r.propertyName===null||r.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return r}static findNode(e,t){if(t===void 0||t===""||t==="."||t===-1||t===e.name||t===e.uuid)return e;if(e.skeleton){let r=e.skeleton.getBoneByName(t);if(r!==void 0)return r}if(e.children){let r=h(function(a){for(let o=0;o<a.length;o++){let s=a[o];if(s.name===t||s.uuid===t)return s;let l=r(s.children);if(l)return l}return null},"searchNodeSubtree"),n=r(e.children);if(n)return n}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){let r=this.resolvedProperty;for(let n=0,a=r.length;n!==a;++n)e[t++]=r[n]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){let r=this.resolvedProperty;for(let n=0,a=r.length;n!==a;++n)r[n]=e[t++]}_setValue_array_setNeedsUpdate(e,t){let r=this.resolvedProperty;for(let n=0,a=r.length;n!==a;++n)r[n]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){let r=this.resolvedProperty;for(let n=0,a=r.length;n!==a;++n)r[n]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node,t=this.parsedPath,r=t.objectName,n=t.propertyName,a=t.propertyIndex;if(e||(e=ec.findNode(this.rootNode,t.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(r){let u=t.objectIndex;switch(r){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let c=0;c<e.length;c++)if(e[c].name===u){u=c;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[r]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[r]}if(u!==void 0){if(e[u]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[u]}}let o=e[n];if(o===void 0){let u=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+u+"."+n+" but it wasn't found.",e);return}let s=this.Versioning.None;this.targetObject=e,e.needsUpdate!==void 0?s=this.Versioning.NeedsUpdate:e.matrixWorldNeedsUpdate!==void 0&&(s=this.Versioning.MatrixWorldNeedsUpdate);let l=this.BindingType.Direct;if(a!==void 0){if(n==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[a]!==void 0&&(a=e.morphTargetDictionary[a])}l=this.BindingType.ArrayElement,this.resolvedProperty=o,this.propertyIndex=a}else o.fromArray!==void 0&&o.toArray!==void 0?(l=this.BindingType.HasFromToArray,this.resolvedProperty=o):Array.isArray(o)?(l=this.BindingType.EntireArray,this.resolvedProperty=o):this.propertyName=n;this.getValue=this.GetterByBindingType[l],this.setValue=this.SetterByBindingTypeAndVersioning[l][s]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}};h(wY,"PropertyBinding");var lr=wY;lr.Composite=Jye;lr.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};lr.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};lr.prototype.GetterByBindingType=[lr.prototype._getValue_direct,lr.prototype._getValue_array,lr.prototype._getValue_arrayElement,lr.prototype._getValue_toArray];lr.prototype.SetterByBindingTypeAndVersioning=[[lr.prototype._setValue_direct,lr.prototype._setValue_direct_setNeedsUpdate,lr.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[lr.prototype._setValue_array,lr.prototype._setValue_array_setNeedsUpdate,lr.prototype._setValue_array_setMatrixWorldNeedsUpdate],[lr.prototype._setValue_arrayElement,lr.prototype._setValue_arrayElement_setNeedsUpdate,lr.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[lr.prototype._setValue_fromArray,lr.prototype._setValue_fromArray_setNeedsUpdate,lr.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];var SY=class MY{constructor(e){this.value=e}clone(){return new MY(this.value.clone===void 0?this.value:this.value.clone())}};h(SY,"Uniform");var m5e=SY,X6=new jt,CY=class{constructor(e,t,r=0,n=1/0){this.ray=new tg(e,t),this.near=r,this.far=n,this.camera=null,this.layers=new wE,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}setFromXRController(e){return X6.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(X6),this}intersectObject(e,t=!0,r=[]){return Iv(e,this,r,t),r.sort(U3),r}intersectObjects(e,t=!0,r=[]){for(let n=0,a=e.length;n<a;n++)Iv(e[n],this,r,t);return r.sort(U3),r}};h(CY,"Raycaster");var ug=CY;function U3(i,e){return i.distance-e.distance}h(U3,"ascSort");function Iv(i,e,t,r){if(i.layers.test(e.layers)&&i.raycast(e,t),r===!0){let n=i.children;for(let a=0,o=n.length;a<o;a++)Iv(n[a],e,t,!0)}}h(Iv,"intersect");var q6=new Oe,EY=class{constructor(e=new Oe(1/0,1/0),t=new Oe(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){let r=q6.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,q6).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}};h(EY,"Box2");var Kye=EY;typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:mE}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=mE);R();function sd(i,e=!1){let t=i[0].index!==null,r=new Set(Object.keys(i[0].attributes)),n=new Set(Object.keys(i[0].morphAttributes)),a={},o={},s=i[0].morphTargetsRelative,l=new ma,u=0;for(let c=0;c<i.length;++c){let p=i[c],d=0;if(t!==(p.index!==null))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+c+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(let m in p.attributes){if(!r.has(m))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+c+'. All geometries must have compatible attributes; make sure "'+m+'" attribute exists among all geometries, or in none of them.'),null;a[m]===void 0&&(a[m]=[]),a[m].push(p.attributes[m]),d++}if(d!==r.size)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+c+". Make sure all geometries have the same number of attributes."),null;if(s!==p.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+c+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(let m in p.morphAttributes){if(!n.has(m))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+c+".  .morphAttributes must be consistent throughout all geometries."),null;o[m]===void 0&&(o[m]=[]),o[m].push(p.morphAttributes[m])}if(e){let m;if(t)m=p.index.count;else if(p.attributes.position!==void 0)m=p.attributes.position.count;else return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+c+". The geometry must have either an index or a position attribute"),null;l.addGroup(u,m,c),u+=m}}if(t){let c=0,p=[];for(let d=0;d<i.length;++d){let m=i[d].index;for(let g=0;g<m.count;++g)p.push(m.getX(g)+c);c+=i[d].attributes.position.count}l.setIndex(p)}for(let c in a){let p=V3(a[c]);if(!p)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the "+c+" attribute."),null;l.setAttribute(c,p)}for(let c in o){let p=o[c][0].length;if(p===0)break;l.morphAttributes=l.morphAttributes||{},l.morphAttributes[c]=[];for(let d=0;d<p;++d){let m=[];for(let b=0;b<o[c].length;++b)m.push(o[c][b][d]);let g=V3(m);if(!g)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the "+c+" morphAttribute."),null;l.morphAttributes[c].push(g)}}return l}h(sd,"mergeGeometries");function V3(i){let e,t,r,n=-1,a=0;for(let u=0;u<i.length;++u){let c=i[u];if(e===void 0&&(e=c.array.constructor),e!==c.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(t===void 0&&(t=c.itemSize),t!==c.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(r===void 0&&(r=c.normalized),r!==c.normalized)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;if(n===-1&&(n=c.gpuType),n!==c.gpuType)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.gpuType must be consistent across matching attributes."),null;a+=c.count*t}let o=new e(a),s=new Br(o,t,r),l=0;for(let u=0;u<i.length;++u){let c=i[u];if(c.isInterleavedBufferAttribute){let p=l/t;for(let d=0,m=c.count;d<m;d++)for(let g=0;g<t;g++){let b=c.getComponent(d,g);s.setComponent(d+p,g,b)}}else o.set(c.array,l);l+=c.count*t}return n!==void 0&&(s.gpuType=n),s}h(V3,"mergeAttributes");function Qye(i,e){if(e===Lfe)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),i;if(e===ZA||e===Dfe){let t=i.getIndex();if(t===null){let o=[],s=i.getAttribute("position");if(s!==void 0){for(let l=0;l<s.count;l++)o.push(l);i.setIndex(o),t=i.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),i}let r=t.count-2,n=[];if(e===ZA)for(let o=1;o<=r;o++)n.push(t.getX(0)),n.push(t.getX(o)),n.push(t.getX(o+1));else for(let o=0;o<r;o++)o%2===0?(n.push(t.getX(o)),n.push(t.getX(o+1)),n.push(t.getX(o+2))):(n.push(t.getX(o+2)),n.push(t.getX(o+1)),n.push(t.getX(o)));n.length/3!==r&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");let a=i.clone();return a.setIndex(n),a.clearGroups(),a}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),i}h(Qye,"toTrianglesDrawMode");var e0e=Qe((i,e)=>{R(),function(t,r){typeof i=="object"&&typeof e<"u"?e.exports=r():typeof define=="function"&&define.amd?define(r):(t=t||self).RBush=r()}(i,function(){function t(w,_,C,E,T){h(function L(D,B,A,k,$){for(;k>A;){if(k-A>600){var O=k-A+1,P=B-A+1,U=Math.log(O),G=.5*Math.exp(2*U/3),K=.5*Math.sqrt(U*G*(O-G)/O)*(P-O/2<0?-1:1),z=Math.max(A,Math.floor(B-P*G/O+K)),V=Math.min(k,Math.floor(B+(O-P)*G/O+K));L(D,B,z,V,$)}var j=D[B],q=A,ee=k;for(r(D,A,B),$(D[k],j)>0&&r(D,A,k);q<ee;){for(r(D,q,ee),q++,ee--;$(D[q],j)<0;)q++;for(;$(D[ee],j)>0;)ee--}$(D[A],j)===0?r(D,A,ee):r(D,++ee,k),ee<=B&&(A=ee+1),B<=ee&&(k=ee-1)}},"t")(w,_,C||0,E||w.length-1,T||n)}h(t,"t");function r(w,_,C){var E=w[_];w[_]=w[C],w[C]=E}h(r,"i");function n(w,_){return w<_?-1:w>_?1:0}h(n,"n");var a=h(function(w){w===void 0&&(w=9),this._maxEntries=Math.max(4,w),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()},"r");function o(w,_,C){if(!C)return _.indexOf(w);for(var E=0;E<_.length;E++)if(C(w,_[E]))return E;return-1}h(o,"e");function s(w,_){l(w,0,w.children.length,_,w)}h(s,"a");function l(w,_,C,E,T){T||(T=x(null)),T.minX=1/0,T.minY=1/0,T.maxX=-1/0,T.maxY=-1/0;for(var L=_;L<C;L++){var D=w.children[L];u(T,w.leaf?E(D):D)}return T}h(l,"h");function u(w,_){return w.minX=Math.min(w.minX,_.minX),w.minY=Math.min(w.minY,_.minY),w.maxX=Math.max(w.maxX,_.maxX),w.maxY=Math.max(w.maxY,_.maxY),w}h(u,"o");function c(w,_){return w.minX-_.minX}h(c,"s");function p(w,_){return w.minY-_.minY}h(p,"l");function d(w){return(w.maxX-w.minX)*(w.maxY-w.minY)}h(d,"f");function m(w){return w.maxX-w.minX+(w.maxY-w.minY)}h(m,"u");function g(w,_){return w.minX<=_.minX&&w.minY<=_.minY&&_.maxX<=w.maxX&&_.maxY<=w.maxY}h(g,"m");function b(w,_){return _.minX<=w.maxX&&_.minY<=w.maxY&&_.maxX>=w.minX&&_.maxY>=w.minY}h(b,"c");function x(w){return{children:w,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}h(x,"p");function v(w,_,C,E,T){for(var L=[_,C];L.length;)if(!((C=L.pop())-(_=L.pop())<=E)){var D=_+Math.ceil((C-_)/E/2)*E;t(w,D,_,C,T),L.push(_,D,D,C)}}return h(v,"d"),a.prototype.all=function(){return this._all(this.data,[])},a.prototype.search=function(w){var _=this.data,C=[];if(!b(w,_))return C;for(var E=this.toBBox,T=[];_;){for(var L=0;L<_.children.length;L++){var D=_.children[L],B=_.leaf?E(D):D;b(w,B)&&(_.leaf?C.push(D):g(w,B)?this._all(D,C):T.push(D))}_=T.pop()}return C},a.prototype.collides=function(w){var _=this.data;if(!b(w,_))return!1;for(var C=[];_;){for(var E=0;E<_.children.length;E++){var T=_.children[E],L=_.leaf?this.toBBox(T):T;if(b(w,L)){if(_.leaf||g(w,L))return!0;C.push(T)}}_=C.pop()}return!1},a.prototype.load=function(w){if(!w||!w.length)return this;if(w.length<this._minEntries){for(var _=0;_<w.length;_++)this.insert(w[_]);return this}var C=this._build(w.slice(),0,w.length-1,0);if(this.data.children.length)if(this.data.height===C.height)this._splitRoot(this.data,C);else{if(this.data.height<C.height){var E=this.data;this.data=C,C=E}this._insert(C,this.data.height-C.height-1,!0)}else this.data=C;return this},a.prototype.insert=function(w){return w&&this._insert(w,this.data.height-1),this},a.prototype.clear=function(){return this.data=x([]),this},a.prototype.remove=function(w,_){if(!w)return this;for(var C,E,T,L=this.data,D=this.toBBox(w),B=[],A=[];L||B.length;){if(L||(L=B.pop(),E=B[B.length-1],C=A.pop(),T=!0),L.leaf){var k=o(w,L.children,_);if(k!==-1)return L.children.splice(k,1),B.push(L),this._condense(B),this}T||L.leaf||!g(L,D)?E?(C++,L=E.children[C],T=!1):L=null:(B.push(L),A.push(C),C=0,E=L,L=L.children[0])}return this},a.prototype.toBBox=function(w){return w},a.prototype.compareMinX=function(w,_){return w.minX-_.minX},a.prototype.compareMinY=function(w,_){return w.minY-_.minY},a.prototype.toJSON=function(){return this.data},a.prototype.fromJSON=function(w){return this.data=w,this},a.prototype._all=function(w,_){for(var C=[];w;)w.leaf?_.push.apply(_,w.children):C.push.apply(C,w.children),w=C.pop();return _},a.prototype._build=function(w,_,C,E){var T,L=C-_+1,D=this._maxEntries;if(L<=D)return s(T=x(w.slice(_,C+1)),this.toBBox),T;E||(E=Math.ceil(Math.log(L)/Math.log(D)),D=Math.ceil(L/Math.pow(D,E-1))),(T=x([])).leaf=!1,T.height=E;var B=Math.ceil(L/D),A=B*Math.ceil(Math.sqrt(D));v(w,_,C,A,this.compareMinX);for(var k=_;k<=C;k+=A){var $=Math.min(k+A-1,C);v(w,k,$,B,this.compareMinY);for(var O=k;O<=$;O+=B){var P=Math.min(O+B-1,$);T.children.push(this._build(w,O,P,E-1))}}return s(T,this.toBBox),T},a.prototype._chooseSubtree=function(w,_,C,E){for(;E.push(_),!_.leaf&&E.length-1!==C;){for(var T=1/0,L=1/0,D=void 0,B=0;B<_.children.length;B++){var A=_.children[B],k=d(A),$=(O=w,P=A,(Math.max(P.maxX,O.maxX)-Math.min(P.minX,O.minX))*(Math.max(P.maxY,O.maxY)-Math.min(P.minY,O.minY))-k);$<L?(L=$,T=k<T?k:T,D=A):$===L&&k<T&&(T=k,D=A)}_=D||_.children[0]}var O,P;return _},a.prototype._insert=function(w,_,C){var E=C?w:this.toBBox(w),T=[],L=this._chooseSubtree(E,this.data,_,T);for(L.children.push(w),u(L,E);_>=0&&T[_].children.length>this._maxEntries;)this._split(T,_),_--;this._adjustParentBBoxes(E,T,_)},a.prototype._split=function(w,_){var C=w[_],E=C.children.length,T=this._minEntries;this._chooseSplitAxis(C,T,E);var L=this._chooseSplitIndex(C,T,E),D=x(C.children.splice(L,C.children.length-L));D.height=C.height,D.leaf=C.leaf,s(C,this.toBBox),s(D,this.toBBox),_?w[_-1].children.push(D):this._splitRoot(C,D)},a.prototype._splitRoot=function(w,_){this.data=x([w,_]),this.data.height=w.height+1,this.data.leaf=!1,s(this.data,this.toBBox)},a.prototype._chooseSplitIndex=function(w,_,C){for(var E,T,L,D,B,A,k,$=1/0,O=1/0,P=_;P<=C-_;P++){var U=l(w,0,P,this.toBBox),G=l(w,P,C,this.toBBox),K=(T=U,L=G,D=void 0,B=void 0,A=void 0,k=void 0,D=Math.max(T.minX,L.minX),B=Math.max(T.minY,L.minY),A=Math.min(T.maxX,L.maxX),k=Math.min(T.maxY,L.maxY),Math.max(0,A-D)*Math.max(0,k-B)),z=d(U)+d(G);K<$?($=K,E=P,O=z<O?z:O):K===$&&z<O&&(O=z,E=P)}return E||C-_},a.prototype._chooseSplitAxis=function(w,_,C){var E=w.leaf?this.compareMinX:c,T=w.leaf?this.compareMinY:p;this._allDistMargin(w,_,C,E)<this._allDistMargin(w,_,C,T)&&w.children.sort(E)},a.prototype._allDistMargin=function(w,_,C,E){w.children.sort(E);for(var T=this.toBBox,L=l(w,0,_,T),D=l(w,C-_,C,T),B=m(L)+m(D),A=_;A<C-_;A++){var k=w.children[A];u(L,w.leaf?T(k):k),B+=m(L)}for(var $=C-_-1;$>=_;$--){var O=w.children[$];u(D,w.leaf?T(O):O),B+=m(D)}return B},a.prototype._adjustParentBBoxes=function(w,_,C){for(var E=C;E>=0;E--)u(_[E],w)},a.prototype._condense=function(w){for(var _=w.length-1,C=void 0;_>=0;_--)w[_].children.length===0?_>0?(C=w[_-1].children).splice(C.indexOf(w[_]),1):this.clear():s(w[_],this.toBBox)},a})}),TY=Qe(i=>{R(),Object.defineProperty(i,"__esModule",{value:!0}),i.earthRadius=63710088e-1,i.factors={centimeters:i.earthRadius*100,centimetres:i.earthRadius*100,degrees:i.earthRadius/111325,feet:i.earthRadius*3.28084,inches:i.earthRadius*39.37,kilometers:i.earthRadius/1e3,kilometres:i.earthRadius/1e3,meters:i.earthRadius,metres:i.earthRadius,miles:i.earthRadius/1609.344,millimeters:i.earthRadius*1e3,millimetres:i.earthRadius*1e3,nauticalmiles:i.earthRadius/1852,radians:1,yards:i.earthRadius*1.0936},i.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:1/1e3,kilometres:1/1e3,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/i.earthRadius,yards:1.0936133},i.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046};function e(k,$,O){O===void 0&&(O={});var P={type:"Feature"};return(O.id===0||O.id)&&(P.id=O.id),O.bbox&&(P.bbox=O.bbox),P.properties=$||{},P.geometry=k,P}h(e,"feature"),i.feature=e;function t(k,$,O){switch(k){case"Point":return r($).geometry;case"LineString":return s($).geometry;case"Polygon":return a($).geometry;case"MultiPoint":return p($).geometry;case"MultiLineString":return c($).geometry;case"MultiPolygon":return d($).geometry;default:throw new Error(k+" is invalid")}}h(t,"geometry"),i.geometry=t;function r(k,$,O){if(O===void 0&&(O={}),!k)throw new Error("coordinates is required");if(!Array.isArray(k))throw new Error("coordinates must be an Array");if(k.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!L(k[0])||!L(k[1]))throw new Error("coordinates must contain numbers");var P={type:"Point",coordinates:k};return e(P,$,O)}h(r,"point"),i.point=r;function n(k,$,O){return O===void 0&&(O={}),u(k.map(function(P){return r(P,$)}),O)}h(n,"points"),i.points=n;function a(k,$,O){O===void 0&&(O={});for(var P=0,U=k;P<U.length;P++){var G=U[P];if(G.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var K=0;K<G[G.length-1].length;K++)if(G[G.length-1][K]!==G[0][K])throw new Error("First and last Position are not equivalent.")}var z={type:"Polygon",coordinates:k};return e(z,$,O)}h(a,"polygon"),i.polygon=a;function o(k,$,O){return O===void 0&&(O={}),u(k.map(function(P){return a(P,$)}),O)}h(o,"polygons"),i.polygons=o;function s(k,$,O){if(O===void 0&&(O={}),k.length<2)throw new Error("coordinates must be an array of two or more positions");var P={type:"LineString",coordinates:k};return e(P,$,O)}h(s,"lineString"),i.lineString=s;function l(k,$,O){return O===void 0&&(O={}),u(k.map(function(P){return s(P,$)}),O)}h(l,"lineStrings"),i.lineStrings=l;function u(k,$){$===void 0&&($={});var O={type:"FeatureCollection"};return $.id&&(O.id=$.id),$.bbox&&(O.bbox=$.bbox),O.features=k,O}h(u,"featureCollection"),i.featureCollection=u;function c(k,$,O){O===void 0&&(O={});var P={type:"MultiLineString",coordinates:k};return e(P,$,O)}h(c,"multiLineString"),i.multiLineString=c;function p(k,$,O){O===void 0&&(O={});var P={type:"MultiPoint",coordinates:k};return e(P,$,O)}h(p,"multiPoint"),i.multiPoint=p;function d(k,$,O){O===void 0&&(O={});var P={type:"MultiPolygon",coordinates:k};return e(P,$,O)}h(d,"multiPolygon"),i.multiPolygon=d;function m(k,$,O){O===void 0&&(O={});var P={type:"GeometryCollection",geometries:k};return e(P,$,O)}h(m,"geometryCollection"),i.geometryCollection=m;function g(k,$){if($===void 0&&($=0),$&&!($>=0))throw new Error("precision must be a positive number");var O=Math.pow(10,$||0);return Math.round(k*O)/O}h(g,"round"),i.round=g;function b(k,$){$===void 0&&($="kilometers");var O=i.factors[$];if(!O)throw new Error($+" units is invalid");return k*O}h(b,"radiansToLength"),i.radiansToLength=b;function x(k,$){$===void 0&&($="kilometers");var O=i.factors[$];if(!O)throw new Error($+" units is invalid");return k/O}h(x,"lengthToRadians"),i.lengthToRadians=x;function v(k,$){return _(x(k,$))}h(v,"lengthToDegrees"),i.lengthToDegrees=v;function w(k){var $=k%360;return $<0&&($+=360),$}h(w,"bearingToAzimuth"),i.bearingToAzimuth=w;function _(k){var $=k%(2*Math.PI);return $*180/Math.PI}h(_,"radiansToDegrees"),i.radiansToDegrees=_;function C(k){var $=k%360;return $*Math.PI/180}h(C,"degreesToRadians"),i.degreesToRadians=C;function E(k,$,O){if($===void 0&&($="kilometers"),O===void 0&&(O="kilometers"),!(k>=0))throw new Error("length must be a positive number");return b(x(k,$),O)}h(E,"convertLength"),i.convertLength=E;function T(k,$,O){if($===void 0&&($="meters"),O===void 0&&(O="kilometers"),!(k>=0))throw new Error("area must be a positive number");var P=i.areaFactors[$];if(!P)throw new Error("invalid original units");var U=i.areaFactors[O];if(!U)throw new Error("invalid final units");return k/P*U}h(T,"convertArea"),i.convertArea=T;function L(k){return!isNaN(k)&&k!==null&&!Array.isArray(k)}h(L,"isNumber"),i.isNumber=L;function D(k){return!!k&&k.constructor===Object}h(D,"isObject"),i.isObject=D;function B(k){if(!k)throw new Error("bbox is required");if(!Array.isArray(k))throw new Error("bbox must be an Array");if(k.length!==4&&k.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");k.forEach(function($){if(!L($))throw new Error("bbox must only contain numbers")})}h(B,"validateBBox"),i.validateBBox=B;function A(k){if(!k)throw new Error("id is required");if(["string","number"].indexOf(typeof k)===-1)throw new Error("id must be a number or a string")}h(A,"validateId"),i.validateId=A}),t0e=Qe(i=>{R(),Object.defineProperty(i,"__esModule",{value:!0});var e=TY();function t(_,C,E){if(_!==null)for(var T,L,D,B,A,k,$,O=0,P=0,U,G=_.type,K=G==="FeatureCollection",z=G==="Feature",V=K?_.features.length:1,j=0;j<V;j++){$=K?_.features[j].geometry:z?_.geometry:_,U=$?$.type==="GeometryCollection":!1,A=U?$.geometries.length:1;for(var q=0;q<A;q++){var ee=0,ae=0;if(B=U?$.geometries[q]:$,B!==null){k=B.coordinates;var N=B.type;switch(O=E&&(N==="Polygon"||N==="MultiPolygon")?1:0,N){case null:break;case"Point":if(C(k,P,j,ee,ae)===!1)return!1;P++,ee++;break;case"LineString":case"MultiPoint":for(T=0;T<k.length;T++){if(C(k[T],P,j,ee,ae)===!1)return!1;P++,N==="MultiPoint"&&ee++}N==="LineString"&&ee++;break;case"Polygon":case"MultiLineString":for(T=0;T<k.length;T++){for(L=0;L<k[T].length-O;L++){if(C(k[T][L],P,j,ee,ae)===!1)return!1;P++}N==="MultiLineString"&&ee++,N==="Polygon"&&ae++}N==="Polygon"&&ee++;break;case"MultiPolygon":for(T=0;T<k.length;T++){for(ae=0,L=0;L<k[T].length;L++){for(D=0;D<k[T][L].length-O;D++){if(C(k[T][L][D],P,j,ee,ae)===!1)return!1;P++}ae++}ee++}break;case"GeometryCollection":for(T=0;T<B.geometries.length;T++)if(t(B.geometries[T],C,E)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}h(t,"coordEach");function r(_,C,E,T){var L=E;return t(_,function(D,B,A,k,$){B===0&&E===void 0?L=D:L=C(L,D,B,A,k,$)},T),L}h(r,"coordReduce");function n(_,C){var E;switch(_.type){case"FeatureCollection":for(E=0;E<_.features.length&&C(_.features[E].properties,E)!==!1;E++);break;case"Feature":C(_.properties,0);break}}h(n,"propEach");function a(_,C,E){var T=E;return n(_,function(L,D){D===0&&E===void 0?T=L:T=C(T,L,D)}),T}h(a,"propReduce");function o(_,C){if(_.type==="Feature")C(_,0);else if(_.type==="FeatureCollection")for(var E=0;E<_.features.length&&C(_.features[E],E)!==!1;E++);}h(o,"featureEach");function s(_,C,E){var T=E;return o(_,function(L,D){D===0&&E===void 0?T=L:T=C(T,L,D)}),T}h(s,"featureReduce");function l(_){var C=[];return t(_,function(E){C.push(E)}),C}h(l,"coordAll");function u(_,C){var E,T,L,D,B,A,k,$,O,P,U=0,G=_.type==="FeatureCollection",K=_.type==="Feature",z=G?_.features.length:1;for(E=0;E<z;E++){for(A=G?_.features[E].geometry:K?_.geometry:_,$=G?_.features[E].properties:K?_.properties:{},O=G?_.features[E].bbox:K?_.bbox:void 0,P=G?_.features[E].id:K?_.id:void 0,k=A?A.type==="GeometryCollection":!1,B=k?A.geometries.length:1,L=0;L<B;L++){if(D=k?A.geometries[L]:A,D===null){if(C(null,U,$,O,P)===!1)return!1;continue}switch(D.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(C(D,U,$,O,P)===!1)return!1;break}case"GeometryCollection":{for(T=0;T<D.geometries.length;T++)if(C(D.geometries[T],U,$,O,P)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}U++}}h(u,"geomEach");function c(_,C,E){var T=E;return u(_,function(L,D,B,A,k){D===0&&E===void 0?T=L:T=C(T,L,D,B,A,k)}),T}h(c,"geomReduce");function p(_,C){u(_,function(E,T,L,D,B){var A=E===null?null:E.type;switch(A){case null:case"Point":case"LineString":case"Polygon":return C(e.feature(E,L,{bbox:D,id:B}),T,0)===!1?!1:void 0}var k;switch(A){case"MultiPoint":k="Point";break;case"MultiLineString":k="LineString";break;case"MultiPolygon":k="Polygon";break}for(var $=0;$<E.coordinates.length;$++){var O=E.coordinates[$],P={type:k,coordinates:O};if(C(e.feature(P,L),T,$)===!1)return!1}})}h(p,"flattenEach");function d(_,C,E){var T=E;return p(_,function(L,D,B){D===0&&B===0&&E===void 0?T=L:T=C(T,L,D,B)}),T}h(d,"flattenReduce");function m(_,C){p(_,function(E,T,L){var D=0;if(E.geometry){var B=E.geometry.type;if(!(B==="Point"||B==="MultiPoint")){var A,k=0,$=0,O=0;if(t(E,function(P,U,G,K,z){if(A===void 0||T>k||K>$||z>O){A=P,k=T,$=K,O=z,D=0;return}var V=e.lineString([A,P],E.properties);if(C(V,T,L,z,D)===!1)return!1;D++,A=P})===!1)return!1}}})}h(m,"segmentEach");function g(_,C,E){var T=E,L=!1;return m(_,function(D,B,A,k,$){L===!1&&E===void 0?T=D:T=C(T,D,B,A,k,$),L=!0}),T}h(g,"segmentReduce");function b(_,C){if(!_)throw new Error("geojson is required");p(_,function(E,T,L){if(E.geometry!==null){var D=E.geometry.type,B=E.geometry.coordinates;switch(D){case"LineString":if(C(E,T,L,0,0)===!1)return!1;break;case"Polygon":for(var A=0;A<B.length;A++)if(C(e.lineString(B[A],E.properties),T,L,A)===!1)return!1;break}}})}h(b,"lineEach");function x(_,C,E){var T=E;return b(_,function(L,D,B,A){D===0&&E===void 0?T=L:T=C(T,L,D,B,A)}),T}h(x,"lineReduce");function v(_,C){if(C=C||{},!e.isObject(C))throw new Error("options is invalid");var E=C.featureIndex||0,T=C.multiFeatureIndex||0,L=C.geometryIndex||0,D=C.segmentIndex||0,B=C.properties,A;switch(_.type){case"FeatureCollection":E<0&&(E=_.features.length+E),B=B||_.features[E].properties,A=_.features[E].geometry;break;case"Feature":B=B||_.properties,A=_.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":A=_;break;default:throw new Error("geojson is invalid")}if(A===null)return null;var k=A.coordinates;switch(A.type){case"Point":case"MultiPoint":return null;case"LineString":return D<0&&(D=k.length+D-1),e.lineString([k[D],k[D+1]],B,C);case"Polygon":return L<0&&(L=k.length+L),D<0&&(D=k[L].length+D-1),e.lineString([k[L][D],k[L][D+1]],B,C);case"MultiLineString":return T<0&&(T=k.length+T),D<0&&(D=k[T].length+D-1),e.lineString([k[T][D],k[T][D+1]],B,C);case"MultiPolygon":return T<0&&(T=k.length+T),L<0&&(L=k[T].length+L),D<0&&(D=k[T][L].length-D-1),e.lineString([k[T][L][D],k[T][L][D+1]],B,C)}throw new Error("geojson is invalid")}h(v,"findSegment");function w(_,C){if(C=C||{},!e.isObject(C))throw new Error("options is invalid");var E=C.featureIndex||0,T=C.multiFeatureIndex||0,L=C.geometryIndex||0,D=C.coordIndex||0,B=C.properties,A;switch(_.type){case"FeatureCollection":E<0&&(E=_.features.length+E),B=B||_.features[E].properties,A=_.features[E].geometry;break;case"Feature":B=B||_.properties,A=_.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":A=_;break;default:throw new Error("geojson is invalid")}if(A===null)return null;var k=A.coordinates;switch(A.type){case"Point":return e.point(k,B,C);case"MultiPoint":return T<0&&(T=k.length+T),e.point(k[T],B,C);case"LineString":return D<0&&(D=k.length+D),e.point(k[D],B,C);case"Polygon":return L<0&&(L=k.length+L),D<0&&(D=k[L].length+D),e.point(k[L][D],B,C);case"MultiLineString":return T<0&&(T=k.length+T),D<0&&(D=k[T].length+D),e.point(k[T][D],B,C);case"MultiPolygon":return T<0&&(T=k.length+T),L<0&&(L=k[T].length+L),D<0&&(D=k[T][L].length-D),e.point(k[T][L][D],B,C)}throw new Error("geojson is invalid")}h(w,"findPoint"),i.coordAll=l,i.coordEach=t,i.coordReduce=r,i.featureEach=o,i.featureReduce=s,i.findPoint=w,i.findSegment=v,i.flattenEach=p,i.flattenReduce=d,i.geomEach=u,i.geomReduce=c,i.lineEach=b,i.lineReduce=x,i.propEach=n,i.propReduce=a,i.segmentEach=m,i.segmentReduce=g}),PY=Qe((i,e)=>{R();var t=Object.prototype.toString;e.exports=h(function(r){var n=t.call(r),a=n==="[object Arguments]";return a||(a=n!=="[object Array]"&&r!==null&&typeof r=="object"&&typeof r.length=="number"&&r.length>=0&&t.call(r.callee)==="[object Function]"),a},"isArguments")}),i0e=Qe((i,e)=>{R();var t;Object.keys||(r=Object.prototype.hasOwnProperty,n=Object.prototype.toString,a=PY(),o=Object.prototype.propertyIsEnumerable,s=!o.call({toString:null},"toString"),l=o.call(function(){},"prototype"),u=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],c=h(function(g){var b=g.constructor;return b&&b.prototype===g},"equalsConstructorPrototype"),p={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},d=function(){if(typeof window>"u")return!1;for(var g in window)try{if(!p["$"+g]&&r.call(window,g)&&window[g]!==null&&typeof window[g]=="object")try{c(window[g])}catch{return!0}}catch{return!0}return!1}(),m=h(function(g){if(typeof window>"u"||!d)return c(g);try{return c(g)}catch{return!1}},"equalsConstructorPrototypeIfNotBuggy"),t=h(function(g){var b=g!==null&&typeof g=="object",x=n.call(g)==="[object Function]",v=a(g),w=b&&n.call(g)==="[object String]",_=[];if(!b&&!x&&!v)throw new TypeError("Object.keys called on a non-object");var C=l&&x;if(w&&g.length>0&&!r.call(g,0))for(var E=0;E<g.length;++E)_.push(String(E));if(v&&g.length>0)for(var T=0;T<g.length;++T)_.push(String(T));else for(var L in g)!(C&&L==="prototype")&&r.call(g,L)&&_.push(String(L));if(s)for(var D=m(g),B=0;B<u.length;++B)!(D&&u[B]==="constructor")&&r.call(g,u[B])&&_.push(u[B]);return _},"keys"));var r,n,a,o,s,l,u,c,p,d,m;e.exports=t}),zE=Qe((i,e)=>{R();var t=Array.prototype.slice,r=PY(),n=Object.keys,a=n?h(function(s){return n(s)},"keys"):i0e(),o=Object.keys;a.shim=h(function(){if(Object.keys){var s=function(){var l=Object.keys(arguments);return l&&l.length===arguments.length}(1,2);s||(Object.keys=h(function(l){return r(l)?o(t.call(l)):o(l)},"keys"))}else Object.keys=a;return Object.keys||a},"shimObjectKeys"),e.exports=a}),r0e=Qe((i,e)=>{R(),e.exports=Error}),n0e=Qe((i,e)=>{R(),e.exports=EvalError}),a0e=Qe((i,e)=>{R(),e.exports=RangeError}),o0e=Qe((i,e)=>{R(),e.exports=ReferenceError}),AY=Qe((i,e)=>{R(),e.exports=SyntaxError}),Xl=Qe((i,e)=>{R(),e.exports=TypeError}),s0e=Qe((i,e)=>{R(),e.exports=URIError}),qx=Qe((i,e)=>{R(),e.exports=h(function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var t={},r=Symbol("test"),n=Object(r);if(typeof r=="string"||Object.prototype.toString.call(r)!=="[object Symbol]"||Object.prototype.toString.call(n)!=="[object Symbol]")return!1;var a=42;t[r]=a;for(r in t)return!1;if(typeof Object.keys=="function"&&Object.keys(t).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(t).length!==0)return!1;var o=Object.getOwnPropertySymbols(t);if(o.length!==1||o[0]!==r||!Object.prototype.propertyIsEnumerable.call(t,r))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var s=Object.getOwnPropertyDescriptor(t,r);if(s.value!==a||s.enumerable!==!0)return!1}return!0},"hasSymbols")}),BE=Qe((i,e)=>{R();var t=typeof Symbol<"u"&&Symbol,r=qx();e.exports=h(function(){return typeof t!="function"||typeof Symbol!="function"||typeof t("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:r()},"hasNativeSymbols")}),l0e=Qe((i,e)=>{R();var t={__proto__:null,foo:{}},r=Object;e.exports=h(function(){return{__proto__:t}.foo===t.foo&&!(t instanceof r)},"hasProto")}),u0e=Qe((i,e)=>{R();var t="Function.prototype.bind called on incompatible ",r=Object.prototype.toString,n=Math.max,a="[object Function]",o=h(function(u,c){for(var p=[],d=0;d<u.length;d+=1)p[d]=u[d];for(var m=0;m<c.length;m+=1)p[m+u.length]=c[m];return p},"concatty"),s=h(function(u,c){for(var p=[],d=c||0,m=0;d<u.length;d+=1,m+=1)p[m]=u[d];return p},"slicy"),l=h(function(u,c){for(var p="",d=0;d<u.length;d+=1)p+=u[d],d+1<u.length&&(p+=c);return p},"joiny");e.exports=h(function(u){var c=this;if(typeof c!="function"||r.apply(c)!==a)throw new TypeError(t+c);for(var p=s(arguments,1),d,m=h(function(){if(this instanceof d){var w=c.apply(this,o(p,arguments));return Object(w)===w?w:this}return c.apply(u,o(p,arguments))},"binder"),g=n(0,c.length-p.length),b=[],x=0;x<g;x++)b[x]="$"+x;if(d=Function("binder","return function ("+l(b,",")+"){ return binder.apply(this,arguments); }")(m),c.prototype){var v=h(function(){},"Empty");v.prototype=c.prototype,d.prototype=new v,v.prototype=null}return d},"bind")}),OE=Qe((i,e)=>{R();var t=u0e();e.exports=Function.prototype.bind||t}),IY=Qe((i,e)=>{R();var t=Function.prototype.call,r=Object.prototype.hasOwnProperty,n=OE();e.exports=n.call(t,r)}),Jo=Qe((i,e)=>{R();var t,r=r0e(),n=n0e(),a=a0e(),o=o0e(),s=AY(),l=Xl(),u=s0e(),c=Function,p=h(function(V){try{return c('"use strict"; return ('+V+").constructor;")()}catch{}},"getEvalledConstructor"),d=Object.getOwnPropertyDescriptor;if(d)try{d({},"")}catch{d=null}var m=h(function(){throw new l},"throwTypeError"),g=d?function(){try{return arguments.callee,m}catch{try{return d(arguments,"callee").get}catch{return m}}}():m,b=BE()(),x=l0e()(),v=Object.getPrototypeOf||(x?function(V){return V.__proto__}:null),w={},_=typeof Uint8Array>"u"||!v?t:v(Uint8Array),C={__proto__:null,"%AggregateError%":typeof AggregateError>"u"?t:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?t:ArrayBuffer,"%ArrayIteratorPrototype%":b&&v?v([][Symbol.iterator]()):t,"%AsyncFromSyncIteratorPrototype%":t,"%AsyncFunction%":w,"%AsyncGenerator%":w,"%AsyncGeneratorFunction%":w,"%AsyncIteratorPrototype%":w,"%Atomics%":typeof Atomics>"u"?t:Atomics,"%BigInt%":typeof BigInt>"u"?t:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?t:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?t:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?t:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":r,"%eval%":eval,"%EvalError%":n,"%Float32Array%":typeof Float32Array>"u"?t:Float32Array,"%Float64Array%":typeof Float64Array>"u"?t:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?t:FinalizationRegistry,"%Function%":c,"%GeneratorFunction%":w,"%Int8Array%":typeof Int8Array>"u"?t:Int8Array,"%Int16Array%":typeof Int16Array>"u"?t:Int16Array,"%Int32Array%":typeof Int32Array>"u"?t:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":b&&v?v(v([][Symbol.iterator]())):t,"%JSON%":typeof JSON=="object"?JSON:t,"%Map%":typeof Map>"u"?t:Map,"%MapIteratorPrototype%":typeof Map>"u"||!b||!v?t:v(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?t:Promise,"%Proxy%":typeof Proxy>"u"?t:Proxy,"%RangeError%":a,"%ReferenceError%":o,"%Reflect%":typeof Reflect>"u"?t:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?t:Set,"%SetIteratorPrototype%":typeof Set>"u"||!b||!v?t:v(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?t:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":b&&v?v(""[Symbol.iterator]()):t,"%Symbol%":b?Symbol:t,"%SyntaxError%":s,"%ThrowTypeError%":g,"%TypedArray%":_,"%TypeError%":l,"%Uint8Array%":typeof Uint8Array>"u"?t:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?t:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?t:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?t:Uint32Array,"%URIError%":u,"%WeakMap%":typeof WeakMap>"u"?t:WeakMap,"%WeakRef%":typeof WeakRef>"u"?t:WeakRef,"%WeakSet%":typeof WeakSet>"u"?t:WeakSet};if(v)try{null.error}catch(V){E=v(v(V)),C["%Error.prototype%"]=E}var E,T=h(function V(j){var q;if(j==="%AsyncFunction%")q=p("async function () {}");else if(j==="%GeneratorFunction%")q=p("function* () {}");else if(j==="%AsyncGeneratorFunction%")q=p("async function* () {}");else if(j==="%AsyncGenerator%"){var ee=V("%AsyncGeneratorFunction%");ee&&(q=ee.prototype)}else if(j==="%AsyncIteratorPrototype%"){var ae=V("%AsyncGenerator%");ae&&v&&(q=v(ae.prototype))}return C[j]=q,q},"doEval"),L={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},D=OE(),B=IY(),A=D.call(Function.call,Array.prototype.concat),k=D.call(Function.apply,Array.prototype.splice),$=D.call(Function.call,String.prototype.replace),O=D.call(Function.call,String.prototype.slice),P=D.call(Function.call,RegExp.prototype.exec),U=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,G=/\\(\\)?/g,K=h(function(V){var j=O(V,0,1),q=O(V,-1);if(j==="%"&&q!=="%")throw new s("invalid intrinsic syntax, expected closing `%`");if(q==="%"&&j!=="%")throw new s("invalid intrinsic syntax, expected opening `%`");var ee=[];return $(V,U,function(ae,N,J,Y){ee[ee.length]=J?$(Y,G,"$1"):N||ae}),ee},"stringToPath"),z=h(function(V,j){var q=V,ee;if(B(L,q)&&(ee=L[q],q="%"+ee[0]+"%"),B(C,q)){var ae=C[q];if(ae===w&&(ae=T(q)),typeof ae>"u"&&!j)throw new l("intrinsic "+V+" exists, but is not available. Please file an issue!");return{alias:ee,name:q,value:ae}}throw new s("intrinsic "+V+" does not exist!")},"getBaseIntrinsic");e.exports=h(function(V,j){if(typeof V!="string"||V.length===0)throw new l("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof j!="boolean")throw new l('"allowMissing" argument must be a boolean');if(P(/^%?[^%]*%?$/,V)===null)throw new s("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var q=K(V),ee=q.length>0?q[0]:"",ae=z("%"+ee+"%",j),N=ae.name,J=ae.value,Y=!1,oe=ae.alias;oe&&(ee=oe[0],k(q,A([0,1],oe)));for(var xe=1,ge=!0;xe<q.length;xe+=1){var Te=q[xe],me=O(Te,0,1),Q=O(Te,-1);if((me==='"'||me==="'"||me==="`"||Q==='"'||Q==="'"||Q==="`")&&me!==Q)throw new s("property names with quotes must have matching quotes");if((Te==="constructor"||!ge)&&(Y=!0),ee+="."+Te,N="%"+ee+"%",B(C,N))J=C[N];else if(J!=null){if(!(Te in J)){if(!j)throw new l("base intrinsic for "+V+" exists, but the property is not available.");return}if(d&&xe+1>=q.length){var Me=d(J,Te);ge=!!Me,ge&&"get"in Me&&!("originalValue"in Me.get)?J=Me.get:J=J[Te]}else ge=B(J,Te),J=J[Te];ge&&!Y&&(C[N]=J)}}return J},"GetIntrinsic")}),NE=Qe((i,e)=>{R();var t=Jo(),r=t("%Object.defineProperty%",!0)||!1;if(r)try{r({},"a",{value:1})}catch{r=!1}e.exports=r}),$E=Qe((i,e)=>{R();var t=Jo(),r=t("%Object.getOwnPropertyDescriptor%",!0);if(r)try{r([],"length")}catch{r=null}e.exports=r}),UE=Qe((i,e)=>{R();var t=NE(),r=AY(),n=Xl(),a=$E();e.exports=h(function(o,s,l){if(!o||typeof o!="object"&&typeof o!="function")throw new n("`obj` must be an object or a function`");if(typeof s!="string"&&typeof s!="symbol")throw new n("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new n("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new n("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new n("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new n("`loose`, if provided, must be a boolean");var u=arguments.length>3?arguments[3]:null,c=arguments.length>4?arguments[4]:null,p=arguments.length>5?arguments[5]:null,d=arguments.length>6?arguments[6]:!1,m=!!a&&a(o,s);if(t)t(o,s,{configurable:p===null&&m?m.configurable:!p,enumerable:u===null&&m?m.enumerable:!u,value:l,writable:c===null&&m?m.writable:!c});else if(d||!u&&!c&&!p)o[s]=l;else throw new r("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")},"defineDataProperty")}),VE=Qe((i,e)=>{R();var t=NE(),r=h(function(){return!!t},"hasPropertyDescriptors");r.hasArrayLengthDefineBug=h(function(){if(!t)return null;try{return t([],"length",{value:1}).length!==1}catch{return!0}},"hasArrayLengthDefineBug"),e.exports=r}),mh=Qe((i,e)=>{R();var t=zE(),r=typeof Symbol=="function"&&typeof Symbol("foo")=="symbol",n=Object.prototype.toString,a=Array.prototype.concat,o=UE(),s=h(function(p){return typeof p=="function"&&n.call(p)==="[object Function]"},"isFunction"),l=VE()(),u=h(function(p,d,m,g){if(d in p){if(g===!0){if(p[d]===m)return}else if(!s(g)||!g())return}l?o(p,d,m,!0):o(p,d,m)},"defineProperty"),c=h(function(p,d){var m=arguments.length>2?arguments[2]:{},g=t(d);r&&(g=a.call(g,Object.getOwnPropertySymbols(d)));for(var b=0;b<g.length;b+=1)u(p,g[b],d[g[b]],m[g[b]])},"defineProperties");c.supportsDescriptors=!!l,e.exports=c}),h0e=Qe((i,e)=>{R();var t=Jo(),r=UE(),n=VE()(),a=$E(),o=Xl(),s=t("%Math.floor%");e.exports=h(function(l,u){if(typeof l!="function")throw new o("`fn` is not a function");if(typeof u!="number"||u<0||u>4294967295||s(u)!==u)throw new o("`length` must be a positive 32-bit integer");var c=arguments.length>2&&!!arguments[2],p=!0,d=!0;if("length"in l&&a){var m=a(l,"length");m&&!m.configurable&&(p=!1),m&&!m.writable&&(d=!1)}return(p||d||!c)&&(n?r(l,"length",u,!0,!0):r(l,"length",u)),l},"setFunctionLength")}),ld=Qe((i,e)=>{R();var t=OE(),r=Jo(),n=h0e(),a=Xl(),o=r("%Function.prototype.apply%"),s=r("%Function.prototype.call%"),l=r("%Reflect.apply%",!0)||t.call(s,o),u=NE(),c=r("%Math.max%");e.exports=h(function(d){if(typeof d!="function")throw new a("a function is required");var m=l(t,s,arguments);return n(m,1+c(0,d.length-(arguments.length-1)),!0)},"callBind");var p=h(function(){return l(t,o,arguments)},"applyBind");u?u(e.exports,"apply",{value:p}):e.exports.apply=p}),Va=Qe((i,e)=>{R();var t=Jo(),r=ld(),n=r(t("String.prototype.indexOf"));e.exports=h(function(a,o){var s=t(a,!!o);return typeof s=="function"&&n(a,".prototype.")>-1?r(s):s},"callBoundIntrinsic")}),LY=Qe((i,e)=>{R();var t=zE(),r=qx()(),n=Va(),a=Object,o=n("Array.prototype.push"),s=n("Object.prototype.propertyIsEnumerable"),l=r?Object.getOwnPropertySymbols:null;e.exports=h(function(u,c){if(u==null)throw new TypeError("target must be an object");var p=a(u);if(arguments.length===1)return p;for(var d=1;d<arguments.length;++d){var m=a(arguments[d]),g=t(m),b=r&&(Object.getOwnPropertySymbols||l);if(b)for(var x=b(m),v=0;v<x.length;++v){var w=x[v];s(m,w)&&o(g,w)}for(var _=0;_<g.length;++_){var C=g[_];if(s(m,C)){var E=m[C];p[C]=E}}}return p},"assign")}),DY=Qe((i,e)=>{R();var t=LY(),r=h(function(){if(!Object.assign)return!1;for(var a="abcdefghijklmnopqrst",o=a.split(""),s={},l=0;l<o.length;++l)s[o[l]]=o[l];var u=Object.assign({},s),c="";for(var p in u)c+=p;return a!==c},"lacksProperEnumerationOrder"),n=h(function(){if(!Object.assign||!Object.preventExtensions)return!1;var a=Object.preventExtensions({1:2});try{Object.assign(a,"xy")}catch{return a[1]==="y"}return!1},"assignHasPendingExceptions");e.exports=h(function(){return!Object.assign||r()||n()?t:Object.assign},"getPolyfill")}),c0e=Qe((i,e)=>{R();var t=mh(),r=DY();e.exports=h(function(){var n=r();return t(Object,{assign:n},{assign:function(){return Object.assign!==n}}),n},"shimAssign")}),p0e=Qe((i,e)=>{R();var t=mh(),r=ld(),n=LY(),a=DY(),o=c0e(),s=r.apply(a()),l=h(function(u,c){return s(Object,arguments)},"assign");t(l,{getPolyfill:a,implementation:n,shim:o}),e.exports=l}),d0e=Qe((i,e)=>{R();var t=h(function(){return typeof h(function(){},"f").name=="string"},"functionsHaveNames"),r=Object.getOwnPropertyDescriptor;if(r)try{r([],"length")}catch{r=null}t.functionsHaveConfigurableNames=h(function(){if(!t()||!r)return!1;var a=r(function(){},"name");return!!a&&!!a.configurable},"functionsHaveConfigurableNames");var n=Function.prototype.bind;t.boundFunctionsHaveNames=h(function(){return t()&&typeof n=="function"&&h(function(){},"f").bind().name!==""},"boundFunctionsHaveNames"),e.exports=t}),f0e=Qe((i,e)=>{R();var t=UE(),r=VE()(),n=d0e().functionsHaveConfigurableNames(),a=Xl();e.exports=h(function(o,s){if(typeof o!="function")throw new a("`fn` is not a function");var l=arguments.length>2&&!!arguments[2];return(!l||n)&&(r?t(o,"name",s,!0,!0):t(o,"name",s)),o},"setFunctionName")}),kY=Qe((i,e)=>{R();var t=f0e(),r=Xl(),n=Object;e.exports=t(h(function(){if(this==null||this!==n(this))throw new r("RegExp.prototype.flags getter called on non-object");var a="";return this.hasIndices&&(a+="d"),this.global&&(a+="g"),this.ignoreCase&&(a+="i"),this.multiline&&(a+="m"),this.dotAll&&(a+="s"),this.unicode&&(a+="u"),this.unicodeSets&&(a+="v"),this.sticky&&(a+="y"),a},"flags"),"get flags",!0)}),RY=Qe((i,e)=>{R();var t=kY(),r=mh().supportsDescriptors,n=Object.getOwnPropertyDescriptor;e.exports=h(function(){if(r&&/a/mig.flags==="gim"){var a=n(RegExp.prototype,"flags");if(a&&typeof a.get=="function"&&typeof RegExp.prototype.dotAll=="boolean"&&typeof RegExp.prototype.hasIndices=="boolean"){var o="",s={};if(Object.defineProperty(s,"hasIndices",{get:function(){o+="d"}}),Object.defineProperty(s,"sticky",{get:function(){o+="y"}}),o==="dy")return a.get}}return t},"getPolyfill")}),m0e=Qe((i,e)=>{R();var t=mh().supportsDescriptors,r=RY(),n=Object.getOwnPropertyDescriptor,a=Object.defineProperty,o=TypeError,s=Object.getPrototypeOf,l=/a/;e.exports=h(function(){if(!t||!s)throw new o("RegExp.prototype.flags requires a true ES5 environment that supports property descriptors");var u=r(),c=s(l),p=n(c,"flags");return(!p||p.get!==u)&&a(c,"flags",{configurable:!0,enumerable:!1,get:u}),u},"shimFlags")}),g0e=Qe((i,e)=>{R();var t=mh(),r=ld(),n=kY(),a=RY(),o=m0e(),s=r(a());t(s,{getPolyfill:a,implementation:n,shim:o}),e.exports=s}),gh=Qe((i,e)=>{R();var t=qx();e.exports=h(function(){return t()&&!!Symbol.toStringTag},"hasToStringTagShams")}),FY=Qe((i,e)=>{R();var t=gh()(),r=Va(),n=r("Object.prototype.toString"),a=h(function(l){return t&&l&&typeof l=="object"&&Symbol.toStringTag in l?!1:n(l)==="[object Arguments]"},"isArguments"),o=h(function(l){return a(l)?!0:l!==null&&typeof l=="object"&&typeof l.length=="number"&&l.length>=0&&n(l)!=="[object Array]"&&n(l.callee)==="[object Function]"},"isArguments"),s=function(){return a(arguments)}();a.isLegacyArguments=o,e.exports=s?a:o}),y0e=Qe(()=>{R()}),v0e=Qe((i,e)=>{R();var t=typeof Map=="function"&&Map.prototype,r=Object.getOwnPropertyDescriptor&&t?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,n=t&&r&&typeof r.get=="function"?r.get:null,a=t&&Map.prototype.forEach,o=typeof Set=="function"&&Set.prototype,s=Object.getOwnPropertyDescriptor&&o?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,l=o&&s&&typeof s.get=="function"?s.get:null,u=o&&Set.prototype.forEach,c=typeof WeakMap=="function"&&WeakMap.prototype,p=c?WeakMap.prototype.has:null,d=typeof WeakSet=="function"&&WeakSet.prototype,m=d?WeakSet.prototype.has:null,g=typeof WeakRef=="function"&&WeakRef.prototype,b=g?WeakRef.prototype.deref:null,x=Boolean.prototype.valueOf,v=Object.prototype.toString,w=Function.prototype.toString,_=String.prototype.match,C=String.prototype.slice,E=String.prototype.replace,T=String.prototype.toUpperCase,L=String.prototype.toLowerCase,D=RegExp.prototype.test,B=Array.prototype.concat,A=Array.prototype.join,k=Array.prototype.slice,$=Math.floor,O=typeof BigInt=="function"?BigInt.prototype.valueOf:null,P=Object.getOwnPropertySymbols,U=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,G=typeof Symbol=="function"&&typeof Symbol.iterator=="object",K=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===G||!0)?Symbol.toStringTag:null,z=Object.prototype.propertyIsEnumerable,V=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(ue){return ue.__proto__}:null);function j(ue,he){if(ue===1/0||ue===-1/0||ue!==ue||ue&&ue>-1e3&&ue<1e3||D.call(/e/,he))return he;var We=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof ue=="number"){var pt=ue<0?-$(-ue):$(ue);if(pt!==ue){var ut=String(pt),ct=C.call(he,ut.length+1);return E.call(ut,We,"$&_")+"."+E.call(E.call(ct,/([0-9]{3})/g,"$&_"),/_$/,"")}}return E.call(he,We,"$&_")}h(j,"addNumericSeparator");var q=y0e(),ee=q.custom,ae=Me(ee)?ee:null;e.exports=h(function ue(he,We,pt,ut){var ct=We||{};if(De(ct,"quoteStyle")&&ct.quoteStyle!=="single"&&ct.quoteStyle!=="double")throw new TypeError('option "quoteStyle" must be "single" or "double"');if(De(ct,"maxStringLength")&&(typeof ct.maxStringLength=="number"?ct.maxStringLength<0&&ct.maxStringLength!==1/0:ct.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var ce=De(ct,"customInspect")?ct.customInspect:!0;if(typeof ce!="boolean"&&ce!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(De(ct,"indent")&&ct.indent!==null&&ct.indent!=="	"&&!(parseInt(ct.indent,10)===ct.indent&&ct.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(De(ct,"numericSeparator")&&typeof ct.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var et=ct.numericSeparator;if(typeof he>"u")return"undefined";if(he===null)return"null";if(typeof he=="boolean")return he?"true":"false";if(typeof he=="string")return ze(he,ct);if(typeof he=="number"){if(he===0)return 1/0/he>0?"0":"-0";var be=String(he);return et?j(he,be):be}if(typeof he=="bigint"){var Ge=String(he)+"n";return et?j(he,Ge):Ge}var tt=typeof ct.depth>"u"?5:ct.depth;if(typeof pt>"u"&&(pt=0),pt>=tt&&tt>0&&typeof he=="object")return Y(he)?"[Array]":"[Object]";var Ht=Xe(ct,pt);if(typeof ut>"u")ut=[];else if(Ze(ut,he)>=0)return"[Circular]";function Nt(ye,Ce,Pe){if(Ce&&(ut=k.call(ut),ut.push(Ce)),Pe){var Se={depth:ct.depth};return De(ct,"quoteStyle")&&(Se.quoteStyle=ct.quoteStyle),ue(ye,Se,pt+1,ut)}return ue(ye,ct,pt+1,ut)}if(h(Nt,"inspect"),typeof he=="function"&&!xe(he)){var Mi=Fe(he),ar=At(he,Nt);return"[Function"+(Mi?": "+Mi:" (anonymous)")+"]"+(ar.length>0?" { "+A.call(ar,", ")+" }":"")}if(Me(he)){var Ut=G?E.call(String(he),/^(Symbol\(.*\))_[^)]*$/,"$1"):U.call(he);return typeof he=="object"&&!G?ot(Ut):Ut}if(Ne(he)){for(var Ci="<"+L.call(String(he.nodeName)),pr=he.attributes||[],Pn=0;Pn<pr.length;Pn++)Ci+=" "+pr[Pn].name+"="+N(J(pr[Pn].value),"double",ct);return Ci+=">",he.childNodes&&he.childNodes.length&&(Ci+="..."),Ci+="</"+L.call(String(he.nodeName))+">",Ci}if(Y(he)){if(he.length===0)return"[]";var ga=At(he,Nt);return Ht&&!bt(ga)?"["+ti(ga,Ht)+"]":"[ "+A.call(ga,", ")+" ]"}if(ge(he)){var cn=At(he,Nt);return!("cause"in Error.prototype)&&"cause"in he&&!z.call(he,"cause")?"{ ["+String(he)+"] "+A.call(B.call("[cause]: "+Nt(he.cause),cn),", ")+" }":cn.length===0?"["+String(he)+"]":"{ ["+String(he)+"] "+A.call(cn,", ")+" }"}if(typeof he=="object"&&ce){if(ae&&typeof he[ae]=="function"&&q)return q(he,{depth:tt-pt});if(ce!=="symbol"&&typeof he.inspect=="function")return he.inspect()}if(yt(he)){var Gr=[];return a&&a.call(he,function(ye,Ce){Gr.push(Nt(Ce,he,!0)+" => "+Nt(ye,he))}),He("Map",n.call(he),Gr,Ht)}if(_e(he)){var An=[];return u&&u.call(he,function(ye){An.push(Nt(ye,he))}),He("Set",l.call(he),An,Ht)}if(ne(he))return je("WeakMap");if(Re(he))return je("WeakSet");if(W(he))return je("WeakRef");if(me(he))return ot(Nt(Number(he)));if(ve(he))return ot(Nt(O.call(he)));if(Q(he))return ot(x.call(he));if(Te(he))return ot(Nt(String(he)));if(typeof window<"u"&&he===window)return"{ [object Window] }";if(he===global)return"{ [object globalThis] }";if(!oe(he)&&!xe(he)){var Yn=At(he,Nt),ya=V?V(he)===Object.prototype:he instanceof Object||he.constructor===Object,va=he instanceof Object?"":"null prototype",ja=!ya&&K&&Object(he)===he&&K in he?C.call(we(he),8,-1):va?"Object":"",pn=ya||typeof he.constructor!="function"?"":he.constructor.name?he.constructor.name+" ":"",te=pn+(ja||va?"["+A.call(B.call([],ja||[],va||[]),": ")+"] ":"");return Yn.length===0?te+"{}":Ht?te+"{"+ti(Yn,Ht)+"}":te+"{ "+A.call(Yn,", ")+" }"}return String(he)},"inspect_");function N(ue,he,We){var pt=(We.quoteStyle||he)==="double"?'"':"'";return pt+ue+pt}h(N,"wrapQuotes");function J(ue){return E.call(String(ue),/"/g,"&quot;")}h(J,"quote");function Y(ue){return we(ue)==="[object Array]"&&(!K||!(typeof ue=="object"&&K in ue))}h(Y,"isArray");function oe(ue){return we(ue)==="[object Date]"&&(!K||!(typeof ue=="object"&&K in ue))}h(oe,"isDate");function xe(ue){return we(ue)==="[object RegExp]"&&(!K||!(typeof ue=="object"&&K in ue))}h(xe,"isRegExp");function ge(ue){return we(ue)==="[object Error]"&&(!K||!(typeof ue=="object"&&K in ue))}h(ge,"isError");function Te(ue){return we(ue)==="[object String]"&&(!K||!(typeof ue=="object"&&K in ue))}h(Te,"isString");function me(ue){return we(ue)==="[object Number]"&&(!K||!(typeof ue=="object"&&K in ue))}h(me,"isNumber");function Q(ue){return we(ue)==="[object Boolean]"&&(!K||!(typeof ue=="object"&&K in ue))}h(Q,"isBoolean");function Me(ue){if(G)return ue&&typeof ue=="object"&&ue instanceof Symbol;if(typeof ue=="symbol")return!0;if(!ue||typeof ue!="object"||!U)return!1;try{return U.call(ue),!0}catch{}return!1}h(Me,"isSymbol");function ve(ue){if(!ue||typeof ue!="object"||!O)return!1;try{return O.call(ue),!0}catch{}return!1}h(ve,"isBigInt");var Ie=Object.prototype.hasOwnProperty||function(ue){return ue in this};function De(ue,he){return Ie.call(ue,he)}h(De,"has");function we(ue){return v.call(ue)}h(we,"toStr");function Fe(ue){if(ue.name)return ue.name;var he=_.call(w.call(ue),/^function\s*([\w$]+)/);return he?he[1]:null}h(Fe,"nameOf");function Ze(ue,he){if(ue.indexOf)return ue.indexOf(he);for(var We=0,pt=ue.length;We<pt;We++)if(ue[We]===he)return We;return-1}h(Ze,"indexOf");function yt(ue){if(!n||!ue||typeof ue!="object")return!1;try{n.call(ue);try{l.call(ue)}catch{return!0}return ue instanceof Map}catch{}return!1}h(yt,"isMap");function ne(ue){if(!p||!ue||typeof ue!="object")return!1;try{p.call(ue,p);try{m.call(ue,m)}catch{return!0}return ue instanceof WeakMap}catch{}return!1}h(ne,"isWeakMap");function W(ue){if(!b||!ue||typeof ue!="object")return!1;try{return b.call(ue),!0}catch{}return!1}h(W,"isWeakRef");function _e(ue){if(!l||!ue||typeof ue!="object")return!1;try{l.call(ue);try{n.call(ue)}catch{return!0}return ue instanceof Set}catch{}return!1}h(_e,"isSet");function Re(ue){if(!m||!ue||typeof ue!="object")return!1;try{m.call(ue,m);try{p.call(ue,p)}catch{return!0}return ue instanceof WeakSet}catch{}return!1}h(Re,"isWeakSet");function Ne(ue){return!ue||typeof ue!="object"?!1:typeof HTMLElement<"u"&&ue instanceof HTMLElement?!0:typeof ue.nodeName=="string"&&typeof ue.getAttribute=="function"}h(Ne,"isElement");function ze(ue,he){if(ue.length>he.maxStringLength){var We=ue.length-he.maxStringLength,pt="... "+We+" more character"+(We>1?"s":"");return ze(C.call(ue,0,he.maxStringLength),he)+pt}var ut=E.call(E.call(ue,/(['\\])/g,"\\$1"),/[\x00-\x1f]/g,xt);return N(ut,"single",he)}h(ze,"inspectString");function xt(ue){var he=ue.charCodeAt(0),We={8:"b",9:"t",10:"n",12:"f",13:"r"}[he];return We?"\\"+We:"\\x"+(he<16?"0":"")+T.call(he.toString(16))}h(xt,"lowbyte");function ot(ue){return"Object("+ue+")"}h(ot,"markBoxed");function je(ue){return ue+" { ? }"}h(je,"weakCollectionOf");function He(ue,he,We,pt){var ut=pt?ti(We,pt):A.call(We,", ");return ue+" ("+he+") {"+ut+"}"}h(He,"collectionOf");function bt(ue){for(var he=0;he<ue.length;he++)if(Ze(ue[he],`
`)>=0)return!1;return!0}h(bt,"singleLineValues");function Xe(ue,he){var We;if(ue.indent==="	")We="	";else if(typeof ue.indent=="number"&&ue.indent>0)We=A.call(Array(ue.indent+1)," ");else return null;return{base:We,prev:A.call(Array(he+1),We)}}h(Xe,"getIndent");function ti(ue,he){if(ue.length===0)return"";var We=`
`+he.prev+he.base;return We+A.call(ue,","+We)+`
`+he.prev}h(ti,"indentedJoin");function At(ue,he){var We=Y(ue),pt=[];if(We){pt.length=ue.length;for(var ut=0;ut<ue.length;ut++)pt[ut]=De(ue,ut)?he(ue[ut],ue):""}var ct=typeof P=="function"?P(ue):[],ce;if(G){ce={};for(var et=0;et<ct.length;et++)ce["$"+ct[et]]=ct[et]}for(var be in ue)De(ue,be)&&(We&&String(Number(be))===be&&be<ue.length||G&&ce["$"+be]instanceof Symbol||(D.call(/[^\w$]/,be)?pt.push(he(be,ue)+": "+he(ue[be],ue)):pt.push(be+": "+he(ue[be],ue))));if(typeof P=="function")for(var Ge=0;Ge<ct.length;Ge++)z.call(ue,ct[Ge])&&pt.push("["+he(ct[Ge])+"]: "+he(ue[ct[Ge]],ue));return pt}h(At,"arrObjKeys")}),zY=Qe((i,e)=>{R();var t=Jo(),r=Va(),n=v0e(),a=Xl(),o=t("%WeakMap%",!0),s=t("%Map%",!0),l=r("WeakMap.prototype.get",!0),u=r("WeakMap.prototype.set",!0),c=r("WeakMap.prototype.has",!0),p=r("Map.prototype.get",!0),d=r("Map.prototype.set",!0),m=r("Map.prototype.has",!0),g=h(function(w,_){for(var C=w,E;(E=C.next)!==null;C=E)if(E.key===_)return C.next=E.next,E.next=w.next,w.next=E,E},"listGetNode"),b=h(function(w,_){var C=g(w,_);return C&&C.value},"listGet"),x=h(function(w,_,C){var E=g(w,_);E?E.value=C:w.next={key:_,next:w.next,value:C}},"listSet"),v=h(function(w,_){return!!g(w,_)},"listHas");e.exports=h(function(){var w,_,C,E={assert:function(T){if(!E.has(T))throw new a("Side channel does not contain "+n(T))},get:function(T){if(o&&T&&(typeof T=="object"||typeof T=="function")){if(w)return l(w,T)}else if(s){if(_)return p(_,T)}else if(C)return b(C,T)},has:function(T){if(o&&T&&(typeof T=="object"||typeof T=="function")){if(w)return c(w,T)}else if(s){if(_)return m(_,T)}else if(C)return v(C,T);return!1},set:function(T,L){o&&T&&(typeof T=="object"||typeof T=="function")?(w||(w=new o),u(w,T,L)):s?(_||(_=new s),d(_,T,L)):(C||(C={key:{},next:null}),x(C,T,L))}};return E},"getSideChannel")}),x0e=Qe((i,e)=>{R();var t=IY(),r=zY()(),n=Xl(),a={assert:function(o,s){if(!o||typeof o!="object"&&typeof o!="function")throw new n("`O` is not an object");if(typeof s!="string")throw new n("`slot` must be a string");if(r.assert(o),!a.has(o,s))throw new n("`"+s+"` is not present on `O`")},get:function(o,s){if(!o||typeof o!="object"&&typeof o!="function")throw new n("`O` is not an object");if(typeof s!="string")throw new n("`slot` must be a string");var l=r.get(o);return l&&l["$"+s]},has:function(o,s){if(!o||typeof o!="object"&&typeof o!="function")throw new n("`O` is not an object");if(typeof s!="string")throw new n("`slot` must be a string");var l=r.get(o);return!!l&&t(l,"$"+s)},set:function(o,s,l){if(!o||typeof o!="object"&&typeof o!="function")throw new n("`O` is not an object");if(typeof s!="string")throw new n("`slot` must be a string");var u=r.get(o);u||(u={},r.set(o,u)),u["$"+s]=l}};Object.freeze&&Object.freeze(a),e.exports=a}),_0e=Qe((i,e)=>{R();var t=x0e(),r=SyntaxError,n=typeof StopIteration=="object"?StopIteration:null;e.exports=h(function(a){if(!n)throw new r("this environment lacks StopIteration");t.set(a,"[[Done]]",!1);var o={next:h(function(){var s=t.get(this,"[[Iterator]]"),l=t.get(s,"[[Done]]");try{return{done:l,value:l?void 0:s.next()}}catch(u){if(t.set(s,"[[Done]]",!0),u!==n)throw u;return{done:!0,value:void 0}}},"next")};return t.set(o,"[[Iterator]]",a),o},"getStopIterationIterator")}),BY=Qe((i,e)=>{R();var t={}.toString;e.exports=Array.isArray||function(r){return t.call(r)=="[object Array]"}}),OY=Qe((i,e)=>{R();var t=String.prototype.valueOf,r=h(function(s){try{return t.call(s),!0}catch{return!1}},"tryStringObject"),n=Object.prototype.toString,a="[object String]",o=gh()();e.exports=h(function(s){return typeof s=="string"?!0:typeof s!="object"?!1:o?r(s):n.call(s)===a},"isString")}),NY=Qe((i,e)=>{R();var t=typeof Map=="function"&&Map.prototype?Map:null,r=typeof Set=="function"&&Set.prototype?Set:null,n;t||(n=h(function(s){return!1},"isMap"));var a=t?Map.prototype.has:null,o=r?Set.prototype.has:null;!n&&!a&&(n=h(function(s){return!1},"isMap")),e.exports=n||h(function(s){if(!s||typeof s!="object")return!1;try{if(a.call(s),o)try{o.call(s)}catch{return!0}return s instanceof t}catch{}return!1},"isMap")}),$Y=Qe((i,e)=>{R();var t=typeof Map=="function"&&Map.prototype?Map:null,r=typeof Set=="function"&&Set.prototype?Set:null,n;r||(n=h(function(s){return!1},"isSet"));var a=t?Map.prototype.has:null,o=r?Set.prototype.has:null;!n&&!o&&(n=h(function(s){return!1},"isSet")),e.exports=n||h(function(s){if(!s||typeof s!="object")return!1;try{if(o.call(s),a)try{a.call(s)}catch{return!0}return s instanceof r}catch{}return!1},"isSet")}),b0e=Qe((i,e)=>{R();var t=FY(),r=_0e();BE()()||qx()()?(n=Symbol.iterator,e.exports=h(function(A){if(A!=null&&typeof A[n]<"u")return A[n]();if(t(A))return Array.prototype[n].call(A)},"getIterator")):(a=BY(),o=OY(),s=Jo(),l=s("%Map%",!0),u=s("%Set%",!0),c=Va(),p=c("Array.prototype.push"),d=c("String.prototype.charCodeAt"),m=c("String.prototype.slice"),g=h(function(A,k){var $=A.length;if(k+1>=$)return k+1;var O=d(A,k);if(O<55296||O>56319)return k+1;var P=d(A,k+1);return P<56320||P>57343?k+1:k+2},"advanceStringIndex"),b=h(function(A){var k=0;return{next:h(function(){var $=k>=A.length,O;return $||(O=A[k],k+=1),{done:$,value:O}},"next")}},"getArrayIterator"),x=h(function(A,k){if(a(A)||t(A))return b(A);if(o(A)){var $=0;return{next:h(function(){var O=g(A,$),P=m(A,$,O);return $=O,{done:O>A.length,value:P}},"next")}}if(k&&typeof A["_es6-shim iterator_"]<"u")return A["_es6-shim iterator_"]()},"getNonCollectionIterator"),!l&&!u?e.exports=h(function(A){if(A!=null)return x(A,!0)},"getIterator"):(v=NY(),w=$Y(),_=c("Map.prototype.forEach",!0),C=c("Set.prototype.forEach",!0),(typeof hr>"u"||!hr.versions||!hr.versions.node)&&(E=c("Map.prototype.iterator",!0),T=c("Set.prototype.iterator",!0)),L=c("Map.prototype.@@iterator",!0)||c("Map.prototype._es6-shim iterator_",!0),D=c("Set.prototype.@@iterator",!0)||c("Set.prototype._es6-shim iterator_",!0),B=h(function(A){if(v(A)){if(E)return r(E(A));if(L)return L(A);if(_){var k=[];return _(A,function(O,P){p(k,[P,O])}),b(k)}}if(w(A)){if(T)return r(T(A));if(D)return D(A);if(C){var $=[];return C(A,function(O){p($,O)}),b($)}}},"getCollectionIterator"),e.exports=h(function(A){return B(A)||x(A)},"getIterator")));var n,a,o,s,l,u,c,p,d,m,g,b,x,v,w,_,C,E,T,L,D,B}),UY=Qe((i,e)=>{R();var t=h(function(r){return r!==r},"numberIsNaN");e.exports=h(function(r,n){return r===0&&n===0?1/r===1/n:!!(r===n||t(r)&&t(n))},"is")}),VY=Qe((i,e)=>{R();var t=UY();e.exports=h(function(){return typeof Object.is=="function"?Object.is:t},"getPolyfill")}),w0e=Qe((i,e)=>{R();var t=VY(),r=mh();e.exports=h(function(){var n=t();return r(Object,{is:n},{is:h(function(){return Object.is!==n},"testObjectIs")}),n},"shimObjectIs")}),S0e=Qe((i,e)=>{R();var t=mh(),r=ld(),n=UY(),a=VY(),o=w0e(),s=r(a(),Object);t(s,{getPolyfill:a,implementation:n,shim:o}),e.exports=s}),jY=Qe((i,e)=>{R();var t=ld(),r=Va(),n=Jo(),a=n("%ArrayBuffer%",!0),o=r("ArrayBuffer.prototype.byteLength",!0),s=r("Object.prototype.toString"),l=!!a&&!o&&new a(0).slice,u=!!l&&t(l);e.exports=h(o||u?function(c){if(!c||typeof c!="object")return!1;try{return o?o(c):u(c,0),!0}catch{return!1}}:a?function(c){return s(c)==="[object ArrayBuffer]"}:function(c){return!1},"isArrayBuffer")}),M0e=Qe((i,e)=>{R();var t=Date.prototype.getDay,r=h(function(s){try{return t.call(s),!0}catch{return!1}},"tryDateGetDayCall"),n=Object.prototype.toString,a="[object Date]",o=gh()();e.exports=h(function(s){return typeof s!="object"||s===null?!1:o?r(s):n.call(s)===a},"isDateObject")}),C0e=Qe((i,e)=>{R();var t=Va(),r=gh()(),n,a,o,s;r&&(n=t("Object.prototype.hasOwnProperty"),a=t("RegExp.prototype.exec"),o={},l=h(function(){throw o},"throwRegexMarker"),s={toString:l,valueOf:l},typeof Symbol.toPrimitive=="symbol"&&(s[Symbol.toPrimitive]=l));var l,u=t("Object.prototype.toString"),c=Object.getOwnPropertyDescriptor,p="[object RegExp]";e.exports=h(r?function(d){if(!d||typeof d!="object")return!1;var m=c(d,"lastIndex"),g=m&&n(m,"value");if(!g)return!1;try{a(d,s)}catch(b){return b===o}}:function(d){return!d||typeof d!="object"&&typeof d!="function"?!1:u(d)===p},"isRegex")}),E0e=Qe((i,e)=>{R();var t=Va(),r=t("SharedArrayBuffer.prototype.byteLength",!0);e.exports=h(r?function(n){if(!n||typeof n!="object")return!1;try{return r(n),!0}catch{return!1}}:function(n){return!1},"isSharedArrayBuffer")}),T0e=Qe((i,e)=>{R();var t=Number.prototype.toString,r=h(function(s){try{return t.call(s),!0}catch{return!1}},"tryNumberObject"),n=Object.prototype.toString,a="[object Number]",o=gh()();e.exports=h(function(s){return typeof s=="number"?!0:typeof s!="object"?!1:o?r(s):n.call(s)===a},"isNumberObject")}),P0e=Qe((i,e)=>{R();var t=Va(),r=t("Boolean.prototype.toString"),n=t("Object.prototype.toString"),a=h(function(l){try{return r(l),!0}catch{return!1}},"booleanBrandCheck"),o="[object Boolean]",s=gh()();e.exports=h(function(l){return typeof l=="boolean"?!0:l===null||typeof l!="object"?!1:s&&Symbol.toStringTag in l?a(l):n(l)===o},"isBoolean")}),A0e=Qe((i,e)=>{R();var t=Object.prototype.toString,r=BE()();r?(n=Symbol.prototype.toString,a=/^Symbol\(.*\)$/,o=h(function(s){return typeof s.valueOf()!="symbol"?!1:a.test(n.call(s))},"isRealSymbolObject"),e.exports=h(function(s){if(typeof s=="symbol")return!0;if(t.call(s)!=="[object Symbol]")return!1;try{return o(s)}catch{return!1}},"isSymbol")):e.exports=h(function(s){return!1},"isSymbol");var n,a,o}),I0e=Qe((i,e)=>{R();var t=typeof BigInt<"u"&&BigInt;e.exports=h(function(){return typeof t=="function"&&typeof BigInt=="function"&&typeof t(42)=="bigint"&&typeof BigInt(42)=="bigint"},"hasNativeBigInts")}),L0e=Qe((i,e)=>{R();var t=I0e()();t?(r=BigInt.prototype.valueOf,n=h(function(a){try{return r.call(a),!0}catch{}return!1},"tryBigIntObject"),e.exports=h(function(a){return a===null||typeof a>"u"||typeof a=="boolean"||typeof a=="string"||typeof a=="number"||typeof a=="symbol"||typeof a=="function"?!1:typeof a=="bigint"?!0:n(a)},"isBigInt")):e.exports=h(function(a){return!1},"isBigInt");var r,n}),D0e=Qe((i,e)=>{R();var t=OY(),r=T0e(),n=P0e(),a=A0e(),o=L0e();e.exports=h(function(s){if(s==null||typeof s!="object"&&typeof s!="function")return null;if(t(s))return"String";if(r(s))return"Number";if(n(s))return"Boolean";if(a(s))return"Symbol";if(o(s))return"BigInt"},"whichBoxedPrimitive")}),k0e=Qe((i,e)=>{R();var t=typeof WeakMap=="function"&&WeakMap.prototype?WeakMap:null,r=typeof WeakSet=="function"&&WeakSet.prototype?WeakSet:null,n;t||(n=h(function(s){return!1},"isWeakMap"));var a=t?t.prototype.has:null,o=r?r.prototype.has:null;!n&&!a&&(n=h(function(s){return!1},"isWeakMap")),e.exports=n||h(function(s){if(!s||typeof s!="object")return!1;try{if(a.call(s,a),o)try{o.call(s,o)}catch{return!0}return s instanceof t}catch{}return!1},"isWeakMap")}),R0e=Qe((i,e)=>{R();var t=Jo(),r=Va(),n=t("%WeakSet%",!0),a=r("WeakSet.prototype.has",!0);a?(o=r("WeakMap.prototype.has",!0),e.exports=h(function(s){if(!s||typeof s!="object")return!1;try{if(a(s,a),o)try{o(s,o)}catch{return!0}return s instanceof n}catch{}return!1},"isWeakSet")):e.exports=h(function(s){return!1},"isWeakSet");var o}),F0e=Qe((i,e)=>{R();var t=NY(),r=$Y(),n=k0e(),a=R0e();e.exports=h(function(o){if(o&&typeof o=="object"){if(t(o))return"Map";if(r(o))return"Set";if(n(o))return"WeakMap";if(a(o))return"WeakSet"}return!1},"whichCollection")}),z0e=Qe((i,e)=>{R();var t=Function.prototype.toString,r=typeof Reflect=="object"&&Reflect!==null&&Reflect.apply,n,a;if(typeof r=="function"&&typeof Object.defineProperty=="function")try{n=Object.defineProperty({},"length",{get:function(){throw a}}),a={},r(function(){throw 42},null,n)}catch(C){C!==a&&(r=null)}else r=null;var o=/^\s*class\b/,s=h(function(C){try{var E=t.call(C);return o.test(E)}catch{return!1}},"isES6ClassFunction"),l=h(function(C){try{return s(C)?!1:(t.call(C),!0)}catch{return!1}},"tryFunctionToStr"),u=Object.prototype.toString,c="[object Object]",p="[object Function]",d="[object GeneratorFunction]",m="[object HTMLAllCollection]",g="[object HTML document.all class]",b="[object HTMLCollection]",x=typeof Symbol=="function"&&!!Symbol.toStringTag,v=!(0 in[,]),w=h(function(){return!1},"isDocumentDotAll");typeof document=="object"&&(_=document.all,u.call(_)===u.call(document.all)&&(w=h(function(C){if((v||!C)&&(typeof C>"u"||typeof C=="object"))try{var E=u.call(C);return(E===m||E===g||E===b||E===c)&&C("")==null}catch{}return!1},"isDocumentDotAll")));var _;e.exports=h(r?function(C){if(w(C))return!0;if(!C||typeof C!="function"&&typeof C!="object")return!1;try{r(C,null,n)}catch(E){if(E!==a)return!1}return!s(C)&&l(C)}:function(C){if(w(C))return!0;if(!C||typeof C!="function"&&typeof C!="object")return!1;if(x)return l(C);if(s(C))return!1;var E=u.call(C);return E!==p&&E!==d&&!/^\[object HTML/.test(E)?!1:l(C)},"isCallable")}),B0e=Qe((i,e)=>{R();var t=z0e(),r=Object.prototype.toString,n=Object.prototype.hasOwnProperty,a=h(function(u,c,p){for(var d=0,m=u.length;d<m;d++)n.call(u,d)&&(p==null?c(u[d],d,u):c.call(p,u[d],d,u))},"forEachArray"),o=h(function(u,c,p){for(var d=0,m=u.length;d<m;d++)p==null?c(u.charAt(d),d,u):c.call(p,u.charAt(d),d,u)},"forEachString"),s=h(function(u,c,p){for(var d in u)n.call(u,d)&&(p==null?c(u[d],d,u):c.call(p,u[d],d,u))},"forEachObject"),l=h(function(u,c,p){if(!t(c))throw new TypeError("iterator must be a function");var d;arguments.length>=3&&(d=p),r.call(u)==="[object Array]"?a(u,c,d):typeof u=="string"?o(u,c,d):s(u,c,d)},"forEach");e.exports=l}),O0e=Qe((i,e)=>{R(),e.exports=["Float32Array","Float64Array","Int8Array","Int16Array","Int32Array","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","BigInt64Array","BigUint64Array"]}),N0e=Qe((i,e)=>{R();var t=O0e(),r=typeof globalThis>"u"?global:globalThis;e.exports=h(function(){for(var n=[],a=0;a<t.length;a++)typeof r[t[a]]=="function"&&(n[n.length]=t[a]);return n},"availableTypedArrays")}),$0e=Qe((i,e)=>{R();var t=B0e(),r=N0e(),n=ld(),a=Va(),o=$E(),s=a("Object.prototype.toString"),l=gh()(),u=typeof globalThis>"u"?global:globalThis,c=r(),p=a("String.prototype.slice"),d=Object.getPrototypeOf,m=a("Array.prototype.indexOf",!0)||h(function(v,w){for(var _=0;_<v.length;_+=1)if(v[_]===w)return _;return-1},"indexOf"),g={__proto__:null};l&&o&&d?t(c,function(v){var w=new u[v];if(Symbol.toStringTag in w){var _=d(w),C=o(_,Symbol.toStringTag);if(!C){var E=d(_);C=o(E,Symbol.toStringTag)}g["$"+v]=n(C.get)}}):t(c,function(v){var w=new u[v],_=w.slice||w.set;_&&(g["$"+v]=n(_))});var b=h(function(v){var w=!1;return t(g,function(_,C){if(!w)try{"$"+_(v)===C&&(w=p(C,1))}catch{}}),w},"tryAllTypedArrays"),x=h(function(v){var w=!1;return t(g,function(_,C){if(!w)try{_(v),w=p(C,1)}catch{}}),w},"tryAllSlices");e.exports=h(function(v){if(!v||typeof v!="object")return!1;if(!l){var w=p(s(v),8,-1);return m(c,w)>-1?w:w!=="Object"?!1:x(v)}return o?b(v):null},"whichTypedArray")}),U0e=Qe((i,e)=>{R();var t=Va(),r=t("ArrayBuffer.prototype.byteLength",!0),n=jY();e.exports=h(function(a){return n(a)?r?r(a):a.byteLength:NaN},"byteLength")}),V0e=Qe((i,e)=>{R();var t=p0e(),r=Va(),n=g0e(),a=Jo(),o=b0e(),s=zY(),l=S0e(),u=FY(),c=BY(),p=jY(),d=M0e(),m=C0e(),g=E0e(),b=zE(),x=D0e(),v=F0e(),w=$0e(),_=U0e(),C=r("SharedArrayBuffer.prototype.byteLength",!0),E=r("Date.prototype.getTime"),T=Object.getPrototypeOf,L=r("Object.prototype.toString"),D=a("%Set%",!0),B=r("Map.prototype.has",!0),A=r("Map.prototype.get",!0),k=r("Map.prototype.size",!0),$=r("Set.prototype.add",!0),O=r("Set.prototype.delete",!0),P=r("Set.prototype.has",!0),U=r("Set.prototype.size",!0);function G(Y,oe,xe,ge){for(var Te=o(Y),me;(me=Te.next())&&!me.done;)if(q(oe,me.value,xe,ge))return O(Y,me.value),!0;return!1}h(G,"setHasEqualElement");function K(Y){if(typeof Y>"u")return null;if(typeof Y!="object")return typeof Y=="symbol"?!1:typeof Y=="string"||typeof Y=="number"?+Y==+Y:!0}h(K,"findLooseMatchingPrimitives");function z(Y,oe,xe,ge,Te,me){var Q=K(xe);if(Q!=null)return Q;var Me=A(oe,Q),ve=t({},Te,{strict:!1});return typeof Me>"u"&&!B(oe,Q)||!q(ge,Me,ve,me)?!1:!B(Y,Q)&&q(ge,Me,ve,me)}h(z,"mapMightHaveLoosePrim");function V(Y,oe,xe){var ge=K(xe);return ge??(P(oe,ge)&&!P(Y,ge))}h(V,"setMightHaveLoosePrim");function j(Y,oe,xe,ge,Te,me){for(var Q=o(Y),Me,ve;(Me=Q.next())&&!Me.done;)if(ve=Me.value,q(xe,ve,Te,me)&&q(ge,A(oe,ve),Te,me))return O(Y,ve),!0;return!1}h(j,"mapHasEqualEntry");function q(Y,oe,xe,ge){var Te=xe||{};if(Te.strict?l(Y,oe):Y===oe)return!0;var me=x(Y),Q=x(oe);if(me!==Q)return!1;if(!Y||!oe||typeof Y!="object"&&typeof oe!="object")return Te.strict?l(Y,oe):Y==oe;var Me=ge.has(Y),ve=ge.has(oe),Ie;if(Me&&ve){if(ge.get(Y)===ge.get(oe))return!0}else Ie={};return Me||ge.set(Y,Ie),ve||ge.set(oe,Ie),J(Y,oe,Te,ge)}h(q,"internalDeepEqual");function ee(Y){return!Y||typeof Y!="object"||typeof Y.length!="number"||typeof Y.copy!="function"||typeof Y.slice!="function"||Y.length>0&&typeof Y[0]!="number"?!1:!!(Y.constructor&&Y.constructor.isBuffer&&Y.constructor.isBuffer(Y))}h(ee,"isBuffer");function ae(Y,oe,xe,ge){if(U(Y)!==U(oe))return!1;for(var Te=o(Y),me=o(oe),Q,Me,ve;(Q=Te.next())&&!Q.done;)if(Q.value&&typeof Q.value=="object")ve||(ve=new D),$(ve,Q.value);else if(!P(oe,Q.value)){if(xe.strict||!V(Y,oe,Q.value))return!1;ve||(ve=new D),$(ve,Q.value)}if(ve){for(;(Me=me.next())&&!Me.done;)if(Me.value&&typeof Me.value=="object"){if(!G(ve,Me.value,xe.strict,ge))return!1}else if(!xe.strict&&!P(Y,Me.value)&&!G(ve,Me.value,xe.strict,ge))return!1;return U(ve)===0}return!0}h(ae,"setEquiv");function N(Y,oe,xe,ge){if(k(Y)!==k(oe))return!1;for(var Te=o(Y),me=o(oe),Q,Me,ve,Ie,De,we;(Q=Te.next())&&!Q.done;)if(Ie=Q.value[0],De=Q.value[1],Ie&&typeof Ie=="object")ve||(ve=new D),$(ve,Ie);else if(we=A(oe,Ie),typeof we>"u"&&!B(oe,Ie)||!q(De,we,xe,ge)){if(xe.strict||!z(Y,oe,Ie,De,xe,ge))return!1;ve||(ve=new D),$(ve,Ie)}if(ve){for(;(Me=me.next())&&!Me.done;)if(Ie=Me.value[0],we=Me.value[1],Ie&&typeof Ie=="object"){if(!j(ve,Y,Ie,we,xe,ge))return!1}else if(!xe.strict&&(!Y.has(Ie)||!q(A(Y,Ie),we,xe,ge))&&!j(ve,Y,Ie,we,t({},xe,{strict:!1}),ge))return!1;return U(ve)===0}return!0}h(N,"mapEquiv");function J(Y,oe,xe,ge){var Te,me;if(typeof Y!=typeof oe||Y==null||oe==null||L(Y)!==L(oe)||u(Y)!==u(oe))return!1;var Q=c(Y),Me=c(oe);if(Q!==Me)return!1;var ve=Y instanceof Error,Ie=oe instanceof Error;if(ve!==Ie||(ve||Ie)&&(Y.name!==oe.name||Y.message!==oe.message))return!1;var De=m(Y),we=m(oe);if(De!==we||(De||we)&&(Y.source!==oe.source||n(Y)!==n(oe)))return!1;var Fe=d(Y),Ze=d(oe);if(Fe!==Ze||(Fe||Ze)&&E(Y)!==E(oe)||xe.strict&&T&&T(Y)!==T(oe))return!1;var yt=w(Y),ne=w(oe);if(yt!==ne)return!1;if(yt||ne){if(Y.length!==oe.length)return!1;for(Te=0;Te<Y.length;Te++)if(Y[Te]!==oe[Te])return!1;return!0}var W=ee(Y),_e=ee(oe);if(W!==_e)return!1;if(W||_e){if(Y.length!==oe.length)return!1;for(Te=0;Te<Y.length;Te++)if(Y[Te]!==oe[Te])return!1;return!0}var Re=p(Y),Ne=p(oe);if(Re!==Ne)return!1;if(Re||Ne)return _(Y)!==_(oe)?!1:typeof Uint8Array=="function"&&q(new Uint8Array(Y),new Uint8Array(oe),xe,ge);var ze=g(Y),xt=g(oe);if(ze!==xt)return!1;if(ze||xt)return C(Y)!==C(oe)?!1:typeof Uint8Array=="function"&&q(new Uint8Array(Y),new Uint8Array(oe),xe,ge);if(typeof Y!=typeof oe)return!1;var ot=b(Y),je=b(oe);if(ot.length!==je.length)return!1;for(ot.sort(),je.sort(),Te=ot.length-1;Te>=0;Te--)if(ot[Te]!=je[Te])return!1;for(Te=ot.length-1;Te>=0;Te--)if(me=ot[Te],!q(Y[me],oe[me],xe,ge))return!1;var He=v(Y),bt=v(oe);return He!==bt?!1:He==="Set"||bt==="Set"?ae(Y,oe,xe,ge):He==="Map"?N(Y,oe,xe,ge):!0}h(J,"objEquiv"),e.exports=h(function(Y,oe,xe){return q(Y,oe,xe,s())},"deepEqual")}),j0e=Qe(i=>{R(),Object.defineProperty(i,"__esModule",{value:!0});function e(N){return N&&N.__esModule?N:{default:N}}h(e,"_interopRequireDefault");var t=Object.defineProperty,r=h((N,J)=>t(N,"name",{value:J,configurable:!0}),"__name"),n=V0e(),a=e(n),o,s=(o=class{constructor(N){this.direction=!1,this.compareProperties=!0;var J,Y,oe;this.precision=10**-((J=N==null?void 0:N.precision)!=null?J:17),this.direction=(Y=N==null?void 0:N.direction)!=null?Y:!1,this.compareProperties=(oe=N==null?void 0:N.compareProperties)!=null?oe:!0}compare(N,J){if(N.type!==J.type||!u(N,J))return!1;switch(N.type){case"Point":return this.compareCoord(N.coordinates,J.coordinates);case"LineString":return this.compareLine(N.coordinates,J.coordinates);case"Polygon":return this.comparePolygon(N,J);case"GeometryCollection":return this.compareGeometryCollection(N,J);case"Feature":return this.compareFeature(N,J);case"FeatureCollection":return this.compareFeatureCollection(N,J);default:if(N.type.startsWith("Multi")){let Y=c(N),oe=c(J);return Y.every(xe=>oe.some(ge=>this.compare(xe,ge)))}}return!1}compareCoord(N,J){return N.length===J.length&&N.every((Y,oe)=>Math.abs(Y-J[oe])<this.precision)}compareLine(N,J,Y=0,oe=!1){if(!u(N,J))return!1;let xe=N,ge=J;if(oe&&!this.compareCoord(xe[0],ge[0])){let me=this.fixStartIndex(ge,xe);if(me)ge=me;else return!1}let Te=this.compareCoord(xe[Y],ge[Y]);return this.direction||Te?this.comparePath(xe,ge):this.compareCoord(xe[Y],ge[ge.length-(1+Y)])?this.comparePath(xe.slice().reverse(),ge):!1}fixStartIndex(N,J){let Y,oe=-1;for(let xe=0;xe<N.length;xe++)if(this.compareCoord(N[xe],J[0])){oe=xe;break}return oe>=0&&(Y=[].concat(N.slice(oe,N.length),N.slice(1,oe+1))),Y}comparePath(N,J){return N.every((Y,oe)=>this.compareCoord(Y,J[oe]))}comparePolygon(N,J){if(this.compareLine(N.coordinates[0],J.coordinates[0],1,!0)){let Y=N.coordinates.slice(1,N.coordinates.length),oe=J.coordinates.slice(1,J.coordinates.length);return Y.every(xe=>oe.some(ge=>this.compareLine(xe,ge,1,!0)))}return!1}compareGeometryCollection(N,J){return u(N.geometries,J.geometries)&&this.compareBBox(N,J)&&N.geometries.every((Y,oe)=>this.compare(Y,J.geometries[oe]))}compareFeature(N,J){return N.id===J.id&&(this.compareProperties?a.default.call(void 0,N.properties,J.properties):!0)&&this.compareBBox(N,J)&&this.compare(N.geometry,J.geometry)}compareFeatureCollection(N,J){return u(N.features,J.features)&&this.compareBBox(N,J)&&N.features.every((Y,oe)=>this.compare(Y,J.features[oe]))}compareBBox(N,J){return!N.bbox&&!J.bbox||(N.bbox&&J.bbox?this.compareCoord(N.bbox,J.bbox):!1)}},h(o,"_GeojsonEquality"),o);r(s,"GeojsonEquality");var l=s;function u(N,J){return N.coordinates?N.coordinates.length===J.coordinates.length:N.length===J.length}h(u,"sameLength"),r(u,"sameLength");function c(N){return N.coordinates.map(J=>({type:N.type.replace("Multi",""),coordinates:J}))}h(c,"explode"),r(c,"explode");var p=63710088e-1,d={centimeters:p*100,centimetres:p*100,degrees:360/(2*Math.PI),feet:p*3.28084,inches:p*39.37,kilometers:p/1e3,kilometres:p/1e3,meters:p,metres:p,miles:p/1609.344,millimeters:p*1e3,millimetres:p*1e3,nauticalmiles:p/1852,radians:1,yards:p*1.0936},m={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,nauticalmiles:29155334959812285e-23,millimeters:1e6,millimetres:1e6,yards:1.195990046};function g(N,J,Y={}){let oe={type:"Feature"};return(Y.id===0||Y.id)&&(oe.id=Y.id),Y.bbox&&(oe.bbox=Y.bbox),oe.properties=J||{},oe.geometry=N,oe}h(g,"feature"),r(g,"feature");function b(N,J,Y={}){switch(N){case"Point":return x(J).geometry;case"LineString":return C(J).geometry;case"Polygon":return w(J).geometry;case"MultiPoint":return D(J).geometry;case"MultiLineString":return L(J).geometry;case"MultiPolygon":return B(J).geometry;default:throw new Error(N+" is invalid")}}h(b,"geometry"),r(b,"geometry");function x(N,J,Y={}){if(!N)throw new Error("coordinates is required");if(!Array.isArray(N))throw new Error("coordinates must be an Array");if(N.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!j(N[0])||!j(N[1]))throw new Error("coordinates must contain numbers");return g({type:"Point",coordinates:N},J,Y)}h(x,"point"),r(x,"point");function v(N,J,Y={}){return T(N.map(oe=>x(oe,J)),Y)}h(v,"points"),r(v,"points");function w(N,J,Y={}){for(let oe of N){if(oe.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");if(oe[oe.length-1].length!==oe[0].length)throw new Error("First and last Position are not equivalent.");for(let xe=0;xe<oe[oe.length-1].length;xe++)if(oe[oe.length-1][xe]!==oe[0][xe])throw new Error("First and last Position are not equivalent.")}return g({type:"Polygon",coordinates:N},J,Y)}h(w,"polygon"),r(w,"polygon");function _(N,J,Y={}){return T(N.map(oe=>w(oe,J)),Y)}h(_,"polygons"),r(_,"polygons");function C(N,J,Y={}){if(N.length<2)throw new Error("coordinates must be an array of two or more positions");return g({type:"LineString",coordinates:N},J,Y)}h(C,"lineString"),r(C,"lineString");function E(N,J,Y={}){return T(N.map(oe=>C(oe,J)),Y)}h(E,"lineStrings"),r(E,"lineStrings");function T(N,J={}){let Y={type:"FeatureCollection"};return J.id&&(Y.id=J.id),J.bbox&&(Y.bbox=J.bbox),Y.features=N,Y}h(T,"featureCollection"),r(T,"featureCollection");function L(N,J,Y={}){return g({type:"MultiLineString",coordinates:N},J,Y)}h(L,"multiLineString"),r(L,"multiLineString");function D(N,J,Y={}){return g({type:"MultiPoint",coordinates:N},J,Y)}h(D,"multiPoint"),r(D,"multiPoint");function B(N,J,Y={}){return g({type:"MultiPolygon",coordinates:N},J,Y)}h(B,"multiPolygon"),r(B,"multiPolygon");function A(N,J,Y={}){return g({type:"GeometryCollection",geometries:N},J,Y)}h(A,"geometryCollection"),r(A,"geometryCollection");function k(N,J=0){if(J&&!(J>=0))throw new Error("precision must be a positive number");let Y=Math.pow(10,J||0);return Math.round(N*Y)/Y}h(k,"round"),r(k,"round");function $(N,J="kilometers"){let Y=d[J];if(!Y)throw new Error(J+" units is invalid");return N*Y}h($,"radiansToLength"),r($,"radiansToLength");function O(N,J="kilometers"){let Y=d[J];if(!Y)throw new Error(J+" units is invalid");return N/Y}h(O,"lengthToRadians"),r(O,"lengthToRadians");function P(N,J){return G(O(N,J))}h(P,"lengthToDegrees"),r(P,"lengthToDegrees");function U(N){let J=N%360;return J<0&&(J+=360),J}h(U,"bearingToAzimuth"),r(U,"bearingToAzimuth");function G(N){return N%(2*Math.PI)*180/Math.PI}h(G,"radiansToDegrees"),r(G,"radiansToDegrees");function K(N){return N%360*Math.PI/180}h(K,"degreesToRadians"),r(K,"degreesToRadians");function z(N,J="kilometers",Y="kilometers"){if(!(N>=0))throw new Error("length must be a positive number");return $(O(N,J),Y)}h(z,"convertLength"),r(z,"convertLength");function V(N,J="meters",Y="kilometers"){if(!(N>=0))throw new Error("area must be a positive number");let oe=m[J];if(!oe)throw new Error("invalid original units");let xe=m[Y];if(!xe)throw new Error("invalid final units");return N/oe*xe}h(V,"convertArea"),r(V,"convertArea");function j(N){return!isNaN(N)&&N!==null&&!Array.isArray(N)}h(j,"isNumber"),r(j,"isNumber");function q(N){return N!==null&&typeof N=="object"&&!Array.isArray(N)}h(q,"isObject"),r(q,"isObject");function ee(N){if(!N)throw new Error("bbox is required");if(!Array.isArray(N))throw new Error("bbox must be an Array");if(N.length!==4&&N.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");N.forEach(J=>{if(!j(J))throw new Error("bbox must only contain numbers")})}h(ee,"validateBBox"),r(ee,"validateBBox");function ae(N){if(!N)throw new Error("id is required");if(["string","number"].indexOf(typeof N)===-1)throw new Error("id must be a number or a string")}h(ae,"validateId"),r(ae,"validateId"),i.GeojsonEquality=l,i.areaFactors=m,i.bearingToAzimuth=U,i.convertArea=V,i.convertLength=z,i.degreesToRadians=K,i.earthRadius=p,i.factors=d,i.feature=g,i.featureCollection=T,i.geometry=b,i.geometryCollection=A,i.isNumber=j,i.isObject=q,i.lengthToDegrees=P,i.lengthToRadians=O,i.lineString=C,i.lineStrings=E,i.multiLineString=L,i.multiPoint=D,i.multiPolygon=B,i.point=x,i.points=v,i.polygon=w,i.polygons=_,i.radiansToDegrees=G,i.radiansToLength=$,i.round=k,i.validateBBox=ee,i.validateId=ae}),H0e=Qe(i=>{R(),Object.defineProperty(i,"__esModule",{value:!0});var e=Object.defineProperty,t=h((E,T)=>e(E,"name",{value:T,configurable:!0}),"__name"),r=j0e();function n(E,T,L){if(E!==null)for(var D,B,A,k,$,O,P,U=0,G=0,K,z=E.type,V=z==="FeatureCollection",j=z==="Feature",q=V?E.features.length:1,ee=0;ee<q;ee++){P=V?E.features[ee].geometry:j?E.geometry:E,K=P?P.type==="GeometryCollection":!1,$=K?P.geometries.length:1;for(var ae=0;ae<$;ae++){var N=0,J=0;if(k=K?P.geometries[ae]:P,k!==null){O=k.coordinates;var Y=k.type;switch(U=L&&(Y==="Polygon"||Y==="MultiPolygon")?1:0,Y){case null:break;case"Point":if(T(O,G,ee,N,J)===!1)return!1;G++,N++;break;case"LineString":case"MultiPoint":for(D=0;D<O.length;D++){if(T(O[D],G,ee,N,J)===!1)return!1;G++,Y==="MultiPoint"&&N++}Y==="LineString"&&N++;break;case"Polygon":case"MultiLineString":for(D=0;D<O.length;D++){for(B=0;B<O[D].length-U;B++){if(T(O[D][B],G,ee,N,J)===!1)return!1;G++}Y==="MultiLineString"&&N++,Y==="Polygon"&&J++}Y==="Polygon"&&N++;break;case"MultiPolygon":for(D=0;D<O.length;D++){for(J=0,B=0;B<O[D].length;B++){for(A=0;A<O[D][B].length-U;A++){if(T(O[D][B][A],G,ee,N,J)===!1)return!1;G++}J++}N++}break;case"GeometryCollection":for(D=0;D<k.geometries.length;D++)if(n(k.geometries[D],T,L)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}h(n,"coordEach"),t(n,"coordEach");function a(E,T,L,D){var B=L;return n(E,function(A,k,$,O,P){k===0&&L===void 0?B=A:B=T(B,A,k,$,O,P)},D),B}h(a,"coordReduce"),t(a,"coordReduce");function o(E,T){var L;switch(E.type){case"FeatureCollection":for(L=0;L<E.features.length&&T(E.features[L].properties,L)!==!1;L++);break;case"Feature":T(E.properties,0);break}}h(o,"propEach"),t(o,"propEach");function s(E,T,L){var D=L;return o(E,function(B,A){A===0&&L===void 0?D=B:D=T(D,B,A)}),D}h(s,"propReduce"),t(s,"propReduce");function l(E,T){if(E.type==="Feature")T(E,0);else if(E.type==="FeatureCollection")for(var L=0;L<E.features.length&&T(E.features[L],L)!==!1;L++);}h(l,"featureEach"),t(l,"featureEach");function u(E,T,L){var D=L;return l(E,function(B,A){A===0&&L===void 0?D=B:D=T(D,B,A)}),D}h(u,"featureReduce"),t(u,"featureReduce");function c(E){var T=[];return n(E,function(L){T.push(L)}),T}h(c,"coordAll"),t(c,"coordAll");function p(E,T){var L,D,B,A,k,$,O,P,U,G,K=0,z=E.type==="FeatureCollection",V=E.type==="Feature",j=z?E.features.length:1;for(L=0;L<j;L++){for($=z?E.features[L].geometry:V?E.geometry:E,P=z?E.features[L].properties:V?E.properties:{},U=z?E.features[L].bbox:V?E.bbox:void 0,G=z?E.features[L].id:V?E.id:void 0,O=$?$.type==="GeometryCollection":!1,k=O?$.geometries.length:1,B=0;B<k;B++){if(A=O?$.geometries[B]:$,A===null){if(T(null,K,P,U,G)===!1)return!1;continue}switch(A.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(T(A,K,P,U,G)===!1)return!1;break}case"GeometryCollection":{for(D=0;D<A.geometries.length;D++)if(T(A.geometries[D],K,P,U,G)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}K++}}h(p,"geomEach"),t(p,"geomEach");function d(E,T,L){var D=L;return p(E,function(B,A,k,$,O){A===0&&L===void 0?D=B:D=T(D,B,A,k,$,O)}),D}h(d,"geomReduce"),t(d,"geomReduce");function m(E,T){p(E,function(L,D,B,A,k){var $=L===null?null:L.type;switch($){case null:case"Point":case"LineString":case"Polygon":return T(r.feature.call(void 0,L,B,{bbox:A,id:k}),D,0)===!1?!1:void 0}var O;switch($){case"MultiPoint":O="Point";break;case"MultiLineString":O="LineString";break;case"MultiPolygon":O="Polygon";break}for(var P=0;P<L.coordinates.length;P++){var U=L.coordinates[P],G={type:O,coordinates:U};if(T(r.feature.call(void 0,G,B),D,P)===!1)return!1}})}h(m,"flattenEach"),t(m,"flattenEach");function g(E,T,L){var D=L;return m(E,function(B,A,k){A===0&&k===0&&L===void 0?D=B:D=T(D,B,A,k)}),D}h(g,"flattenReduce"),t(g,"flattenReduce");function b(E,T){m(E,function(L,D,B){var A=0;if(L.geometry){var k=L.geometry.type;if(!(k==="Point"||k==="MultiPoint")){var $,O=0,P=0,U=0;if(n(L,function(G,K,z,V,j){if($===void 0||D>O||V>P||j>U){$=G,O=D,P=V,U=j,A=0;return}var q=r.lineString.call(void 0,[$,G],L.properties);if(T(q,D,B,j,A)===!1)return!1;A++,$=G})===!1)return!1}}})}h(b,"segmentEach"),t(b,"segmentEach");function x(E,T,L){var D=L,B=!1;return b(E,function(A,k,$,O,P){B===!1&&L===void 0?D=A:D=T(D,A,k,$,O,P),B=!0}),D}h(x,"segmentReduce"),t(x,"segmentReduce");function v(E,T){if(!E)throw new Error("geojson is required");m(E,function(L,D,B){if(L.geometry!==null){var A=L.geometry.type,k=L.geometry.coordinates;switch(A){case"LineString":if(T(L,D,B,0,0)===!1)return!1;break;case"Polygon":for(var $=0;$<k.length;$++)if(T(r.lineString.call(void 0,k[$],L.properties),D,B,$)===!1)return!1;break}}})}h(v,"lineEach"),t(v,"lineEach");function w(E,T,L){var D=L;return v(E,function(B,A,k,$){A===0&&L===void 0?D=B:D=T(D,B,A,k,$)}),D}h(w,"lineReduce"),t(w,"lineReduce");function _(E,T){if(T=T||{},!r.isObject.call(void 0,T))throw new Error("options is invalid");var L=T.featureIndex||0,D=T.multiFeatureIndex||0,B=T.geometryIndex||0,A=T.segmentIndex||0,k=T.properties,$;switch(E.type){case"FeatureCollection":L<0&&(L=E.features.length+L),k=k||E.features[L].properties,$=E.features[L].geometry;break;case"Feature":k=k||E.properties,$=E.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":$=E;break;default:throw new Error("geojson is invalid")}if($===null)return null;var O=$.coordinates;switch($.type){case"Point":case"MultiPoint":return null;case"LineString":return A<0&&(A=O.length+A-1),r.lineString.call(void 0,[O[A],O[A+1]],k,T);case"Polygon":return B<0&&(B=O.length+B),A<0&&(A=O[B].length+A-1),r.lineString.call(void 0,[O[B][A],O[B][A+1]],k,T);case"MultiLineString":return D<0&&(D=O.length+D),A<0&&(A=O[D].length+A-1),r.lineString.call(void 0,[O[D][A],O[D][A+1]],k,T);case"MultiPolygon":return D<0&&(D=O.length+D),B<0&&(B=O[D].length+B),A<0&&(A=O[D][B].length-A-1),r.lineString.call(void 0,[O[D][B][A],O[D][B][A+1]],k,T)}throw new Error("geojson is invalid")}h(_,"findSegment"),t(_,"findSegment");function C(E,T){if(T=T||{},!r.isObject.call(void 0,T))throw new Error("options is invalid");var L=T.featureIndex||0,D=T.multiFeatureIndex||0,B=T.geometryIndex||0,A=T.coordIndex||0,k=T.properties,$;switch(E.type){case"FeatureCollection":L<0&&(L=E.features.length+L),k=k||E.features[L].properties,$=E.features[L].geometry;break;case"Feature":k=k||E.properties,$=E.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":$=E;break;default:throw new Error("geojson is invalid")}if($===null)return null;var O=$.coordinates;switch($.type){case"Point":return r.point.call(void 0,O,k,T);case"MultiPoint":return D<0&&(D=O.length+D),r.point.call(void 0,O[D],k,T);case"LineString":return A<0&&(A=O.length+A),r.point.call(void 0,O[A],k,T);case"Polygon":return B<0&&(B=O.length+B),A<0&&(A=O[B].length+A),r.point.call(void 0,O[B][A],k,T);case"MultiLineString":return D<0&&(D=O.length+D),A<0&&(A=O[D].length+A),r.point.call(void 0,O[D][A],k,T);case"MultiPolygon":return D<0&&(D=O.length+D),B<0&&(B=O[D].length+B),A<0&&(A=O[D][B].length-A),r.point.call(void 0,O[D][B][A],k,T)}throw new Error("geojson is invalid")}h(C,"findPoint"),t(C,"findPoint"),i.coordAll=c,i.coordEach=n,i.coordReduce=a,i.featureEach=l,i.featureReduce=u,i.findPoint=C,i.findSegment=_,i.flattenEach=m,i.flattenReduce=g,i.geomEach=p,i.geomReduce=d,i.lineEach=v,i.lineReduce=w,i.propEach=o,i.propReduce=s,i.segmentEach=b,i.segmentReduce=x}),G0e=Qe(i=>{R(),Object.defineProperty(i,"__esModule",{value:!0});var e=Object.defineProperty,t=h((o,s)=>e(o,"name",{value:s,configurable:!0}),"__name"),r=H0e();function n(o,s={}){if(o.bbox!=null&&s.recompute!==!0)return o.bbox;let l=[1/0,1/0,-1/0,-1/0];return r.coordEach.call(void 0,o,u=>{l[0]>u[0]&&(l[0]=u[0]),l[1]>u[1]&&(l[1]=u[1]),l[2]<u[0]&&(l[2]=u[0]),l[3]<u[1]&&(l[3]=u[1])}),l}h(n,"bbox"),t(n,"bbox");var a=n;i.bbox=n,i.default=a}),W0e=Qe((i,e)=>{R();var t=e0e(),r=TY(),n=t0e(),a=G0e().default,o=n.featureEach;n.coordEach,r.polygon;var s=r.featureCollection;function l(u){var c=new t(u);return c.insert=function(p){if(p.type!=="Feature")throw new Error("invalid feature");return p.bbox=p.bbox?p.bbox:a(p),t.prototype.insert.call(this,p)},c.load=function(p){var d=[];return Array.isArray(p)?p.forEach(function(m){if(m.type!=="Feature")throw new Error("invalid features");m.bbox=m.bbox?m.bbox:a(m),d.push(m)}):o(p,function(m){if(m.type!=="Feature")throw new Error("invalid features");m.bbox=m.bbox?m.bbox:a(m),d.push(m)}),t.prototype.load.call(this,d)},c.remove=function(p,d){if(p.type!=="Feature")throw new Error("invalid feature");return p.bbox=p.bbox?p.bbox:a(p),t.prototype.remove.call(this,p,d)},c.clear=function(){return t.prototype.clear.call(this)},c.search=function(p){var d=t.prototype.search.call(this,this.toBBox(p));return s(d)},c.collides=function(p){return t.prototype.collides.call(this,this.toBBox(p))},c.all=function(){var p=t.prototype.all.call(this);return s(p)},c.toJSON=function(){return t.prototype.toJSON.call(this)},c.fromJSON=function(p){return t.prototype.fromJSON.call(this,p)},c.toBBox=function(p){var d;if(p.bbox)d=p.bbox;else if(Array.isArray(p)&&p.length===4)d=p;else if(Array.isArray(p)&&p.length===6)d=[p[0],p[1],p[3],p[4]];else if(p.type==="Feature")d=a(p);else if(p.type==="FeatureCollection")d=a(p);else throw new Error("invalid geojson");return{minX:d[0],minY:d[1],maxX:d[2],maxY:d[3]}},c}h(l,"geojsonRbush"),e.exports=l,e.exports.default=l}),hg=Qe((i,e)=>{R();var t=h(function(){this._tweens={},this._tweensAddedDuringUpdate={}},"_Group");t.prototype={getAll:function(){return Object.keys(this._tweens).map((function(n){return this._tweens[n]}).bind(this))},removeAll:function(){this._tweens={}},add:function(n){this._tweens[n.getId()]=n,this._tweensAddedDuringUpdate[n.getId()]=n},remove:function(n){delete this._tweens[n.getId()],delete this._tweensAddedDuringUpdate[n.getId()]},update:function(n,a){var o=Object.keys(this._tweens);if(o.length===0)return!1;for(n=n!==void 0?n:r.now();o.length>0;){this._tweensAddedDuringUpdate={};for(var s=0;s<o.length;s++){var l=this._tweens[o[s]];l&&l.update(n)===!1&&(l._isPlaying=!1,a||delete this._tweens[o[s]])}o=Object.keys(this._tweensAddedDuringUpdate)}return!0}};var r=new t;r.Group=t,r._nextId=0,r.nextId=function(){return r._nextId++},typeof self>"u"&&typeof hr<"u"&&hr.hrtime?r.now=function(){var n=hr.hrtime();return n[0]*1e3+n[1]/1e6}:typeof self<"u"&&self.performance!==void 0&&self.performance.now!==void 0?r.now=self.performance.now.bind(self.performance):Date.now!==void 0?r.now=Date.now:r.now=function(){return new Date().getTime()},r.Tween=function(n,a){this._object=n,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._repeat=0,this._repeatDelayTime=void 0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=null,this._easingFunction=r.Easing.Linear.None,this._interpolationFunction=r.Interpolation.Linear,this._chainedTweens=[],this._onStartCallback=null,this._onStartCallbackFired=!1,this._onUpdateCallback=null,this._onRepeatCallback=null,this._onCompleteCallback=null,this._onStopCallback=null,this._group=a||r,this._id=r.nextId()},r.Tween.prototype={getId:function(){return this._id},isPlaying:function(){return this._isPlaying},to:function(n,a){return this._valuesEnd=n,a!==void 0&&(this._duration=a),this},duration:h(function(n){return this._duration=n,this},"duration"),start:function(n){this._group.add(this),this._isPlaying=!0,this._onStartCallbackFired=!1,this._startTime=n!==void 0?typeof n=="string"?r.now()+parseFloat(n):n:r.now(),this._startTime+=this._delayTime;for(var a in this._valuesEnd){if(this._valuesEnd[a]instanceof Array){if(this._valuesEnd[a].length===0)continue;this._valuesEnd[a]=[this._object[a]].concat(this._valuesEnd[a])}this._object[a]!==void 0&&(this._valuesStart[a]=this._object[a],this._valuesStart[a]instanceof Array||(this._valuesStart[a]*=1),this._valuesStartRepeat[a]=this._valuesStart[a]||0)}return this},stop:function(){return this._isPlaying?(this._group.remove(this),this._isPlaying=!1,this._onStopCallback!==null&&this._onStopCallback(this._object),this.stopChainedTweens(),this):this},end:function(){return this.update(1/0),this},stopChainedTweens:function(){for(var n=0,a=this._chainedTweens.length;n<a;n++)this._chainedTweens[n].stop()},group:function(n){return this._group=n,this},delay:function(n){return this._delayTime=n,this},repeat:function(n){return this._repeat=n,this},repeatDelay:function(n){return this._repeatDelayTime=n,this},yoyo:function(n){return this._yoyo=n,this},easing:function(n){return this._easingFunction=n,this},interpolation:function(n){return this._interpolationFunction=n,this},chain:function(){return this._chainedTweens=arguments,this},onStart:function(n){return this._onStartCallback=n,this},onUpdate:function(n){return this._onUpdateCallback=n,this},onRepeat:h(function(n){return this._onRepeatCallback=n,this},"onRepeat"),onComplete:function(n){return this._onCompleteCallback=n,this},onStop:function(n){return this._onStopCallback=n,this},update:function(n){var a,o,s;if(n<this._startTime)return!0;this._onStartCallbackFired===!1&&(this._onStartCallback!==null&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),o=(n-this._startTime)/this._duration,o=this._duration===0||o>1?1:o,s=this._easingFunction(o);for(a in this._valuesEnd)if(this._valuesStart[a]!==void 0){var l=this._valuesStart[a]||0,u=this._valuesEnd[a];u instanceof Array?this._object[a]=this._interpolationFunction(u,s):(typeof u=="string"&&(u.charAt(0)==="+"||u.charAt(0)==="-"?u=l+parseFloat(u):u=parseFloat(u)),typeof u=="number"&&(this._object[a]=l+(u-l)*s))}if(this._onUpdateCallback!==null&&this._onUpdateCallback(this._object,o),o===1)if(this._repeat>0){isFinite(this._repeat)&&this._repeat--;for(a in this._valuesStartRepeat){if(typeof this._valuesEnd[a]=="string"&&(this._valuesStartRepeat[a]=this._valuesStartRepeat[a]+parseFloat(this._valuesEnd[a])),this._yoyo){var c=this._valuesStartRepeat[a];this._valuesStartRepeat[a]=this._valuesEnd[a],this._valuesEnd[a]=c}this._valuesStart[a]=this._valuesStartRepeat[a]}return this._yoyo&&(this._reversed=!this._reversed),this._repeatDelayTime!==void 0?this._startTime=n+this._repeatDelayTime:this._startTime=n+this._delayTime,this._onRepeatCallback!==null&&this._onRepeatCallback(this._object),!0}else{this._onCompleteCallback!==null&&this._onCompleteCallback(this._object);for(var p=0,d=this._chainedTweens.length;p<d;p++)this._chainedTweens[p].start(this._startTime+this._duration);return!1}return!0}},r.Easing={Linear:{None:function(n){return n}},Quadratic:{In:function(n){return n*n},Out:function(n){return n*(2-n)},InOut:function(n){return(n*=2)<1?.5*n*n:-.5*(--n*(n-2)-1)}},Cubic:{In:function(n){return n*n*n},Out:function(n){return--n*n*n+1},InOut:function(n){return(n*=2)<1?.5*n*n*n:.5*((n-=2)*n*n+2)}},Quartic:{In:function(n){return n*n*n*n},Out:function(n){return 1- --n*n*n*n},InOut:function(n){return(n*=2)<1?.5*n*n*n*n:-.5*((n-=2)*n*n*n-2)}},Quintic:{In:function(n){return n*n*n*n*n},Out:function(n){return--n*n*n*n*n+1},InOut:function(n){return(n*=2)<1?.5*n*n*n*n*n:.5*((n-=2)*n*n*n*n+2)}},Sinusoidal:{In:function(n){return 1-Math.cos(n*Math.PI/2)},Out:function(n){return Math.sin(n*Math.PI/2)},InOut:function(n){return .5*(1-Math.cos(Math.PI*n))}},Exponential:{In:function(n){return n===0?0:Math.pow(1024,n-1)},Out:function(n){return n===1?1:1-Math.pow(2,-10*n)},InOut:function(n){return n===0?0:n===1?1:(n*=2)<1?.5*Math.pow(1024,n-1):.5*(-Math.pow(2,-10*(n-1))+2)}},Circular:{In:function(n){return 1-Math.sqrt(1-n*n)},Out:function(n){return Math.sqrt(1- --n*n)},InOut:function(n){return(n*=2)<1?-.5*(Math.sqrt(1-n*n)-1):.5*(Math.sqrt(1-(n-=2)*n)+1)}},Elastic:{In:function(n){return n===0?0:n===1?1:-Math.pow(2,10*(n-1))*Math.sin((n-1.1)*5*Math.PI)},Out:function(n){return n===0?0:n===1?1:Math.pow(2,-10*n)*Math.sin((n-.1)*5*Math.PI)+1},InOut:function(n){return n===0?0:n===1?1:(n*=2,n<1?-.5*Math.pow(2,10*(n-1))*Math.sin((n-1.1)*5*Math.PI):.5*Math.pow(2,-10*(n-1))*Math.sin((n-1.1)*5*Math.PI)+1)}},Back:{In:function(n){var a=1.70158;return n*n*((a+1)*n-a)},Out:function(n){var a=1.70158;return--n*n*((a+1)*n+a)+1},InOut:function(n){var a=2.5949095;return(n*=2)<1?.5*(n*n*((a+1)*n-a)):.5*((n-=2)*n*((a+1)*n+a)+2)}},Bounce:{In:function(n){return 1-r.Easing.Bounce.Out(1-n)},Out:function(n){return n<1/2.75?7.5625*n*n:n<2/2.75?7.5625*(n-=1.5/2.75)*n+.75:n<2.5/2.75?7.5625*(n-=2.25/2.75)*n+.9375:7.5625*(n-=2.625/2.75)*n+.984375},InOut:function(n){return n<.5?r.Easing.Bounce.In(n*2)*.5:r.Easing.Bounce.Out(n*2-1)*.5+.5}}},r.Interpolation={Linear:function(n,a){var o=n.length-1,s=o*a,l=Math.floor(s),u=r.Interpolation.Utils.Linear;return a<0?u(n[0],n[1],s):a>1?u(n[o],n[o-1],o-s):u(n[l],n[l+1>o?o:l+1],s-l)},Bezier:function(n,a){for(var o=0,s=n.length-1,l=Math.pow,u=r.Interpolation.Utils.Bernstein,c=0;c<=s;c++)o+=l(1-a,s-c)*l(a,c)*n[c]*u(s,c);return o},CatmullRom:function(n,a){var o=n.length-1,s=o*a,l=Math.floor(s),u=r.Interpolation.Utils.CatmullRom;return n[0]===n[o]?(a<0&&(l=Math.floor(s=o*(1+a))),u(n[(l-1+o)%o],n[l],n[(l+1)%o],n[(l+2)%o],s-l)):a<0?n[0]-(u(n[0],n[0],n[1],n[1],-s)-n[0]):a>1?n[o]-(u(n[o],n[o],n[o-1],n[o-1],s-o)-n[o]):u(n[l?l-1:0],n[l],n[o<l+1?o:l+1],n[o<l+2?o:l+2],s-l)},Utils:{Linear:function(n,a,o){return(a-n)*o+n},Bernstein:function(n,a){var o=r.Interpolation.Utils.Factorial;return o(n)/o(a)/o(n-a)},Factorial:function(){var n=[1];return function(a){var o=1;if(n[a])return n[a];for(var s=a;s>1;s--)o*=s;return n[a]=o,o}}(),CatmullRom:function(n,a,o,s,l){var u=(o-n)*.5,c=(s-a)*.5,p=l*l,d=l*p;return(2*a-2*o+u+c)*d+(-3*a+3*o-2*u-c)*p+u*l+a}}},function(n){typeof define=="function"&&define.amd?define([],function(){return r}):typeof e<"u"&&typeof i=="object"?e.exports=r:n!==void 0&&(n.TWEEN=r)}(i)}),X0e=Qe((i,e)=>{R();var t=200,r="__lodash_hash_undefined__",n=800,a=16,o=9007199254740991,s="[object Arguments]",l="[object Array]",u="[object AsyncFunction]",c="[object Boolean]",p="[object Date]",d="[object Error]",m="[object Function]",g="[object GeneratorFunction]",b="[object Map]",x="[object Number]",v="[object Null]",w="[object Object]",_="[object Proxy]",C="[object RegExp]",E="[object Set]",T="[object String]",L="[object Undefined]",D="[object WeakMap]",B="[object ArrayBuffer]",A="[object DataView]",k="[object Float32Array]",$="[object Float64Array]",O="[object Int8Array]",P="[object Int16Array]",U="[object Int32Array]",G="[object Uint8Array]",K="[object Uint8ClampedArray]",z="[object Uint16Array]",V="[object Uint32Array]",j=/[\\^$.*+?()[\]{}|]/g,q=/^\[object .+?Constructor\]$/,ee=/^(?:0|[1-9]\d*)$/,ae={};ae[k]=ae[$]=ae[O]=ae[P]=ae[U]=ae[G]=ae[K]=ae[z]=ae[V]=!0,ae[s]=ae[l]=ae[B]=ae[c]=ae[A]=ae[p]=ae[d]=ae[m]=ae[b]=ae[x]=ae[w]=ae[C]=ae[E]=ae[T]=ae[D]=!1;var N=typeof global=="object"&&global&&global.Object===Object&&global,J=typeof self=="object"&&self&&self.Object===Object&&self,Y=N||J||Function("return this")(),oe=typeof i=="object"&&i&&!i.nodeType&&i,xe=oe&&typeof e=="object"&&e&&!e.nodeType&&e,ge=xe&&xe.exports===oe,Te=ge&&N.process,me=function(){try{var re=xe&&xe.require&&xe.require("util").types;return re||Te&&Te.binding&&Te.binding("util")}catch{}}(),Q=me&&me.isTypedArray;function Me(re,pe,Ae){switch(Ae.length){case 0:return re.call(pe);case 1:return re.call(pe,Ae[0]);case 2:return re.call(pe,Ae[0],Ae[1]);case 3:return re.call(pe,Ae[0],Ae[1],Ae[2])}return re.apply(pe,Ae)}h(Me,"apply");function ve(re,pe){for(var Ae=-1,ft=Array(re);++Ae<re;)ft[Ae]=pe(Ae);return ft}h(ve,"baseTimes");function Ie(re){return function(pe){return re(pe)}}h(Ie,"baseUnary");function De(re,pe){return re==null?void 0:re[pe]}h(De,"getValue");function we(re,pe){return function(Ae){return re(pe(Ae))}}h(we,"overArg");var Fe=Array.prototype,Ze=Function.prototype,yt=Object.prototype,ne=Y["__core-js_shared__"],W=Ze.toString,_e=yt.hasOwnProperty,Re=function(){var re=/[^.]+$/.exec(ne&&ne.keys&&ne.keys.IE_PROTO||"");return re?"Symbol(src)_1."+re:""}(),Ne=yt.toString,ze=W.call(Object),xt=RegExp("^"+W.call(_e).replace(j,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ot=ge?Y.Buffer:void 0,je=Y.Symbol,He=Y.Uint8Array,bt=ot?ot.allocUnsafe:void 0,Xe=we(Object.getPrototypeOf,Object),ti=Object.create,At=yt.propertyIsEnumerable,ue=Fe.splice,he=je?je.toStringTag:void 0,We=function(){try{var re=f(Object,"defineProperty");return re({},"",{}),re}catch{}}(),pt=ot?ot.isBuffer:void 0,ut=Math.max,ct=Date.now,ce=f(Y,"Map"),et=f(Object,"create"),be=function(){function re(){}return h(re,"object"),function(pe){if(!So(pe))return{};if(ti)return ti(pe);re.prototype=pe;var Ae=new re;return re.prototype=void 0,Ae}}();function Ge(re){var pe=-1,Ae=re==null?0:re.length;for(this.clear();++pe<Ae;){var ft=re[pe];this.set(ft[0],ft[1])}}h(Ge,"Hash");function tt(){this.__data__=et?et(null):{},this.size=0}h(tt,"hashClear");function Ht(re){var pe=this.has(re)&&delete this.__data__[re];return this.size-=pe?1:0,pe}h(Ht,"hashDelete");function Nt(re){var pe=this.__data__;if(et){var Ae=pe[re];return Ae===r?void 0:Ae}return _e.call(pe,re)?pe[re]:void 0}h(Nt,"hashGet");function Mi(re){var pe=this.__data__;return et?pe[re]!==void 0:_e.call(pe,re)}h(Mi,"hashHas");function ar(re,pe){var Ae=this.__data__;return this.size+=this.has(re)?0:1,Ae[re]=et&&pe===void 0?r:pe,this}h(ar,"hashSet"),Ge.prototype.clear=tt,Ge.prototype.delete=Ht,Ge.prototype.get=Nt,Ge.prototype.has=Mi,Ge.prototype.set=ar;function Ut(re){var pe=-1,Ae=re==null?0:re.length;for(this.clear();++pe<Ae;){var ft=re[pe];this.set(ft[0],ft[1])}}h(Ut,"ListCache");function Ci(){this.__data__=[],this.size=0}h(Ci,"listCacheClear");function pr(re){var pe=this.__data__,Ae=Tt(pe,re);if(Ae<0)return!1;var ft=pe.length-1;return Ae==ft?pe.pop():ue.call(pe,Ae,1),--this.size,!0}h(pr,"listCacheDelete");function Pn(re){var pe=this.__data__,Ae=Tt(pe,re);return Ae<0?void 0:pe[Ae][1]}h(Pn,"listCacheGet");function ga(re){return Tt(this.__data__,re)>-1}h(ga,"listCacheHas");function cn(re,pe){var Ae=this.__data__,ft=Tt(Ae,re);return ft<0?(++this.size,Ae.push([re,pe])):Ae[ft][1]=pe,this}h(cn,"listCacheSet"),Ut.prototype.clear=Ci,Ut.prototype.delete=pr,Ut.prototype.get=Pn,Ut.prototype.has=ga,Ut.prototype.set=cn;function Gr(re){var pe=-1,Ae=re==null?0:re.length;for(this.clear();++pe<Ae;){var ft=re[pe];this.set(ft[0],ft[1])}}h(Gr,"MapCache");function An(){this.size=0,this.__data__={hash:new Ge,map:new(ce||Ut),string:new Ge}}h(An,"mapCacheClear");function Yn(re){var pe=Ga(this,re).delete(re);return this.size-=pe?1:0,pe}h(Yn,"mapCacheDelete");function ya(re){return Ga(this,re).get(re)}h(ya,"mapCacheGet");function va(re){return Ga(this,re).has(re)}h(va,"mapCacheHas");function ja(re,pe){var Ae=Ga(this,re),ft=Ae.size;return Ae.set(re,pe),this.size+=Ae.size==ft?0:1,this}h(ja,"mapCacheSet"),Gr.prototype.clear=An,Gr.prototype.delete=Yn,Gr.prototype.get=ya,Gr.prototype.has=va,Gr.prototype.set=ja;function pn(re){var pe=this.__data__=new Ut(re);this.size=pe.size}h(pn,"Stack");function te(){this.__data__=new Ut,this.size=0}h(te,"stackClear");function ye(re){var pe=this.__data__,Ae=pe.delete(re);return this.size=pe.size,Ae}h(ye,"stackDelete");function Ce(re){return this.__data__.get(re)}h(Ce,"stackGet");function Pe(re){return this.__data__.has(re)}h(Pe,"stackHas");function Se(re,pe){var Ae=this.__data__;if(Ae instanceof Ut){var ft=Ae.__data__;if(!ce||ft.length<t-1)return ft.push([re,pe]),this.size=++Ae.size,this;Ae=this.__data__=new Gr(ft)}return Ae.set(re,pe),this.size=Ae.size,this}h(Se,"stackSet"),pn.prototype.clear=te,pn.prototype.delete=ye,pn.prototype.get=Ce,pn.prototype.has=Pe,pn.prototype.set=Se;function rt(re,pe){var Ae=Lr(re),ft=!Ae&&Ii(re),si=!Ae&&!ft&&dg(re),mi=!Ae&&!ft&&!si&&uT(re),Ni=Ae||ft||si||mi,li=Ni?ve(re.length,String):[],$i=li.length;for(var ba in re)(pe||_e.call(re,ba))&&!(Ni&&(ba=="length"||si&&(ba=="offset"||ba=="parent")||mi&&(ba=="buffer"||ba=="byteLength"||ba=="byteOffset")||I(ba,$i)))&&li.push(ba);return li}h(rt,"arrayLikeKeys");function _t(re,pe,Ae){(Ae!==void 0&&!Wt(re[pe],Ae)||Ae===void 0&&!(pe in re))&&Dt(re,pe,Ae)}h(_t,"assignMergeValue");function Et(re,pe,Ae){var ft=re[pe];(!(_e.call(re,pe)&&Wt(ft,Ae))||Ae===void 0&&!(pe in re))&&Dt(re,pe,Ae)}h(Et,"assignValue");function Tt(re,pe){for(var Ae=re.length;Ae--;)if(Wt(re[Ae][0],pe))return Ae;return-1}h(Tt,"assocIndexOf");function Dt(re,pe,Ae){pe=="__proto__"&&We?We(re,pe,{configurable:!0,enumerable:!0,value:Ae,writable:!0}):re[pe]=Ae}h(Dt,"baseAssignValue");var Vt=Os();function Rt(re){return re==null?re===void 0?L:v:he&&he in Object(re)?y(re):Ee(re)}h(Rt,"baseGetTag");function qi(re){return _h(re)&&Rt(re)==s}h(qi,"baseIsArguments");function Ai(re){if(!So(re)||X(re))return!1;var pe=Wa(re)?xt:q;return pe.test(Ct(re))}h(Ai,"baseIsNative");function Or(re){return _h(re)&&o_(re.length)&&!!ae[Rt(re)]}h(Or,"baseIsTypedArray");function dn(re){if(!So(re))return de(re);var pe=se(re),Ae=[];for(var ft in re)ft=="constructor"&&(pe||!_e.call(re,ft))||Ae.push(ft);return Ae}h(dn,"baseKeysIn");function vi(re,pe,Ae,ft,si){re!==pe&&Vt(pe,function(mi,Ni){if(si||(si=new pn),So(mi))Bt(re,pe,Ni,Ae,vi,ft,si);else{var li=ft?ft(Ye(re,Ni),mi,Ni+"",re,pe,si):void 0;li===void 0&&(li=mi),_t(re,Ni,li)}},s_)}h(vi,"baseMerge");function Bt(re,pe,Ae,ft,si,mi,Ni){var li=Ye(re,Ae),$i=Ye(pe,Ae),ba=Ni.get($i);if(ba){_t(re,Ae,ba);return}var Jn=mi?mi(li,$i,Ae+"",re,pe,Ni):void 0,hd=Jn===void 0;if(hd){var u_=Lr($i),h_=!u_&&dg($i),dT=!u_&&!h_&&uT($i);Jn=$i,u_||h_||dT?Lr(li)?Jn=li:pg(li)?Jn=$t(li):h_?(hd=!1,Jn=xa($i,!0)):dT?(hd=!1,Jn=Ha($i,!0)):Jn=[]:lT($i)||Ii($i)?(Jn=li,Ii(li)?Jn=hT(li):(!So(li)||Wa(li))&&(Jn=S($i))):hd=!1}hd&&(Ni.set($i,Jn),si(Jn,$i,ft,mi,Ni),Ni.delete($i)),_t(re,Ae,Jn)}h(Bt,"baseMergeDeep");function wo(re,pe){return dt(Ue(re,pe,l_),re+"")}h(wo,"baseRest");var dr=We?function(re,pe){return We(re,"toString",{configurable:!0,enumerable:!1,value:cT(pe),writable:!0})}:l_;function xa(re,pe){if(pe)return re.slice();var Ae=re.length,ft=bt?bt(Ae):new re.constructor(Ae);return re.copy(ft),ft}h(xa,"cloneBuffer");function Bs(re){var pe=new re.constructor(re.byteLength);return new He(pe).set(new He(re)),pe}h(Bs,"cloneArrayBuffer");function Ha(re,pe){var Ae=pe?Bs(re.buffer):re.buffer;return new re.constructor(Ae,re.byteOffset,re.length)}h(Ha,"cloneTypedArray");function $t(re,pe){var Ae=-1,ft=re.length;for(pe||(pe=Array(ft));++Ae<ft;)pe[Ae]=re[Ae];return pe}h($t,"copyArray");function Oi(re,pe,Ae,ft){var si=!Ae;Ae||(Ae={});for(var mi=-1,Ni=pe.length;++mi<Ni;){var li=pe[mi],$i=ft?ft(Ae[li],re[li],li,Ae,re):void 0;$i===void 0&&($i=re[li]),si?Dt(Ae,li,$i):Et(Ae,li,$i)}return Ae}h(Oi,"copyObject");function _a(re){return wo(function(pe,Ae){var ft=-1,si=Ae.length,mi=si>1?Ae[si-1]:void 0,Ni=si>2?Ae[2]:void 0;for(mi=re.length>3&&typeof mi=="function"?(si--,mi):void 0,Ni&&F(Ae[0],Ae[1],Ni)&&(mi=si<3?void 0:mi,si=1),pe=Object(pe);++ft<si;){var li=Ae[ft];li&&re(pe,li,ft,mi)}return pe})}h(_a,"createAssigner");function Os(re){return function(pe,Ae,ft){for(var si=-1,mi=Object(pe),Ni=ft(pe),li=Ni.length;li--;){var $i=Ni[re?li:++si];if(Ae(mi[$i],$i,mi)===!1)break}return pe}}h(Os,"createBaseFor");function Nr(re,pe,Ae,ft,si,mi){return So(re)&&So(pe)&&(mi.set(pe,re),vi(re,pe,void 0,Nr,mi),mi.delete(pe)),re}h(Nr,"customDefaultsMerge");function Ga(re,pe){var Ae=re.__data__;return H(pe)?Ae[typeof pe=="string"?"string":"hash"]:Ae.map}h(Ga,"getMapData");function f(re,pe){var Ae=De(re,pe);return Ai(Ae)?Ae:void 0}h(f,"getNative");function y(re){var pe=_e.call(re,he),Ae=re[he];try{re[he]=void 0;var ft=!0}catch{}var si=Ne.call(re);return ft&&(pe?re[he]=Ae:delete re[he]),si}h(y,"getRawTag");function S(re){return typeof re.constructor=="function"&&!se(re)?be(Xe(re)):{}}h(S,"initCloneObject");function I(re,pe){var Ae=typeof re;return pe=pe??o,!!pe&&(Ae=="number"||Ae!="symbol"&&ee.test(re))&&re>-1&&re%1==0&&re<pe}h(I,"isIndex");function F(re,pe,Ae){if(!So(Ae))return!1;var ft=typeof pe;return(ft=="number"?fn(Ae)&&I(pe,Ae.length):ft=="string"&&pe in Ae)?Wt(Ae[pe],re):!1}h(F,"isIterateeCall");function H(re){var pe=typeof re;return pe=="string"||pe=="number"||pe=="symbol"||pe=="boolean"?re!=="__proto__":re===null}h(H,"isKeyable");function X(re){return!!Re&&Re in re}h(X,"isMasked");function se(re){var pe=re&&re.constructor,Ae=typeof pe=="function"&&pe.prototype||yt;return re===Ae}h(se,"isPrototype");function de(re){var pe=[];if(re!=null)for(var Ae in Object(re))pe.push(Ae);return pe}h(de,"nativeKeysIn");function Ee(re){return Ne.call(re)}h(Ee,"objectToString");function Ue(re,pe,Ae){return pe=ut(pe===void 0?re.length-1:pe,0),function(){for(var ft=arguments,si=-1,mi=ut(ft.length-pe,0),Ni=Array(mi);++si<mi;)Ni[si]=ft[pe+si];si=-1;for(var li=Array(pe+1);++si<pe;)li[si]=ft[si];return li[pe]=Ae(Ni),Me(re,this,li)}}h(Ue,"overRest");function Ye(re,pe){if(!(pe==="constructor"&&typeof re[pe]=="function")&&pe!="__proto__")return re[pe]}h(Ye,"safeGet");var dt=Pt(dr);function Pt(re){var pe=0,Ae=0;return function(){var ft=ct(),si=a-(ft-Ae);if(Ae=ft,si>0){if(++pe>=n)return arguments[0]}else pe=0;return re.apply(void 0,arguments)}}h(Pt,"shortOut");function Ct(re){if(re!=null){try{return W.call(re)}catch{}try{return re+""}catch{}}return""}h(Ct,"toSource");function Wt(re,pe){return re===pe||re!==re&&pe!==pe}h(Wt,"eq");var Ii=qi(function(){return arguments}())?qi:function(re){return _h(re)&&_e.call(re,"callee")&&!At.call(re,"callee")},Lr=Array.isArray;function fn(re){return re!=null&&o_(re.length)&&!Wa(re)}h(fn,"isArrayLike");function pg(re){return _h(re)&&fn(re)}h(pg,"isArrayLikeObject");var dg=pt||pT;function Wa(re){if(!So(re))return!1;var pe=Rt(re);return pe==m||pe==g||pe==u||pe==_}h(Wa,"isFunction");function o_(re){return typeof re=="number"&&re>-1&&re%1==0&&re<=o}h(o_,"isLength");function So(re){var pe=typeof re;return re!=null&&(pe=="object"||pe=="function")}h(So,"isObject");function _h(re){return re!=null&&typeof re=="object"}h(_h,"isObjectLike");function lT(re){if(!_h(re)||Rt(re)!=w)return!1;var pe=Xe(re);if(pe===null)return!0;var Ae=_e.call(pe,"constructor")&&pe.constructor;return typeof Ae=="function"&&Ae instanceof Ae&&W.call(Ae)==ze}h(lT,"isPlainObject");var uT=Q?Ie(Q):Or;function hT(re){return Oi(re,s_(re))}h(hT,"toPlainObject");var $te=wo(function(re){return re.push(void 0,Nr),Me(Ute,void 0,re)});function s_(re){return fn(re)?rt(re,!0):dn(re)}h(s_,"keysIn");var Ute=_a(function(re,pe,Ae,ft){vi(re,pe,Ae,ft)});function cT(re){return function(){return re}}h(cT,"constant");function l_(re){return re}h(l_,"identity");function pT(){return!1}h(pT,"stubFalse"),e.exports=$te}),q0e=Qe((i,e)=>{R();var t=!1,r={},n=!1;typeof e<"u"&&e.exports?(e.exports=r,n=!0):typeof document<"u"?window.ClipperLib=r:self.ClipperLib=r;var a;n?(o="chrome",a="Netscape"):(o=navigator.userAgent.toString().toLowerCase(),a=navigator.appName);var o,s={};o.indexOf("chrome")!=-1&&o.indexOf("chromium")==-1?s.chrome=1:s.chrome=0,o.indexOf("chromium")!=-1?s.chromium=1:s.chromium=0,o.indexOf("safari")!=-1&&o.indexOf("chrome")==-1&&o.indexOf("chromium")==-1?s.safari=1:s.safari=0,o.indexOf("firefox")!=-1?s.firefox=1:s.firefox=0,o.indexOf("firefox/17")!=-1?s.firefox17=1:s.firefox17=0,o.indexOf("firefox/15")!=-1?s.firefox15=1:s.firefox15=0,o.indexOf("firefox/3")!=-1?s.firefox3=1:s.firefox3=0,o.indexOf("opera")!=-1?s.opera=1:s.opera=0,o.indexOf("msie 10")!=-1?s.msie10=1:s.msie10=0,o.indexOf("msie 9")!=-1?s.msie9=1:s.msie9=0,o.indexOf("msie 8")!=-1?s.msie8=1:s.msie8=0,o.indexOf("msie 7")!=-1?s.msie7=1:s.msie7=0,o.indexOf("msie ")!=-1?s.msie=1:s.msie=0,r.biginteger_used=null;var l;function u(f,y,S){r.biginteger_used=1,f!=null&&(typeof f=="number"&&typeof y>"u"?this.fromInt(f):typeof f=="number"?this.fromNumber(f,y,S):y==null&&typeof f!="string"?this.fromString(f,256):this.fromString(f,y))}h(u,"BigInteger");function c(){return new u(null)}h(c,"nbi");function p(f,y,S,I,F,H){for(;--H>=0;){var X=y*this[f++]+S[I]+F;F=Math.floor(X/67108864),S[I++]=X&67108863}return F}h(p,"am1");function d(f,y,S,I,F,H){for(var X=y&32767,se=y>>15;--H>=0;){var de=this[f]&32767,Ee=this[f++]>>15,Ue=se*de+Ee*X;de=X*de+((Ue&32767)<<15)+S[I]+(F&1073741823),F=(de>>>30)+(Ue>>>15)+se*Ee+(F>>>30),S[I++]=de&1073741823}return F}h(d,"am2");function m(f,y,S,I,F,H){for(var X=y&16383,se=y>>14;--H>=0;){var de=this[f]&16383,Ee=this[f++]>>14,Ue=se*de+Ee*X;de=X*de+((Ue&16383)<<14)+S[I]+F,F=(de>>28)+(Ue>>14)+se*Ee,S[I++]=de&268435455}return F}h(m,"am3"),a=="Microsoft Internet Explorer"?(u.prototype.am=d,l=30):a!="Netscape"?(u.prototype.am=p,l=26):(u.prototype.am=m,l=28),u.prototype.DB=l,u.prototype.DM=(1<<l)-1,u.prototype.DV=1<<l;var g=52;u.prototype.FV=Math.pow(2,g),u.prototype.F1=g-l,u.prototype.F2=2*l-g;var b="0123456789abcdefghijklmnopqrstuvwxyz",x=new Array,v,w;for(v=48,w=0;w<=9;++w)x[v++]=w;for(v=97,w=10;w<36;++w)x[v++]=w;for(v=65,w=10;w<36;++w)x[v++]=w;function _(f){return b.charAt(f)}h(_,"int2char");function C(f,y){var S=x[f.charCodeAt(y)];return S??-1}h(C,"intAt");function E(f){for(var y=this.t-1;y>=0;--y)f[y]=this[y];f.t=this.t,f.s=this.s}h(E,"bnpCopyTo");function T(f){this.t=1,this.s=f<0?-1:0,f>0?this[0]=f:f<-1?this[0]=f+this.DV:this.t=0}h(T,"bnpFromInt");function L(f){var y=c();return y.fromInt(f),y}h(L,"nbv");function D(f,y){var S;if(y==16)S=4;else if(y==8)S=3;else if(y==256)S=8;else if(y==2)S=1;else if(y==32)S=5;else if(y==4)S=2;else{this.fromRadix(f,y);return}this.t=0,this.s=0;for(var I=f.length,F=!1,H=0;--I>=0;){var X=S==8?f[I]&255:C(f,I);if(X<0){f.charAt(I)=="-"&&(F=!0);continue}F=!1,H==0?this[this.t++]=X:H+S>this.DB?(this[this.t-1]|=(X&(1<<this.DB-H)-1)<<H,this[this.t++]=X>>this.DB-H):this[this.t-1]|=X<<H,H+=S,H>=this.DB&&(H-=this.DB)}S==8&&f[0]&128&&(this.s=-1,H>0&&(this[this.t-1]|=(1<<this.DB-H)-1<<H)),this.clamp(),F&&u.ZERO.subTo(this,this)}h(D,"bnpFromString");function B(){for(var f=this.s&this.DM;this.t>0&&this[this.t-1]==f;)--this.t}h(B,"bnpClamp");function A(f){if(this.s<0)return"-"+this.negate().toString(f);var y;if(f==16)y=4;else if(f==8)y=3;else if(f==2)y=1;else if(f==32)y=5;else if(f==4)y=2;else return this.toRadix(f);var S=(1<<y)-1,I,F=!1,H="",X=this.t,se=this.DB-X*this.DB%y;if(X-- >0)for(se<this.DB&&(I=this[X]>>se)>0&&(F=!0,H=_(I));X>=0;)se<y?(I=(this[X]&(1<<se)-1)<<y-se,I|=this[--X]>>(se+=this.DB-y)):(I=this[X]>>(se-=y)&S,se<=0&&(se+=this.DB,--X)),I>0&&(F=!0),F&&(H+=_(I));return F?H:"0"}h(A,"bnToString");function k(){var f=c();return u.ZERO.subTo(this,f),f}h(k,"bnNegate");function $(){return this.s<0?this.negate():this}h($,"bnAbs");function O(f){var y=this.s-f.s;if(y!=0)return y;var S=this.t;if(y=S-f.t,y!=0)return this.s<0?-y:y;for(;--S>=0;)if((y=this[S]-f[S])!=0)return y;return 0}h(O,"bnCompareTo");function P(f){var y=1,S;return(S=f>>>16)!=0&&(f=S,y+=16),(S=f>>8)!=0&&(f=S,y+=8),(S=f>>4)!=0&&(f=S,y+=4),(S=f>>2)!=0&&(f=S,y+=2),(S=f>>1)!=0&&(f=S,y+=1),y}h(P,"nbits");function U(){return this.t<=0?0:this.DB*(this.t-1)+P(this[this.t-1]^this.s&this.DM)}h(U,"bnBitLength");function G(f,y){var S;for(S=this.t-1;S>=0;--S)y[S+f]=this[S];for(S=f-1;S>=0;--S)y[S]=0;y.t=this.t+f,y.s=this.s}h(G,"bnpDLShiftTo");function K(f,y){for(var S=f;S<this.t;++S)y[S-f]=this[S];y.t=Math.max(this.t-f,0),y.s=this.s}h(K,"bnpDRShiftTo");function z(f,y){var S=f%this.DB,I=this.DB-S,F=(1<<I)-1,H=Math.floor(f/this.DB),X=this.s<<S&this.DM,se;for(se=this.t-1;se>=0;--se)y[se+H+1]=this[se]>>I|X,X=(this[se]&F)<<S;for(se=H-1;se>=0;--se)y[se]=0;y[H]=X,y.t=this.t+H+1,y.s=this.s,y.clamp()}h(z,"bnpLShiftTo");function V(f,y){y.s=this.s;var S=Math.floor(f/this.DB);if(S>=this.t){y.t=0;return}var I=f%this.DB,F=this.DB-I,H=(1<<I)-1;y[0]=this[S]>>I;for(var X=S+1;X<this.t;++X)y[X-S-1]|=(this[X]&H)<<F,y[X-S]=this[X]>>I;I>0&&(y[this.t-S-1]|=(this.s&H)<<F),y.t=this.t-S,y.clamp()}h(V,"bnpRShiftTo");function j(f,y){for(var S=0,I=0,F=Math.min(f.t,this.t);S<F;)I+=this[S]-f[S],y[S++]=I&this.DM,I>>=this.DB;if(f.t<this.t){for(I-=f.s;S<this.t;)I+=this[S],y[S++]=I&this.DM,I>>=this.DB;I+=this.s}else{for(I+=this.s;S<f.t;)I-=f[S],y[S++]=I&this.DM,I>>=this.DB;I-=f.s}y.s=I<0?-1:0,I<-1?y[S++]=this.DV+I:I>0&&(y[S++]=I),y.t=S,y.clamp()}h(j,"bnpSubTo");function q(f,y){var S=this.abs(),I=f.abs(),F=S.t;for(y.t=F+I.t;--F>=0;)y[F]=0;for(F=0;F<I.t;++F)y[F+S.t]=S.am(0,I[F],y,F,0,S.t);y.s=0,y.clamp(),this.s!=f.s&&u.ZERO.subTo(y,y)}h(q,"bnpMultiplyTo");function ee(f){for(var y=this.abs(),S=f.t=2*y.t;--S>=0;)f[S]=0;for(S=0;S<y.t-1;++S){var I=y.am(S,y[S],f,2*S,0,1);(f[S+y.t]+=y.am(S+1,2*y[S],f,2*S+1,I,y.t-S-1))>=y.DV&&(f[S+y.t]-=y.DV,f[S+y.t+1]=1)}f.t>0&&(f[f.t-1]+=y.am(S,y[S],f,2*S,0,1)),f.s=0,f.clamp()}h(ee,"bnpSquareTo");function ae(f,y,S){var I=f.abs();if(!(I.t<=0)){var F=this.abs();if(F.t<I.t){y!=null&&y.fromInt(0),S!=null&&this.copyTo(S);return}S==null&&(S=c());var H=c(),X=this.s,se=f.s,de=this.DB-P(I[I.t-1]);de>0?(I.lShiftTo(de,H),F.lShiftTo(de,S)):(I.copyTo(H),F.copyTo(S));var Ee=H.t,Ue=H[Ee-1];if(Ue!=0){var Ye=Ue*(1<<this.F1)+(Ee>1?H[Ee-2]>>this.F2:0),dt=this.FV/Ye,Pt=(1<<this.F1)/Ye,Ct=1<<this.F2,Wt=S.t,Ii=Wt-Ee,Lr=y??c();for(H.dlShiftTo(Ii,Lr),S.compareTo(Lr)>=0&&(S[S.t++]=1,S.subTo(Lr,S)),u.ONE.dlShiftTo(Ee,Lr),Lr.subTo(H,H);H.t<Ee;)H[H.t++]=0;for(;--Ii>=0;){var fn=S[--Wt]==Ue?this.DM:Math.floor(S[Wt]*dt+(S[Wt-1]+Ct)*Pt);if((S[Wt]+=H.am(0,fn,S,Ii,0,Ee))<fn)for(H.dlShiftTo(Ii,Lr),S.subTo(Lr,S);S[Wt]<--fn;)S.subTo(Lr,S)}y!=null&&(S.drShiftTo(Ee,y),X!=se&&u.ZERO.subTo(y,y)),S.t=Ee,S.clamp(),de>0&&S.rShiftTo(de,S),X<0&&u.ZERO.subTo(S,S)}}}h(ae,"bnpDivRemTo");function N(f){var y=c();return this.abs().divRemTo(f,null,y),this.s<0&&y.compareTo(u.ZERO)>0&&f.subTo(y,y),y}h(N,"bnMod");function J(f){this.m=f}h(J,"Classic");function Y(f){return f.s<0||f.compareTo(this.m)>=0?f.mod(this.m):f}h(Y,"cConvert");function oe(f){return f}h(oe,"cRevert");function xe(f){f.divRemTo(this.m,null,f)}h(xe,"cReduce");function ge(f,y,S){f.multiplyTo(y,S),this.reduce(S)}h(ge,"cMulTo");function Te(f,y){f.squareTo(y),this.reduce(y)}h(Te,"cSqrTo"),J.prototype.convert=Y,J.prototype.revert=oe,J.prototype.reduce=xe,J.prototype.mulTo=ge,J.prototype.sqrTo=Te;function me(){if(this.t<1)return 0;var f=this[0];if(!(f&1))return 0;var y=f&3;return y=y*(2-(f&15)*y)&15,y=y*(2-(f&255)*y)&255,y=y*(2-((f&65535)*y&65535))&65535,y=y*(2-f*y%this.DV)%this.DV,y>0?this.DV-y:-y}h(me,"bnpInvDigit");function Q(f){this.m=f,this.mp=f.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<f.DB-15)-1,this.mt2=2*f.t}h(Q,"Montgomery");function Me(f){var y=c();return f.abs().dlShiftTo(this.m.t,y),y.divRemTo(this.m,null,y),f.s<0&&y.compareTo(u.ZERO)>0&&this.m.subTo(y,y),y}h(Me,"montConvert");function ve(f){var y=c();return f.copyTo(y),this.reduce(y),y}h(ve,"montRevert");function Ie(f){for(;f.t<=this.mt2;)f[f.t++]=0;for(var y=0;y<this.m.t;++y){var S=f[y]&32767,I=S*this.mpl+((S*this.mph+(f[y]>>15)*this.mpl&this.um)<<15)&f.DM;for(S=y+this.m.t,f[S]+=this.m.am(0,I,f,y,0,this.m.t);f[S]>=f.DV;)f[S]-=f.DV,f[++S]++}f.clamp(),f.drShiftTo(this.m.t,f),f.compareTo(this.m)>=0&&f.subTo(this.m,f)}h(Ie,"montReduce");function De(f,y){f.squareTo(y),this.reduce(y)}h(De,"montSqrTo");function we(f,y,S){f.multiplyTo(y,S),this.reduce(S)}h(we,"montMulTo"),Q.prototype.convert=Me,Q.prototype.revert=ve,Q.prototype.reduce=Ie,Q.prototype.mulTo=we,Q.prototype.sqrTo=De;function Fe(){return(this.t>0?this[0]&1:this.s)==0}h(Fe,"bnpIsEven");function Ze(f,y){if(f>4294967295||f<1)return u.ONE;var S=c(),I=c(),F=y.convert(this),H=P(f)-1;for(F.copyTo(S);--H>=0;)if(y.sqrTo(S,I),(f&1<<H)>0)y.mulTo(I,F,S);else{var X=S;S=I,I=X}return y.revert(S)}h(Ze,"bnpExp");function yt(f,y){var S;return f<256||y.isEven()?S=new J(y):S=new Q(y),this.exp(f,S)}h(yt,"bnModPowInt"),u.prototype.copyTo=E,u.prototype.fromInt=T,u.prototype.fromString=D,u.prototype.clamp=B,u.prototype.dlShiftTo=G,u.prototype.drShiftTo=K,u.prototype.lShiftTo=z,u.prototype.rShiftTo=V,u.prototype.subTo=j,u.prototype.multiplyTo=q,u.prototype.squareTo=ee,u.prototype.divRemTo=ae,u.prototype.invDigit=me,u.prototype.isEven=Fe,u.prototype.exp=Ze,u.prototype.toString=A,u.prototype.negate=k,u.prototype.abs=$,u.prototype.compareTo=O,u.prototype.bitLength=U,u.prototype.mod=N,u.prototype.modPowInt=yt,u.ZERO=L(0),u.ONE=L(1);function ne(){var f=c();return this.copyTo(f),f}h(ne,"bnClone");function W(){if(this.s<0){if(this.t==1)return this[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this[0];if(this.t==0)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}h(W,"bnIntValue");function _e(){return this.t==0?this.s:this[0]<<24>>24}h(_e,"bnByteValue");function Re(){return this.t==0?this.s:this[0]<<16>>16}h(Re,"bnShortValue");function Ne(f){return Math.floor(Math.LN2*this.DB/Math.log(f))}h(Ne,"bnpChunkSize");function ze(){return this.s<0?-1:this.t<=0||this.t==1&&this[0]<=0?0:1}h(ze,"bnSigNum");function xt(f){if(f==null&&(f=10),this.signum()==0||f<2||f>36)return"0";var y=this.chunkSize(f),S=Math.pow(f,y),I=L(S),F=c(),H=c(),X="";for(this.divRemTo(I,F,H);F.signum()>0;)X=(S+H.intValue()).toString(f).substr(1)+X,F.divRemTo(I,F,H);return H.intValue().toString(f)+X}h(xt,"bnpToRadix");function ot(f,y){this.fromInt(0),y==null&&(y=10);for(var S=this.chunkSize(y),I=Math.pow(y,S),F=!1,H=0,X=0,se=0;se<f.length;++se){var de=C(f,se);if(de<0){f.charAt(se)=="-"&&this.signum()==0&&(F=!0);continue}X=y*X+de,++H>=S&&(this.dMultiply(I),this.dAddOffset(X,0),H=0,X=0)}H>0&&(this.dMultiply(Math.pow(y,H)),this.dAddOffset(X,0)),F&&u.ZERO.subTo(this,this)}h(ot,"bnpFromRadix");function je(f,y,S){if(typeof y=="number")if(f<2)this.fromInt(1);else for(this.fromNumber(f,S),this.testBit(f-1)||this.bitwiseTo(u.ONE.shiftLeft(f-1),We,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(y);)this.dAddOffset(2,0),this.bitLength()>f&&this.subTo(u.ONE.shiftLeft(f-1),this);else{var I=new Array,F=f&7;I.length=(f>>3)+1,y.nextBytes(I),F>0?I[0]&=(1<<F)-1:I[0]=0,this.fromString(I,256)}}h(je,"bnpFromNumber");function He(){var f=this.t,y=new Array;y[0]=this.s;var S=this.DB-f*this.DB%8,I,F=0;if(f-- >0)for(S<this.DB&&(I=this[f]>>S)!=(this.s&this.DM)>>S&&(y[F++]=I|this.s<<this.DB-S);f>=0;)S<8?(I=(this[f]&(1<<S)-1)<<8-S,I|=this[--f]>>(S+=this.DB-8)):(I=this[f]>>(S-=8)&255,S<=0&&(S+=this.DB,--f)),I&128&&(I|=-256),F==0&&(this.s&128)!=(I&128)&&++F,(F>0||I!=this.s)&&(y[F++]=I);return y}h(He,"bnToByteArray");function bt(f){return this.compareTo(f)==0}h(bt,"bnEquals");function Xe(f){return this.compareTo(f)<0?this:f}h(Xe,"bnMin");function ti(f){return this.compareTo(f)>0?this:f}h(ti,"bnMax");function At(f,y,S){var I,F,H=Math.min(f.t,this.t);for(I=0;I<H;++I)S[I]=y(this[I],f[I]);if(f.t<this.t){for(F=f.s&this.DM,I=H;I<this.t;++I)S[I]=y(this[I],F);S.t=this.t}else{for(F=this.s&this.DM,I=H;I<f.t;++I)S[I]=y(F,f[I]);S.t=f.t}S.s=y(this.s,f.s),S.clamp()}h(At,"bnpBitwiseTo");function ue(f,y){return f&y}h(ue,"op_and");function he(f){var y=c();return this.bitwiseTo(f,ue,y),y}h(he,"bnAnd");function We(f,y){return f|y}h(We,"op_or");function pt(f){var y=c();return this.bitwiseTo(f,We,y),y}h(pt,"bnOr");function ut(f,y){return f^y}h(ut,"op_xor");function ct(f){var y=c();return this.bitwiseTo(f,ut,y),y}h(ct,"bnXor");function ce(f,y){return f&~y}h(ce,"op_andnot");function et(f){var y=c();return this.bitwiseTo(f,ce,y),y}h(et,"bnAndNot");function be(){for(var f=c(),y=0;y<this.t;++y)f[y]=this.DM&~this[y];return f.t=this.t,f.s=~this.s,f}h(be,"bnNot");function Ge(f){var y=c();return f<0?this.rShiftTo(-f,y):this.lShiftTo(f,y),y}h(Ge,"bnShiftLeft");function tt(f){var y=c();return f<0?this.lShiftTo(-f,y):this.rShiftTo(f,y),y}h(tt,"bnShiftRight");function Ht(f){if(f==0)return-1;var y=0;return f&65535||(f>>=16,y+=16),f&255||(f>>=8,y+=8),f&15||(f>>=4,y+=4),f&3||(f>>=2,y+=2),f&1||++y,y}h(Ht,"lbit");function Nt(){for(var f=0;f<this.t;++f)if(this[f]!=0)return f*this.DB+Ht(this[f]);return this.s<0?this.t*this.DB:-1}h(Nt,"bnGetLowestSetBit");function Mi(f){for(var y=0;f!=0;)f&=f-1,++y;return y}h(Mi,"cbit");function ar(){for(var f=0,y=this.s&this.DM,S=0;S<this.t;++S)f+=Mi(this[S]^y);return f}h(ar,"bnBitCount");function Ut(f){var y=Math.floor(f/this.DB);return y>=this.t?this.s!=0:(this[y]&1<<f%this.DB)!=0}h(Ut,"bnTestBit");function Ci(f,y){var S=u.ONE.shiftLeft(f);return this.bitwiseTo(S,y,S),S}h(Ci,"bnpChangeBit");function pr(f){return this.changeBit(f,We)}h(pr,"bnSetBit");function Pn(f){return this.changeBit(f,ce)}h(Pn,"bnClearBit");function ga(f){return this.changeBit(f,ut)}h(ga,"bnFlipBit");function cn(f,y){for(var S=0,I=0,F=Math.min(f.t,this.t);S<F;)I+=this[S]+f[S],y[S++]=I&this.DM,I>>=this.DB;if(f.t<this.t){for(I+=f.s;S<this.t;)I+=this[S],y[S++]=I&this.DM,I>>=this.DB;I+=this.s}else{for(I+=this.s;S<f.t;)I+=f[S],y[S++]=I&this.DM,I>>=this.DB;I+=f.s}y.s=I<0?-1:0,I>0?y[S++]=I:I<-1&&(y[S++]=this.DV+I),y.t=S,y.clamp()}h(cn,"bnpAddTo");function Gr(f){var y=c();return this.addTo(f,y),y}h(Gr,"bnAdd");function An(f){var y=c();return this.subTo(f,y),y}h(An,"bnSubtract");function Yn(f){var y=c();return this.multiplyTo(f,y),y}h(Yn,"bnMultiply");function ya(){var f=c();return this.squareTo(f),f}h(ya,"bnSquare");function va(f){var y=c();return this.divRemTo(f,y,null),y}h(va,"bnDivide");function ja(f){var y=c();return this.divRemTo(f,null,y),y}h(ja,"bnRemainder");function pn(f){var y=c(),S=c();return this.divRemTo(f,y,S),new Array(y,S)}h(pn,"bnDivideAndRemainder");function te(f){this[this.t]=this.am(0,f-1,this,0,0,this.t),++this.t,this.clamp()}h(te,"bnpDMultiply");function ye(f,y){if(f!=0){for(;this.t<=y;)this[this.t++]=0;for(this[y]+=f;this[y]>=this.DV;)this[y]-=this.DV,++y>=this.t&&(this[this.t++]=0),++this[y]}}h(ye,"bnpDAddOffset");function Ce(){}h(Ce,"NullExp");function Pe(f){return f}h(Pe,"nNop");function Se(f,y,S){f.multiplyTo(y,S)}h(Se,"nMulTo");function rt(f,y){f.squareTo(y)}h(rt,"nSqrTo"),Ce.prototype.convert=Pe,Ce.prototype.revert=Pe,Ce.prototype.mulTo=Se,Ce.prototype.sqrTo=rt;function _t(f){return this.exp(f,new Ce)}h(_t,"bnPow");function Et(f,y,S){var I=Math.min(this.t+f.t,y);for(S.s=0,S.t=I;I>0;)S[--I]=0;var F;for(F=S.t-this.t;I<F;++I)S[I+this.t]=this.am(0,f[I],S,I,0,this.t);for(F=Math.min(f.t,y);I<F;++I)this.am(0,f[I],S,I,0,y-I);S.clamp()}h(Et,"bnpMultiplyLowerTo");function Tt(f,y,S){--y;var I=S.t=this.t+f.t-y;for(S.s=0;--I>=0;)S[I]=0;for(I=Math.max(y-this.t,0);I<f.t;++I)S[this.t+I-y]=this.am(y-I,f[I],S,0,0,this.t+I-y);S.clamp(),S.drShiftTo(1,S)}h(Tt,"bnpMultiplyUpperTo");function Dt(f){this.r2=c(),this.q3=c(),u.ONE.dlShiftTo(2*f.t,this.r2),this.mu=this.r2.divide(f),this.m=f}h(Dt,"Barrett");function Vt(f){if(f.s<0||f.t>2*this.m.t)return f.mod(this.m);if(f.compareTo(this.m)<0)return f;var y=c();return f.copyTo(y),this.reduce(y),y}h(Vt,"barrettConvert");function Rt(f){return f}h(Rt,"barrettRevert");function qi(f){for(f.drShiftTo(this.m.t-1,this.r2),f.t>this.m.t+1&&(f.t=this.m.t+1,f.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);f.compareTo(this.r2)<0;)f.dAddOffset(1,this.m.t+1);for(f.subTo(this.r2,f);f.compareTo(this.m)>=0;)f.subTo(this.m,f)}h(qi,"barrettReduce");function Ai(f,y){f.squareTo(y),this.reduce(y)}h(Ai,"barrettSqrTo");function Or(f,y,S){f.multiplyTo(y,S),this.reduce(S)}h(Or,"barrettMulTo"),Dt.prototype.convert=Vt,Dt.prototype.revert=Rt,Dt.prototype.reduce=qi,Dt.prototype.mulTo=Or,Dt.prototype.sqrTo=Ai;function dn(f,y){var S=f.bitLength(),I,F=L(1),H;if(S<=0)return F;S<18?I=1:S<48?I=3:S<144?I=4:S<768?I=5:I=6,S<8?H=new J(y):y.isEven()?H=new Dt(y):H=new Q(y);var X=new Array,se=3,de=I-1,Ee=(1<<I)-1;if(X[1]=H.convert(this),I>1){var Ue=c();for(H.sqrTo(X[1],Ue);se<=Ee;)X[se]=c(),H.mulTo(Ue,X[se-2],X[se]),se+=2}var Ye=f.t-1,dt,Pt=!0,Ct=c(),Wt;for(S=P(f[Ye])-1;Ye>=0;){for(S>=de?dt=f[Ye]>>S-de&Ee:(dt=(f[Ye]&(1<<S+1)-1)<<de-S,Ye>0&&(dt|=f[Ye-1]>>this.DB+S-de)),se=I;!(dt&1);)dt>>=1,--se;if((S-=se)<0&&(S+=this.DB,--Ye),Pt)X[dt].copyTo(F),Pt=!1;else{for(;se>1;)H.sqrTo(F,Ct),H.sqrTo(Ct,F),se-=2;se>0?H.sqrTo(F,Ct):(Wt=F,F=Ct,Ct=Wt),H.mulTo(Ct,X[dt],F)}for(;Ye>=0&&!(f[Ye]&1<<S);)H.sqrTo(F,Ct),Wt=F,F=Ct,Ct=Wt,--S<0&&(S=this.DB-1,--Ye)}return H.revert(F)}h(dn,"bnModPow");function vi(f){var y=this.s<0?this.negate():this.clone(),S=f.s<0?f.negate():f.clone();if(y.compareTo(S)<0){var I=y;y=S,S=I}var F=y.getLowestSetBit(),H=S.getLowestSetBit();if(H<0)return y;for(F<H&&(H=F),H>0&&(y.rShiftTo(H,y),S.rShiftTo(H,S));y.signum()>0;)(F=y.getLowestSetBit())>0&&y.rShiftTo(F,y),(F=S.getLowestSetBit())>0&&S.rShiftTo(F,S),y.compareTo(S)>=0?(y.subTo(S,y),y.rShiftTo(1,y)):(S.subTo(y,S),S.rShiftTo(1,S));return H>0&&S.lShiftTo(H,S),S}h(vi,"bnGCD");function Bt(f){if(f<=0)return 0;var y=this.DV%f,S=this.s<0?f-1:0;if(this.t>0)if(y==0)S=this[0]%f;else for(var I=this.t-1;I>=0;--I)S=(y*S+this[I])%f;return S}h(Bt,"bnpModInt");function wo(f){var y=f.isEven();if(this.isEven()&&y||f.signum()==0)return u.ZERO;for(var S=f.clone(),I=this.clone(),F=L(1),H=L(0),X=L(0),se=L(1);S.signum()!=0;){for(;S.isEven();)S.rShiftTo(1,S),y?((!F.isEven()||!H.isEven())&&(F.addTo(this,F),H.subTo(f,H)),F.rShiftTo(1,F)):H.isEven()||H.subTo(f,H),H.rShiftTo(1,H);for(;I.isEven();)I.rShiftTo(1,I),y?((!X.isEven()||!se.isEven())&&(X.addTo(this,X),se.subTo(f,se)),X.rShiftTo(1,X)):se.isEven()||se.subTo(f,se),se.rShiftTo(1,se);S.compareTo(I)>=0?(S.subTo(I,S),y&&F.subTo(X,F),H.subTo(se,H)):(I.subTo(S,I),y&&X.subTo(F,X),se.subTo(H,se))}if(I.compareTo(u.ONE)!=0)return u.ZERO;if(se.compareTo(f)>=0)return se.subtract(f);if(se.signum()<0)se.addTo(f,se);else return se;return se.signum()<0?se.add(f):se}h(wo,"bnModInverse");var dr=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],xa=(1<<26)/dr[dr.length-1];function Bs(f){var y,S=this.abs();if(S.t==1&&S[0]<=dr[dr.length-1]){for(y=0;y<dr.length;++y)if(S[0]==dr[y])return!0;return!1}if(S.isEven())return!1;for(y=1;y<dr.length;){for(var I=dr[y],F=y+1;F<dr.length&&I<xa;)I*=dr[F++];for(I=S.modInt(I);y<F;)if(I%dr[y++]==0)return!1}return S.millerRabin(f)}h(Bs,"bnIsProbablePrime");function Ha(f){var y=this.subtract(u.ONE),S=y.getLowestSetBit();if(S<=0)return!1;var I=y.shiftRight(S);f=f+1>>1,f>dr.length&&(f=dr.length);for(var F=c(),H=0;H<f;++H){F.fromInt(dr[Math.floor(Math.random()*dr.length)]);var X=F.modPow(I,this);if(X.compareTo(u.ONE)!=0&&X.compareTo(y)!=0){for(var se=1;se++<S&&X.compareTo(y)!=0;)if(X=X.modPowInt(2,this),X.compareTo(u.ONE)==0)return!1;if(X.compareTo(y)!=0)return!1}}return!0}h(Ha,"bnpMillerRabin"),u.prototype.chunkSize=Ne,u.prototype.toRadix=xt,u.prototype.fromRadix=ot,u.prototype.fromNumber=je,u.prototype.bitwiseTo=At,u.prototype.changeBit=Ci,u.prototype.addTo=cn,u.prototype.dMultiply=te,u.prototype.dAddOffset=ye,u.prototype.multiplyLowerTo=Et,u.prototype.multiplyUpperTo=Tt,u.prototype.modInt=Bt,u.prototype.millerRabin=Ha,u.prototype.clone=ne,u.prototype.intValue=W,u.prototype.byteValue=_e,u.prototype.shortValue=Re,u.prototype.signum=ze,u.prototype.toByteArray=He,u.prototype.equals=bt,u.prototype.min=Xe,u.prototype.max=ti,u.prototype.and=he,u.prototype.or=pt,u.prototype.xor=ct,u.prototype.andNot=et,u.prototype.not=be,u.prototype.shiftLeft=Ge,u.prototype.shiftRight=tt,u.prototype.getLowestSetBit=Nt,u.prototype.bitCount=ar,u.prototype.testBit=Ut,u.prototype.setBit=pr,u.prototype.clearBit=Pn,u.prototype.flipBit=ga,u.prototype.add=Gr,u.prototype.subtract=An,u.prototype.multiply=Yn,u.prototype.divide=va,u.prototype.remainder=ja,u.prototype.divideAndRemainder=pn,u.prototype.modPow=dn,u.prototype.modInverse=wo,u.prototype.pow=_t,u.prototype.gcd=vi,u.prototype.isProbablePrime=Bs,u.prototype.square=ya;var $t=u;$t.prototype.IsNegative=function(){return this.compareTo($t.ZERO)==-1},$t.op_Equality=function(f,y){return f.compareTo(y)==0},$t.op_Inequality=function(f,y){return f.compareTo(y)!=0},$t.op_GreaterThan=function(f,y){return f.compareTo(y)>0},$t.op_LessThan=function(f,y){return f.compareTo(y)<0},$t.op_Addition=function(f,y){return new $t(f).add(new $t(y))},$t.op_Subtraction=function(f,y){return new $t(f).subtract(new $t(y))},$t.Int128Mul=function(f,y){return new $t(f).multiply(new $t(y))},$t.op_Division=function(f,y){return f.divide(y)},$t.prototype.ToDouble=function(){return parseFloat(this.toString())},typeof Oi>"u"&&(Oi=h(function(f,y){var S;if(typeof Object.getOwnPropertyNames>"u"){for(S in y.prototype)(typeof f.prototype[S]>"u"||f.prototype[S]==Object.prototype[S])&&(f.prototype[S]=y.prototype[S]);for(S in y)typeof f[S]>"u"&&(f[S]=y[S]);f.$baseCtor=y}else{for(var I=Object.getOwnPropertyNames(y.prototype),F=0;F<I.length;F++)typeof Object.getOwnPropertyDescriptor(f.prototype,I[F])>"u"&&Object.defineProperty(f.prototype,I[F],Object.getOwnPropertyDescriptor(y.prototype,I[F]));for(S in y)typeof f[S]>"u"&&(f[S]=y[S]);f.$baseCtor=y}},"Inherit"));var Oi;r.Path=function(){return[]},r.Paths=function(){return[]},r.DoublePoint=function(){var f=arguments;this.X=0,this.Y=0,f.length==1?(this.X=f[0].X,this.Y=f[0].Y):f.length==2&&(this.X=f[0],this.Y=f[1])},r.DoublePoint0=function(){this.X=0,this.Y=0},r.DoublePoint1=function(f){this.X=f.X,this.Y=f.Y},r.DoublePoint2=function(f,y){this.X=f,this.Y=y},r.PolyNode=function(){this.m_Parent=null,this.m_polygon=new r.Path,this.m_Index=0,this.m_jointype=0,this.m_endtype=0,this.m_Childs=[],this.IsOpen=!1},r.PolyNode.prototype.IsHoleNode=function(){for(var f=!0,y=this.m_Parent;y!==null;)f=!f,y=y.m_Parent;return f},r.PolyNode.prototype.ChildCount=function(){return this.m_Childs.length},r.PolyNode.prototype.Contour=function(){return this.m_polygon},r.PolyNode.prototype.AddChild=function(f){var y=this.m_Childs.length;this.m_Childs.push(f),f.m_Parent=this,f.m_Index=y},r.PolyNode.prototype.GetNext=function(){return this.m_Childs.length>0?this.m_Childs[0]:this.GetNextSiblingUp()},r.PolyNode.prototype.GetNextSiblingUp=function(){return this.m_Parent===null?null:this.m_Index==this.m_Parent.m_Childs.length-1?this.m_Parent.GetNextSiblingUp():this.m_Parent.m_Childs[this.m_Index+1]},r.PolyNode.prototype.Childs=function(){return this.m_Childs},r.PolyNode.prototype.Parent=function(){return this.m_Parent},r.PolyNode.prototype.IsHole=function(){return this.IsHoleNode()},r.PolyTree=function(){this.m_AllPolys=[],r.PolyNode.call(this)},r.PolyTree.prototype.Clear=function(){for(var f=0,y=this.m_AllPolys.length;f<y;f++)this.m_AllPolys[f]=null;this.m_AllPolys.length=0,this.m_Childs.length=0},r.PolyTree.prototype.GetFirst=function(){return this.m_Childs.length>0?this.m_Childs[0]:null},r.PolyTree.prototype.Total=function(){return this.m_AllPolys.length},Oi(r.PolyTree,r.PolyNode),r.Math_Abs_Int64=r.Math_Abs_Int32=r.Math_Abs_Double=function(f){return Math.abs(f)},r.Math_Max_Int32_Int32=function(f,y){return Math.max(f,y)},s.msie||s.opera||s.safari?r.Cast_Int32=function(f){return f|0}:r.Cast_Int32=function(f){return~~f},s.chrome?r.Cast_Int64=function(f){return f<-2147483648||f>2147483647?f<0?Math.ceil(f):Math.floor(f):~~f}:s.firefox&&typeof Number.toInteger=="function"?r.Cast_Int64=function(f){return Number.toInteger(f)}:s.msie7||s.msie8?r.Cast_Int64=function(f){return parseInt(f,10)}:s.msie?r.Cast_Int64=function(f){return f<-2147483648||f>2147483647?f<0?Math.ceil(f):Math.floor(f):f|0}:r.Cast_Int64=function(f){return f<0?Math.ceil(f):Math.floor(f)},r.Clear=function(f){f.length=0},r.PI=3.141592653589793,r.PI2=2*3.141592653589793,r.IntPoint=function(){var f=arguments,y=f.length,S,I;if(this.X=0,this.Y=0,!t)if(y==2)this.X=f[0],this.Y=f[1];else if(y==1)if(f[0]instanceof r.DoublePoint){var S=f[0];this.X=r.Clipper.Round(S.X),this.Y=r.Clipper.Round(S.Y)}else{var I=f[0];this.X=I.X,this.Y=I.Y}else this.X=0,this.Y=0},r.IntPoint.op_Equality=function(f,y){return f.X==y.X&&f.Y==y.Y},r.IntPoint.op_Inequality=function(f,y){return f.X!=y.X||f.Y!=y.Y},r.IntPoint0=function(){this.X=0,this.Y=0},r.IntPoint1=function(f){this.X=f.X,this.Y=f.Y},r.IntPoint1dp=function(f){this.X=r.Clipper.Round(f.X),this.Y=r.Clipper.Round(f.Y)},r.IntPoint2=function(f,y){this.X=f,this.Y=y},r.IntRect=function(){var f=arguments,y=f.length;y==4?(this.left=f[0],this.top=f[1],this.right=f[2],this.bottom=f[3]):y==1?(this.left=ir.left,this.top=ir.top,this.right=ir.right,this.bottom=ir.bottom):(this.left=0,this.top=0,this.right=0,this.bottom=0)},r.IntRect0=function(){this.left=0,this.top=0,this.right=0,this.bottom=0},r.IntRect1=function(f){this.left=f.left,this.top=f.top,this.right=f.right,this.bottom=f.bottom},r.IntRect4=function(f,y,S,I){this.left=f,this.top=y,this.right=S,this.bottom=I},r.ClipType={ctIntersection:0,ctUnion:1,ctDifference:2,ctXor:3},r.PolyType={ptSubject:0,ptClip:1},r.PolyFillType={pftEvenOdd:0,pftNonZero:1,pftPositive:2,pftNegative:3},r.JoinType={jtSquare:0,jtRound:1,jtMiter:2},r.EndType={etOpenSquare:0,etOpenRound:1,etOpenButt:2,etClosedLine:3,etClosedPolygon:4},r.EdgeSide={esLeft:0,esRight:1},r.Direction={dRightToLeft:0,dLeftToRight:1},r.TEdge=function(){this.Bot=new r.IntPoint,this.Curr=new r.IntPoint,this.Top=new r.IntPoint,this.Delta=new r.IntPoint,this.Dx=0,this.PolyTyp=r.PolyType.ptSubject,this.Side=r.EdgeSide.esLeft,this.WindDelta=0,this.WindCnt=0,this.WindCnt2=0,this.OutIdx=0,this.Next=null,this.Prev=null,this.NextInLML=null,this.NextInAEL=null,this.PrevInAEL=null,this.NextInSEL=null,this.PrevInSEL=null},r.IntersectNode=function(){this.Edge1=null,this.Edge2=null,this.Pt=new r.IntPoint},r.MyIntersectNodeSort=function(){},r.MyIntersectNodeSort.Compare=function(f,y){return y.Pt.Y-f.Pt.Y},r.LocalMinima=function(){this.Y=0,this.LeftBound=null,this.RightBound=null,this.Next=null},r.Scanbeam=function(){this.Y=0,this.Next=null},r.OutRec=function(){this.Idx=0,this.IsHole=!1,this.IsOpen=!1,this.FirstLeft=null,this.Pts=null,this.BottomPt=null,this.PolyNode=null},r.OutPt=function(){this.Idx=0,this.Pt=new r.IntPoint,this.Next=null,this.Prev=null},r.Join=function(){this.OutPt1=null,this.OutPt2=null,this.OffPt=new r.IntPoint},r.ClipperBase=function(){this.m_MinimaList=null,this.m_CurrentLM=null,this.m_edges=new Array,this.m_UseFullRange=!1,this.m_HasOpenPaths=!1,this.PreserveCollinear=!1,this.m_MinimaList=null,this.m_CurrentLM=null,this.m_UseFullRange=!1,this.m_HasOpenPaths=!1},r.ClipperBase.horizontal=-9007199254740992,r.ClipperBase.Skip=-2,r.ClipperBase.Unassigned=-1,r.ClipperBase.tolerance=1e-20,r.ClipperBase.loRange=47453132,r.ClipperBase.hiRange=0xfffffffffffff,r.ClipperBase.near_zero=function(f){return f>-r.ClipperBase.tolerance&&f<r.ClipperBase.tolerance},r.ClipperBase.IsHorizontal=function(f){return f.Delta.Y===0},r.ClipperBase.prototype.PointIsVertex=function(f,y){var S=y;do{if(r.IntPoint.op_Equality(S.Pt,f))return!0;S=S.Next}while(S!=y);return!1},r.ClipperBase.prototype.PointOnLineSegment=function(f,y,S,I){return I?f.X==y.X&&f.Y==y.Y||f.X==S.X&&f.Y==S.Y||f.X>y.X==f.X<S.X&&f.Y>y.Y==f.Y<S.Y&&$t.op_Equality($t.Int128Mul(f.X-y.X,S.Y-y.Y),$t.Int128Mul(S.X-y.X,f.Y-y.Y)):f.X==y.X&&f.Y==y.Y||f.X==S.X&&f.Y==S.Y||f.X>y.X==f.X<S.X&&f.Y>y.Y==f.Y<S.Y&&(f.X-y.X)*(S.Y-y.Y)==(S.X-y.X)*(f.Y-y.Y)},r.ClipperBase.prototype.PointOnPolygon=function(f,y,S){for(var I=y;;){if(this.PointOnLineSegment(f,I.Pt,I.Next.Pt,S))return!0;if(I=I.Next,I==y)break}return!1},r.ClipperBase.prototype.SlopesEqual=r.ClipperBase.SlopesEqual=function(){var f=arguments,y=f.length,S,I,F,H,X,se,de;return y==3?(S=f[0],I=f[1],de=f[2],de?$t.op_Equality($t.Int128Mul(S.Delta.Y,I.Delta.X),$t.Int128Mul(S.Delta.X,I.Delta.Y)):r.Cast_Int64(S.Delta.Y*I.Delta.X)==r.Cast_Int64(S.Delta.X*I.Delta.Y)):y==4?(F=f[0],H=f[1],X=f[2],de=f[3],de?$t.op_Equality($t.Int128Mul(F.Y-H.Y,H.X-X.X),$t.Int128Mul(F.X-H.X,H.Y-X.Y)):r.Cast_Int64((F.Y-H.Y)*(H.X-X.X))-r.Cast_Int64((F.X-H.X)*(H.Y-X.Y))===0):(F=f[0],H=f[1],X=f[2],se=f[3],de=f[4],de?$t.op_Equality($t.Int128Mul(F.Y-H.Y,X.X-se.X),$t.Int128Mul(F.X-H.X,X.Y-se.Y)):r.Cast_Int64((F.Y-H.Y)*(X.X-se.X))-r.Cast_Int64((F.X-H.X)*(X.Y-se.Y))===0)},r.ClipperBase.SlopesEqual3=function(f,y,S){return S?$t.op_Equality($t.Int128Mul(f.Delta.Y,y.Delta.X),$t.Int128Mul(f.Delta.X,y.Delta.Y)):r.Cast_Int64(f.Delta.Y*y.Delta.X)==r.Cast_Int64(f.Delta.X*y.Delta.Y)},r.ClipperBase.SlopesEqual4=function(f,y,S,I){return I?$t.op_Equality($t.Int128Mul(f.Y-y.Y,y.X-S.X),$t.Int128Mul(f.X-y.X,y.Y-S.Y)):r.Cast_Int64((f.Y-y.Y)*(y.X-S.X))-r.Cast_Int64((f.X-y.X)*(y.Y-S.Y))===0},r.ClipperBase.SlopesEqual5=function(f,y,S,I,F){return F?$t.op_Equality($t.Int128Mul(f.Y-y.Y,S.X-I.X),$t.Int128Mul(f.X-y.X,S.Y-I.Y)):r.Cast_Int64((f.Y-y.Y)*(S.X-I.X))-r.Cast_Int64((f.X-y.X)*(S.Y-I.Y))===0},r.ClipperBase.prototype.Clear=function(){this.DisposeLocalMinimaList();for(var f=0,y=this.m_edges.length;f<y;++f){for(var S=0,I=this.m_edges[f].length;S<I;++S)this.m_edges[f][S]=null;r.Clear(this.m_edges[f])}r.Clear(this.m_edges),this.m_UseFullRange=!1,this.m_HasOpenPaths=!1},r.ClipperBase.prototype.DisposeLocalMinimaList=function(){for(;this.m_MinimaList!==null;){var f=this.m_MinimaList.Next;this.m_MinimaList=null,this.m_MinimaList=f}this.m_CurrentLM=null},r.ClipperBase.prototype.RangeTest=function(f,y){y.Value?(f.X>r.ClipperBase.hiRange||f.Y>r.ClipperBase.hiRange||-f.X>r.ClipperBase.hiRange||-f.Y>r.ClipperBase.hiRange)&&r.Error("Coordinate outside allowed range in RangeTest()."):(f.X>r.ClipperBase.loRange||f.Y>r.ClipperBase.loRange||-f.X>r.ClipperBase.loRange||-f.Y>r.ClipperBase.loRange)&&(y.Value=!0,this.RangeTest(f,y))},r.ClipperBase.prototype.InitEdge=function(f,y,S,I){f.Next=y,f.Prev=S,f.Curr.X=I.X,f.Curr.Y=I.Y,f.OutIdx=-1},r.ClipperBase.prototype.InitEdge2=function(f,y){f.Curr.Y>=f.Next.Curr.Y?(f.Bot.X=f.Curr.X,f.Bot.Y=f.Curr.Y,f.Top.X=f.Next.Curr.X,f.Top.Y=f.Next.Curr.Y):(f.Top.X=f.Curr.X,f.Top.Y=f.Curr.Y,f.Bot.X=f.Next.Curr.X,f.Bot.Y=f.Next.Curr.Y),this.SetDx(f),f.PolyTyp=y},r.ClipperBase.prototype.FindNextLocMin=function(f){for(var y;;){for(;r.IntPoint.op_Inequality(f.Bot,f.Prev.Bot)||r.IntPoint.op_Equality(f.Curr,f.Top);)f=f.Next;if(f.Dx!=r.ClipperBase.horizontal&&f.Prev.Dx!=r.ClipperBase.horizontal)break;for(;f.Prev.Dx==r.ClipperBase.horizontal;)f=f.Prev;for(y=f;f.Dx==r.ClipperBase.horizontal;)f=f.Next;if(f.Top.Y!=f.Prev.Bot.Y){y.Prev.Bot.X<f.Bot.X&&(f=y);break}}return f},r.ClipperBase.prototype.ProcessBound=function(f,y){var S=f,I=f,F,H;if(f.Dx==r.ClipperBase.horizontal&&(y?H=f.Prev.Bot.X:H=f.Next.Bot.X,f.Bot.X!=H&&this.ReverseHorizontal(f)),I.OutIdx!=r.ClipperBase.Skip)if(y){for(;I.Top.Y==I.Next.Bot.Y&&I.Next.OutIdx!=r.ClipperBase.Skip;)I=I.Next;if(I.Dx==r.ClipperBase.horizontal&&I.Next.OutIdx!=r.ClipperBase.Skip){for(F=I;F.Prev.Dx==r.ClipperBase.horizontal;)F=F.Prev;F.Prev.Top.X==I.Next.Top.X?y||(I=F.Prev):F.Prev.Top.X>I.Next.Top.X&&(I=F.Prev)}for(;f!=I;)f.NextInLML=f.Next,f.Dx==r.ClipperBase.horizontal&&f!=S&&f.Bot.X!=f.Prev.Top.X&&this.ReverseHorizontal(f),f=f.Next;f.Dx==r.ClipperBase.horizontal&&f!=S&&f.Bot.X!=f.Prev.Top.X&&this.ReverseHorizontal(f),I=I.Next}else{for(;I.Top.Y==I.Prev.Bot.Y&&I.Prev.OutIdx!=r.ClipperBase.Skip;)I=I.Prev;if(I.Dx==r.ClipperBase.horizontal&&I.Prev.OutIdx!=r.ClipperBase.Skip){for(F=I;F.Next.Dx==r.ClipperBase.horizontal;)F=F.Next;F.Next.Top.X==I.Prev.Top.X?y||(I=F.Next):F.Next.Top.X>I.Prev.Top.X&&(I=F.Next)}for(;f!=I;)f.NextInLML=f.Prev,f.Dx==r.ClipperBase.horizontal&&f!=S&&f.Bot.X!=f.Next.Top.X&&this.ReverseHorizontal(f),f=f.Prev;f.Dx==r.ClipperBase.horizontal&&f!=S&&f.Bot.X!=f.Next.Top.X&&this.ReverseHorizontal(f),I=I.Prev}if(I.OutIdx==r.ClipperBase.Skip){if(f=I,y){for(;f.Top.Y==f.Next.Bot.Y;)f=f.Next;for(;f!=I&&f.Dx==r.ClipperBase.horizontal;)f=f.Prev}else{for(;f.Top.Y==f.Prev.Bot.Y;)f=f.Prev;for(;f!=I&&f.Dx==r.ClipperBase.horizontal;)f=f.Next}if(f==I)y?I=f.Next:I=f.Prev;else{y?f=I.Next:f=I.Prev;var X=new r.LocalMinima;X.Next=null,X.Y=f.Bot.Y,X.LeftBound=null,X.RightBound=f,X.RightBound.WindDelta=0,I=this.ProcessBound(X.RightBound,y),this.InsertLocalMinima(X)}}return I},r.ClipperBase.prototype.AddPath=function(f,y,S){!S&&y==r.PolyType.ptClip&&r.Error("AddPath: Open paths must be subject.");var I=f.length-1;if(S)for(;I>0&&r.IntPoint.op_Equality(f[I],f[0]);)--I;for(;I>0&&r.IntPoint.op_Equality(f[I],f[I-1]);)--I;if(S&&I<2||!S&&I<1)return!1;for(var F=new Array,H=0;H<=I;H++)F.push(new r.TEdge);var X=!0;F[1].Curr.X=f[1].X,F[1].Curr.Y=f[1].Y;var se={Value:this.m_UseFullRange};this.RangeTest(f[0],se),this.m_UseFullRange=se.Value,se.Value=this.m_UseFullRange,this.RangeTest(f[I],se),this.m_UseFullRange=se.Value,this.InitEdge(F[0],F[1],F[I],f[0]),this.InitEdge(F[I],F[0],F[I-1],f[I]);for(var H=I-1;H>=1;--H)se.Value=this.m_UseFullRange,this.RangeTest(f[H],se),this.m_UseFullRange=se.Value,this.InitEdge(F[H],F[H+1],F[H-1],f[H]);for(var de=F[0],Ee=de,Ue=de;;){if(r.IntPoint.op_Equality(Ee.Curr,Ee.Next.Curr)){if(Ee==Ee.Next)break;Ee==de&&(de=Ee.Next),Ee=this.RemoveEdge(Ee),Ue=Ee;continue}if(Ee.Prev==Ee.Next)break;if(S&&r.ClipperBase.SlopesEqual(Ee.Prev.Curr,Ee.Curr,Ee.Next.Curr,this.m_UseFullRange)&&(!this.PreserveCollinear||!this.Pt2IsBetweenPt1AndPt3(Ee.Prev.Curr,Ee.Curr,Ee.Next.Curr))){Ee==de&&(de=Ee.Next),Ee=this.RemoveEdge(Ee),Ee=Ee.Prev,Ue=Ee;continue}if(Ee=Ee.Next,Ee==Ue)break}if(!S&&Ee==Ee.Next||S&&Ee.Prev==Ee.Next)return!1;S||(this.m_HasOpenPaths=!0,de.Prev.OutIdx=r.ClipperBase.Skip),Ee=de;do this.InitEdge2(Ee,y),Ee=Ee.Next,X&&Ee.Curr.Y!=de.Curr.Y&&(X=!1);while(Ee!=de);if(X){if(S)return!1;Ee.Prev.OutIdx=r.ClipperBase.Skip,Ee.Prev.Bot.X<Ee.Prev.Top.X&&this.ReverseHorizontal(Ee.Prev);var Ye=new r.LocalMinima;for(Ye.Next=null,Ye.Y=Ee.Bot.Y,Ye.LeftBound=null,Ye.RightBound=Ee,Ye.RightBound.Side=r.EdgeSide.esRight,Ye.RightBound.WindDelta=0;Ee.Next.OutIdx!=r.ClipperBase.Skip;)Ee.NextInLML=Ee.Next,Ee.Bot.X!=Ee.Prev.Top.X&&this.ReverseHorizontal(Ee),Ee=Ee.Next;return this.InsertLocalMinima(Ye),this.m_edges.push(F),!0}this.m_edges.push(F);for(var dt,Pt=null;Ee=this.FindNextLocMin(Ee),Ee!=Pt;){Pt==null&&(Pt=Ee);var Ye=new r.LocalMinima;Ye.Next=null,Ye.Y=Ee.Bot.Y,Ee.Dx<Ee.Prev.Dx?(Ye.LeftBound=Ee.Prev,Ye.RightBound=Ee,dt=!1):(Ye.LeftBound=Ee,Ye.RightBound=Ee.Prev,dt=!0),Ye.LeftBound.Side=r.EdgeSide.esLeft,Ye.RightBound.Side=r.EdgeSide.esRight,S?Ye.LeftBound.Next==Ye.RightBound?Ye.LeftBound.WindDelta=-1:Ye.LeftBound.WindDelta=1:Ye.LeftBound.WindDelta=0,Ye.RightBound.WindDelta=-Ye.LeftBound.WindDelta,Ee=this.ProcessBound(Ye.LeftBound,dt);var Ct=this.ProcessBound(Ye.RightBound,!dt);Ye.LeftBound.OutIdx==r.ClipperBase.Skip?Ye.LeftBound=null:Ye.RightBound.OutIdx==r.ClipperBase.Skip&&(Ye.RightBound=null),this.InsertLocalMinima(Ye),dt||(Ee=Ct)}return!0},r.ClipperBase.prototype.AddPaths=function(f,y,S){for(var I=!1,F=0,H=f.length;F<H;++F)this.AddPath(f[F],y,S)&&(I=!0);return I},r.ClipperBase.prototype.Pt2IsBetweenPt1AndPt3=function(f,y,S){return r.IntPoint.op_Equality(f,S)||r.IntPoint.op_Equality(f,y)||r.IntPoint.op_Equality(S,y)?!1:f.X!=S.X?y.X>f.X==y.X<S.X:y.Y>f.Y==y.Y<S.Y},r.ClipperBase.prototype.RemoveEdge=function(f){f.Prev.Next=f.Next,f.Next.Prev=f.Prev;var y=f.Next;return f.Prev=null,y},r.ClipperBase.prototype.SetDx=function(f){f.Delta.X=f.Top.X-f.Bot.X,f.Delta.Y=f.Top.Y-f.Bot.Y,f.Delta.Y===0?f.Dx=r.ClipperBase.horizontal:f.Dx=f.Delta.X/f.Delta.Y},r.ClipperBase.prototype.InsertLocalMinima=function(f){if(this.m_MinimaList===null)this.m_MinimaList=f;else if(f.Y>=this.m_MinimaList.Y)f.Next=this.m_MinimaList,this.m_MinimaList=f;else{for(var y=this.m_MinimaList;y.Next!==null&&f.Y<y.Next.Y;)y=y.Next;f.Next=y.Next,y.Next=f}},r.ClipperBase.prototype.PopLocalMinima=function(){this.m_CurrentLM!==null&&(this.m_CurrentLM=this.m_CurrentLM.Next)},r.ClipperBase.prototype.ReverseHorizontal=function(f){var y=f.Top.X;f.Top.X=f.Bot.X,f.Bot.X=y},r.ClipperBase.prototype.Reset=function(){if(this.m_CurrentLM=this.m_MinimaList,this.m_CurrentLM!=null)for(var f=this.m_MinimaList;f!=null;){var y=f.LeftBound;y!=null&&(y.Curr.X=y.Bot.X,y.Curr.Y=y.Bot.Y,y.Side=r.EdgeSide.esLeft,y.OutIdx=r.ClipperBase.Unassigned),y=f.RightBound,y!=null&&(y.Curr.X=y.Bot.X,y.Curr.Y=y.Bot.Y,y.Side=r.EdgeSide.esRight,y.OutIdx=r.ClipperBase.Unassigned),f=f.Next}},r.Clipper=function(f){typeof f>"u"&&(f=0),this.m_PolyOuts=null,this.m_ClipType=r.ClipType.ctIntersection,this.m_Scanbeam=null,this.m_ActiveEdges=null,this.m_SortedEdges=null,this.m_IntersectList=null,this.m_IntersectNodeComparer=null,this.m_ExecuteLocked=!1,this.m_ClipFillType=r.PolyFillType.pftEvenOdd,this.m_SubjFillType=r.PolyFillType.pftEvenOdd,this.m_Joins=null,this.m_GhostJoins=null,this.m_UsingPolyTree=!1,this.ReverseSolution=!1,this.StrictlySimple=!1,r.ClipperBase.call(this),this.m_Scanbeam=null,this.m_ActiveEdges=null,this.m_SortedEdges=null,this.m_IntersectList=new Array,this.m_IntersectNodeComparer=r.MyIntersectNodeSort.Compare,this.m_ExecuteLocked=!1,this.m_UsingPolyTree=!1,this.m_PolyOuts=new Array,this.m_Joins=new Array,this.m_GhostJoins=new Array,this.ReverseSolution=(1&f)!==0,this.StrictlySimple=(2&f)!==0,this.PreserveCollinear=(4&f)!==0},r.Clipper.ioReverseSolution=1,r.Clipper.ioStrictlySimple=2,r.Clipper.ioPreserveCollinear=4,r.Clipper.prototype.Clear=function(){this.m_edges.length!==0&&(this.DisposeAllPolyPts(),r.ClipperBase.prototype.Clear.call(this))},r.Clipper.prototype.DisposeScanbeamList=function(){for(;this.m_Scanbeam!==null;){var f=this.m_Scanbeam.Next;this.m_Scanbeam=null,this.m_Scanbeam=f}},r.Clipper.prototype.Reset=function(){r.ClipperBase.prototype.Reset.call(this),this.m_Scanbeam=null,this.m_ActiveEdges=null,this.m_SortedEdges=null;for(var f=this.m_MinimaList;f!==null;)this.InsertScanbeam(f.Y),f=f.Next},r.Clipper.prototype.InsertScanbeam=function(f){if(this.m_Scanbeam===null)this.m_Scanbeam=new r.Scanbeam,this.m_Scanbeam.Next=null,this.m_Scanbeam.Y=f;else if(f>this.m_Scanbeam.Y){var y=new r.Scanbeam;y.Y=f,y.Next=this.m_Scanbeam,this.m_Scanbeam=y}else{for(var S=this.m_Scanbeam;S.Next!==null&&f<=S.Next.Y;)S=S.Next;if(f==S.Y)return;var y=new r.Scanbeam;y.Y=f,y.Next=S.Next,S.Next=y}},r.Clipper.prototype.Execute=function(){var f=arguments,y=f.length,S=f[1]instanceof r.PolyTree;if(y==4&&!S){var I=f[0],F=f[1],H=f[2],X=f[3];if(this.m_ExecuteLocked)return!1;this.m_HasOpenPaths&&r.Error("Error: PolyTree struct is need for open path clipping."),this.m_ExecuteLocked=!0,r.Clear(F),this.m_SubjFillType=H,this.m_ClipFillType=X,this.m_ClipType=I,this.m_UsingPolyTree=!1;try{var se=this.ExecuteInternal();se&&this.BuildResult(F)}finally{this.DisposeAllPolyPts(),this.m_ExecuteLocked=!1}return se}else if(y==4&&S){var I=f[0],de=f[1],H=f[2],X=f[3];if(this.m_ExecuteLocked)return!1;this.m_ExecuteLocked=!0,this.m_SubjFillType=H,this.m_ClipFillType=X,this.m_ClipType=I,this.m_UsingPolyTree=!0;try{var se=this.ExecuteInternal();se&&this.BuildResult2(de)}finally{this.DisposeAllPolyPts(),this.m_ExecuteLocked=!1}return se}else if(y==2&&!S){var I=f[0],F=f[1];return this.Execute(I,F,r.PolyFillType.pftEvenOdd,r.PolyFillType.pftEvenOdd)}else if(y==2&&S){var I=f[0],de=f[1];return this.Execute(I,de,r.PolyFillType.pftEvenOdd,r.PolyFillType.pftEvenOdd)}},r.Clipper.prototype.FixHoleLinkage=function(f){if(!(f.FirstLeft===null||f.IsHole!=f.FirstLeft.IsHole&&f.FirstLeft.Pts!==null)){for(var y=f.FirstLeft;y!==null&&(y.IsHole==f.IsHole||y.Pts===null);)y=y.FirstLeft;f.FirstLeft=y}},r.Clipper.prototype.ExecuteInternal=function(){try{if(this.Reset(),this.m_CurrentLM===null)return!1;var f=this.PopScanbeam();do{if(this.InsertLocalMinimaIntoAEL(f),r.Clear(this.m_GhostJoins),this.ProcessHorizontals(!1),this.m_Scanbeam===null)break;var y=this.PopScanbeam();if(!this.ProcessIntersections(f,y))return!1;this.ProcessEdgesAtTopOfScanbeam(y),f=y}while(this.m_Scanbeam!==null||this.m_CurrentLM!==null);for(var S=0,I=this.m_PolyOuts.length;S<I;S++){var F=this.m_PolyOuts[S];F.Pts===null||F.IsOpen||(F.IsHole^this.ReverseSolution)==this.Area(F)>0&&this.ReversePolyPtLinks(F.Pts)}this.JoinCommonEdges();for(var S=0,I=this.m_PolyOuts.length;S<I;S++){var F=this.m_PolyOuts[S];F.Pts!==null&&!F.IsOpen&&this.FixupOutPolygon(F)}return this.StrictlySimple&&this.DoSimplePolygons(),!0}finally{r.Clear(this.m_Joins),r.Clear(this.m_GhostJoins)}},r.Clipper.prototype.PopScanbeam=function(){var f=this.m_Scanbeam.Y;return this.m_Scanbeam,this.m_Scanbeam=this.m_Scanbeam.Next,f},r.Clipper.prototype.DisposeAllPolyPts=function(){for(var f=0,y=this.m_PolyOuts.length;f<y;++f)this.DisposeOutRec(f);r.Clear(this.m_PolyOuts)},r.Clipper.prototype.DisposeOutRec=function(f){var y=this.m_PolyOuts[f];y.Pts!==null&&this.DisposeOutPts(y.Pts),y=null,this.m_PolyOuts[f]=null},r.Clipper.prototype.DisposeOutPts=function(f){if(f!==null)for(f.Prev.Next=null;f!==null;)f=f.Next},r.Clipper.prototype.AddJoin=function(f,y,S){var I=new r.Join;I.OutPt1=f,I.OutPt2=y,I.OffPt.X=S.X,I.OffPt.Y=S.Y,this.m_Joins.push(I)},r.Clipper.prototype.AddGhostJoin=function(f,y){var S=new r.Join;S.OutPt1=f,S.OffPt.X=y.X,S.OffPt.Y=y.Y,this.m_GhostJoins.push(S)},r.Clipper.prototype.InsertLocalMinimaIntoAEL=function(f){for(;this.m_CurrentLM!==null&&this.m_CurrentLM.Y==f;){var y=this.m_CurrentLM.LeftBound,S=this.m_CurrentLM.RightBound;this.PopLocalMinima();var I=null;if(y===null?(this.InsertEdgeIntoAEL(S,null),this.SetWindingCount(S),this.IsContributing(S)&&(I=this.AddOutPt(S,S.Bot))):S==null?(this.InsertEdgeIntoAEL(y,null),this.SetWindingCount(y),this.IsContributing(y)&&(I=this.AddOutPt(y,y.Bot)),this.InsertScanbeam(y.Top.Y)):(this.InsertEdgeIntoAEL(y,null),this.InsertEdgeIntoAEL(S,y),this.SetWindingCount(y),S.WindCnt=y.WindCnt,S.WindCnt2=y.WindCnt2,this.IsContributing(y)&&(I=this.AddLocalMinPoly(y,S,y.Bot)),this.InsertScanbeam(y.Top.Y)),S!=null&&(r.ClipperBase.IsHorizontal(S)?this.AddEdgeToSEL(S):this.InsertScanbeam(S.Top.Y)),!(y==null||S==null)){if(I!==null&&r.ClipperBase.IsHorizontal(S)&&this.m_GhostJoins.length>0&&S.WindDelta!==0)for(var F=0,H=this.m_GhostJoins.length;F<H;F++){var X=this.m_GhostJoins[F];this.HorzSegmentsOverlap(X.OutPt1.Pt,X.OffPt,S.Bot,S.Top)&&this.AddJoin(X.OutPt1,I,X.OffPt)}if(y.OutIdx>=0&&y.PrevInAEL!==null&&y.PrevInAEL.Curr.X==y.Bot.X&&y.PrevInAEL.OutIdx>=0&&r.ClipperBase.SlopesEqual(y.PrevInAEL,y,this.m_UseFullRange)&&y.WindDelta!==0&&y.PrevInAEL.WindDelta!==0){var se=this.AddOutPt(y.PrevInAEL,y.Bot);this.AddJoin(I,se,y.Top)}if(y.NextInAEL!=S){if(S.OutIdx>=0&&S.PrevInAEL.OutIdx>=0&&r.ClipperBase.SlopesEqual(S.PrevInAEL,S,this.m_UseFullRange)&&S.WindDelta!==0&&S.PrevInAEL.WindDelta!==0){var se=this.AddOutPt(S.PrevInAEL,S.Bot);this.AddJoin(I,se,S.Top)}var de=y.NextInAEL;if(de!==null)for(;de!=S;)this.IntersectEdges(S,de,y.Curr,!1),de=de.NextInAEL}}}},r.Clipper.prototype.InsertEdgeIntoAEL=function(f,y){if(this.m_ActiveEdges===null)f.PrevInAEL=null,f.NextInAEL=null,this.m_ActiveEdges=f;else if(y===null&&this.E2InsertsBeforeE1(this.m_ActiveEdges,f))f.PrevInAEL=null,f.NextInAEL=this.m_ActiveEdges,this.m_ActiveEdges.PrevInAEL=f,this.m_ActiveEdges=f;else{for(y===null&&(y=this.m_ActiveEdges);y.NextInAEL!==null&&!this.E2InsertsBeforeE1(y.NextInAEL,f);)y=y.NextInAEL;f.NextInAEL=y.NextInAEL,y.NextInAEL!==null&&(y.NextInAEL.PrevInAEL=f),f.PrevInAEL=y,y.NextInAEL=f}},r.Clipper.prototype.E2InsertsBeforeE1=function(f,y){return y.Curr.X==f.Curr.X?y.Top.Y>f.Top.Y?y.Top.X<r.Clipper.TopX(f,y.Top.Y):f.Top.X>r.Clipper.TopX(y,f.Top.Y):y.Curr.X<f.Curr.X},r.Clipper.prototype.IsEvenOddFillType=function(f){return f.PolyTyp==r.PolyType.ptSubject?this.m_SubjFillType==r.PolyFillType.pftEvenOdd:this.m_ClipFillType==r.PolyFillType.pftEvenOdd},r.Clipper.prototype.IsEvenOddAltFillType=function(f){return f.PolyTyp==r.PolyType.ptSubject?this.m_ClipFillType==r.PolyFillType.pftEvenOdd:this.m_SubjFillType==r.PolyFillType.pftEvenOdd},r.Clipper.prototype.IsContributing=function(f){var y,S;switch(f.PolyTyp==r.PolyType.ptSubject?(y=this.m_SubjFillType,S=this.m_ClipFillType):(y=this.m_ClipFillType,S=this.m_SubjFillType),y){case r.PolyFillType.pftEvenOdd:if(f.WindDelta===0&&f.WindCnt!=1)return!1;break;case r.PolyFillType.pftNonZero:if(Math.abs(f.WindCnt)!=1)return!1;break;case r.PolyFillType.pftPositive:if(f.WindCnt!=1)return!1;break;default:if(f.WindCnt!=-1)return!1;break}switch(this.m_ClipType){case r.ClipType.ctIntersection:switch(S){case r.PolyFillType.pftEvenOdd:case r.PolyFillType.pftNonZero:return f.WindCnt2!==0;case r.PolyFillType.pftPositive:return f.WindCnt2>0;default:return f.WindCnt2<0}case r.ClipType.ctUnion:switch(S){case r.PolyFillType.pftEvenOdd:case r.PolyFillType.pftNonZero:return f.WindCnt2===0;case r.PolyFillType.pftPositive:return f.WindCnt2<=0;default:return f.WindCnt2>=0}case r.ClipType.ctDifference:if(f.PolyTyp==r.PolyType.ptSubject)switch(S){case r.PolyFillType.pftEvenOdd:case r.PolyFillType.pftNonZero:return f.WindCnt2===0;case r.PolyFillType.pftPositive:return f.WindCnt2<=0;default:return f.WindCnt2>=0}else switch(S){case r.PolyFillType.pftEvenOdd:case r.PolyFillType.pftNonZero:return f.WindCnt2!==0;case r.PolyFillType.pftPositive:return f.WindCnt2>0;default:return f.WindCnt2<0}case r.ClipType.ctXor:if(f.WindDelta===0)switch(S){case r.PolyFillType.pftEvenOdd:case r.PolyFillType.pftNonZero:return f.WindCnt2===0;case r.PolyFillType.pftPositive:return f.WindCnt2<=0;default:return f.WindCnt2>=0}else return!0}return!0},r.Clipper.prototype.SetWindingCount=function(f){for(var y=f.PrevInAEL;y!==null&&(y.PolyTyp!=f.PolyTyp||y.WindDelta===0);)y=y.PrevInAEL;if(y===null)f.WindCnt=f.WindDelta===0?1:f.WindDelta,f.WindCnt2=0,y=this.m_ActiveEdges;else if(f.WindDelta===0&&this.m_ClipType!=r.ClipType.ctUnion)f.WindCnt=1,f.WindCnt2=y.WindCnt2,y=y.NextInAEL;else if(this.IsEvenOddFillType(f)){if(f.WindDelta===0){for(var S=!0,I=y.PrevInAEL;I!==null;)I.PolyTyp==y.PolyTyp&&I.WindDelta!==0&&(S=!S),I=I.PrevInAEL;f.WindCnt=S?0:1}else f.WindCnt=f.WindDelta;f.WindCnt2=y.WindCnt2,y=y.NextInAEL}else y.WindCnt*y.WindDelta<0?Math.abs(y.WindCnt)>1?y.WindDelta*f.WindDelta<0?f.WindCnt=y.WindCnt:f.WindCnt=y.WindCnt+f.WindDelta:f.WindCnt=f.WindDelta===0?1:f.WindDelta:f.WindDelta===0?f.WindCnt=y.WindCnt<0?y.WindCnt-1:y.WindCnt+1:y.WindDelta*f.WindDelta<0?f.WindCnt=y.WindCnt:f.WindCnt=y.WindCnt+f.WindDelta,f.WindCnt2=y.WindCnt2,y=y.NextInAEL;if(this.IsEvenOddAltFillType(f))for(;y!=f;)y.WindDelta!==0&&(f.WindCnt2=f.WindCnt2===0?1:0),y=y.NextInAEL;else for(;y!=f;)f.WindCnt2+=y.WindDelta,y=y.NextInAEL},r.Clipper.prototype.AddEdgeToSEL=function(f){this.m_SortedEdges===null?(this.m_SortedEdges=f,f.PrevInSEL=null,f.NextInSEL=null):(f.NextInSEL=this.m_SortedEdges,f.PrevInSEL=null,this.m_SortedEdges.PrevInSEL=f,this.m_SortedEdges=f)},r.Clipper.prototype.CopyAELToSEL=function(){var f=this.m_ActiveEdges;for(this.m_SortedEdges=f;f!==null;)f.PrevInSEL=f.PrevInAEL,f.NextInSEL=f.NextInAEL,f=f.NextInAEL},r.Clipper.prototype.SwapPositionsInAEL=function(f,y){if(!(f.NextInAEL==f.PrevInAEL||y.NextInAEL==y.PrevInAEL)){if(f.NextInAEL==y){var S=y.NextInAEL;S!==null&&(S.PrevInAEL=f);var I=f.PrevInAEL;I!==null&&(I.NextInAEL=y),y.PrevInAEL=I,y.NextInAEL=f,f.PrevInAEL=y,f.NextInAEL=S}else if(y.NextInAEL==f){var S=f.NextInAEL;S!==null&&(S.PrevInAEL=y);var I=y.PrevInAEL;I!==null&&(I.NextInAEL=f),f.PrevInAEL=I,f.NextInAEL=y,y.PrevInAEL=f,y.NextInAEL=S}else{var S=f.NextInAEL,I=f.PrevInAEL;f.NextInAEL=y.NextInAEL,f.NextInAEL!==null&&(f.NextInAEL.PrevInAEL=f),f.PrevInAEL=y.PrevInAEL,f.PrevInAEL!==null&&(f.PrevInAEL.NextInAEL=f),y.NextInAEL=S,y.NextInAEL!==null&&(y.NextInAEL.PrevInAEL=y),y.PrevInAEL=I,y.PrevInAEL!==null&&(y.PrevInAEL.NextInAEL=y)}f.PrevInAEL===null?this.m_ActiveEdges=f:y.PrevInAEL===null&&(this.m_ActiveEdges=y)}},r.Clipper.prototype.SwapPositionsInSEL=function(f,y){if(!(f.NextInSEL===null&&f.PrevInSEL===null)&&!(y.NextInSEL===null&&y.PrevInSEL===null)){if(f.NextInSEL==y){var S=y.NextInSEL;S!==null&&(S.PrevInSEL=f);var I=f.PrevInSEL;I!==null&&(I.NextInSEL=y),y.PrevInSEL=I,y.NextInSEL=f,f.PrevInSEL=y,f.NextInSEL=S}else if(y.NextInSEL==f){var S=f.NextInSEL;S!==null&&(S.PrevInSEL=y);var I=y.PrevInSEL;I!==null&&(I.NextInSEL=f),f.PrevInSEL=I,f.NextInSEL=y,y.PrevInSEL=f,y.NextInSEL=S}else{var S=f.NextInSEL,I=f.PrevInSEL;f.NextInSEL=y.NextInSEL,f.NextInSEL!==null&&(f.NextInSEL.PrevInSEL=f),f.PrevInSEL=y.PrevInSEL,f.PrevInSEL!==null&&(f.PrevInSEL.NextInSEL=f),y.NextInSEL=S,y.NextInSEL!==null&&(y.NextInSEL.PrevInSEL=y),y.PrevInSEL=I,y.PrevInSEL!==null&&(y.PrevInSEL.NextInSEL=y)}f.PrevInSEL===null?this.m_SortedEdges=f:y.PrevInSEL===null&&(this.m_SortedEdges=y)}},r.Clipper.prototype.AddLocalMaxPoly=function(f,y,S){this.AddOutPt(f,S),y.WindDelta==0&&this.AddOutPt(y,S),f.OutIdx==y.OutIdx?(f.OutIdx=-1,y.OutIdx=-1):f.OutIdx<y.OutIdx?this.AppendPolygon(f,y):this.AppendPolygon(y,f)},r.Clipper.prototype.AddLocalMinPoly=function(f,y,S){var I,F,H;if(r.ClipperBase.IsHorizontal(y)||f.Dx>y.Dx?(I=this.AddOutPt(f,S),y.OutIdx=f.OutIdx,f.Side=r.EdgeSide.esLeft,y.Side=r.EdgeSide.esRight,F=f,F.PrevInAEL==y?H=y.PrevInAEL:H=F.PrevInAEL):(I=this.AddOutPt(y,S),f.OutIdx=y.OutIdx,f.Side=r.EdgeSide.esRight,y.Side=r.EdgeSide.esLeft,F=y,F.PrevInAEL==f?H=f.PrevInAEL:H=F.PrevInAEL),H!==null&&H.OutIdx>=0&&r.Clipper.TopX(H,S.Y)==r.Clipper.TopX(F,S.Y)&&r.ClipperBase.SlopesEqual(F,H,this.m_UseFullRange)&&F.WindDelta!==0&&H.WindDelta!==0){var X=this.AddOutPt(H,S);this.AddJoin(I,X,F.Top)}return I},r.Clipper.prototype.CreateOutRec=function(){var f=new r.OutRec;return f.Idx=-1,f.IsHole=!1,f.IsOpen=!1,f.FirstLeft=null,f.Pts=null,f.BottomPt=null,f.PolyNode=null,this.m_PolyOuts.push(f),f.Idx=this.m_PolyOuts.length-1,f},r.Clipper.prototype.AddOutPt=function(f,y){var S=f.Side==r.EdgeSide.esLeft;if(f.OutIdx<0){var I=this.CreateOutRec();I.IsOpen=f.WindDelta===0;var F=new r.OutPt;return I.Pts=F,F.Idx=I.Idx,F.Pt.X=y.X,F.Pt.Y=y.Y,F.Next=F,F.Prev=F,I.IsOpen||this.SetHoleState(f,I),f.OutIdx=I.Idx,F}else{var I=this.m_PolyOuts[f.OutIdx],H=I.Pts;if(S&&r.IntPoint.op_Equality(y,H.Pt))return H;if(!S&&r.IntPoint.op_Equality(y,H.Prev.Pt))return H.Prev;var F=new r.OutPt;return F.Idx=I.Idx,F.Pt.X=y.X,F.Pt.Y=y.Y,F.Next=H,F.Prev=H.Prev,F.Prev.Next=F,H.Prev=F,S&&(I.Pts=F),F}},r.Clipper.prototype.SwapPoints=function(f,y){var S=new r.IntPoint(f.Value);f.Value.X=y.Value.X,f.Value.Y=y.Value.Y,y.Value.X=S.X,y.Value.Y=S.Y},r.Clipper.prototype.HorzSegmentsOverlap=function(f,y,S,I){return f.X>S.X==f.X<I.X||y.X>S.X==y.X<I.X||S.X>f.X==S.X<y.X||I.X>f.X==I.X<y.X||f.X==S.X&&y.X==I.X?!0:f.X==I.X&&y.X==S.X},r.Clipper.prototype.InsertPolyPtBetween=function(f,y,S){var I=new r.OutPt;return I.Pt.X=S.X,I.Pt.Y=S.Y,y==f.Next?(f.Next=I,y.Prev=I,I.Next=y,I.Prev=f):(y.Next=I,f.Prev=I,I.Next=f,I.Prev=y),I},r.Clipper.prototype.SetHoleState=function(f,y){for(var S=!1,I=f.PrevInAEL;I!==null;)I.OutIdx>=0&&I.WindDelta!=0&&(S=!S,y.FirstLeft===null&&(y.FirstLeft=this.m_PolyOuts[I.OutIdx])),I=I.PrevInAEL;S&&(y.IsHole=!0)},r.Clipper.prototype.GetDx=function(f,y){return f.Y==y.Y?r.ClipperBase.horizontal:(y.X-f.X)/(y.Y-f.Y)},r.Clipper.prototype.FirstIsBottomPt=function(f,y){for(var S=f.Prev;r.IntPoint.op_Equality(S.Pt,f.Pt)&&S!=f;)S=S.Prev;var I=Math.abs(this.GetDx(f.Pt,S.Pt));for(S=f.Next;r.IntPoint.op_Equality(S.Pt,f.Pt)&&S!=f;)S=S.Next;var F=Math.abs(this.GetDx(f.Pt,S.Pt));for(S=y.Prev;r.IntPoint.op_Equality(S.Pt,y.Pt)&&S!=y;)S=S.Prev;var H=Math.abs(this.GetDx(y.Pt,S.Pt));for(S=y.Next;r.IntPoint.op_Equality(S.Pt,y.Pt)&&S!=y;)S=S.Next;var X=Math.abs(this.GetDx(y.Pt,S.Pt));return I>=H&&I>=X||F>=H&&F>=X},r.Clipper.prototype.GetBottomPt=function(f){for(var y=null,S=f.Next;S!=f;)S.Pt.Y>f.Pt.Y?(f=S,y=null):S.Pt.Y==f.Pt.Y&&S.Pt.X<=f.Pt.X&&(S.Pt.X<f.Pt.X?(y=null,f=S):S.Next!=f&&S.Prev!=f&&(y=S)),S=S.Next;if(y!==null)for(;y!=S;)for(this.FirstIsBottomPt(S,y)||(f=y),y=y.Next;r.IntPoint.op_Inequality(y.Pt,f.Pt);)y=y.Next;return f},r.Clipper.prototype.GetLowermostRec=function(f,y){f.BottomPt===null&&(f.BottomPt=this.GetBottomPt(f.Pts)),y.BottomPt===null&&(y.BottomPt=this.GetBottomPt(y.Pts));var S=f.BottomPt,I=y.BottomPt;return S.Pt.Y>I.Pt.Y?f:S.Pt.Y<I.Pt.Y?y:S.Pt.X<I.Pt.X?f:S.Pt.X>I.Pt.X||S.Next==S?y:I.Next==I||this.FirstIsBottomPt(S,I)?f:y},r.Clipper.prototype.Param1RightOfParam2=function(f,y){do if(f=f.FirstLeft,f==y)return!0;while(f!==null);return!1},r.Clipper.prototype.GetOutRec=function(f){for(var y=this.m_PolyOuts[f];y!=this.m_PolyOuts[y.Idx];)y=this.m_PolyOuts[y.Idx];return y},r.Clipper.prototype.AppendPolygon=function(f,y){var S=this.m_PolyOuts[f.OutIdx],I=this.m_PolyOuts[y.OutIdx],F;this.Param1RightOfParam2(S,I)?F=I:this.Param1RightOfParam2(I,S)?F=S:F=this.GetLowermostRec(S,I);var H=S.Pts,X=H.Prev,se=I.Pts,de=se.Prev,Ee;f.Side==r.EdgeSide.esLeft?(y.Side==r.EdgeSide.esLeft?(this.ReversePolyPtLinks(se),se.Next=H,H.Prev=se,X.Next=de,de.Prev=X,S.Pts=de):(de.Next=H,H.Prev=de,se.Prev=X,X.Next=se,S.Pts=se),Ee=r.EdgeSide.esLeft):(y.Side==r.EdgeSide.esRight?(this.ReversePolyPtLinks(se),X.Next=de,de.Prev=X,se.Next=H,H.Prev=se):(X.Next=se,se.Prev=X,H.Prev=de,de.Next=H),Ee=r.EdgeSide.esRight),S.BottomPt=null,F==I&&(I.FirstLeft!=S&&(S.FirstLeft=I.FirstLeft),S.IsHole=I.IsHole),I.Pts=null,I.BottomPt=null,I.FirstLeft=S;var Ue=f.OutIdx,Ye=y.OutIdx;f.OutIdx=-1,y.OutIdx=-1;for(var dt=this.m_ActiveEdges;dt!==null;){if(dt.OutIdx==Ye){dt.OutIdx=Ue,dt.Side=Ee;break}dt=dt.NextInAEL}I.Idx=S.Idx},r.Clipper.prototype.ReversePolyPtLinks=function(f){if(f!==null){var y,S;y=f;do S=y.Next,y.Next=y.Prev,y.Prev=S,y=S;while(y!=f)}},r.Clipper.SwapSides=function(f,y){var S=f.Side;f.Side=y.Side,y.Side=S},r.Clipper.SwapPolyIndexes=function(f,y){var S=f.OutIdx;f.OutIdx=y.OutIdx,y.OutIdx=S},r.Clipper.prototype.IntersectEdges=function(f,y,S,I){var F=!I&&f.NextInLML===null&&f.Top.X==S.X&&f.Top.Y==S.Y,H=!I&&y.NextInLML===null&&y.Top.X==S.X&&y.Top.Y==S.Y,X=f.OutIdx>=0,se=y.OutIdx>=0;if(f.WindDelta===0||y.WindDelta===0){f.WindDelta===0&&y.WindDelta===0?(F||H)&&X&&se&&this.AddLocalMaxPoly(f,y,S):f.PolyTyp==y.PolyTyp&&f.WindDelta!=y.WindDelta&&this.m_ClipType==r.ClipType.ctUnion?f.WindDelta===0?se&&(this.AddOutPt(f,S),X&&(f.OutIdx=-1)):X&&(this.AddOutPt(y,S),se&&(y.OutIdx=-1)):f.PolyTyp!=y.PolyTyp&&(f.WindDelta===0&&Math.abs(y.WindCnt)==1&&(this.m_ClipType!=r.ClipType.ctUnion||y.WindCnt2===0)?(this.AddOutPt(f,S),X&&(f.OutIdx=-1)):y.WindDelta===0&&Math.abs(f.WindCnt)==1&&(this.m_ClipType!=r.ClipType.ctUnion||f.WindCnt2===0)&&(this.AddOutPt(y,S),se&&(y.OutIdx=-1))),F&&(f.OutIdx<0?this.DeleteFromAEL(f):r.Error("Error intersecting polylines")),H&&(y.OutIdx<0?this.DeleteFromAEL(y):r.Error("Error intersecting polylines"));return}if(f.PolyTyp==y.PolyTyp)if(this.IsEvenOddFillType(f)){var de=f.WindCnt;f.WindCnt=y.WindCnt,y.WindCnt=de}else f.WindCnt+y.WindDelta===0?f.WindCnt=-f.WindCnt:f.WindCnt+=y.WindDelta,y.WindCnt-f.WindDelta===0?y.WindCnt=-y.WindCnt:y.WindCnt-=f.WindDelta;else this.IsEvenOddFillType(y)?f.WindCnt2=f.WindCnt2===0?1:0:f.WindCnt2+=y.WindDelta,this.IsEvenOddFillType(f)?y.WindCnt2=y.WindCnt2===0?1:0:y.WindCnt2-=f.WindDelta;var Ee,Ue,Ye,dt;f.PolyTyp==r.PolyType.ptSubject?(Ee=this.m_SubjFillType,Ye=this.m_ClipFillType):(Ee=this.m_ClipFillType,Ye=this.m_SubjFillType),y.PolyTyp==r.PolyType.ptSubject?(Ue=this.m_SubjFillType,dt=this.m_ClipFillType):(Ue=this.m_ClipFillType,dt=this.m_SubjFillType);var Pt,Ct;switch(Ee){case r.PolyFillType.pftPositive:Pt=f.WindCnt;break;case r.PolyFillType.pftNegative:Pt=-f.WindCnt;break;default:Pt=Math.abs(f.WindCnt);break}switch(Ue){case r.PolyFillType.pftPositive:Ct=y.WindCnt;break;case r.PolyFillType.pftNegative:Ct=-y.WindCnt;break;default:Ct=Math.abs(y.WindCnt);break}if(X&&se)F||H||Pt!==0&&Pt!=1||Ct!==0&&Ct!=1||f.PolyTyp!=y.PolyTyp&&this.m_ClipType!=r.ClipType.ctXor?this.AddLocalMaxPoly(f,y,S):(this.AddOutPt(f,S),this.AddOutPt(y,S),r.Clipper.SwapSides(f,y),r.Clipper.SwapPolyIndexes(f,y));else if(X)(Ct===0||Ct==1)&&(this.AddOutPt(f,S),r.Clipper.SwapSides(f,y),r.Clipper.SwapPolyIndexes(f,y));else if(se)(Pt===0||Pt==1)&&(this.AddOutPt(y,S),r.Clipper.SwapSides(f,y),r.Clipper.SwapPolyIndexes(f,y));else if((Pt===0||Pt==1)&&(Ct===0||Ct==1)&&!F&&!H){var Wt,Ii;switch(Ye){case r.PolyFillType.pftPositive:Wt=f.WindCnt2;break;case r.PolyFillType.pftNegative:Wt=-f.WindCnt2;break;default:Wt=Math.abs(f.WindCnt2);break}switch(dt){case r.PolyFillType.pftPositive:Ii=y.WindCnt2;break;case r.PolyFillType.pftNegative:Ii=-y.WindCnt2;break;default:Ii=Math.abs(y.WindCnt2);break}if(f.PolyTyp!=y.PolyTyp)this.AddLocalMinPoly(f,y,S);else if(Pt==1&&Ct==1)switch(this.m_ClipType){case r.ClipType.ctIntersection:Wt>0&&Ii>0&&this.AddLocalMinPoly(f,y,S);break;case r.ClipType.ctUnion:Wt<=0&&Ii<=0&&this.AddLocalMinPoly(f,y,S);break;case r.ClipType.ctDifference:(f.PolyTyp==r.PolyType.ptClip&&Wt>0&&Ii>0||f.PolyTyp==r.PolyType.ptSubject&&Wt<=0&&Ii<=0)&&this.AddLocalMinPoly(f,y,S);break;case r.ClipType.ctXor:this.AddLocalMinPoly(f,y,S);break}else r.Clipper.SwapSides(f,y)}F!=H&&(F&&f.OutIdx>=0||H&&y.OutIdx>=0)&&(r.Clipper.SwapSides(f,y),r.Clipper.SwapPolyIndexes(f,y)),F&&this.DeleteFromAEL(f),H&&this.DeleteFromAEL(y)},r.Clipper.prototype.DeleteFromAEL=function(f){var y=f.PrevInAEL,S=f.NextInAEL;y===null&&S===null&&f!=this.m_ActiveEdges||(y!==null?y.NextInAEL=S:this.m_ActiveEdges=S,S!==null&&(S.PrevInAEL=y),f.NextInAEL=null,f.PrevInAEL=null)},r.Clipper.prototype.DeleteFromSEL=function(f){var y=f.PrevInSEL,S=f.NextInSEL;y===null&&S===null&&f!=this.m_SortedEdges||(y!==null?y.NextInSEL=S:this.m_SortedEdges=S,S!==null&&(S.PrevInSEL=y),f.NextInSEL=null,f.PrevInSEL=null)},r.Clipper.prototype.UpdateEdgeIntoAEL=function(f){f.NextInLML===null&&r.Error("UpdateEdgeIntoAEL: invalid call");var y=f.PrevInAEL,S=f.NextInAEL;return f.NextInLML.OutIdx=f.OutIdx,y!==null?y.NextInAEL=f.NextInLML:this.m_ActiveEdges=f.NextInLML,S!==null&&(S.PrevInAEL=f.NextInLML),f.NextInLML.Side=f.Side,f.NextInLML.WindDelta=f.WindDelta,f.NextInLML.WindCnt=f.WindCnt,f.NextInLML.WindCnt2=f.WindCnt2,f=f.NextInLML,f.Curr.X=f.Bot.X,f.Curr.Y=f.Bot.Y,f.PrevInAEL=y,f.NextInAEL=S,r.ClipperBase.IsHorizontal(f)||this.InsertScanbeam(f.Top.Y),f},r.Clipper.prototype.ProcessHorizontals=function(f){for(var y=this.m_SortedEdges;y!==null;)this.DeleteFromSEL(y),this.ProcessHorizontal(y,f),y=this.m_SortedEdges},r.Clipper.prototype.GetHorzDirection=function(f,y){f.Bot.X<f.Top.X?(y.Left=f.Bot.X,y.Right=f.Top.X,y.Dir=r.Direction.dLeftToRight):(y.Left=f.Top.X,y.Right=f.Bot.X,y.Dir=r.Direction.dRightToLeft)},r.Clipper.prototype.PrepareHorzJoins=function(f,y){var S=this.m_PolyOuts[f.OutIdx].Pts;f.Side!=r.EdgeSide.esLeft&&(S=S.Prev),y&&(r.IntPoint.op_Equality(S.Pt,f.Top)?this.AddGhostJoin(S,f.Bot):this.AddGhostJoin(S,f.Top))},r.Clipper.prototype.ProcessHorizontal=function(f,y){var S={Dir:null,Left:null,Right:null};this.GetHorzDirection(f,S);for(var I=S.Dir,F=S.Left,H=S.Right,X=f,se=null;X.NextInLML!==null&&r.ClipperBase.IsHorizontal(X.NextInLML);)X=X.NextInLML;for(X.NextInLML===null&&(se=this.GetMaximaPair(X));;){for(var de=f==X,Ee=this.GetNextInAEL(f,I);Ee!==null&&!(Ee.Curr.X==f.Top.X&&f.NextInLML!==null&&Ee.Dx<f.NextInLML.Dx);){var Ue=this.GetNextInAEL(Ee,I);if(I==r.Direction.dLeftToRight&&Ee.Curr.X<=H||I==r.Direction.dRightToLeft&&Ee.Curr.X>=F){if(f.OutIdx>=0&&f.WindDelta!=0&&this.PrepareHorzJoins(f,y),Ee==se&&de){I==r.Direction.dLeftToRight?this.IntersectEdges(f,Ee,Ee.Top,!1):this.IntersectEdges(Ee,f,Ee.Top,!1),se.OutIdx>=0&&r.Error("ProcessHorizontal error");return}else if(I==r.Direction.dLeftToRight){var Ye=new r.IntPoint(Ee.Curr.X,f.Curr.Y);this.IntersectEdges(f,Ee,Ye,!0)}else{var Ye=new r.IntPoint(Ee.Curr.X,f.Curr.Y);this.IntersectEdges(Ee,f,Ye,!0)}this.SwapPositionsInAEL(f,Ee)}else if(I==r.Direction.dLeftToRight&&Ee.Curr.X>=H||I==r.Direction.dRightToLeft&&Ee.Curr.X<=F)break;Ee=Ue}if(f.OutIdx>=0&&f.WindDelta!==0&&this.PrepareHorzJoins(f,y),f.NextInLML!==null&&r.ClipperBase.IsHorizontal(f.NextInLML)){f=this.UpdateEdgeIntoAEL(f),f.OutIdx>=0&&this.AddOutPt(f,f.Bot);var S={Dir:I,Left:F,Right:H};this.GetHorzDirection(f,S),I=S.Dir,F=S.Left,H=S.Right}else break}if(f.NextInLML!==null)if(f.OutIdx>=0){var dt=this.AddOutPt(f,f.Top);if(f=this.UpdateEdgeIntoAEL(f),f.WindDelta===0)return;var Pt=f.PrevInAEL,Ue=f.NextInAEL;if(Pt!==null&&Pt.Curr.X==f.Bot.X&&Pt.Curr.Y==f.Bot.Y&&Pt.WindDelta!==0&&Pt.OutIdx>=0&&Pt.Curr.Y>Pt.Top.Y&&r.ClipperBase.SlopesEqual(f,Pt,this.m_UseFullRange)){var Ct=this.AddOutPt(Pt,f.Bot);this.AddJoin(dt,Ct,f.Top)}else if(Ue!==null&&Ue.Curr.X==f.Bot.X&&Ue.Curr.Y==f.Bot.Y&&Ue.WindDelta!==0&&Ue.OutIdx>=0&&Ue.Curr.Y>Ue.Top.Y&&r.ClipperBase.SlopesEqual(f,Ue,this.m_UseFullRange)){var Ct=this.AddOutPt(Ue,f.Bot);this.AddJoin(dt,Ct,f.Top)}}else f=this.UpdateEdgeIntoAEL(f);else se!==null?se.OutIdx>=0?(I==r.Direction.dLeftToRight?this.IntersectEdges(f,se,f.Top,!1):this.IntersectEdges(se,f,f.Top,!1),se.OutIdx>=0&&r.Error("ProcessHorizontal error")):(this.DeleteFromAEL(f),this.DeleteFromAEL(se)):(f.OutIdx>=0&&this.AddOutPt(f,f.Top),this.DeleteFromAEL(f))},r.Clipper.prototype.GetNextInAEL=function(f,y){return y==r.Direction.dLeftToRight?f.NextInAEL:f.PrevInAEL},r.Clipper.prototype.IsMinima=function(f){return f!==null&&f.Prev.NextInLML!=f&&f.Next.NextInLML!=f},r.Clipper.prototype.IsMaxima=function(f,y){return f!==null&&f.Top.Y==y&&f.NextInLML===null},r.Clipper.prototype.IsIntermediate=function(f,y){return f.Top.Y==y&&f.NextInLML!==null},r.Clipper.prototype.GetMaximaPair=function(f){var y=null;return r.IntPoint.op_Equality(f.Next.Top,f.Top)&&f.Next.NextInLML===null?y=f.Next:r.IntPoint.op_Equality(f.Prev.Top,f.Top)&&f.Prev.NextInLML===null&&(y=f.Prev),y!==null&&(y.OutIdx==-2||y.NextInAEL==y.PrevInAEL&&!r.ClipperBase.IsHorizontal(y))?null:y},r.Clipper.prototype.ProcessIntersections=function(f,y){if(this.m_ActiveEdges==null)return!0;try{if(this.BuildIntersectList(f,y),this.m_IntersectList.length==0)return!0;if(this.m_IntersectList.length==1||this.FixupIntersectionOrder())this.ProcessIntersectList();else return!1}catch{this.m_SortedEdges=null,this.m_IntersectList.length=0,r.Error("ProcessIntersections error")}return this.m_SortedEdges=null,!0},r.Clipper.prototype.BuildIntersectList=function(f,y){if(this.m_ActiveEdges!==null){var S=this.m_ActiveEdges;for(this.m_SortedEdges=S;S!==null;)S.PrevInSEL=S.PrevInAEL,S.NextInSEL=S.NextInAEL,S.Curr.X=r.Clipper.TopX(S,y),S=S.NextInAEL;for(var I=!0;I&&this.m_SortedEdges!==null;){for(I=!1,S=this.m_SortedEdges;S.NextInSEL!==null;){var F=S.NextInSEL,H=new r.IntPoint;if(S.Curr.X>F.Curr.X){!this.IntersectPoint(S,F,H)&&S.Curr.X>F.Curr.X+1&&r.Error("Intersection error"),H.Y>f&&(H.Y=f,Math.abs(S.Dx)>Math.abs(F.Dx)?H.X=r.Clipper.TopX(F,f):H.X=r.Clipper.TopX(S,f));var X=new r.IntersectNode;X.Edge1=S,X.Edge2=F,X.Pt.X=H.X,X.Pt.Y=H.Y,this.m_IntersectList.push(X),this.SwapPositionsInSEL(S,F),I=!0}else S=F}if(S.PrevInSEL!==null)S.PrevInSEL.NextInSEL=null;else break}this.m_SortedEdges=null}},r.Clipper.prototype.EdgesAdjacent=function(f){return f.Edge1.NextInSEL==f.Edge2||f.Edge1.PrevInSEL==f.Edge2},r.Clipper.IntersectNodeSort=function(f,y){return y.Pt.Y-f.Pt.Y},r.Clipper.prototype.FixupIntersectionOrder=function(){this.m_IntersectList.sort(this.m_IntersectNodeComparer),this.CopyAELToSEL();for(var f=this.m_IntersectList.length,y=0;y<f;y++){if(!this.EdgesAdjacent(this.m_IntersectList[y])){for(var S=y+1;S<f&&!this.EdgesAdjacent(this.m_IntersectList[S]);)S++;if(S==f)return!1;var I=this.m_IntersectList[y];this.m_IntersectList[y]=this.m_IntersectList[S],this.m_IntersectList[S]=I}this.SwapPositionsInSEL(this.m_IntersectList[y].Edge1,this.m_IntersectList[y].Edge2)}return!0},r.Clipper.prototype.ProcessIntersectList=function(){for(var f=0,y=this.m_IntersectList.length;f<y;f++){var S=this.m_IntersectList[f];this.IntersectEdges(S.Edge1,S.Edge2,S.Pt,!0),this.SwapPositionsInAEL(S.Edge1,S.Edge2)}this.m_IntersectList.length=0};var _a=h(function(f){return f<0?Math.ceil(f-.5):Math.round(f)},"R1"),Os=h(function(f){return f<0?Math.ceil(f-.5):Math.floor(f+.5)},"R2"),Nr=h(function(f){return f<0?-Math.round(Math.abs(f)):Math.round(f)},"R3"),Ga=h(function(f){return f<0?(f-=.5,f<-2147483648?Math.ceil(f):f|0):(f+=.5,f>2147483647?Math.floor(f):f|0)},"R4");s.msie?r.Clipper.Round=_a:s.chromium?r.Clipper.Round=Nr:s.safari?r.Clipper.Round=Ga:r.Clipper.Round=Os,r.Clipper.TopX=function(f,y){return y==f.Top.Y?f.Top.X:f.Bot.X+r.Clipper.Round(f.Dx*(y-f.Bot.Y))},r.Clipper.prototype.IntersectPoint=function(f,y,S){S.X=0,S.Y=0;var I,F;if(r.ClipperBase.SlopesEqual(f,y,this.m_UseFullRange)||f.Dx==y.Dx)return y.Bot.Y>f.Bot.Y?(S.X=y.Bot.X,S.Y=y.Bot.Y):(S.X=f.Bot.X,S.Y=f.Bot.Y),!1;if(f.Delta.X===0)S.X=f.Bot.X,r.ClipperBase.IsHorizontal(y)?S.Y=y.Bot.Y:(F=y.Bot.Y-y.Bot.X/y.Dx,S.Y=r.Clipper.Round(S.X/y.Dx+F));else if(y.Delta.X===0)S.X=y.Bot.X,r.ClipperBase.IsHorizontal(f)?S.Y=f.Bot.Y:(I=f.Bot.Y-f.Bot.X/f.Dx,S.Y=r.Clipper.Round(S.X/f.Dx+I));else{I=f.Bot.X-f.Bot.Y*f.Dx,F=y.Bot.X-y.Bot.Y*y.Dx;var H=(F-I)/(f.Dx-y.Dx);S.Y=r.Clipper.Round(H),Math.abs(f.Dx)<Math.abs(y.Dx)?S.X=r.Clipper.Round(f.Dx*H+I):S.X=r.Clipper.Round(y.Dx*H+F)}if(S.Y<f.Top.Y||S.Y<y.Top.Y){if(f.Top.Y>y.Top.Y)return S.Y=f.Top.Y,S.X=r.Clipper.TopX(y,f.Top.Y),S.X<f.Top.X;S.Y=y.Top.Y,Math.abs(f.Dx)<Math.abs(y.Dx)?S.X=r.Clipper.TopX(f,S.Y):S.X=r.Clipper.TopX(y,S.Y)}return!0},r.Clipper.prototype.ProcessEdgesAtTopOfScanbeam=function(f){for(var y=this.m_ActiveEdges;y!==null;){var S=this.IsMaxima(y,f);if(S){var I=this.GetMaximaPair(y);S=I===null||!r.ClipperBase.IsHorizontal(I)}if(S){var F=y.PrevInAEL;this.DoMaxima(y),F===null?y=this.m_ActiveEdges:y=F.NextInAEL}else{if(this.IsIntermediate(y,f)&&r.ClipperBase.IsHorizontal(y.NextInLML)?(y=this.UpdateEdgeIntoAEL(y),y.OutIdx>=0&&this.AddOutPt(y,y.Bot),this.AddEdgeToSEL(y)):(y.Curr.X=r.Clipper.TopX(y,f),y.Curr.Y=f),this.StrictlySimple){var F=y.PrevInAEL;if(y.OutIdx>=0&&y.WindDelta!==0&&F!==null&&F.OutIdx>=0&&F.Curr.X==y.Curr.X&&F.WindDelta!==0){var H=this.AddOutPt(F,y.Curr),X=this.AddOutPt(y,y.Curr);this.AddJoin(H,X,y.Curr)}}y=y.NextInAEL}}for(this.ProcessHorizontals(!0),y=this.m_ActiveEdges;y!==null;){if(this.IsIntermediate(y,f)){var H=null;y.OutIdx>=0&&(H=this.AddOutPt(y,y.Top)),y=this.UpdateEdgeIntoAEL(y);var F=y.PrevInAEL,se=y.NextInAEL;if(F!==null&&F.Curr.X==y.Bot.X&&F.Curr.Y==y.Bot.Y&&H!==null&&F.OutIdx>=0&&F.Curr.Y>F.Top.Y&&r.ClipperBase.SlopesEqual(y,F,this.m_UseFullRange)&&y.WindDelta!==0&&F.WindDelta!==0){var X=this.AddOutPt(F,y.Bot);this.AddJoin(H,X,y.Top)}else if(se!==null&&se.Curr.X==y.Bot.X&&se.Curr.Y==y.Bot.Y&&H!==null&&se.OutIdx>=0&&se.Curr.Y>se.Top.Y&&r.ClipperBase.SlopesEqual(y,se,this.m_UseFullRange)&&y.WindDelta!==0&&se.WindDelta!==0){var X=this.AddOutPt(se,y.Bot);this.AddJoin(H,X,y.Top)}}y=y.NextInAEL}},r.Clipper.prototype.DoMaxima=function(f){var y=this.GetMaximaPair(f);if(y===null){f.OutIdx>=0&&this.AddOutPt(f,f.Top),this.DeleteFromAEL(f);return}for(var S=f.NextInAEL,I=!0;S!==null&&S!=y;)this.IntersectEdges(f,S,f.Top,!0),this.SwapPositionsInAEL(f,S),S=f.NextInAEL;f.OutIdx==-1&&y.OutIdx==-1?(this.DeleteFromAEL(f),this.DeleteFromAEL(y)):f.OutIdx>=0&&y.OutIdx>=0?this.IntersectEdges(f,y,f.Top,!1):I&&f.WindDelta===0?(f.OutIdx>=0&&(this.AddOutPt(f,f.Top),f.OutIdx=-1),this.DeleteFromAEL(f),y.OutIdx>=0&&(this.AddOutPt(y,f.Top),y.OutIdx=-1),this.DeleteFromAEL(y)):r.Error("DoMaxima error")},r.Clipper.ReversePaths=function(f){for(var y=0,S=f.length;y<S;y++)f[y].reverse()},r.Clipper.Orientation=function(f){return r.Clipper.Area(f)>=0},r.Clipper.prototype.PointCount=function(f){if(f===null)return 0;var y=0,S=f;do y++,S=S.Next;while(S!=f);return y},r.Clipper.prototype.BuildResult=function(f){r.Clear(f);for(var y=0,S=this.m_PolyOuts.length;y<S;y++){var I=this.m_PolyOuts[y];if(I.Pts!==null){var F=I.Pts.Prev,H=this.PointCount(F);if(!(H<2)){for(var X=new Array(H),se=0;se<H;se++)X[se]=F.Pt,F=F.Prev;f.push(X)}}}},r.Clipper.prototype.BuildResult2=function(f){f.Clear();for(var y=0,S=this.m_PolyOuts.length;y<S;y++){var I=this.m_PolyOuts[y],F=this.PointCount(I.Pts);if(!(I.IsOpen&&F<2||!I.IsOpen&&F<3)){this.FixHoleLinkage(I);var H=new r.PolyNode;f.m_AllPolys.push(H),I.PolyNode=H,H.m_polygon.length=F;for(var X=I.Pts.Prev,se=0;se<F;se++)H.m_polygon[se]=X.Pt,X=X.Prev}}for(var y=0,S=this.m_PolyOuts.length;y<S;y++){var I=this.m_PolyOuts[y];I.PolyNode!==null&&(I.IsOpen?(I.PolyNode.IsOpen=!0,f.AddChild(I.PolyNode)):I.FirstLeft!==null&&I.FirstLeft.PolyNode!=null?I.FirstLeft.PolyNode.AddChild(I.PolyNode):f.AddChild(I.PolyNode))}},r.Clipper.prototype.FixupOutPolygon=function(f){var y=null;f.BottomPt=null;for(var S=f.Pts;;){if(S.Prev==S||S.Prev==S.Next){this.DisposeOutPts(S),f.Pts=null;return}if(r.IntPoint.op_Equality(S.Pt,S.Next.Pt)||r.IntPoint.op_Equality(S.Pt,S.Prev.Pt)||r.ClipperBase.SlopesEqual(S.Prev.Pt,S.Pt,S.Next.Pt,this.m_UseFullRange)&&(!this.PreserveCollinear||!this.Pt2IsBetweenPt1AndPt3(S.Prev.Pt,S.Pt,S.Next.Pt)))y=null,S.Prev.Next=S.Next,S.Next.Prev=S.Prev,S=S.Prev;else{if(S==y)break;y===null&&(y=S),S=S.Next}}f.Pts=S},r.Clipper.prototype.DupOutPt=function(f,y){var S=new r.OutPt;return S.Pt.X=f.Pt.X,S.Pt.Y=f.Pt.Y,S.Idx=f.Idx,y?(S.Next=f.Next,S.Prev=f,f.Next.Prev=S,f.Next=S):(S.Prev=f.Prev,S.Next=f,f.Prev.Next=S,f.Prev=S),S},r.Clipper.prototype.GetOverlap=function(f,y,S,I,F){return f<y?S<I?(F.Left=Math.max(f,S),F.Right=Math.min(y,I)):(F.Left=Math.max(f,I),F.Right=Math.min(y,S)):S<I?(F.Left=Math.max(y,S),F.Right=Math.min(f,I)):(F.Left=Math.max(y,I),F.Right=Math.min(f,S)),F.Left<F.Right},r.Clipper.prototype.JoinHorz=function(f,y,S,I,F,H){var X=f.Pt.X>y.Pt.X?r.Direction.dRightToLeft:r.Direction.dLeftToRight,se=S.Pt.X>I.Pt.X?r.Direction.dRightToLeft:r.Direction.dLeftToRight;if(X==se)return!1;if(X==r.Direction.dLeftToRight){for(;f.Next.Pt.X<=F.X&&f.Next.Pt.X>=f.Pt.X&&f.Next.Pt.Y==F.Y;)f=f.Next;H&&f.Pt.X!=F.X&&(f=f.Next),y=this.DupOutPt(f,!H),r.IntPoint.op_Inequality(y.Pt,F)&&(f=y,f.Pt.X=F.X,f.Pt.Y=F.Y,y=this.DupOutPt(f,!H))}else{for(;f.Next.Pt.X>=F.X&&f.Next.Pt.X<=f.Pt.X&&f.Next.Pt.Y==F.Y;)f=f.Next;!H&&f.Pt.X!=F.X&&(f=f.Next),y=this.DupOutPt(f,H),r.IntPoint.op_Inequality(y.Pt,F)&&(f=y,f.Pt.X=F.X,f.Pt.Y=F.Y,y=this.DupOutPt(f,H))}if(se==r.Direction.dLeftToRight){for(;S.Next.Pt.X<=F.X&&S.Next.Pt.X>=S.Pt.X&&S.Next.Pt.Y==F.Y;)S=S.Next;H&&S.Pt.X!=F.X&&(S=S.Next),I=this.DupOutPt(S,!H),r.IntPoint.op_Inequality(I.Pt,F)&&(S=I,S.Pt.X=F.X,S.Pt.Y=F.Y,I=this.DupOutPt(S,!H))}else{for(;S.Next.Pt.X>=F.X&&S.Next.Pt.X<=S.Pt.X&&S.Next.Pt.Y==F.Y;)S=S.Next;!H&&S.Pt.X!=F.X&&(S=S.Next),I=this.DupOutPt(S,H),r.IntPoint.op_Inequality(I.Pt,F)&&(S=I,S.Pt.X=F.X,S.Pt.Y=F.Y,I=this.DupOutPt(S,H))}return X==r.Direction.dLeftToRight==H?(f.Prev=S,S.Next=f,y.Next=I,I.Prev=y):(f.Next=S,S.Prev=f,y.Prev=I,I.Next=y),!0},r.Clipper.prototype.JoinPoints=function(f,y,S){var I=f.OutPt1,F=new r.OutPt,H=f.OutPt2,X=new r.OutPt,se=f.OutPt1.Pt.Y==f.OffPt.Y;if(se&&r.IntPoint.op_Equality(f.OffPt,f.OutPt1.Pt)&&r.IntPoint.op_Equality(f.OffPt,f.OutPt2.Pt)){for(F=f.OutPt1.Next;F!=I&&r.IntPoint.op_Equality(F.Pt,f.OffPt);)F=F.Next;var de=F.Pt.Y>f.OffPt.Y;for(X=f.OutPt2.Next;X!=H&&r.IntPoint.op_Equality(X.Pt,f.OffPt);)X=X.Next;var Ee=X.Pt.Y>f.OffPt.Y;return de==Ee?!1:de?(F=this.DupOutPt(I,!1),X=this.DupOutPt(H,!0),I.Prev=H,H.Next=I,F.Next=X,X.Prev=F,f.OutPt1=I,f.OutPt2=F,!0):(F=this.DupOutPt(I,!0),X=this.DupOutPt(H,!1),I.Next=H,H.Prev=I,F.Prev=X,X.Next=F,f.OutPt1=I,f.OutPt2=F,!0)}else if(se){for(F=I;I.Prev.Pt.Y==I.Pt.Y&&I.Prev!=F&&I.Prev!=H;)I=I.Prev;for(;F.Next.Pt.Y==F.Pt.Y&&F.Next!=I&&F.Next!=H;)F=F.Next;if(F.Next==I||F.Next==H)return!1;for(X=H;H.Prev.Pt.Y==H.Pt.Y&&H.Prev!=X&&H.Prev!=F;)H=H.Prev;for(;X.Next.Pt.Y==X.Pt.Y&&X.Next!=H&&X.Next!=I;)X=X.Next;if(X.Next==H||X.Next==I)return!1;var Ue={Left:null,Right:null};if(!this.GetOverlap(I.Pt.X,F.Pt.X,H.Pt.X,X.Pt.X,Ue))return!1;var Ye=Ue.Left,dt=Ue.Right,Pt=new r.IntPoint,Ct;return I.Pt.X>=Ye&&I.Pt.X<=dt?(Pt.X=I.Pt.X,Pt.Y=I.Pt.Y,Ct=I.Pt.X>F.Pt.X):H.Pt.X>=Ye&&H.Pt.X<=dt?(Pt.X=H.Pt.X,Pt.Y=H.Pt.Y,Ct=H.Pt.X>X.Pt.X):F.Pt.X>=Ye&&F.Pt.X<=dt?(Pt.X=F.Pt.X,Pt.Y=F.Pt.Y,Ct=F.Pt.X>I.Pt.X):(Pt.X=X.Pt.X,Pt.Y=X.Pt.Y,Ct=X.Pt.X>H.Pt.X),f.OutPt1=I,f.OutPt2=H,this.JoinHorz(I,F,H,X,Pt,Ct)}else{for(F=I.Next;r.IntPoint.op_Equality(F.Pt,I.Pt)&&F!=I;)F=F.Next;var Wt=F.Pt.Y>I.Pt.Y||!r.ClipperBase.SlopesEqual(I.Pt,F.Pt,f.OffPt,this.m_UseFullRange);if(Wt){for(F=I.Prev;r.IntPoint.op_Equality(F.Pt,I.Pt)&&F!=I;)F=F.Prev;if(F.Pt.Y>I.Pt.Y||!r.ClipperBase.SlopesEqual(I.Pt,F.Pt,f.OffPt,this.m_UseFullRange))return!1}for(X=H.Next;r.IntPoint.op_Equality(X.Pt,H.Pt)&&X!=H;)X=X.Next;var Ii=X.Pt.Y>H.Pt.Y||!r.ClipperBase.SlopesEqual(H.Pt,X.Pt,f.OffPt,this.m_UseFullRange);if(Ii){for(X=H.Prev;r.IntPoint.op_Equality(X.Pt,H.Pt)&&X!=H;)X=X.Prev;if(X.Pt.Y>H.Pt.Y||!r.ClipperBase.SlopesEqual(H.Pt,X.Pt,f.OffPt,this.m_UseFullRange))return!1}return F==I||X==H||F==X||y==S&&Wt==Ii?!1:Wt?(F=this.DupOutPt(I,!1),X=this.DupOutPt(H,!0),I.Prev=H,H.Next=I,F.Next=X,X.Prev=F,f.OutPt1=I,f.OutPt2=F,!0):(F=this.DupOutPt(I,!0),X=this.DupOutPt(H,!1),I.Next=H,H.Prev=I,F.Prev=X,X.Next=F,f.OutPt1=I,f.OutPt2=F,!0)}},r.Clipper.GetBounds=function(f){for(var y=0,S=f.length;y<S&&f[y].length==0;)y++;if(y==S)return new r.IntRect(0,0,0,0);var I=new r.IntRect;for(I.left=f[y][0].X,I.right=I.left,I.top=f[y][0].Y,I.bottom=I.top;y<S;y++)for(var F=0,H=f[y].length;F<H;F++)f[y][F].X<I.left?I.left=f[y][F].X:f[y][F].X>I.right&&(I.right=f[y][F].X),f[y][F].Y<I.top?I.top=f[y][F].Y:f[y][F].Y>I.bottom&&(I.bottom=f[y][F].Y);return I},r.Clipper.prototype.GetBounds2=function(f){var y=f,S=new r.IntRect;for(S.left=f.Pt.X,S.right=f.Pt.X,S.top=f.Pt.Y,S.bottom=f.Pt.Y,f=f.Next;f!=y;)f.Pt.X<S.left&&(S.left=f.Pt.X),f.Pt.X>S.right&&(S.right=f.Pt.X),f.Pt.Y<S.top&&(S.top=f.Pt.Y),f.Pt.Y>S.bottom&&(S.bottom=f.Pt.Y),f=f.Next;return S},r.Clipper.PointInPolygon=function(f,y){var S=0,I=y.length;if(I<3)return 0;for(var F=y[0],H=1;H<=I;++H){var X=H==I?y[0]:y[H];if(X.Y==f.Y&&(X.X==f.X||F.Y==f.Y&&X.X>f.X==F.X<f.X))return-1;if(F.Y<f.Y!=X.Y<f.Y){if(F.X>=f.X)if(X.X>f.X)S=1-S;else{var se=(F.X-f.X)*(X.Y-f.Y)-(X.X-f.X)*(F.Y-f.Y);if(se==0)return-1;se>0==X.Y>F.Y&&(S=1-S)}else if(X.X>f.X){var se=(F.X-f.X)*(X.Y-f.Y)-(X.X-f.X)*(F.Y-f.Y);if(se==0)return-1;se>0==X.Y>F.Y&&(S=1-S)}}F=X}return S},r.Clipper.prototype.PointInPolygon=function(f,y){for(var S=0,I=y;;){var F=y.Pt.X,H=y.Pt.Y,X=y.Next.Pt.X,se=y.Next.Pt.Y;if(se==f.Y&&(X==f.X||H==f.Y&&X>f.X==F<f.X))return-1;if(H<f.Y!=se<f.Y){if(F>=f.X)if(X>f.X)S=1-S;else{var de=(F-f.X)*(se-f.Y)-(X-f.X)*(H-f.Y);if(de==0)return-1;de>0==se>H&&(S=1-S)}else if(X>f.X){var de=(F-f.X)*(se-f.Y)-(X-f.X)*(H-f.Y);if(de==0)return-1;de>0==se>H&&(S=1-S)}}if(y=y.Next,I==y)break}return S},r.Clipper.prototype.Poly2ContainsPoly1=function(f,y){var S=f;do{var I=this.PointInPolygon(S.Pt,y);if(I>=0)return I!=0;S=S.Next}while(S!=f);return!0},r.Clipper.prototype.FixupFirstLefts1=function(f,y){for(var S=0,I=this.m_PolyOuts.length;S<I;S++){var F=this.m_PolyOuts[S];F.Pts!==null&&F.FirstLeft==f&&this.Poly2ContainsPoly1(F.Pts,y.Pts)&&(F.FirstLeft=y)}},r.Clipper.prototype.FixupFirstLefts2=function(f,y){for(var S=0,I=this.m_PolyOuts,F=I.length,H=I[S];S<F;S++,H=I[S])H.FirstLeft==f&&(H.FirstLeft=y)},r.Clipper.ParseFirstLeft=function(f){for(;f!=null&&f.Pts==null;)f=f.FirstLeft;return f},r.Clipper.prototype.JoinCommonEdges=function(){for(var f=0,y=this.m_Joins.length;f<y;f++){var S=this.m_Joins[f],I=this.GetOutRec(S.OutPt1.Idx),F=this.GetOutRec(S.OutPt2.Idx);if(!(I.Pts==null||F.Pts==null)){var H;if(I==F?H=I:this.Param1RightOfParam2(I,F)?H=F:this.Param1RightOfParam2(F,I)?H=I:H=this.GetLowermostRec(I,F),!!this.JoinPoints(S,I,F))if(I==F){if(I.Pts=S.OutPt1,I.BottomPt=null,F=this.CreateOutRec(),F.Pts=S.OutPt2,this.UpdateOutPtIdxs(F),this.m_UsingPolyTree)for(var X=0,se=this.m_PolyOuts.length;X<se-1;X++){var de=this.m_PolyOuts[X];de.Pts==null||r.Clipper.ParseFirstLeft(de.FirstLeft)!=I||de.IsHole==I.IsHole||this.Poly2ContainsPoly1(de.Pts,S.OutPt2)&&(de.FirstLeft=F)}this.Poly2ContainsPoly1(F.Pts,I.Pts)?(F.IsHole=!I.IsHole,F.FirstLeft=I,this.m_UsingPolyTree&&this.FixupFirstLefts2(F,I),(F.IsHole^this.ReverseSolution)==this.Area(F)>0&&this.ReversePolyPtLinks(F.Pts)):this.Poly2ContainsPoly1(I.Pts,F.Pts)?(F.IsHole=I.IsHole,I.IsHole=!F.IsHole,F.FirstLeft=I.FirstLeft,I.FirstLeft=F,this.m_UsingPolyTree&&this.FixupFirstLefts2(I,F),(I.IsHole^this.ReverseSolution)==this.Area(I)>0&&this.ReversePolyPtLinks(I.Pts)):(F.IsHole=I.IsHole,F.FirstLeft=I.FirstLeft,this.m_UsingPolyTree&&this.FixupFirstLefts1(I,F))}else F.Pts=null,F.BottomPt=null,F.Idx=I.Idx,I.IsHole=H.IsHole,H==F&&(I.FirstLeft=F.FirstLeft),F.FirstLeft=I,this.m_UsingPolyTree&&this.FixupFirstLefts2(F,I)}}},r.Clipper.prototype.UpdateOutPtIdxs=function(f){var y=f.Pts;do y.Idx=f.Idx,y=y.Prev;while(y!=f.Pts)},r.Clipper.prototype.DoSimplePolygons=function(){for(var f=0;f<this.m_PolyOuts.length;){var y=this.m_PolyOuts[f++],S=y.Pts;if(S!==null)do{for(var I=S.Next;I!=y.Pts;){if(r.IntPoint.op_Equality(S.Pt,I.Pt)&&I.Next!=S&&I.Prev!=S){var F=S.Prev,H=I.Prev;S.Prev=H,H.Next=S,I.Prev=F,F.Next=I,y.Pts=S;var X=this.CreateOutRec();X.Pts=I,this.UpdateOutPtIdxs(X),this.Poly2ContainsPoly1(X.Pts,y.Pts)?(X.IsHole=!y.IsHole,X.FirstLeft=y):this.Poly2ContainsPoly1(y.Pts,X.Pts)?(X.IsHole=y.IsHole,y.IsHole=!X.IsHole,X.FirstLeft=y.FirstLeft,y.FirstLeft=X):(X.IsHole=y.IsHole,X.FirstLeft=y.FirstLeft),I=S}I=I.Next}S=S.Next}while(S!=y.Pts)}},r.Clipper.Area=function(f){var y=f.length;if(y<3)return 0;for(var S=0,I=0,F=y-1;I<y;++I)S+=(f[F].X+f[I].X)*(f[F].Y-f[I].Y),F=I;return-S*.5},r.Clipper.prototype.Area=function(f){var y=f.Pts;if(y==null)return 0;var S=0;do S=S+(y.Prev.Pt.X+y.Pt.X)*(y.Prev.Pt.Y-y.Pt.Y),y=y.Next;while(y!=f.Pts);return S*.5},r.Clipper.SimplifyPolygon=function(f,y){var S=new Array,I=new r.Clipper(0);return I.StrictlySimple=!0,I.AddPath(f,r.PolyType.ptSubject,!0),I.Execute(r.ClipType.ctUnion,S,y,y),S},r.Clipper.SimplifyPolygons=function(f,y){typeof y>"u"&&(y=r.PolyFillType.pftEvenOdd);var S=new Array,I=new r.Clipper(0);return I.StrictlySimple=!0,I.AddPaths(f,r.PolyType.ptSubject,!0),I.Execute(r.ClipType.ctUnion,S,y,y),S},r.Clipper.DistanceSqrd=function(f,y){var S=f.X-y.X,I=f.Y-y.Y;return S*S+I*I},r.Clipper.DistanceFromLineSqrd=function(f,y,S){var I=y.Y-S.Y,F=S.X-y.X,H=I*y.X+F*y.Y;return H=I*f.X+F*f.Y-H,H*H/(I*I+F*F)},r.Clipper.SlopesNearCollinear=function(f,y,S,I){return r.Clipper.DistanceFromLineSqrd(y,f,S)<I},r.Clipper.PointsAreClose=function(f,y,S){var I=f.X-y.X,F=f.Y-y.Y;return I*I+F*F<=S},r.Clipper.ExcludeOp=function(f){var y=f.Prev;return y.Next=f.Next,f.Next.Prev=y,y.Idx=0,y},r.Clipper.CleanPolygon=function(f,y){typeof y>"u"&&(y=1.415);var S=f.length;if(S==0)return new Array;for(var I=new Array(S),F=0;F<S;++F)I[F]=new r.OutPt;for(var F=0;F<S;++F)I[F].Pt=f[F],I[F].Next=I[(F+1)%S],I[F].Next.Prev=I[F],I[F].Idx=0;for(var H=y*y,X=I[0];X.Idx==0&&X.Next!=X.Prev;)r.Clipper.PointsAreClose(X.Pt,X.Prev.Pt,H)?(X=r.Clipper.ExcludeOp(X),S--):r.Clipper.PointsAreClose(X.Prev.Pt,X.Next.Pt,H)?(r.Clipper.ExcludeOp(X.Next),X=r.Clipper.ExcludeOp(X),S-=2):r.Clipper.SlopesNearCollinear(X.Prev.Pt,X.Pt,X.Next.Pt,H)?(X=r.Clipper.ExcludeOp(X),S--):(X.Idx=1,X=X.Next);S<3&&(S=0);for(var se=new Array(S),F=0;F<S;++F)se[F]=new r.IntPoint(X.Pt),X=X.Next;return I=null,se},r.Clipper.CleanPolygons=function(f,y){for(var S=new Array(f.length),I=0,F=f.length;I<F;I++)S[I]=r.Clipper.CleanPolygon(f[I],y);return S},r.Clipper.Minkowski=function(f,y,S,I){var F=I?1:0,H=f.length,X=y.length,se=new Array;if(S)for(var de=0;de<X;de++){for(var Ee=new Array(H),Ue=0,Ye=f.length,dt=f[Ue];Ue<Ye;Ue++,dt=f[Ue])Ee[Ue]=new r.IntPoint(y[de].X+dt.X,y[de].Y+dt.Y);se.push(Ee)}else for(var de=0;de<X;de++){for(var Ee=new Array(H),Ue=0,Ye=f.length,dt=f[Ue];Ue<Ye;Ue++,dt=f[Ue])Ee[Ue]=new r.IntPoint(y[de].X-dt.X,y[de].Y-dt.Y);se.push(Ee)}for(var Pt=new Array,de=0;de<X-1+F;de++)for(var Ue=0;Ue<H;Ue++){var Ct=new Array;Ct.push(se[de%X][Ue%H]),Ct.push(se[(de+1)%X][Ue%H]),Ct.push(se[(de+1)%X][(Ue+1)%H]),Ct.push(se[de%X][(Ue+1)%H]),r.Clipper.Orientation(Ct)||Ct.reverse(),Pt.push(Ct)}var Wt=new r.Clipper(0);return Wt.AddPaths(Pt,r.PolyType.ptSubject,!0),Wt.Execute(r.ClipType.ctUnion,se,r.PolyFillType.pftNonZero,r.PolyFillType.pftNonZero),se},r.Clipper.MinkowskiSum=function(){var f=arguments,y=f.length;if(y==3){var S=f[0],I=f[1],F=f[2];return r.Clipper.Minkowski(S,I,!0,F)}else if(y==4){for(var S=f[0],H=f[1],X=f[2],F=f[3],se=new r.Clipper,de,Ee=0,Ue=H.length;Ee<Ue;++Ee){var de=r.Clipper.Minkowski(S,H[Ee],!0,F);se.AddPaths(de,r.PolyType.ptSubject,!0)}F&&se.AddPaths(H,r.PolyType.ptClip,!0);var Ye=new r.Paths;return se.Execute(r.ClipType.ctUnion,Ye,X,X),Ye}},r.Clipper.MinkowskiDiff=function(f,y,S){return r.Clipper.Minkowski(f,y,!1,S)},r.Clipper.PolyTreeToPaths=function(f){var y=new Array;return r.Clipper.AddPolyNodeToPaths(f,r.Clipper.NodeType.ntAny,y),y},r.Clipper.AddPolyNodeToPaths=function(f,y,S){var I=!0;switch(y){case r.Clipper.NodeType.ntOpen:return;case r.Clipper.NodeType.ntClosed:I=!f.IsOpen;break}f.m_polygon.length>0&&I&&S.push(f.m_polygon);for(var F=0,H=f.Childs(),X=H.length,se=H[F];F<X;F++,se=H[F])r.Clipper.AddPolyNodeToPaths(se,y,S)},r.Clipper.OpenPathsFromPolyTree=function(f){for(var y=new r.Paths,S=0,I=f.ChildCount();S<I;S++)f.Childs()[S].IsOpen&&y.push(f.Childs()[S].m_polygon);return y},r.Clipper.ClosedPathsFromPolyTree=function(f){var y=new r.Paths;return r.Clipper.AddPolyNodeToPaths(f,r.Clipper.NodeType.ntClosed,y),y},Oi(r.Clipper,r.ClipperBase),r.Clipper.NodeType={ntAny:0,ntOpen:1,ntClosed:2},r.ClipperOffset=function(f,y){typeof f>"u"&&(f=2),typeof y>"u"&&(y=r.ClipperOffset.def_arc_tolerance),this.m_destPolys=new r.Paths,this.m_srcPoly=new r.Path,this.m_destPoly=new r.Path,this.m_normals=new Array,this.m_delta=0,this.m_sinA=0,this.m_sin=0,this.m_cos=0,this.m_miterLim=0,this.m_StepsPerRad=0,this.m_lowest=new r.IntPoint,this.m_polyNodes=new r.PolyNode,this.MiterLimit=f,this.ArcTolerance=y,this.m_lowest.X=-1},r.ClipperOffset.two_pi=6.28318530717959,r.ClipperOffset.def_arc_tolerance=.25,r.ClipperOffset.prototype.Clear=function(){r.Clear(this.m_polyNodes.Childs()),this.m_lowest.X=-1},r.ClipperOffset.Round=r.Clipper.Round,r.ClipperOffset.prototype.AddPath=function(f,y,S){var I=f.length-1;if(!(I<0)){var F=new r.PolyNode;if(F.m_jointype=y,F.m_endtype=S,S==r.EndType.etClosedLine||S==r.EndType.etClosedPolygon)for(;I>0&&r.IntPoint.op_Equality(f[0],f[I]);)I--;F.m_polygon.push(f[0]);for(var H=0,X=0,se=1;se<=I;se++)r.IntPoint.op_Inequality(F.m_polygon[H],f[se])&&(H++,F.m_polygon.push(f[se]),(f[se].Y>F.m_polygon[X].Y||f[se].Y==F.m_polygon[X].Y&&f[se].X<F.m_polygon[X].X)&&(X=H));if(!(S==r.EndType.etClosedPolygon&&H<2||S!=r.EndType.etClosedPolygon&&H<0)&&(this.m_polyNodes.AddChild(F),S==r.EndType.etClosedPolygon))if(this.m_lowest.X<0)this.m_lowest=new r.IntPoint(0,X);else{var de=this.m_polyNodes.Childs()[this.m_lowest.X].m_polygon[this.m_lowest.Y];(F.m_polygon[X].Y>de.Y||F.m_polygon[X].Y==de.Y&&F.m_polygon[X].X<de.X)&&(this.m_lowest=new r.IntPoint(this.m_polyNodes.ChildCount()-1,X))}}},r.ClipperOffset.prototype.AddPaths=function(f,y,S){for(var I=0,F=f.length;I<F;I++)this.AddPath(f[I],y,S)},r.ClipperOffset.prototype.FixOrientations=function(){if(this.m_lowest.X>=0&&!r.Clipper.Orientation(this.m_polyNodes.Childs()[this.m_lowest.X].m_polygon))for(var f=0;f<this.m_polyNodes.ChildCount();f++){var y=this.m_polyNodes.Childs()[f];(y.m_endtype==r.EndType.etClosedPolygon||y.m_endtype==r.EndType.etClosedLine&&r.Clipper.Orientation(y.m_polygon))&&y.m_polygon.reverse()}else for(var f=0;f<this.m_polyNodes.ChildCount();f++){var y=this.m_polyNodes.Childs()[f];y.m_endtype==r.EndType.etClosedLine&&!r.Clipper.Orientation(y.m_polygon)&&y.m_polygon.reverse()}},r.ClipperOffset.GetUnitNormal=function(f,y){var S=y.X-f.X,I=y.Y-f.Y;if(S==0&&I==0)return new r.DoublePoint(0,0);var F=1/Math.sqrt(S*S+I*I);return S*=F,I*=F,new r.DoublePoint(I,-S)},r.ClipperOffset.prototype.DoOffset=function(f){if(this.m_destPolys=new Array,this.m_delta=f,r.ClipperBase.near_zero(f)){for(var y=0;y<this.m_polyNodes.ChildCount();y++){var S=this.m_polyNodes.Childs()[y];S.m_endtype==r.EndType.etClosedPolygon&&this.m_destPolys.push(S.m_polygon)}return}this.MiterLimit>2?this.m_miterLim=2/(this.MiterLimit*this.MiterLimit):this.m_miterLim=.5;var I;this.ArcTolerance<=0?I=r.ClipperOffset.def_arc_tolerance:this.ArcTolerance>Math.abs(f)*r.ClipperOffset.def_arc_tolerance?I=Math.abs(f)*r.ClipperOffset.def_arc_tolerance:I=this.ArcTolerance;var F=3.14159265358979/Math.acos(1-I/Math.abs(f));this.m_sin=Math.sin(r.ClipperOffset.two_pi/F),this.m_cos=Math.cos(r.ClipperOffset.two_pi/F),this.m_StepsPerRad=F/r.ClipperOffset.two_pi,f<0&&(this.m_sin=-this.m_sin);for(var y=0;y<this.m_polyNodes.ChildCount();y++){var S=this.m_polyNodes.Childs()[y];this.m_srcPoly=S.m_polygon;var H=this.m_srcPoly.length;if(!(H==0||f<=0&&(H<3||S.m_endtype!=r.EndType.etClosedPolygon))){if(this.m_destPoly=new Array,H==1){if(S.m_jointype==r.JoinType.jtRound)for(var X=1,se=0,de=1;de<=F;de++){this.m_destPoly.push(new r.IntPoint(r.ClipperOffset.Round(this.m_srcPoly[0].X+X*f),r.ClipperOffset.Round(this.m_srcPoly[0].Y+se*f)));var Ee=X;X=X*this.m_cos-this.m_sin*se,se=Ee*this.m_sin+se*this.m_cos}else for(var X=-1,se=-1,de=0;de<4;++de)this.m_destPoly.push(new r.IntPoint(r.ClipperOffset.Round(this.m_srcPoly[0].X+X*f),r.ClipperOffset.Round(this.m_srcPoly[0].Y+se*f))),X<0?X=1:se<0?se=1:X=-1;this.m_destPolys.push(this.m_destPoly);continue}this.m_normals.length=0;for(var de=0;de<H-1;de++)this.m_normals.push(r.ClipperOffset.GetUnitNormal(this.m_srcPoly[de],this.m_srcPoly[de+1]));if(S.m_endtype==r.EndType.etClosedLine||S.m_endtype==r.EndType.etClosedPolygon?this.m_normals.push(r.ClipperOffset.GetUnitNormal(this.m_srcPoly[H-1],this.m_srcPoly[0])):this.m_normals.push(new r.DoublePoint(this.m_normals[H-2])),S.m_endtype==r.EndType.etClosedPolygon){for(var Ue=H-1,de=0;de<H;de++)Ue=this.OffsetPoint(de,Ue,S.m_jointype);this.m_destPolys.push(this.m_destPoly)}else if(S.m_endtype==r.EndType.etClosedLine){for(var Ue=H-1,de=0;de<H;de++)Ue=this.OffsetPoint(de,Ue,S.m_jointype);this.m_destPolys.push(this.m_destPoly),this.m_destPoly=new Array;for(var Ye=this.m_normals[H-1],de=H-1;de>0;de--)this.m_normals[de]=new r.DoublePoint(-this.m_normals[de-1].X,-this.m_normals[de-1].Y);this.m_normals[0]=new r.DoublePoint(-Ye.X,-Ye.Y),Ue=0;for(var de=H-1;de>=0;de--)Ue=this.OffsetPoint(de,Ue,S.m_jointype);this.m_destPolys.push(this.m_destPoly)}else{for(var Ue=0,de=1;de<H-1;++de)Ue=this.OffsetPoint(de,Ue,S.m_jointype);var dt;if(S.m_endtype==r.EndType.etOpenButt){var de=H-1;dt=new r.IntPoint(r.ClipperOffset.Round(this.m_srcPoly[de].X+this.m_normals[de].X*f),r.ClipperOffset.Round(this.m_srcPoly[de].Y+this.m_normals[de].Y*f)),this.m_destPoly.push(dt),dt=new r.IntPoint(r.ClipperOffset.Round(this.m_srcPoly[de].X-this.m_normals[de].X*f),r.ClipperOffset.Round(this.m_srcPoly[de].Y-this.m_normals[de].Y*f)),this.m_destPoly.push(dt)}else{var de=H-1;Ue=H-2,this.m_sinA=0,this.m_normals[de]=new r.DoublePoint(-this.m_normals[de].X,-this.m_normals[de].Y),S.m_endtype==r.EndType.etOpenSquare?this.DoSquare(de,Ue):this.DoRound(de,Ue)}for(var de=H-1;de>0;de--)this.m_normals[de]=new r.DoublePoint(-this.m_normals[de-1].X,-this.m_normals[de-1].Y);this.m_normals[0]=new r.DoublePoint(-this.m_normals[1].X,-this.m_normals[1].Y),Ue=H-1;for(var de=Ue-1;de>0;--de)Ue=this.OffsetPoint(de,Ue,S.m_jointype);S.m_endtype==r.EndType.etOpenButt?(dt=new r.IntPoint(r.ClipperOffset.Round(this.m_srcPoly[0].X-this.m_normals[0].X*f),r.ClipperOffset.Round(this.m_srcPoly[0].Y-this.m_normals[0].Y*f)),this.m_destPoly.push(dt),dt=new r.IntPoint(r.ClipperOffset.Round(this.m_srcPoly[0].X+this.m_normals[0].X*f),r.ClipperOffset.Round(this.m_srcPoly[0].Y+this.m_normals[0].Y*f)),this.m_destPoly.push(dt)):(Ue=1,this.m_sinA=0,S.m_endtype==r.EndType.etOpenSquare?this.DoSquare(0,1):this.DoRound(0,1)),this.m_destPolys.push(this.m_destPoly)}}}},r.ClipperOffset.prototype.Execute=function(){var f=arguments,y=f[0]instanceof r.PolyTree;if(y){var S=f[0],I=f[1];S.Clear(),this.FixOrientations(),this.DoOffset(I);var F=new r.Clipper(0);if(F.AddPaths(this.m_destPolys,r.PolyType.ptSubject,!0),I>0)F.Execute(r.ClipType.ctUnion,S,r.PolyFillType.pftPositive,r.PolyFillType.pftPositive);else{var H=r.Clipper.GetBounds(this.m_destPolys),X=new r.Path;if(X.push(new r.IntPoint(H.left-10,H.bottom+10)),X.push(new r.IntPoint(H.right+10,H.bottom+10)),X.push(new r.IntPoint(H.right+10,H.top-10)),X.push(new r.IntPoint(H.left-10,H.top-10)),F.AddPath(X,r.PolyType.ptSubject,!0),F.ReverseSolution=!0,F.Execute(r.ClipType.ctUnion,S,r.PolyFillType.pftNegative,r.PolyFillType.pftNegative),S.ChildCount()==1&&S.Childs()[0].ChildCount()>0){var se=S.Childs()[0];S.Childs()[0]=se.Childs()[0];for(var de=1;de<se.ChildCount();de++)S.AddChild(se.Childs()[de])}else S.Clear()}}else{var S=f[0],I=f[1];r.Clear(S),this.FixOrientations(),this.DoOffset(I);var F=new r.Clipper(0);if(F.AddPaths(this.m_destPolys,r.PolyType.ptSubject,!0),I>0)F.Execute(r.ClipType.ctUnion,S,r.PolyFillType.pftPositive,r.PolyFillType.pftPositive);else{var H=r.Clipper.GetBounds(this.m_destPolys),X=new r.Path;X.push(new r.IntPoint(H.left-10,H.bottom+10)),X.push(new r.IntPoint(H.right+10,H.bottom+10)),X.push(new r.IntPoint(H.right+10,H.top-10)),X.push(new r.IntPoint(H.left-10,H.top-10)),F.AddPath(X,r.PolyType.ptSubject,!0),F.ReverseSolution=!0,F.Execute(r.ClipType.ctUnion,S,r.PolyFillType.pftNegative,r.PolyFillType.pftNegative),S.length>0&&S.splice(0,1)}}},r.ClipperOffset.prototype.OffsetPoint=function(f,y,S){if(this.m_sinA=this.m_normals[y].X*this.m_normals[f].Y-this.m_normals[f].X*this.m_normals[y].Y,this.m_sinA<5e-5&&this.m_sinA>-5e-5)return y;if(this.m_sinA>1?this.m_sinA=1:this.m_sinA<-1&&(this.m_sinA=-1),this.m_sinA*this.m_delta<0)this.m_destPoly.push(new r.IntPoint(r.ClipperOffset.Round(this.m_srcPoly[f].X+this.m_normals[y].X*this.m_delta),r.ClipperOffset.Round(this.m_srcPoly[f].Y+this.m_normals[y].Y*this.m_delta))),this.m_destPoly.push(new r.IntPoint(this.m_srcPoly[f])),this.m_destPoly.push(new r.IntPoint(r.ClipperOffset.Round(this.m_srcPoly[f].X+this.m_normals[f].X*this.m_delta),r.ClipperOffset.Round(this.m_srcPoly[f].Y+this.m_normals[f].Y*this.m_delta)));else switch(S){case r.JoinType.jtMiter:{var I=1+(this.m_normals[f].X*this.m_normals[y].X+this.m_normals[f].Y*this.m_normals[y].Y);I>=this.m_miterLim?this.DoMiter(f,y,I):this.DoSquare(f,y);break}case r.JoinType.jtSquare:this.DoSquare(f,y);break;case r.JoinType.jtRound:this.DoRound(f,y);break}return y=f,y},r.ClipperOffset.prototype.DoSquare=function(f,y){var S=Math.tan(Math.atan2(this.m_sinA,this.m_normals[y].X*this.m_normals[f].X+this.m_normals[y].Y*this.m_normals[f].Y)/4);this.m_destPoly.push(new r.IntPoint(r.ClipperOffset.Round(this.m_srcPoly[f].X+this.m_delta*(this.m_normals[y].X-this.m_normals[y].Y*S)),r.ClipperOffset.Round(this.m_srcPoly[f].Y+this.m_delta*(this.m_normals[y].Y+this.m_normals[y].X*S)))),this.m_destPoly.push(new r.IntPoint(r.ClipperOffset.Round(this.m_srcPoly[f].X+this.m_delta*(this.m_normals[f].X+this.m_normals[f].Y*S)),r.ClipperOffset.Round(this.m_srcPoly[f].Y+this.m_delta*(this.m_normals[f].Y-this.m_normals[f].X*S))))},r.ClipperOffset.prototype.DoMiter=function(f,y,S){var I=this.m_delta/S;this.m_destPoly.push(new r.IntPoint(r.ClipperOffset.Round(this.m_srcPoly[f].X+(this.m_normals[y].X+this.m_normals[f].X)*I),r.ClipperOffset.Round(this.m_srcPoly[f].Y+(this.m_normals[y].Y+this.m_normals[f].Y)*I)))},r.ClipperOffset.prototype.DoRound=function(f,y){for(var S=Math.atan2(this.m_sinA,this.m_normals[y].X*this.m_normals[f].X+this.m_normals[y].Y*this.m_normals[f].Y),I=r.Cast_Int32(r.ClipperOffset.Round(this.m_StepsPerRad*Math.abs(S))),F=this.m_normals[y].X,H=this.m_normals[y].Y,X,se=0;se<I;++se)this.m_destPoly.push(new r.IntPoint(r.ClipperOffset.Round(this.m_srcPoly[f].X+F*this.m_delta),r.ClipperOffset.Round(this.m_srcPoly[f].Y+H*this.m_delta))),X=F,F=F*this.m_cos-this.m_sin*H,H=X*this.m_sin+H*this.m_cos;this.m_destPoly.push(new r.IntPoint(r.ClipperOffset.Round(this.m_srcPoly[f].X+this.m_normals[f].X*this.m_delta),r.ClipperOffset.Round(this.m_srcPoly[f].Y+this.m_normals[f].Y*this.m_delta)))},r.Error=function(f){try{throw new Error(f)}catch(y){alert(y.message)}},r.JS={},r.JS.AreaOfPolygon=function(f,y){return y||(y=1),r.Clipper.Area(f)/(y*y)},r.JS.AreaOfPolygons=function(f,y){y||(y=1);for(var S=0,I=0;I<f.length;I++)S+=r.Clipper.Area(f[I]);return S/(y*y)},r.JS.BoundsOfPath=function(f,y){return r.JS.BoundsOfPaths([f],y)},r.JS.BoundsOfPaths=function(f,y){y||(y=1);var S=r.Clipper.GetBounds(f);return S.left/=y,S.bottom/=y,S.right/=y,S.top/=y,S},r.JS.Clean=function(I,y){if(!(I instanceof Array))return[];var S=I[0]instanceof Array,I=r.JS.Clone(I);if(typeof y!="number"||y===null)return r.Error("Delta is not a number in Clean()."),I;if(I.length===0||I.length==1&&I[0].length===0||y<0)return I;S||(I=[I]);for(var F=I.length,H,X,se,de,Ee,Ue,Ye,dt=[],Pt=0;Pt<F;Pt++)if(X=I[Pt],H=X.length,H!==0){if(H<3){se=X,dt.push(se);continue}for(se=X,de=y*y,Ee=X[0],Ue=1,Ye=1;Ye<H;Ye++)(X[Ye].X-Ee.X)*(X[Ye].X-Ee.X)+(X[Ye].Y-Ee.Y)*(X[Ye].Y-Ee.Y)<=de||(se[Ue]=X[Ye],Ee=X[Ye],Ue++);Ee=X[Ue-1],(X[0].X-Ee.X)*(X[0].X-Ee.X)+(X[0].Y-Ee.Y)*(X[0].Y-Ee.Y)<=de&&Ue--,Ue<H&&se.splice(Ue,H-Ue),se.length&&dt.push(se)}return!S&&dt.length?dt=dt[0]:!S&&dt.length===0?dt=[]:S&&dt.length===0&&(dt=[[]]),dt},r.JS.Clone=function(f){if(!(f instanceof Array))return[];if(f.length===0)return[];if(f.length==1&&f[0].length===0)return[[]];var y=f[0]instanceof Array;y||(f=[f]);var S=f.length,I,F,H,X,se=new Array(S);for(F=0;F<S;F++){for(I=f[F].length,X=new Array(I),H=0;H<I;H++)X[H]={X:f[F][H].X,Y:f[F][H].Y};se[F]=X}return y||(se=se[0]),se},r.JS.Lighten=function(f,y){if(!(f instanceof Array))return[];if(typeof y!="number"||y===null)return r.Error("Tolerance is not a number in Lighten()."),r.JS.Clone(f);if(f.length===0||f.length==1&&f[0].length===0||y<0)return r.JS.Clone(f);f[0]instanceof Array||(f=[f]);var S,I,F,H,X,se,de,Ee,Ue,Ye,dt,Pt,Ct,Wt,Ii,Lr,fn,pg=f.length,dg=y*y,Wa=[];for(S=0;S<pg;S++)if(F=f[S],se=F.length,se!=0){for(H=0;H<1e6;H++){for(X=[],se=F.length,F[se-1].X!=F[0].X||F[se-1].Y!=F[0].Y?(Pt=1,F.push({X:F[0].X,Y:F[0].Y}),se=F.length):Pt=0,dt=[],I=0;I<se-2;I++)de=F[I],Ue=F[I+1],Ee=F[I+2],Lr=de.X,fn=de.Y,Ct=Ee.X-Lr,Wt=Ee.Y-fn,(Ct!==0||Wt!==0)&&(Ii=((Ue.X-Lr)*Ct+(Ue.Y-fn)*Wt)/(Ct*Ct+Wt*Wt),Ii>1?(Lr=Ee.X,fn=Ee.Y):Ii>0&&(Lr+=Ct*Ii,fn+=Wt*Ii)),Ct=Ue.X-Lr,Wt=Ue.Y-fn,Ye=Ct*Ct+Wt*Wt,Ye<=dg&&(dt[I+1]=1,I++);for(X.push({X:F[0].X,Y:F[0].Y}),I=1;I<se-1;I++)dt[I]||X.push({X:F[I].X,Y:F[I].Y});if(X.push({X:F[se-1].X,Y:F[se-1].Y}),Pt&&F.pop(),dt.length)F=X;else break}se=X.length,X[se-1].X==X[0].X&&X[se-1].Y==X[0].Y&&X.pop(),X.length>2&&Wa.push(X)}return!f[0]instanceof Array&&(Wa=Wa[0]),typeof Wa>"u"&&(Wa=[[]]),Wa},r.JS.PerimeterOfPath=function(f,y,S){if(typeof f>"u")return 0;var I=Math.sqrt,F=0,H,X,se=0,de=0,Ee=0,Ue=0,Ye=f.length;if(Ye<2)return 0;for(y&&(f[Ye]=f[0],Ye++);--Ye;)H=f[Ye],se=H.X,de=H.Y,X=f[Ye-1],Ee=X.X,Ue=X.Y,F+=I((se-Ee)*(se-Ee)+(de-Ue)*(de-Ue));return y&&f.pop(),F/S},r.JS.PerimeterOfPaths=function(f,y,S){S||(S=1);for(var I=0,F=0;F<f.length;F++)I+=r.JS.PerimeterOfPath(f[F],y,S);return I},r.JS.ScaleDownPath=function(f,y){var S,I;for(y||(y=1),S=f.length;S--;)I=f[S],I.X=I.X/y,I.Y=I.Y/y},r.JS.ScaleDownPaths=function(f,y){var S,I,F;for(y||(y=1),S=f.length;S--;)for(I=f[S].length;I--;)F=f[S][I],F.X=F.X/y,F.Y=F.Y/y},r.JS.ScaleUpPath=function(f,y){var S,I,F=Math.round;for(y||(y=1),S=f.length;S--;)I=f[S],I.X=F(I.X*y),I.Y=F(I.Y*y)},r.JS.ScaleUpPaths=function(f,y){var S,I,F,H=Math.round;for(y||(y=1),S=f.length;S--;)for(I=f[S].length;I--;)F=f[S][I],F.X=H(F.X*y),F.Y=H(F.Y*y)},r.ExPolygons=function(){return[]},r.ExPolygon=function(){this.outer=null,this.holes=null},r.JS.AddOuterPolyNodeToExPolygons=function(f,y){var S=new r.ExPolygon;S.outer=f.Contour();var I=f.Childs(),F=I.length;S.holes=new Array(F);var H,X,se,de,Ee,Ue;for(se=0;se<F;se++)for(H=I[se],S.holes[se]=H.Contour(),de=0,Ee=H.Childs(),Ue=Ee.length;de<Ue;de++)X=Ee[de],r.JS.AddOuterPolyNodeToExPolygons(X,y);y.push(S)},r.JS.ExPolygonsToPaths=function(f){var y,S,I,F,H=new r.Paths;for(y=0,I=f.length;y<I;y++)for(H.push(f[y].outer),S=0,F=f[y].holes.length;S<F;S++)H.push(f[y].holes[S]);return H},r.JS.PolyTreeToExPolygons=function(f){var y=new r.ExPolygons,S,I,F,H;for(I=0,F=f.Childs(),H=F.length;I<H;I++)S=F[I],r.JS.AddOuterPolyNodeToExPolygons(S,y);return y},e.exports=r}),Z0e={};oh(Z0e,{Annotation:()=>XE,Connection:()=>t_,Coordinate:()=>vr,Door:()=>Qx,E_SDK_LOG_LEVEL:()=>GY,Floor:()=>e_,Hyperlink:()=>IJ,Image:()=>NJ,MapObject:()=>rh,PointOfInterest:()=>i_,Space:()=>ih,analytics:()=>l2e,createMapLibreOverlay:()=>E2e,enableTestMode:()=>JK,getMapData:()=>Dte,getMapDataEnterprise:()=>Ate,hydrateMapDataFromMVF:()=>C2e,parseMVF:()=>Zx,setLoggerLevel:()=>WY,setUseEnterpriseAPI:()=>Lte,show3dMap:()=>Rte,show3dMapGeojson:()=>kte,unzipMVF:()=>Yx});R();R();var j3=new WeakMap,vn,HY=class{constructor(e){fe(this,vn,void 0),ke(this,vn,e),j3.set(this,e)}get mapName(){return M(this,vn).mapName}get mapCenter(){return M(this,vn).mapCenter}get organizationId(){return M(this,vn).organizationId}get outdoorViewToken(){return M(this,vn).outdoorViewToken}getByType(e){switch(e){case"space":return M(this,vn).spaces;case"door":return M(this,vn).doors;case"floor":return M(this,vn).floors;case"connection":return M(this,vn).connections;case"object":return M(this,vn).objects;case"point-of-interest":return M(this,vn).pointsOfInterest;case"annotation":return M(this,vn).annotations;default:return[]}}getById(e,t){return M(this,vn).getById(e,t)}};vn=new WeakMap,h(HY,"MapData");var Y0e=HY,jE=Y0e;R();R();R();var GY=(i=>(i[i.LOG=0]="LOG",i[i.WARN=1]="WARN",i[i.ERROR=2]="ERROR",i[i.SILENT=3]="SILENT",i))(GY||{});function WY(i){0<=i&&i<=3&&(XY.logState=i)}h(WY,"setLoggerLevel");var XY={logState:hr.env.NODE_ENV==="test"?3:0,log(...i){this.logState<=0&&console.log("[MappedinJS]",...i)},warn(...i){this.logState<=1&&console.warn("[MappedinJS]",...i)},error(...i){this.logState<=2&&console.error("[MappedinJS]",...i)},assert(...i){console.assert(...i)},time(i){console.time(i)},timeEnd(i){console.timeEnd(i)}},Ft=XY,Z6=globalThis.fetch,Y6,J0e=(Y6=hr==null?void 0:hr.env)==null?void 0:Y6.npm_package_version,qY="https://app.mappedin.com/";function ud(){if(Z6==null)throw new Error("fetch is not available in your environment. Pass your own function into `setFetchFn` (node-fetch, etc)");return Z6}h(ud,"isomorphicFetch");var ZY={supplementaryUrl:"https://api-gateway.mappedin.com/analytics/",headers:{},accessToken:"",clientId:"",noAuth:!1,includeHidden:!0,clientSecret:"",apiGateway:"",authorization:"",perspective:"Website",language:"",venue:""};function YY(i){var e;let t={...ZY,...i};return t.headers={...t.headers,"mappedin-sdk-version":J0e},t.things=[],"platformString"in i&&(t.headers={...t.headers,"mappedin-platform-version":i.platformString}),t.noAuth||(t.accessToken?t.authorization=`Bearer ${t.accessToken}`:t.clientId&&t.clientSecret&&(t.authorization=`Basic ${globalThis.btoa(`${t.clientId}:${t.clientSecret}`)}`)),t.language=(e=t.language)==null?void 0:e.toLowerCase(),t}h(YY,"parseOptions");function JY(i,e,t=!1){let r={language:i.language,clientId:i.clientId,clientSecret:i.clientSecret};t&&delete r.language,r.language&&(e+=`&lang=${encodeURIComponent(r.language)}`);let{headers:n}=i;n["Content-Type"]=n["Content-Type"]||"text/json",i.accessToken?n.Authorization=`Bearer ${i.accessToken}`:i.noAuth||i.clientId&&i.clientSecret&&(n["x-mappedin-key"]=btoa(i.clientId),n["x-mappedin-secret"]=btoa(i.clientSecret)),r.language&&(n["Accept-Language"]=r.language);let a={method:"GET",headers:n};return i.secure&&(e+="&withcdntoken"),{req:a,url:e}}h(JY,"constructParamsForRequest");async function KY(i,e,t=!1){let r=JY(i,e,t),n=await ud()(r.url,r.req);if(!n.ok)throw new Error(`${n.status} ${n.statusText}`);return n.json()}h(KY,"generateAPIRequest");async function QY(i,e="exports/mvf/1/bundle"){var t;let r=YY({baseUri:"https://api-gateway.mappedin.com/",...ZY,...i}),n=`${r.baseUri+e}?venue=${r.venue}&version=${(t=r.version)!=null?t:"2.0.0"}`;return r.headers["Content-Type"]="application/zip",await KY(r,n)}h(QY,"getVenueMVFURL");async function eJ(i){return new Promise(async(e,t)=>{try{let{url:r}=await QY(i,"exports/mvf2/1/bundle"),n=await ud()(r).then(o=>o.arrayBuffer()),a=new Uint8Array(n);e(a)}catch(r){t(r)}})}h(eJ,"downloadVenueBundleMVFAPIGateway");async function tJ(i,e){return new Promise(async(t,r)=>{try{let{url:n}=await iJ(i,e),a=await ud()(n).then(s=>s.arrayBuffer()),o=new Uint8Array(a);t(o)}catch(n){r(n)}})}h(tJ,"downloadMVF");function HE(i){return i.endsWith("/")?i:`${i}/`}h(HE,"normalizeUrl");async function iJ(i,e){let t=`${i.baseUri?HE(i.baseUri):qY}api/venue/${i.mapId}/mvf${i.viewId?`?configId=${i.viewId}`:""}`,r=await ud()(t,{headers:{Authorization:`Bearer ${e}`}});if(!r.ok)throw new Error(`${r.status} ${r.statusText}`);return r.json()}h(iJ,"getMakerBundleURL");async function GE(i){let e=`${i.baseUri?HE(i.baseUri):qY}api/api-key/token`,t=await ud()(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({key:i.key,secret:i.secret})});if(!t.ok)throw new Error(`${t.status} ${t.statusText}`);return t.json()}h(GE,"getAccessToken");function Zx(i){let e=new TextDecoder,t=e.decode.bind(e);try{let r={"connection.json":JSON.parse(t(i["connection.json"])),"manifest.geojson":JSON.parse(t(i["manifest.geojson"])),"map.geojson":JSON.parse(t(i["map.geojson"])),"mapstack.geojson":i["mapstack.geojson"]?JSON.parse(t(i["mapstack.geojson"])):void 0,"node.geojson":JSON.parse(t(i["node.geojson"])),obstruction:{},space:{},entrance:{}};if((r["mapstack.geojson"]==null||"mapstack.json"in i)&&(r["mapstack.json"]=JSON.parse(t(i["mapstack.json"]))),"styles.json"in i&&(r["styles.json"]=JSON.parse(t(i["styles.json"]))),"shapes.json"in i&&(r["shapes.json"]=JSON.parse(t(i["shapes.json"]))),i.annotation!=null){r.annotation={};let a=Object.keys(i.annotation);for(let o of a){let s=o.replace(/\.json|\.geojson/g,"");r.annotation[s]=JSON.parse(t(i.annotation[o]))}}let n=Object.keys(i.space);for(let a of n){let o=a.replace(/\.json|\.geojson/g,"");r.space[o]=JSON.parse(t(i.space[a]))}if(i.obstruction!=null){let a=Object.keys(i.obstruction);for(let o of a){let s=o.replace(/\.json|\.geojson/g,"");r.obstruction[s]=JSON.parse(t(i.obstruction[o]))}}else r.obstruction={};if(i.entrance!=null){let a=Object.keys(i.entrance);for(let o of a){let s=o.replace(/\.json|\.geojson/g,"");r.entrance[s]=JSON.parse(t(i.entrance[o]))}}else r.entrance={};return r}catch(r){throw Ft.error(r),new Error("MVF parsing failed! Probably encountered a bad file.")}}h(Zx,"parseMVF");function rJ(i){if(i==null||typeof i!="object")return!1;let e=["connection.json","manifest.geojson","map.geojson","node.geojson","mapstack.json"in i?"mapstack.json":"mapstack.geojson"];"styles.json"in i&&e.push("styles.json"),"shapes.json"in i&&e.push("shapes.json");for(let t of e)if(i[t]==null||i[t][Symbol.toStringTag]!=="Uint8Array")return!1;return!0}h(rJ,"validateStaticMVFFiles");async function Yx(i){return new Promise(async(e,t)=>{try{if(i==null||typeof i!="object")throw new Error("Error parsing data! Unzipping failed.");if(i[Symbol.toStringTag]!=="Uint8Array")throw new Error("Unexpected file type! Unzipping failed.");let r=(await zm(async()=>{const{unzipSync:o}=await import("./browser-VJJYXKCR-Ct6Z1Y9D.js");return{unzipSync:o}},[])).unzipSync(i);if(!rJ(r))throw new Error("MVF is missing some expect static files. Unzipping failed.");let n={},a=Object.keys(r);for(let o of a){if(r[o].length===0)continue;let s=o.split("/");if(s.length<0)throw new Error("Encounted a file with no name! Unzipping failed.");if(s.length>2)throw new Error("Encountered unexpected nesting in MVF! Unzipping failed.");if(s.length===1){n[s[0]]=r[o];continue}if(s[0]==="image"){Ft.warn("MVF unzipping encountered an image. Ignoring as this case has not been implemented.");continue}else n[s[0]]==null&&(n[s[0]]={}),n[s[0]][s[1]]=r[o]}e(n)}catch(r){t(r)}})}h(Yx,"unzipMVF");R();R();R();R();var In=63710088e-1,nJ={centimeters:In*100,centimetres:In*100,degrees:In/111325,feet:In*3.28084,inches:In*39.37,kilometers:In/1e3,kilometres:In/1e3,meters:In,metres:In,miles:In/1609.344,millimeters:In*1e3,millimetres:In*1e3,nauticalmiles:In/1852,radians:1,yards:In*1.0936};function th(i,e,t){t===void 0&&(t={});var r={type:"Feature"};return(t.id===0||t.id)&&(r.id=t.id),t.bbox&&(r.bbox=t.bbox),r.properties=e||{},r.geometry=i,r}h(th,"feature");function Nu(i,e,t){if(t===void 0&&(t={}),!i)throw new Error("coordinates is required");if(!Array.isArray(i))throw new Error("coordinates must be an Array");if(i.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!H3(i[0])||!H3(i[1]))throw new Error("coordinates must contain numbers");var r={type:"Point",coordinates:i};return th(r,e,t)}h(Nu,"point");function Xp(i,e,t){if(t===void 0&&(t={}),i.length<2)throw new Error("coordinates must be an array of two or more positions");var r={type:"LineString",coordinates:i};return th(r,e,t)}h(Xp,"lineString");function Lv(i,e){e===void 0&&(e={});var t={type:"FeatureCollection"};return e.id&&(t.id=e.id),e.bbox&&(t.bbox=e.bbox),t.features=i,t}h(Lv,"featureCollection");function aJ(i,e){e===void 0&&(e="kilometers");var t=nJ[e];if(!t)throw new Error(e+" units is invalid");return i*t}h(aJ,"radiansToLength");function oJ(i,e){e===void 0&&(e="kilometers");var t=nJ[e];if(!t)throw new Error(e+" units is invalid");return i/t}h(oJ,"lengthToRadians");function Dv(i){var e=i%(2*Math.PI);return e*180/Math.PI}h(Dv,"radiansToDegrees");function Fa(i){var e=i%360;return e*Math.PI/180}h(Fa,"degreesToRadians");function H3(i){return!isNaN(i)&&i!==null&&!Array.isArray(i)}h(H3,"isNumber");function Nl(i){if(!i)throw new Error("coord is required");if(!Array.isArray(i)){if(i.type==="Feature"&&i.geometry!==null&&i.geometry.type==="Point")return i.geometry.coordinates;if(i.type==="Point")return i.coordinates}if(Array.isArray(i)&&i.length>=2&&!Array.isArray(i[0])&&!Array.isArray(i[1]))return i;throw new Error("coord must be GeoJSON Point or an Array of numbers")}h(Nl,"getCoord");function Ds(i){if(Array.isArray(i))return i;if(i.type==="Feature"){if(i.geometry!==null)return i.geometry.coordinates}else if(i.coordinates)return i.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}h(Ds,"getCoords");function sJ(i){return i.type==="Feature"?i.geometry:i}h(sJ,"getGeom");function lJ(i,e){return i.type==="FeatureCollection"?"FeatureCollection":i.type==="GeometryCollection"?"GeometryCollection":i.type==="Feature"&&i.geometry!==null?i.geometry.type:i.type}h(lJ,"getType");function uJ(i,e,t){t===void 0&&(t={});for(var r=Nl(i),n=Ds(e),a=0;a<n.length-1;a++){var o=!1;if(t.ignoreEndVertices&&(a===0&&(o="start"),a===n.length-2&&(o="end"),a===0&&a+1===n.length-1&&(o="both")),hJ(n[a],n[a+1],r,o,typeof t.epsilon>"u"?null:t.epsilon))return!0}return!1}h(uJ,"booleanPointOnLine");function hJ(i,e,t,r,n){var a=t[0],o=t[1],s=i[0],l=i[1],u=e[0],c=e[1],p=t[0]-s,d=t[1]-l,m=u-s,g=c-l,b=p*g-d*m;if(n!==null){if(Math.abs(b)>n)return!1}else if(b!==0)return!1;if(r){if(r==="start")return Math.abs(m)>=Math.abs(g)?m>0?s<a&&a<=u:u<=a&&a<s:g>0?l<o&&o<=c:c<=o&&o<l;if(r==="end")return Math.abs(m)>=Math.abs(g)?m>0?s<=a&&a<u:u<a&&a<=s:g>0?l<=o&&o<c:c<o&&o<=l;if(r==="both")return Math.abs(m)>=Math.abs(g)?m>0?s<a&&a<u:u<a&&a<s:g>0?l<o&&o<c:c<o&&o<l}else return Math.abs(m)>=Math.abs(g)?m>0?s<=a&&a<=u:u<=a&&a<=s:g>0?l<=o&&o<=c:c<=o&&o<=l;return!1}h(hJ,"isPointOnLineSegment");var K0e=uJ;R();R();R();function Jx(i,e,t){if(i!==null)for(var r,n,a,o,s,l,u,c=0,p=0,d,m=i.type,g=m==="FeatureCollection",b=m==="Feature",x=g?i.features.length:1,v=0;v<x;v++){u=g?i.features[v].geometry:b?i.geometry:i,d=u?u.type==="GeometryCollection":!1,s=d?u.geometries.length:1;for(var w=0;w<s;w++){var _=0,C=0;if(o=d?u.geometries[w]:u,o!==null){l=o.coordinates;var E=o.type;switch(c=t&&(E==="Polygon"||E==="MultiPolygon")?1:0,E){case null:break;case"Point":if(e(l,p,v,_,C)===!1)return!1;p++,_++;break;case"LineString":case"MultiPoint":for(r=0;r<l.length;r++){if(e(l[r],p,v,_,C)===!1)return!1;p++,E==="MultiPoint"&&_++}E==="LineString"&&_++;break;case"Polygon":case"MultiLineString":for(r=0;r<l.length;r++){for(n=0;n<l[r].length-c;n++){if(e(l[r][n],p,v,_,C)===!1)return!1;p++}E==="MultiLineString"&&_++,E==="Polygon"&&C++}E==="Polygon"&&_++;break;case"MultiPolygon":for(r=0;r<l.length;r++){for(C=0,n=0;n<l[r].length;n++){for(a=0;a<l[r][n].length-c;a++){if(e(l[r][n][a],p,v,_,C)===!1)return!1;p++}C++}_++}break;case"GeometryCollection":for(r=0;r<o.geometries.length;r++)if(Jx(o.geometries[r],e,t)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}h(Jx,"coordEach");function G3(i,e){if(i.type==="Feature")e(i,0);else if(i.type==="FeatureCollection")for(var t=0;t<i.features.length&&e(i.features[t],t)!==!1;t++);}h(G3,"featureEach");function cJ(i,e){var t,r,n,a,o,s,l,u,c,p,d=0,m=i.type==="FeatureCollection",g=i.type==="Feature",b=m?i.features.length:1;for(t=0;t<b;t++){for(s=m?i.features[t].geometry:g?i.geometry:i,u=m?i.features[t].properties:g?i.properties:{},c=m?i.features[t].bbox:g?i.bbox:void 0,p=m?i.features[t].id:g?i.id:void 0,l=s?s.type==="GeometryCollection":!1,o=l?s.geometries.length:1,n=0;n<o;n++){if(a=l?s.geometries[n]:s,a===null){if(e(null,d,u,c,p)===!1)return!1;continue}switch(a.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(e(a,d,u,c,p)===!1)return!1;break}case"GeometryCollection":{for(r=0;r<a.geometries.length;r++)if(e(a.geometries[r],d,u,c,p)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}d++}}h(cJ,"geomEach");function Kx(i,e){cJ(i,function(t,r,n,a,o){var s=t===null?null:t.type;switch(s){case null:case"Point":case"LineString":case"Polygon":return e(th(t,n,{bbox:a,id:o}),r,0)===!1?!1:void 0}var l;switch(s){case"MultiPoint":l="Point";break;case"MultiLineString":l="LineString";break;case"MultiPolygon":l="Polygon";break}for(var u=0;u<t.coordinates.length;u++){var c=t.coordinates[u],p={type:l,coordinates:c};if(e(th(p,n),r,u)===!1)return!1}})}h(Kx,"flattenEach");function pJ(i,e){Kx(i,function(t,r,n){var a=0;if(t.geometry){var o=t.geometry.type;if(!(o==="Point"||o==="MultiPoint")){var s,l=0,u=0,c=0;if(Jx(t,function(p,d,m,g,b){if(s===void 0||r>l||g>u||b>c){s=p,l=r,u=g,c=b,a=0;return}var x=Xp([s,p],t.properties);if(e(x,r,n,b,a)===!1)return!1;a++,s=p})===!1)return!1}}})}h(pJ,"segmentEach");function dJ(i,e,t){var r=t,n=!1;return pJ(i,function(a,o,s,l,u){n===!1&&t===void 0?r=a:r=e(r,a,o,s,l,u),n=!0}),r}h(dJ,"segmentReduce");function kv(i){var e=[1/0,1/0,-1/0,-1/0];return Jx(i,function(t){e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])}),e}h(kv,"bbox");kv.default=kv;var fJ=kv;function mJ(i,e){e===void 0&&(e={});var t=fJ(i),r=(t[0]+t[2])/2,n=(t[1]+t[3])/2;return Nu([r,n],e.properties,e)}h(mJ,"center");var Q0e=mJ;R();R();function gJ(i,e,t){t===void 0&&(t={});var r=Nl(i),n=Nl(e),a=Fa(n[1]-r[1]),o=Fa(n[0]-r[0]),s=Fa(r[1]),l=Fa(n[1]),u=Math.pow(Math.sin(a/2),2)+Math.pow(Math.sin(o/2),2)*Math.cos(s)*Math.cos(l);return aJ(2*Math.atan2(Math.sqrt(u),Math.sqrt(1-u)),t.units)}h(gJ,"distance");var tc=gJ;function W3(i,e){return e===void 0&&(e={}),dJ(i,function(t,r){var n=r.geometry.coordinates;return t+tc(n[0],n[1],e)},0)}h(W3,"length");R();R();R();function WE(i,e,t){if(t===void 0&&(t={}),t.final===!0)return yJ(i,e);var r=Nl(i),n=Nl(e),a=Fa(r[0]),o=Fa(n[0]),s=Fa(r[1]),l=Fa(n[1]),u=Math.sin(o-a)*Math.cos(l),c=Math.cos(s)*Math.sin(l)-Math.sin(s)*Math.cos(l)*Math.cos(o-a);return Dv(Math.atan2(u,c))}h(WE,"bearing");function yJ(i,e){var t=WE(e,i);return t=(t+180)%360,t}h(yJ,"calculateFinalBearing");R();function Am(i,e,t,r){r===void 0&&(r={});var n=Nl(i),a=Fa(n[0]),o=Fa(n[1]),s=Fa(t),l=oJ(e,r.units),u=Math.asin(Math.sin(o)*Math.cos(l)+Math.cos(o)*Math.sin(l)*Math.cos(s)),c=a+Math.atan2(Math.sin(s)*Math.sin(l)*Math.cos(o),Math.cos(l)-Math.sin(o)*Math.sin(u)),p=Dv(c),d=Dv(u);return Nu([p,d],r.properties)}h(Am,"destination");R();R();function vJ(i){if(!i)throw new Error("geojson is required");var e=[];return Kx(i,function(t){xJ(t,e)}),Lv(e)}h(vJ,"lineSegment");function xJ(i,e){var t=[],r=i.geometry;if(r!==null){switch(r.type){case"Polygon":t=Ds(r);break;case"LineString":t=[Ds(r)]}t.forEach(function(n){var a=_J(n,i.properties);a.forEach(function(o){o.id=e.length,e.push(o)})})}}h(xJ,"lineSegmentFeature");function _J(i,e){var t=[];return i.reduce(function(r,n){var a=Xp([r,n],e);return a.bbox=bJ(r,n),t.push(a),n}),t}h(_J,"createSegments");function bJ(i,e){var t=i[0],r=i[1],n=e[0],a=e[1],o=t<n?t:n,s=r<a?r:a,l=t>n?t:n,u=r>a?r:a;return[o,s,l,u]}h(bJ,"bbox");var J6=vJ,eve=It(W0e(),1);function wJ(i,e){var t={},r=[];if(i.type==="LineString"&&(i=th(i)),e.type==="LineString"&&(e=th(e)),i.type==="Feature"&&e.type==="Feature"&&i.geometry!==null&&e.geometry!==null&&i.geometry.type==="LineString"&&e.geometry.type==="LineString"&&i.geometry.coordinates.length===2&&e.geometry.coordinates.length===2){var n=X3(i,e);return n&&r.push(n),Lv(r)}var a=(0,eve.default)();return a.load(J6(e)),G3(J6(i),function(o){G3(a.search(o),function(s){var l=X3(o,s);if(l){var u=Ds(l).join(",");t[u]||(t[u]=!0,r.push(l))}})}),Lv(r)}h(wJ,"lineIntersect");function X3(i,e){var t=Ds(i),r=Ds(e);if(t.length!==2)throw new Error("<intersects> line1 must only contain 2 coordinates");if(r.length!==2)throw new Error("<intersects> line2 must only contain 2 coordinates");var n=t[0][0],a=t[0][1],o=t[1][0],s=t[1][1],l=r[0][0],u=r[0][1],c=r[1][0],p=r[1][1],d=(p-u)*(o-n)-(c-l)*(s-a),m=(c-l)*(a-u)-(p-u)*(n-l),g=(o-n)*(a-u)-(s-a)*(n-l);if(d===0)return null;var b=m/d,x=g/d;if(b>=0&&b<=1&&x>=0&&x<=1){var v=n+b*(o-n),w=a+b*(s-a);return Nu([v,w])}return null}h(X3,"intersects");var tve=wJ;function SJ(i,e,t){t===void 0&&(t={});var r=Nu([1/0,1/0],{dist:1/0}),n=0;return Kx(i,function(a){for(var o=Ds(a),s=0;s<o.length-1;s++){var l=Nu(o[s]);l.properties.dist=tc(e,l,t);var u=Nu(o[s+1]);u.properties.dist=tc(e,u,t);var c=tc(l,u,t),p=Math.max(l.properties.dist,u.properties.dist),d=WE(l,u),m=Am(e,p,d+90,t),g=Am(e,p,d-90,t),b=tve(Xp([m.geometry.coordinates,g.geometry.coordinates]),Xp([l.geometry.coordinates,u.geometry.coordinates])),x=null;b.features.length>0&&(x=b.features[0],x.properties.dist=tc(e,x,t),x.properties.location=n+tc(l,x,t)),l.properties.dist<r.properties.dist&&(r=l,r.properties.index=s,r.properties.location=n),u.properties.dist<r.properties.dist&&(r=u,r.properties.index=s+1,r.properties.location=n+c),x&&x.properties.dist<r.properties.dist&&(r=x,r.properties.index=s),n+=c}}),r}h(SJ,"nearestPointOnLine");var q3=SJ;function MJ(i,e,t){var r=Ds(t);if(lJ(t)!=="LineString")throw new Error("line must be a LineString");var n=q3(t,i),a=q3(t,e),o;n.properties.index<=a.properties.index?o=[n,a]:o=[a,n];for(var s=[o[0].geometry.coordinates],l=o[0].properties.index+1;l<o[1].properties.index+1;l++)s.push(r[l]);return s.push(o[1].geometry.coordinates),Xp(s,t.properties)}h(MJ,"lineSlice");var K6=MJ,ive=1e-7;function Cy(i){return{type:"Point",coordinates:i}}h(Cy,"point");function CJ(i,e){let{coordinates:t}=e.geometry,{coordinates:r}=i.geometry,n=t.map(a=>q3(i,Cy(a)));return r.reduce((a,o)=>{let s=K6(Cy(o),n[0],i),l=K6(Cy(o),n[1],i),u=W3(s)<W3(l)?s:l;return u.properties={...i.properties,entrances:[]},a.concat([u])},[])}h(CJ,"splitObstructionByEntrance");function EJ(i,e){return e.reduce((t,r)=>{let n={epsilon:ive},a=t.findIndex(s=>K0e(Q0e(r),s,n)),o=t[a];if(o){let[s,l]=CJ(o,r);t.splice(a,1,s,l)}return t},[i])}h(EJ,"splitObstructionByAllEntrances");R();R();R();R();var N2=[0,4,6,8,10],Cr=h(()=>{let i=new Array(16).fill(0),e=Math.random()*4294967296;for(let r=0;r<i.length;r++)r>0&&!(r&3)&&(e=Math.random()*4294967296),i[r]=e>>>((r&3)<<3)&255;let t=i.map(r=>r.toString(16).padStart(2,"0"));return t[6]="4"+t[6][1],t[8]=["8","9","a","b"].includes(t[7][0])?t[7]:"a"+t[7][1],N2.map((r,n)=>t.slice(r,n===N2.length-1?void 0:N2[n+1]).join("")).join("-")},"randomId"),Z3=class Y3{constructor(e,t,r){Z(this,"__type",Y3.__type);Z(this,"id",Cr());Z(this,"latitude");Z(this,"longitude");Z(this,"floorId");this.latitude=e,this.longitude=t,this.floorId=r}static is(e){return e.__type===Y3.__type}isEqual(e){return this.latitude===e.latitude&&this.longitude===e.longitude&&this.floorId===e.floorId}toJSON(){return{latitude:this.latitude,longitude:this.longitude,floor:this.floorId}}destroy(){}};h(Z3,"Coordinate"),ie(Z3,"__type","coordinate");var rve=Z3,vr=rve;R();R();R();R();var TJ=class{constructor(e){Z(this,"id");this.id=e}};h(TJ,"BaseMetaData");var PJ=TJ,Ey,pf,J3=class AJ extends PJ{constructor(e){super(String(Cr())),fe(this,Ey,{}),fe(this,pf,void 0),ke(this,pf,e.mvfData)}static is(e){return e.__type===AJ.__type}get url(){return M(this,pf).url}get name(){return M(this,pf).displayName}toJSON(){return{id:this.id,url:this.url,name:this.name}}destroy(){for(let e of globalThis.Object.keys(M(this,Ey)))delete M(this,Ey)[e]}};Ey=new WeakMap,pf=new WeakMap,h(J3,"Hyperlink"),ie(J3,"__type","hyperlink");var nve=J3,IJ=nve,LJ=class{constructor(e,t){Z(this,"id");Z(this,"links",[]);var r;this.id=e;let n=(r=t==null?void 0:t.links)!=null?r:[];n.length>0&&(this.links=n.map(a=>new IJ({mvfData:a})))}};h(LJ,"BaseMapData");var ql=LJ,ic,Ks,rc,uu,K3=class Q3 extends ql{constructor(e,t){super(t.mvfData.properties.id,t.mvfData.properties.details),ie(this,"__type",Q3.__type),fe(this,ic,void 0),fe(this,Ks,void 0),fe(this,rc,void 0),fe(this,uu,void 0),ke(this,Ks,{}),ke(this,uu,t.mvfData),ke(this,ic,e),ke(this,rc,t.floorId)}static is(e){return e.__type===Q3.__type}get name(){var e,t;return(t=(e=M(this,uu).properties.details)==null?void 0:e.name)!=null?t:""}get description(){var e,t;return(t=(e=M(this,uu).properties.details)==null?void 0:e.description)!=null?t:""}get images(){var e,t;return(t=(e=M(this,uu).properties.details)==null?void 0:e.images)!=null?t:[]}get floor(){let e=M(this,ic).getById("floor",M(this,rc));if(e==null)throw new Error(`Floor ${M(this,rc)} not found!`);return e}get center(){if(M(this,Ks).center==null){let[[e,t],[r,n]]=M(this,uu).geometry.coordinates,a=(e+r)/2,o=(t+n)/2;M(this,Ks).center=new vr(o,a,M(this,rc))}return M(this,Ks).center}get isExterior(){var e;let t=M(this,ic).obstructionIdByEntranceId[this.id],r=M(this,ic).getMVFFeatureById("obstruction",t);return(e=r==null?void 0:r.properties.footprintComponent)!=null?e:!1}toJSON(){return{id:this.id,name:this.name,floor:this.floor.id,center:this.center.toJSON()}}destroy(){for(let e of Object.keys(M(this,Ks)))delete M(this,Ks)[e]}};ic=new WeakMap,Ks=new WeakMap,rc=new WeakMap,uu=new WeakMap,h(K3,"Door"),ie(K3,"__type","door");var ave=K3,Qx=ave;R();var df,nc,hu,ls,eS=class tS extends ql{constructor(e,t){super(t.mvfData.properties.id,t.mvfData.properties.details),ie(this,"__type",tS.__type),fe(this,df,void 0),fe(this,nc,void 0),fe(this,hu,{}),fe(this,ls,void 0),ke(this,df,e),ke(this,nc,t.floorId),ke(this,ls,t.mvfData)}static is(e){return e.__type===tS.__type}get name(){var e,t;let{properties:r}=M(this,ls);return(t=(e=r.details)==null?void 0:e.name)!=null?t:r.externalId}get type(){return DJ(M(this,ls).properties.kind)}get description(){var e,t;return(t=(e=M(this,ls).properties.details)==null?void 0:e.description)!=null?t:""}get images(){var e,t;return(t=(e=M(this,ls).properties.details)==null?void 0:e.images)!=null?t:[]}get floor(){let e=M(this,df).getById("floor",M(this,nc));if(e==null)throw new Error(`Floor ${M(this,nc)} not found!`);return e}get doors(){return M(this,ls).properties.destinationNodes.reduce((e,t)=>{let r=M(this,df).doorsByNodeId[t];return r&&e.push(r),e},[])}get center(){var e;if(M(this,hu).center==null){let[t,r]=(e=M(this,ls).properties.center)!=null?e:[0,0];M(this,hu).center=new vr(r,t,M(this,nc))}return M(this,hu).center}toJSON(){return{id:this.id,name:this.name,type:this.type,floor:this.floor.id,center:this.center.toJSON()}}destroy(){for(let e of Object.keys(M(this,hu)))delete M(this,hu)[e]}};df=new WeakMap,nc=new WeakMap,hu=new WeakMap,ls=new WeakMap,h(eS,"Space"),ie(eS,"__type","space");var ove=eS,sve=["room","hallway","exterior","void","connection.stairs","connection.elevator","poi"];function DJ(i){if(i==null||i==="default")return"room";let e=i.toLowerCase();return sve.includes(e)?e:"room"}h(DJ,"validateSpaceType");var ih=ove;R();var us,or,ff,iS=class rS extends ql{constructor(e,t){super(t.mvfData.id),ie(this,"__type",rS.__type),fe(this,us,void 0),fe(this,or,{}),fe(this,ff,void 0),ke(this,us,e),ke(this,ff,t.mvfData)}static is(e){return e.__type===rS.__type}get name(){return M(this,ff).externalId}get elevation(){return M(this,ff).elevation}get spaces(){if(M(this,or).spaces==null){let e=M(this,us).spaces.filter(t=>t.floor.id===this.id);M(this,or).spaces=e}return M(this,or).spaces}get objects(){if(M(this,or).objects==null){let e=M(this,us).objects.filter(t=>t.floor.id===this.id);M(this,or).objects=e}return M(this,or).objects}get connections(){if(M(this,or).connections==null){let e=M(this,us).connections.filter(t=>t.floors.includes(this));M(this,or).connections=e}return M(this,or).connections}get doors(){if(M(this,or).doors==null){let e=M(this,us).doors.filter(t=>t.floor.id===this.id);M(this,or).doors=e}return M(this,or).doors}get annotations(){if(M(this,or).annotations==null){let e=M(this,us).annotations.filter(t=>t.floor.id===this.id);M(this,or).annotations=e}return M(this,or).annotations}get pois(){if(M(this,or).pois==null){let e=M(this,us).pointsOfInterest.filter(t=>t.floor.id===this.id);M(this,or).pois=e}return M(this,or).pois}toJSON(){return{id:this.id,name:this.name,elevation:this.elevation,spaces:this.spaces.map(e=>e.id),objects:this.objects.map(e=>e.id),connections:this.connections.map(e=>e.id),doors:this.doors.map(e=>e.id),annotations:this.annotations.map(e=>e.id),pois:this.pois.map(e=>e.id)}}destroy(){for(let e of globalThis.Object.keys(M(this,or)))delete M(this,or)[e]}};us=new WeakMap,or=new WeakMap,ff=new WeakMap,h(iS,"Floor"),ie(iS,"__type","floor");var lve=iS,e_=lve;R();R();R();var kJ=h(i=>i!=null,"notNull");R();function RJ(i){return typeof i=="string"?i:i.id}h(RJ,"getId");R();function $u(i){let e;if(ih.is(i)||Qx.is(i)||rh.is(i))e=i.center;else if(i_.is(i)||XE.is(i))e=i.coordinate;else if(vr.is(i))e=i;else return;return e}h($u,"getCoordinateFromStuffs");R();R();var nS={auto:!0,debug:!1,pitch:45,bearing:0,antialiasing:{enabled:!0},shadingAndOutlines:!0,outdoorView:{layersHiddenByGeometry:["building","building-top"]}},Rv="ExteriorWalls",FJ="Walls",uve=0;function zJ(i){var e,t;if((e=i.outdoorView)!=null&&e.enabled&&!((t=i.outdoorView)!=null&&t.token)){let r=new Error("Missing outdoorView token");throw r.name="MissingOutdoorViewToken",r}}h(zJ,"validateOptions");function BJ(i,e){var t,r,n,a;let o=((t=i==null?void 0:i.outdoorView)==null?void 0:t.token)||e.outdoorViewToken,s={...nS,...i??{},outdoorView:{enabled:((r=i==null?void 0:i.outdoorView)==null?void 0:r.enabled)===void 0?!!o:(n=i==null?void 0:i.outdoorView)==null?void 0:n.enabled,layersHiddenByGeometry:(a=nS.outdoorView)==null?void 0:a.layersHiddenByGeometry,...i==null?void 0:i.outdoorView}};return o&&s.outdoorView&&(s.outdoorView.token=o),s}h(BJ,"handleDefault");var Ty,Qs,el,aS=class oS extends ql{constructor(e,t){let r=Object.values(t.mvfDataByFloorId)[0];super(r.properties.id,r.properties.details),ie(this,"__type",oS.__type),fe(this,Ty,void 0),fe(this,Qs,void 0),fe(this,el,void 0),ke(this,Qs,{}),ke(this,Ty,e),ke(this,el,t.mvfDataByFloorId)}static is(e){return e.__type===oS.__type}get name(){var e,t;return(t=(e=Object.values(M(this,el))[0].properties.details)==null?void 0:e.name)!=null?t:""}get description(){var e,t;return(t=(e=Object.values(M(this,el))[0].properties.details)==null?void 0:e.description)!=null?t:""}get images(){var e,t;return(t=(e=Object.values(M(this,el))[0].properties.details)==null?void 0:e.images)!=null?t:[]}get type(){var e,t;return(t=(e=Object.values(M(this,el))[0].properties.kind)==null?void 0:e.split(".")[1])!=null?t:"unknown"}get coordinates(){return M(this,Qs).coordinates==null&&(M(this,Qs).coordinates=Object.entries(M(this,el)).map(([e,t])=>new vr(t.geometry.coordinates[1],t.geometry.coordinates[0],e))),M(this,Qs).coordinates}get floors(){return this.coordinates.map(e=>e.floorId?M(this,Ty).getById("floor",e.floorId):void 0).filter(kJ)}toJSON(){return{id:this.id,name:this.name,type:this.type,coordinates:this.coordinates.map(e=>e.toJSON()),floors:this.floors.map(e=>e.id)}}destroy(){for(let e of Object.keys(M(this,Qs)))delete M(this,Qs)[e]}};Ty=new WeakMap,Qs=new WeakMap,el=new WeakMap,h(aS,"Connection"),ie(aS,"__type","connection");var hve=aS,t_=hve;R();var Py,ac,cu,tl,sS=class lS extends ql{constructor(e,t){super(t.mvfData.properties.id,t.mvfData.properties.details),ie(this,"__type",lS.__type),fe(this,Py,void 0),fe(this,ac,void 0),fe(this,cu,{}),fe(this,tl,void 0),ke(this,Py,e),ke(this,ac,t.floorId),ke(this,tl,t.mvfData)}static is(e){return e.__type===lS.__type}get name(){var e,t;return(t=(e=M(this,tl).properties.details)==null?void 0:e.name)!=null?t:""}get description(){var e,t;return(t=(e=M(this,tl).properties.details)==null?void 0:e.description)!=null?t:""}get images(){var e,t;return(t=(e=M(this,tl).properties.details)==null?void 0:e.images)!=null?t:[]}get type(){let e=M(this,tl).properties.kind;return e==null&&(e="object"),e==="Desks"&&(e="desk"),e.toLowerCase()}get floor(){let e=M(this,Py).getById("floor",M(this,ac));if(e==null)throw new Error(`Floor ${M(this,ac)} not found!`);return e}get center(){var e;if(M(this,cu).center==null){let[t,r]=(e=M(this,tl).properties.center)!=null?e:[0,0];M(this,cu).center=new vr(r,t,M(this,ac))}return M(this,cu).center}toJSON(){return{id:this.id,name:this.name,type:this.type,floor:this.floor.id,center:this.center.toJSON()}}destroy(){for(let e of globalThis.Object.keys(M(this,cu)))M(this,cu)[e]=null}};Py=new WeakMap,ac=new WeakMap,cu=new WeakMap,tl=new WeakMap,h(sS,"MapObject"),ie(sS,"__type","object");var cve=sS,rh=cve;R();R();var Ay,mf,uS=class OJ extends PJ{constructor(e){super(String(Cr())),fe(this,Ay,{}),fe(this,mf,void 0),ke(this,mf,e.mvfData)}static is(e){return e.__type===OJ.__type}get url(){return M(this,mf).url}get name(){return M(this,mf).altText}toJSON(){return{id:this.id,url:this.url,name:this.name}}destroy(){for(let e of globalThis.Object.keys(M(this,Ay)))delete M(this,Ay)[e]}};Ay=new WeakMap,mf=new WeakMap,h(uS,"Image"),ie(uS,"__type","image");var pve=uS,NJ=pve,Iy,oc,Co,pu,hS=class cS extends ql{constructor(e,t){super(t.mvfData.properties.id,t.mvfData.properties.details),ie(this,"__type",cS.__type),fe(this,Iy,void 0),fe(this,oc,void 0),fe(this,Co,{}),fe(this,pu,void 0),ke(this,Iy,e),ke(this,pu,t.mvfData),ke(this,oc,t.floorId)}static is(e){return e.__type===cS.__type}get name(){var e,t;return(t=(e=M(this,pu).properties.details)==null?void 0:e.name)!=null?t:""}get description(){var e,t;return(t=(e=M(this,pu).properties.details)==null?void 0:e.description)!=null?t:""}get images(){var e,t;if(M(this,Co).images==null){let r=(t=(e=M(this,pu).properties.details)==null?void 0:e.images)!=null?t:[];M(this,Co).images=r.map(n=>new NJ({mvfData:n}))}return M(this,Co).images}get floor(){let e=M(this,Iy).getById("floor",M(this,oc));if(e==null)throw new Error(`Floor ${M(this,oc)} not found!`);return e}get coordinate(){var e;if(M(this,Co).coordinate==null){let[t,r]=(e=M(this,pu).geometry.coordinates)!=null?e:[0,0];M(this,Co).coordinate=new vr(r,t,M(this,oc))}return M(this,Co).coordinate}toJSON(){return{id:this.id,name:this.name,floor:this.floor.id,coordinate:this.coordinate.toJSON()}}destroy(){for(let e in M(this,Co))M(this,Co)[e]=null}};Iy=new WeakMap,oc=new WeakMap,Co=new WeakMap,pu=new WeakMap,h(hS,"PointOfInterest"),ie(hS,"__type","point-of-interest");var dve=hS,i_=dve;R();var Ly,sc,du,qf,Dy,pS,dS=class fS extends ql{constructor(e,t){super(t.mvfData.properties.id),fe(this,Dy),ie(this,"__type",fS.__type),fe(this,Ly,void 0),fe(this,sc,void 0),fe(this,du,{}),fe(this,qf,void 0),ke(this,Ly,e),ke(this,sc,t.floorId),ke(this,qf,t.mvfData)}static is(e){return e.__type===fS.__type}get group(){return Ot(this,Dy,pS).call(this).group}get type(){return Ot(this,Dy,pS).call(this).type}get coordinate(){if(M(this,du).coordinate==null){let[e,t]=M(this,qf).geometry.coordinates;M(this,du).coordinate=new vr(t,e,M(this,sc))}return M(this,du).coordinate}get floor(){let e=M(this,Ly).getById("floor",M(this,sc));if(e==null)throw new Error(`Floor ${M(this,sc)} not found!`);return e}toJSON(){return{id:this.id,group:this.group,type:this.type,coordinate:this.coordinate.toJSON()}}destroy(){for(let e of Object.keys(M(this,du)))delete M(this,du)[e]}};Ly=new WeakMap,sc=new WeakMap,du=new WeakMap,qf=new WeakMap,Dy=new WeakSet,pS=h(function(){let[i,e]=M(this,qf).properties.symbolId.split("--");return{group:i,type:e}},"#getGroupAndTypeFromSymbolId"),h(dS,"Annotation"),ie(dS,"__type","annotation");var fve=dS,XE=fve;R();R();var gf,Eo,lc,yf,mS=class gS extends ql{constructor(e,t){super(t.mvfData.properties.id),ie(this,"__type",gS.__type),fe(this,gf,void 0),fe(this,Eo,{}),fe(this,lc,void 0),fe(this,yf,void 0),ke(this,gf,e),ke(this,lc,t.floorId),ke(this,yf,t.mvfData)}static is(e){return e.__type===gS.__type}get floor(){let e=M(this,gf).getById("floor",M(this,lc));if(e==null)throw new Error(`Floor ${M(this,lc)} not found!`);return e}get coordinate(){if(M(this,Eo).coordinate==null){let[e,t]=M(this,yf).geometry.coordinates;M(this,Eo).coordinate=new vr(t,e,M(this,lc))}return M(this,Eo).coordinate}get neighbors(){if(M(this,Eo).neighbours==null){let e=M(this,yf).properties.neighbors.map(t=>{let r=M(this,gf).getById("node",t.id);if(r==null)throw new Error(`Node ${t.id} not found!`);return r});M(this,Eo).neighbours=e}return M(this,Eo).neighbours}toJSON(){return{id:this.id,floor:this.floor.id,coordinate:this.coordinate.toJSON(),neighbors:this.neighbors.map(e=>e.id)}}destroy(){for(let e of Object.keys(M(this,Eo)))delete M(this,Eo)[e]}};gf=new WeakMap,Eo=new WeakMap,lc=new WeakMap,yf=new WeakMap,h(mS,"Node"),ie(mS,"__type","node");var mve=mS,gve=mve,yve=h((i,e)=>{var t,r;let n={},a={},o={},s={},l={},u={},c={},p={},d=globalThis.Object.keys(i.space);for(let m of d){let g=i.space[m];if(g!=null)for(let b of g.features){p[b.properties.id]=m,l[b.properties.id]=b;for(let x of b.properties.destinationNodes)o[x]==null&&(o[x]=[]),o[x].push(b.properties.id);if(b.properties.kind==="desk-entrance"&&(s[b.properties.externalId]==null&&(s[b.properties.externalId]=[]),s[b.properties.externalId].push(...b.properties.destinationNodes)),!["void","desk-entrance"].includes((t=b.properties.kind)!=null?t:"")){if((r=b.properties.kind)!=null&&r.includes("connection")){let x=`${b.geometry.coordinates[1]}-${b.geometry.coordinates[0]}`;u[x]==null&&(u[x]=[]),u[x].push(b.properties.id);continue}if(b.properties.kind==="poi"){let x=new i_(e,{floorId:m,mvfData:b});a[b.properties.id]=x}else{let x=new ih(e,{floorId:m,mvfData:b});n[b.properties.id]=x}}}}for(let m in u){let g=u[m],b={};for(let v of g){let w=p[v],_=l[v];b[w]=_}let x=new t_(e,{mvfDataByFloorId:b});c[x.id]=x}return{spacesById:n,poisById:a,connectionsById:c,spaceIdsByDestinationNodeId:o,objectEntranceNodeIdsByObstructionId:s,mvfSpacesById:l,connectionIdsByLatLon:u}},"processMVFSpaces"),vve=h((i,e)=>{let t={},r={};for(let n of i["node.geojson"].features){r[n.properties.id]=n;let a=new gve(e,{mvfData:n,floorId:n.properties.map});t[n.properties.id]=a}return{nodesById:t,mvfNodesById:r}},"processMVFNodes"),xve=h((i,e)=>{let t={},r={},n={},a=globalThis.Object.keys(i.obstruction);for(let o of a){let s=i.obstruction[o];if(s!=null)for(let l of s.features){r[l.properties.id]=l;for(let c of l.properties.entrances)n[c]=l.properties.id;if(l.properties.kind==="Wall")continue;let u=new rh(e,{floorId:o,mvfData:l});t[l.properties.id]=u}}return{objectsById:t,mvfObstructionById:r,obstructionIdByEntranceId:n}},"processMVFObstructions"),_ve=h((i,e)=>{let t={},r={};for(let n of i["map.geojson"]){r[n.id]=n;let a=new e_(e,{mvfData:n});t[n.id]=a}return{floorsById:t,mvfMapsById:r}},"processMVFMaps"),bve=h((i,e)=>{let t={},r=i["connection.json"].reduce((n,a)=>(a.nodes.forEach(o=>n[o]=a),t[a.id]=a,n),{});return{mvfConnectionsById:t,mvfConnectionsByNodeId:r}},"processMVFConnections"),wve=h((i,e)=>{let t={},r={},n={},a=globalThis.Object.keys(i.entrance);for(let o of a){let s=i.entrance[o];if(s!=null)for(let l of s.features){n[l.properties.id]=l;let u=new Qx(e,{floorId:o,mvfData:l});l.properties.node&&(r[l.properties.node]=u),t[l.properties.id]=u}}return{doorsById:t,doorsByNodeId:r,mvfEntrancesById:n}},"processMVFEntrances"),Sve=h((i,e)=>{let t={},r={};if(i.annotation==null)return{annotationsById:t,mvfAnnotationsById:r};let n=globalThis.Object.keys(i.annotation);for(let a of n){let o=i.annotation[a];if(o!=null)for(let s of o.features){r[s.properties.id]=s;let l=new XE(e,{floorId:a,mvfData:s});t[s.properties.id]=l}}return{annotationsById:t,mvfAnnotationsById:r}},"processMVFAnnotations"),Mve=h((i,e)=>{let{spacesById:t,spaceIdsByDestinationNodeId:r,poisById:n,mvfSpacesById:a,objectEntranceNodeIdsByObstructionId:o,connectionsById:s,connectionIdsByLatLon:l}=yve(i,e),{nodesById:u,mvfNodesById:c}=vve(i,e),{objectsById:p,mvfObstructionById:d,obstructionIdByEntranceId:m}=xve(i,e),{floorsById:g,mvfMapsById:b}=_ve(i,e),{mvfConnectionsById:x,mvfConnectionsByNodeId:v}=bve(i,e),{doorsById:w,doorsByNodeId:_,mvfEntrancesById:C}=wve(i,e),{annotationsById:E,mvfAnnotationsById:T}=Sve(i,e);return{spacesById:t,nodesById:u,objectsById:p,floorsById:g,connectionsById:s,doorsById:w,doorsByNodeId:_,poisById:n,annotationsById:E,spaceIdsByDestinationNodeId:r,objectEntranceNodeIdsByObstructionId:o,obstructionIdByEntranceId:m,connectionIdsByLatLon:l,mvfSpacesById:a,mvfNodesById:c,mvfObstructionById:d,mvfMapsById:b,mvfConnectionsById:x,mvfConnectionsByNodeId:v,mvfEntrancesById:C,mvfAnnotationsById:T}},"createDataFromMVF"),bi,uc,hc,cc,pc,dc,fc,mc,gc,ky,Ry,Fy,zy,By,Oy,Ny,$y,$J=class{constructor(e,t){fe(this,bi,{}),ie(this,"mvf"),ie(this,"outdoorViewToken"),ie(this,"spaceIdsByDestinationNodeId"),ie(this,"objectEntranceNodeIdsByObstructionId"),ie(this,"obstructionIdByEntranceId"),fe(this,uc,void 0),fe(this,hc,void 0),fe(this,cc,void 0),fe(this,pc,void 0),fe(this,dc,void 0),fe(this,fc,void 0),ie(this,"doorsByNodeId"),fe(this,mc,void 0),fe(this,gc,void 0),fe(this,ky,void 0),fe(this,Ry,void 0),fe(this,Fy,void 0),fe(this,zy,void 0),fe(this,By,void 0),fe(this,Oy,void 0),fe(this,Ny,void 0),fe(this,$y,void 0),this.mvf=e,this.outdoorViewToken=t;let r=Mve(e,this);ke(this,uc,r.nodesById),ke(this,hc,r.spacesById),ke(this,cc,r.floorsById),ke(this,pc,r.connectionsById),ke(this,dc,r.objectsById),ke(this,fc,r.doorsById),ke(this,mc,r.poisById),ke(this,gc,r.annotationsById),ke(this,ky,r.mvfAnnotationsById),ke(this,Ry,r.mvfConnectionsById),ke(this,Fy,r.mvfConnectionsByNodeId),ke(this,zy,r.mvfEntrancesById),ke(this,By,r.mvfNodesById),ke(this,Oy,r.mvfObstructionById),ke(this,Ny,r.mvfSpacesById),ke(this,$y,r.mvfMapsById),this.doorsByNodeId=r.doorsByNodeId,this.spaceIdsByDestinationNodeId=r.spaceIdsByDestinationNodeId,this.objectEntranceNodeIdsByObstructionId=r.objectEntranceNodeIdsByObstructionId,this.obstructionIdByEntranceId=r.obstructionIdByEntranceId}get mapName(){return this.mvf["manifest.geojson"].features[0].properties.name}get organizationId(){var e;return(e=this.mvf["manifest.geojson"].features[0].properties.org_id)!=null?e:""}get mapCenter(){return new vr(this.mvf["manifest.geojson"].features[0].geometry.coordinates[1],this.mvf["manifest.geojson"].features[0].geometry.coordinates[0])}get spaces(){return M(this,bi).spaces==null&&(M(this,bi).spaces=globalThis.Object.values(M(this,hc))),M(this,bi).spaces}get objects(){return M(this,bi).objects==null&&(M(this,bi).objects=globalThis.Object.values(M(this,dc))),M(this,bi).objects}get connections(){return M(this,bi).connections==null&&(M(this,bi).connections=globalThis.Object.values(M(this,pc))),M(this,bi).connections}get floors(){return M(this,bi).floors==null&&(M(this,bi).floors=globalThis.Object.values(M(this,cc))),M(this,bi).floors}get doors(){return M(this,bi).doors==null&&(M(this,bi).doors=globalThis.Object.values(M(this,fc))),M(this,bi).doors}get pointsOfInterest(){return M(this,bi).pointsOfInterest==null&&(M(this,bi).pointsOfInterest=globalThis.Object.values(M(this,mc))),M(this,bi).pointsOfInterest}get annotations(){return M(this,bi).annotations==null&&(M(this,bi).annotations=globalThis.Object.values(M(this,gc))),M(this,bi).annotations}get nodes(){return M(this,bi).nodes==null&&(M(this,bi).nodes=globalThis.Object.values(M(this,uc))),M(this,bi).nodes}getById(e,t){switch(e){case"space":return M(this,hc)[t];case"floor":return M(this,cc)[t];case"node":return M(this,uc)[t];case"door":return M(this,fc)[t];case"connection":return M(this,pc)[t];case"object":return M(this,dc)[t];case"point-of-interest":return M(this,mc)[t];case"annotation":return M(this,gc)[t];default:throw new Error(`Unknown type: ${e}`)}}getMapDataById(e){var t,r,n,a,o,s,l;return(l=(s=(o=(a=(n=(r=(t=M(this,hc)[e])!=null?t:M(this,cc)[e])!=null?r:M(this,uc)[e])!=null?n:M(this,fc)[e])!=null?a:M(this,pc)[e])!=null?o:M(this,dc)[e])!=null?s:M(this,mc)[e])!=null?l:M(this,gc)[e]}getMVFFeatureById(e,t){switch(e){case"space":return M(this,Ny)[t];case"node":return M(this,By)[t];case"obstruction":return M(this,Oy)[t];case"map":return M(this,$y)[t];case"connection":return M(this,Ry)[t];case"entrance":return M(this,zy)[t];case"annotation":return M(this,ky)[t];default:throw new Error(`Unknown MVF feature type: ${e}`)}}getMVFFeatureByNodeId(e,t){switch(e){case"connection":return M(this,Fy)[t];default:throw new Error(`Unsupported MVF feature type: ${e}`)}}destroy(){for(let e of globalThis.Object.keys(M(this,bi)))M(this,bi)[e]=null}};bi=new WeakMap,uc=new WeakMap,hc=new WeakMap,cc=new WeakMap,pc=new WeakMap,dc=new WeakMap,fc=new WeakMap,mc=new WeakMap,gc=new WeakMap,ky=new WeakMap,Ry=new WeakMap,Fy=new WeakMap,zy=new WeakMap,By=new WeakMap,Oy=new WeakMap,Ny=new WeakMap,$y=new WeakMap,h($J,"MapDataInternal");var qE=$J;R();R();R();R();var UJ=class{constructor(){Z(this,"_subscribers",{})}publish(e,t){!this._subscribers||!this._subscribers[e]||this._subscribers[e].forEach(function(r){typeof r=="function"&&r(t)})}on(e,t){this._subscribers||(this._subscribers={}),this._subscribers[e]=this._subscribers[e]||[],this._subscribers[e].push(t)}off(e,t){if(!this._subscribers||this._subscribers[e]==null)return;let r=this._subscribers[e].indexOf(t);r!==-1&&this._subscribers[e].splice(r,1)}destroy(){this._subscribers={}}};h(UJ,"PubSub");var Hr=UJ;R();var Q6="mi-session-data",eI="mi-local-data",Hc,To,Po,yS=class VJ{constructor(){fe(this,To,void 0),fe(this,Po,void 0);try{let e=sessionStorage.getItem(Q6);e?ke(this,To,JSON.parse(e)):ke(this,To,{id:Cr()})}catch{ke(this,To,{id:Cr()})}try{let e=localStorage.getItem(eI);e?ke(this,Po,JSON.parse(e)):ke(this,Po,{deviceId:Cr()})}catch{ke(this,Po,{deviceId:Cr()})}M(this,To).id||(M(this,To).id=Cr()),M(this,Po).deviceId||(M(this,Po).deviceId=Cr())}static getInstance(){return M(this,Hc)||ke(this,Hc,new VJ),M(this,Hc)}static ___clearInstance(){ke(this,Hc,void 0)}saveSessionData(e,t){M(this,To)[e]=t;try{return sessionStorage.setItem(Q6,JSON.stringify(M(this,To))),!0}catch{return!1}}loadSessionData(e){let t=M(this,To)[e];if(t!=null)return t}saveLocalData(e,t){M(this,Po)[e]=t;try{return localStorage.setItem(eI,JSON.stringify(M(this,Po))),!0}catch{return!1}}loadLocalData(e){let t=M(this,Po)[e];if(t!=null)return t}};Hc=new WeakMap,To=new WeakMap,Po=new WeakMap,h(yS,"SafeStorage"),fe(yS,Hc,void 0);var jJ=yS;R();R();R();R();var vS=class xS{constructor(e,t){Z(this,"id");Z(this,"text");Z(this,"__type",xS.__type);this.id=e,this.text=t}static is(e){return e.__type===xS.__type}};h(vS,"Label"),ie(vS,"__type","Label");var _S=vS;R();var bS=class wS{constructor(e,t){Z(this,"id");Z(this,"__type",wS.__type);Z(this,"contentEl");this.id=e,this.contentEl=t}static is(e){return e.__type===wS.__type}};h(bS,"Marker"),ie(bS,"__type","Marker");var HJ=bS;R();var SS=class MS{constructor(e,t){Z(this,"id");Z(this,"groupId");Z(this,"__type",MS.__type);this.id=e,this.groupId=t}static is(e){return e.__type===MS.__type}};h(SS,"Model"),ie(SS,"__type","Model");var Cve=SS;R();var GJ=class{constructor(e){Z(this,"id");Z(this,"__type");this.id=e,this.__type="Path"}};h(GJ,"Path");var Eve=GJ;R();var fu,WJ=class{constructor(e){fe(this,fu,void 0),ke(this,fu,e)}get center(){return M(this,fu).center}get bearing(){return M(this,fu).bearing}get pitch(){return M(this,fu).pitch}get zoomLevel(){return M(this,fu).zoomLevel}};fu=new WeakMap,h(WJ,"CameraTransform");var Tve=WJ;R();var CS=class ES{constructor(e){Z(this,"id");Z(this,"__type",ES.__type);this.id=e}static is(e){return e.__type===ES.__type}};h(CS,"Shape"),ie(CS,"__type","Shape");var Pve=CS;R();R();R();var Ave=new Map([["search-16x16",`<svg viewBox="0 0 16 16">
			<path
				fillRule="evenodd"
				clipRule="evenodd"
				d="M1 7C1 3.68629 3.68629 1 7 1C10.3137 1 13 3.68629 13 7C13 8.29583 12.5892 9.49572 11.8907 10.4765L15.4614 14.0472C15.6567 14.2425 15.6567 14.559 15.4614 14.7543L14.7543 15.4614C14.559 15.6567 14.2424 15.6567 14.0472 15.4614L10.4765 11.8907C9.49571 12.5892 8.29583 13 7 13C3.68629 13 1 10.3137 1 7ZM7 11C4.79086 11 3 9.20914 3 7C3 4.79086 4.79086 3 7 3C9.20914 3 11 4.79086 11 7C11 9.20914 9.20914 11 7 11Z"
				stroke="none"
			/>
		</svg>`],["close-16x16",`<svg viewBox="0 0 16 16">
			<path
				d="M12.5963 1.98959C12.7916 1.79433 13.1082 1.79433 13.3034 1.98959L14.0105 2.6967C14.2058 2.89196 14.2058 3.20855 14.0105 3.40381L3.40392 14.0104C3.20866 14.2057 2.89208 14.2057 2.69682 14.0104L1.98971 13.3033C1.79445 13.108 1.79445 12.7915 1.98971 12.5962L12.5963 1.98959Z"
				stroke="none"
			/>
			<path
				d="M1.98971 3.40381C1.79445 3.20855 1.79445 2.89196 1.98971 2.6967L2.69682 1.98959C2.89208 1.79433 3.20866 1.79433 3.40392 1.98959L14.0105 12.5962C14.2058 12.7915 14.2058 13.108 14.0105 13.3033L13.3034 14.0104C13.1082 14.2057 12.7916 14.2057 12.5963 14.0104L1.98971 3.40381Z"
				stroke="none"
			/>
		</svg>`],["empty-64x40",`<svg viewBox="0 0 64 40">
			<g>
				<g clipPath="url(#clip0_499_175492)">
					<path
						d="M32 39.7032C49.6731 39.7032 64 36.5925 64 32.7552C64 28.9179 49.6731 25.8071 32 25.8071C14.3269 25.8071 0 28.9179 0 32.7552C0 36.5925 14.3269 39.7032 32 39.7032Z"
						stroke="none"
						fill="#F5F5F5"
					/>
					<path
						d="M55 13.6653L44.854 2.24866C44.367 1.47048 43.656 1 42.907 1H21.093C20.344 1 19.633 1.47048 19.146 2.24767L9 13.6663V22.8367H55V13.6653Z"
						fill="none"
					/>
					<path
						d="M41.613 16.8128C41.613 15.2197 42.607 13.9046 43.84 13.9036H55V31.9059C55 34.0132 53.68 35.7402 52.05 35.7402H11.95C10.32 35.7402 9 34.0122 9 31.9059V13.9036H20.16C21.393 13.9036 22.387 15.2167 22.387 16.8098V16.8317C22.387 18.4248 23.392 19.7111 24.624 19.7111H39.376C40.608 19.7111 41.613 18.4128 41.613 16.8198V16.8128Z"
						fill="#FAFAFA"
					/>
				</g>
				<defs>
					<clipPath id="clip0_499_175492">
						<rect width="64" height="40" fill="white" />
					</clipPath>
				</defs>
			</g>
		</svg>`],["caret-12x12",`<svg viewBox="0 0 12 12">
			<path
				stroke="none"
				d="M8.38828 5.78337L3.92578 1.93493C3.75938 1.79196 3.51562 1.92087 3.51562 2.15173V9.84861C3.51562 10.0795 3.75938 10.2084 3.92578 10.0654L8.38828 6.21696C8.51602 6.10681 8.51602 5.89353 8.38828 5.78337Z"
			/>
		</svg>`],["plus-16x16",`<svg viewBox="0 0 16 16">
			<path
				d="M7.5 1C7.22386 1 7 1.22386 7 1.5V7H1.5C1.22386 7 1 7.22386 1 7.5L1 8.5C1 8.77614 1.22386 9 1.5 9H7V14.5C7 14.7761 7.22386 15 7.5 15H8.5C8.77614 15 9 14.7761 9 14.5V9H14.5C14.7761 9 15 8.77614 15 8.5V7.5C15 7.22386 14.7761 7 14.5 7H9V1.5C9 1.22386 8.77614 1 8.5 1H7.5Z"
				stroke="none"
			/>
		</svg>`],["recenter-16x16",`<svg viewBox="0 0 16 16">
			<g stroke="none">
				<path d="M0 2.5C0 2.22386 0.223858 2 0.5 2H1.5C1.77614 2 2 2.22386 2 2.5V13.5C2 13.7761 1.77614 14 1.5 14H0.5C0.223858 14 0 13.7761 0 13.5V2.5Z" />
				<path
					fillRule="evenodd"
					clipRule="evenodd"
					d="M4.5 4C4.22386 4 4 4.22386 4 4.5V11.5C4 11.7761 4.22386 12 4.5 12H11.5C11.7761 12 12 11.7761 12 11.5V4.5C12 4.22386 11.7761 4 11.5 4H4.5ZM6 6V10H10V6H6Z"
				/>
				<path d="M14.5 2C14.2239 2 14 2.22386 14 2.5V13.5C14 13.7761 14.2239 14 14.5 14H15.5C15.7761 14 16 13.7761 16 13.5V2.5C16 2.22386 15.7761 2 15.5 2H14.5Z" />
			</g>
		</svg>`],["minus-16x16",`<svg viewBox="0 0 16 16">
			<path
				d="M1.5 9C1.22386 9 1 8.77614 1 8.5L1 7.5C1 7.22386 1.22386 7 1.5 7L14.5 7C14.7761 7 15 7.22386 15 7.5V8.5C15 8.77614 14.7761 9 14.5 9L1.5 9Z"
				stroke="none"
			/>
		</svg>`],["logo-horizontal-206x48",`<svg viewBox="0 0 206 48">
			<path d="M27.2678 14.2261H22.3187C21.0695 14.2261 20.4695 14.7801 20.4695 15.9852V31.142L10.3966 15.5591C9.69665 14.4784 9.2475 14.2773 7.8475 14.2261H2.97462C1.67462 14.2261 1.07631 14.7801 1.07631 15.9852V44.7665C1.07631 45.9716 1.67462 46.5256 2.97462 46.5256H7.92377C9.22207 46.5256 9.82207 45.9716 9.82207 44.7665V29.6847L19.9441 45.1926C20.695 46.3244 21.095 46.5256 22.4933 46.5256H27.2933C28.5916 46.5256 29.1916 45.9716 29.1916 44.7665V15.9852C29.1407 14.7801 28.5424 14.2261 27.2678 14.2261Z" />
			<path d="M5.44915 10.9602C8.45863 10.9602 10.8983 8.50669 10.8983 5.48011C10.8983 2.45353 8.45863 0 5.44915 0C2.43967 0 0 2.45353 0 5.48011C0 8.50669 2.43967 10.9602 5.44915 10.9602Z" />
			<path d="M61.7899 25.0449C63.2306 23.1903 65.078 22.2051 67.556 22.2051C72.0526 22.2051 74.7611 25.3347 74.7611 29.4511V39.2489C74.8187 39.7125 74.5306 39.9443 74.0695 39.9443H72.5136C72.0526 39.9443 71.7645 39.7125 71.8221 39.2489V29.5091C71.8221 27.1909 69.9187 25.2187 67.4984 25.2187C65.1339 25.2187 63.2323 27.1329 63.2323 29.2773V39.2489C63.2899 39.7125 63.0018 39.9443 62.5407 39.9443H60.9831C60.5221 39.9443 60.2916 39.7125 60.2916 39.2489V29.4511C60.2916 27.1329 58.3899 25.2187 56.0255 25.2187C53.7204 25.2187 51.7594 27.075 51.7594 29.2773V39.3068C51.817 39.7705 51.5289 40.0023 51.0102 40.0023H49.5119C49.0509 40.0023 48.7628 39.7705 48.7628 39.3068V23.25C48.7051 22.7864 48.9933 22.4966 49.5119 22.4966H50.9526C51.356 22.4966 51.5289 22.6704 51.5289 23.0182V24.2352C52.7407 22.9602 54.239 22.2648 56.0255 22.2648C58.4475 22.2068 60.3492 23.192 61.7899 25.0466V25.0449ZM77.1255 31.2477C77.1255 26.3216 81.1018 22.2051 86.1187 22.2051C88.539 22.2051 90.6136 23.1903 92.3441 25.1608V23.1903C92.3441 22.7267 92.5746 22.5528 93.0357 22.5528H94.4187C94.8797 22.5528 95.1102 22.7847 95.1102 23.3062V39.3648C95.1102 39.8284 94.8797 40.0602 94.4187 40.0602H93.0357C92.5746 40.0602 92.3441 39.8284 92.3441 39.4227V37.4523C90.6712 39.3648 88.5967 40.35 86.1746 40.35C81.1018 40.2341 77.1238 36.1773 77.1238 31.2477H77.1255ZM92.1136 31.2477C92.1136 27.8284 89.4611 25.2187 86.0594 25.2187C82.7746 25.2187 80.1221 27.8864 80.1221 31.2477C80.1221 34.6687 82.7746 37.2784 86.1187 37.2784C86.9062 37.2789 87.6861 37.1232 88.4138 36.8202C89.1414 36.5173 89.8026 36.0731 90.3593 35.513C90.9161 34.9528 91.3577 34.2878 91.6587 33.556C91.9597 32.8241 92.1143 32.0397 92.1136 31.2477ZM100.992 37.3943V46.3807C101.049 46.8443 100.761 47.1341 100.298 47.1341H98.7424C98.2814 47.1341 97.9933 46.9023 97.9933 46.3807V23.1903C97.9933 22.7267 98.2238 22.4369 98.7424 22.4369H100.183C100.646 22.379 100.934 22.6687 100.934 23.0744V24.9869C102.605 23.0744 104.68 22.1472 107.044 22.1472C112.002 22.1472 116.037 26.2619 116.037 31.1898C116.037 36.1176 112.059 40.2341 107.044 40.2341C104.622 40.2341 102.603 39.3068 100.992 37.3943ZM106.987 25.2187C103.7 25.2187 101.049 27.8864 101.049 31.2477C101.049 34.6687 103.7 37.2784 107.044 37.2784C110.446 37.2784 113.039 34.6108 113.039 31.2477C113.039 27.8864 110.388 25.2187 106.987 25.2187ZM121.11 37.3943V46.3807C121.168 46.8443 120.88 47.1341 120.419 47.1341H118.861C118.4 47.1341 118.112 46.9023 118.112 46.3807V23.1903C118.112 22.7267 118.342 22.4369 118.861 22.4369H120.302C120.764 22.379 121.053 22.6687 121.053 23.0744V24.9869C122.724 23.0744 124.798 22.1472 127.163 22.1472C132.12 22.1472 136.156 26.2619 136.156 31.1898C136.156 36.1176 132.178 40.2341 127.163 40.2341C124.742 40.2341 122.781 39.3068 121.11 37.3943ZM127.105 25.2187C123.819 25.2187 121.168 27.8864 121.168 31.2477C121.168 34.6687 123.819 37.2784 127.163 37.2784C130.564 37.2784 133.158 34.6108 133.158 31.2477C133.158 27.8864 130.507 25.2187 127.107 25.2187H127.105ZM153.97 32.3506H141.054C141.342 35.2483 143.995 37.4523 147.164 37.4523C148.893 37.4523 150.393 37.0466 151.719 36.0597C152.007 35.8858 152.295 35.7699 152.353 35.7699C152.583 35.7699 152.756 35.8858 152.929 36.1773L153.505 37.1625C153.622 37.3364 153.68 37.4523 153.68 37.5682C153.68 37.8 153.507 38.0318 153.103 38.3216C151.258 39.5966 149.183 40.292 146.992 40.292C141.688 40.292 137.883 36.3511 137.883 31.2477C137.883 26.204 141.803 22.2051 146.703 22.2051C151.546 22.2051 154.717 25.7983 154.717 31.0176C154.717 31.5972 154.717 32.3506 153.968 32.3506H153.97ZM141.056 30.0324H151.72C151.432 26.8432 149.473 24.929 146.648 24.929C145.241 24.8904 143.875 25.3995 142.833 26.3501C141.791 27.3007 141.154 28.6194 141.056 30.0307V30.0324ZM156.332 31.2477C156.332 26.3216 160.31 22.2051 165.326 22.2051C167.748 22.2051 169.707 23.1324 171.32 25.0449V16.2324C171.263 15.7687 171.551 15.479 172.012 15.479H173.57C174.031 15.479 174.319 15.7108 174.319 16.2324V39.3068C174.319 39.7705 174.088 40.0023 173.57 40.0023H172.129C171.666 40.0602 171.378 39.7705 171.378 39.3648V37.3943C169.649 39.3068 167.632 40.292 165.268 40.292C160.31 40.2341 156.332 36.1773 156.332 31.2477ZM171.264 31.2477C171.264 27.8284 168.612 25.2187 165.21 25.2187C161.924 25.2187 159.273 27.8864 159.273 31.2477C159.273 34.6687 161.924 37.2784 165.268 37.2784C166.057 37.2838 166.839 37.1316 167.569 36.8304C168.299 36.5292 168.962 36.0852 169.52 35.5241C170.077 34.963 170.519 34.296 170.818 33.5619C171.117 32.8277 171.268 32.0411 171.263 31.2477H171.264ZM177.72 19.0739C177.715 18.8594 177.754 18.646 177.833 18.4468C177.912 18.2476 178.031 18.0667 178.182 17.915C178.333 17.7633 178.512 17.6439 178.71 17.5642C178.909 17.4845 179.121 17.446 179.334 17.4511C179.546 17.4507 179.756 17.4923 179.952 17.5737C180.148 17.6551 180.326 17.7746 180.476 17.9254C180.626 18.0762 180.745 18.2553 180.826 18.4523C180.907 18.6494 180.948 18.8606 180.948 19.0739C180.953 19.2884 180.914 19.5017 180.835 19.7009C180.756 19.9001 180.637 20.081 180.486 20.2327C180.335 20.3845 180.156 20.5038 179.957 20.5835C179.759 20.6633 179.547 20.7017 179.334 20.6966C178.412 20.7545 177.72 20.0591 177.72 19.0739ZM177.836 39.2489V23.1903C177.836 22.7267 178.066 22.4369 178.527 22.4369H180.083C180.544 22.4369 180.832 22.6687 180.775 23.1903V39.2489C180.832 39.7125 180.544 39.9443 180.083 39.9443H178.527C178.066 39.9443 177.836 39.7125 177.836 39.2489ZM186.944 23.0165V24.1756C188.212 22.8426 189.71 22.2051 191.497 22.2051C195.937 22.2051 198.646 25.2767 198.646 29.3932V39.2489C198.703 39.7125 198.415 39.9443 197.954 39.9443H196.398C195.936 39.9443 195.705 39.7125 195.705 39.2489V29.4511C195.705 27.1329 193.803 25.2187 191.439 25.2187C189.134 25.2187 187.175 27.075 187.175 29.2773V39.3068C187.232 39.7705 186.944 40.0023 186.424 40.0023H184.868C184.407 40.0023 184.119 39.7705 184.119 39.3068V23.1903C184.061 22.7267 184.349 22.4949 184.868 22.4949H186.309C186.712 22.4949 186.944 22.6687 186.944 23.0165Z" />
			<path d="M204 40C205.115 40 206 39.0857 206 38V37.9886C206 36.9029 205.126 36 204 36C202.885 36 202 36.9143 202 38V38.0114C202 39.0971 202.874 40 204 40ZM204 39.7829C202.989 39.7829 202.23 38.9829 202.23 38.0114V38C202.23 37.0286 203 36.2171 204 36.2171C205.011 36.2171 205.77 37.0171 205.77 37.9886V38C205.77 38.9714 205 39.7829 204 39.7829ZM203.218 38.9714H203.609V38.2743H204.034L204.517 38.9714H204.989L204.448 38.2057C204.724 38.1257 204.92 37.92 204.92 37.5886C204.92 37.1657 204.586 36.9486 204.138 36.9486H203.218V38.9714ZM203.609 37.9543V37.2914H204.103C204.368 37.2914 204.517 37.4057 204.517 37.6229C204.517 37.8171 204.368 37.9543 204.103 37.9543H203.609Z" />
		</svg>`],["share-16x16",`<svg viewBox="0 0 16 16">
			<path
				fillRule="evenodd"
				clipRule="evenodd"
				d="M13 6C14.6569 6 16 4.65685 16 3C16 1.34315 14.6569 0 13 0C11.3431 0 10 1.34315 10 3C10 3.13463 10.0089 3.26719 10.0261 3.39712L6.82972 5.17286C6.10576 4.44825 5.10523 4 4 4C1.79086 4 0 5.79086 0 8C0 10.2091 1.79086 12 4 12C5.10523 12 6.10576 11.5518 6.82972 10.8271L10.0261 12.6029C10.0089 12.7328 10 12.8654 10 13C10 14.6569 11.3431 16 13 16C14.6569 16 16 14.6569 16 13C16 11.3431 14.6569 10 13 10C12.2011 10 11.4752 10.3123 10.9376 10.8214L7.84579 9.1037C7.94622 8.75313 8 8.38284 8 8C8 7.61716 7.94622 7.24687 7.84579 6.8963L10.9376 5.17864C11.4752 5.68775 12.2011 6 13 6ZM13 4C13.5523 4 14 3.55228 14 3C14 2.44772 13.5523 2 13 2C12.4477 2 12 2.44772 12 3C12 3.55228 12.4477 4 13 4ZM4 10C5.10457 10 6 9.10457 6 8C6 6.89543 5.10457 6 4 6C2.89543 6 2 6.89543 2 8C2 9.10457 2.89543 10 4 10ZM14 13C14 13.5523 13.5523 14 13 14C12.4477 14 12 13.5523 12 13C12 12.4477 12.4477 12 13 12C13.5523 12 14 12.4477 14 13Z"
				stroke="none"
			/>
		</svg>`],["checkmark-16x16",`<svg viewBox="0 0 16 16">
			<path
				fillRule="evenodd"
				clipRule="evenodd"
				d="M15.387 3.31662C15.6008 3.49148 15.6323 3.80649 15.4574 4.02021L6.77402 14.6332C6.58509 14.8642 6.30292 14.9986 6.00457 15C5.70622 15.0013 5.42285 14.8694 5.23184 14.6402L0.551937 9.02429C0.375155 8.81215 0.403817 8.49687 0.615956 8.32009L1.38418 7.67991C1.59632 7.50312 1.9116 7.53179 2.08838 7.74392L5.99299 12.4295L13.9095 2.75374C14.0844 2.54002 14.3994 2.50852 14.6131 2.68338L15.387 3.31662Z"
				stroke="none"
			/>
		</svg>`],["arrow-right-16x16",`<svg viewBox="0 0 16 16">
			<path
				fillRule="evenodd"
				clipRule="evenodd"
				d="M8.35355 1.64645C8.54881 1.45118 8.8654 1.45118 9.06066 1.64645L14.7071 7.29289C15.0976 7.68342 15.0976 8.31658 14.7071 8.70711L9.06066 14.3536C8.8654 14.5488 8.54882 14.5488 8.35355 14.3536L7.64645 13.6464C7.45118 13.4512 7.45118 13.1346 7.64645 12.9393L11.5858 9H0.5C0.223858 9 0 8.77614 0 8.5V7.5C0 7.22386 0.223858 7 0.5 7H11.5858L7.64645 3.06066C7.45118 2.8654 7.45118 2.54882 7.64645 2.35355L8.35355 1.64645Z"
				stroke="none"
			/>
		</svg>`],["arrow-up-16x16",`<svg viewBox="0 0 16 16">
			<path
				fillRule="evenodd"
				clipRule="evenodd"
				d="M8.00015 0.5C8.34685 0.5 8.67835 0.642318 8.91714 0.893677L15.6517 7.98267C15.8441 8.18525 15.8359 8.50548 15.6333 8.69793L14.533 9.7433C14.3304 9.93575 14.0101 9.92754 13.8177 9.72496L9.26497 4.93262V15.4249C9.26497 15.7043 9.03846 15.9308 8.75904 15.9308H7.24125C6.96184 15.9308 6.73532 15.7043 6.73532 15.4249V4.93262L2.1826 9.72496C1.99015 9.92754 1.66992 9.93575 1.46734 9.7433L0.366945 8.69793C0.164367 8.50548 0.156156 8.18525 0.348604 7.98267L7.08315 0.893677C7.32194 0.642318 7.65344 0.5 8.00015 0.5Z"
				stroke="none"
			/>
		</svg>`],["connection-stairs-16x16",`<svg viewBox="0 0 16 16">
			<g stroke="none">
				<path d="M1 11.5C1 11.2239 1.22386 11 1.5 11H6V13.5C6 13.7761 5.77614 14 5.5 14H1.5C1.22386 14 1 13.7761 1 13.5V11.5Z" />
				<path d="M4 8.5C4 8.22386 4.22386 8 4.5 8H9V10.5C9 10.7761 8.77614 11 8.5 11H4V8.5Z" />
				<path d="M7 5.5C7 5.22386 7.22386 5 7.5 5H12V7.5C12 7.77614 11.7761 8 11.5 8H7V5.5Z" />
				<path d="M10 2.5C10 2.22386 10.2239 2 10.5 2H14.5C14.7761 2 15 2.22386 15 2.5V4.5C15 4.77614 14.7761 5 14.5 5H10V2.5Z" />
			</g>
		</svg>`],["connection-stairs-14x14",`<svg viewBox="0 0 14 14">
			<path
				d="M5.25 12H2.5C2.225 12 2 11.7429 2 11.4286C2 11.1143 2.225 10.8571 2.5 10.8571H4.25V7.91429H6.5V4.94286H8.75V2H11.5C11.775 2 12 2.25714 12 2.57143C12 2.88571 11.775 3.14286 11.5 3.14286H9.75V6.08571H7.5V9.02857H5.25V12Z"
				stroke="none"
			/>
		</svg>`],["connection-stairs-12x12",`<svg viewBox="0 0 12 12" stroke="none">
			<path d="M1.625 8.1875C1.625 8.01491 1.76491 7.875 1.9375 7.875H4.75V9.4375C4.75 9.61009 4.61009 9.75 4.4375 9.75H1.9375C1.76491 9.75 1.625 9.61009 1.625 9.4375V8.1875Z" />
			<path d="M3.5 6.3125C3.5 6.13991 3.63991 6 3.8125 6H6.625V7.5625C6.625 7.73509 6.48509 7.875 6.3125 7.875H3.5V6.3125Z" />
			<path d="M5.375 4.4375C5.375 4.26491 5.51491 4.125 5.6875 4.125H8.5V5.6875C8.5 5.86009 8.36009 6 8.1875 6H5.375V4.4375Z" />
			<path d="M7.25 2.5625C7.25 2.38991 7.38991 2.25 7.5625 2.25H10.0625C10.2351 2.25 10.375 2.38991 10.375 2.5625V3.8125C10.375 3.98509 10.2351 4.125 10.0625 4.125H7.25V2.5625Z" />
		</svg>`],["connection-escalator-16x16",`<svg viewBox="0 0 16 16">
			<g stroke="none">
				<path d="M3.63008 12H2C0.895431 12 0 12.8954 0 14C0 15.1046 0.89543 16 2 16H4.63008C4.86879 16 5.09962 15.9146 5.28087 15.7593L11.7191 10.2407C11.9004 10.0854 12.1312 10 12.3699 10H14C15.1046 10 16 9.10457 16 8C16 6.89543 15.1046 6 14 6H11.3699C11.1312 6 10.9004 6.08539 10.7191 6.24074L4.28087 11.7593C4.09962 11.9146 3.86879 12 3.63008 12Z" />
				<path d="M5 6C5 4.89543 5.89543 4 7 4C8.10457 4 9 4.89543 9 6L5 9.5V6Z" />
				<path d="M9 2C9 3.10457 8.10457 4 7 4C5.89543 4 5 3.10457 5 2C5 0.89543 5.89543 0 7 0C8.10457 0 9 0.89543 9 2Z" />
			</g>
		</svg>`],["connection-escalator-14x14",`<svg viewBox="0 0 14 14">
			<path
				d="M5.26686 2.98522C5.26686 2.44335 5.71573 2 6.26436 2C6.81299 2 7.26187 2.44335 7.26187 2.98522C7.26187 3.5271 6.81299 3.97045 6.26436 3.97045C5.71573 3.97045 5.26686 3.50246 5.26686 2.98522Z"
				stroke="none"
			/>
			<path
				d="M7.26188 5.48588V5.25125C7.26188 4.85716 6.91275 4.53696 6.48881 4.53696H6.03993C5.61599 4.53696 5.26687 4.88179 5.26687 5.25125V7.66458L4.3192 8.6995H3.67082C2.74813 8.6995 2 9.43842 2 10.3498C2 11.2611 2.74813 12 3.67082 12H4.61845C5.36658 12 6.11471 11.6798 6.61347 11.1133L9.6808 7.76354H10.3292C11.2519 7.76354 12 7.02463 12 6.11329C12 5.20196 11.2519 4.46305 10.3292 4.46305H9.38155C8.60848 4.46305 7.88529 4.78324 7.38653 5.34975L7.26188 5.48588ZM4.61846 11.0148H3.67083C3.29677 11.0148 2.99751 10.7192 2.99751 10.3498C2.99751 9.9803 3.29677 9.68473 3.67083 9.68473H4.61846C4.71821 9.68473 4.81796 9.63547 4.86784 9.56158L8.13467 5.99015C8.45886 5.64532 8.90774 5.44828 9.38155 5.44828H10.3292C10.7032 5.44828 11.0025 5.74384 11.0025 6.1133C11.0025 6.48276 10.7032 6.77833 10.3292 6.77833H9.38155C9.2818 6.77833 9.18205 6.82759 9.13218 6.87685L5.86534 10.4729C5.54115 10.8177 5.09228 11.0148 4.61846 11.0148Z"
				stroke="none"
			/>
		</svg>`],["connection-elevator-16x16",`<svg viewBox="0 0 16 16">
			<g stroke="none">
				<path d="M3 5.5C3 6.32843 2.32843 7 1.5 7C0.671573 7 0 6.32843 0 5.5C0 4.67157 0.671573 4 1.5 4C2.32843 4 3 4.67157 3 5.5Z" />
				<path d="M3 10.5C3 11.3284 2.32843 12 1.5 12C0.671573 12 0 11.3284 0 10.5C0 9.67157 0.671573 9 1.5 9C2.32843 9 3 9.67157 3 10.5Z" />
				<path d="M11 1H14C14.5523 1 15 1.44772 15 2V14C15 14.5523 14.5523 15 14 15H11V1Z" />
				<path d="M9 1H6C5.44772 1 5 1.44772 5 2V14C5 14.5523 5.44772 15 6 15H9V1Z" />
			</g>
		</svg>`],["connection-elevator-14x14",`<svg viewBox="0 0 14 14">
			<path
				d="M7.476 2H2.72693C1.77095 2 1 2.72464 1 3.62319V10.3768C1 11.2754 1.77095 12 2.72693 12H7.476C8.43198 12 9.20293 11.2754 9.20293 10.3768V3.62319C9.17209 2.72464 8.40114 2 7.476 2ZM7.476 3.15942C7.75354 3.15942 7.96941 3.36232 7.96941 3.62319V10.3768C7.96941 10.6377 7.75354 10.8406 7.476 10.8406H5.71824V3.15942H7.476ZM4.48472 3.15942V10.8406H2.72693C2.44939 10.8406 2.23352 10.6377 2.23352 10.3768V3.62319C2.23352 3.36232 2.44939 3.15942 2.72693 3.15942H4.48472Z"
				stroke="none"
			/>
			<path
				d="M12.4643 6.19064H10.6638C10.4456 6.19064 10.2546 6.06243 10.1728 5.88294C10.0909 5.70346 10.1455 5.47269 10.2819 5.31884L11.1821 4.47269C11.4004 4.26756 11.755 4.26756 11.946 4.47269L12.8462 5.31884C13.0099 5.47269 13.0371 5.67781 12.9553 5.88294C12.8735 6.08807 12.6825 6.19064 12.4643 6.19064Z"
				stroke="none"
			/>
			<path
				d="M11.564 9.65216C11.4276 9.65216 11.2912 9.60088 11.1821 9.49831L10.2819 8.65216C10.1182 8.49831 10.0909 8.29319 10.1728 8.08806C10.2546 7.90857 10.4456 7.78036 10.6638 7.78036H12.4643C12.6825 7.78036 12.8735 7.90857 12.9553 8.08806C13.0371 8.26754 12.9826 8.49831 12.8462 8.65216L11.9459 9.49831C11.8641 9.60088 11.7004 9.65216 11.564 9.65216Z"
				stroke="none"
			/>
		</svg>`],["connection-elevator-12x12",`<svg viewBox="0 0 12 12" stroke="none">
			<circle cx="1.9375" cy="4.4375" r="0.9375" />
			<circle cx="1.9375" cy="7.5625" r="0.9375" />
			<path
				fillRule="evenodd"
				clipRule="evenodd"
				d="M7.6 2H9.4C9.73137 2 10 2.26863 10 2.6V9.41328C10 9.74465 9.73137 10.0133 9.4 10.0133H7.6V2ZM6.4 2H4.6C4.26863 2 4 2.26863 4 2.6V9.41328C4 9.74465 4.26863 10.0133 4.6 10.0133H6.4V2Z"
			/>
		</svg>`],["new-tab-14x14",`<svg viewBox="0 0 14 14">
			<g stroke="none">
				<path d="M2.625 2.625H5.6875C5.92913 2.625 6.125 2.42912 6.125 2.1875V1.3125C6.125 1.07088 5.92913 0.875 5.6875 0.875H1.3125C1.07088 0.875 0.875 1.07088 0.875 1.3125V12.6875C0.875 12.9291 1.07088 13.125 1.3125 13.125H12.6875C12.9291 13.125 13.125 12.9291 13.125 12.6875V8.3125C13.125 8.07088 12.9291 7.875 12.6875 7.875H11.8125C11.5709 7.875 11.375 8.07088 11.375 8.3125V11.375H2.625V2.625Z" />
				<path d="M12.9063 0.875H8.40311C8.20822 0.875 8.11063 1.11062 8.24843 1.24843L9.88124 2.88124L5.8156 6.94688C5.64475 7.11774 5.64475 7.39475 5.8156 7.5656L6.43432 8.18432C6.60517 8.35517 6.88218 8.35517 7.05304 8.18432L11.1187 4.11868L12.7516 5.75157C12.8894 5.88938 13.125 5.79178 13.125 5.59689V1.09375C13.125 0.972938 13.0271 0.875 12.9063 0.875Z" />
			</g>
		</svg>`],["compress-16x16",`<svg viewBox="0 0 16 16">
			<g stroke="none">
				<path
					id="Vector"
					d="M4.67773 10.7154H0.713449C0.556306 10.7154 0.427734 10.844 0.427734 11.0011V11.8583C0.427734 12.0154 0.556306 12.144 0.713449 12.144H3.82059V15.2868C3.82059 15.444 3.94916 15.5725 4.10631 15.5725H4.96345C5.12059 15.5725 5.24916 15.444 5.24916 15.2868V11.2868C5.24916 10.9708 4.99381 10.7154 4.67773 10.7154ZM4.96345 0.429688H4.10631C3.94916 0.429688 3.82059 0.558259 3.82059 0.715402V3.85826H0.713449C0.556306 3.85826 0.427734 3.98683 0.427734 4.14397V5.00112C0.427734 5.15826 0.556306 5.28683 0.713449 5.28683H4.67773C4.99381 5.28683 5.24916 5.03147 5.24916 4.7154V0.715402C5.24916 0.558259 5.12059 0.429688 4.96345 0.429688ZM15.2849 10.7154H11.3206C11.0045 10.7154 10.7492 10.9708 10.7492 11.2868V15.2868C10.7492 15.444 10.8777 15.5725 11.0349 15.5725H11.892C12.0492 15.5725 12.1777 15.444 12.1777 15.2868V12.144H15.2849C15.442 12.144 15.5706 12.0154 15.5706 11.8583V11.0011C15.5706 10.844 15.442 10.7154 15.2849 10.7154ZM15.2849 3.85826H12.1777V0.715402C12.1777 0.558259 12.0492 0.429688 11.892 0.429688H11.0349C10.8777 0.429688 10.7492 0.558259 10.7492 0.715402V4.7154C10.7492 5.03147 11.0045 5.28683 11.3206 5.28683H15.2849C15.442 5.28683 15.5706 5.15826 15.5706 5.00112V4.14397C15.5706 3.98683 15.442 3.85826 15.2849 3.85826Z"
				/>
			</g>
		</svg>`],["washroom-14x14",`<svg viewBox="0 0 14 14" stroke="none">
			<path d="M4.55125 3.09062C4.55125 3.69326 4.07639 4.18176 3.49058 4.18176C2.90525 4.18176 2.43039 3.69326 2.43039 3.09062C2.43039 2.4885 2.90525 2 3.49058 2C4.07639 2 4.55125 2.4885 4.55125 3.09062Z" />
			<path d="M5.1193 5.48047C4.81653 4.83116 4.17252 4.41571 3.47822 4.41571C2.78392 4.41571 2.13986 4.83116 1.83714 5.48047L1.04175 7.22034C0.940664 7.441 1.02893 7.70073 1.24393 7.81791C1.47077 7.90871 1.72324 7.81791 1.82433 7.59725L2.49349 6.15554L2.21587 11.4407C2.20305 11.7263 2.41805 11.9734 2.69567 11.9993C2.97329 12.0124 3.21344 11.7913 3.23859 11.5057L3.4028 8.285H3.567L3.73121 11.5057C3.74403 11.7913 3.97086 11.9993 4.23616 11.9993H4.26131C4.53893 11.9861 4.75343 11.7395 4.74111 11.4407L4.46349 6.15554L5.13265 7.59725C5.20858 7.75298 5.35997 7.85697 5.52418 7.85697C5.5873 7.85697 5.65042 7.84379 5.71354 7.81792C5.92804 7.71393 6.0163 7.44153 5.91572 7.22035L5.1193 5.48047Z" />
			<path d="M12.9582 7.22034L12.1505 5.48047C11.8477 4.83116 11.2037 4.41571 10.5094 4.41571C9.81513 4.41571 9.17107 4.83116 8.86836 5.48047L8.06064 7.22034C7.95955 7.441 8.04782 7.70073 8.26282 7.81791C8.47732 7.9219 8.7298 7.8311 8.84371 7.60993L9.52519 6.12977L9.46207 7.2204L8.57842 8.92184C8.47733 9.11663 8.61638 9.36316 8.83089 9.36316H9.33584L9.22242 11.4668C9.2096 11.7397 9.41177 11.9862 9.68939 11.9994C9.95469 12.0126 10.1943 11.8046 10.2072 11.519L10.3581 9.33723H10.6737L10.7871 11.5058C10.7999 11.7787 11.0144 11.9862 11.2792 11.9862H11.3043C11.5696 11.973 11.7841 11.7396 11.7713 11.4535L11.6579 9.33718H12.1628C12.3773 9.33718 12.5287 9.09066 12.4153 8.89586L11.5317 7.19442L11.4685 6.1038L12.1757 7.5972C12.2516 7.75293 12.403 7.85692 12.5672 7.85692C12.6303 7.85692 12.6934 7.84373 12.7566 7.81786C12.9711 7.70068 13.0593 7.44102 12.9582 7.22034Z" />
			<path d="M11.5696 3.09062C11.5696 3.69326 11.0948 4.18176 10.5094 4.18176C9.92363 4.18176 9.44876 3.69326 9.44876 3.09062C9.44876 2.4885 9.92363 2 10.5094 2C11.0948 2 11.5696 2.4885 11.5696 3.09062Z" />
			<path d="M6.99996 2.00006C6.76031 2.00006 6.57095 2.19485 6.57095 2.44138V11.5575C6.57095 11.804 6.76031 11.9988 6.99996 11.9988C7.2396 11.9988 7.42896 11.804 7.42896 11.5575V2.44138C7.42896 2.19485 7.2396 2.00006 6.99996 2.00006Z" />
		</svg>`],["point-of-interest-12x12",`<svg viewBox="0 0 12 12" stroke="none">
			<path
				stroke="none"
				id="Subtract"
				// Do not change these to fillRule or clipRule, since they need to be rendered as actual SVGs in labels, not React SVGs
				fill-rule="evenodd"
				clip-rule="evenodd"
				d="M6.24724 10.7516C7.94597 9.0358 9.85962 6.89195 9.85962 4.85965C9.85962 2.72802 8.13159 1 5.99997 1C3.86834 1 2.14032 2.72802 2.14032 4.85965C2.14032 6.89195 4.05397 9.0358 5.7527 10.7516C5.88904 10.8893 6.1109 10.8893 6.24724 10.7516ZM5.99994 6.26317C6.77508 6.26317 7.40345 5.6348 7.40345 4.85967C7.40345 4.08453 6.77508 3.45616 5.99994 3.45616C5.22481 3.45616 4.59644 4.08453 4.59644 4.85967C4.59644 5.6348 5.22481 6.26317 5.99994 6.26317Z"
			/>
		</svg>`],["flag-20x20",`<svg viewBox="0 0 20 20" stroke="none">
			<path
				d="M16.9987 4.27111C16.936 5.06715 16.3836 5.93162 15.5238 6.57845C14.7549 7.15682 13.0885 8.04927 10.5434 7.55174C8.32167 7.1164 6.82156 8.02129 6.08085 10.2416L8.24615 17.3998C8.31833 17.6471 8.17711 17.9059 7.9292 17.9813C7.88527 17.9938 7.83976 18 7.79426 18C7.58634 18 7.40277 17.8647 7.34236 17.6673L5.1644 10.4686C5.13773 10.4173 5.12125 10.3613 5.11419 10.3038L3.41956 4.70042C3.38112 4.63512 3.35994 4.56127 3.3568 4.48587L3.02101 3.37886C2.98413 3.25992 2.9959 3.13165 3.05553 3.02203C3.11437 2.91242 3.21479 2.83079 3.33482 2.79504C3.45564 2.75928 3.5851 2.7725 3.69494 2.83235C3.80477 2.89144 3.88637 2.99172 3.92167 3.11143L3.9813 3.31355C4.38847 2.85956 4.90472 2.51439 5.48136 2.30915C6.97201 1.75566 8.95216 1.95467 10.6469 2.83156C11.6888 3.36951 14.3374 4.54493 16.3647 3.79553C16.5154 3.74111 16.684 3.76599 16.8127 3.86239C16.9406 3.95879 17.0105 4.11251 16.9987 4.27111Z"
				stroke="none"
			/>
		</svg>`],["link-16x16",`<svg viewBox="0 0 16 16" stroke="none">
			<path
				d="M9.10678 11.2433C9.07993 11.2167 9.04367 11.2018 9.00589 11.2018C8.9681 11.2018 8.93184 11.2167 8.90499 11.2433L6.82999 13.3183C5.86928 14.279 4.24785 14.3808 3.18714 13.3183C2.12464 12.2558 2.22642 10.6362 3.18714 9.67546L5.26214 7.60046C5.31749 7.5451 5.31749 7.45403 5.26214 7.39868L4.55142 6.68796C4.52457 6.66138 4.48832 6.64646 4.45053 6.64646C4.41274 6.64646 4.37649 6.66138 4.34964 6.68796L2.27464 8.76296C0.763923 10.2737 0.763923 12.7183 2.27464 14.2272C3.78535 15.7362 6.22999 15.738 7.73892 14.2272L9.81392 12.1522C9.86928 12.0969 9.86928 12.0058 9.81392 11.9505L9.10678 11.2433ZM13.7246 2.77903C12.2139 1.26832 9.76928 1.26832 8.26035 2.77903L6.18357 4.85403C6.15698 4.88088 6.14207 4.91714 6.14207 4.95493C6.14207 4.99271 6.15698 5.02897 6.18357 5.05582L6.89249 5.76475C6.94785 5.8201 7.03892 5.8201 7.09428 5.76475L9.16928 3.68975C10.13 2.72903 11.7514 2.62725 12.8121 3.68975C13.8746 4.75225 13.7729 6.37189 12.8121 7.3326L10.7371 9.4076C10.7106 9.43445 10.6956 9.47071 10.6956 9.5085C10.6956 9.54628 10.7106 9.58254 10.7371 9.60939L11.4479 10.3201C11.5032 10.3755 11.5943 10.3755 11.6496 10.3201L13.7246 8.2451C15.2336 6.73439 15.2336 4.28975 13.7246 2.77903ZM9.75142 6.00939C9.72457 5.9828 9.68832 5.96789 9.65053 5.96789C9.61275 5.96789 9.57649 5.9828 9.54964 6.00939L5.50499 10.0522C5.47841 10.0791 5.46349 10.1154 5.46349 10.1531C5.46349 10.1909 5.47841 10.2272 5.50499 10.254L6.21214 10.9612C6.26749 11.0165 6.35857 11.0165 6.41392 10.9612L10.4568 6.91832C10.5121 6.86296 10.5121 6.77189 10.4568 6.71653L9.75142 6.00939Z"
				stroke="none"
			/>
		</svg>`]]),Ive=/<svg([^>]*)>/g;function XJ(i,e,t){let r=Ave.get(i);return r?r.replace(Ive,`<svg$1 style="fill:${e}; width:${t}px; height:${t}px">`):""}h(XJ,"getStyledIcon");var Lve=h(i=>`
		<div class="pin-shadow" style="background: ${i}"></div>
		<svg width="${20*.9}px" height="${48*.9}px" viewBox="0 0 20 48">
			<path
				d="M1.37965 29.3246C1.5778 31.2167 2.27661 33.0694 3.83078 33.775C4.0998 37.1861 4.7451 40.2227 5.65918 42.4784C6.14556 43.6787 6.72883 44.71 7.41453 45.4578C8.10027 46.2056 8.97065 46.7527 9.99989 46.7527C11.0292 46.7527 11.8995 46.2055 12.585 45.4576C13.2706 44.7098 13.8536 43.6785 14.3398 42.4783C15.2536 40.2226 15.8988 37.186 16.1688 33.7752C17.7232 33.0697 18.422 31.2169 18.6201 29.3247C18.8386 27.2385 18.5165 24.6502 17.6475 22.0285L17.6473 22.0278C16.9657 19.9761 16.0319 18.1622 14.9848 16.7474C17.0884 15.1587 18.4471 12.5964 18.4471 9.7152C18.4471 4.93539 14.6967 1 9.99966 1C5.30272 1 1.54993 4.93527 1.54993 9.7152C1.54993 12.5961 2.90839 15.1583 5.01167 16.747C3.9635 18.1625 3.03185 19.977 2.3522 22.0286C1.48319 24.6503 1.16118 27.2385 1.37965 29.3246Z"
				fill={color}
				stroke="white"
				strokeWidth="2"
			/>
		</svg>
	`,"getDeparturePin"),Dve=h(i=>`
		<div class="pin-shadow" style="background: ${i}"></div>
		<svg width="36" height="42" viewBox="-2 -2 40 46">
			<path
				d="M35.8372 5.86776C35.6765 7.92448 34.2625 10.158 32.0612 11.8292C30.0929 13.3235 25.8269 15.6292 19.3114 14.3438C13.6237 13.219 9.78333 15.5569 7.88708 21.2934L13.4303 39.7879C13.6151 40.4267 13.2536 41.0955 12.6189 41.2903C12.5064 41.3225 12.39 41.3385 12.2735 41.3385C11.7412 41.3385 11.2712 40.989 11.1166 40.4789L5.54093 21.88C5.47265 21.7474 5.43047 21.6028 5.41239 21.4542L1.07409 6.97696C0.975678 6.80825 0.921449 6.61744 0.913417 6.42263L0.053779 3.56251C-0.0406172 3.2552 -0.0104927 2.92379 0.142154 2.64058C0.29279 2.35738 0.549874 2.14649 0.857157 2.05411C1.16646 1.96172 1.49786 1.99587 1.77906 2.15052C2.06025 2.30317 2.26912 2.56226 2.35951 2.87155L2.51215 3.39375C3.55453 2.22081 4.87615 1.32902 6.35237 0.798742C10.1685 -0.631292 15.2377 -0.117113 19.5763 2.14846C22.2435 3.53834 29.0241 6.57524 34.2141 4.63904C34.5998 4.49845 35.0316 4.56272 35.361 4.81178C35.6884 5.06083 35.8673 5.45801 35.8372 5.86776Z"
				fill="none"
				stroke="white"
				strokeWidth="4"
			/>
			<path
				d="M35.8372 5.86776C35.6765 7.92448 34.2625 10.158 32.0612 11.8292C30.0929 13.3235 25.8269 15.6292 19.3114 14.3438C13.6237 13.219 9.78333 15.5569 7.88708 21.2934L13.4303 39.7879C13.6151 40.4267 13.2536 41.0955 12.6189 41.2903C12.5064 41.3225 12.39 41.3385 12.2735 41.3385C11.7412 41.3385 11.2712 40.989 11.1166 40.4789L5.54093 21.88C5.47265 21.7474 5.43047 21.6028 5.41239 21.4542L1.07409 6.97696C0.975678 6.80825 0.921449 6.61744 0.913417 6.42263L0.053779 3.56251C-0.0406172 3.2552 -0.0104927 2.92379 0.142154 2.64058C0.29279 2.35738 0.549874 2.14649 0.857157 2.05411C1.16646 1.96172 1.49786 1.99587 1.77906 2.15052C2.06025 2.30317 2.26912 2.56226 2.35951 2.87155L2.51215 3.39375C3.55453 2.22081 4.87615 1.32902 6.35237 0.798742C10.1685 -0.631292 15.2377 -0.117113 19.5763 2.14846C22.2435 3.53834 29.0241 6.57524 34.2141 4.63904C34.5998 4.49845 35.0316 4.56272 35.361 4.81178C35.6884 5.06083 35.8673 5.45801 35.8372 5.86776Z"
				fill={color}
			/>
		</svg>
    `,"getDestinationPin"),qJ="#722ED1",ZJ="#1890FF",tI=h(({type:i="departure",destinationColor:e=qJ,departureColor:t=ZJ})=>`<div class="dropped-pin-wrapper">
			${i==="departure"?Lve(t):Dve(e)}
		</div>`,"DroppedPin"),kve=h(i=>{switch(i){case"default":return 28;case"selection":return 28;case"navigation":return 32}},"getSize"),Rve=h(({type:i="stairs",color:e="#722ED1",direction:t="up"})=>{let r=kve("default"),n=r/2+2,a=t&&t!=="none";return`<div class="mappedin-connection-marker">
			<div class="connection-circle"
				role="button"
                style="background:${e}; width:${r}px; height:${r}px;"
			>
                ${XJ("connection-"+i+"-16x16","white",n)||""}
			</div>
			${a?`<div style="margin-left: -${r*.2}px;">
					<div class="bouncey">
						<div class="connection-circle"
							role="button"
							style="width: ${r}px; height: ${r}px;">
							<div class="${t==="up"?"":"arrow--down"}">
                                <svg viewBox="0 0 16 16" style="fill: white; width: ${n}px; height: ${n}px">
                                    <path
                                        fillRule="evenodd"
                                        clipRule="evenodd"
                                        d="M8.00015 0.5C8.34685 0.5 8.67835 0.642318 8.91714 0.893677L15.6517 7.98267C15.8441 8.18525 15.8359 8.50548 15.6333 8.69793L14.533 9.7433C14.3304 9.93575 14.0101 9.92754 13.8177 9.72496L9.26497 4.93262V15.4249C9.26497 15.7043 9.03846 15.9308 8.75904 15.9308H7.24125C6.96184 15.9308 6.73532 15.7043 6.73532 15.4249V4.93262L2.1826 9.72496C1.99015 9.92754 1.66992 9.93575 1.46734 9.7433L0.366945 8.69793C0.164367 8.50548 0.156156 8.18525 0.348604 7.98267L7.08315 0.893677C7.32194 0.642318 7.65344 0.5 8.00015 0.5Z"
                                        stroke="none"
                                    />
                                </svg>
							</div>
						</div>
					</div>
				</div>`:""}
		</div>`},"ConnectionMarker");R();var Fve=h(async i=>new Promise(e=>setTimeout(e,i)),"ms"),T1={createMarkers:{departure:!0,destination:!0,connection:!0},pathOptions:{color:"#40A9FF",nearRadius:.25,farRadius:.25*4,displayArrowsOnPath:!1},polygons:{departure:"#40A9FF"}},il,rl,yc,xn,mu,TS,YJ,Uy,JJ=class{constructor(e){fe(this,TS),fe(this,il,void 0),fe(this,rl,new Map),fe(this,yc,void 0),fe(this,xn,void 0),fe(this,mu,T1),ie(this,"draw",async(t,r={})=>{var n,a,o;if(t.coordinates.length<2){Ft.warn("Directions must have at least 2 coordinates");return}M(this,il)&&this.clear();let s={pathOptions:{...T1.pathOptions,...r.pathOptions},createMarkers:{...T1.createMarkers,...r.createMarkers},polygons:{...T1.polygons,...r.polygons}};ke(this,mu,s),ke(this,il,t);let l=t.coordinates[0],u=t.coordinates[t.coordinates.length-1],c=M(this,xn).getMapData()[Object.keys(M(this,xn).getMapData())[0]];if(l.floorId&&M(this,xn).setFloor(c.getById("floor",l.floorId)),(n=M(this,mu).createMarkers)!=null&&n.departure){let p=M(this,xn).Markers.add(l,tI({type:"departure"}),{anchor:"top",rank:"always-visible"});M(this,rl).set(p,void 0)}if(await Fve(500),!!M(this,il)&&(ke(this,yc,await M(this,xn).Paths.add(t.coordinates,M(this,mu).pathOptions)),!!M(this,il))){if((a=M(this,mu).createMarkers)!=null&&a.destination){let p=M(this,xn).Markers.add(u,tI({type:"destination"}),{anchor:"top",rank:"always-visible"});M(this,rl).set(p,void 0)}(o=M(this,mu).createMarkers)!=null&&o.connection&&(t.instructions.filter(p=>Ot(this,TS,YJ).call(this,p.action)).forEach(p=>{let d=M(this,xn).Markers.add(p.coordinate,Rve({type:p.action.connectionType,color:p.action.type==="ExitConnection"?ZJ:qJ,direction:p.action.direction}),{interactive:!0,anchor:"top",rank:"always-visible"});M(this,rl).set(d,p)}),M(this,xn).on("click",M(this,Uy)))}}),fe(this,Uy,h(t=>{if(t.markers.length>0){let r=M(this,rl).get(t.markers[0]);r!=null&&r.action.toFloor&&M(this,xn).setFloor(r.action.toFloor)}},"#handleClick")),ie(this,"clear",()=>{M(this,il)&&(M(this,rl).forEach((t,r)=>{M(this,xn).Markers.remove(r)}),M(this,rl).clear(),M(this,yc)&&(M(this,xn).Paths.remove(M(this,yc)),ke(this,yc,void 0)),M(this,xn).off("click",M(this,Uy)),ke(this,il,void 0))}),ke(this,xn,e)}};il=new WeakMap,rl=new WeakMap,yc=new WeakMap,xn=new WeakMap,mu=new WeakMap,TS=new WeakSet,YJ=h(function(i){return i!=null&&["TakeConnection","ExitConnection"].includes(i.type)},"#isVortexAction"),Uy=new WeakMap,h(JJ,"Navigation");var zve=JJ;R();R();R();var Bve=new Map([["search-16x16",`<svg viewBox="0 0 16 16">
			<path
				fillRule="evenodd"
				clipRule="evenodd"
				d="M1 7C1 3.68629 3.68629 1 7 1C10.3137 1 13 3.68629 13 7C13 8.29583 12.5892 9.49572 11.8907 10.4765L15.4614 14.0472C15.6567 14.2425 15.6567 14.559 15.4614 14.7543L14.7543 15.4614C14.559 15.6567 14.2424 15.6567 14.0472 15.4614L10.4765 11.8907C9.49571 12.5892 8.29583 13 7 13C3.68629 13 1 10.3137 1 7ZM7 11C4.79086 11 3 9.20914 3 7C3 4.79086 4.79086 3 7 3C9.20914 3 11 4.79086 11 7C11 9.20914 9.20914 11 7 11Z"
				stroke="none"
			/>
		</svg>`],["close-16x16",`<svg viewBox="0 0 16 16">
			<path
				d="M12.5963 1.98959C12.7916 1.79433 13.1082 1.79433 13.3034 1.98959L14.0105 2.6967C14.2058 2.89196 14.2058 3.20855 14.0105 3.40381L3.40392 14.0104C3.20866 14.2057 2.89208 14.2057 2.69682 14.0104L1.98971 13.3033C1.79445 13.108 1.79445 12.7915 1.98971 12.5962L12.5963 1.98959Z"
				stroke="none"
			/>
			<path
				d="M1.98971 3.40381C1.79445 3.20855 1.79445 2.89196 1.98971 2.6967L2.69682 1.98959C2.89208 1.79433 3.20866 1.79433 3.40392 1.98959L14.0105 12.5962C14.2058 12.7915 14.2058 13.108 14.0105 13.3033L13.3034 14.0104C13.1082 14.2057 12.7916 14.2057 12.5963 14.0104L1.98971 3.40381Z"
				stroke="none"
			/>
		</svg>`],["empty-64x40",`<svg viewBox="0 0 64 40">
			<g>
				<g clipPath="url(#clip0_499_175492)">
					<path
						d="M32 39.7032C49.6731 39.7032 64 36.5925 64 32.7552C64 28.9179 49.6731 25.8071 32 25.8071C14.3269 25.8071 0 28.9179 0 32.7552C0 36.5925 14.3269 39.7032 32 39.7032Z"
						stroke="none"
						fill="#F5F5F5"
					/>
					<path
						d="M55 13.6653L44.854 2.24866C44.367 1.47048 43.656 1 42.907 1H21.093C20.344 1 19.633 1.47048 19.146 2.24767L9 13.6663V22.8367H55V13.6653Z"
						fill="none"
					/>
					<path
						d="M41.613 16.8128C41.613 15.2197 42.607 13.9046 43.84 13.9036H55V31.9059C55 34.0132 53.68 35.7402 52.05 35.7402H11.95C10.32 35.7402 9 34.0122 9 31.9059V13.9036H20.16C21.393 13.9036 22.387 15.2167 22.387 16.8098V16.8317C22.387 18.4248 23.392 19.7111 24.624 19.7111H39.376C40.608 19.7111 41.613 18.4128 41.613 16.8198V16.8128Z"
						fill="#FAFAFA"
					/>
				</g>
				<defs>
					<clipPath id="clip0_499_175492">
						<rect width="64" height="40" fill="white" />
					</clipPath>
				</defs>
			</g>
		</svg>`],["caret-12x12",`<svg viewBox="0 0 12 12">
			<path
				stroke="none"
				d="M8.38828 5.78337L3.92578 1.93493C3.75938 1.79196 3.51562 1.92087 3.51562 2.15173V9.84861C3.51562 10.0795 3.75938 10.2084 3.92578 10.0654L8.38828 6.21696C8.51602 6.10681 8.51602 5.89353 8.38828 5.78337Z"
			/>
		</svg>`],["plus-16x16",`<svg viewBox="0 0 16 16">
			<path
				d="M7.5 1C7.22386 1 7 1.22386 7 1.5V7H1.5C1.22386 7 1 7.22386 1 7.5L1 8.5C1 8.77614 1.22386 9 1.5 9H7V14.5C7 14.7761 7.22386 15 7.5 15H8.5C8.77614 15 9 14.7761 9 14.5V9H14.5C14.7761 9 15 8.77614 15 8.5V7.5C15 7.22386 14.7761 7 14.5 7H9V1.5C9 1.22386 8.77614 1 8.5 1H7.5Z"
				stroke="none"
			/>
		</svg>`],["recenter-16x16",`<svg viewBox="0 0 16 16">
			<g stroke="none">
				<path d="M0 2.5C0 2.22386 0.223858 2 0.5 2H1.5C1.77614 2 2 2.22386 2 2.5V13.5C2 13.7761 1.77614 14 1.5 14H0.5C0.223858 14 0 13.7761 0 13.5V2.5Z" />
				<path
					fillRule="evenodd"
					clipRule="evenodd"
					d="M4.5 4C4.22386 4 4 4.22386 4 4.5V11.5C4 11.7761 4.22386 12 4.5 12H11.5C11.7761 12 12 11.7761 12 11.5V4.5C12 4.22386 11.7761 4 11.5 4H4.5ZM6 6V10H10V6H6Z"
				/>
				<path d="M14.5 2C14.2239 2 14 2.22386 14 2.5V13.5C14 13.7761 14.2239 14 14.5 14H15.5C15.7761 14 16 13.7761 16 13.5V2.5C16 2.22386 15.7761 2 15.5 2H14.5Z" />
			</g>
		</svg>`],["minus-16x16",`<svg viewBox="0 0 16 16">
			<path
				d="M1.5 9C1.22386 9 1 8.77614 1 8.5L1 7.5C1 7.22386 1.22386 7 1.5 7L14.5 7C14.7761 7 15 7.22386 15 7.5V8.5C15 8.77614 14.7761 9 14.5 9L1.5 9Z"
				stroke="none"
			/>
		</svg>`],["logo-horizontal-206x48",`<svg viewBox="0 0 206 48">
			<path d="M27.2678 14.2261H22.3187C21.0695 14.2261 20.4695 14.7801 20.4695 15.9852V31.142L10.3966 15.5591C9.69665 14.4784 9.2475 14.2773 7.8475 14.2261H2.97462C1.67462 14.2261 1.07631 14.7801 1.07631 15.9852V44.7665C1.07631 45.9716 1.67462 46.5256 2.97462 46.5256H7.92377C9.22207 46.5256 9.82207 45.9716 9.82207 44.7665V29.6847L19.9441 45.1926C20.695 46.3244 21.095 46.5256 22.4933 46.5256H27.2933C28.5916 46.5256 29.1916 45.9716 29.1916 44.7665V15.9852C29.1407 14.7801 28.5424 14.2261 27.2678 14.2261Z" />
			<path d="M5.44915 10.9602C8.45863 10.9602 10.8983 8.50669 10.8983 5.48011C10.8983 2.45353 8.45863 0 5.44915 0C2.43967 0 0 2.45353 0 5.48011C0 8.50669 2.43967 10.9602 5.44915 10.9602Z" />
			<path d="M61.7899 25.0449C63.2306 23.1903 65.078 22.2051 67.556 22.2051C72.0526 22.2051 74.7611 25.3347 74.7611 29.4511V39.2489C74.8187 39.7125 74.5306 39.9443 74.0695 39.9443H72.5136C72.0526 39.9443 71.7645 39.7125 71.8221 39.2489V29.5091C71.8221 27.1909 69.9187 25.2187 67.4984 25.2187C65.1339 25.2187 63.2323 27.1329 63.2323 29.2773V39.2489C63.2899 39.7125 63.0018 39.9443 62.5407 39.9443H60.9831C60.5221 39.9443 60.2916 39.7125 60.2916 39.2489V29.4511C60.2916 27.1329 58.3899 25.2187 56.0255 25.2187C53.7204 25.2187 51.7594 27.075 51.7594 29.2773V39.3068C51.817 39.7705 51.5289 40.0023 51.0102 40.0023H49.5119C49.0509 40.0023 48.7628 39.7705 48.7628 39.3068V23.25C48.7051 22.7864 48.9933 22.4966 49.5119 22.4966H50.9526C51.356 22.4966 51.5289 22.6704 51.5289 23.0182V24.2352C52.7407 22.9602 54.239 22.2648 56.0255 22.2648C58.4475 22.2068 60.3492 23.192 61.7899 25.0466V25.0449ZM77.1255 31.2477C77.1255 26.3216 81.1018 22.2051 86.1187 22.2051C88.539 22.2051 90.6136 23.1903 92.3441 25.1608V23.1903C92.3441 22.7267 92.5746 22.5528 93.0357 22.5528H94.4187C94.8797 22.5528 95.1102 22.7847 95.1102 23.3062V39.3648C95.1102 39.8284 94.8797 40.0602 94.4187 40.0602H93.0357C92.5746 40.0602 92.3441 39.8284 92.3441 39.4227V37.4523C90.6712 39.3648 88.5967 40.35 86.1746 40.35C81.1018 40.2341 77.1238 36.1773 77.1238 31.2477H77.1255ZM92.1136 31.2477C92.1136 27.8284 89.4611 25.2187 86.0594 25.2187C82.7746 25.2187 80.1221 27.8864 80.1221 31.2477C80.1221 34.6687 82.7746 37.2784 86.1187 37.2784C86.9062 37.2789 87.6861 37.1232 88.4138 36.8202C89.1414 36.5173 89.8026 36.0731 90.3593 35.513C90.9161 34.9528 91.3577 34.2878 91.6587 33.556C91.9597 32.8241 92.1143 32.0397 92.1136 31.2477ZM100.992 37.3943V46.3807C101.049 46.8443 100.761 47.1341 100.298 47.1341H98.7424C98.2814 47.1341 97.9933 46.9023 97.9933 46.3807V23.1903C97.9933 22.7267 98.2238 22.4369 98.7424 22.4369H100.183C100.646 22.379 100.934 22.6687 100.934 23.0744V24.9869C102.605 23.0744 104.68 22.1472 107.044 22.1472C112.002 22.1472 116.037 26.2619 116.037 31.1898C116.037 36.1176 112.059 40.2341 107.044 40.2341C104.622 40.2341 102.603 39.3068 100.992 37.3943ZM106.987 25.2187C103.7 25.2187 101.049 27.8864 101.049 31.2477C101.049 34.6687 103.7 37.2784 107.044 37.2784C110.446 37.2784 113.039 34.6108 113.039 31.2477C113.039 27.8864 110.388 25.2187 106.987 25.2187ZM121.11 37.3943V46.3807C121.168 46.8443 120.88 47.1341 120.419 47.1341H118.861C118.4 47.1341 118.112 46.9023 118.112 46.3807V23.1903C118.112 22.7267 118.342 22.4369 118.861 22.4369H120.302C120.764 22.379 121.053 22.6687 121.053 23.0744V24.9869C122.724 23.0744 124.798 22.1472 127.163 22.1472C132.12 22.1472 136.156 26.2619 136.156 31.1898C136.156 36.1176 132.178 40.2341 127.163 40.2341C124.742 40.2341 122.781 39.3068 121.11 37.3943ZM127.105 25.2187C123.819 25.2187 121.168 27.8864 121.168 31.2477C121.168 34.6687 123.819 37.2784 127.163 37.2784C130.564 37.2784 133.158 34.6108 133.158 31.2477C133.158 27.8864 130.507 25.2187 127.107 25.2187H127.105ZM153.97 32.3506H141.054C141.342 35.2483 143.995 37.4523 147.164 37.4523C148.893 37.4523 150.393 37.0466 151.719 36.0597C152.007 35.8858 152.295 35.7699 152.353 35.7699C152.583 35.7699 152.756 35.8858 152.929 36.1773L153.505 37.1625C153.622 37.3364 153.68 37.4523 153.68 37.5682C153.68 37.8 153.507 38.0318 153.103 38.3216C151.258 39.5966 149.183 40.292 146.992 40.292C141.688 40.292 137.883 36.3511 137.883 31.2477C137.883 26.204 141.803 22.2051 146.703 22.2051C151.546 22.2051 154.717 25.7983 154.717 31.0176C154.717 31.5972 154.717 32.3506 153.968 32.3506H153.97ZM141.056 30.0324H151.72C151.432 26.8432 149.473 24.929 146.648 24.929C145.241 24.8904 143.875 25.3995 142.833 26.3501C141.791 27.3007 141.154 28.6194 141.056 30.0307V30.0324ZM156.332 31.2477C156.332 26.3216 160.31 22.2051 165.326 22.2051C167.748 22.2051 169.707 23.1324 171.32 25.0449V16.2324C171.263 15.7687 171.551 15.479 172.012 15.479H173.57C174.031 15.479 174.319 15.7108 174.319 16.2324V39.3068C174.319 39.7705 174.088 40.0023 173.57 40.0023H172.129C171.666 40.0602 171.378 39.7705 171.378 39.3648V37.3943C169.649 39.3068 167.632 40.292 165.268 40.292C160.31 40.2341 156.332 36.1773 156.332 31.2477ZM171.264 31.2477C171.264 27.8284 168.612 25.2187 165.21 25.2187C161.924 25.2187 159.273 27.8864 159.273 31.2477C159.273 34.6687 161.924 37.2784 165.268 37.2784C166.057 37.2838 166.839 37.1316 167.569 36.8304C168.299 36.5292 168.962 36.0852 169.52 35.5241C170.077 34.963 170.519 34.296 170.818 33.5619C171.117 32.8277 171.268 32.0411 171.263 31.2477H171.264ZM177.72 19.0739C177.715 18.8594 177.754 18.646 177.833 18.4468C177.912 18.2476 178.031 18.0667 178.182 17.915C178.333 17.7633 178.512 17.6439 178.71 17.5642C178.909 17.4845 179.121 17.446 179.334 17.4511C179.546 17.4507 179.756 17.4923 179.952 17.5737C180.148 17.6551 180.326 17.7746 180.476 17.9254C180.626 18.0762 180.745 18.2553 180.826 18.4523C180.907 18.6494 180.948 18.8606 180.948 19.0739C180.953 19.2884 180.914 19.5017 180.835 19.7009C180.756 19.9001 180.637 20.081 180.486 20.2327C180.335 20.3845 180.156 20.5038 179.957 20.5835C179.759 20.6633 179.547 20.7017 179.334 20.6966C178.412 20.7545 177.72 20.0591 177.72 19.0739ZM177.836 39.2489V23.1903C177.836 22.7267 178.066 22.4369 178.527 22.4369H180.083C180.544 22.4369 180.832 22.6687 180.775 23.1903V39.2489C180.832 39.7125 180.544 39.9443 180.083 39.9443H178.527C178.066 39.9443 177.836 39.7125 177.836 39.2489ZM186.944 23.0165V24.1756C188.212 22.8426 189.71 22.2051 191.497 22.2051C195.937 22.2051 198.646 25.2767 198.646 29.3932V39.2489C198.703 39.7125 198.415 39.9443 197.954 39.9443H196.398C195.936 39.9443 195.705 39.7125 195.705 39.2489V29.4511C195.705 27.1329 193.803 25.2187 191.439 25.2187C189.134 25.2187 187.175 27.075 187.175 29.2773V39.3068C187.232 39.7705 186.944 40.0023 186.424 40.0023H184.868C184.407 40.0023 184.119 39.7705 184.119 39.3068V23.1903C184.061 22.7267 184.349 22.4949 184.868 22.4949H186.309C186.712 22.4949 186.944 22.6687 186.944 23.0165Z" />
			<path d="M204 40C205.115 40 206 39.0857 206 38V37.9886C206 36.9029 205.126 36 204 36C202.885 36 202 36.9143 202 38V38.0114C202 39.0971 202.874 40 204 40ZM204 39.7829C202.989 39.7829 202.23 38.9829 202.23 38.0114V38C202.23 37.0286 203 36.2171 204 36.2171C205.011 36.2171 205.77 37.0171 205.77 37.9886V38C205.77 38.9714 205 39.7829 204 39.7829ZM203.218 38.9714H203.609V38.2743H204.034L204.517 38.9714H204.989L204.448 38.2057C204.724 38.1257 204.92 37.92 204.92 37.5886C204.92 37.1657 204.586 36.9486 204.138 36.9486H203.218V38.9714ZM203.609 37.9543V37.2914H204.103C204.368 37.2914 204.517 37.4057 204.517 37.6229C204.517 37.8171 204.368 37.9543 204.103 37.9543H203.609Z" />
		</svg>`],["share-16x16",`<svg viewBox="0 0 16 16">
			<path
				fillRule="evenodd"
				clipRule="evenodd"
				d="M13 6C14.6569 6 16 4.65685 16 3C16 1.34315 14.6569 0 13 0C11.3431 0 10 1.34315 10 3C10 3.13463 10.0089 3.26719 10.0261 3.39712L6.82972 5.17286C6.10576 4.44825 5.10523 4 4 4C1.79086 4 0 5.79086 0 8C0 10.2091 1.79086 12 4 12C5.10523 12 6.10576 11.5518 6.82972 10.8271L10.0261 12.6029C10.0089 12.7328 10 12.8654 10 13C10 14.6569 11.3431 16 13 16C14.6569 16 16 14.6569 16 13C16 11.3431 14.6569 10 13 10C12.2011 10 11.4752 10.3123 10.9376 10.8214L7.84579 9.1037C7.94622 8.75313 8 8.38284 8 8C8 7.61716 7.94622 7.24687 7.84579 6.8963L10.9376 5.17864C11.4752 5.68775 12.2011 6 13 6ZM13 4C13.5523 4 14 3.55228 14 3C14 2.44772 13.5523 2 13 2C12.4477 2 12 2.44772 12 3C12 3.55228 12.4477 4 13 4ZM4 10C5.10457 10 6 9.10457 6 8C6 6.89543 5.10457 6 4 6C2.89543 6 2 6.89543 2 8C2 9.10457 2.89543 10 4 10ZM14 13C14 13.5523 13.5523 14 13 14C12.4477 14 12 13.5523 12 13C12 12.4477 12.4477 12 13 12C13.5523 12 14 12.4477 14 13Z"
				stroke="none"
			/>
		</svg>`],["checkmark-16x16",`<svg viewBox="0 0 16 16">
			<path
				fillRule="evenodd"
				clipRule="evenodd"
				d="M15.387 3.31662C15.6008 3.49148 15.6323 3.80649 15.4574 4.02021L6.77402 14.6332C6.58509 14.8642 6.30292 14.9986 6.00457 15C5.70622 15.0013 5.42285 14.8694 5.23184 14.6402L0.551937 9.02429C0.375155 8.81215 0.403817 8.49687 0.615956 8.32009L1.38418 7.67991C1.59632 7.50312 1.9116 7.53179 2.08838 7.74392L5.99299 12.4295L13.9095 2.75374C14.0844 2.54002 14.3994 2.50852 14.6131 2.68338L15.387 3.31662Z"
				stroke="none"
			/>
		</svg>`],["arrow-right-16x16",`<svg viewBox="0 0 16 16">
			<path
				fillRule="evenodd"
				clipRule="evenodd"
				d="M8.35355 1.64645C8.54881 1.45118 8.8654 1.45118 9.06066 1.64645L14.7071 7.29289C15.0976 7.68342 15.0976 8.31658 14.7071 8.70711L9.06066 14.3536C8.8654 14.5488 8.54882 14.5488 8.35355 14.3536L7.64645 13.6464C7.45118 13.4512 7.45118 13.1346 7.64645 12.9393L11.5858 9H0.5C0.223858 9 0 8.77614 0 8.5V7.5C0 7.22386 0.223858 7 0.5 7H11.5858L7.64645 3.06066C7.45118 2.8654 7.45118 2.54882 7.64645 2.35355L8.35355 1.64645Z"
				stroke="none"
			/>
		</svg>`],["arrow-up-16x16",`<svg viewBox="0 0 16 16">
			<path
				fillRule="evenodd"
				clipRule="evenodd"
				d="M8.00015 0.5C8.34685 0.5 8.67835 0.642318 8.91714 0.893677L15.6517 7.98267C15.8441 8.18525 15.8359 8.50548 15.6333 8.69793L14.533 9.7433C14.3304 9.93575 14.0101 9.92754 13.8177 9.72496L9.26497 4.93262V15.4249C9.26497 15.7043 9.03846 15.9308 8.75904 15.9308H7.24125C6.96184 15.9308 6.73532 15.7043 6.73532 15.4249V4.93262L2.1826 9.72496C1.99015 9.92754 1.66992 9.93575 1.46734 9.7433L0.366945 8.69793C0.164367 8.50548 0.156156 8.18525 0.348604 7.98267L7.08315 0.893677C7.32194 0.642318 7.65344 0.5 8.00015 0.5Z"
				stroke="none"
			/>
		</svg>`],["connection-stairs-16x16",`<svg viewBox="0 0 16 16">
			<g stroke="none">
				<path d="M1 11.5C1 11.2239 1.22386 11 1.5 11H6V13.5C6 13.7761 5.77614 14 5.5 14H1.5C1.22386 14 1 13.7761 1 13.5V11.5Z" />
				<path d="M4 8.5C4 8.22386 4.22386 8 4.5 8H9V10.5C9 10.7761 8.77614 11 8.5 11H4V8.5Z" />
				<path d="M7 5.5C7 5.22386 7.22386 5 7.5 5H12V7.5C12 7.77614 11.7761 8 11.5 8H7V5.5Z" />
				<path d="M10 2.5C10 2.22386 10.2239 2 10.5 2H14.5C14.7761 2 15 2.22386 15 2.5V4.5C15 4.77614 14.7761 5 14.5 5H10V2.5Z" />
			</g>
		</svg>`],["connection-stairs-14x14",`<svg viewBox="0 0 14 14">
			<path
				d="M5.25 12H2.5C2.225 12 2 11.7429 2 11.4286C2 11.1143 2.225 10.8571 2.5 10.8571H4.25V7.91429H6.5V4.94286H8.75V2H11.5C11.775 2 12 2.25714 12 2.57143C12 2.88571 11.775 3.14286 11.5 3.14286H9.75V6.08571H7.5V9.02857H5.25V12Z"
				stroke="none"
			/>
		</svg>`],["connection-stairs-12x12",`<svg viewBox="0 0 12 12" stroke="none">
			<path d="M1.625 8.1875C1.625 8.01491 1.76491 7.875 1.9375 7.875H4.75V9.4375C4.75 9.61009 4.61009 9.75 4.4375 9.75H1.9375C1.76491 9.75 1.625 9.61009 1.625 9.4375V8.1875Z" />
			<path d="M3.5 6.3125C3.5 6.13991 3.63991 6 3.8125 6H6.625V7.5625C6.625 7.73509 6.48509 7.875 6.3125 7.875H3.5V6.3125Z" />
			<path d="M5.375 4.4375C5.375 4.26491 5.51491 4.125 5.6875 4.125H8.5V5.6875C8.5 5.86009 8.36009 6 8.1875 6H5.375V4.4375Z" />
			<path d="M7.25 2.5625C7.25 2.38991 7.38991 2.25 7.5625 2.25H10.0625C10.2351 2.25 10.375 2.38991 10.375 2.5625V3.8125C10.375 3.98509 10.2351 4.125 10.0625 4.125H7.25V2.5625Z" />
		</svg>`],["connection-escalator-16x16",`<svg viewBox="0 0 16 16">
			<g stroke="none">
				<path d="M3.63008 12H2C0.895431 12 0 12.8954 0 14C0 15.1046 0.89543 16 2 16H4.63008C4.86879 16 5.09962 15.9146 5.28087 15.7593L11.7191 10.2407C11.9004 10.0854 12.1312 10 12.3699 10H14C15.1046 10 16 9.10457 16 8C16 6.89543 15.1046 6 14 6H11.3699C11.1312 6 10.9004 6.08539 10.7191 6.24074L4.28087 11.7593C4.09962 11.9146 3.86879 12 3.63008 12Z" />
				<path d="M5 6C5 4.89543 5.89543 4 7 4C8.10457 4 9 4.89543 9 6L5 9.5V6Z" />
				<path d="M9 2C9 3.10457 8.10457 4 7 4C5.89543 4 5 3.10457 5 2C5 0.89543 5.89543 0 7 0C8.10457 0 9 0.89543 9 2Z" />
			</g>
		</svg>`],["connection-escalator-14x14",`<svg viewBox="0 0 14 14">
			<path
				d="M5.26686 2.98522C5.26686 2.44335 5.71573 2 6.26436 2C6.81299 2 7.26187 2.44335 7.26187 2.98522C7.26187 3.5271 6.81299 3.97045 6.26436 3.97045C5.71573 3.97045 5.26686 3.50246 5.26686 2.98522Z"
				stroke="none"
			/>
			<path
				d="M7.26188 5.48588V5.25125C7.26188 4.85716 6.91275 4.53696 6.48881 4.53696H6.03993C5.61599 4.53696 5.26687 4.88179 5.26687 5.25125V7.66458L4.3192 8.6995H3.67082C2.74813 8.6995 2 9.43842 2 10.3498C2 11.2611 2.74813 12 3.67082 12H4.61845C5.36658 12 6.11471 11.6798 6.61347 11.1133L9.6808 7.76354H10.3292C11.2519 7.76354 12 7.02463 12 6.11329C12 5.20196 11.2519 4.46305 10.3292 4.46305H9.38155C8.60848 4.46305 7.88529 4.78324 7.38653 5.34975L7.26188 5.48588ZM4.61846 11.0148H3.67083C3.29677 11.0148 2.99751 10.7192 2.99751 10.3498C2.99751 9.9803 3.29677 9.68473 3.67083 9.68473H4.61846C4.71821 9.68473 4.81796 9.63547 4.86784 9.56158L8.13467 5.99015C8.45886 5.64532 8.90774 5.44828 9.38155 5.44828H10.3292C10.7032 5.44828 11.0025 5.74384 11.0025 6.1133C11.0025 6.48276 10.7032 6.77833 10.3292 6.77833H9.38155C9.2818 6.77833 9.18205 6.82759 9.13218 6.87685L5.86534 10.4729C5.54115 10.8177 5.09228 11.0148 4.61846 11.0148Z"
				stroke="none"
			/>
		</svg>`],["connection-elevator-16x16",`<svg viewBox="0 0 16 16">
			<g stroke="none">
				<path d="M3 5.5C3 6.32843 2.32843 7 1.5 7C0.671573 7 0 6.32843 0 5.5C0 4.67157 0.671573 4 1.5 4C2.32843 4 3 4.67157 3 5.5Z" />
				<path d="M3 10.5C3 11.3284 2.32843 12 1.5 12C0.671573 12 0 11.3284 0 10.5C0 9.67157 0.671573 9 1.5 9C2.32843 9 3 9.67157 3 10.5Z" />
				<path d="M11 1H14C14.5523 1 15 1.44772 15 2V14C15 14.5523 14.5523 15 14 15H11V1Z" />
				<path d="M9 1H6C5.44772 1 5 1.44772 5 2V14C5 14.5523 5.44772 15 6 15H9V1Z" />
			</g>
		</svg>`],["connection-elevator-14x14",`<svg viewBox="0 0 14 14">
			<path
				d="M7.476 2H2.72693C1.77095 2 1 2.72464 1 3.62319V10.3768C1 11.2754 1.77095 12 2.72693 12H7.476C8.43198 12 9.20293 11.2754 9.20293 10.3768V3.62319C9.17209 2.72464 8.40114 2 7.476 2ZM7.476 3.15942C7.75354 3.15942 7.96941 3.36232 7.96941 3.62319V10.3768C7.96941 10.6377 7.75354 10.8406 7.476 10.8406H5.71824V3.15942H7.476ZM4.48472 3.15942V10.8406H2.72693C2.44939 10.8406 2.23352 10.6377 2.23352 10.3768V3.62319C2.23352 3.36232 2.44939 3.15942 2.72693 3.15942H4.48472Z"
				stroke="none"
			/>
			<path
				d="M12.4643 6.19064H10.6638C10.4456 6.19064 10.2546 6.06243 10.1728 5.88294C10.0909 5.70346 10.1455 5.47269 10.2819 5.31884L11.1821 4.47269C11.4004 4.26756 11.755 4.26756 11.946 4.47269L12.8462 5.31884C13.0099 5.47269 13.0371 5.67781 12.9553 5.88294C12.8735 6.08807 12.6825 6.19064 12.4643 6.19064Z"
				stroke="none"
			/>
			<path
				d="M11.564 9.65216C11.4276 9.65216 11.2912 9.60088 11.1821 9.49831L10.2819 8.65216C10.1182 8.49831 10.0909 8.29319 10.1728 8.08806C10.2546 7.90857 10.4456 7.78036 10.6638 7.78036H12.4643C12.6825 7.78036 12.8735 7.90857 12.9553 8.08806C13.0371 8.26754 12.9826 8.49831 12.8462 8.65216L11.9459 9.49831C11.8641 9.60088 11.7004 9.65216 11.564 9.65216Z"
				stroke="none"
			/>
		</svg>`],["connection-elevator-12x12",`<svg viewBox="0 0 12 12" stroke="none">
			<circle cx="1.9375" cy="4.4375" r="0.9375" />
			<circle cx="1.9375" cy="7.5625" r="0.9375" />
			<path
				fillRule="evenodd"
				clipRule="evenodd"
				d="M7.6 2H9.4C9.73137 2 10 2.26863 10 2.6V9.41328C10 9.74465 9.73137 10.0133 9.4 10.0133H7.6V2ZM6.4 2H4.6C4.26863 2 4 2.26863 4 2.6V9.41328C4 9.74465 4.26863 10.0133 4.6 10.0133H6.4V2Z"
			/>
		</svg>`],["new-tab-14x14",`<svg viewBox="0 0 14 14">
			<g stroke="none">
				<path d="M2.625 2.625H5.6875C5.92913 2.625 6.125 2.42912 6.125 2.1875V1.3125C6.125 1.07088 5.92913 0.875 5.6875 0.875H1.3125C1.07088 0.875 0.875 1.07088 0.875 1.3125V12.6875C0.875 12.9291 1.07088 13.125 1.3125 13.125H12.6875C12.9291 13.125 13.125 12.9291 13.125 12.6875V8.3125C13.125 8.07088 12.9291 7.875 12.6875 7.875H11.8125C11.5709 7.875 11.375 8.07088 11.375 8.3125V11.375H2.625V2.625Z" />
				<path d="M12.9063 0.875H8.40311C8.20822 0.875 8.11063 1.11062 8.24843 1.24843L9.88124 2.88124L5.8156 6.94688C5.64475 7.11774 5.64475 7.39475 5.8156 7.5656L6.43432 8.18432C6.60517 8.35517 6.88218 8.35517 7.05304 8.18432L11.1187 4.11868L12.7516 5.75157C12.8894 5.88938 13.125 5.79178 13.125 5.59689V1.09375C13.125 0.972938 13.0271 0.875 12.9063 0.875Z" />
			</g>
		</svg>`],["compress-16x16",`<svg viewBox="0 0 16 16">
			<g stroke="none">
				<path
					id="Vector"
					d="M4.67773 10.7154H0.713449C0.556306 10.7154 0.427734 10.844 0.427734 11.0011V11.8583C0.427734 12.0154 0.556306 12.144 0.713449 12.144H3.82059V15.2868C3.82059 15.444 3.94916 15.5725 4.10631 15.5725H4.96345C5.12059 15.5725 5.24916 15.444 5.24916 15.2868V11.2868C5.24916 10.9708 4.99381 10.7154 4.67773 10.7154ZM4.96345 0.429688H4.10631C3.94916 0.429688 3.82059 0.558259 3.82059 0.715402V3.85826H0.713449C0.556306 3.85826 0.427734 3.98683 0.427734 4.14397V5.00112C0.427734 5.15826 0.556306 5.28683 0.713449 5.28683H4.67773C4.99381 5.28683 5.24916 5.03147 5.24916 4.7154V0.715402C5.24916 0.558259 5.12059 0.429688 4.96345 0.429688ZM15.2849 10.7154H11.3206C11.0045 10.7154 10.7492 10.9708 10.7492 11.2868V15.2868C10.7492 15.444 10.8777 15.5725 11.0349 15.5725H11.892C12.0492 15.5725 12.1777 15.444 12.1777 15.2868V12.144H15.2849C15.442 12.144 15.5706 12.0154 15.5706 11.8583V11.0011C15.5706 10.844 15.442 10.7154 15.2849 10.7154ZM15.2849 3.85826H12.1777V0.715402C12.1777 0.558259 12.0492 0.429688 11.892 0.429688H11.0349C10.8777 0.429688 10.7492 0.558259 10.7492 0.715402V4.7154C10.7492 5.03147 11.0045 5.28683 11.3206 5.28683H15.2849C15.442 5.28683 15.5706 5.15826 15.5706 5.00112V4.14397C15.5706 3.98683 15.442 3.85826 15.2849 3.85826Z"
				/>
			</g>
		</svg>`],["washroom-14x14",`<svg viewBox="0 0 14 14" stroke="none">
			<path d="M4.55125 3.09062C4.55125 3.69326 4.07639 4.18176 3.49058 4.18176C2.90525 4.18176 2.43039 3.69326 2.43039 3.09062C2.43039 2.4885 2.90525 2 3.49058 2C4.07639 2 4.55125 2.4885 4.55125 3.09062Z" />
			<path d="M5.1193 5.48047C4.81653 4.83116 4.17252 4.41571 3.47822 4.41571C2.78392 4.41571 2.13986 4.83116 1.83714 5.48047L1.04175 7.22034C0.940664 7.441 1.02893 7.70073 1.24393 7.81791C1.47077 7.90871 1.72324 7.81791 1.82433 7.59725L2.49349 6.15554L2.21587 11.4407C2.20305 11.7263 2.41805 11.9734 2.69567 11.9993C2.97329 12.0124 3.21344 11.7913 3.23859 11.5057L3.4028 8.285H3.567L3.73121 11.5057C3.74403 11.7913 3.97086 11.9993 4.23616 11.9993H4.26131C4.53893 11.9861 4.75343 11.7395 4.74111 11.4407L4.46349 6.15554L5.13265 7.59725C5.20858 7.75298 5.35997 7.85697 5.52418 7.85697C5.5873 7.85697 5.65042 7.84379 5.71354 7.81792C5.92804 7.71393 6.0163 7.44153 5.91572 7.22035L5.1193 5.48047Z" />
			<path d="M12.9582 7.22034L12.1505 5.48047C11.8477 4.83116 11.2037 4.41571 10.5094 4.41571C9.81513 4.41571 9.17107 4.83116 8.86836 5.48047L8.06064 7.22034C7.95955 7.441 8.04782 7.70073 8.26282 7.81791C8.47732 7.9219 8.7298 7.8311 8.84371 7.60993L9.52519 6.12977L9.46207 7.2204L8.57842 8.92184C8.47733 9.11663 8.61638 9.36316 8.83089 9.36316H9.33584L9.22242 11.4668C9.2096 11.7397 9.41177 11.9862 9.68939 11.9994C9.95469 12.0126 10.1943 11.8046 10.2072 11.519L10.3581 9.33723H10.6737L10.7871 11.5058C10.7999 11.7787 11.0144 11.9862 11.2792 11.9862H11.3043C11.5696 11.973 11.7841 11.7396 11.7713 11.4535L11.6579 9.33718H12.1628C12.3773 9.33718 12.5287 9.09066 12.4153 8.89586L11.5317 7.19442L11.4685 6.1038L12.1757 7.5972C12.2516 7.75293 12.403 7.85692 12.5672 7.85692C12.6303 7.85692 12.6934 7.84373 12.7566 7.81786C12.9711 7.70068 13.0593 7.44102 12.9582 7.22034Z" />
			<path d="M11.5696 3.09062C11.5696 3.69326 11.0948 4.18176 10.5094 4.18176C9.92363 4.18176 9.44876 3.69326 9.44876 3.09062C9.44876 2.4885 9.92363 2 10.5094 2C11.0948 2 11.5696 2.4885 11.5696 3.09062Z" />
			<path d="M6.99996 2.00006C6.76031 2.00006 6.57095 2.19485 6.57095 2.44138V11.5575C6.57095 11.804 6.76031 11.9988 6.99996 11.9988C7.2396 11.9988 7.42896 11.804 7.42896 11.5575V2.44138C7.42896 2.19485 7.2396 2.00006 6.99996 2.00006Z" />
		</svg>`],["point-of-interest-12x12",`<svg viewBox="0 0 12 12" stroke="none">
			<path
				stroke="none"
				id="Subtract"
				fill-rule="evenodd"
				clip-rule="evenodd"
				d="M6.24724 10.7516C7.94597 9.0358 9.85962 6.89195 9.85962 4.85965C9.85962 2.72802 8.13159 1 5.99997 1C3.86834 1 2.14032 2.72802 2.14032 4.85965C2.14032 6.89195 4.05397 9.0358 5.7527 10.7516C5.88904 10.8893 6.1109 10.8893 6.24724 10.7516ZM5.99994 6.26317C6.77508 6.26317 7.40345 5.6348 7.40345 4.85967C7.40345 4.08453 6.77508 3.45616 5.99994 3.45616C5.22481 3.45616 4.59644 4.08453 4.59644 4.85967C4.59644 5.6348 5.22481 6.26317 5.99994 6.26317Z"
			/>
		</svg>`],["flag-20x20",`<svg viewBox="0 0 20 20" stroke="none">
			<path
				d="M16.9987 4.27111C16.936 5.06715 16.3836 5.93162 15.5238 6.57845C14.7549 7.15682 13.0885 8.04927 10.5434 7.55174C8.32167 7.1164 6.82156 8.02129 6.08085 10.2416L8.24615 17.3998C8.31833 17.6471 8.17711 17.9059 7.9292 17.9813C7.88527 17.9938 7.83976 18 7.79426 18C7.58634 18 7.40277 17.8647 7.34236 17.6673L5.1644 10.4686C5.13773 10.4173 5.12125 10.3613 5.11419 10.3038L3.41956 4.70042C3.38112 4.63512 3.35994 4.56127 3.3568 4.48587L3.02101 3.37886C2.98413 3.25992 2.9959 3.13165 3.05553 3.02203C3.11437 2.91242 3.21479 2.83079 3.33482 2.79504C3.45564 2.75928 3.5851 2.7725 3.69494 2.83235C3.80477 2.89144 3.88637 2.99172 3.92167 3.11143L3.9813 3.31355C4.38847 2.85956 4.90472 2.51439 5.48136 2.30915C6.97201 1.75566 8.95216 1.95467 10.6469 2.83156C11.6888 3.36951 14.3374 4.54493 16.3647 3.79553C16.5154 3.74111 16.684 3.76599 16.8127 3.86239C16.9406 3.95879 17.0105 4.11251 16.9987 4.27111Z"
				stroke="none"
			/>
		</svg>`],["link-16x16",`<svg viewBox="0 0 16 16" stroke="none">
			<path
				d="M9.10678 11.2433C9.07993 11.2167 9.04367 11.2018 9.00589 11.2018C8.9681 11.2018 8.93184 11.2167 8.90499 11.2433L6.82999 13.3183C5.86928 14.279 4.24785 14.3808 3.18714 13.3183C2.12464 12.2558 2.22642 10.6362 3.18714 9.67546L5.26214 7.60046C5.31749 7.5451 5.31749 7.45403 5.26214 7.39868L4.55142 6.68796C4.52457 6.66138 4.48832 6.64646 4.45053 6.64646C4.41274 6.64646 4.37649 6.66138 4.34964 6.68796L2.27464 8.76296C0.763923 10.2737 0.763923 12.7183 2.27464 14.2272C3.78535 15.7362 6.22999 15.738 7.73892 14.2272L9.81392 12.1522C9.86928 12.0969 9.86928 12.0058 9.81392 11.9505L9.10678 11.2433ZM13.7246 2.77903C12.2139 1.26832 9.76928 1.26832 8.26035 2.77903L6.18357 4.85403C6.15698 4.88088 6.14207 4.91714 6.14207 4.95493C6.14207 4.99271 6.15698 5.02897 6.18357 5.05582L6.89249 5.76475C6.94785 5.8201 7.03892 5.8201 7.09428 5.76475L9.16928 3.68975C10.13 2.72903 11.7514 2.62725 12.8121 3.68975C13.8746 4.75225 13.7729 6.37189 12.8121 7.3326L10.7371 9.4076C10.7106 9.43445 10.6956 9.47071 10.6956 9.5085C10.6956 9.54628 10.7106 9.58254 10.7371 9.60939L11.4479 10.3201C11.5032 10.3755 11.5943 10.3755 11.6496 10.3201L13.7246 8.2451C15.2336 6.73439 15.2336 4.28975 13.7246 2.77903ZM9.75142 6.00939C9.72457 5.9828 9.68832 5.96789 9.65053 5.96789C9.61275 5.96789 9.57649 5.9828 9.54964 6.00939L5.50499 10.0522C5.47841 10.0791 5.46349 10.1154 5.46349 10.1531C5.46349 10.1909 5.47841 10.2272 5.50499 10.254L6.21214 10.9612C6.26749 11.0165 6.35857 11.0165 6.41392 10.9612L10.4568 6.91832C10.5121 6.86296 10.5121 6.77189 10.4568 6.71653L9.75142 6.00939Z"
				stroke="none"
			/>
		</svg>`]]),Ove=/<svg([^>]*)>/g;function KJ(i,e,t){let r=Bve.get(i);return r?r.replace(Ove,`<svg$1 xmlns="http://www.w3.org/2000/svg" style="fill:${e}; width:${t}px; height:${t}px">`):""}h(KJ,"getStyledIcon");var vc,vf,Vy,PS,AS,iI,IS,rI,jy,$2,LS,nI,QJ=class{constructor(e,t){fe(this,Vy),fe(this,AS),fe(this,IS),fe(this,jy),fe(this,LS),fe(this,vc,void 0),fe(this,vf,void 0),ie(this,"colors",{default:"#3D5676",connection:"#128387",washroom:"#3161B4",point:"#AD468F"}),ke(this,vc,e),ke(this,vf,t)}auto(){let e=M(this,vf)[Object.keys(M(this,vf))[0]];[...e.getByType("connection"),...e.getByType("point-of-interest"),...e.getByType("space")].forEach(t=>{t.__type==="connection"?t.coordinates.forEach(r=>{M(this,vc).Labels.add(r,t.name,Ot(this,Vy,PS).call(this,t))}):(t.__type==="space"&&t.name!==""&&M(this,vc).updateState(t,{interactive:!0,hoverColor:"#F0F0F0"}),M(this,vc).Labels.add(t,t.name,Ot(this,Vy,PS).call(this,t)))})}};vc=new WeakMap,vf=new WeakMap,Vy=new WeakSet,PS=h(function(i){let e=KJ(Ot(this,AS,iI).call(this,i),"white",12);return{appearance:{text:{foregroundColor:Ot(this,jy,$2).call(this,i)},marker:{foregroundColor:{active:Ot(this,jy,$2).call(this,i)},icon:e,iconSize:12}},interactive:!0,rank:Ot(this,LS,nI).call(this,i)}},"#generatLabelAppearance"),AS=new WeakSet,iI=h(function(i){return i.__type==="connection"?Ot(this,IS,rI).call(this,i.type):i.name.includes("Washroom")?"washroom-14x14":i.__type==="point-of-interest"?"point-of-interest-12x12":""},"#getIconName"),IS=new WeakSet,rI=h(function(i){let e="";switch(i){case"elevator":e="connection-elevator-12x12";break;case"escalator":e="connection-escalator-12x12";break;case"stairs":e="connection-stairs-12x12";break}return e},"#attemptIconNameForConnection"),jy=new WeakSet,$2=h(function(i){return i.__type==="connection"?this.colors.connection:i.__type==="point-of-interest"?this.colors.point:"name"in i&&i.name.includes("Washroom")?this.colors.washroom:this.colors.default},"#getLabelColor"),LS=new WeakSet,nI=h(function(i){return i.__type==="connection"?"high":(i.__type,"medium")},"#getDefaultLabelRank"),h(QJ,"Labels");var Nve=QJ,eK=class{constructor(e,t){Z(this,"Labels");Z(this,"auto",()=>{this.Labels.auto()});this.Labels=new Nve(e,t)}};h(eK,"DefaultTheme");var $ve=eK;R();var Ui,tK=class{constructor(e){fe(this,Ui,void 0),ie(this,"setMinPitch",t=>{M(this,Ui).camera.setMinPitch(t)}),ie(this,"setMaxPitch",t=>{M(this,Ui).camera.setMaxPitch(t)}),ie(this,"setMinZoomLevel",t=>{M(this,Ui).camera.setMinZoomLevel(t)}),ie(this,"setMaxZoomLevel",t=>{M(this,Ui).camera.setMaxZoomLevel(t)}),ke(this,Ui,e)}setScreenOffsets(e){M(this,Ui).camera.setInsetPadding(e)}focusOn(e,t){var r;let n=[],a=Array.isArray(e)?e:[e];for(let o of a)if(t_.is(o)){let s;for(s of o.coordinates)n.push([s.longitude,s.latitude])}else if(e_.is(o)||ih.is(o)||rh.is(o)){let s=M(this,Ui).getBoundingArea(o.id);s&&n.push(...s)}else{let s=$u(o);if(s){let l=0;s.floorId&&(l=((r=M(this,Ui).getState(s.floorId))==null?void 0:r.altitude)||0),n.push([s.longitude,s.latitude,l])}}return M(this,Ui).camera.focusOn(n,{pitch:t==null?void 0:t.pitch,bearing:t==null?void 0:t.bearing,padding:t==null?void 0:t.screenOffsets,maxZoomLevel:t==null?void 0:t.maxZoomLevel,minZoomLevel:t==null?void 0:t.minZoomLevel,duration:t==null?void 0:t.duration,easing:t==null?void 0:t.easing})}animateTo(e,t){var r;let{center:n,zoomLevel:a,bearing:o,pitch:s}=e,l=n??this.center,u=[l.longitude,l.latitude];return M(this,Ui).camera.animateTo({center:u,zoomLevel:a??this.zoomLevel,bearing:o??this.bearing,pitch:s??this.pitch,duration:(r=t==null?void 0:t.duration)!=null?r:600,easing:t==null?void 0:t.easing})}set(e){let{center:t=this.center,zoomLevel:r=this.zoomLevel,bearing:n=this.bearing,pitch:a=this.pitch}=e,o=[t.longitude,t.latitude];M(this,Ui).camera.setCenter(o),M(this,Ui).camera.setZoomLevel(r),M(this,Ui).camera.setBearing(n),M(this,Ui).camera.setPitch(a)}get center(){let e=M(this,Ui).camera.center;return new vr(e[1],e[0],void 0)}get zoomLevel(){return M(this,Ui).camera.zoomLevel}get pitch(){return M(this,Ui).camera.pitch}get minPitch(){return M(this,Ui).camera.minPitch}get maxPitch(){return M(this,Ui).camera.maxPitch}get bearing(){let e=M(this,Ui).camera.bearing;return(e<0?e+360:e)%360}get minZoomLevel(){return M(this,Ui).camera.minZoomLevel}get maxZoomLevel(){return M(this,Ui).camera.maxZoomLevel}};Ui=new WeakMap,h(tK,"Camera");var Uve=tK;R();R();R();R();R();R();R();R();function iK(i){let e=+this._x.call(null,i),t=+this._y.call(null,i);return ZE(this.cover(e,t),e,t,i)}h(iK,"default");function ZE(i,e,t,r){if(isNaN(e)||isNaN(t))return i;var n,a=i._root,o={data:r},s=i._x0,l=i._y0,u=i._x1,c=i._y1,p,d,m,g,b,x,v,w;if(!a)return i._root=o,i;for(;a.length;)if((b=e>=(p=(s+u)/2))?s=p:u=p,(x=t>=(d=(l+c)/2))?l=d:c=d,n=a,!(a=a[v=x<<1|b]))return n[v]=o,i;if(m=+i._x.call(null,a.data),g=+i._y.call(null,a.data),e===m&&t===g)return o.next=a,n?n[v]=o:i._root=o,i;do n=n?n[v]=new Array(4):i._root=new Array(4),(b=e>=(p=(s+u)/2))?s=p:u=p,(x=t>=(d=(l+c)/2))?l=d:c=d;while((v=x<<1|b)===(w=(g>=d)<<1|m>=p));return n[w]=a,n[v]=o,i}h(ZE,"add");function rK(i){var e,t,r=i.length,n,a,o=new Array(r),s=new Array(r),l=1/0,u=1/0,c=-1/0,p=-1/0;for(t=0;t<r;++t)isNaN(n=+this._x.call(null,e=i[t]))||isNaN(a=+this._y.call(null,e))||(o[t]=n,s[t]=a,n<l&&(l=n),n>c&&(c=n),a<u&&(u=a),a>p&&(p=a));if(l>c||u>p)return this;for(this.cover(l,u).cover(c,p),t=0;t<r;++t)ZE(this,o[t],s[t],i[t]);return this}h(rK,"addAll");R();function nK(i,e){if(isNaN(i=+i)||isNaN(e=+e))return this;var t=this._x0,r=this._y0,n=this._x1,a=this._y1;if(isNaN(t))n=(t=Math.floor(i))+1,a=(r=Math.floor(e))+1;else{for(var o=n-t||1,s=this._root,l,u;t>i||i>=n||r>e||e>=a;)switch(u=(e<r)<<1|i<t,l=new Array(4),l[u]=s,s=l,o*=2,u){case 0:n=t+o,a=r+o;break;case 1:t=n-o,a=r+o;break;case 2:n=t+o,r=a-o;break;case 3:t=n-o,r=a-o;break}this._root&&this._root.length&&(this._root=s)}return this._x0=t,this._y0=r,this._x1=n,this._y1=a,this}h(nK,"default");R();function aK(){var i=[];return this.visit(function(e){if(!e.length)do i.push(e.data);while(e=e.next)}),i}h(aK,"default");R();function oK(i){return arguments.length?this.cover(+i[0][0],+i[0][1]).cover(+i[1][0],+i[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}h(oK,"default");R();R();function sn(i,e,t,r,n){this.node=i,this.x0=e,this.y0=t,this.x1=r,this.y1=n}h(sn,"default");function sK(i,e,t){var r,n=this._x0,a=this._y0,o,s,l,u,c=this._x1,p=this._y1,d=[],m=this._root,g,b;for(m&&d.push(new sn(m,n,a,c,p)),t==null?t=1/0:(n=i-t,a=e-t,c=i+t,p=e+t,t*=t);g=d.pop();)if(!(!(m=g.node)||(o=g.x0)>c||(s=g.y0)>p||(l=g.x1)<n||(u=g.y1)<a))if(m.length){var x=(o+l)/2,v=(s+u)/2;d.push(new sn(m[3],x,v,l,u),new sn(m[2],o,v,x,u),new sn(m[1],x,s,l,v),new sn(m[0],o,s,x,v)),(b=(e>=v)<<1|i>=x)&&(g=d[d.length-1],d[d.length-1]=d[d.length-1-b],d[d.length-1-b]=g)}else{var w=i-+this._x.call(null,m.data),_=e-+this._y.call(null,m.data),C=w*w+_*_;if(C<t){var E=Math.sqrt(t=C);n=i-E,a=e-E,c=i+E,p=e+E,r=m.data}}return r}h(sK,"default");R();function lK(i){if(isNaN(c=+this._x.call(null,i))||isNaN(p=+this._y.call(null,i)))return this;var e,t=this._root,r,n,a,o=this._x0,s=this._y0,l=this._x1,u=this._y1,c,p,d,m,g,b,x,v;if(!t)return this;if(t.length)for(;;){if((g=c>=(d=(o+l)/2))?o=d:l=d,(b=p>=(m=(s+u)/2))?s=m:u=m,e=t,!(t=t[x=b<<1|g]))return this;if(!t.length)break;(e[x+1&3]||e[x+2&3]||e[x+3&3])&&(r=e,v=x)}for(;t.data!==i;)if(n=t,!(t=t.next))return this;return(a=t.next)&&delete t.next,n?(a?n.next=a:delete n.next,this):e?(a?e[x]=a:delete e[x],(t=e[0]||e[1]||e[2]||e[3])&&t===(e[3]||e[2]||e[1]||e[0])&&!t.length&&(r?r[v]=t:this._root=t),this):(this._root=a,this)}h(lK,"default");function uK(i){for(var e=0,t=i.length;e<t;++e)this.remove(i[e]);return this}h(uK,"removeAll");R();function hK(){return this._root}h(hK,"default");R();function cK(){var i=0;return this.visit(function(e){if(!e.length)do++i;while(e=e.next)}),i}h(cK,"default");R();function pK(i){var e=[],t,r=this._root,n,a,o,s,l;for(r&&e.push(new sn(r,this._x0,this._y0,this._x1,this._y1));t=e.pop();)if(!i(r=t.node,a=t.x0,o=t.y0,s=t.x1,l=t.y1)&&r.length){var u=(a+s)/2,c=(o+l)/2;(n=r[3])&&e.push(new sn(n,u,c,s,l)),(n=r[2])&&e.push(new sn(n,a,c,u,l)),(n=r[1])&&e.push(new sn(n,u,o,s,c)),(n=r[0])&&e.push(new sn(n,a,o,u,c))}return this}h(pK,"default");R();function dK(i){var e=[],t=[],r;for(this._root&&e.push(new sn(this._root,this._x0,this._y0,this._x1,this._y1));r=e.pop();){var n=r.node;if(n.length){var a,o=r.x0,s=r.y0,l=r.x1,u=r.y1,c=(o+l)/2,p=(s+u)/2;(a=n[0])&&e.push(new sn(a,o,s,c,p)),(a=n[1])&&e.push(new sn(a,c,s,l,p)),(a=n[2])&&e.push(new sn(a,o,p,c,u)),(a=n[3])&&e.push(new sn(a,c,p,l,u))}t.push(r)}for(;r=t.pop();)i(r.node,r.x0,r.y0,r.x1,r.y1);return this}h(dK,"default");R();function fK(i){return i[0]}h(fK,"defaultX");function mK(i){return arguments.length?(this._x=i,this):this._x}h(mK,"default");R();function gK(i){return i[1]}h(gK,"defaultY");function yK(i){return arguments.length?(this._y=i,this):this._y}h(yK,"default");function YE(i,e,t){var r=new r_(e??fK,t??gK,NaN,NaN,NaN,NaN);return i==null?r:r.addAll(i)}h(YE,"quadtree");function r_(i,e,t,r,n,a){this._x=i,this._y=e,this._x0=t,this._y0=r,this._x1=n,this._y1=a,this._root=void 0}h(r_,"Quadtree");function DS(i){for(var e={data:i.data},t=e;i=i.next;)t=t.next={data:i.data};return e}h(DS,"leaf_copy");var Tn=YE.prototype=r_.prototype;Tn.copy=function(){var i=new r_(this._x,this._y,this._x0,this._y0,this._x1,this._y1),e=this._root,t,r;if(!e)return i;if(!e.length)return i._root=DS(e),i;for(t=[{source:e,target:i._root=new Array(4)}];e=t.pop();)for(var n=0;n<4;++n)(r=e.source[n])&&(r.length?t.push({source:r,target:e.target[n]=new Array(4)}):e.target[n]=DS(r));return i};Tn.add=iK;Tn.addAll=rK;Tn.cover=nK;Tn.data=aK;Tn.extent=oK;Tn.find=sK;Tn.remove=lK;Tn.removeAll=uK;Tn.root=hK;Tn.size=cK;Tn.visit=pK;Tn.visitAfter=dK;Tn.x=mK;Tn.y=yK;R();R();var vK=class{constructor({origin:e,destination:t,distance:r=0,angle:n=0,pathWeight:a=0}){Z(this,"origin");Z(this,"destination");Z(this,"distance");Z(this,"angle");Z(this,"weight");this.origin=e,this.destination=t,this.distance=r,this.angle=n;let o=a||0;if(this.weight=o>=0?this.distance+o:0,isNaN(this.angle))throw new Error("nan angle")}};h(vK,"Edge");var kS=vK;R();R();R();function xK(i,e,t){if(t===void 0&&(t={}),!i)throw new Error("point is required");if(!e)throw new Error("polygon is required");var r=Nl(i),n=sJ(e),a=n.type,o=e.bbox,s=n.coordinates;if(o&&_K(r,o)===!1)return!1;a==="Polygon"&&(s=[s]);for(var l=!1,u=0;u<s.length&&!l;u++)if(RS(r,s[u][0],t.ignoreBoundary)){for(var c=!1,p=1;p<s[u].length&&!c;)RS(r,s[u][p],!t.ignoreBoundary)&&(c=!0),p++;c||(l=!0)}return l}h(xK,"booleanPointInPolygon");function RS(i,e,t){var r=!1;e[0][0]===e[e.length-1][0]&&e[0][1]===e[e.length-1][1]&&(e=e.slice(0,e.length-1));for(var n=0,a=e.length-1;n<e.length;a=n++){var o=e[n][0],s=e[n][1],l=e[a][0],u=e[a][1],c=i[1]*(o-l)+s*(l-i[0])+u*(i[0]-o)===0&&(o-i[0])*(l-i[0])<=0&&(s-i[1])*(u-i[1])<=0;if(c)return!t;var p=s>i[1]!=u>i[1]&&i[0]<(l-o)*(i[1]-s)/(u-s)+o;p&&(r=!r)}return r}h(RS,"inRing");function _K(i,e){return e[0]<=i[0]&&e[1]<=i[1]&&e[2]>=i[0]&&e[3]>=i[1]}h(_K,"inBBox");R();R();function Uu([i,e],[t,r]){let n=e-r,a=i-t;return(Math.atan2(a,n)+Math.PI*3)%(Math.PI*2)}h(Uu,"getAngle");R();var Vve=63710088e-1;function yp(i,e){let[t,r]=i.map(c=>c*Math.PI/180),[n,a]=e.map(c=>c*Math.PI/180),o=a-r,s=n-t,l=Math.sin(o/2)*Math.sin(o/2)+Math.cos(r)*Math.cos(a)*Math.sin(s/2)*Math.sin(s/2),u=2*Math.atan2(Math.sqrt(l),Math.sqrt(1-l));return Vve*u}h(yp,"getDistance");R();R();function Hy(i,e,t,r){let[n,a]=i,[o,s]=e,[l,u]=t,[c,p]=r;if(a===s&&n===o||u===p&&l===c)return null;let d=(c-l)*(s-a)-(p-u)*(o-n);if(d===0)return null;let m=((p-u)*(n-l)-(c-l)*(a-u))/d,g=((s-a)*(n-l)-(o-n)*(a-u))/d;if(m<0||m>1||g<0||g>1)return null;let b=a+m*(s-a);return[n+m*(o-n),b]}h(Hy,"getLineIntersection");R();function FS(i,e,t,r){let n=Am(i,t/1e3,r),a=Am(e,t/1e3,r);return[n.geometry.coordinates,a.geometry.coordinates]}h(FS,"getOffsetLine");R();function zS(i){let e=i*(180/Math.PI);return e=e%360,e>180?e-=360:e<-180&&(e+=360),Object.is(e,-0)?0:e}h(zS,"radToDegNormalized");function bK(i,e,t=[],r=0){let n=!0,a=i.geometry.coordinates,o=e.geometry.coordinates,s=zS(Uu(a,o)-Math.PI/2),l=zS(Uu(a,o)+Math.PI/2);return t.forEach(u=>{if(r>0){let c=FS(a,o,r,s),p=FS(a,o,r,l);if(Hy(c[0],c[1],u[0],u[1])||Hy(p[0],p[1],u[0],u[1])){n=!1;return}}else if(Hy(a,o,u[0],u[1])){n=!1;return}}),n}h(bK,"hasLineOfSight");var xc,Gy,BS,OS,wK,NS,SK,$S,MK,US,CK,VS,EK,jS,TK,HS,PK=class{constructor({nodes:e,groupBy:t}){fe(this,Gy),fe(this,OS),fe(this,NS),fe(this,$S),fe(this,US),fe(this,VS),fe(this,jS),ie(this,"edges",{}),ie(this,"nodesById"),ie(this,"nodesByGroup",new Map),fe(this,xc,void 0),fe(this,HS,h((n,a)=>{let o=0;for(let s of a)(!s[M(this,xc)]||s[M(this,xc)]===n.properties[M(this,xc)])&&xK(n.geometry.coordinates,s.geometry.geometry)&&(o+=Math.max(0,s.cost));return o},"#getZonalCost")),ke(this,xc,t);let{features:r}=e;this.nodesById=Ot(this,OS,wK).call(this,r),Ot(this,NS,SK).call(this),Ot(this,$S,MK).call(this,r,t)}getShortestEuclideanDistance(e,t){return t.reduce((r,n)=>{let a=yp(e.geometry.coordinates,n.geometry.coordinates);return Math.min(r,a)},Number.MAX_VALUE)}aStar({originIds:e,destinationNodeIds:t,excludedNodeIds:r,zones:n}){let a=Ot(this,Gy,BS).call(this,e),o=Ot(this,Gy,BS).call(this,t);if(a.length===0||o.length===0)return[];let{frontier:s,cameFrom:l,costSoFar:u}=Ot(this,US,CK).call(this,a,o);for(;s.length>0;){let c=s.shift();if(!c)break;if(Ot(this,VS,EK).call(this,c.origin,o))return Ot(this,jS,TK).call(this,l,c.origin.properties.id);for(let p of this.edges[c.origin.properties.id]){let d=u[c.origin.properties.id]+p.weight+M(this,HS).call(this,p.destination,n);if(!(d===1/0||r!=null&&r.has(p.destination.properties.id))&&(u[p.destination.properties.id]==null||d<u[p.destination.properties.id])){let m=d+this.getShortestEuclideanDistance(p.destination,o);u[p.destination.properties.id]=d,l[p.destination.properties.id]=p,s.push({origin:p.destination,priority:m})}}s.sort((p,d)=>p.priority-d.priority)}return[]}};xc=new WeakMap,Gy=new WeakSet,BS=h(function(i){return i.map(e=>this.nodesById[e]).filter(Boolean)},"#filterValidNodes"),OS=new WeakSet,wK=h(function(i){return i.reduce((e,t)=>(e[t.properties.id]=t,e),{})},"#createNodesById"),NS=new WeakSet,SK=h(function(){for(let i in this.nodesById)this.nodesById.hasOwnProperty(i)&&(this.nodesById[i].properties.neighbors=this.nodesById[i].properties.neighbors.filter(({id:e})=>!!this.nodesById[e]))},"#removeInvalidNeighbors"),$S=new WeakSet,MK=h(function(i,e){i.forEach(t=>{let r=e==="default"?e:t.properties[e];this.nodesByGroup.has(r)||this.nodesByGroup.set(r,[]),this.nodesByGroup.get(r).push(t),this.edges[t.properties.id]=t.properties.neighbors.map(({id:n,weight:a})=>{let o=this.nodesById[n],s=yp(t.geometry.coordinates,o.geometry.coordinates),l=Uu(t.geometry.coordinates,o.geometry.coordinates);return new kS({origin:t,destination:o,pathWeight:a,distance:s,angle:l})})})},"#initializeEdgesAndGroups"),US=new WeakSet,CK=h(function(i,e){let t=[],r={},n={};return i.forEach(a=>{let o=this.getShortestEuclideanDistance(a,e);t.push({origin:a,priority:o}),r[a.properties.id]=null,n[a.properties.id]=0}),t.sort((a,o)=>a.priority-o.priority),{frontier:t,cameFrom:r,costSoFar:n}},"#initializeSearch"),VS=new WeakSet,EK=h(function(i,e){return e.some(t=>t.properties.id===i.properties.id)},"#isDestinationNode"),jS=new WeakSet,TK=h(function(i,e){let t=[],r=i[e];for(;r;)t.push(r),r=i[r.origin.properties.id];return t.reverse()},"#reconstructPath"),HS=new WeakMap,h(PK,"NavigationGraph");var jve=PK,Hve=.4,AK=class{constructor({nodes:e,obstructions:t,groupBy:r="default"}){Z(this,"groupBy");Z(this,"graph");Z(this,"geometryEdgesByMapId",new Map);Z(this,"cache",{nodeTreesByGroup:new Map});Z(this,"findNearestNode",e=>{var t;let r=this.groupBy==="default"?this.groupBy:e.properties[this.groupBy];if(!this.cache.nodeTreesByGroup.has(r)){let n=(t=this.graph.nodesByGroup.get(r))!=null?t:[],a=YE();a.x(o=>o.geometry.coordinates[1]),a.y(o=>o.geometry.coordinates[0]),a.addAll(n),this.cache.nodeTreesByGroup.set(r,a)}return this.cache.nodeTreesByGroup.get(r).find(e.geometry.coordinates[1],e.geometry.coordinates[0])||null});Z(this,"generatePath",e=>{let{destination:t}=e[e.length-1],r={type:"FeatureCollection",features:[]};for(let a=0;a<e.length;a++){let{origin:o}=e[a],s={id:o.properties.id,angle:e[a].angle,distance:e[a].distance};this.groupBy!=="default"&&(s.groupBy=o.properties[this.groupBy]),r.features.push({type:"Feature",geometry:{type:"Point",coordinates:[o.geometry.coordinates[0],o.geometry.coordinates[1]]},properties:s})}let n={id:t.properties.id};return this.groupBy!=="default"&&(n.groupBy=t.properties[this.groupBy]),r.features.push({type:"Feature",geometry:{type:"Point",coordinates:[t.geometry.coordinates[0],t.geometry.coordinates[1]]},properties:n}),r});Z(this,"getDistance",(e,t)=>yp(e,t));Z(this,"getAngle",(e,t)=>Uu(e,t));this.groupBy=r,this.graph=new jve({nodes:e,groupBy:this.groupBy}),t&&t.features.forEach(n=>{let a=n.geometry.coordinates.length===1?n.geometry.coordinates[0]:n.geometry.coordinates,o=this.groupBy==="default"?this.groupBy:n.properties[this.groupBy];this.geometryEdgesByMapId.has(o)||this.geometryEdgesByMapId.set(o,[]),a.forEach((s,l)=>{this.geometryEdgesByMapId.get(o).push([s,a[l+1]||a[0]])})})}getDirections({zones:e,originIds:t,destinationNodeIds:r,excludedNodeIds:n,simplify:a}){var o,s;let l=(o=a==null?void 0:a.enabled)!=null?o:!0,u=e??[],c=this.graph.aStar({originIds:t,destinationNodeIds:r,zones:u,excludedNodeIds:new Set(n)});return c.length===0?{type:"FeatureCollection",features:[]}:(l&&(c=this.simplifyAllSteps(c,(s=a==null?void 0:a.bufferRadius)!=null?s:Hve)),this.generatePath(c))}simplifyAllSteps(e,t){var r,n;let a=[],o=[e[0]];for(let c=1;c<e.length;c++){if(this.groupBy!=="default"&&e[c].origin.properties[this.groupBy]!==e[c-1].origin.properties[this.groupBy]){let p=e[c-1].origin.properties[this.groupBy],d=(r=this.geometryEdgesByMapId.get(p))!=null?r:[];a.push(...this.simplifySteps(o,d,t)),o=[e[c]]}o.push(e[c])}let s=e[e.length-1],l=this.groupBy==="default"?this.groupBy:s.origin.properties[this.groupBy],u=(n=this.geometryEdgesByMapId.get(l))!=null?n:[];return a.push(...this.simplifySteps(o,u,t)),a}simplifySteps(e,t,r){if(e.length<3)return e;let n=[e[0]],a=1;for(let o=a+2;o<e.length;o++)if(!bK(e[a].origin,e[o].origin,t,r)){let s=o-1;n.push(new kS({...e[a],destination:e[s].origin,distance:yp(e[a].origin.geometry.coordinates,e[s].origin.geometry.coordinates),angle:Uu(e[a].origin.geometry.coordinates,e[s].origin.geometry.coordinates)})),a=s}return n.push(new kS({...e[a],destination:e[e.length-1].origin,distance:yp(e[a].origin.geometry.coordinates,e[e.length-1].origin.geometry.coordinates),angle:Uu(e[a].origin.geometry.coordinates,e[e.length-1].origin.geometry.coordinates)}),e[e.length-1]),n}};h(AK,"Navigator");var Gve=AK;R();function vp(i){return[i.longitude,i.latitude]}h(vp,"convertCoordinateToPosition");function IK(i){return new Map(i.map(e=>{let{properties:t}=e,{id:r}=t;return[r,e]}))}h(IK,"getEntranceMap");var aI=h((i,e)=>{let t=IK(e),r={type:"Feature",properties:{id:i[0].properties.id},geometry:{type:"MultiLineString",coordinates:[]}};for(let n of i){let a=[n.geometry.coordinates],o=(n.properties.entrances||[]).reduce((s,l)=>(t.has(l)&&s.push(t.get(l)),s),[]);o.length&&(a=EJ(n,o).map(s=>s.geometry.coordinates)),r.geometry.coordinates.push(...a)}return r},"cutEntrancesFromLineStrings");function LK(i,e){let t={options:{}};if(!t.options)throw new Error("options should exist");return i.appearance&&(t.options.appearance=i.appearance),i.rank!=null&&(i.rank==="initial"?t.options.rank=e.initialRank||2:t.options.rank=i.rank),i.enabled!==void 0&&(t.enabled=i.enabled),i.interactive!==null&&(t.options.interactive=i.interactive),t}h(LK,"translateLabelStateToGeojsonCore");function DK(i,e){let t={options:{}};if(!t.options)throw new Error("options should exist");return i.rank!=null&&(i.rank==="initial"?t.options.rank=e.initialRank||2:t.options.rank=i.rank),i.enabled!==void 0&&(t.enabled=i.enabled),i.interactive!==null&&(t.options.interactive=i.interactive),t}h(DK,"translateMarkerStateToGeojsonCore");function kK(i,e){let t={};return e==null||(i.color&&(i.color==="initial"?t.color=e.initialColor:t.color=i.color),i.hoverColor&&(t.hoverColor=i.hoverColor),i.interactive!==void 0&&(t.interactive=i.interactive),i.visible!==void 0&&(t.visible=i.visible)),t}h(kK,"translateSpaceStateToGeojsonCore");function RK(i,e){return((e-i+Math.PI)%(Math.PI*2)+Math.PI*2)%(Math.PI*2)-Math.PI}h(RK,"differenceBetweenAngles");function FK(i,e){let t="Left";return i<=-Math.PI/4?t="Right":i<=-e?t="SlightRight":i<=e?t="Straight":i<=Math.PI/4?t="SlightLeft":t="Left",t}h(FK,"getRelativeBearing");function zK(i){let e={};for(let t in i){let r=i[t];if(r!=null){if(r.id=t,"polygons"in r)for(let n of r.polygons)e[n]=r;else if("lineStrings"in r)for(let n of r.lineStrings)e[n]=r;else if("points"in r)for(let n of r.points)e[n]=r}}return e}h(zK,"extractStyleMap");function GS(i,e){return i.reduce((t,r)=>{let n=e[r.properties.id];return n==null||(t.has(n)||t.set(n,[]),t.get(n).push(r)),t},new Map)}h(GS,"groupGeometryByStyle");function xf(i,e={}){var t,r,n,a,o,s;let l={...i},u=(r=(t=e==null?void 0:e.style)==null?void 0:t.shading)!=null?r:e==null?void 0:e.shadingAndOutlines;if(u===!0?l.shading={start:.1,end:.15,intensity:.4}:typeof u=="object"&&(l.shading={start:u.start,end:u.end,intensity:u.intensity}),l.outline=(a=(n=e==null?void 0:e.style)==null?void 0:n.outlines)!=null?a:e==null?void 0:e.shadingAndOutlines,"lineStrings"in i){let c=(s=(o=e==null?void 0:e.style)==null?void 0:o.wallTopColor)!=null?s:e==null?void 0:e.wallTopColor;c!=null&&(l.topColor=c)}return l}h(xf,"translateToCoreStyle");var oI=Math.PI*.1,Ln,ys,Qa,WS,BK,Wy,U2,XS,sI,OK=class{constructor(e,t){fe(this,WS),fe(this,Wy),fe(this,XS),fe(this,Ln,{}),fe(this,ys,void 0),fe(this,Qa,void 0),ke(this,ys,t),ke(this,Qa,e.features),ke(this,ys,t),ke(this,Qa,e.features)}get coordinates(){return M(this,Ln).coordinates?M(this,Ln).coordinates:(M(this,Ln).coordinates=M(this,Qa).map(e=>new vr(e.geometry.coordinates[1],e.geometry.coordinates[0],e.properties.groupBy)),M(this,Ln).coordinates)}get distance(){return M(this,Ln).distance?M(this,Ln).distance:(M(this,Ln).distance=M(this,Qa).reduce((e,t)=>e+(t.properties.distance||0),0),M(this,Ln).distance)}get instructions(){if(M(this,Qa).length<2)return[];if(M(this,Ln).instructions)return M(this,Ln).instructions;let e=[],t=0;for(let r=0;r<M(this,Qa).length;r++){let n=M(this,Qa)[r],a=M(this,Qa)[r-1],o=M(this,Qa)[r+1],s=new vr(n.geometry.coordinates[1],n.geometry.coordinates[0],n.properties.groupBy),l=Ot(this,WS,BK).call(this,{prevDirection:a,direction:n,nextDirection:o});t+=(a==null?void 0:a.properties.distance)||0;for(let u of l)u&&(e.push({action:u,distance:t,coordinate:s}),t=0)}return M(this,Ln).instructions=e,M(this,Ln).instructions}};Ln=new WeakMap,ys=new WeakMap,Qa=new WeakMap,WS=new WeakSet,BK=h(function(i){let{prevDirection:e,direction:t,nextDirection:r}=i,n=e&&M(this,ys).getById("floor",e.properties.groupBy),a=M(this,ys).getById("floor",t.properties.groupBy),o=r&&M(this,ys).getById("floor",r.properties.groupBy),s=[];if(e||s.push({type:"Departure"}),o&&a.id!==o.id){let l=M(this,ys).getMVFFeatureByNodeId("connection",t.properties.id);s.push(Ot(this,Wy,U2).call(this,"TakeConnection",a,o,l==null?void 0:l.type))}else if(n&&n.id!==a.id){let l=M(this,ys).getMVFFeatureByNodeId("connection",t.properties.id);s.push(Ot(this,Wy,U2).call(this,"ExitConnection",a,n,l==null?void 0:l.type))}else s.push(Ot(this,XS,sI).call(this,e,t));return r||s.push({type:"Arrival"}),s},"#getActions"),Wy=new WeakSet,U2=h(function(i,e,t,r){let n=e.elevation-t.elevation,a="none";return n>0?a="down":n<0&&(a="up"),{type:i,fromFloor:e,toFloor:t,direction:a,connectionType:r??"stairs"}},"#createConnectionAction"),XS=new WeakSet,sI=h(function(i,e){let t=i?-RK(i.properties.angle,e.properties.angle):0;return Math.abs(t)>=oI?{type:"Turn",bearing:FK(t,oI),referencePosition:"At"}:null},"#createTurnAction"),h(OK,"Directions");var Wve=OK,NK=class{constructor({nodes:e,obstructions:t,connections:r,groupBy:n}){Z(this,"navigator");Z(this,"connections");Z(this,"getDirections",(e,t,r,n)=>{let{accessible:a,smoothing:{enabled:o,radius:s}}=r,l=e.flatMap(m=>this.getNodesFromTarget(m,n)),u=t.flatMap(m=>this.getNodesFromTarget(m,n)),c=this.getExcludedNodeIds(a).filter(m=>!l.includes(m)&&!u.includes(m)),p=this.navigator.getDirections({zones:r.zones.map(m=>{var g;return{geometry:m.geometry,cost:m.cost,map:(g=m.floor)==null?void 0:g.id}}),originIds:l,destinationNodeIds:u,excludedNodeIds:c,simplify:{enabled:o,bufferRadius:s}});this.addCoordinateDirections(p,e,t);let d=new Wve(p,n);if(!(d.distance===0&&new Set([...l,...u]).size===l.length+u.length))return d});Z(this,"getExcludedNodeIds",e=>e?this.connections.reduce((t,r)=>r.accessible?t:t.concat(r.nodes),[]):[]);Z(this,"addCoordinateDirections",(e,[t],[r])=>{if(e.features.length){if(vr.is(t)){let n=this.createDirectionFeature(t,this.navigator.getAngle([t.longitude,t.latitude],e.features[0].geometry.coordinates),this.navigator.getDistance([t.longitude,t.latitude],e.features[0].geometry.coordinates));e.features.splice(0,0,n)}if(vr.is(r)){let n=this.createDirectionFeature(r,0,0),a=e.features[e.features.length-1];a.properties.distance=this.navigator.getDistance(a.geometry.coordinates,[r.longitude,r.latitude]),a.properties.angle=this.navigator.getAngle(a.geometry.coordinates,[r.longitude,r.latitude]),e.features.push(n)}}});Z(this,"getNodesFromTarget",(e,t)=>{if(vr.is(e)){let r=this.navigator.findNearestNode(this.createCoordinateFeature(e));return r?[r.properties.id]:[]}else if(i_.is(e)){let r=this.navigator.findNearestNode(this.createCoordinateFeature(e.coordinate));return r?[r.properties.id]:[]}else if(Qx.is(e)){let r=this.navigator.findNearestNode(this.createCoordinateFeature(e.center));return r?[r.properties.id]:[]}else if(ih.is(e)){let r=t==null?void 0:t.getMVFFeatureById("space",e.id);return r==null?[]:r.properties.destinationNodes}else{if(t_.is(e))return e.coordinates.reduce((r,n)=>{let a=this.navigator.findNearestNode(this.createCoordinateFeature(n));return a&&r.push(a.properties.id),r},[]);if(rh.is(e)){let r=t==null?void 0:t.objectEntranceNodeIdsByObstructionId[e.id];return r??[]}else return[]}});Z(this,"createCoordinateFeature",e=>({type:"Feature",geometry:{type:"Point",coordinates:[e.longitude,e.latitude]},properties:{map:e.floorId}}));Z(this,"createDirectionFeature",(e,t,r)=>({type:"Feature",geometry:{type:"Point",coordinates:[e.longitude,e.latitude]},properties:{groupBy:e.floorId,id:e.id,angle:t,distance:r}}));this.navigator=new Gve({nodes:e,obstructions:this.createObstructionCollection(t),groupBy:n}),this.connections=r}createObstructionCollection(e){return{type:"FeatureCollection",features:Object.entries(e).reduce((t,[r,n])=>t.concat(n.features.map(a=>(a.properties.map=r,a))),[])}}};h(NK,"DirectionsInternal");var Xve=NK;R();var _f,$K=class{constructor({currentMapGetter:e}){fe(this,_f,void 0),ke(this,_f,e)}get currentMap(){return M(this,_f).call(this)}async getCurrentSceneGLTF(e){let t=M(this,_f).call(this);return t?t==null?void 0:t.Exporter.getCurrentSceneGLTF(e):(Ft.error("There is no map to export. Please load a map first."),new Blob)}};_f=new WeakMap,h($K,"Exporter");var qve=$K;R();var hs,Xy,UK=class{constructor({currentMapGetter:e}){fe(this,hs,new Map),fe(this,Xy,void 0),ke(this,Xy,e)}get currentMap(){return M(this,Xy).call(this)}getById(e){return M(this,hs).get(e)}add(e,t,r){let n=$u(e);if(!n)throw new Error("get coordinate failed");let a=this.currentMap;if(!a)throw new Error("currentMap should exist");let o=a.Labels.add(vp(n),t,{...r,floorId:n.floorId,rank:(r==null?void 0:r.rank)||"medium"}),s=new _S(o.id.toString(),t);return M(this,hs).set(s.id,{label:s,entityId:s.id}),s}all(){var e;let t=[];return(e=this.currentMap)==null||e.Labels.all({onCreate:(r,n)=>{let a=new _S(r.toString(),n);M(this,hs).set(a.id,{label:a,entityId:a.id}),t.push(a)}}),t}remove(e){var t;let r=M(this,hs).get(e.id);r&&((t=this.currentMap)==null||t.Labels.remove(r.entityId),M(this,hs).delete(e.id.toString()))}removeAll(){let e=[];return M(this,hs).forEach(({label:t})=>{this.remove(t),e.push(t),M(this,hs).delete(t.id.toString())}),e}};hs=new WeakMap,Xy=new WeakMap,h(UK,"Labels");var Zve=UK;R();R();var lI={altitude:0,height:1,color:"#ffffff",opacity:1,width:.15},VK=class{constructor(e,t,r,n,a,o){Z(this,"id");Z(this,"name");Z(this,"elevation");Z(this,"containerId");Z(this,"loaded",!1);Z(this,"styleMap",{});Z(this,"obstructions");Z(this,"entrances");Z(this,"spaces");Z(this,"renderer");Z(this,"options");Z(this,"layers",new Map);Z(this,"load",()=>{var e,t;if(this.loaded||this.obstructions==null&&this.spaces==null)return this;if(this.loaded=!0,this.spaces!=null&&this.spaces.features.length>0){let r=this.spaces.features.filter(s=>{var l;return s.geometry.type==="Polygon"&&((l=s.properties.kind)==null?void 0:l.toLowerCase())!=="void"}),n=GS(r,this.styleMap),a=this.renderer.addGroupContainer(`spaces-${this.id}`,{},this.id),o=0;for(let[s,l]of n){let u=this.renderer.addGeometryGroup(`Spaces-${this.id}-${o}`,{features:l},xf(s,this.options),a);o++;let c=u.id.toString();this.layers.set(s.id||c,u.id.toString())}}if(this.obstructions!=null&&this.obstructions.features.length>0){let r=this.obstructions.features.filter(d=>d.geometry.type==="Polygon"&&d.properties.kind==="object"),n=GS(r,this.styleMap),a=this.renderer.addGroupContainer(`objects-${this.id}`,{},this.id),o=0;for(let[d,m]of n){let g=this.renderer.addGeometryGroup(`Objects-${this.id}-${o}`,{features:m},xf(d,this.options),a);o++;let b=g.id.toString();this.layers.set(d.id||b,b)}let s=this.obstructions.features.filter(d=>d.geometry.type==="LineString"&&d.properties.kind==="Wall"&&d.properties.footprintComponent===!1),l=this.obstructions.features.filter(d=>d.geometry.type==="LineString"&&d.properties.kind==="Wall"&&d.properties.footprintComponent===!0),u=this.entrances,c=lI,p=lI;if(s!=null&&s.length>0){let d=this.styleMap[(e=s[0].properties)==null?void 0:e.id];d!=null&&(c={...d}),p=c;let m=this.renderer.addGeometryGroup(`Walls-${this.id}`,{features:[aI(s,(u==null?void 0:u.features)||[])]},xf(c,this.options),this.id),g=m.id.toString();this.layers.set(c.id||g,m.id.toString())}if(l!=null&&l.length>0){let d=this.styleMap[(t=l[0].properties)==null?void 0:t.id];d!=null&&(p={...d,id:Rv});let m=this.renderer.addGeometryGroup(`ExteriorWalls-${this.id}`,{features:[aI(l,(u==null?void 0:u.features)||[])]},xf(p,this.options),this.id),g=m.id.toString();this.layers.set(p.id||g,m.id.toString())}}return this.renderer.render(),this});this.id=t.id,this.options=n;let s=r.addGroupContainer(this.id,{visible:!1,interactive:!0},e);this.containerId=s.id.toString(),this.name=t.externalId,this.elevation=t.elevation,a!=null&&o!=null&&(this.styleMap=o,this.spaces=a.space[this.id],this.entrances=a.entrance[this.id],this.obstructions=a.obstruction[this.id]),this.renderer=r}};h(VK,"FloorObject");var Yve=VK,Gc=It(hg());R();R();R();R();(function(){typeof globalThis!="object"&&(Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__)})();R();R();R();var Jve="#ffffff",gu,jK=class{constructor(e={}){ie(this,"color",Jve),ie(this,"topColor"),ie(this,"opacity",1),fe(this,gu,void 0),ie(this,"outline",!0);var t,r;this.color=(t=e==null?void 0:e.color)!=null?t:this.color,this.topColor=e==null?void 0:e.topColor,this.opacity=(r=e==null?void 0:e.opacity)!=null?r:this.opacity,this.shading=e==null?void 0:e.shading,this.outline=(e==null?void 0:e.outline)!==void 0?!!e.outline:this.outline}get shading(){return M(this,gu)}set shading(e){var t;if(!e){ke(this,gu,void 0);return}ke(this,gu,(t=M(this,gu))!=null?t:{start:0,end:0,intensity:0}),Object.assign(M(this,gu),e)}};gu=new WeakMap,h(jK,"GeometryGroupStyleComponent");var qS=jK,HK=class extends rr{constructor(t,r=new qS){super();Z(this,"visible",!0);Z(this,"type","geometry-group");Z(this,"components");Z(this,"userData",{entityId:"",entities3D:new Set,opacity:1,dirty:!0,outlineDirty:!0,shadingDirty:!0});this.components=[r],this.userData.entityId=t}setVisible(t){this.visible=t,this.dispatchEvent({type:"childremoved",child:this})}getOpacity(){return this.userData.opacity}setOpacity(t){this.userData.opacity=t}removeEntity(){this.dispatchEvent({type:"childremoved",child:this})}};h(HK,"GeometryGroupObject3D");var ks=HK;R();var GK=class extends rr{};h(GK,"Geometry2DObject3D");var ZS=GK,WK=class{constructor(e,t){Z(this,"id");Z(this,"positionDirty",!0);Z(this,"object3d",new ZS);Z(this,"components");Z(this,"disposed",!1);Z(this,"worldPosition",new le);this.id=e.id||Cr(),this.components=[e],this.object3d=new ZS,this.object3d.position.copy(t),this.object3d.userData.entityId=this.id,this.object3d.userData.type=this.type}get type(){return this.components[0].type}get parent(){return this.object3d.parent}get position(){return this.object3d.getWorldPosition(this.worldPosition),this.worldPosition}};h(WK,"Geometry2D");var qp=WK;R();var XK=class extends rr{constructor(){super(...arguments);Z(this,"userData",{entityId:"",type:"geometry"})}};h(XK,"Geometry3DObject3D");var n_=XK,qK=class{constructor(e,t){Z(this,"id",Cr());Z(this,"components");this.components=[e,t]}get object3d(){return this.components[0].mesh}get parent(){var e;return(e=this.components[0].mesh)==null?void 0:e.parent}get type(){return this.components[0].type}};h(qK,"Geometry3D");var Vn=qK,ZK=class YS extends rr{constructor(t){super();Z(this,"childrenIds",new Set);Z(this,"type","group-container");Z(this,"userData",{entityId:"",entities2D:new Set,dirty:!0});Z(this,"components",[]);this.userData.entityId=t}addEntity(t){t instanceof YS?(this.childrenIds.add(t.userData.entityId),this.add(t)):t instanceof qp?(this.childrenIds.add(t.id),this.add(t.object3d),this.userData.entities2D.add(t.id)):t instanceof ks?(this.childrenIds.add(t.userData.entityId),this.add(t)):t instanceof Vn&&t.object3d&&(this.childrenIds.add(t.id),this.add(t.object3d)),this.dispatchEvent({type:"childadded",child:this})}removeEntity(t){t instanceof YS?(this.childrenIds.delete(t.userData.entityId),this.remove(t)):t instanceof qp?(this.childrenIds.delete(t.id),this.userData.entities2D.delete(t.id),this.remove(t.object3d)):t instanceof ks?(this.childrenIds.delete(t.userData.entityId),this.remove(t)):t instanceof Vn&&t.object3d&&(this.childrenIds.delete(t.id),this.add(t.object3d)),this.dispatchEvent({type:"childremoved",child:this})}setVisible(t){this.visible=t,this.dispatchEvent({type:"childremoved",child:this})}setAltitude(t){this.position.z=t,this.dispatchEvent({type:"childremoved",child:this})}get altitude(){return this.position.z}};h(ZK,"GroupContainerObject3D");var ca=ZK;R();var YK=!1;function JK(){YK=!0}h(JK,"enableTestMode");var KK=class{constructor(e,t=2){Z(this,"backgroundAlpha",1);Z(this,"backgroundColor",new Lt);Z(this,"width",0);Z(this,"height",0);Z(this,"options",{});Z(this,"renderer");try{this.options=e;let r={canvas:e.canvas,alpha:e.alpha||!1,stencil:!1,antialias:typeof e.antialias=="boolean"?e.antialias:!0,outputColorSpace:zn,powerPreference:"high-performance",preserveDrawingBuffer:!0};YK?(this.renderer={setSize:()=>{},state:{reset:()=>{}},properties:{get:()=>{}},getSize:()=>({width:window.innerWidth,height:innerHeight}),getDrawingBufferSize:()=>({width:window.innerWidth,height:innerHeight}),getClearAlpha:()=>1,getClearColor:()=>new Lt,autoUpdate:!0,shadowMap:{autoUpdate:!0},getContext:()=>({getContextAttributes(){return{alpha:!0,antialias:!1,depth:!0,stencil:!1}}}),setRenderTarget:()=>{},setClearColor:()=>{},clear:()=>{},render:()=>{},domElement:document.createElement("canvas"),capabilities:{isWebGL2:!0}},this.renderer.domElement.style.width="1920px",Object.defineProperty(this.renderer.domElement,"clientWidth",{value:1920}),this.renderer.domElement.style.height="1080px",Object.defineProperty(this.renderer.domElement,"clientHeight",{value:1080})):this.renderer=t===2?new nq(r):new oq(r),this.backgroundColor=new Lt,this.backgroundAlpha=1}catch(r){Ft.error(r),e.onWebGLRendererError&&e.onWebGLRendererError(r)}}destroy(){var e,t;this.renderer&&((t=(e=this.renderer).dispose)==null||t.call(e))}render(e,t){this.renderer&&(this.renderer.state.reset(),t.layers.enable(0),t.layers.enable(1),this.renderer.autoClear=!1,this.renderer.setRenderTarget(null),this.renderer.render(e,t),this.renderer.state.reset())}clear(){this.renderer&&(this.renderer.setClearColor(this.backgroundColor,this.backgroundAlpha),this.renderer.clear())}setBufferSize(e,t){hr.env.NODE_ENV==="test"||!this.renderer||(this.width=e,this.height=t,this.renderer.setSize(e,t,!1))}setBackgroundColor(e,t){this.backgroundColor=e,this.backgroundAlpha=t}domElement(){var e;return(e=this.renderer)==null?void 0:e.domElement}};h(KK,"Renderer");var Kve=KK;R();R();var Zp=63710088e-1,Qve=-85.051129,exe=85.051129,V2=1e4,uI={chain:"chain",cancel:"cancel"},hI=Math.PI*2,P1=100,txe=1e4,cI=0,pI=22,dI=["change","pan-start","pan-end","rotate-start","rotate-end","zoom-start","zoom-end","multi-start","multi-end","multi-cancel","pedestal-start","pedestal-change","pedestal-end","user-pan-start","user-pedestal-start","user-rotate-start","user-dolly-start","user-zoom-start","user-tilt-start","user-pan-end","user-pedestal-end","user-rotate-end","user-dolly-end","user-zoom-end","user-tilt-end","position-updated","zoom-updated","tilt-updated","rotation-updated"];R();var QK="mappedin";R();function eQ(i){let e=i.min,t=i.max,r=new le(e.x,e.y,e.z),n=new le(t.x,e.y,e.z),a=new le(e.x,t.y,e.z),o=new le(t.x,t.y,e.z);return[r,n,a,o]}h(eQ,"getCornersOfBoundingBox");R();function Wc(){return typeof window>"u"?1:Math.min(window.devicePixelRatio,2)}h(Wc,"getPixelRatio");R();function xp(i,e,t=!1){let r=null,n=0;return function(...a){n++,n===1&&t===!0&&i(...a);let o=h(()=>{(!t||n>1)&&i(...a),r=null,n=0},"later");clearTimeout(r),r=setTimeout(o,e)}}h(xp,"debounce");R();var ixe=(()=>{let i;return{getDeviceType(){if(i)return i;let{userAgent:e,platform:t,maxTouchPoints:r}=window.navigator,n=/(iphone|ipod|ipad)/i.test(e),a=t==="iPad"||t.indexOf("Mac")===0&&r>0&&!window.MSStream,o=/android/i.test(e);return i={isIpad:a,isMobile:o||n||a,isSafari12:/Version\/12.+Safari/.test(e),isFirefox:/Firefox/.test(e),isWindows:/windows/i.test(e)},i},_reset(){i=void 0}}})(),fI=ixe.getDeviceType,tQ=(()=>{let i,e,t;function r(){if(e!==void 0)return e;i||(i=document.createElement("canvas"));let a=i.getContext("webgl")||i.getContext("experimental-webgl");if(!a)return e;try{let o=fI().isFirefox?null:a.getExtension("WEBGL_debug_renderer_info");return e=o?a.getParameter(o.UNMASKED_RENDERER_WEBGL):a.getParameter(a.RENDERER),e}catch{let o=new Error("Failed getting device info");throw o.name="FailedGettingDeviceInfo",o}}h(r,"getInfo");function n(){var a,o;if(!fI().isWindows)return!1;if(t!==void 0)return t;let s=(o=(a=rxe())==null?void 0:a.toLowerCase())!=null?o:"";return t=s.includes("intel")&&(s.includes("uhd")||s.includes("iris")),t}return h(n,"shouldDisableOffscreenCanvas"),{getInfo:r,shouldDisableOffscreenCanvas:n,_setCanvas(a){i=a,e=void 0,t=void 0}}})(),rxe=tQ.getInfo,nxe=tQ.shouldDisableOffscreenCanvas;R();function JE(i,e,t,r){let n=i*(Math.PI/180),a=r/Zp,o=i+a*180/Math.PI,s=t/Zp/Math.cos(n),l=e+s*180/Math.PI;return{lat:o,lon:l}}h(JE,"cartesianToGeographic");function KE(i,e,t,r){let n=t*(Math.PI/180),a=r*(Math.PI/180),o=i*(Math.PI/180),s=e*(Math.PI/180),l=n-o,u=a-s,c=Zp*u*Math.cos(o),p=Zp*l;return{x:c,y:p}}h(KE,"geographicToCartesian");var iQ=h((i,e=[])=>{var t;if(i.children&&i.visible)for(let r of i.children){if(r.visible)if((t=r.userData)!=null&&t.entities3D&&r.type==="geometry-group"){e.push(r.userData.entityId);for(let n of r.userData.entities3D.values())e.push(n)}else(r.type==="group-container"||r.type==="custom-geometry"||r instanceof n_)&&e.push(r.userData.entityId);iQ(r,e)}return e},"extract3DEntitiesFromTree"),rQ=h((i,e)=>{var t;if(i.children&&i.visible&&!((t=i.userData)!=null&&t.hidden))for(let r of i.children)r.visible&&r instanceof ZS&&e.add(r.userData.entityId),rQ(r,e);return e},"extractEntitiesFromTree");function QE(i,e){for(let t in e){if(e[t]==null){i[t]=void 0;continue}typeof e[t]=="object"?QE(i[t],e[t]):i[t]=e[t]}return i}h(QE,"mergeObjects");function eT(i,e,t,r){let n={translateX:i.x,translateY:i.y,translateZ:i.z,scale:i.meterInMercatorCoordinateUnits()},a=new jt,o=new le(n.scale,-n.scale,n.scale),s=new jt().makeTranslation(n.translateX,n.translateY,n.translateZ).scale(o);return{id:QK,type:"custom",renderingMode:"3d",render:(l,u)=>{if(a.fromArray(u),t.elevation>0){let c=qr.fromLngLat(i.toLngLat(),t.elevation);s.makeTranslation(n.translateX,n.translateY,-c.z).scale(o)}e.projectionMatrix=a.multiply(s),r()}}}h(eT,"createCustomLayer");function nQ(i){return fetch(i,{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({grant_type:"client_credentials"})})}h(nQ,"fetchToken");async function aQ(i){let e=await nQ(i),{access_token:t}=await e.json();return{"x-mappedin-tiles-key":t}}h(aQ,"getRequestHeaders");function oQ(i,e=0){let t=3735928559^e,r=1103547991^e;for(let n=0,a;n<i.length;n++)a=i.charCodeAt(n),t=Math.imul(t^a,2654435761),r=Math.imul(r^a,1597334677);return t=Math.imul(t^t>>>16,2246822507)^Math.imul(r^r>>>13,3266489909),r=Math.imul(r^r>>>16,2246822507)^Math.imul(t^t>>>13,3266489909),4294967296*(2097151&r)+(t>>>0)}h(oQ,"cyrb53");var axe=h(i=>i,"linearEase");function yh(i,e,t,r,n,a=axe){i=Math.max(e,Math.min(i,t));let o=(i-Math.min(e,t))/Math.abs(t-e),s=a(o);return r+s*(n-r)}h(yh,"interpolate");function JS(i,e,t){let r=i*(Math.PI/180)/2,n=e/2;return t*Math.tan(r)/n}h(JS,"getProjectionScaleFactor");function bf(i,e){let t;return typeof e=="string"||typeof e=="number"?(t=i.entity2DMap.get(e),t==null&&(t=i.entity3DMap.get(e))):typeof(e==null?void 0:e.id)=="string"||typeof(e==null?void 0:e.id)=="number"?(t=i.entity2DMap.get(e.id),t==null&&(t=i.entity3DMap.get(e.id))):t=e,t}h(bf,"getGeometryByGeometryId");function sQ(i){return new zl(new Jt(i[0][0],i[0][1]),new Jt(i[1][0],i[1][1])).getCenter().toArray()}h(sQ,"getBoundingBoxCenter");function lQ(i){return Number.isFinite(i.min.x)&&Number.isFinite(i.min.y)&&Number.isFinite(i.max.x)&&Number.isFinite(i.max.y)&&(i instanceof Kye||Number.isFinite(i.min.z)&&Number.isFinite(i.max.z))}h(lQ,"isFiniteBox");R();R();var oxe=`"use strict";(()=>{function _(n,e){return e.x+e.w<n.x+n.w&&e.x>n.x&&e.y>n.y&&e.y+e.h<n.y+n.h}function A(n,e){let[t,o]=e;return t>=n.x&&t<=n.x+n.w&&o>=n.y&&o<=n.y+n.h}function j(n,e){let t=e.x,o=e.y,i=e.x+e.w,c=e.y+e.h,a=n.x,p=n.y,g=n.x+n.w,x=n.y+n.h;return t<g&&a<i&&o<x&&p<c}function u(n,e){for(let t=0;t<e.length;t++)n.push(e[t])}var I=4,r=class{x;y;w;h;userData;constructor(e,t,o,i,c){let a=typeof window>"u"?2:window.devicePixelRatio;this.userData=typeof c>"u"?null:c,this.x=e-I,this.y=t-I,this.w=o+I*Math.min(a,2),this.h=i+I*Math.min(a,2)}contains(e){return e===this?!1:_(this,e)}intersects(e){return j(this,e)}intersectsPoint(e){return A(this,e)}draw(e){e.fillStyle="rgba(123,222,26, 0.5)",e.fillRect(this.x,this.y,this.w,this.h)}};var T=class n{topLeft;topRight;bottomLeft;bottomRight;divided=!1;boundary;capacity=16;objects=[];parent;constructor(e,t){this.parent=t,this.boundary=e}getSize(){return this.divided?this.objects.length+this.topLeft.getSize()+this.topRight.getSize()+this.bottomLeft.getSize()+this.bottomRight.getSize():this.objects.length}subdivide(){let{x:e,y:t,w:o,h:i}=this.boundary;this.topLeft=new n(new r(e,t,o/2,i/2),this),this.topRight=new n(new r(e+o/2,t,o/2,i/2),this),this.bottomLeft=new n(new r(e,t+i/2,o/2,i/2),this),this.bottomRight=new n(new r(e+o/2,t+i/2,o/2,i/2),this),this.divided=!0}queryRect(e){let t=[];if(this.boundary.intersects(e))t.push(...this.objects);else return[];return this.divided&&(u(t,this.topLeft.queryRect(e)),u(t,this.topRight.queryRect(e)),u(t,this.bottomLeft.queryRect(e)),u(t,this.bottomRight.queryRect(e))),t}queryPoint(e){let t=[];if(this.boundary.intersectsPoint(e))t.push(...this.objects);else return[];return this.divided&&(u(t,this.topLeft.queryPoint(e)),u(t,this.topRight.queryPoint(e)),u(t,this.bottomLeft.queryPoint(e)),u(t,this.bottomRight.queryPoint(e))),t}insert(e){return this.boundary.contains(e)?this.objects.length<this.capacity?(this.objects.push(e),!0):(this.divided||this.subdivide(),(this.topLeft.insert(e)||this.topRight.insert(e)||this.bottomLeft.insert(e)||this.bottomRight.insert(e))===!1&&this.objects.push(e),!0):!1}drawObjects(e){this.objects.forEach(t=>t.draw(e)),this.divided&&(this.topLeft.drawObjects(e),this.topRight.drawObjects(e),this.bottomLeft.drawObjects(e),this.bottomRight.drawObjects(e))}draw(e){e.rect(this.boundary.x,this.boundary.y,this.boundary.w,this.boundary.h),this.divided&&(this.topLeft.draw(e),this.topRight.draw(e),this.bottomLeft.draw(e),this.bottomRight.draw(e)),e.strokeStyle="black",e.lineWidth=4,e.stroke()}};var d=200,P=10;function q(n,e,t,o,i,c="-1"){let a=1/0,p=1/0,g=-1/0,x=-1/0,W=new r(-P,0,5,t),X=new r(-P,0,e,5),O=new r(e-5,0,e+P,t),K=new r(0,t-5,e,t+P),Q=new r(0,t-i,o,i),Y=[W,X,O,K],D=new r(-d,-d,e+d*2,t+d*2);for(let s of n)for(let b=0;b<s.bboxes.length;b++){let{boundingBox:k}=s.bboxes[b],[h,w,l,m]=k,[S,y,N,F]=[s.y-h,s.y+w,s.x-l,s.x+m],L=N,v=S,E=F-N,M=y-S;a=Math.min(a,L)-d,p=Math.min(p,v)-d,g=Math.max(g,L+E)+d,x=Math.max(x,v+M)+d,s.bboxes[b].boundingRect=new r(L,v,E,M)}let f={msgId:c,colliders:new Array(n.length),debug:[]},C=new T(new r(a,p,g-a,x-p)),R;for(let s=0;s<n.length;s++)if(R=n[s],f.colliders[s]=[-1,!1],R.enabled){let[b,k,h]=[1/0,-1,void 0];for(let{index:w,boundingRect:l}of R.bboxes){let m=[];if(m=C.queryRect(l).filter(y=>l.intersects(y)),R.shouldCollideWithScreenEdges&&Y.forEach(y=>{l.intersects(y)&&m.push(y)}),l.intersects(Q)){f.colliders[s]=[w,!0,l];break}if(m.length<=b&&(h=l,k=w,b=m.length),m.length===0){C.insert(l),f.colliders[s]=[w,!D.contains(l),l];break}}R.rank===5&&h!=null&&(C.insert(h),f.colliders[s]=[k,!D.contains(h),h])}else f.colliders[s]=[-1,!1];return f}function z(n){let e=n[0].map(t=>{let o=t[0].map((i,c)=>({index:c,boundingBox:[i[0],i[1],i[2],i[3]]}));return{enabled:t[1]===1,rank:t[2]===1?5:0,x:t[3],y:t[4],bboxes:o}});return{msgId:"-1",totalWidth:n[3],totalHeight:n[2],watermarkWidth:n[4],watermarkHeight:n[5],colliders:e,devicePixelRatio:n[1]}}self.onmessage=n=>{let e=z(n.data);self.postMessage(q(e.colliders,e.totalWidth,e.totalHeight,e.watermarkWidth,e.watermarkHeight,e.msgId))};})();
`;R();R();R();R();R();function uQ(i,e){return e.x+e.w<i.x+i.w&&e.x>i.x&&e.y>i.y&&e.y+e.h<i.y+i.h}h(uQ,"contains");R();function hQ(i,e){let[t,r]=e;return t>=i.x&&t<=i.x+i.w&&r>=i.y&&r<=i.y+i.h}h(hQ,"intersectPoint");R();function cQ(i,e){let t=e.x,r=e.y,n=e.x+e.w,a=e.y+e.h,o=i.x,s=i.y,l=i.x+i.w,u=i.y+i.h;return t<l&&o<n&&r<u&&s<a}h(cQ,"intersects");R();function cs(i,e){for(let t=0;t<e.length;t++)i.push(e[t])}h(cs,"appendItems");R();var A1=4,pQ=class{constructor(e,t,r,n,a){Z(this,"x");Z(this,"y");Z(this,"w");Z(this,"h");Z(this,"userData");let o=typeof window>"u"?2:window.devicePixelRatio;this.userData=typeof a>"u"?null:a,this.x=e-A1,this.y=t-A1,this.w=r+A1*Math.min(o,2),this.h=n+A1*Math.min(o,2)}contains(e){return e===this?!1:uQ(this,e)}intersects(e){return cQ(this,e)}intersectsPoint(e){return hQ(this,e)}draw(e){e.fillStyle="rgba(123,222,26, 0.5)",e.fillRect(this.x,this.y,this.w,this.h)}};h(pQ,"Rectangle");var Ia=pQ,dQ=class wf{constructor(e,t){Z(this,"topLeft");Z(this,"topRight");Z(this,"bottomLeft");Z(this,"bottomRight");Z(this,"divided",!1);Z(this,"boundary");Z(this,"capacity",16);Z(this,"objects",[]);Z(this,"parent");this.parent=t,this.boundary=e}getSize(){return this.divided?this.objects.length+this.topLeft.getSize()+this.topRight.getSize()+this.bottomLeft.getSize()+this.bottomRight.getSize():this.objects.length}subdivide(){let{x:e,y:t,w:r,h:n}=this.boundary;this.topLeft=new wf(new Ia(e,t,r/2,n/2),this),this.topRight=new wf(new Ia(e+r/2,t,r/2,n/2),this),this.bottomLeft=new wf(new Ia(e,t+n/2,r/2,n/2),this),this.bottomRight=new wf(new Ia(e+r/2,t+n/2,r/2,n/2),this),this.divided=!0}queryRect(e){let t=[];if(this.boundary.intersects(e))t.push(...this.objects);else return[];return this.divided&&(cs(t,this.topLeft.queryRect(e)),cs(t,this.topRight.queryRect(e)),cs(t,this.bottomLeft.queryRect(e)),cs(t,this.bottomRight.queryRect(e))),t}queryPoint(e){let t=[];if(this.boundary.intersectsPoint(e))t.push(...this.objects);else return[];return this.divided&&(cs(t,this.topLeft.queryPoint(e)),cs(t,this.topRight.queryPoint(e)),cs(t,this.bottomLeft.queryPoint(e)),cs(t,this.bottomRight.queryPoint(e))),t}insert(e){return this.boundary.contains(e)?this.objects.length<this.capacity?(this.objects.push(e),!0):(this.divided||this.subdivide(),(this.topLeft.insert(e)||this.topRight.insert(e)||this.bottomLeft.insert(e)||this.bottomRight.insert(e))===!1&&this.objects.push(e),!0):!1}drawObjects(e){this.objects.forEach(t=>t.draw(e)),this.divided&&(this.topLeft.drawObjects(e),this.topRight.drawObjects(e),this.bottomLeft.drawObjects(e),this.bottomRight.drawObjects(e))}draw(e){e.rect(this.boundary.x,this.boundary.y,this.boundary.w,this.boundary.h),this.divided&&(this.topLeft.draw(e),this.topRight.draw(e),this.bottomLeft.draw(e),this.bottomRight.draw(e)),e.strokeStyle="black",e.lineWidth=4,e.stroke()}};h(dQ,"QuadTree");var Sf=dQ;R();R();var fQ=["","","low","medium","high","always-visible"];function tT(i){return Math.min(5,Math.max(2,i))}h(tT,"clampTierNumber");function a_(i){if(typeof i=="number")return tT(i);let e=fQ.indexOf(i);return e===-1?3:e}h(a_,"convertCollisionRankingTierToNumber");function Mf(i){let e=tT(i);return fQ[e]}h(Mf,"convertNumberToCollisionRankingTier");function mQ(i,e,t){let r,n,a,o=null,s=0;t||(t={});let l=h(function(){s=t.leading===!1?0:Date.now(),o=null,a=i.apply(r,n),o||(r=n=null)},"later");return function(){let u=Date.now();!s&&t.leading===!1&&(s=u);let c=e-(u-s);return r=globalThis,n=arguments,c<=0||c>e?(o&&(clearTimeout(o),o=null),s=u,a=i.apply(r,n),o||(r=n=null)):!o&&t.trailing!==!1&&(o=setTimeout(l,c)),a}}h(mQ,"throttle");function gQ(i){return[i.bboxes.map(e=>[e.boundingBox[0],e.boundingBox[1],e.boundingBox[2],e.boundingBox[3]]),i.enabled?1:0,i.rank===5?1:0,i.x,i.y]}h(gQ,"packCollider");var ru=!1,sxe=150,yQ=class extends Hr{constructor(t,r,n=new Worker(URL.createObjectURL(new Blob([oxe],{type:"text/javascript"})))){super();Z(this,"worker");Z(this,"debugContext");Z(this,"debugCanvas");Z(this,"dirty",!0);Z(this,"packedMessage",[[],0,0,0,0,0]);Z(this,"visibleCollidersQTree",new Sf(new Ia(0,0,0,0)));Z(this,"interactiveCollidersQTree",new Sf(new Ia(0,0,0,0)));Z(this,"coreState");Z(this,"postMessage");Z(this,"showCollisionBoxes",()=>{ru=!0,this.debugCanvas.style.display="block"});Z(this,"hideCollisionBoxes",()=>{ru=!1,this.debugContext.clearRect(0,0,this.debugCanvas.width,this.debugCanvas.height),this.debugCanvas.style.display="none"});Z(this,"currentMsgId","");Z(this,"working",!1);Z(this,"_postMessage",()=>{this.worker.postMessage(this.packedMessage)});Z(this,"componentArray",[]);Z(this,"update",(t,r)=>{if(this.dirty){this.packedMessage=[[],0,0,0,0,0],this.componentArray=new Array(this.coreState.entity2DIds.size);let n=0,a;for(let o of this.coreState.entity2DIds){let s=this.coreState.entity2DMap.get(o);s&&(a=s.components[0],this.componentArray[n]=a),n++}this.resize(t,r),this.dirty=!1,this.componentArray.sort((o,s)=>s.rank-o.rank)}else this.componentArray.filter(n=>n.collisionDirty===!0).length>0&&this.componentArray.sort((n,a)=>a.rank-n.rank);for(let n=0;n<this.componentArray.length;n++)this.packedMessage&&(this.componentArray[n].collisionDirty||this.packedMessage[0][n]==null?(this.packedMessage[0][n]=gQ(this.componentArray[n].toJSON()),this.componentArray[n].collisionDirty=!1):(this.packedMessage[0][n][1]=this.componentArray[n].enabled?1:0,this.packedMessage[0][n][2]=this.componentArray[n].rank===5?1:0,this.packedMessage[0][n][3]=this.componentArray[n].projection.x,this.packedMessage[0][n][4]=this.componentArray[n].projection.y));this.working||this.postMessage()});Z(this,"resolve",t=>{if(this.working=!1,this.dirty||!t.data)return;let r=t.data.colliders,n=-1,a=!1,o,s,l;ru&&(this.visibleCollidersQTree=new Sf(new Ia(0,0,this.debugCanvas.width,this.debugCanvas.height))),this.interactiveCollidersQTree=new Sf(new Ia(0,0,this.debugCanvas.width,this.debugCanvas.height));for(let u=0;u<this.componentArray.length;u++){let c=this.componentArray[u];r[u]==null||!c.enabled||([n,a,o]=r[u],n!==-1&&!a&&o!=null?(l=new Ia(o.x,o.y,o.w,o.h,{entityId:c.id}),ru&&this.visibleCollidersQTree.insert(l),s=this.coreState.entity2DMap.get(c.id),(s==null?void 0:s.components[1])!=null&&this.interactiveCollidersQTree.insert(new Ia(o.x,o.y,o.w,o.h,{entityId:c.id})),c.visible===!1&&(c.visible=!0,"visibilityNeedsUpdate"in c&&(c.visibilityNeedsUpdate=!0)),n!==-1&&n!==c.activeStrategyIndex&&(c.activeBoundingBox=l,c.onStrategySelected(n))):(c.visible===!0&&(c.visible=!1,"visibilityNeedsUpdate"in c&&(c.visibilityNeedsUpdate=!0)),n!==-1&&n!==c.activeStrategyIndex&&c.onStrategySelected(n)))}ru&&this.drawDebug(),this.publish("visibility-changed")});Z(this,"drawDebug",()=>{ru&&this.visibleCollidersQTree&&(this.debugContext.clearRect(0,0,this.debugCanvas.width,this.debugCanvas.height),this.debugContext.beginPath(),this.visibleCollidersQTree.drawObjects(this.debugContext))});Z(this,"destroy",()=>{this.worker.terminate()});this.coreState=r,this.debugCanvas=t,this.debugContext=t.getContext("2d"),this.worker=n,this.worker.onmessage=a=>this.resolve(a),this.postMessage=mQ(this._postMessage,sxe,!1),ru?this.showCollisionBoxes():this.hideCollisionBoxes()}resize(t,r){this.packedMessage[5]=r,this.packedMessage[4]=t,this.packedMessage[3]=this.debugCanvas.width,this.packedMessage[2]=this.debugCanvas.height}};h(yQ,"CollisionSystem");var lxe=yQ;R();R();R();R();var vQ=class{constructor(e){Z(this,"type");Z(this,"event");this.type=0,this.event=e}get timestamp(){return this.event.timeStamp}};h(vQ,"Tap");var uxe=vQ,xQ=class{constructor(){Z(this,"taps",[])}add(e){this.lastPointerDown&&e.timestamp-this.lastPointerDown.timestamp<50?this.lastPointerDown.type=1:this.taps.push(e)}get lastPointerDown(){return this.taps.length>=1?this.taps[this.taps.length-1]:void 0}get isSingleTapWithTwoFingers(){var e;return this.isSingleTap&&((e=this.lastPointerDown)==null?void 0:e.type)===1}get isSingleTapWithOneFinger(){var e;return this.isSingleTap&&((e=this.lastPointerDown)==null?void 0:e.type)===0}get isDoubleTapWithOneFinger(){var e,t;return this.isDoubleTap&&((e=this.taps[0])==null?void 0:e.type)===0&&((t=this.taps[1])==null?void 0:t.type)===0}get isSingleTap(){return this.taps.length===1}get isDoubleTap(){return this.taps.length===2}discardOutsideOfWaitWindow(e){this.taps=this.taps.filter(t=>e-t.timestamp<300)}flush(){this.taps=[]}get _taps(){return this.taps}destroy(){this.flush()}};h(xQ,"TapsController");var hxe=xQ;R();function _Q(i){let e=new Set;for(let t of i){let r=t.object;for(;r.parent&&!e.has(r.parent);)r=r.parent,r instanceof ca&&r.type==="group-container"&&r.visible&&r.components[1]&&e.add(r)}return Array.from(e)}h(_Q,"getUniqueIntersectedGroupContainers");function bQ(i,e){if(i==null||e==null)return i===e;if(i.length!==e.length)return!1;for(let t=0;t<i.length;t++)if(i[t]!==e[t])return!1;return!0}h(bQ,"arraysEqual");var Cf,wQ=class extends Hr{constructor(e,t,r,n){super(),ie(this,"raycaster",new ug),ie(this,"state",{hovered3DEntity:void 0,hovered2DEntity:void 0,hovered3DContainers:void 0,lastHover:void 0,containerOffset:[0,0],interaction:{mouseDownStart:void 0,distanceFromMouseDown:void 0,isPanning:!1}}),ie(this,"coreState"),ie(this,"camera"),ie(this,"cameraPlane"),ie(this,"_quadtree",new Sf(new Ia(0,0,0,0))),ie(this,"_container"),ie(this,"lastPointerEvent"),ie(this,"cursor","grab"),ie(this,"touchesCount",0),ie(this,"hasTouched",!1),fe(this,Cf,void 0),ie(this,"onPointerMoveRaf",s=>{this.lastPointerEvent=s,M(this,Cf)&&cancelAnimationFrame(M(this,Cf)),ke(this,Cf,requestAnimationFrame(()=>{this.onPointerMove(s)}))}),ie(this,"onPointerMove",s=>{s.preventDefault(),this.updateInteractionStateIfPanning(s),(s.pointerType!=="touch"||s.pointerType===void 0&&this.hasTouched)&&this.handleHover(s),this.handleCursor()}),ie(this,"tapsControl",new hxe),ie(this,"onPointerDown",s=>{s.target===this._container&&(this._container.addEventListener("pointerup",this.onPointerUp,!1),this._container.addEventListener("pointercancel",this.onPointerUp,!1),this.state.interaction.mouseDownStart={time:Date.now(),timestamp:s.timeStamp,clientX:s.clientX,clientY:s.clientY},this.lastPointerEvent=s,this.state.interaction.distanceFromMouseDown=0,this.handleCursor(),s.pointerType==="touch"&&(this.tapsControl.add(new uxe(s)),this.touchesCount=Math.max(0,this.touchesCount+1)))}),ie(this,"clickTimeout"),ie(this,"onPointerUp",s=>{this.tapsControl.discardOutsideOfWaitWindow(s.timeStamp),this.lastPointerEvent=s,this.touchesCount=Math.max(0,this.touchesCount-1),this.touchesCount===0&&(this._container.removeEventListener("pointerup",this.onPointerUp,!1),this._container.removeEventListener("pointercancel",this.onPointerUp,!1)),this.updateInteractionStateIfPanning(s);let{mouseDownStart:l}=this.state.interaction;!l||this.state.interaction.distanceFromMouseDown==null||(Date.now()<l.time+300&&(this.tapsControl.isSingleTapWithTwoFingers||this.state.interaction.distanceFromMouseDown<=15)&&(s.pointerType==="touch"?this.tapsControl.isSingleTapWithTwoFingers?(this.publish("singletap-with-twofinger",s),this.flush()):this.tapsControl.isSingleTapWithOneFinger&&this.touchesCount===0?(this.clickTimeout&&clearTimeout(this.clickTimeout),this.clickTimeout=window.setTimeout(()=>{this.handleClick(s),this.flush()},300)):this.tapsControl.isDoubleTapWithOneFinger&&(this.publish("doubletap-with-onefinger",s),this.flush()):this.handleClick(s)),this.state.interaction.mouseDownStart=void 0,this.state.interaction.distanceFromMouseDown=void 0,this.state.interaction.isPanning=!1,this.handleCursor())}),ie(this,"dirty3D",!0),ie(this,"cachedHitBoxes",{entities:[],groups:[]}),ie(this,"ndcPoint",new Oe),ie(this,"debugPanel"),this.raycaster.layers.enableAll(),this.raycaster.layers.disable(1);let{top:a,left:o}=e.getBoundingClientRect();this.state.containerOffset=[a,o],this.camera=r,this._container=e,this.coreState=t,this.cameraPlane=n,this._container.addEventListener("pointerdown",this.onPointerDown,!1),this._container.addEventListener("pointermove",this.onPointerMoveRaf,!1),this._container.classList.add("mappedin-interactive")}updateQuadtree(e){this._quadtree=e}setHovered3DEntityInteractionComponentDirty(){if(this.state.hovered3DEntity){let e=this.state.hovered3DEntity.components[2];e&&(e.dirty=!0)}}flush(){this.tapsControl.flush(),this.clickTimeout!=null&&(clearTimeout(this.clickTimeout),this.clickTimeout=void 0)}handleHover(e){let t=e||this.lastPointerEvent;if(this.state.interaction.mouseDownStart||!t)return;let{entity3D:r,entity2D:n,position:a,groupContainers:o}=this.intersect(t);(this.handle3DEntityHover(r)||this.handle2DEntityHover(n)||this.handle3DContainerHover(o))&&this.publish("hover",{entity2D:this.state.hovered2DEntity,entity3D:this.state.hovered3DEntity,position:a,groupContainers:o}),this.handleCursor()}handleCursor(){let e=!!(this.state.hovered3DEntity||this.state.hovered2DEntity),t=!!this.state.interaction.mouseDownStart,r=this.state.interaction.isPanning,n=SQ(e,r,t);this.cursor!==n&&(this.cursor=n,n==="pointer"?this._container.classList.add("mappedin-interaction-hover"):this._container.classList.remove("mappedin-interaction-hover"))}handle2DEntityHover(e){let t=this.state.hovered2DEntity!==e;return this.state.hovered2DEntity=e,t}handleClick(e){let t=this.intersect(e);this.publish("click",{entity2D:t.entity2D,entity3D:t.entity3D,position:t.position,groupContainers:t.groupContainers,pointerEvent:{button:e.button}})}get _hitBoxes(){if(this.dirty3D){this.cachedHitBoxes.entities=[],this.cachedHitBoxes.groups=[];let e;for(let t of this.coreState.threeDEntities)e=this.coreState.entity3DMap.get(t),((e==null?void 0:e.type)==="geometry"||(e==null?void 0:e.type)==="model")&&e.components[2]?e.components[0].mesh&&!this.cachedHitBoxes.entities.includes(e.components[0].mesh)&&this.cachedHitBoxes.entities.push(e.components[0].mesh):(e==null?void 0:e.type)==="group-container"&&e.components[1]&&!this.cachedHitBoxes.groups.includes(e)&&this.cachedHitBoxes.groups.push(e);return this.dirty3D=!1,this.cachedHitBoxes}return this.cachedHitBoxes}intersect(e){var t,r;let n=[e.offsetX,e.offsetY],a=this._quadtree.queryPoint(n),[o]=a.filter(b=>b.intersectsPoint(n)),s=this.state.containerOffset[0],l=this.state.containerOffset[1];this.ndcPoint.x=(e.clientX-l)/this._container.clientWidth*2-1,this.ndcPoint.y=-((e.clientY-s)/this._container.clientHeight)*2+1,this.raycaster.setFromCamera(this.ndcPoint,this.camera),this.raycaster.layers.enable(0);let[u]=this.getMouseRayIntersects(),c=this.raycaster.intersectObjects(this._hitBoxes.entities,!0).filter(b=>b.object.visible),[p]=c,d=(t=p==null?void 0:p.instanceId)!=null?t:p==null?void 0:p.batchId,m=this.raycaster.intersectObjects(this._hitBoxes.groups,!0).filter(b=>b.object.visible),g;return m!=null&&m.length>0&&(g=_Q(m)),{entity2D:((r=o==null?void 0:o.userData)==null?void 0:r.entityId)==="watermark"?{id:"watermark"}:this.coreState.entity2DMap.get(o==null?void 0:o.userData.entityId),entity3D:d!=null?this.coreState.entity3DMap.get(p==null?void 0:p.object.userData.entities[d]):this.coreState.entity3DMap.get(p==null?void 0:p.object.userData.entityId),position:u==null?void 0:u.point,groupContainers:g}}handle3DEntityHover(e){this.state.lastHover!==e&&(this.state.lastHover&&KS(this.state.lastHover,!1),e&&KS(e,!0));let t=this.state.hovered3DEntity!==e;return this.state.hovered3DEntity=e,this.state.lastHover=e,t}handle3DContainerHover(e){let t=!bQ(this.state.hovered3DContainers,e);return this.state.hovered3DContainers=e,t}updateInteractionStateIfPanning(e){this.state.interaction.mouseDownStart&&(this.state.interaction.distanceFromMouseDown=Math.sqrt(Math.pow(e.clientX-this.state.interaction.mouseDownStart.clientX,2)+Math.pow(e.clientY-this.state.interaction.mouseDownStart.clientY,2)),!this.state.interaction.isPanning&&this.state.interaction.distanceFromMouseDown>15&&(this.state.interaction.isPanning=!0))}getMouseRayIntersects(){return this.raycaster.intersectObjects([this.cameraPlane],!1)}destroy(){this._container.removeEventListener("pointerdown",this.onPointerDown,!1),this._container.removeEventListener("pointermove",this.onPointerMoveRaf,!1),this._container.removeEventListener("pointerup",this.onPointerUp,!1),this._container.removeEventListener("pointercancel",this.onPointerUp,!1)}enableDebug(){let e=document.createElement("div");e.style.position="absolute",e.style.top="0",e.style.right="0",e.style.backgroundColor="white",e.style.padding="10px",document.body.append(e),e.id="interaction-debug-panel",this.debugPanel=e,this.on("doubletap-with-onefinger",()=>{this.queueDebugMessage("doubletap-with-onefinger","#ffadad")}),this.on("singletap-with-twofinger",()=>{this.queueDebugMessage("singletap-with-twofinger","#ffd6a5")}),this.on("click",t=>{var r,n,a;this.queueDebugMessage(`CLICK 
3D: ${(r=t.entity3D)==null?void 0:r.id} 
2D: ${(n=t.entity2D)==null?void 0:n.id} 
Pos: ${(a=t.position)==null?void 0:a.toArray().join(", ")}`,"#fdffb6")}),this.on("hover",t=>{var r,n,a;this.queueDebugMessage(`HOVER 
3D: ${(r=t.entity3D)==null?void 0:r.id} 
2D: ${(n=t.entity2D)==null?void 0:n.id} 
Pos: ${(a=t.position)==null?void 0:a.toArray().join(", ")}`,"#caffbf")})}get _state(){return this.state}queueDebugMessage(e,t){var r;let n=document.createElement("pre");n.style.maxWidth="300px",n.style.transition="opacity 500ms cubic-bezier(0.4, 0, 0.2, 1)",n.style.backgroundColor=t,n.textContent=e,(r=this.debugPanel)==null||r.prepend(n),setTimeout(()=>{n.style.opacity="0",setTimeout(()=>{n.remove()},500)},2500)}getCursor(){return this.cursor}};Cf=new WeakMap,h(wQ,"InteractionSystem");var cxe=wQ;function KS(i,e){let t=i.components[2];t&&(t.hover=e,t.dirty=!0)}h(KS,"updateHover");function SQ(i,e,t){return e?"grabbing":i?"pointer":t?"grabbing":"grab"}h(SQ,"processCursor");R();R();R();function Im(i){"@babel/helpers - typeof";return Im=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Im(i)}h(Im,"_typeof");var pxe=/^\s+/,dxe=/\s+$/;function vt(i,e){if(i=i||"",e=e||{},i instanceof vt)return i;if(!(this instanceof vt))return new vt(i,e);var t=MQ(i);this._originalInput=i,this._r=t.r,this._g=t.g,this._b=t.b,this._a=t.a,this._roundA=Math.round(100*this._a)/100,this._format=e.format||t.format,this._gradientType=e.gradientType,this._r<1&&(this._r=Math.round(this._r)),this._g<1&&(this._g=Math.round(this._g)),this._b<1&&(this._b=Math.round(this._b)),this._ok=t.ok}h(vt,"tinycolor");vt.prototype={isDark:h(function(){return this.getBrightness()<128},"isDark"),isLight:h(function(){return!this.isDark()},"isLight"),isValid:h(function(){return this._ok},"isValid"),getOriginalInput:h(function(){return this._originalInput},"getOriginalInput"),getFormat:h(function(){return this._format},"getFormat"),getAlpha:h(function(){return this._a},"getAlpha"),getBrightness:h(function(){var i=this.toRgb();return(i.r*299+i.g*587+i.b*114)/1e3},"getBrightness"),getLuminance:h(function(){var i=this.toRgb(),e,t,r,n,a,o;return e=i.r/255,t=i.g/255,r=i.b/255,e<=.03928?n=e/12.92:n=Math.pow((e+.055)/1.055,2.4),t<=.03928?a=t/12.92:a=Math.pow((t+.055)/1.055,2.4),r<=.03928?o=r/12.92:o=Math.pow((r+.055)/1.055,2.4),.2126*n+.7152*a+.0722*o},"getLuminance"),setAlpha:h(function(i){return this._a=iT(i),this._roundA=Math.round(100*this._a)/100,this},"setAlpha"),toHsv:h(function(){var i=eM(this._r,this._g,this._b);return{h:i.h*360,s:i.s,v:i.v,a:this._a}},"toHsv"),toHsvString:h(function(){var i=eM(this._r,this._g,this._b),e=Math.round(i.h*360),t=Math.round(i.s*100),r=Math.round(i.v*100);return this._a==1?"hsv("+e+", "+t+"%, "+r+"%)":"hsva("+e+", "+t+"%, "+r+"%, "+this._roundA+")"},"toHsvString"),toHsl:h(function(){var i=QS(this._r,this._g,this._b);return{h:i.h*360,s:i.s,l:i.l,a:this._a}},"toHsl"),toHslString:h(function(){var i=QS(this._r,this._g,this._b),e=Math.round(i.h*360),t=Math.round(i.s*100),r=Math.round(i.l*100);return this._a==1?"hsl("+e+", "+t+"%, "+r+"%)":"hsla("+e+", "+t+"%, "+r+"%, "+this._roundA+")"},"toHslString"),toHex:h(function(i){return tM(this._r,this._g,this._b,i)},"toHex"),toHexString:h(function(i){return"#"+this.toHex(i)},"toHexString"),toHex8:h(function(i){return PQ(this._r,this._g,this._b,this._a,i)},"toHex8"),toHex8String:h(function(i){return"#"+this.toHex8(i)},"toHex8String"),toRgb:h(function(){return{r:Math.round(this._r),g:Math.round(this._g),b:Math.round(this._b),a:this._a}},"toRgb"),toRgbString:h(function(){return this._a==1?"rgb("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+")":"rgba("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+", "+this._roundA+")"},"toRgbString"),toPercentageRgb:h(function(){return{r:Math.round(Ri(this._r,255)*100)+"%",g:Math.round(Ri(this._g,255)*100)+"%",b:Math.round(Ri(this._b,255)*100)+"%",a:this._a}},"toPercentageRgb"),toPercentageRgbString:h(function(){return this._a==1?"rgb("+Math.round(Ri(this._r,255)*100)+"%, "+Math.round(Ri(this._g,255)*100)+"%, "+Math.round(Ri(this._b,255)*100)+"%)":"rgba("+Math.round(Ri(this._r,255)*100)+"%, "+Math.round(Ri(this._g,255)*100)+"%, "+Math.round(Ri(this._b,255)*100)+"%, "+this._roundA+")"},"toPercentageRgbString"),toName:h(function(){return this._a===0?"transparent":this._a<1?!1:fxe[tM(this._r,this._g,this._b,!0)]||!1},"toName"),toFilter:h(function(i){var e="#"+iM(this._r,this._g,this._b,this._a),t=e,r=this._gradientType?"GradientType = 1, ":"";if(i){var n=vt(i);t="#"+iM(n._r,n._g,n._b,n._a)}return"progid:DXImageTransform.Microsoft.gradient("+r+"startColorstr="+e+",endColorstr="+t+")"},"toFilter"),toString:h(function(i){var e=!!i;i=i||this._format;var t=!1,r=this._a<1&&this._a>=0,n=!e&&r&&(i==="hex"||i==="hex6"||i==="hex3"||i==="hex4"||i==="hex8"||i==="name");return n?i==="name"&&this._a===0?this.toName():this.toRgbString():(i==="rgb"&&(t=this.toRgbString()),i==="prgb"&&(t=this.toPercentageRgbString()),(i==="hex"||i==="hex6")&&(t=this.toHexString()),i==="hex3"&&(t=this.toHexString(!0)),i==="hex4"&&(t=this.toHex8String(!0)),i==="hex8"&&(t=this.toHex8String()),i==="name"&&(t=this.toName()),i==="hsl"&&(t=this.toHslString()),i==="hsv"&&(t=this.toHsvString()),t||this.toHexString())},"toString"),clone:h(function(){return vt(this.toString())},"clone"),_applyModification:h(function(i,e){var t=i.apply(null,[this].concat([].slice.call(e)));return this._r=t._r,this._g=t._g,this._b=t._b,this.setAlpha(t._a),this},"_applyModification"),lighten:h(function(){return this._applyModification(DQ,arguments)},"lighten"),brighten:h(function(){return this._applyModification(kQ,arguments)},"brighten"),darken:h(function(){return this._applyModification(RQ,arguments)},"darken"),desaturate:h(function(){return this._applyModification(AQ,arguments)},"desaturate"),saturate:h(function(){return this._applyModification(IQ,arguments)},"saturate"),greyscale:h(function(){return this._applyModification(LQ,arguments)},"greyscale"),spin:h(function(){return this._applyModification(FQ,arguments)},"spin"),_applyCombination:h(function(i,e){return i.apply(null,[this].concat([].slice.call(e)))},"_applyCombination"),analogous:h(function(){return this._applyCombination(OQ,arguments)},"analogous"),complement:h(function(){return this._applyCombination(zQ,arguments)},"complement"),monochromatic:h(function(){return this._applyCombination(NQ,arguments)},"monochromatic"),splitcomplement:h(function(){return this._applyCombination(BQ,arguments)},"splitcomplement"),triad:h(function(){return this._applyCombination(rM,[3])},"triad"),tetrad:h(function(){return this._applyCombination(rM,[4])},"tetrad")};vt.fromRatio=function(i,e){if(Im(i)=="object"){var t={};for(var r in i)i.hasOwnProperty(r)&&(r==="a"?t[r]=i[r]:t[r]=Xc(i[r]));i=t}return vt(i,e)};function MQ(i){var e={r:0,g:0,b:0},t=1,r=null,n=null,a=null,o=!1,s=!1;return typeof i=="string"&&(i=jQ(i)),Im(i)=="object"&&(Ao(i.r)&&Ao(i.g)&&Ao(i.b)?(e=CQ(i.r,i.g,i.b),o=!0,s=String(i.r).substr(-1)==="%"?"prgb":"rgb"):Ao(i.h)&&Ao(i.s)&&Ao(i.v)?(r=Xc(i.s),n=Xc(i.v),e=TQ(i.h,r,n),o=!0,s="hsv"):Ao(i.h)&&Ao(i.s)&&Ao(i.l)&&(r=Xc(i.s),a=Xc(i.l),e=EQ(i.h,r,a),o=!0,s="hsl"),i.hasOwnProperty("a")&&(t=i.a)),t=iT(t),{ok:o,format:i.format||s,r:Math.min(255,Math.max(e.r,0)),g:Math.min(255,Math.max(e.g,0)),b:Math.min(255,Math.max(e.b,0)),a:t}}h(MQ,"inputToRGB");function CQ(i,e,t){return{r:Ri(i,255)*255,g:Ri(e,255)*255,b:Ri(t,255)*255}}h(CQ,"rgbToRgb");function QS(i,e,t){i=Ri(i,255),e=Ri(e,255),t=Ri(t,255);var r=Math.max(i,e,t),n=Math.min(i,e,t),a,o,s=(r+n)/2;if(r==n)a=o=0;else{var l=r-n;switch(o=s>.5?l/(2-r-n):l/(r+n),r){case i:a=(e-t)/l+(e<t?6:0);break;case e:a=(t-i)/l+2;break;case t:a=(i-e)/l+4;break}a/=6}return{h:a,s:o,l:s}}h(QS,"rgbToHsl");function EQ(i,e,t){var r,n,a;i=Ri(i,360),e=Ri(e,100),t=Ri(t,100);function o(u,c,p){return p<0&&(p+=1),p>1&&(p-=1),p<1/6?u+(c-u)*6*p:p<1/2?c:p<2/3?u+(c-u)*(2/3-p)*6:u}if(h(o,"hue2rgb"),e===0)r=n=a=t;else{var s=t<.5?t*(1+e):t+e-t*e,l=2*t-s;r=o(l,s,i+1/3),n=o(l,s,i),a=o(l,s,i-1/3)}return{r:r*255,g:n*255,b:a*255}}h(EQ,"hslToRgb");function eM(i,e,t){i=Ri(i,255),e=Ri(e,255),t=Ri(t,255);var r=Math.max(i,e,t),n=Math.min(i,e,t),a,o,s=r,l=r-n;if(o=r===0?0:l/r,r==n)a=0;else{switch(r){case i:a=(e-t)/l+(e<t?6:0);break;case e:a=(t-i)/l+2;break;case t:a=(i-e)/l+4;break}a/=6}return{h:a,s:o,v:s}}h(eM,"rgbToHsv");function TQ(i,e,t){i=Ri(i,360)*6,e=Ri(e,100),t=Ri(t,100);var r=Math.floor(i),n=i-r,a=t*(1-e),o=t*(1-n*e),s=t*(1-(1-n)*e),l=r%6,u=[t,o,a,a,s,t][l],c=[s,t,t,o,a,a][l],p=[a,a,s,t,t,o][l];return{r:u*255,g:c*255,b:p*255}}h(TQ,"hsvToRgb");function tM(i,e,t,r){var n=[za(Math.round(i).toString(16)),za(Math.round(e).toString(16)),za(Math.round(t).toString(16))];return r&&n[0].charAt(0)==n[0].charAt(1)&&n[1].charAt(0)==n[1].charAt(1)&&n[2].charAt(0)==n[2].charAt(1)?n[0].charAt(0)+n[1].charAt(0)+n[2].charAt(0):n.join("")}h(tM,"rgbToHex");function PQ(i,e,t,r,n){var a=[za(Math.round(i).toString(16)),za(Math.round(e).toString(16)),za(Math.round(t).toString(16)),za(rT(r))];return n&&a[0].charAt(0)==a[0].charAt(1)&&a[1].charAt(0)==a[1].charAt(1)&&a[2].charAt(0)==a[2].charAt(1)&&a[3].charAt(0)==a[3].charAt(1)?a[0].charAt(0)+a[1].charAt(0)+a[2].charAt(0)+a[3].charAt(0):a.join("")}h(PQ,"rgbaToHex");function iM(i,e,t,r){var n=[za(rT(r)),za(Math.round(i).toString(16)),za(Math.round(e).toString(16)),za(Math.round(t).toString(16))];return n.join("")}h(iM,"rgbaToArgbHex");vt.equals=function(i,e){return!i||!e?!1:vt(i).toRgbString()==vt(e).toRgbString()};vt.random=function(){return vt.fromRatio({r:Math.random(),g:Math.random(),b:Math.random()})};function AQ(i,e){e=e===0?0:e||10;var t=vt(i).toHsl();return t.s-=e/100,t.s=cg(t.s),vt(t)}h(AQ,"_desaturate");function IQ(i,e){e=e===0?0:e||10;var t=vt(i).toHsl();return t.s+=e/100,t.s=cg(t.s),vt(t)}h(IQ,"_saturate");function LQ(i){return vt(i).desaturate(100)}h(LQ,"_greyscale");function DQ(i,e){e=e===0?0:e||10;var t=vt(i).toHsl();return t.l+=e/100,t.l=cg(t.l),vt(t)}h(DQ,"_lighten");function kQ(i,e){e=e===0?0:e||10;var t=vt(i).toRgb();return t.r=Math.max(0,Math.min(255,t.r-Math.round(255*-(e/100)))),t.g=Math.max(0,Math.min(255,t.g-Math.round(255*-(e/100)))),t.b=Math.max(0,Math.min(255,t.b-Math.round(255*-(e/100)))),vt(t)}h(kQ,"_brighten");function RQ(i,e){e=e===0?0:e||10;var t=vt(i).toHsl();return t.l-=e/100,t.l=cg(t.l),vt(t)}h(RQ,"_darken");function FQ(i,e){var t=vt(i).toHsl(),r=(t.h+e)%360;return t.h=r<0?360+r:r,vt(t)}h(FQ,"_spin");function zQ(i){var e=vt(i).toHsl();return e.h=(e.h+180)%360,vt(e)}h(zQ,"_complement");function rM(i,e){if(isNaN(e)||e<=0)throw new Error("Argument to polyad must be a positive number");for(var t=vt(i).toHsl(),r=[vt(i)],n=360/e,a=1;a<e;a++)r.push(vt({h:(t.h+a*n)%360,s:t.s,l:t.l}));return r}h(rM,"polyad");function BQ(i){var e=vt(i).toHsl(),t=e.h;return[vt(i),vt({h:(t+72)%360,s:e.s,l:e.l}),vt({h:(t+216)%360,s:e.s,l:e.l})]}h(BQ,"_splitcomplement");function OQ(i,e,t){e=e||6,t=t||30;var r=vt(i).toHsl(),n=360/t,a=[vt(i)];for(r.h=(r.h-(n*e>>1)+720)%360;--e;)r.h=(r.h+n)%360,a.push(vt(r));return a}h(OQ,"_analogous");function NQ(i,e){e=e||6;for(var t=vt(i).toHsv(),r=t.h,n=t.s,a=t.v,o=[],s=1/e;e--;)o.push(vt({h:r,s:n,v:a})),a=(a+s)%1;return o}h(NQ,"_monochromatic");vt.mix=function(i,e,t){t=t===0?0:t||50;var r=vt(i).toRgb(),n=vt(e).toRgb(),a=t/100,o={r:(n.r-r.r)*a+r.r,g:(n.g-r.g)*a+r.g,b:(n.b-r.b)*a+r.b,a:(n.a-r.a)*a+r.a};return vt(o)};vt.readability=function(i,e){var t=vt(i),r=vt(e);return(Math.max(t.getLuminance(),r.getLuminance())+.05)/(Math.min(t.getLuminance(),r.getLuminance())+.05)};vt.isReadable=function(i,e,t){var r=vt.readability(i,e),n,a;switch(a=!1,n=HQ(t),n.level+n.size){case"AAsmall":case"AAAlarge":a=r>=4.5;break;case"AAlarge":a=r>=3;break;case"AAAsmall":a=r>=7;break}return a};vt.mostReadable=function(i,e,t){var r=null,n=0,a,o,s,l;t=t||{},o=t.includeFallbackColors,s=t.level,l=t.size;for(var u=0;u<e.length;u++)a=vt.readability(i,e[u]),a>n&&(n=a,r=vt(e[u]));return vt.isReadable(i,r,{level:s,size:l})||!o?r:(t.includeFallbackColors=!1,vt.mostReadable(i,["#fff","#000"],t))};var nM=vt.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},fxe=vt.hexNames=$Q(nM);function $Q(i){var e={};for(var t in i)i.hasOwnProperty(t)&&(e[i[t]]=t);return e}h($Q,"flip");function iT(i){return i=parseFloat(i),(isNaN(i)||i<0||i>1)&&(i=1),i}h(iT,"boundAlpha");function Ri(i,e){UQ(i)&&(i="100%");var t=VQ(i);return i=Math.min(e,Math.max(0,parseFloat(i))),t&&(i=parseInt(i*e,10)/100),Math.abs(i-e)<1e-6?1:i%e/parseFloat(e)}h(Ri,"bound01");function cg(i){return Math.min(1,Math.max(0,i))}h(cg,"clamp01");function Rn(i){return parseInt(i,16)}h(Rn,"parseIntFromHex");function UQ(i){return typeof i=="string"&&i.indexOf(".")!=-1&&parseFloat(i)===1}h(UQ,"isOnePointZero");function VQ(i){return typeof i=="string"&&i.indexOf("%")!=-1}h(VQ,"isPercentage");function za(i){return i.length==1?"0"+i:""+i}h(za,"pad2");function Xc(i){return i<=1&&(i=i*100+"%"),i}h(Xc,"convertToPercentage");function rT(i){return Math.round(parseFloat(i)*255).toString(16)}h(rT,"convertDecimalToHex");function aM(i){return Rn(i)/255}h(aM,"convertHexToDecimal");var eo=function(){var i="[-\\+]?\\d+%?",e="[-\\+]?\\d*\\.\\d+%?",t="(?:"+e+")|(?:"+i+")",r="[\\s|\\(]+("+t+")[,|\\s]+("+t+")[,|\\s]+("+t+")\\s*\\)?",n="[\\s|\\(]+("+t+")[,|\\s]+("+t+")[,|\\s]+("+t+")[,|\\s]+("+t+")\\s*\\)?";return{CSS_UNIT:new RegExp(t),rgb:new RegExp("rgb"+r),rgba:new RegExp("rgba"+n),hsl:new RegExp("hsl"+r),hsla:new RegExp("hsla"+n),hsv:new RegExp("hsv"+r),hsva:new RegExp("hsva"+n),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();function Ao(i){return!!eo.CSS_UNIT.exec(i)}h(Ao,"isValidCSSUnit");function jQ(i){i=i.replace(pxe,"").replace(dxe,"").toLowerCase();var e=!1;if(nM[i])i=nM[i],e=!0;else if(i=="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var t;return(t=eo.rgb.exec(i))?{r:t[1],g:t[2],b:t[3]}:(t=eo.rgba.exec(i))?{r:t[1],g:t[2],b:t[3],a:t[4]}:(t=eo.hsl.exec(i))?{h:t[1],s:t[2],l:t[3]}:(t=eo.hsla.exec(i))?{h:t[1],s:t[2],l:t[3],a:t[4]}:(t=eo.hsv.exec(i))?{h:t[1],s:t[2],v:t[3]}:(t=eo.hsva.exec(i))?{h:t[1],s:t[2],v:t[3],a:t[4]}:(t=eo.hex8.exec(i))?{r:Rn(t[1]),g:Rn(t[2]),b:Rn(t[3]),a:aM(t[4]),format:e?"name":"hex8"}:(t=eo.hex6.exec(i))?{r:Rn(t[1]),g:Rn(t[2]),b:Rn(t[3]),format:e?"name":"hex"}:(t=eo.hex4.exec(i))?{r:Rn(t[1]+""+t[1]),g:Rn(t[2]+""+t[2]),b:Rn(t[3]+""+t[3]),a:aM(t[4]+""+t[4]),format:e?"name":"hex8"}:(t=eo.hex3.exec(i))?{r:Rn(t[1]+""+t[1]),g:Rn(t[2]+""+t[2]),b:Rn(t[3]+""+t[3]),format:e?"name":"hex"}:!1}h(jQ,"stringInputToObject");function HQ(i){var e,t;return i=i||{level:"AA",size:"small"},e=(i.level||"AA").toUpperCase(),t=(i.size||"small").toLowerCase(),e!=="AA"&&e!=="AAA"&&(e="AA"),t!=="small"&&t!=="large"&&(t="small"),{level:e,size:t}}h(HQ,"validateWCAG2Parms");var mI=It(X0e()),Vh={margin:6,text:{numLines:2,lineHeight:1.2,size:11.5,maxWidth:150,foregroundColor:"white",backgroundColor:"#333"},marker:{size:5,foregroundColor:{active:"white",inactive:void 0},backgroundColor:{active:"#333",inactive:void 0}}},mxe={lightOnDark:{...Vh,text:{...Vh.text,foregroundColor:"white",backgroundColor:"#333"},marker:{...Vh.marker,foregroundColor:{active:"white",inactive:void 0},backgroundColor:{active:"#333",inactive:void 0}}},darkOnLight:{...Vh,text:{...Vh.text,foregroundColor:"#333",backgroundColor:"white"},marker:{...Vh.marker,foregroundColor:{active:"#333",inactive:void 0},backgroundColor:{active:"white",inactive:void 0}}}},gxe="LOW_PRIORITY",gI=4,yxe=6,vxe=20,xxe=2.5,_xe=2,bxe="cover",yI=.5,wxe=6.5,vI={heightAbovePolygon:0,appearance:mxe.darkOnLight},oM=class qy{constructor(e,t,r){Z(this,"lines",0);Z(this,"id");Z(this,"rank");Z(this,"type","label");Z(this,"initialRank");Z(this,"contextConfigured",!1);Z(this,"fillText");Z(this,"newStyle",{});Z(this,"opacity",0);Z(this,"visibilityNeedsUpdate",!0);Z(this,"activeStrategyIndex",-1);Z(this,"text");Z(this,"style",{top:0,left:0,textLabelVisible:!0,pinVisibility:1,textAlign:"left"});Z(this,"projection",new Oe);Z(this,"_cache",{});Z(this,"appearance");Z(this,"options");Z(this,"visible",!1);Z(this,"enabled",!0);Z(this,"activeBoundingBox",{x:0,y:0,w:0,h:0});Z(this,"dimensions",{width:0,height:0});Z(this,"currentStrategyIndex",-1);Z(this,"totalMarkerSize",0);Z(this,"dirty",!0);Z(this,"collisionDirty",!0);Z(this,"lastTextAlign");Z(this,"imageHash");Z(this,"markerSize",0);Z(this,"iconVisible",!1);Z(this,"zoomProportion",0);Z(this,"dp");Z(this,"onStrategySelected",e=>{if(this.currentStrategyIndex===e)return;let t=this.strategies[e];t&&t.onStrategySelected(this),this.currentStrategyIndex=e;let r=this.style;this.style=this.newStyle,this.newStyle=r,this.iconVisible||(this.opacity=0,this.visibilityNeedsUpdate=!0)});var n,a;if(this.id=(n=t.id)!=null?n:Cr(),this.options=(0,mI.default)({},t,vI),this.text=e,this.dp=(s=1)=>s*r.pixelRatio,typeof t.rank=="string")this.rank=a_(t.rank),this.initialRank=this.rank;else if(t.rank!=null&&t.rank>0)this.rank=t.rank,this.initialRank=t.rank;else{let s=Math.trunc(hr.env.NODE_ENV==="test"?qy.testId:qy.testId*10)/10;qy.testId+=.001,this.rank=s,this.initialRank=s}let o=(0,mI.default)({},this.options.appearance,vI.appearance);this.appearance={margin:o.margin,text:{lineHeight:o.text.lineHeight,numLines:o.text.numLines,size:o.text.size,maxWidth:o.text.maxWidth,foregroundColor:o.text.foregroundColor,backgroundColor:o.text.backgroundColor},marker:{foregroundColor:{active:o.marker.foregroundColor.active,inactive:o.marker.foregroundColor.inactive||vt(o.marker.foregroundColor.active).setAlpha(.5).toRgbString()},backgroundColor:{active:o.marker.backgroundColor.active,inactive:o.marker.backgroundColor.inactive||vt(o.marker.backgroundColor.active).setAlpha(.5).toRgbString()},icon:o.marker.icon,iconSize:o.marker.iconSize||vxe,iconPadding:(a=o.marker.iconPadding)!=null?a:_xe,iconFit:o.marker.iconFit||bxe,iconVisibilityThreshold:o.marker.iconVisibilityThreshold==null?yI:o.marker.iconVisibilityThreshold}},this.calculateMarkerSize()}setEntity(){}calculateMarkerSize(){let{iconVisibilityThreshold:e=yI}=this.appearance.marker,t=this.dp();this.zoomProportion<=e&&typeof this.appearance.marker.iconSize<"u"&&this.imageHash?(this.markerSize=this.dp(this.appearance.marker.iconSize),this.iconVisible=!0):(this.iconVisible=!1,this.markerSize=this.dp(wxe)),this.totalMarkerSize=Math.ceil((this.markerSize+xxe)/t)}get strategies(){let{width:e,height:t}=this.dimensions,{margin:r}=this.appearance;this.calculateMarkerSize();let n=Math.max(yxe,r),a=this.iconVisible?n/2:0,o=[{name:"RIGHT",getBoundingBox:()=>{let s=Math.max(this.totalMarkerSize,t);return[s/2+n,s/2+n,this.totalMarkerSize/2+n,this.totalMarkerSize/2+e+n]},onStrategySelected:()=>{this.newStyle.textAlign="left",this.newStyle.pinVisibility=1,this.newStyle.top=-t/2,this.newStyle.left=this.totalMarkerSize/2+gI,this.newStyle.textLabelVisible=!0}},{name:"LEFT",getBoundingBox:()=>{let s=Math.max(this.totalMarkerSize,t);return[s/2+n,s/2+n,this.totalMarkerSize/2+e+n,this.totalMarkerSize/2+n]},onStrategySelected:()=>{this.newStyle.textAlign="right",this.newStyle.pinVisibility=1,this.newStyle.top=-t/2,this.newStyle.left=-e-this.totalMarkerSize/2-gI,this.newStyle.textLabelVisible=!0}},{name:"TOP",getBoundingBox:()=>{let s=this.dp();return[t+this.totalMarkerSize/2/s+n,this.totalMarkerSize/2+n,e/2+n,e/2+n]},onStrategySelected:()=>{this.newStyle.pinVisibility=1,this.newStyle.textAlign="center",this.newStyle.textLabelVisible=!0,this.newStyle.top=-this.totalMarkerSize-t/2,this.newStyle.left=-e/2}},{name:gxe,getBoundingBox:()=>[this.totalMarkerSize/2+a,this.totalMarkerSize/2+a,this.totalMarkerSize/2+a,this.totalMarkerSize/2+a],onStrategySelected:()=>{this.newStyle.pinVisibility=.5,this.newStyle.textLabelVisible=!1,this.newStyle.top=0,this.newStyle.left=0}}];return this.text===""?[{name:"ICON_ONLY",getBoundingBox:()=>[this.totalMarkerSize/2+n,this.totalMarkerSize/2+n,this.totalMarkerSize/2+n,this.totalMarkerSize/2+n],onStrategySelected:()=>{this.newStyle.pinVisibility=1,this.newStyle.textLabelVisible=!1,this.newStyle.top=0,this.newStyle.left=0}}]:o}updatePosition(){}disable(){this.visible=!1}toJSON(){return{x:this.projection.x,y:this.projection.y,enabled:this.enabled,id:this.id,rank:this.rank,bboxes:this.strategies.map((e,t)=>({index:t,boundingBox:e.getBoundingBox()})),shouldCollideWithScreenEdges:!1}}destroy(){}};h(oM,"LabelComponent"),ie(oM,"testId",0);var Sxe=oM,_p=Sxe;R();R();function GQ(i){return fJ(i)}h(GQ,"getBoundingBoxFromFeature");var WQ=class extends EE{constructor(){super(...arguments);Z(this,"userData",{entities:{}})}};h(WQ,"EntityBatchedMesh");var XQ=WQ,Zy,Yy,_c,qQ=class{constructor(e){ie(this,"mesh"),ie(this,"focusMesh"),ie(this,"outline"),ie(this,"type","geometry"),ie(this,"instanceIndex",-1),ie(this,"geometry"),ie(this,"material"),ie(this,"feature"),ie(this,"focusable",!1),ie(this,"color",new Lt),ie(this,"topColor",new Lt),ie(this,"position",new le),fe(this,Zy,0),fe(this,Yy,1),fe(this,_c,void 0),ie(this,"texturesVisible",!1),this.feature=e}get visible(){return this.mesh?this.mesh.getVisibleAt(this.instanceIndex):!1}set visible(e){this.mesh&&this.mesh.setVisibleAt(this.instanceIndex,e)}setOpacity(e){this.mesh&&(this.material&&(this.material.opacity=e,this.material.transparent=e<1),this.outline&&(e<.5?this.outline.visible=!1:this.outline.visible=!0),e===0?this.mesh.visible=!1:this.mesh.visible=!0)}setColor(e,t){this.color.set(e),this.topColor.set(t),this.material&&this.material.setColor(this.instanceIndex,this.color,this.topColor)}get altitude(){return M(this,Zy)}set altitude(e){this.mesh&&(this.mesh.position.z=e,ke(this,Zy,e))}get opacity(){return M(this,Yy)}set opacity(e){this.material&&(this.material.opacity=e,this.material.transparent=e<1,this.outline&&(this.outline.visible=e>.5),this.material.needsUpdate=!0),ke(this,Yy,e)}get texture(){var e,t;return(t=(e=this.material)==null?void 0:e.texture)==null?void 0:t.image.src}set texture(e){this.material&&(this.material.texture=e)}set topTexture(e){this.material&&(this.material.topTexture=e)}get topTexture(){var e,t;return(t=(e=this.material)==null?void 0:e.topTexture)==null?void 0:t.image.src}get featureBbox(){return M(this,_c)?M(this,_c):(ke(this,_c,GQ(this.feature)),M(this,_c))}showTextures(){this.material&&(this.material.showTextures(this.instanceIndex),this.texturesVisible=!0)}hideTextures(){this.material&&(this.material.hideTextures(this.instanceIndex),this.texturesVisible=!1)}};Zy=new WeakMap,Yy=new WeakMap,_c=new WeakMap,h(qQ,"MeshComponent");var Ho=qQ,ZQ=class extends Hr{constructor(){super();Z(this,"interpolators",new Map);Z(this,"update",t=>{for(let[r,n]of this.interpolators)r instanceof Ho?r.setOpacity(n(t)):r instanceof _p?r.enabled=n(t):n(t)})}addEntity3D(t,r){let[n,a,o,s]=r[1];this.interpolators.set(t,l=>yh(l,n,a,o,s))}addEntity2D(t,r){let[n,a,o]=r[1];this.interpolators.set(t,s=>s<n?a:o)}addAny(t,r){this.interpolators.set(t,r)}destroy(){this.interpolators.clear()}};h(ZQ,"ZoomInterpolationSystem");var Mxe=ZQ;R();var sM=class Jy{constructor(e,t={}){Z(this,"id");Z(this,"type","marker");Z(this,"rank",0);Z(this,"initialRank",0);Z(this,"options",{});Z(this,"projection",new Oe);Z(this,"enabled",!0);Z(this,"activeStrategyIndex",-1);Z(this,"strategyIndex",-1);Z(this,"activeBoundingBox",{x:0,y:0,w:0,h:0});Z(this,"dimensions",{width:0,height:0});Z(this,"containerEl");Z(this,"contentEl",null);Z(this,"contentHtml","");Z(this,"style",{top:"0px",left:"0px"});Z(this,"dirty",!1);Z(this,"collisionDirty",!0);Z(this,"visibilityNeedsUpdate",!0);Z(this,"visible",!1);Z(this,"animation",null);Z(this,"currentStrategyIndex",-1);Z(this,"onStrategySelected",(e,t=!1)=>{if(this.currentStrategyIndex===e||t)return;let{width:r,height:n}=this.dimensions,a=-n/2+"px",o=-r/2+"px";switch(this.style.top=a,this.style.left=o,this.options.anchor){case"top":{this.style.top=-n+"px";break}case"bottom":{this.style.top="0px";break}case"left":{this.style.left=-r+"px";break}case"right":{this.style.left="0px";break}default:this.style.top=a,this.style.left=o}this.containerEl.style.top=this.style.top,this.containerEl.style.left=this.style.left});if(this.id=(t==null?void 0:t.id)||Cr(),this.options=t,typeof t.rank=="string")this.rank=a_(t.rank);else if(t.rank!=null&&t.rank>0)this.rank=t.rank;else{let n=Math.trunc(hr.env.NODE_ENV==="test"?Jy.testId:Jy.testId*10)/10;Jy.testId+=.001,this.rank=n}this.contentHtml=e,this.initialRank=this.rank;let r=document.createElement("div");r.style.opacity="0",r.innerHTML=`<div class="mappedin-marker">${this.contentHtml}</div>`,this.containerEl=r.querySelector(".mappedin-marker"),this.containerEl.setAttribute("data-marker-id",this.id.toString()),this.contentEl=this.containerEl?this.containerEl.firstElementChild:null}updateDimensions(e,t){if(e!=null&&t!=null)this.dimensions={width:e,height:t};else{let{width:r,height:n}=this.containerEl.getBoundingClientRect();this.dimensions={width:r,height:n}}Object.assign(this.containerEl,{width:this.dimensions.width+"px",height:this.dimensions.height+"px"})}get strategies(){let{width:e,height:t}=this.dimensions;return[{name:"center",getBoundingBox:()=>{let r=t/2,n=t/2,a=e/2,o=e/2;switch(this.options.anchor){case"top":{r=t,n=0;break}case"bottom":{r=0,n=t;break}case"left":{a=e,o=0;break}case"right":{a=0,o=e;break}}return[r,n,a,o]}}]}toJSON(){return{x:this.projection.x,y:this.projection.y,enabled:this.enabled,id:this.id,rank:this.rank,bboxes:this.strategies.map((e,t)=>({index:t,boundingBox:e.getBoundingBox()})),shouldCollideWithScreenEdges:!1}}destroy(){}};h(sM,"MarkerComponent"),ie(sM,"testId",0);var bp=sM;R();R();R();R();R();var YQ=class{constructor(){Z(this,"hover",!1);Z(this,"dirty",!1)}};h(YQ,"InteractionComponent");var j2=YQ;function Ma(i,e,t){if(e!==void 0){if(i.type==="model"||i.type==="path"||i.type==="marker"||i.type==="label"||i.type==="geometry"||i.type==="group-container")return e===!0?(i instanceof qp&&i.components[1]===void 0?(i.components[1]=new j2,i.components[1].dirty=!0):i instanceof Vn&&i.components[2]===void 0?(i.components[2]=new j2,i.components[2].dirty=!0):i instanceof ca&&i.components[1]===void 0&&(i.components[1]=new j2,i.components[1].dirty=!0),!0):(i instanceof qp?i.components[1]=void 0:i instanceof Vn?i.components[2]=void 0:i instanceof ca&&(i.components[1]=void 0),!0);if(i.type==="geometry-group"){let r;for(let n of i.userData.entities3D.values())r=t.entity3DMap.get(n),Ma(r,e,t);return!0}}return!1}h(Ma,"updateInteractivity");function JQ(i,e,t){if(t!==void 0&&i.type==="geometry-group"&&i.components[0]!=null){let r,n,a=i.components[0];for(let o of i.userData.entities3D.values())r=e.entity3DMap.get(o),r&&(n=r.components[1],n.color===a.color&&(n.initialColor=t.color||a.color,n.color=t.color||a.color,n.dirty=!0),n.topColor===a.topColor&&(n.topColor=t.topColor||a.topColor,n.dirty=!0));return t.color!==void 0&&(i.components[0].color=t.color),t.topColor!==void 0&&(i.components[0].topColor=t.topColor),!0}return!1}h(JQ,"updateGroupColor");function KQ(i,e){if(e!==void 0&&i.type==="geometry-group"&&i.components[0]!=null){let t=i.components[0];return t.shading=t.shading||{},t.shading&&(e.start!==t.shading.start||e.end!==t.shading.end||e.intensity!==t.shading.intensity)&&(Object.assign(t.shading,e),i.userData.shadingDirty=!0),!0}return!1}h(KQ,"updateGroupShading");function QQ(i,e){e!==void 0&&(i.type==="path"||i.type==="geometry")&&(e.initialColor!==void 0&&(i.components[1].initialColor=e.initialColor),e.color!==void 0&&(i.components[1].color=e.color),e.topColor!==void 0&&(i.components[1].topColor=e.topColor),i.components[1].dirty=!0)}h(QQ,"updateColor");function lM(i,e,t){e!==void 0&&(i.type==="label"||i.type==="marker"?(i.object3d.position.copy(t(e[1],e[0],e[2]||0)),i.positionDirty=!0):i.type==="custom-geometry"&&i.components[0].position.copy(t(e[1],e[0],e[2]||0)))}h(lM,"updatePosition");function uM(i,e){var t;return e!==void 0&&(i.type==="marker"||i.type==="label"||i.type==="custom-geometry")&&i.parent!==e&&i.parent instanceof ca?((t=i.parent)==null||t.removeEntity(i),e.addEntity(i),!0):!1}h(uM,"updateParent");function eee(i,e){e!==void 0&&(i.type==="marker"||i.type==="label")&&(i.components[0].enabled=e)}h(eee,"updateEnabled");function tee(i,e){if(e!==void 0&&i.type==="path"){let t=i.components[0];e.completeFraction!==void 0&&(t.completeFraction=e.completeFraction)}}h(tee,"updatePath");function iee(i,e){if(e!==void 0&&i.type==="marker"){let t=i.components[0];if(e.contentHTML!==void 0)return t.containerEl.innerHTML=e.contentHTML,!0}return!1}h(iee,"updateMarker");function ree(i,e){return e!==void 0&&(i.type==="marker"||i.type==="label")?(i.components[0].rank=a_(e),!0):!1}h(ree,"updateRank");function nee(i,e){var t,r,n;if(e!==void 0&&i.type==="label"){let a=i.components[0];e.text!==void 0&&(a.text=e.text,a.dirty=!0),((t=e.options)==null?void 0:t.appearance)!==void 0&&Object.keys((r=e.options)==null?void 0:r.appearance).length>0&&(QE(a.appearance,((n=e.options)==null?void 0:n.appearance)||{}),a.dirty=!0)}}h(nee,"updateLabel");function aee(i,e){e!==void 0&&i.type==="geometry"&&(i.components[1].hoverColor=e,i.components[1].dirty=!0)}h(aee,"updateHoverColor");function bc(i,e){if(e!==void 0){if(i.type==="model"||i.type==="path"||i.type==="geometry"||i.type==="custom-geometry"){i.components[1].visible=e,i.components[1].dirty=!0;let t=i.parent;t instanceof ks&&(t.userData.outlineDirty=!0)}else(i.type==="group-container"||i.type==="geometry-group")&&i.setVisible(e);return!0}return!1}h(bc,"updateVisibility");function oee(i,e,t){if(t!==void 0&&i.type==="geometry-group"){i.setOpacity(t),i.components[0].opacity=t;for(let r of i.userData.entities3D.values()){let n=e.entity3DMap.get(r);((n==null?void 0:n.type)==="geometry"||(n==null?void 0:n.type)==="model")&&(n.components[1].opacity=t,n.components[1].dirty=!0)}}}h(oee,"updateOpacity");function hM(i,e){e!==void 0&&(i.type==="model"||i.type==="path"||i.type==="geometry"||i.type==="custom-geometry"?(i.components[1].altitude=e,i.components[1].dirty=!0):i.type==="group-container"&&i.setAltitude(e))}h(hM,"updateAltitude");function cM(i,e){if(e!==void 0){if(i.type==="geometry-group"&&i.components[0]!=null)i.components[0].outline=e,i.userData.outlineDirty=!0;else if(i.type==="geometry"){i.components[1].outline=e,i.components[1].dirty=!0;let t=i.parent;t instanceof ks&&(t.userData.outlineDirty=!0)}return!0}return!1}h(cM,"updateOutline");var qc,vs,pM,dM,see,Ky,fM,mM,lee,gM,uee,Qy,yM,e0,Fv,vM,hee=class{constructor(e){fe(this,dM),fe(this,mM),fe(this,gM),fe(this,qc,null),fe(this,vs,void 0),ie(this,"getCurrentSceneGLTF",async t=>{let r={onlyVisible:!0,binary:!0,light:!0,scale:1,...t},n=await Ot(this,dM,see).call(this),a=M(this,pM).call(this,r),o=await n.parseAsync(a,{trs:!1,maxTextureSize:1/0,onlyVisible:r.onlyVisible,binary:r.binary,scale:r.scale}),s;if(o instanceof ArrayBuffer)s=new Blob([o],{type:"application/octet-stream"});else{let l=JSON.stringify(o,null,2);s=new Blob([l],{type:"text/plain"})}return s}),fe(this,pM,h(t=>{let{scale:r,light:n,onlyVisible:a}=t,o=new lq,s=new Yr().setFromObject(M(this,vs).entityScene);if(M(this,Ky).call(this,M(this,vs).entityScene,o,a),n){let l=new gY(16777215,.3*Math.PI);l.position.set(0,Math.max(s.max.x,s.max.y)*r*.5,s.max.y*r*4),l.lookAt(0,0,-1),l.target.position.set(0,0,-1),l.add(l.target),o.add(l)}return o},"#getExportedScene")),fe(this,Ky,h((t,r,n)=>{t.material&&(t instanceof EE?Ot(this,mM,lee).call(this,t).forEach(a=>r.add(a)):t instanceof Hx&&r.add(Ot(this,gM,uee).call(this,t))),t.children.forEach(a=>{(!n||a.visible)&&M(this,Ky).call(this,a,r,n)})},"#processObject3D")),fe(this,fM,h((t,r,n)=>{let a=new FZ({color:new Lt(t),metalness:0});return a.opacity=r,a.transparent=n,a},"#createStandardMaterial")),fe(this,Qy,h(t=>{let{geometry:r,material:n,position:a,rotation:o,quaternion:s,scale:l}=t;if(!(r!=null&&r.isBufferGeometry))return t;let u=r.attributes.position,c=r.attributes.normal,p=r.attributes.uv;return M(this,yM).call(this,u,c),M(this,Fv).call(this,a,l,o,s),p&&M(this,vM).call(this,p),n!=null&&n.map&&r.type==="PlaneGeometry"&&(t.side=Da),t},"#convertGeometry")),fe(this,yM,h((t,r)=>{let n=new le,a=new le;for(let o=0;o<t.count;o++)n.fromBufferAttribute(t,o),M(this,e0).call(this,n),t.setXYZ(o,n.x,n.y,n.z),r&&(a.fromBufferAttribute(r,o),M(this,e0).call(this,a),r.setXYZ(o,a.x,a.y,a.z))},"#convertAttributes")),fe(this,e0,h(t=>{let r=t.y;t.y=t.z,t.z=-r},"#convertVector")),fe(this,Fv,h((t,r,n,a)=>{let o=t.y;t.y=t.z,t.z=-o;let s=r.y;if(r.y=r.z,r.z=s,n instanceof $a)n.order="YXZ",n.set(n.x,n.y,n.z,n.order);else{let l=a.y;a.set(a.x,a.z,-l,a.w)}},"#convertObjectProperties")),fe(this,vM,h(t=>{for(let r=0;r<t.count;r++){let n=t.getX(r),a=t.getY(r);t.setXY(r,n,a)}},"#convertUVs")),ke(this,vs,e),M(this,vs).entityScene=e.entityScene,M(this,vs).entity3DMap=e.entity3DMap}destroy(){ke(this,qc,null)}};qc=new WeakMap,vs=new WeakMap,pM=new WeakMap,dM=new WeakSet,see=h(async function(){if(!M(this,qc)){let{GLTFExporter:i}=await zm(()=>import("./GLTFExporter-DJTLMZRS-DV9xnn5r.js"),[]);ke(this,qc,new i)}return M(this,qc)},"#getGLTFExporter"),Ky=new WeakMap,fM=new WeakMap,mM=new WeakSet,lee=h(function(i){var e,t;let r=[],n=((e=i.userData)!=null&&e.entities?Object.values((t=i.userData)==null?void 0:t.entities):[]).map(o=>M(this,vs).entity3DMap.get(o)),a=new Map;return n.forEach(o=>{var s;if(!o||!(o instanceof Vn))return;let l=o.components[1],u=o.components[2];if(!l.visible||l.opacity===0)return;let c=`${u!=null&&u.hover?l.hoverColor||M(this,vs).hoverColor:l.color}-${l.opacity}-${Number(l.visible)}`;a.has(c)||a.set(c,[]),(s=a.get(c))==null||s.push(o)}),a.forEach((o,s)=>{let[l,u,c]=s.split("-"),p=o.reduce((b,x)=>{let v=x.components[0];if(v.type==="custom-geometry")return b;let w=v==null?void 0:v.geometry;return w&&b.push(w),b},[]),d=M(this,fM).call(this,l,Number(u),i.material.transparent),m=sd(p,!0),g=new Wi(m,d);g.position.copy(i.position),g.rotation.copy(i.rotation),g.scale.copy(i.scale),g.visible=!!c,M(this,Fv).call(this,g.position,g.scale,g.rotation,g.quaternion),r.push(M(this,Qy).call(this,g))}),r},"#processBatchedMesh"),gM=new WeakSet,uee=h(function(i){let e=i.geometry.clone(),t=i.material,r=new rd({color:t.color,side:Da});r.opacity=t.opacity,r.transparent=t.transparent;let n=new Hx(e,r);return n.position.copy(i.position),n.rotation.copy(i.rotation),n.scale.copy(i.scale),n.visible=i.visible,M(this,Qy).call(this,n)},"#processLineSegments"),Qy=new WeakMap,yM=new WeakMap,e0=new WeakMap,Fv=new WeakMap,vM=new WeakMap,h(hee,"ExporterSystem");var Cxe=hee;R();var xI="#ffffff",cee=class{constructor(e={}){Z(this,"initialColor",xI);Z(this,"color",xI);Z(this,"topColor");Z(this,"topTexture");Z(this,"texture");Z(this,"hoverColor");Z(this,"dirty",!0);Z(this,"visible",!0);Z(this,"opacity",1);Z(this,"width",.1);Z(this,"height",.1);Z(this,"altitude",0);Z(this,"join","round");Z(this,"cap","round");Z(this,"outline",!0);this.color=(e==null?void 0:e.color)!==void 0?e.color:this.color,this.initialColor=this.color,this.width=(e==null?void 0:e.width)!==void 0?e.width:this.width,this.opacity=(e==null?void 0:e.opacity)!==void 0?e.opacity:this.opacity,this.visible=(e==null?void 0:e.visible)!==void 0?e.visible:this.visible,this.height=(e==null?void 0:e.height)!==void 0?e.height:this.height,this.altitude=(e==null?void 0:e.altitude)!==void 0?e.altitude:this.altitude,this.join=(e==null?void 0:e.join)!==void 0?e.join:this.join,this.cap=(e==null?void 0:e.cap)!==void 0?e.cap:this.cap,this.topColor=e==null?void 0:e.topColor,this.texture=e==null?void 0:e.texture,this.topTexture=e==null?void 0:e.topTexture,this.outline=(e==null?void 0:e.outline)!==void 0?!!e.outline:this.outline}};h(cee,"StyleComponent");var zv=cee;R();R();R();R();var pee={top:0,bottom:0,left:0,right:0};R();R();R();R();var dee=class extends jx{constructor(t){let r=t,n=3,a=n*4;super(new Float32Array(t*a),n,t,$n,na);Z(this,"_width");Z(this,"_height");Z(this,"_propertiesLength");this._width=a,this._height=r,this._propertiesLength=n}setColor(t,r,n){let a=this.image.data,o=t*this._width;a[o]=r.r,a[o+1]=r.g,a[o+2]=r.b,a[o+3]=0,a[o+4]=n.r,a[o+5]=n.g,a[o+6]=n.b,a[o+7]=0,this.needsUpdate=!0}setTexture(t,r,n){let a=this.image.data,o=t*this._width;a[o+8]=r?1:0,a[o+9]=n?1:0,a[o+10]=0,a[o+11]=0,this.needsUpdate=!0}};h(dee,"BatchedPropertiesTexture");var Exe=dee,Txe=`#define LAMBERT
varying vec3 vViewPosition;
varying vec4 vPosition;
varying vec2 vUv;
varying vec4 finalPosition;
varying vec3 vWorldPosition;
varying vec3 worldNormal;
varying float vBatchId;

#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vBatchId = batchId + 0.5;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
	// vertex normal relative to world space
	worldNormal = normal;
	vUv = uv;
	// world position
	vWorldPosition = (modelMatrix * vec4(position, 1.0)).xyz;
}`,Pxe=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
uniform float uGradientEnd;
uniform float uGradientIntensity;
uniform float uMinSideAlpha;
uniform float uMaxSideAlpha;
uniform float uGradientStart;
uniform highp sampler2D uPropertiesTexture;
uniform highp sampler2D uTopTexture;
uniform highp sampler2D uTexture;
varying float vBatchId;

varying vec2 vUv;
varying vec3 vWorldPosition;
varying vec3 worldNormal;

#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

void main() {
	#include <clipping_planes_fragment>

	// get the normalized world normal of vertex fragment
	vec3 surfaceNormal = normalize(worldNormal);

	// get angle relative to Z up
	float angle = degrees(acos(abs(dot(surfaceNormal, vec3(0.0, 0.0, 1.0)))));

	int idx = int(vBatchId) * 1;
	vec3 diffuse = vec3(texelFetch(uPropertiesTexture, ivec2(0, idx), 0).rgb);
	bool shouldShowTexture = texelFetch(uPropertiesTexture, ivec2(2, idx), 0).r == 1.0;

	if(shouldShowTexture) {
		diffuse = texture2D(uTexture, vUv).rgb;
	}

	// if this is a fragment facing upwards, use topColor
	if(angle == 0.0) {
		bool shouldShowTopTexture = texelFetch(uPropertiesTexture, ivec2(2, idx), 0).g == 1.0;

		if(shouldShowTopTexture) {
			diffuse = texture2D(uTopTexture, vUv).rgb;
		} else {
			diffuse = vec3(texelFetch(uPropertiesTexture, ivec2(1, idx), 0).rgb);
		}
	}

	vec4 diffuseColor = vec4(diffuse, opacity);

	// only for vertical surfaces
	if(angle > 89.0 && angle < 91.0) {

		// get the percentage of the z position from the ground, up
		float percentFromZeroZ = max((abs(vWorldPosition.z) - uGradientStart) / uGradientEnd, 0.0);

		// gradient based on percentage
		float alpha = smoothstep(uMinSideAlpha, uMaxSideAlpha, percentFromZeroZ);

		// mix the shadow color with the diffuse color based on the alpha and opacity
		diffuseColor = vec4(mix(diffuseColor.rgb, diffuseColor.rgb * (1.0 - uGradientIntensity), 1.0 - alpha), opacity);
	}

	ReflectedLight reflectedLight = ReflectedLight(vec3(0.0), vec3(0.0), vec3(0.0), vec3(0.0));
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}
`,Axe=-.05,Ixe=1,fee=class extends Tv{constructor(t,r){super(t);Z(this,"propertiesTexture");Z(this,"uniforms",{uGradientIntensity:{value:0},uGradientEnd:{value:0},uGradientStart:{value:0},uTopTexture:{value:null},uTexture:{value:null}});Z(this,"showTextures",t=>{let r=!!this.uniforms.uTexture.value,n=!!this.uniforms.uTopTexture.value;(r||n)&&(this.propertiesTexture.setTexture(t,r,n),this.needsUpdate=!0)});this.propertiesTexture=new Exe(r),this.onBeforeCompile=n=>{let a=this.uniforms.uGradientIntensity,o=this.uniforms.uGradientEnd,s=this.uniforms.uGradientStart,l=this.uniforms.uTopTexture,u=this.uniforms.uTexture;this.uniforms=n.uniforms,n.vertexShader=Txe,n.fragmentShader=Pxe,Object.assign(this.uniforms,{uGradientIntensity:a,uGradientEnd:o,uGradientStart:s,uMinSideAlpha:{value:Axe},uMaxSideAlpha:{value:Ixe},uPropertiesTexture:{value:this.propertiesTexture},uTopTexture:l,uTexture:u})}}get texture(){return this.uniforms.uTexture.value}set texture(t){t.wrapS=po,t.wrapT=po,t.colorSpace=zn,this.uniforms.uTexture.value=t}get topTexture(){return this.uniforms.uTopTexture.value}set topTexture(t){t.wrapS=po,t.wrapT=po,t.colorSpace=zn,this.uniforms.uTopTexture.value=t}setGradientShading(t,r,n){this.uniforms.uGradientStart.value=t,this.uniforms.uGradientEnd.value=r,this.uniforms.uGradientIntensity.value=n}setColor(t,r,n){this.propertiesTexture.setColor(t,r,n)}hideTextures(t){let r=!!this.uniforms.uTexture.value,n=!!this.uniforms.uTopTexture.value;(r||n)&&(this.propertiesTexture.setTexture(t,!1,!1),this.needsUpdate=!0)}dispose(){super.dispose(),this.propertiesTexture.dispose()}};h(fee,"BatchedStandardMaterial");var Lxe=fee;R();var Dxe=80;function mee(i,e){var t,r;let n=0;for(let u of i)n+=((r=(t=u.components[0])==null?void 0:t.geometry)==null?void 0:r.attributes.position.count)||0;let a=new Lt(e.color),o=new Lxe({color:a,side:Da,opacity:e.opacity||1,transparent:e.opacity!==void 0?e.opacity<1:!1},i.length),s=new XQ(i.length,n,0,o),l;for(let u of i)l=u.components[0],!(!(l instanceof Ho)||!l.geometry)&&(l.mesh=s,l.material=o,l.instanceIndex=s.addGeometry(l.geometry),s.userData.entities[l.instanceIndex]=u.id,o.setColor(l.instanceIndex,a,e.topColor?new Lt(e.topColor):a));return s.perObjectFrustumCulled=!0,s.matrixAutoUpdate=!1,s}h(mee,"batchGeometries");function gee(i,e){e.polygonOffset=!0,e.polygonOffsetFactor=1,e.polygonOffsetUnits=1;let t=new Eye(i,Dxe),r=vt(e.color.getHexString()).darken(30).toRgbString(),n=new Eq({linewidth:2,color:r,transparent:!0}),a=new Hx(t,n);return a.layers.set(1),a}h(gee,"createOutlines");R();var kxe="gray",Rxe=.1;function yee(i,e,t){let{color:r=kxe,opacity:n=1,altitude:a=0,height:o=Rxe}=t||{};Array.isArray(n)&&(n=1);let s={min:{x:1/0,y:1/0,z:a},max:{x:-1/0,y:-1/0,z:o+a},center:{x:0,y:0,z:(o+a)/2}},l=new nd,u=i.geometry.coordinates[0].map(m=>{let g=e(m[1],m[0]);return s.min.x=Math.min(s.min.x,g.x),s.min.y=Math.min(s.min.y,g.y),s.max.x=Math.max(s.max.x,g.x),s.max.y=Math.max(s.max.y,g.y),g});l.moveTo(u[0].x,u[0].y),u.slice(1).forEach(m=>l.lineTo(m.x,m.y)),l.lineTo(u[0].x,u[0].y);let c=i.geometry.coordinates.slice(1);l.holes=c.map(m=>{let g=m.map(x=>e(x[1],x[0])),b=new jp;return b.moveTo(g[0].x,g[0].y),g.slice(1).forEach(x=>b.lineTo(x.x,x.y)),b.lineTo(g[0].x,g[0].y),b});let p={bevelEnabled:!1,depth:o},d=new og(l,p);return d.translate(0,0,a||0),d.userData={style:{color:r,opacity:n}},d}h(yee,"renderPolygonGeometry");R();var Fxe="gray",zxe=.1;function vee(i,e,t){let{color:r=Fxe,opacity:n=1,altitude:a=0,height:o=zxe}=t||{};Array.isArray(n)&&(n=1);let s={min:{x:1/0,y:1/0,z:a},max:{x:-1/0,y:-1/0,z:o+a}},l={bevelEnabled:!1,depth:o},u=[];i.geometry.coordinates.forEach(p=>{let d=new nd,m=p[0].map(x=>{let v=e(x[1],x[0]);return s.min.x=Math.min(s.min.x,v.x),s.min.y=Math.min(s.min.y,v.y),s.max.x=Math.max(s.max.x,v.x),s.max.y=Math.max(s.max.y,v.y),v});d.moveTo(m[0].x,m[0].y),m.slice(1).forEach(x=>d.lineTo(x.x,x.y)),d.lineTo(m[0].x,m[0].y);let g=p.slice(1);d.holes=g.map(x=>{let v=x.map(_=>e(_[1],_[0])),w=new jp;return w.moveTo(v[0].x,v[0].y),v.slice(1).forEach(_=>w.lineTo(_.x,_.y)),w.lineTo(v[0].x,v[0].y),w});let b=new og(d,l);u.push(b)});let c=sd(u);return c.translate(0,0,a||0),c.userData={style:{color:r,opacity:n}},c}h(vee,"renderMultiPolygonGeometry");R();R();var xee=It(q0e());function nT(i){this.name="JSClipperError",this.message=i,this.stack=new Error().stack}h(nT,"JSClipperError");nT.prototype=Error.prototype;xee.default.Error=function(i){throw new nT(i)};var Ca=xee.default,Bxe="gray",H2=new Ca.ClipperOffset,gn=100;function _ee(i,e,t){let{color:r=Bxe,opacity:n=1,width:a=1,join:o="round",cap:s="round",height:l=.01,altitude:u=0}=t||{};Array.isArray(n)&&(n=0);let c=[];for(let b=0;b<i.geometry.coordinates.length-1;b++){let x=e(i.geometry.coordinates[b][1],i.geometry.coordinates[b][0]),v=e(i.geometry.coordinates[b+1][1],i.geometry.coordinates[b+1][0]);c.push([x,v])}H2.AddPaths(c.map(b=>b.map(x=>({X:x.x*gn,Y:x.y*gn}))),o==="round"?Ca.JoinType.jsRound:o==="miter"?Ca.JoinType.jsMiter:Ca.JoinType.jsSquare,s==="round"?Ca.EndType.etOpenRound:s==="butt"?Ca.EndType.etOpenButt:Ca.EndType.etOpenSquare);let p=new Ca.PolyTree;H2.Execute(p,a/2*gn);let d=[],m={bevelEnabled:!1,depth:l};for(let b of p.m_AllPolys){let x=new nd;if(b.IsHole())continue;let v=b.m_polygon;x.moveTo(v[0].X/gn,v[0].Y/gn),v.slice(1).forEach(w=>x.lineTo(w.X/gn,w.Y/gn)),x.lineTo(v[0].X/gn,v[0].Y/gn),x.holes=b.m_Childs.map(w=>{let _=new jp,C=w.m_polygon;return _.moveTo(C[0].X/gn,C[0].Y/gn),C.slice(1).forEach(E=>_.lineTo(E.X/gn,E.Y/gn)),_.lineTo(C[0].X/gn,C[0].Y/gn),_}),d.push(new og(x,m))}let g=sd(d);return g.translate(0,0,u||0),g.userData={style:{color:r,opacity:n}},H2.Clear(),g}h(_ee,"renderLineStringGeometry");R();var yn=100,Oxe=.22,Nxe=.01;function bee(i,e,t={}){let{width:r=Oxe,height:n=Nxe,color:a="gray",opacity:o=1,altitude:s=0}=t,l={min:{x:1/0,y:1/0,z:s},max:{x:-1/0,y:-1/0,z:s+n}},u={bevelEnabled:!1,depth:n},c=new Ca.ClipperOffset,p=i.geometry.coordinates.map(b=>b.map(x=>e(x[1],x[0])));c.AddPaths(p.map(b=>b.map(x=>({X:x.x*yn,Y:x.y*yn}))),Ca.JoinType.jsMiter,Ca.EndType.etOpenRound);let d=new Ca.PolyTree;c.Execute(d,r/2*yn);let m=[];for(let b of d.m_AllPolys){let x=new nd;if(b.IsHole())continue;l.min.x=Math.min(l.min.x,b.m_polygon[0].X),l.min.y=Math.min(l.min.y,b.m_polygon[0].Y),l.max.x=Math.max(l.max.x,b.m_polygon[0].X),l.max.y=Math.max(l.max.y,b.m_polygon[0].Y);let v=b.m_polygon;x.moveTo(v[0].X/yn,v[0].Y/yn),v.slice(1).forEach(w=>x.lineTo(w.X/yn,w.Y/yn)),x.lineTo(v[0].X/yn,v[0].Y/yn),x.holes=b.m_Childs.map(w=>{let _=new jp,C=w.m_polygon;return _.moveTo(C[0].X/yn,C[0].Y/yn),C.slice(1).forEach(E=>_.lineTo(E.X/yn,E.Y/yn)),_.lineTo(C[0].X/yn,C[0].Y/yn),_}),m.push(new og(x,u))}let g=sd(m);return g.translate(0,0,s||0),g.userData={style:{color:a,opacity:o}},c.Clear(),g}h(bee,"renderMultiLineStringGeometry");R();var t0,i0,wee=class{constructor(e){ie(this,"mesh"),ie(this,"type","model"),ie(this,"outline"),ie(this,"geometry"),ie(this,"material"),ie(this,"feature"),ie(this,"instanceIndex",-1),ie(this,"visible",!0),ie(this,"color",new Lt),ie(this,"position",new le),fe(this,t0,0),fe(this,i0,1),this.feature=e}setOpacity(){}setColor(){}get altitude(){return M(this,t0)}set altitude(e){this.mesh&&(this.mesh.position.z=e,ke(this,t0,e))}get opacity(){return M(this,i0)}set opacity(e){var t,r;if(this.mesh){for(let n of this.mesh.children)if(n instanceof xq){((t=n.userData)==null?void 0:t.originalOpacity)===void 0&&(n.userData.originalOpacity=n.material.opacity);let a=yh(e,0,(r=n.userData)==null?void 0:r.originalOpacity,0,1);n.material.opacity=a,n.material.transparent=a<1,n.material.needsUpdate=!0}}ke(this,i0,e)}};t0=new WeakMap,i0=new WeakMap,h(wee,"ModelComponent");var r0=wee;function See(i){let{color:e,opacity:t,topColor:r,texture:n,topTexture:a}=i;return`${e}${t}${r||""}${n||""}${a||""}`}h(See,"generateIndex");var $xe=1e4,Mee=class extends Hr{constructor(t,r){super();Z(this,"state");Z(this,"convertTo3DMapPosition");Z(this,"loader");this.state=t,this.convertTo3DMapPosition=r}async getGLTFLoader(){if(this.loader)return;let{GLTFLoader:t}=await zm(()=>import("./GLTFLoader-EMLQBTUW-CjY2va8x.js"),[]);this.loader=new t}createEntityFromFeature(t,r,n){let a=new Ho(r),o=new Vn(a,new zv(n));return o.id=t,o}createModelFromFeature(t,r,n){let a=new r0(r),o=new Vn(a,new zv(n));return o.id=t,o}populateEntityMesh(t,r){let n=t.components[0];n.geometry=r}async populateModelGroup(t,r,n){let a=new jt,o=new $a,s=new dh,l=new le,u=new n_;return this.loader||await this.getGLTFLoader(),this.loader.load(r,c=>{var p,d,m,g,b,x;c.scene.traverse(_=>{let C=_;if("isMesh"in C&&C.isMesh===!0){let E=new xq(C.geometry,C.material,t.size);E.userData={entities:{}},u.add(E),n.add(u)}});let v=0,w;for(let _ of t.values()){w=this.state.entity3DMap.get(_);let C=w.components[0],E=w.components[0].feature;C.mesh=u,C.instanceIndex=v;let{x:T,y:L,z:D}=this.convertTo3DMapPosition(E.geometry.coordinates[1],E.geometry.coordinates[0],0);C.position.set(T,L,D),o.set(((p=E.properties.rotation)==null?void 0:p[0])||0,((d=E.properties.rotation)==null?void 0:d[1])||0,((m=E.properties.rotation)==null?void 0:m[2])||0),l.set(((g=E.properties.scale)==null?void 0:g[0])||1,((b=E.properties.scale)==null?void 0:b[1])||1,((x=E.properties.scale)==null?void 0:x[2])||1),s.setFromEuler(o),a.compose(C.position,s,l),u.children.forEach(B=>{let A=B;A.setMatrixAt(v,a),A.userData.entities[v]=w.id}),v++}this.publish("model-loaded")}),u}populateEntityGroup(t){let r,n,a,o;for(let s of t.values())o=this.state.entity3DMap.get(s),o.components[0]instanceof Ho&&(n=o.components[0].feature,a=o.components[1],n.geometry.type==="Polygon"?(r=yee(n,this.convertTo3DMapPosition,a),this.populateEntityMesh(o,r)):n.geometry.type==="MultiPolygon"?(r=vee(n,this.convertTo3DMapPosition,a),this.populateEntityMesh(o,r)):n.geometry.type==="LineString"?(r=_ee(n,this.convertTo3DMapPosition,a),this.populateEntityMesh(o,r)):n.geometry.type==="MultiLineString"&&(r=bee(n,this.convertTo3DMapPosition,a),this.populateEntityMesh(o,r)));return t}optimize(t){if(t.visible&&(t instanceof ks||t instanceof ca)){for(let a of t.children)this.optimize(a);if(t instanceof ca||t.userData.dirty===!1)return;let r={};if(!t.userData.modelURL&&t.userData.dirty)try{this.populateEntityGroup(t.userData.entities3D)}catch(a){Ft.warn(a)}else t.userData.modelURL&&t.userData.dirty&&(this.populateModelGroup(t.userData.entities3D,t.userData.modelURL,t),t.userData.dirty=!1);let n=0;if(t.userData.dirty){let a=0,o;for(let s of t.userData.entities3D.values()){o=this.state.entity3DMap.get(s);let l=o.components[0],u=o.components[1];if(l instanceof Ho){a++,a>=$xe&&(a=0,n++);let c=See(u)+n;r[c]===void 0&&(r[c]={style:u,entities:[]}),r[c].entities.push(o)}else l.mesh&&l.mesh.parent!==t&&t.add(l.mesh)}for(let s in r){let l=mee(r[s].entities,r[s].style);t.add(l),t.userData.outlineDirty=!0,t.userData.dirty=!1}}}}update(){this.optimize(this.state.entityScene)}};h(Mee,"MeshCreationAndOptimizationSystem");var Uxe=Mee;R();var Cee=class{constructor(e,t){Z(this,"state");Z(this,"dirty",!0);Z(this,"domTree");this.state=e,this.domTree=t}update(){if(this.dirty){let e;for(let t of Array.from(this.domTree.children))if(e=this.state.entity2DMap.get(t.userData.entityId),e){let r=e.components[0];(!r.enabled||!r.visible||!this.state.entity2DIds.has(t.userData.entityId))&&this.domTree.removeChild(t)}else this.domTree.removeChild(t);for(let t of this.state.entity2DIds)if(e=this.state.entity2DMap.get(t),e){let r=e.components[0];r instanceof bp&&r.enabled&&r.containerEl&&!this.domTree.contains(r.containerEl)&&(r.containerEl.userData={entityId:e.id},this.domTree.appendChild(r.containerEl),r.updateDimensions())}this.dirty=!1}}};h(Cee,"DOMVisibilitySystem");var Vxe=Cee;R();var Eee=class{constructor(e,t){Z(this,"state");Z(this,"project");this.state=e,this.project=t}update(){let e;for(let t of this.state.entity2DIds)e=this.state.entity2DMap.get(t),e&&this.project(e.components[0].projection,e.position)}};h(Eee,"TwoDProjectionSystem");var jxe=Eee;R();R();var Hxe=h(function(){let i,e;return t=>{if((!e||!e)&&(i=document.createElement("canvas"),i.width=500*t,i.height=500*t,i.style.width="500px",i.style.height="500px",e=i.getContext("2d")),!e)throw new Error("Could not get 2D context");return{measureCanvas:i,measureCanvasContext:e}}},"createMeasureCanvasContext")(),Gxe=h(({text:i,size:e,maxWidth:t,pixelRatio:r,maxLines:n=2,lineHeight:a=1.2,options:o={strokeText:!0}})=>{let s=`bold ${e*r}px 'InterUI-Regular', Helvetica Neue, Arial, sans-serif`,{measureCanvasContext:l}=Hxe(r);l.font=s;let u=[],c=i.split(" "),p=0,d=0,m=0;for(;d<c.length;){let x=c[d];if(p===n&&p>0){u[p-1]+="...";break}if(u[p]==null&&(u[p]=x,d++),c.length===1){u[p]=x;break}if(c[d]==null)break;let{width:v}=l.measureText(u[p]+" "+c[d]);v<=t*r?(u[p]+=" "+c[d],d++):p++}u.forEach(x=>{let{width:v}=l.measureText(x);m=Math.max(v,m)});let g=e*r*a,b=u.length*g;return{maxWidth:m,maxHeight:b,lines:u.length,draw:(x,v,w)=>{u.length===1?(o.strokeText&&x.strokeText(u[0],v,w),x.fillText(u[0],v,w)):(o.strokeText&&(x.strokeText(u[0],v,w-g/2),x.strokeText(u[1],v,w+g/2)),x.fillText(u[0],v,w-g/2),x.fillText(u[1],v,w+g/2))}}},"shaveText"),Wxe=4.5,Xxe=2.5,qxe=2,Zxe=5,Fd=2.5,Tee=class{constructor(e,t){Z(this,"dirty",!1);Z(this,"state");Z(this,"colliderContext");Z(this,"colliderCanvas");Z(this,"pinCache",{});Z(this,"imagePromiseCache",{});Z(this,"imageDimensionsCache",{});Z(this,"textCache",{});Z(this,"update",(e,t,r)=>{let n=(e-t)/(r-t),a=this.state.pixelRatio;this.colliderContext.clearRect(0,0,this.colliderCanvas.width,this.colliderCanvas.height);let o,s,l,u,c,p;for(let d of this.state.entity2DIds)if(p=this.state.entity2DMap.get(d),p!=null&&p.components[0]instanceof _p&&!p.disposed){if(c=p.components[0],s=c.appearance.marker.foregroundColor,l=c.appearance.marker.backgroundColor,u=c.markerSize,o=`${s.active}-${s.inactive}-${l.active}-${l.inactive}-${u}`,this.pinCache[o]||this.prepare(c,o,this.colliderContext),c.appearance.marker.icon&&!c.imageHash&&this.cacheImage(c),this.textCache[c.id]==null||c.dirty||this.dirty){c.dirty=!1,c.collisionDirty=!0,this.textCache[c.id]={};let{textDrawFn:m,width:g,height:b}=this.processText(c.text,c.appearance.text.size,c.appearance.text.maxWidth,c.appearance.text.numLines,c.appearance.text.lineHeight);["left","center","right"].forEach(v=>{this.textCache[c.id][v]=this.textToCanvas(m,c.appearance.text.size,v,g,b,c.appearance.text.foregroundColor,c.appearance.text.backgroundColor)}),c.dimensions={width:Math.ceil(g/a),height:Math.ceil(b/a)},c.currentStrategyIndex===-1&&(c.currentStrategyIndex=0);let x=c.strategies[c.currentStrategyIndex];if(x){x.onStrategySelected(c);let v=c.style;c.style=c.newStyle,c.newStyle=v}}c.visible&&c.enabled&&(c.zoomProportion=n,this.draw(c,o,this.colliderContext))}this.dirty=!1});Z(this,"processText",(e,t,r,n,a)=>{let o=this.state.pixelRatio,{draw:s,maxWidth:l,maxHeight:u}=Gxe({text:e,size:t,pixelRatio:o,maxWidth:r,maxLines:n,lineHeight:a});return{textDrawFn:s,width:l+Fd*o*2,height:u+Fd*o*2}});Z(this,"textToCanvas",(e,t,r,n,a,o,s)=>{let l=this.state.pixelRatio,u,c=n,p=a;window.OffscreenCanvas!=null&&!nxe()?u=new OffscreenCanvas(c,p):(u=document.createElement("canvas"),u.width=c,u.height=p,u.style.width=c+"px",u.style.height=p+"px");let d=u.getContext("2d",{willReadFrequently:!0});if(!d)return;d.textAlign=r,d.font=`bold ${t*l}px 'InterUI-Regular', Helvetica Neue, Arial, sans-serif`,d.textBaseline="middle",d.lineJoin="miter",d.miterLimit=2,d.strokeStyle="white",d.lineWidth=Fd*l,d.fillStyle=o,d.strokeStyle=s;let m=r==="left"?0:r==="center"?c/2:c-Fd*l/2;return e(d,m,(p+Fd*l/2)/2),u});Z(this,"cacheImage",e=>{if(!e.appearance.marker.icon)return;let t=oQ(e.appearance.marker.icon);if(e.imageHash=t,!this.imagePromiseCache[t]){let r=["png","jpg","jpeg"],n=e.appearance.marker.icon.split("?")[0],a=r.some(s=>n.toLowerCase().endsWith(s)),o=new Image;a?o.src=e.appearance.marker.icon:o.src=`data:image/svg+xml;base64, ${btoa(e.appearance.marker.icon)}`,o.onload=()=>{this.imagePromiseCache[t]=o}}});Z(this,"createPinCanvas",(e,t,r,n)=>{let a,o=this.state.pixelRatio,s=e.totalMarkerSize*2*o;window.OffscreenCanvas!=null?a=new OffscreenCanvas(s,s):(a=document.createElement("canvas"),a.width=s,a.height=s,a.style.width=s/o+"px",a.style.height=s/o+"px");let l=a.getContext("2d");return l.shadowColor="rgba(0,0,0,0.3)",l.shadowOffsetY=qxe*o,l.shadowBlur=Zxe*o,l.beginPath(),l.arc(s/2,s/2,t/2+Xxe*o/2,0,2*Math.PI),l.fillStyle=r,l.fill(),l.beginPath(),l.arc(s/2,s/2,t/2,0,2*Math.PI),l.shadowColor="transparent",l.fillStyle=n,l.fill(),a});Z(this,"prepare",(e,t,r)=>{let n=this.state.pixelRatio;r.lineWidth=4*n;let a=this.createPinCanvas(e,e.markerSize,e.appearance.marker.backgroundColor.active,e.appearance.marker.foregroundColor.active),o=this.createPinCanvas(e,e.iconVisible?e.markerSize:Wxe*n,e.appearance.marker.backgroundColor.inactive,e.appearance.marker.foregroundColor.inactive);this.pinCache[t]=[a,o]});this.state=e,this.colliderCanvas=t,this.colliderContext=t.getContext("2d")}draw(e,t,r){if(!e.visible)return;r.save(),r.globalAlpha=e.opacity;let n=this.state.pixelRatio,a=e.projection.x*n,o=e.projection.y*n,s=e.style.pinVisibility===1?this.pinCache[t][0]:this.pinCache[t][1];if(r.drawImage(s,a-e.totalMarkerSize*n,o-e.totalMarkerSize*n),e.appearance.marker.icon&&e.iconVisible&&e.imageHash&&e.appearance.marker.iconSize&&this.imagePromiseCache[e.imageHash]){let l=this.imagePromiseCache[e.imageHash],u=(e.appearance.marker.iconSize-e.appearance.marker.iconPadding)*n,{iconFit:c}=e.appearance.marker,p=u,d=u,m=`${e.imageHash}_${c}`;if(this.imageDimensionsCache[m])p=this.imageDimensionsCache[m].width,d=this.imageDimensionsCache[m].height;else{let g=l.width*n,b=l.height*n;if(c==="contain"){let x=Math.sqrt(g**2+b**2),v=u/x;p=g*v,d=b*v}if(c==="cover"){let x=u/g,v=u/b,w=Math.max(x,v);p=g*w,d=b*w}}r.save(),r.beginPath(),r.arc(a,o,u/2,0,2*Math.PI),r.closePath(),r.clip(),r.drawImage(l,a-p/2,o-d/2,p,d),r.restore()}e.style.textLabelVisible&&e.style.textAlign!=null&&e.style.left&&e.style.top&&r.drawImage(this.textCache[e.id][e.style.textAlign],a+e.style.left*n,o+e.style.top*n),r.restore()}};h(Tee,"TwoDDrawSystem");var Yxe=Tee;R();R();var xM=class Ef{constructor(){Z(this,"loader");this.loader=new DE}static getInstance(){return Ef.instance||(Ef.instance=new Ef),Ef.instance}getLoader(){return this.loader}};h(xM,"TextureLoaderSingleton"),ie(xM,"instance");var Jxe=xM,Pee=Jxe.getInstance();function Aee(i,e){let t=i.components[2],r=i.components[1];return t!=null&&t.hover?[r.hoverColor||e,r.hoverColor||e]:[r.color,r.topColor||r.color]}h(Aee,"processColor");var n0,_M,Iee=class extends Hr{constructor(e){super(),fe(this,n0),ie(this,"state"),ie(this,"textureCache",new Map),this.state=e}setShading(e,t){e.material&&e.material.setGradientShading(t.start,t.end,t.intensity)}update(){var e,t,r;let n,a,o,s;for(let l of this.state.threeDEntities)if(s=this.state.entity3DMap.get(l),s instanceof ks&&s.type==="geometry-group"){if(s.userData.shadingDirty){a=s.components[0];let u=s.userData.entities3D.values().next().value,c=this.state.entity3DMap.get(u);c instanceof Vn&&(c.type==="geometry"||c.type==="custom-geometry")&&(n=c.components[0],s.userData.shadingDirty&&a.shading&&this.setShading(n,a.shading)),s.userData.shadingDirty=!1}}else if(s instanceof Vn&&(s.type==="geometry"||s.type==="custom-geometry")&&((e=s.components[1])!=null&&e.dirty||(t=s.components[2])!=null&&t.dirty)){n=s.components[0],a=s.components[1],o=s.components[2];let u=Aee(s,this.state.hoverColor);n.setColor(u[0],u[1]),a.visible!==n.visible&&(n.visible=a.visible),a.altitude!==n.altitude&&(n.altitude=a.altitude),a.opacity!==n.opacity&&(n.opacity=a.opacity),a.dirty=!1,a.texture!==n.texture&&Ot(this,n0,_M).call(this,a.texture,n,"texture"),a.topTexture!==n.topTexture&&Ot(this,n0,_M).call(this,a.topTexture,n,"topTexture"),(n.texture||n.topTexture)&&(o!=null&&o.hover&&n.texturesVisible?n.hideTextures():n.texturesVisible||n.showTextures()),s.components[2]&&(s.components[2].dirty=!1)}else(s==null?void 0:s.type)==="model"&&(r=s.components[1])!=null&&r.dirty&&(n=s.components[0],a=s.components[1],a.opacity!==n.opacity&&(n.opacity=a.opacity),a.dirty=!1)}destroy(){this.textureCache.forEach(e=>{e.dispose()}),this.textureCache.clear()}};n0=new WeakSet,_M=h(function(i,e,t){if(!(!i||!e.showTextures)){if(this.textureCache.has(i)){t==="topTexture"?e.topTexture=this.textureCache.get(i):e.texture=this.textureCache.get(i),e.showTextures();return}Pee.getLoader().load(i,r=>{t==="topTexture"?e.topTexture=r:e.texture=r,this.textureCache.set(i,r),e.showTextures(),this.publish("texture-loaded")},void 0,()=>{Ft.error(`Failed to load texture: ${i}`)})}},"#loadTexture"),h(Iee,"DrawSystem");var Kxe=Iee;R();var Lee=class extends Hr{constructor(t){super();Z(this,"state");Z(this,"animating",new Map);Z(this,"isAnimating",!1);Z(this,"startTime",-1);Z(this,"duration",500);Z(this,"update",()=>{this.animating.clear();let t,r;for(let n of this.state.entity2DIds)t=this.state.entity2DMap.get(n),t&&(r=t.components[0],r instanceof _p&&r.visibilityNeedsUpdate&&(r.visible?this.animating.set(r,r.opacity):(r.opacity=0,r.visibilityNeedsUpdate=!1)));this.startTime=performance.now(),this.publish("animate:2d")});Z(this,"playAnimations");this.state=t,this.playAnimations=this._playAnimations}_playAnimations(){let t=performance.now();for(let[r,n]of this.animating.entries()){let a=(t-this.startTime)/this.duration;r.opacity=yh(a,0,1,n,1),t-this.startTime>=this.duration&&(r.visible=!0,r.visibilityNeedsUpdate=!1,this.animating.delete(r))}this.publish("draw:2d"),this.animating.size>0&&this.publish("animate:2d")}};h(Lee,"TwoDVisibilitySystem");var Qxe=Lee;R();var Dee=class extends Hr{constructor(t,r,n,a,o,s,l){super();Z(this,"state");Z(this,"renderer");Z(this,"mode");Z(this,"scene");Z(this,"cameraObject");Z(this,"viewCamera");Z(this,"systems");Z(this,"twoDdirty",!0);Z(this,"threeDdirty",!0);Z(this,"frameId",null);Z(this,"twoDFrameId",null);Z(this,"animationFrameId",null);Z(this,"nextFrame",null);Z(this,"update",(t=!1)=>{var r;if(((r=this.renderer)==null?void 0:r.renderer)!=null)if(t)this.commitRenderState(),this.paint();else{if(this.frameId)return;this.frameId=requestAnimationFrame(()=>{var n;((n=this.renderer)==null?void 0:n.renderer)!=null&&this.mode==="standalone"&&(this.commitRenderState(),this.paint())})}});Z(this,"animate2D",()=>{this.animationFrameId=requestAnimationFrame(()=>{this.animationFrameId=null,this.systems.twoDVisiblitySystem.playAnimations()})});Z(this,"drawEntities2D",()=>{this.twoDFrameId||(this.twoDFrameId=requestAnimationFrame(()=>{this.twoDFrameId=null,this.systems.twoDDrawSystem.update(this.systems.cameraSystem.getZoomAltitude(),this.systems.cameraSystem.getZoomScaledMin(),this.systems.cameraSystem.getZoomScaledMax())}))});Z(this,"updateEntities2D",()=>{this.animationFrameId&&(cancelAnimationFrame(this.animationFrameId),this.animationFrameId=null),this.twoDFrameId=requestAnimationFrame(()=>{this.twoDFrameId=null,this.systems.watermarkSystem.insertIntoQuadTree(this.systems.collisionSystem.interactiveCollidersQTree),this.systems.interactionSystem.updateQuadtree(this.systems.collisionSystem.interactiveCollidersQTree),this.systems.twoDVisiblitySystem.update(),this.systems.twoDDrawSystem.update(this.systems.cameraSystem.getZoomAltitude(),this.systems.cameraSystem.getZoomScaledMin(),this.systems.cameraSystem.getZoomScaledMax()),this.systems.domDrawSystem.update(this.systems.cameraSystem.isUserInteracting())})});Z(this,"commitRenderState",()=>{this.frameId=null,(this.mode==="outdoors-interleaved"||this.mode==="standalone")&&this.systems.cameraSystem.update(),this.scene.updateMatrixWorld(),this.state.shouldMeasureCanvas&&(this.state.shouldMeasureCanvas=!1,this.publish("measure-canvas")),this.twoDdirty&&(this.state.entity2DIds.clear(),rQ(this.state.entityScene,this.state.entity2DIds),this.systems.domVisiblitySystem.dirty=!0,this.systems.collisionSystem.dirty=!0,this.systems.domMutationSystem.dirty=!0,this.systems.panBoundsSystem.dirty=!0,this.twoDdirty=!1),this.threeDdirty&&(this.state.threeDEntities=[],iQ(this.state.entityScene,this.state.threeDEntities),this.threeDdirty=!1,this.systems.interactionSystem.dirty3D=!0,this.systems.panBoundsSystem.dirty=!0,this.systems.outlineInterpolationSystem.geometries3DDirty=!0,this.systems.geometryInFocusSystem.focusablesDirty=!0),this.systems.meshOptimizationSystem.update(),this.systems.customGeometrySystem.update(),this.systems.panBoundsSystem.update(),this.systems.geometryInFocusSystem.update(),this.systems.stackSystem.update(),this.systems.drawSystem.update(),this.systems.outlineInterpolationSystem.update(this.systems.cameraSystem.getZoomLevel(),this.systems.cameraSystem.zoomDirty),this.systems.pathSystem.update(this.systems.cameraSystem.minZoomAltitude,this.systems.cameraSystem.maxZoomAltitude,this.systems.cameraSystem.getZoomAltitude()),this.systems.cameraSystem.postRender(),this.systems.domVisiblitySystem.update(),this.systems.domMutationSystem.update(),this.systems.twoDProjectionSystem.update(),this.systems.twoDDrawSystem.update(this.systems.cameraSystem.getZoomAltitude(),this.systems.cameraSystem.getZoomScaledMin(),this.systems.cameraSystem.getZoomScaledMax()),this.systems.domDrawSystem.update(this.systems.cameraSystem.isUserInteracting()),this.systems.watermarkSystem.update(),this.nextFrame=requestAnimationFrame(()=>{this.systems.collisionSystem.update(this.systems.watermarkSystem.width,this.systems.watermarkSystem.height)}),this.systems.cameraSystem.dirty=!1,this.systems.cameraSystem.zoomDirty=!1});this.renderer=t,this.state=r,this.mode=n,this.scene=a,this.cameraObject=o,this.viewCamera=s,this.systems=l,this.systems.collisionSystem.on("visibility-changed",this.updateEntities2D),this.systems.twoDVisiblitySystem.on("draw:2d",this.drawEntities2D),this.systems.twoDVisiblitySystem.on("animate:2d",this.animate2D)}paint(){var t;(t=this.renderer)!=null&&t.renderer&&(this.mode==="standalone"?(this.renderer.clear(),this.renderer.render(this.scene,this.cameraObject)):this.renderer.render(this.scene,this.viewCamera))}destroy(){this.frameId&&cancelAnimationFrame(this.frameId),this.twoDFrameId&&cancelAnimationFrame(this.twoDFrameId),this.animationFrameId&&cancelAnimationFrame(this.animationFrameId),this.nextFrame&&cancelAnimationFrame(this.nextFrame),this.state.entity2DIds.clear(),this.state.threeDEntities=[],this.systems.domVisiblitySystem.dirty=!0,this.systems.collisionSystem.dirty=!0,this.update(),this.systems.collisionSystem.off("visibility-changed",this.updateEntities2D),this.systems.twoDVisiblitySystem.off("draw:2d",this.drawEntities2D),this.systems.twoDVisiblitySystem.off("animate:2d",this.animate2D)}};h(Dee,"RenderSystem");var e_e=Dee;R();var Tf,a0,kee=class{constructor(e,t){ie(this,"type","path"),ie(this,"mesh",new n_),ie(this,"material"),ie(this,"geometry"),ie(this,"outline"),ie(this,"feature"),ie(this,"options"),ie(this,"nearRadius",.2),ie(this,"farRadius",.4),ie(this,"color","#ff834c"),ie(this,"accentColor","blue"),fe(this,Tf,1),ie(this,"altitudeAdjustment",1),ie(this,"displayArrowsOnPath",!1),ie(this,"animateArrowsOnPath",!1),ie(this,"dirty",!0),ie(this,"position",new le),fe(this,a0,0);var r,n,a,o,s,l;this.feature=e,this.options=t||{},this.color=(r=t==null?void 0:t.color)!=null?r:this.color,this.accentColor=(n=t==null?void 0:t.accentColor)!=null?n:this.accentColor,this.nearRadius=(a=t==null?void 0:t.nearRadius)!=null?a:this.nearRadius,this.farRadius=(o=t==null?void 0:t.farRadius)!=null?o:this.farRadius,this.displayArrowsOnPath=(s=t==null?void 0:t.displayArrowsOnPath)!=null?s:this.displayArrowsOnPath,this.animateArrowsOnPath=(l=t==null?void 0:t.animateArrowsOnPath)!=null?l:this.animateArrowsOnPath}setColor(){}setOpacity(){}set completeFraction(e){ke(this,Tf,e),this.mesh&&this.mesh.children.forEach(t=>{t.material.uniforms.complete.value=M(this,Tf),t.material.needsUpdate=!0})}get completeFraction(){return M(this,Tf)}set visible(e){this.mesh&&(this.mesh.visible=e)}get visible(){return this.mesh?this.mesh.visible:!1}get altitude(){return M(this,a0)}set altitude(e){this.mesh&&(this.mesh.position.z=e,ke(this,a0,e))}set complete(e){this.material&&(this.material.uniforms.complete.value=e,this.material.needsUpdate=!0)}};Tf=new WeakMap,a0=new WeakMap,h(kee,"PathComponent");var t_e=kee;R();var Ree=class{constructor(e){Z(this,"rendererState");this.rendererState=e}update(){let e;for(let t of this.rendererState.threeDEntities)if(e=this.rendererState.entity3DMap.get(t),e instanceof ca&&e.components[0]){let r=e.components[0];if(r.dirty){for(let n of e.children)(n instanceof ks||n instanceof ca)&&(n.userData.entityId!==e.components[0].activeId?n.setVisible(!1):n.setVisible(!0));r.dirty=!1}}}};h(Ree,"StackSystem");var i_e=Ree;R();R();var I1=It(hg());R();R();R();var r_e=h((i,e)=>(e-i+Math.PI)%(Math.PI*2)+Math.PI*2%(Math.PI*2)-Math.PI,"differenceBetweenAngles"),n_e=h((i,e)=>new Oe(i.clientX-e.offsetLeft,i.clientY-e.offsetTop),"getTouchPos"),_I=h((i,e)=>Math.atan2(e.y-i.y,e.x-i.x),"angle"),L1=h((i,e)=>Math.sqrt((e.y-i.y)**2+(e.x-i.x)**2),"distance"),bI=h((i,e)=>new Oe((i.x+e.x)/2,(i.y+e.y)/2),"average"),wI=h(i=>{let e=0,{wheelDelta:t,detail:r}=i;return t!==void 0?e=t:r!==void 0&&(e=-r),e},"getScrollDelta"),Fee=class{constructor(e,t){Z(this,"input1");Z(this,"input2");Z(this,"lastAngle");Z(this,"lastDistance");Z(this,"totalDistance");Z(this,"first");Z(this,"second");this.input1=e,this.input2=t,this.lastAngle=_I(e,t),this.lastDistance=L1(e,t),this.totalDistance=0,this.first=e,this.second=t}update(e,t){let r=L1(e,t);this.input1=e,this.input2=t;let n=_I(e,t);this.lastAngle=n,this.lastDistance=r,this.totalDistance+=(L1(this.first,e)+L1(this.second,t))/2,this.first=bI(this.first,e),this.second=bI(this.second,t)}};h(Fee,"InputSet");var a_e=Fee;R();var zee=class{constructor(e,t,r){Z(this,"touch");Z(this,"camera");Z(this,"cameraPlane");Z(this,"viewCoordinate");Z(this,"snapHolderMatrix");Z(this,"snapCamera");Z(this,"cameraPosition");Z(this,"raycaster");Z(this,"worldCoordinate");Z(this,"snapshotted",!1);this.touch=e,this.camera=t,this.cameraPlane=r,this.viewCoordinate={x:e.x,y:e.y},this.camera.updateMatrixWorld(),this.camera.updateMatrix(),this.snapHolderMatrix=this.camera.matrixWorld.clone(),this.snapCamera=this.camera.clone(),this.snapshotCameraState()}snapshotCameraState(){this.camera.updateMatrix(),this.camera.updateMatrixWorld(),this.cameraPosition=this.camera.position.clone();let e=new Oe(this.viewCoordinate.x,this.viewCoordinate.y);this.raycaster=this.raycaster||new ug,this.raycaster.setFromCamera(e,this.snapCamera);let t=this.raycaster.intersectObject(this.cameraPlane,!0);this.worldCoordinate=t&&t.length>0?t[0].point:null,this.snapshotted=!0}updateAnchorState(e,t){this.camera=e,this.snapCamera=e.clone(),this.snapHolderMatrix=e.matrixWorld.clone(),this.updateViewCoordinate(t),this.snapshotCameraState()}updateViewCoordinate(e){this.viewCoordinate={x:e.x,y:e.y}}reUnproject(){var e,t;let r=new Oe(this.viewCoordinate.x,this.viewCoordinate.y);(e=this.raycaster)==null||e.setFromCamera(r,this.snapCamera);let n=(t=this.raycaster)==null?void 0:t.intersectObject(this.cameraPlane,!0)[0];return n?n.point:void 0}};h(zee,"TouchAnchor");var SI=zee,wc,bM,Bee=class extends Hr{constructor(e,t,r,n,a){super(),ie(this,"dirty",!1),ie(this,"zoomDirty",!1),ie(this,"zoomSpeed",5),ie(this,"rotateSpeed",100),ie(this,"enabled",!0),ie(this,"enableZoom",!0),ie(this,"enablePan",!0),ie(this,"enablePedestal",!1),ie(this,"maxPedestal",1/0),ie(this,"minPedestal",0),ie(this,"enableRotate",!0),ie(this,"minZoomAltitude",0),ie(this,"maxZoomAltitude",1/0),ie(this,"ignoreZoomLimits",!1),ie(this,"zoomFactor",1),ie(this,"panBounds",{min:new le(1/0,1/0),max:new le(-1/0,-1/0),center:new le(0,0,0),radius:1/0}),ie(this,"minTilt",0),ie(this,"maxTilt",1.2),ie(this,"MOUSE_BUTTONS",{ORBIT:K_.RIGHT,ZOOM:K_.MIDDLE,PAN:K_.LEFT}),ie(this,"camera"),ie(this,"scene"),ie(this,"renderer"),ie(this,"elevation"),ie(this,"orbit"),ie(this,"cameraPlane"),ie(this,"raycaster",new ug),ie(this,"rendererState"),ie(this,"options"),ie(this,"state",-1),ie(this,"intersection"),ie(this,"viewState",null),ie(this,"tweens",new Set),ie(this,"clock",new Vye(!0)),ie(this,"coords",{mouse:new Oe,rotateStart:new Oe,rotateEnd:new Oe,rotateDelta:new Oe,panStart:new le,panCameraStart:new le,panEnd:new le,panDelta:new le,initialShiftPos:new Oe,initialPedestal:0,floorAnchor:new le}),ie(this,"touch",{origin:{offsetLeft:0,offsetTop:0},touches:[],anchor1:null,anchor2:null,inputs:null}),ie(this,"scrollTimer",null),ie(this,"lastWheelTime",0),ie(this,"resetZoom",!1),ie(this,"zoomStart"),ie(this,"pedestalScaleFactor",1),ie(this,"isUserZooming",!1),ie(this,"stayInsideBounds",!0),ie(this,"userInteracting",!1),ie(this,"raycastToFloor",o=>{this.raycaster.setFromCamera(o,this.camera);let s=this.raycaster.intersectObject(this.cameraPlane,!1)[0];return s?s.point:new le}),ie(this,"isUserInteracting",()=>this.userInteracting),ie(this,"getPosition",()=>new le(this.orbit.position.x,this.orbit.position.y,this.orbit.position.z)),ie(this,"getPedestal",()=>this.orbit.position.z),ie(this,"pan",(o,s)=>{isNaN(o)||isNaN(s)||(this.setPosition(this.orbit.position.x+o,this.orbit.position.y+s),this.publish("position-updated"))}),ie(this,"postRender",()=>{(this.state===2||this.state===6)&&(this.raycaster.setFromCamera(this.coords.mouse,this.camera),this.intersection=this.raycaster.intersectObject(this.cameraPlane,!1)[0],this.intersection&&(this.coords.panStart.set(this.intersection.point.x,this.intersection.point.y,0),this.coords.panCameraStart.set(this.orbit.position.x,this.orbit.position.y,0))),this.state===3&&this.resetZoom&&(this.resetZoom=!1,this.zoomStart=this.getZoomAltitude(),this.coords.floorAnchor=this.raycastToFloor(this.coords.mouse),this.coords.panCameraStart.set(this.orbit.position.x,this.orbit.position.y,0)),this.state===7&&this.isAnimating()===!1&&(this.state=-1,this.publish("multi-end"))}),ie(this,"isAnimating",()=>I1.default.getAll().some(o=>o._mMapAnimation)),ie(this,"isCameraMoving",()=>this.state!==-1),ie(this,"setPosition",(o,s)=>{o===void 0||s===void 0||isNaN(o)||isNaN(s)||(this.state===-1&&this.publish("pan-start"),this.updateCameraPosition(o,s),this.publish("position-updated"),this.publish("change"),this.state===-1&&this.publish("pan-end"),this.dirty=!0)}),ie(this,"updateCameraPosition",(o,s)=>{let l=o-this.panBounds.center.x,u=s-this.panBounds.center.y,c=Math.sqrt(l*l+u*u);if(this.stayInsideBounds&&c>this.panBounds.radius){let p=Math.atan2(u,l),d={x:Math.cos(p)*this.panBounds.radius+this.panBounds.center.x,y:Math.sin(p)*this.panBounds.radius+this.panBounds.center.y};this.orbit.position.x=d.x,this.orbit.position.y=d.y}else this.orbit.position.x=o,this.orbit.position.y=s}),ie(this,"tilt",o=>{if(isNaN(o))return;this.state===-1&&this.publish("rotate-start");let s=this.stayInsideBounds?Math.max(Math.min(o+this.getTilt(),this.maxTilt),this.minTilt):o+this.getTilt();s!==this.elevation.rotation.x&&(this.elevation.rotation.x=s,this.publish("tilt-updated")),this.publish("change"),this.state===-1&&this.publish("rotate-end")}),ie(this,"zoomIn",(o,s,l)=>{let u=this.getZoomAltitude();this.animateCamera({zoom:u/1.5},o,s,l)}),ie(this,"zoomOut",(o,s,l)=>{let u=this.getZoomAltitude();this.animateCamera({zoom:u*1.5},o,s,l)}),ie(this,"getRotation",()=>this.orbit.rotation.z),ie(this,"cancelAnimation",()=>{let o=Array.from(this.tweens),s=o[o.length-1];s.state===7&&this.publish("multi-cancel",{zooming:!0,rotating:!0,tilting:!0}),this.completeTween(s)}),ie(this,"animateCamera",(o,s,l,u,c,p)=>{let d={mode:uI.cancel,...p},m={},g={},b=this.getPosition();if(o.position!=null&&(o.position.x!==void 0&&(m.x=b.x,g.x=o.position.x),o.position.y!==void 0&&(m.y=b.y,g.y=o.position.y),o.position.z!==void 0&&(m.z=b.z,g.z=o.position.z)),o.zoom!==void 0&&(m.zoom=this.stayInsideBounds?Math.min(Math.max(this.getZoomAltitude(),this.getZoomScaledMin()),this.getZoomScaledMax()):this.getZoomAltitude(),this.viewState==="multi_floor"||!this.stayInsideBounds?g.zoom=o.zoom:g.zoom=Math.min(Math.max(o.zoom,this.getZoomScaledMin()),this.getZoomScaledMax())),o.rotation!==void 0){let L=m.rotation=this.getRotation(),D=o.rotation%(2*Math.PI),B=D-L;if(Math.abs(B)>Math.PI){let A=B<0?1:-1;g.rotation=D+2*Math.PI*A}else g.rotation=D}o.tilt!==void 0&&(m.tilt=this.getTilt(),this.viewState==="multi_floor"||!this.stayInsideBounds?g.tilt=o.tilt:g.tilt=Math.max(Math.min(o.tilt,this.maxTilt),this.minTilt));let x=m.zoom!==g.zoom,v=m.rotation!==g.rotation,w=m.tilt!==g.tilt,_=new I1.default.Tween(m).to(g,hr.env.TESTING?0:s).onUpdate(L=>{this.setMulti({x:L.x,y:L.y,z:L.z},L.zoom,L.rotation,L.tilt)}).onComplete(()=>{this.completeTween(_),this.publish("multi-end",{zooming:x,rotating:v,tilting:w}),u&&u()}).onStart(()=>{this.state!==7&&(this.state=7,_.state=7,this.publish("multi-start",{zooming:x,rotating:v,tilting:w})),this.publish("change")}),C=Array.from(this.tweens),E=C[C.length-1],T=!1;return E!=null&&(d.mode===uI.chain?(T=!0,E.chain(_)):(this.completeTween(E),typeof c=="function"&&c(),E=null)),this.tweens.add(_),l?_.easing(l):_.easing(I1.default.Easing.Quadratic.In),!o.doNotAutoStart&&!T&&(_.start(),this.publish("change")),_._mMapAnimation=!0,_}),ie(this,"setMulti",(o,s,l,u,c=!0)=>{this.state===-1&&this.publish("multi-start");let p=!1;o!=null&&(o.x!==void 0&&!isNaN(o.x)&&o.y!==void 0&&!isNaN(o.y)&&(this.updateCameraPosition(o.x,o.y),p=!0),o.z!==void 0&&!isNaN(o.z)&&(this.setPedestal(o.z,!0),p=!0)),p&&this.publish("position-updated");let d={zooming:!1,tilting:!!s,rotating:!1};if(s!==void 0&&!isNaN(s)){let m=this.stayInsideBounds?Math.min(Math.max(s,this.getZoomScaledMin()),this.getZoomScaledMax()):s;m!==this.camera.position.z&&(d.zooming=!0,this.camera.position.z=m,this.publish("zoom-updated"),this.zoomDirty=!0,this.viewState==="multi_floor"?s>V2&&(this.camera.near=s-V2,this.camera.far=s+V2):(this.camera.near=s/P1,this.camera.far=s*P1),this.camera.updateProjectionMatrix())}if(l!==void 0&&!isNaN(l)&&l!==this.orbit.rotation.z&&(d.rotating=!0,this.orbit.rotation.z=l,this.publish("rotation-updated")),u!==void 0&&!isNaN(u)){let m=this.stayInsideBounds?Math.max(Math.min(u,this.maxTilt),this.minTilt):u;m!==this.elevation.rotation.x&&(d.tilting=!0,this.elevation.rotation.x=m,this.publish("tilt-updated"))}c&&this.publish("change"),this.state===-1&&this.publish("multi-end",d)}),ie(this,"getZoomScaledMin",()=>this.minZoomAltitude*this.zoomFactor),ie(this,"getZoomScaledMax",()=>{let o=this.minZoomAltitude*this.zoomFactor;return Math.max(this.maxZoomAltitude,o)}),ie(this,"setRotation",(o,s)=>{if(isNaN(o))return;this.state===-1&&!s&&this.publish("rotate-start");let l=o%hI;l!==this.orbit.rotation.z&&(this.orbit.rotation.z=l,s||this.publish("rotation-updated")),s||this.publish("change"),this.state===-1&&!s&&this.publish("rotate-end"),this.dirty=!0}),ie(this,"setZoomAltitude",o=>{if(isNaN(o))return;this.state===-1&&this.publish("zoom-start");let s=this.stayInsideBounds?Math.min(Math.max(o,this.getZoomScaledMin()),this.getZoomScaledMax()):o;s!==this.camera.position.z&&(this.camera.position.z=s,this.publish("zoom-updated"),this.zoomDirty=!0),this.camera.near=s/P1,this.camera.far=s*P1,this.camera.updateProjectionMatrix(),this.publish("change"),this.state===-1&&this.publish("zoom-end"),this.dirty=!0}),ie(this,"setZoomLevel",o=>{this.setZoomAltitude(this.convertZoomLevelToAltitude(o))}),ie(this,"getZoomAltitude",()=>this.camera.position.z),ie(this,"getZoomLevel",()=>this.convertAltitudeToZoomLevel(this.getZoomAltitude())),ie(this,"rotate",o=>{if(isNaN(o))return;this.state===-1&&this.publish("rotate-start");let s=(this.orbit.rotation.z+o)%hI;s!==this.orbit.rotation.z&&(this.orbit.rotation.z=s,this.publish("rotation-updated")),this.publish("change"),this.state===-1&&this.publish("rotate-end")}),ie(this,"setTilt",(o,s)=>{if(isNaN(o))return;this.state===-1&&!s&&this.publish("rotate-start");let l=this.stayInsideBounds?Math.max(Math.min(o,this.maxTilt),this.minTilt):o;l!==this.elevation.rotation.x&&(this.elevation.rotation.x=l,s||this.publish("tilt-updated")),s||this.publish("change"),this.state===-1&&!s&&this.publish("rotate-end"),this.dirty=!0}),ie(this,"getTilt",()=>this.elevation.rotation.x),ie(this,"setCameraPlaneElevation",o=>{this.cameraPlane.position.z=o}),ie(this,"zoom",o=>{if(isNaN(o))return;this.state===-1&&this.publish("zoom-start");let s=this.getZoomAltitude()-o;this.camera.position.z=this.stayInsideBounds?Math.min(Math.max(s,this.minZoomAltitude*this.zoomFactor),this.maxZoomAltitude*this.zoomFactor):s,this.publish("zoom-updated"),this.zoomDirty=!0,this.publish("change"),this.state===-1&&this.publish("zoom-end")}),ie(this,"getProjectionScaleFactor",(o,s,l)=>JS(o,s,l)),ie(this,"update",()=>{I1.default.update(),this.lastWheelTime>0&&this.state===3&&this.clock.getElapsedTime()-this.lastWheelTime>.2&&(this.lastWheelTime=0,this.state=-1,this.publish("zoom-end"),this.removeMouseMoveEventListeners())}),ie(this,"setPedestal",(o,s=!1)=>{typeof o=="number"&&!isNaN(o)&&(this.orbit.position.z=o,s&&(this.publishPedestalChangeEvent(o),this.publish("change")),this.dirty=!0)}),ie(this,"dispose",()=>{for(let o of dI)o.endsWith("start")?this.off(o,this.setUserInteracting):o.endsWith("end")&&this.off(o,this.unsetUserInteracting);this.removeEventListeners(),this.scene.remove(this.cameraPlane)}),ie(this,"createCameraPlane",()=>{let o=new rg(1e10,1e10),s=new rd({color:0,visible:!1}),l=new Wi(o,s);return this.scene.add(l),l}),ie(this,"addEventListeners",()=>{let{domElement:o}=this.renderer;for(let s of dI)s.endsWith("start")?this.on(s,this.setUserInteracting):s.endsWith("end")&&this.on(s,this.unsetUserInteracting);o.addEventListener("contextmenu",this.onContextMenu,!1),o.addEventListener("mousedown",this.onMouseDown,!1),o.addEventListener("wheel",this.onMouseWheel,{passive:!1}),o.addEventListener("touchstart",this.onTouchStart,!1),o.addEventListener("touchend",this.onTouchEnd,!1),o.addEventListener("touchmove",this.onTouchMove,!1)}),ie(this,"addMouseEventListeners",()=>{this.addMouseMoveEventListeners(),window.addEventListener("mouseup",this.onMouseUp,!1),window.addEventListener("mouseout",this.onMouseUp,!1)}),ie(this,"addMouseMoveEventListeners",()=>{this.renderer.domElement.addEventListener("mousemove",this.onMouseMove,!1)}),ie(this,"removeMouseMoveEventListeners",()=>{this.renderer.domElement.removeEventListener("mousemove",this.onMouseMove,!1)}),ie(this,"removeEventListeners",()=>{let{domElement:o}=this.renderer;o.removeEventListener("contextmenu",this.onContextMenu,!1),o.removeEventListener("mousedown",this.onMouseDown,!1),o.removeEventListener("wheel",this.onMouseWheel,!1),o.removeEventListener("touchstart",this.onTouchStart,!1),o.removeEventListener("touchend",this.onTouchEnd,!1),o.removeEventListener("touchmove",this.onTouchMove,!1),o.removeEventListener("mousemove",this.onMouseMove,!1),window.removeEventListener("mouseup",this.onMouseUp,!1),window.removeEventListener("mouseout",this.onMouseUp,!1)}),ie(this,"removeMouseUpEventListeners",()=>{this.renderer.domElement.removeEventListener("mousemove",this.onMouseMove,!1),window.removeEventListener("mouseup",this.onMouseUp,!1),window.removeEventListener("mouseout",this.onMouseUp,!1)}),ie(this,"onContextMenu",o=>{o.preventDefault()}),ie(this,"onMouseUp",()=>{if(this.enabled!==!1){switch(this.removeMouseUpEventListeners(),this.state){case 2:this.publish("pan-end"),this.publish("user-pan-end");break;case 1:this.publish("zoom-end"),this.publish("user-dolly-end");break;case 0:this.publish("rotate-end"),this.publish("user-rotate-end");break;case 8:this.publish("pedestal-end"),this.publish("user-pedestal-end");break}this.state=-1}}),ie(this,"onMouseMove",o=>{if(this.enabled!==!1)if(o.preventDefault(),this.mouseToScene(o),this.state===0){if(this.enableRotate===!1)return;this.handleMouseMoveRotate(o)}else if(this.state===2){if(this.enablePan===!1)return;this.handleMouseMovePan()}else this.state===3?(this.resetZoom=!0,this.state=-1):this.state===8&&this.handleMouseMovePedestal(o)}),ie(this,"onTouchStart",o=>{if(this.enabled!==!1){switch(this.updateTouchOrigin(),this.touchToScene(o),o.touches.length){case 1:this.enablePedestal?(this.handleTouchStartPedestal(o),this.state=9):this.enablePan&&(this.handleTouchStartPan(o),this.state=6);break;case 2:this.touch.inputs=new a_e(this.touch.touches[0],this.touch.touches[1]);break;default:this.state=-1}this.state}}),ie(this,"onTouchMove",o=>{if(this.enabled!==!1)switch(this.touchToScene(o),o.touches.length){case 2:o.preventDefault(),o.stopPropagation();let s={...this.touch.inputs.first},l={...this.touch.inputs.second},u=new Oe(this.touch.touches[0].x,this.touch.touches[0].y),c=new Oe(this.touch.touches[1].x,this.touch.touches[1].y);if(this.touch.inputs.update(this.touch.touches[0],this.touch.touches[1]),this.enableRotate&&this.state===4)this.handleTouchMoveTilt(o);else if(this.state===5)this.handleTouchMoveDolly();else if(this.state!==5&&this.touch.inputs.totalDistance>.05){let p=s.y<u.y&&l.y<c.y,d=s.y>u.y&&l.y>c.y;this.enableRotate&&this.state!==4&&(d||p)?(this.handleTouchStartTilt(o),this.state=4):(this.handleTouchStartDolly(),this.state=5)}break;case 1:(this.enablePedestal||this.enablePan)&&(o.preventDefault(),o.stopPropagation()),this.enablePedestal&&this.state===9?this.handleTouchMovePedestal(o):this.enablePan&&this.state===6&&this.handleTouchMovePan(o);break;default:this.state=-1}}),ie(this,"onTouchEnd",o=>{if(this.enabled!==!1){switch(this.handleTouchEnd(),this.state){case 2:case 6:this.publish("user-pan-end");break;case 4:this.publish("pan-end"),this.publish("user-tilt-end");break;case 1:case 5:this.publish("zoom-end"),this.publish("user-dolly-end");break;case 0:this.publish("rotate-end"),this.publish("user-rotate-end");break;case 8:case 9:this.publish("pedestal-end"),this.publish("user-pedestal-end");break}o.touches.length?this.onTouchStart(o):this.state=-1}}),ie(this,"handleTouchMovePan",o=>{let s=Object.hasOwn(o,"x")?new Oe(o.x,o.y):this.touch.touches[0],l=this.raycastToFloor(s);this.coords.panEnd.set(l.x,l.y,0),this.coords.panDelta.subVectors(this.coords.panEnd,this.coords.panStart),this.setPosition(this.coords.panCameraStart.x-this.coords.panDelta.x,this.coords.panCameraStart.y-this.coords.panDelta.y),this.publish("change")}),ie(this,"handleTouchStartDolly",()=>{let o=this.touch.touches[0].x-this.touch.touches[1].x,s=this.touch.touches[0].y-this.touch.touches[1].y;this.zoomStart=this.getZoomAltitude();let l=new Oe(this.touch.touches[0].x-o/2,this.touch.touches[0].y-s/2);this.coords.floorAnchor=this.raycastToFloor(l),this.orbit.updateMatrixWorld(),this.touch.anchor1=new SI(this.touch.touches[0],this.camera,this.cameraPlane),this.touch.anchor2=new SI(this.touch.touches[1],this.camera,this.cameraPlane),this.coords.panCameraStart.set(this.orbit.position.x,this.orbit.position.y,0),this.publish("user-dolly-start"),this.publish("multi-start")}),ie(this,"handleMouseMovePan",()=>{let o=this.raycastToFloor(this.coords.mouse);this.coords.panEnd.set(o.x,o.y,0),this.coords.panDelta.subVectors(this.coords.panEnd,this.coords.panStart),this.setPosition(this.coords.panCameraStart.x-this.coords.panDelta.x,this.coords.panCameraStart.y-this.coords.panDelta.y),this.publish("change")}),ie(this,"handleTouchStartTilt",o=>{this.coords.rotateStart.set(o.touches[1].clientX,o.touches[1].clientY),this.publish("user-tilt-start"),this.publish("rotate-start")}),ie(this,"handleTouchMovePedestal",o=>{this.handleMouseMovePedestal(o.touches[0])}),ie(this,"handleTouchMoveTilt",o=>{this.coords.rotateEnd.set(o.touches[1].clientX,o.touches[1].clientY),this.coords.rotateDelta.subVectors(this.coords.rotateEnd,this.coords.rotateStart),this.setTilt(this.getTilt()-this.coords.rotateDelta.y/this.rotateSpeed),this.coords.rotateStart.copy(this.coords.rotateEnd)}),ie(this,"handleTouchMoveDolly",()=>{let o=this.touch.inputs.first,s=this.touch.inputs.second;this.touch.anchor1.viewCoordinate={x:o.x,y:o.y},this.touch.anchor2.viewCoordinate={x:s.x,y:s.y};let l=this.makeTransformFromTouchAnchors(this.touch.anchor1,this.touch.anchor2);l&&this.setCameraFromTransformMatrix(l),this.orbit.updateMatrixWorld(),this.touch.anchor1.updateAnchorState(this.camera,o),this.touch.anchor2.updateAnchorState(this.camera,s)}),ie(this,"handleTouchEnd",()=>{this.state===4||this.state===5?this.publish("multi-end"):this.state===6&&this.publish("pan-end")}),ie(this,"handleTouchStartPan",o=>{let s=Object.hasOwn(o,"x")?new Oe(o.x,o.y):this.touch.touches[0],l=this.raycastToFloor(s);this.coords.panStart.set(l.x,l.y,0),this.coords.panCameraStart.set(this.orbit.position.x,this.orbit.position.y,0),this.publish("user-pan-start"),this.publish("pan-start")}),ie(this,"handleTouchStartPedestal",o=>{this.handleMouseDownPedestal(o.touches[0])}),ie(this,"onMouseDown",o=>{if(this.enabled!==!1){if(this.mouseToScene(o),o.preventDefault(),this.state===3&&this.publish("zoom-end"),o.button===this.MOUSE_BUTTONS.ORBIT){if(this.enableRotate===!1)return;this.handleMouseDownRotate(o),this.state=0}else o.button===this.MOUSE_BUTTONS.PAN&&(this.enablePan?(this.handleMouseDownPan(),this.state=2):this.enablePedestal&&(this.handleMouseDownPedestal(o),this.state=8));this.state!==-1&&this.addMouseEventListeners()}}),ie(this,"onMouseWheel",o=>{this.enabled===!1||this.enableZoom===!1||this.state!==-1&&this.state!==3||(o.preventDefault(),o.stopPropagation(),this.mouseToScene(o),this.canScrollZoom(o)&&(this.lastWheelTime=this.clock.getElapsedTime(),this.publishUserZoomEvent()),this.state!==3&&this.canScrollZoom(o)&&(this.addMouseMoveEventListeners(),this.state=3,this.zoomStart=this.getZoomAltitude(),this.coords.floorAnchor=this.raycastToFloor(this.coords.mouse),this.coords.panCameraStart.set(this.orbit.position.x,this.orbit.position.y,0),this.publish("zoom-start")),this.scrollTimer!=null&&clearTimeout(this.scrollTimer),this.scrollTimer=setTimeout(()=>{this.publish("zoom-end")},50),this.handleMouseWheel(o))}),ie(this,"handleMouseWheel",o=>{if(this.publish("zoom-start"),!this.canScrollZoom(o)){this.lastWheelTime>0&&this.publish("zoom-end"),this.lastWheelTime=0,this.state=-1;return}let s=this.getZoomAltitude(),l=s-wI(o)*s/txe*this.zoomSpeed;this.setZoomAltitude(l);let u=l/this.zoomStart;this.coords.panDelta.subVectors(this.coords.floorAnchor,this.coords.panCameraStart).multiplyScalar(1-u),this.setPosition(this.coords.panCameraStart.x+this.coords.panDelta.x,this.coords.panCameraStart.y+this.coords.panDelta.y),this.publish("change")}),ie(this,"setCameraFromTransformMatrix",o=>{this.orbit.updateMatrixWorld();let s=new $a;s.setFromRotationMatrix(o,"ZYX");let l=(o.elements[14]-this.cameraPlane.position.z)/Math.cos(s.x),u=s.z,c=new le(0,0,1);c.applyEuler(s),c.setLength(l);let p=new le;p.setFromMatrixPosition(o),p.sub(c),this.enablePan&&this.setPosition(p.x,p.y),this.enableZoom&&this.setZoomAltitude(l),this.enableRotate&&this.setRotation(u)}),ie(this,"makeTransformFromTouchAnchors",(o,s)=>{this.orbit.updateMatrixWorld(),this.camera.updateProjectionMatrix();let l=this.camera.projectionMatrix.clone(),u=o.worldCoordinate,c=s.worldCoordinate,p=o.reUnproject(),d=s.reUnproject();if(!p||!d||!u||!c)return null;let m=o.viewCoordinate,g=s.viewCoordinate,b=c.x-u.x,x=c.y-u.y,v=Math.atan2(x,b),w=d.x-p.x,_=d.y-p.y,C=Math.atan2(_,w),E=r_e(v,C),T=new jt;T.makeRotationZ(-E);let L=T.clone();L.multiply(o.snapHolderMatrix);let D=h((At,ue,he)=>At.elements[(ue-1)*4+he-1],"m"),B=D(l,1,1)*D(L,1,1)-m.x*D(l,3,4)*D(L,3,1),A=D(l,1,1)*D(L,1,2)-m.x*D(l,3,4)*D(L,3,2),k=D(l,1,1)*D(L,1,3)-m.x*D(l,3,4)*D(L,3,3),$=u.x*B+u.y*A+u.z*k,O=D(l,2,2)*D(L,2,1)-m.y*D(l,3,4)*D(L,3,1),P=D(l,2,2)*D(L,2,2)-m.y*D(l,3,4)*D(L,3,2),U=D(l,2,2)*D(L,2,3)-m.y*D(l,3,4)*D(L,3,3),G=u.x*O+u.y*P+u.z*U,K=D(l,1,1)*D(L,1,1)-g.x*D(l,3,4)*D(L,3,1),z=D(l,1,1)*D(L,1,2)-g.x*D(l,3,4)*D(L,3,2),V=D(l,1,1)*D(L,1,3)-g.x*D(l,3,4)*D(L,3,3),j=c.x*K+c.y*z+c.z*V,q=D(l,2,2)*D(L,2,1)-g.y*D(l,3,4)*D(L,3,1),ee=D(l,2,2)*D(L,2,2)-g.y*D(l,3,4)*D(L,3,2),ae=D(l,2,2)*D(L,2,3)-g.y*D(l,3,4)*D(L,3,3),N=c.x*q+c.y*ee+c.z*ae,J=Math.abs(K-B),Y=Math.abs(z-A),oe=Math.abs(V-k),xe=Math.abs(K-O),ge=Math.abs(z-P),Te=Math.abs(V-U),me=Math.abs(q-B),Q=Math.abs(ee-A),Me=Math.abs(ae-k),ve=Math.abs(q-O),Ie=Math.abs(ee-P),De=Math.abs(ae-U),we=Math.min(J+Y+oe,xe+ge+Te),Fe=Math.min(me+Q+Me,ve+Ie+De);we<Fe&&(K=q,z=ee,V=ae,j=N);let Ze=O*k-B*U,yt=P*k-A*U,ne=G*k-$*U,W=K*U-O*V,_e=z*U-P*V,Re=j*U-G*V,Ne=(Re*yt-ne*_e)/(W*yt-Ze*_e),ze=(Re*Ze-ne*W)/(_e*Ze-yt*W),xt=P*B-A*O,ot=U*B-k*O,je=G*B-$*O,He=z*O-P*K,bt=V*O-U*K,Xe=((j*O-G*K)*xt-je*He)/(bt*xt-ot*He),ti=L.clone();return ti.elements[12]=Ne,ti.elements[13]=ze,ti.elements[14]=Xe,Xe>0?ti:null}),ie(this,"updateTouchOrigin",()=>{let o=this.renderer.domElement;this.touch.origin.offsetLeft=o.getBoundingClientRect().left,this.touch.origin.offsetTop=o.getBoundingClientRect().top}),ie(this,"touchToScene",o=>{this.touch.touches=[];for(let s=0,l=o.touches.length;s<l;s++){let u=o.touches[s],c=n_e(u,this.touch.origin);this.touch.touches.push(new Oe(c.x/this.renderer.domElement.width*this.rendererState.pixelRatio*2-1,-(c.y/this.renderer.domElement.height*this.rendererState.pixelRatio)*2+1))}this.coords.mouse=this.touch.touches[0]}),ie(this,"canScrollZoom",o=>{let s=wI(o),l=this.getZoomAltitude();return!(s<0&&l===this.getZoomScaledMax()||s>0&&l===this.getZoomScaledMin())}),ie(this,"mouseToScene",o=>{let s=this.getMousePos(o);return this.coords.mouse.x=s.x/this.renderer.domElement.width*this.rendererState.pixelRatio*2-1,this.coords.mouse.y=-(s.y/this.renderer.domElement.height*this.rendererState.pixelRatio)*2+1,this.coords.mouse}),ie(this,"getMousePos",o=>({x:o.offsetX,y:o.offsetY})),ie(this,"handleMouseDownRotate",o=>{this.coords.rotateStart.set(o.clientX,o.clientY),this.publish("rotate-start"),this.publish("user-rotate-start")}),ie(this,"handleMouseDownPan",()=>{let o=this.raycastToFloor(this.coords.mouse);this.coords.panStart.set(o.x,o.y,0),this.coords.panCameraStart.set(this.orbit.position.x,this.orbit.position.y,0),this.publish("pan-start"),this.publish("user-pan-start")}),ie(this,"handleMouseDownPedestal",o=>{let s=new Oe(o.clientX,o.clientY);this.coords.initialShiftPos=s,this.coords.initialPedestal=this.getPedestal(),this.pedestalScaleFactor=JS(this.camera.fov,this.renderer.domElement.clientHeight,this.getZoomAltitude()),this.publish("pedestal-start"),this.publish("user-pedestal-start")}),ie(this,"handleMouseMovePedestal",o=>{let s={x:o.clientX,y:o.clientY},l=this.coords.initialPedestal+this.pedestalScaleFactor*(s.y-this.coords.initialShiftPos.y);this.stayInsideBounds&&(l<this.minPedestal?l=Math.max(l,this.minPedestal):l>this.maxPedestal&&(l=Math.min(l,this.maxPedestal))),l!==this.getPedestal()&&this.setPedestal(l,!0)}),ie(this,"handleMouseMoveRotate",o=>{this.coords.rotateEnd.set(o.clientX,o.clientY),this.coords.rotateDelta.subVectors(this.coords.rotateEnd,this.coords.rotateStart),this.rotate(-this.coords.rotateDelta.x/this.rotateSpeed),this.setTilt(this.getTilt()-this.coords.rotateDelta.y/this.rotateSpeed),this.coords.rotateStart.copy(this.coords.rotateEnd),this.publish("change")}),ie(this,"publishUserZoomDebounced",xp(()=>{this.isUserZooming=!1,this.publish("user-zoom-end")},250)),ie(this,"publishUserZoomEvent",()=>{this.isUserZooming?this.publishUserZoomDebounced():(this.publish("user-zoom-start"),this.isUserZooming=!0,this.publishUserZoomDebounced())}),ie(this,"setUserInteracting",()=>{this.userInteracting=!0}),ie(this,"unsetUserInteracting",()=>{this.userInteracting=!1}),ie(this,"publishPedestalChangeEvent",o=>{this.publish("pedestal-change",{pedestal:o,scrolledToTop:this.scrolledToTop,scrolledToBottom:this.scrolledToBottom,scrollPercent:this.scrollPercent})}),ie(this,"convertAltitudeToZoomLevel",o=>{let[,s]=this.center,l=o*2*Math.tan(ki.degToRad(this.camera.fov)/2)/this.options.canvasHeight,u=Math.cos(ki.degToRad(s))*2*Math.PI*Zp/l;return ki.clamp(Math.log2(u/512),cI,pI)}),ie(this,"convertZoomLevelToAltitude",o=>{let[,s]=this.center,l=ki.clamp(o,cI,pI),u=Math.pow(2,l),c=ki.clamp(s,Qve,exe),p=u*512;return Math.cos(ki.degToRad(c))*Math.PI*2*Zp/p*this.options.canvasHeight/2/Math.tan(ki.degToRad(this.camera.fov)/2)}),ie(this,"completeTween",o=>{o.isPlaying?o.stop():o.end(),this.tweens.delete(o)}),fe(this,wc,{PIXELS:"pixels",PORTIONS:"portions"}),fe(this,bM,["top","bottom","left","right"]),ie(this,"getCameraFrameForPoints",(o,s,l,u,{canvasWidth:c,canvasHeight:p},d=this.minZoomAltitude,m=this.maxZoomAltitude)=>{Number.isFinite(l)&&(l=1),Number.isFinite(s)&&(s=1),d=Math.max(this.cameraPlane.position.z,d);let g={position:this.getPosition(),zoom:d};if(o==null||o.length===0)return g;u||(u={top:0,bottom:0,left:0,right:0,type:M(this,wc).PIXELS});for(let we of M(this,bM))typeof u[we]!="number"&&(u[we]=0);if(u.type||(u.type=M(this,wc).PIXELS),u.type===M(this,wc).PORTIONS&&(u={top:u.top*p,bottom:u.bottom*p,left:u.left*c,right:u.right*c,type:M(this,wc).PIXELS}),u.left+u.right>=c||u.top+u.bottom>=p)return g;this.orbit.updateMatrixWorld();let b=this.camera.matrixWorldInverse,x=this.camera.fov*(Math.PI/180)/2,v=x*l,w=Math.atan(Math.tan(x)*(c/p))*s;if(o.length===1){let we=o[0].clone();we.applyMatrix4(b);let Fe=d*Math.tan(w)*2,Ze=d*Math.tan(v)*2,yt=(u.left-u.right)/2/c,ne=(u.top-u.bottom)/2/p,W=new le(-yt*Fe,ne*Ze,0);return we.add(W),we.applyMatrix4(this.camera.matrixWorld),g.position.x=we.x,g.position.y=we.y,g.position.z=we.z,g.zoom=Math.max(g.zoom,g.position.z),g}let _=new le(1/0,1/0,1/0),C=new le(-1/0,-1/0,-1/0),E=new Yr().setFromPoints(o),T;for(let we=0,Fe=o.length;we<Fe;we++)T=o[we].clone(),T.applyMatrix4(b),_.min(T),C.max(T);let L=C.x-_.x,D=C.y-_.y,B=c-u.left-u.right,A=p-u.top-u.bottom,k=(C.x+_.x)/2,$=(C.y+_.y)/2,O=L/B,P=D/A,U=d,G=m,K=U*Math.tan(w)*2,z=G*Math.tan(w)*2,V=K/c,j=z/c,q=Math.max(O,P);q=ki.clamp(q,V,j);let ee=B*q,ae=A*q,N={min:{x:k-ee/2-u.left*q,y:$-ae/2-u.bottom*q},max:{x:k+ee/2+u.right*q,y:$+ae/2+u.top*q}},J=(N.min.x+N.max.x)/2,Y=(N.min.y+N.max.y)/2,oe=E.getCenter(new le),xe=Math.abs(J-N.min.x),ge=Math.abs(Y-N.min.y),Te=xe/Math.tan(w),me=ge/Math.tan(v),Q=new le;Q.set(J,Y,C.z+Math.max(Te,me)),Q.applyMatrix4(this.camera.matrixWorld);let Me=new le;Me.set(J,Y,C.z),Me.applyMatrix4(this.camera.matrixWorld);let ve=new le().subVectors(Me,Q),Ie=(oe.z-Q.z)/ve.z,De=new le().copy(Q).add(ve.clone().multiplyScalar(Ie));return g.position=De,Me.set(g.position.x,g.position.y,g.position.z),Q.sub(Me),g.zoom=Q.length(),g}),this.camera=e,this.renderer=r,this.rendererState=n,this.scene=t,this.options=a,this.elevation=e.parent,this.orbit=this.elevation.parent,this.cameraPlane=this.createCameraPlane(),this.zoomStart=e.position.z,a.mode!=="outdoors-overlay"&&this.addEventListeners()}get maxZoomLevel(){return this.convertAltitudeToZoomLevel(this.minZoomAltitude)}setMaxZoomLevel(e){this.minZoomAltitude=this.convertZoomLevelToAltitude(e)}get minZoomLevel(){return this.convertAltitudeToZoomLevel(this.maxZoomAltitude)}setMinZoomLevel(e){this.maxZoomAltitude=this.convertZoomLevelToAltitude(e)}get scrollPercent(){let e=this.minPedestal,t=this.maxPedestal,r=this.getPedestal();return r=Math.min(r,t),r=Math.max(r,e),(r-e)/(t-e)*100}get scrolledToBottom(){return this.minPedestal===0||Math.floor(this.getPedestal())<=this.minPedestal}get scrolledToTop(){return this.maxPedestal===0||Math.ceil(this.getPedestal())>=this.maxPedestal}get center(){var e,t,r,n;let a=this.getPosition(),{lat:o,lon:s}=JE((t=(e=this.rendererState.center)==null?void 0:e[1])!=null?t:0,(n=(r=this.rendererState.center)==null?void 0:r[0])!=null?n:0,a.x,a.y);return[s,o]}setCenter(e,t){var r,n,a,o;let{x:s,y:l}=KE((n=(r=this.rendererState.center)==null?void 0:r[1])!=null?n:0,(o=(a=this.rendererState.center)==null?void 0:a[0])!=null?o:0,t,e);this.setPosition(s,l)}focusOn(e,{insetsPadding:t},r={}){let n=r.curve,a=1,o=1,s=r.callback,l=r.cancelledCallback,u=r.minZoom!==void 0?r.minZoom:this.minZoomAltitude,c=r.maxZoom!==void 0?r.maxZoom:this.maxZoomAltitude,p=this.options.canvasWidth,d=this.options.canvasHeight,m;if(r.duration!==void 0?m=r.duration:hr.env.TESTING==="true"?m=0:m=200,t.top!==0||t.bottom!==0||t.left!==0||t.right!==0)if(r.tilt!==void 0&&r.tilt!==this.getTilt()||r.rotation!==void 0&&r.rotation!==this.getRotation())this.animateCamera({position:this.getPosition(),tilt:r.tilt,rotation:r.rotation},m,n,()=>{let g=r.padding||t,b=this.getCameraFrameForPoints(e,a,o,g,{canvasWidth:p,canvasHeight:d},u,c);this.animateCamera({position:b.position,tilt:this.getTilt(),rotation:this.getRotation(),zoom:b.zoom},m,n,s,l)});else{let g=r.padding||t,b=this.getCameraFrameForPoints(e,a,o,g,{canvasWidth:p,canvasHeight:d},u,c);this.animateCamera({position:b.position,tilt:this.getTilt(),rotation:this.getRotation(),zoom:b.zoom},m,n,s,l)}else{let g=r.padding||t,b=this.getCameraFrameForPoints(e,a,o,g,{canvasHeight:d,canvasWidth:p},u,c);this.animateCamera({position:b.position,tilt:r.tilt,rotation:r.rotation,zoom:b.zoom},m,n,s,l)}}resize(e,t){this.options.canvasWidth=e,this.options.canvasHeight=t}};wc=new WeakMap,bM=new WeakMap,h(Bee,"CameraSystem");var o_e=Bee;R();var s_e=300,Oee=class{constructor(e){Z(this,"state");this.state=e}update(e){var t;let r,n,a;for(let o of this.state.entity2DIds)r=this.state.entity2DMap.get(o),r&&(n=r.components[0],a=r.components[1],n instanceof bp&&n.containerEl!=null&&((n.visible===!0||((t=n.animation)==null?void 0:t.pending)===!0)&&(n.containerEl.style.transform=`translate3D(${n.projection.x}px, ${n.projection.y}px, ${n.projection.y}px)`),n.visible===!0?n.containerEl.style.pointerEvents=e||a!=null?"none":"auto":n.containerEl.style.pointerEvents="none",n.visibilityNeedsUpdate&&(n.animation&&n.animation.cancel(),n.animation=n.containerEl.animate([{opacity:n.visible?"1":"0"}],{duration:s_e,easing:"ease-in-out",fill:"forwards"}),n.visibilityNeedsUpdate=!1)))}};h(Oee,"DOMDrawSystem");var l_e=Oee;R();var Nee=class{constructor(){Z(this,"percentExpanded",0);Z(this,"activeId","");Z(this,"gap",20);Z(this,"dirty",!0)}};h(Nee,"StackComponent");var u_e=Nee;R();var $ee=class extends Hr{constructor(t,r){super();Z(this,"state");Z(this,"dirty",!0);Z(this,"domTree");Z(this,"observers",new Map);Z(this,"updateDimensions",t=>{t.forEach(r=>{let n=r.target,a=n.getAttribute("data-marker-id");if(a){let o=this.state.entity2DMap.get(a);if(o&&o.components[0]instanceof bp&&n.firstElementChild){let{width:s,height:l}=n.firstElementChild.getBoundingClientRect();o.components[0].updateDimensions(s,l)}}}),this.publish("dimensions-update")});this.state=t,this.domTree=r}setupObserver(){var t;if(this.observers){for(let n of this.observers.values())n.disconnect();this.observers.clear()}let r;for(let n of this.domTree.children){let a=n.getAttribute("data-marker-id");if(a!=null&&(r=this.state.entity2DMap.get(a),(t=r.components[0].options)!=null&&t.dynamicResize)){let o=new ResizeObserver(this.updateDimensions);o.observe(n),this.observers.set(n.userData.entityId,o)}}}update(){this.dirty&&(this.setupObserver(),this.dirty=!1)}destroy(){for(let t of this.observers.values())t.disconnect();this.observers.clear()}};h($ee,"DOMResizeSystem");var h_e=$ee;R();var D1=It(hg()),c_e=0,p_e=22,d_e=0,f_e=90;function nl(i,e,t,r){return(i<e||i>t)&&Ft.warn(r),Math.min(t,Math.max(e,i))}h(nl,"clampWithWarning");var MI={linear:D1.default.Easing.Linear.None,"ease-in":D1.default.Easing.Quadratic.In,"ease-out":D1.default.Easing.Quadratic.Out,"ease-in-out":D1.default.Easing.Quadratic.InOut},wt,ci,Sc,o0,Uee=class{constructor(e,t,r,n){fe(this,wt,void 0),fe(this,ci,void 0),fe(this,Sc,void 0),fe(this,o0,void 0),ke(this,wt,e),ke(this,ci,t),ke(this,Sc,r),ke(this,o0,n),M(this,ci).cameraSystem.on("pedestal-change",({pedestal:a})=>{M(this,wt).map&&(M(this,wt).map.transform.elevation=a,M(this,wt).map.transform.minElevationForCurrentTile=a,M(this,wt).map.triggerRepaint()),M(this,ci).cameraSystem.setCameraPlaneElevation(a),M(this,o0).position.z=a})}get center(){return M(this,wt).mode==="outdoors-overlay"&&M(this,wt).map?M(this,wt).map.getCenter().toArray():M(this,ci).cameraSystem.center}setCenter(e){var t;if(M(this,wt).mode==="outdoors-overlay"&&M(this,wt).map){(t=M(this,wt).map)==null||t.setCenter(e),M(this,ci).interactionSystem.handleHover();return}M(this,ci).cameraSystem.setCenter(e[0],e[1]),M(this,ci).interactionSystem.handleHover()}get zoomLevel(){var e;return M(this,wt).mode==="outdoors-overlay"&&M(this,wt).map?(e=M(this,wt).map)==null?void 0:e.getZoom():M(this,ci).cameraSystem.getZoomLevel()}setZoomLevel(e){var t;M(this,wt).mode==="outdoors-overlay"&&M(this,wt).map&&((t=M(this,wt).map)==null||t.setZoom(e)),M(this,ci).cameraSystem.setZoomLevel(nl(e,this.minZoomLevel,this.maxZoomLevel,"zoomLevel was clamped to minZoomLevel/maxZoomLevel bounds. Use mapView.Camera.setMinZoomLevel() and mapView.Camera.setMaxZoomLevel() to adjust limits."))}get maxZoomLevel(){return M(this,ci).cameraSystem.maxZoomLevel}get minZoomLevel(){return M(this,ci).cameraSystem.minZoomLevel}setMinZoomLevel(e){var t;let r=Math.max(c_e,e);M(this,ci).cameraSystem.setMinZoomLevel(r),this.zoomLevel<r&&this.setZoomLevel(r),(t=M(this,wt).map)==null||t.setMinZoom(r)}setMaxZoomLevel(e){var t;let r=Math.min(p_e,e);M(this,ci).cameraSystem.setMaxZoomLevel(r),this.zoomLevel>r&&this.setZoomLevel(r),(t=M(this,wt).map)==null||t.setMaxZoom(r)}get maxPitch(){var e;return M(this,wt).mode==="outdoors-overlay"&&M(this,wt).map?(e=M(this,wt).map)==null?void 0:e.getMaxPitch():ki.radToDeg(M(this,ci).cameraSystem.maxTilt)}get minPitch(){var e;return M(this,wt).mode==="outdoors-overlay"&&M(this,wt).map?(e=M(this,wt).map)==null?void 0:e.getMinPitch():ki.radToDeg(M(this,ci).cameraSystem.minTilt)}setMinPitch(e){var t;let r=Math.max(d_e,e);(t=M(this,wt).map)==null||t.setMinPitch(r),M(this,ci).cameraSystem.minTilt=ki.degToRad(r)}setMaxPitch(e){var t;let r=Math.min(f_e,e);(t=M(this,wt).map)==null||t.setMaxPitch(r),M(this,ci).cameraSystem.maxTilt=ki.degToRad(r)}get bearing(){var e;return M(this,wt).mode==="outdoors-overlay"&&M(this,wt).map?(e=M(this,wt).map)==null?void 0:e.getBearing():ki.radToDeg(M(this,ci).cameraSystem.getRotation())}setBearing(e){var t;if(M(this,wt).mode==="outdoors-overlay"&&M(this,wt).map){(t=M(this,wt).map)==null||t.setBearing(e);return}M(this,ci).cameraSystem.setRotation(ki.degToRad(e))}get pitch(){var e;return M(this,wt).mode==="outdoors-overlay"&&M(this,wt).map?(e=M(this,wt).map)==null?void 0:e.getPitch():ki.radToDeg(M(this,ci).cameraSystem.getTilt())}setPitch(e){var t;if(M(this,wt).mode==="outdoors-overlay"&&M(this,wt).map){(t=M(this,wt).map)==null||t.setPitch(e);return}M(this,ci).cameraSystem.setTilt(ki.degToRad(nl(e,this.minPitch,this.maxPitch,"pitch was clamped to minPitch/maxPitch bounds. Use mapView.Camera.setMinPitch() and mapView.Camera.setMaxPitch() to adjust limits.")))}get elevation(){return M(this,ci).cameraSystem.getPedestal()}setElevation(e){M(this,ci).cameraSystem.setPedestal(e,!0)}get insetsPadding(){return M(this,Sc).insetsPadding}setInsetPadding(e){M(this,Sc).center&&(M(this,Sc).insetsPadding=e?{...e}:pee)}animateTo(e){var t;if(M(this,wt).mode==="outdoors-overlay"&&M(this,wt).map)return(t=M(this,wt).map)==null||t.flyTo({center:e.center,zoom:e.zoomLevel,bearing:e.bearing,pitch:e.pitch,duration:e.duration}),Promise.resolve();let r=e.center?M(this,wt).convertTo3DMapPosition(e.center[1],e.center[0],0):void 0,n=e.zoomLevel!==void 0?M(this,ci).cameraSystem.convertZoomLevelToAltitude(nl(e.zoomLevel,this.minZoomLevel,this.maxZoomLevel,"zoomLevel was clamped to minZoomLevel/maxZoomLevel bounds. Use mapView.Camera.setMinZoomLevel() and mapView.Camera.setMaxZoomLevel() to adjust limits.")):void 0,a=e.bearing!==void 0?ki.degToRad(e.bearing):void 0,o=e.pitch!==void 0?ki.degToRad(nl(e.pitch,this.minPitch,this.maxPitch,"pitch was clamped to minPitch/maxPitch bounds. Use mapView.Camera.setMinPitch() and mapView.Camera.setMaxPitch() to adjust limits.")):void 0;return new Promise(s=>{M(this,ci).cameraSystem.animateCamera({position:r,zoom:n,rotation:a,tilt:o},e.duration||0,MI[e.easing||"ease-in-out"],()=>{M(this,ci).interactionSystem.handleHover(),s()},s)})}focusOn(e,t){var r,n;return M(this,wt).mode==="outdoors-overlay"&&M(this,wt).map?(e.length===1?(r=M(this,wt).map)==null||r.flyTo({center:e[0],duration:(t==null?void 0:t.duration)||M(this,wt).map.getBearing(),animate:!0,bearing:(t==null?void 0:t.bearing)||M(this,wt).map.getBearing(),pitch:(t==null?void 0:t.pitch)||M(this,wt).map.getPitch(),zoom:(t==null?void 0:t.maxZoomLevel)||M(this,wt).map.getMaxZoom()}):(n=M(this,wt).map)==null||n.fitBounds(e,{duration:t==null?void 0:t.duration,animate:!0,bearing:(t==null?void 0:t.bearing)||M(this,wt).map.getBearing(),pitch:(t==null?void 0:t.pitch)||M(this,wt).map.getPitch(),zoom:(t==null?void 0:t.maxZoomLevel)||M(this,wt).map.getMaxZoom()}),M(this,ci).interactionSystem.handleHover(),Promise.resolve()):new Promise(a=>{M(this,ci).cameraSystem.focusOn(e.map(o=>M(this,wt).convertTo3DMapPosition(o[1],o[0],o[2]||0)),{insetsPadding:(t==null?void 0:t.padding)||this.insetsPadding},{minZoom:(t==null?void 0:t.maxZoomLevel)===void 0?void 0:M(this,ci).cameraSystem.convertZoomLevelToAltitude(nl(t.maxZoomLevel,this.minZoomLevel,this.maxZoomLevel,"maxZoomLevel was clamped to minZoomLevel/maxZoomLevel bounds. Use mapView.Camera.setMaxZoomLevel() to adjust limits.")),maxZoom:(t==null?void 0:t.minZoomLevel)===void 0?void 0:M(this,ci).cameraSystem.convertZoomLevelToAltitude(nl(t.minZoomLevel,this.minZoomLevel,this.maxZoomLevel,"minZoomLevel was clamped to minZoomLevel/maxZoomLevel bounds. Use mapView.Camera.setMinZoomLevel() to adjust limits.")),padding:(t==null?void 0:t.padding)||{top:0,left:0,bottom:0,right:0},curve:MI[(t==null?void 0:t.easing)||"ease-in-out"],rotation:t!=null&&t.bearing?ki.degToRad(t.bearing):void 0,tilt:(t==null?void 0:t.pitch)!==void 0?ki.degToRad(nl(t.pitch,this.minPitch,this.maxPitch,"pitch was clamped to minPitch/maxPitch bounds. Use mapView.Camera.setMinPitch() and mapView.Camera.setMaxPitch() to adjust limits.")):void 0,duration:t==null?void 0:t.duration,callback:()=>{M(this,ci).interactionSystem.handleHover(),a()},cancelledCallback:a})})}};wt=new WeakMap,ci=new WeakMap,Sc=new WeakMap,o0=new WeakMap,h(Uee,"Camera");var m_e=Uee;R();function wM(i){i&&(i.map&&(i.map.dispose(),i.map=void 0),i.dispose())}h(wM,"scrubMaterial");function oo(i){for(let e=i.children.length-1;e>=0;e--)oo(i.children[e]);"geometry"in i&&i.geometry&&i.geometry.dispose(),i.parent&&i.parent.remove(i),"material"in i&&Array.isArray(i.material)?i.material.forEach(function(e){wM(e)}):"material"in i&&typeof i.material<"u"&&wM(i.material)}h(oo,"destroyObject3D");R();var g_e=`uniform vec4 uSize;
varying vec2 vUv;
void main() {
  vUv = uv;
  // Scale the position by the size of the quad
  // and shift to top left corner for 0,0
	vec2 transformed = position.xy * uSize.xy - vec2(1.0, -1.0);
  // Apply width .x and height .y of image
  transformed += vec2(uSize.x, -uSize.y);
  // Apply left .w and top .z offset
  transformed += vec2(uSize.w, -uSize.z) * 2.0;
  gl_Position = vec4(transformed, 1.0, 1.0);
}`,y_e=`varying vec2 vUv;
uniform sampler2D uTexture;
uniform float uOpacity;
void main() {
  #ifndef debug
  vec4 texture = texture2D(uTexture, vUv);
  gl_FragColor = vec4(texture.rgb, texture.a * uOpacity);
  #else
  gl_FragColor = vec4(1.0, 0.0, 0.0, 1.0);
  #endif
}`;R();var v_e=4.291666666666667,x_e=15,__e=25,b_e=43/60;R();var CI=["horizontal","icon"],w_e=new Map([[CI[0],`<svg viewBox="0 0 206 48">
      <path d="M27.2678 14.2261H22.3187C21.0695 14.2261 20.4695 14.7801 20.4695 15.9852V31.142L10.3966 15.5591C9.69665 14.4784 9.2475 14.2773 7.8475 14.2261H2.97462C1.67462 14.2261 1.07631 14.7801 1.07631 15.9852V44.7665C1.07631 45.9716 1.67462 46.5256 2.97462 46.5256H7.92377C9.22207 46.5256 9.82207 45.9716 9.82207 44.7665V29.6847L19.9441 45.1926C20.695 46.3244 21.095 46.5256 22.4933 46.5256H27.2933C28.5916 46.5256 29.1916 45.9716 29.1916 44.7665V15.9852C29.1407 14.7801 28.5424 14.2261 27.2678 14.2261Z"/>
      <path d="M5.44915 10.9602C8.45863 10.9602 10.8983 8.50669 10.8983 5.48011C10.8983 2.45353 8.45863 0 5.44915 0C2.43967 0 0 2.45353 0 5.48011C0 8.50669 2.43967 10.9602 5.44915 10.9602Z"/>
      <path d="M61.7899 25.0449C63.2306 23.1903 65.078 22.2051 67.556 22.2051C72.0526 22.2051 74.7611 25.3347 74.7611 29.4511V39.2489C74.8187 39.7125 74.5306 39.9443 74.0695 39.9443H72.5136C72.0526 39.9443 71.7645 39.7125 71.8221 39.2489V29.5091C71.8221 27.1909 69.9187 25.2187 67.4984 25.2187C65.1339 25.2187 63.2323 27.1329 63.2323 29.2773V39.2489C63.2899 39.7125 63.0018 39.9443 62.5407 39.9443H60.9831C60.5221 39.9443 60.2916 39.7125 60.2916 39.2489V29.4511C60.2916 27.1329 58.3899 25.2187 56.0255 25.2187C53.7204 25.2187 51.7594 27.075 51.7594 29.2773V39.3068C51.817 39.7705 51.5289 40.0023 51.0102 40.0023H49.5119C49.0509 40.0023 48.7628 39.7705 48.7628 39.3068V23.25C48.7051 22.7864 48.9933 22.4966 49.5119 22.4966H50.9526C51.356 22.4966 51.5289 22.6704 51.5289 23.0182V24.2352C52.7407 22.9602 54.239 22.2648 56.0255 22.2648C58.4475 22.2068 60.3492 23.192 61.7899 25.0466V25.0449ZM77.1255 31.2477C77.1255 26.3216 81.1018 22.2051 86.1187 22.2051C88.539 22.2051 90.6136 23.1903 92.3441 25.1608V23.1903C92.3441 22.7267 92.5746 22.5528 93.0357 22.5528H94.4187C94.8797 22.5528 95.1102 22.7847 95.1102 23.3062V39.3648C95.1102 39.8284 94.8797 40.0602 94.4187 40.0602H93.0357C92.5746 40.0602 92.3441 39.8284 92.3441 39.4227V37.4523C90.6712 39.3648 88.5967 40.35 86.1746 40.35C81.1018 40.2341 77.1238 36.1773 77.1238 31.2477H77.1255ZM92.1136 31.2477C92.1136 27.8284 89.4611 25.2187 86.0594 25.2187C82.7746 25.2187 80.1221 27.8864 80.1221 31.2477C80.1221 34.6687 82.7746 37.2784 86.1187 37.2784C86.9062 37.2789 87.6861 37.1232 88.4138 36.8202C89.1414 36.5173 89.8026 36.0731 90.3593 35.513C90.9161 34.9528 91.3577 34.2878 91.6587 33.556C91.9597 32.8241 92.1143 32.0397 92.1136 31.2477ZM100.992 37.3943V46.3807C101.049 46.8443 100.761 47.1341 100.298 47.1341H98.7424C98.2814 47.1341 97.9933 46.9023 97.9933 46.3807V23.1903C97.9933 22.7267 98.2238 22.4369 98.7424 22.4369H100.183C100.646 22.379 100.934 22.6687 100.934 23.0744V24.9869C102.605 23.0744 104.68 22.1472 107.044 22.1472C112.002 22.1472 116.037 26.2619 116.037 31.1898C116.037 36.1176 112.059 40.2341 107.044 40.2341C104.622 40.2341 102.603 39.3068 100.992 37.3943ZM106.987 25.2187C103.7 25.2187 101.049 27.8864 101.049 31.2477C101.049 34.6687 103.7 37.2784 107.044 37.2784C110.446 37.2784 113.039 34.6108 113.039 31.2477C113.039 27.8864 110.388 25.2187 106.987 25.2187ZM121.11 37.3943V46.3807C121.168 46.8443 120.88 47.1341 120.419 47.1341H118.861C118.4 47.1341 118.112 46.9023 118.112 46.3807V23.1903C118.112 22.7267 118.342 22.4369 118.861 22.4369H120.302C120.764 22.379 121.053 22.6687 121.053 23.0744V24.9869C122.724 23.0744 124.798 22.1472 127.163 22.1472C132.12 22.1472 136.156 26.2619 136.156 31.1898C136.156 36.1176 132.178 40.2341 127.163 40.2341C124.742 40.2341 122.781 39.3068 121.11 37.3943ZM127.105 25.2187C123.819 25.2187 121.168 27.8864 121.168 31.2477C121.168 34.6687 123.819 37.2784 127.163 37.2784C130.564 37.2784 133.158 34.6108 133.158 31.2477C133.158 27.8864 130.507 25.2187 127.107 25.2187H127.105ZM153.97 32.3506H141.054C141.342 35.2483 143.995 37.4523 147.164 37.4523C148.893 37.4523 150.393 37.0466 151.719 36.0597C152.007 35.8858 152.295 35.7699 152.353 35.7699C152.583 35.7699 152.756 35.8858 152.929 36.1773L153.505 37.1625C153.622 37.3364 153.68 37.4523 153.68 37.5682C153.68 37.8 153.507 38.0318 153.103 38.3216C151.258 39.5966 149.183 40.292 146.992 40.292C141.688 40.292 137.883 36.3511 137.883 31.2477C137.883 26.204 141.803 22.2051 146.703 22.2051C151.546 22.2051 154.717 25.7983 154.717 31.0176C154.717 31.5972 154.717 32.3506 153.968 32.3506H153.97ZM141.056 30.0324H151.72C151.432 26.8432 149.473 24.929 146.648 24.929C145.241 24.8904 143.875 25.3995 142.833 26.3501C141.791 27.3007 141.154 28.6194 141.056 30.0307V30.0324ZM156.332 31.2477C156.332 26.3216 160.31 22.2051 165.326 22.2051C167.748 22.2051 169.707 23.1324 171.32 25.0449V16.2324C171.263 15.7687 171.551 15.479 172.012 15.479H173.57C174.031 15.479 174.319 15.7108 174.319 16.2324V39.3068C174.319 39.7705 174.088 40.0023 173.57 40.0023H172.129C171.666 40.0602 171.378 39.7705 171.378 39.3648V37.3943C169.649 39.3068 167.632 40.292 165.268 40.292C160.31 40.2341 156.332 36.1773 156.332 31.2477ZM171.264 31.2477C171.264 27.8284 168.612 25.2187 165.21 25.2187C161.924 25.2187 159.273 27.8864 159.273 31.2477C159.273 34.6687 161.924 37.2784 165.268 37.2784C166.057 37.2838 166.839 37.1316 167.569 36.8304C168.299 36.5292 168.962 36.0852 169.52 35.5241C170.077 34.963 170.519 34.296 170.818 33.5619C171.117 32.8277 171.268 32.0411 171.263 31.2477H171.264ZM177.72 19.0739C177.715 18.8594 177.754 18.646 177.833 18.4468C177.912 18.2476 178.031 18.0667 178.182 17.915C178.333 17.7633 178.512 17.6439 178.71 17.5642C178.909 17.4845 179.121 17.446 179.334 17.4511C179.546 17.4507 179.756 17.4923 179.952 17.5737C180.148 17.6551 180.326 17.7746 180.476 17.9254C180.626 18.0762 180.745 18.2553 180.826 18.4523C180.907 18.6494 180.948 18.8606 180.948 19.0739C180.953 19.2884 180.914 19.5017 180.835 19.7009C180.756 19.9001 180.637 20.081 180.486 20.2327C180.335 20.3845 180.156 20.5038 179.957 20.5835C179.759 20.6633 179.547 20.7017 179.334 20.6966C178.412 20.7545 177.72 20.0591 177.72 19.0739ZM177.836 39.2489V23.1903C177.836 22.7267 178.066 22.4369 178.527 22.4369H180.083C180.544 22.4369 180.832 22.6687 180.775 23.1903V39.2489C180.832 39.7125 180.544 39.9443 180.083 39.9443H178.527C178.066 39.9443 177.836 39.7125 177.836 39.2489ZM186.944 23.0165V24.1756C188.212 22.8426 189.71 22.2051 191.497 22.2051C195.937 22.2051 198.646 25.2767 198.646 29.3932V39.2489C198.703 39.7125 198.415 39.9443 197.954 39.9443H196.398C195.936 39.9443 195.705 39.7125 195.705 39.2489V29.4511C195.705 27.1329 193.803 25.2187 191.439 25.2187C189.134 25.2187 187.175 27.075 187.175 29.2773V39.3068C187.232 39.7705 186.944 40.0023 186.424 40.0023H184.868C184.407 40.0023 184.119 39.7705 184.119 39.3068V23.1903C184.061 22.7267 184.349 22.4949 184.868 22.4949H186.309C186.712 22.4949 186.944 22.6687 186.944 23.0165Z"/>
      <path d="M204 40C205.115 40 206 39.0857 206 38V37.9886C206 36.9029 205.126 36 204 36C202.885 36 202 36.9143 202 38V38.0114C202 39.0971 202.874 40 204 40ZM204 39.7829C202.989 39.7829 202.23 38.9829 202.23 38.0114V38C202.23 37.0286 203 36.2171 204 36.2171C205.011 36.2171 205.77 37.0171 205.77 37.9886V38C205.77 38.9714 205 39.7829 204 39.7829ZM203.218 38.9714H203.609V38.2743H204.034L204.517 38.9714H204.989L204.448 38.2057C204.724 38.1257 204.92 37.92 204.92 37.5886C204.92 37.1657 204.586 36.9486 204.138 36.9486H203.218V38.9714ZM203.609 37.9543V37.2914H204.103C204.368 37.2914 204.517 37.4057 204.517 37.6229C204.517 37.8171 204.368 37.9543 204.103 37.9543H203.609Z"/>
    </svg>`],[CI[1],`<svg viewBox="0 0 43 60">
      <path d="M14.0291 7.06645C14.0291 10.9691 10.8885 14.1329 7.01453 14.1329C3.14051 14.1329 0 10.9691 0 7.06645C0 3.16376 3.14051 0 7.01453 0C10.8885 0 14.0291 3.16376 14.0291 7.06645Z"/>
      <path d="M28.7335 18.3468H35.1045C36.7455 18.3468 37.5178 19.0599 37.5821 20.6158V57.7309C37.5821 59.2868 36.8099 60 35.1367 60H28.9588C27.1569 60 26.642 59.7406 25.6767 58.282L12.6452 38.282V57.7309C12.6452 59.2868 11.8729 60 10.1997 60H3.82873C2.15554 60 1.3833 59.2868 1.3833 57.7309V20.6158C1.3833 19.0599 2.15554 18.3468 3.82873 18.3468H10.1032C11.9051 18.4116 12.4843 18.671 13.3852 20.0648L26.3524 40.162V20.6158C26.3524 19.0599 27.1247 18.3468 28.7335 18.3468Z"/>
      <path d="M41.5 60C42.3362 60 43 59.3143 43 58.5V58.4914C43 57.6771 42.3448 57 41.5 57C40.6638 57 40 57.6857 40 58.5V58.5086C40 59.3229 40.6552 60 41.5 60ZM41.5 59.8371C40.7414 59.8371 40.1724 59.2371 40.1724 58.5086V58.5C40.1724 57.7714 40.75 57.1629 41.5 57.1629C42.2586 57.1629 42.8276 57.7629 42.8276 58.4914V58.5C42.8276 59.2286 42.25 59.8371 41.5 59.8371ZM40.9138 59.2286H41.2069V58.7057H41.5259L41.8879 59.2286H42.2414L41.8362 58.6543C42.0431 58.5943 42.1897 58.44 42.1897 58.1914C42.1897 57.8743 41.9397 57.7114 41.6034 57.7114H40.9138V59.2286ZM41.2069 58.4657V57.9686H41.5776C41.7759 57.9686 41.8879 58.0543 41.8879 58.2171C41.8879 58.3629 41.7759 58.4657 41.5776 58.4657H41.2069Z"/>
    </svg>`]]),S_e=/<svg([^>]*)>/g;function Vee(i,e,t,r){let n=w_e.get(i);return n?n.replace(S_e,`<svg$1 width="${t}" height="${r}" xmlns="http://www.w3.org/2000/svg" style="fill: ${e};">`):""}h(Vee,"getLogoIcon");var EI=!1,jh={padding:16,scale:1,iconOnly:!1,position:"bottom-left",color:"dark",onClick:()=>{window!=null&&window.open("https://www.mappedin.com")}},nn,Pf,s0,to,_n,Mc,Io,ps,io,Lo,jee=class extends Hr{constructor(e,t,r,n,a){var o,s,l,u,c,p;super(),fe(this,nn,void 0),fe(this,Pf,void 0),fe(this,s0,void 0),fe(this,to,void 0),fe(this,_n,void 0),fe(this,Mc,void 0),fe(this,Io,0),fe(this,ps,0),fe(this,io,0),fe(this,Lo,0),ie(this,"dirty",!0),ie(this,"getPositionAlignedCanvasCoordinates",(d,m)=>({"top-left":{x:0,y:0},"top-right":{x:d,y:0},"bottom-left":{x:0,y:m},"bottom-right":{x:d,y:m},center:{x:d/2,y:m/2},top:{x:d/2,y:0},bottom:{x:d/2,y:m},left:{x:0,y:m/2},right:{x:d,y:m/2}})[M(this,nn).position]),ie(this,"getPositionAlignedPadding",()=>{var d,m,g,b;let x=M(this,nn).padding;if(typeof x=="number")return{"top-left":{x,y:x},"top-right":{x:-x,y:x},"bottom-left":{x,y:-x},"bottom-right":{x:-x,y:-x},center:{x:0,y:0},top:{x:0,y:x},bottom:{x:0,y:-x},left:{x,y:0},right:{x:-x,y:0}}[M(this,nn).position];let v={top:(d=x.top)!=null?d:0,right:(m=x.right)!=null?m:0,bottom:(g=x.bottom)!=null?g:0,left:(b=x.left)!=null?b:0};return{x:v.left-v.right,y:v.top-v.bottom}}),ke(this,nn,{position:(o=a==null?void 0:a.position)!=null?o:jh.position,padding:(s=a==null?void 0:a.padding)!=null?s:jh.padding,scale:(l=a==null?void 0:a.scale)!=null?l:jh.scale,iconOnly:(u=a==null?void 0:a.iconOnly)!=null?u:jh.iconOnly,color:(c=a==null?void 0:a.color)!=null?c:jh.color,onClick:(p=a==null?void 0:a.onClick)!=null?p:jh.onClick}),ke(this,s0,e),ke(this,Pf,n),ke(this,io,t),ke(this,Lo,r)}get color(){return M(this,nn).color==="light"?"white":"#293136"}get iconName(){return M(this,nn).iconOnly?"icon":"horizontal"}get minWidth(){return M(this,nn).iconOnly?x_e:75}get defaultWidth(){return M(this,nn).iconOnly?__e:150}get aspectRatio(){return M(this,nn).iconOnly?b_e:v_e}get options(){return{...M(this,nn)}}set options(e){let{onClick:t,...r}=e;typeof t=="function"&&Ft.warn("Setting the onClick option is currently unavailable."),Object.assign(M(this,nn),r)}get icon(){return Vee(this.iconName,this.color,M(this,Io)*M(this,Pf).pixelRatio,M(this,ps)*M(this,Pf).pixelRatio)}setSize(e,t){M(this,_n)&&(M(this,_n).uniforms.uSize.value.x=e,M(this,_n).uniforms.uSize.value.y=t)}setXY(e,t){M(this,_n)&&(M(this,_n).uniforms.uSize.value.w=e,M(this,_n).uniforms.uSize.value.z=t)}get width(){return M(this,Io)}get height(){return M(this,ps)}getPositionAlignedOffset(e,t){return{"top-left":{x:0,y:0},"top-right":{x:-e,y:0},"bottom-left":{x:0,y:-t},"bottom-right":{x:-e,y:-t},center:{x:-(e/2),y:-(t/2)},top:{x:-(e/2),y:0},bottom:{x:-(e/2),y:-t},left:{x:0,y:-(t/2)},right:{x:-e,y:-(t/2)}}[M(this,nn).position]}clampWithWarning(e,t,r,n){return t>=r?(Ft.warn(`Watermark ${n} does not fit within given space.`),t):e<t||e>r?(Ft.warn(`Watermark ${n} must be between ${t} and ${r}.`),ki.clamp(e,t,r)):e}show(){if(!M(this,_n)){Ft.warn("Watermark material is not initialized.");return}M(this,_n).visible=!0,this.resize(M(this,io),M(this,Lo))}hide(){if(!M(this,_n)){Ft.warn("Watermark material is not initialized.");return}M(this,_n).visible=!1,ke(this,Mc,void 0)}insertIntoQuadTree(e){M(this,Mc)!=null&&typeof M(this,nn).onClick=="function"&&e.insert(M(this,Mc))}render(){let e=this.clampWithWarning(this.defaultWidth*M(this,nn).scale,this.minWidth,M(this,io),"width");ke(this,Io,e),ke(this,ps,M(this,Io)/this.aspectRatio),Pee.getLoader().load(`data:image/svg+xml;base64,${btoa(this.icon)}`,t=>{if(ke(this,_n,new xo({uniforms:{uTexture:{value:t},uSize:{value:new Ei(0,0,0,0)},uOpacity:{value:.7}},vertexShader:g_e,fragmentShader:y_e,depthWrite:!1,depthTest:!1,defines:{debug:EI},wireframe:EI,transparent:!0,visible:!0})),M(this,to))M(this,to).material=M(this,_n),M(this,to).material.needsUpdate=!0;else{let r=new rg(2,2,1,1);ke(this,to,new Wi(r,M(this,_n))),M(this,to).position.set(0,0,-1),M(this,to).frustumCulled=!1,M(this,to).renderOrder=999;let n=new Ux(1,1,1),a=new Wi(n,new rd({transparent:!0,opacity:0,depthTest:!1,depthWrite:!1}));a.layers.set(1),M(this,to).add(a),M(this,s0).add(M(this,to))}this.resize(M(this,io),M(this,Lo)),this.publish("texture-loaded")})}resize(e,t){ke(this,io,e),ke(this,Lo,t);let r=this.getPositionAlignedCanvasCoordinates(M(this,io),M(this,Lo)),n=this.getPositionAlignedPadding(),a=this.getPositionAlignedOffset(M(this,Io),M(this,ps)),o=this.clampWithWarning(r.x+n.x+a.x,0,M(this,io)-M(this,Io),"x"),s=this.clampWithWarning(r.y+n.y+a.y,0,M(this,Lo)-M(this,ps),"y");this.setSize(M(this,Io)/M(this,io),M(this,ps)/M(this,Lo)),this.setXY(o/M(this,io),s/M(this,Lo)),ke(this,Mc,new Ia(o,s,M(this,Io),M(this,ps),{entityId:"watermark"}))}update(){this.dirty&&(this.render(),this.dirty=!1)}};nn=new WeakMap,Pf=new WeakMap,s0=new WeakMap,to=new WeakMap,_n=new WeakMap,Mc=new WeakMap,Io=new WeakMap,ps=new WeakMap,io=new WeakMap,Lo=new WeakMap,h(jee,"WatermarkSystem");var M_e=jee;R();var G2=100,Hee=class{constructor(e,t){Z(this,"currentTotalBoundingBox");Z(this,"state");Z(this,"cameraSystem");Z(this,"dirty",!1);this.state=e,this.cameraSystem=t}update(){if(this.dirty){this.currentTotalBoundingBox==null&&(this.currentTotalBoundingBox=new Yr,this.state.entityScene.children.length===0?this.currentTotalBoundingBox.setFromCenterAndSize(new le(0,0,0),new le(G2*2,G2*2,0)):(this.currentTotalBoundingBox.setFromObject(this.state.entityScene),this.currentTotalBoundingBox.expandByScalar(G2))),this.currentTotalBoundingBox.expandByObject(this.state.entityScene);for(let e of this.state.entity2DMap.values())e.positionDirty===!0&&(this.currentTotalBoundingBox.expandByPoint(e.position),e.positionDirty=!1);this.cameraSystem.panBounds={center:this.currentTotalBoundingBox.getCenter(new le),min:this.currentTotalBoundingBox.min,max:this.currentTotalBoundingBox.max,radius:this.currentTotalBoundingBox.getBoundingSphere(new Xn).radius},this.cameraSystem.dirty=!0,this.dirty=!1}}};h(Hee,"PanBoundsSystem");var C_e=Hee;R();var W2="© Mappedin",E_e="https://info.mappedin.com/feedback",TI=["top-left","top-right","bottom-left","bottom-right"],T_e=640,P_e=h(()=>`<svg xmlns='http://www.w3.org/2000/svg' width='15' height='15' fill-rule='evenodd' viewBox='0 0 20 20'>
						<circle cx='10' cy='10' r='5.9' style='fill:rgba(255,255,255,1);'/>
						<path style='fill:rgba(0,0,0,0.7);' d='M4 10a6 6 0 1 0 12 0 6 6 0 1 0-12 0m5-3a1 1 0 1 0 2 0 1 1 0 1 0-2 0m0 3a1 1 0 1 1 2 0v3a1 1 0 1 1-2 0'/>
					</svg>`,"getAttributionButtonIcon"),PI={position:"bottom-right"},Gee=class{constructor(e){Z(this,"controlContainerEl");Z(this,"controlPositions");Z(this,"compact");Z(this,"attribContainerEl");Z(this,"attribInnerEl");Z(this,"attribButtonEl");Z(this,"feedbackLinkEl");Z(this,"attribHTML",W2);Z(this,"toggleAttribution",e=>{this.attribContainerEl!=null&&(e.preventDefault(),this.attribContainerEl.classList.contains("mappedin-compact")&&(this.attribContainerEl.classList.contains("mappedin-compact-show")?(this.attribContainerEl.removeAttribute("open"),this.attribContainerEl.classList.remove("mappedin-compact-show")):(this.attribContainerEl.classList.add("mappedin-compact-show"),this.attribContainerEl.setAttribute("open",""))))});this.controlContainerEl=document.createElement("div"),this.controlContainerEl.classList.add("mappedin-control-container"),e.appendChild(this.controlContainerEl),this.controlPositions=TI.reduce((t,r)=>{let n=document.createElement("div");return n.classList.add(`mappedin-ctrl-${r}`),this.controlContainerEl.appendChild(n),t[r]=n,t},{})}addAttributionControl(e=PI){let t=TI.includes(e.position)?e.position:PI.position;this.attribContainerEl=document.createElement("details"),this.attribContainerEl.classList.add("mappedin-ctrl-attrib",`mappedin-ctrl-attrib-${t}`),this.attribContainerEl.open=!0,this.attribContainerEl.tabIndex=0,this.attribContainerEl.ariaLabel="Attribution",this.controlPositions[t].appendChild(this.attribContainerEl),this.attribButtonEl=document.createElement("summary"),this.attribButtonEl.addEventListener("click",this.toggleAttribution),this.attribButtonEl.classList.add("mappedin-ctrl-attrib-button"),this.attribButtonEl.title="Toggle attribution",this.attribButtonEl.ariaLabel="Toggle attribution",this.attribButtonEl.tabIndex=0,this.attribButtonEl.innerHTML=P_e(),this.attribContainerEl.appendChild(this.attribButtonEl),this.attribInnerEl=document.createElement("div"),this.attribInnerEl.classList.add("mappedin-ctrl-attrib-inner"),this.attribInnerEl.innerHTML=W2,this.attribContainerEl.appendChild(this.attribInnerEl),this.feedbackLinkEl=document.createElement("a"),this.feedbackLinkEl.href=E_e,this.feedbackLinkEl.target="_blank",this.feedbackLinkEl.rel="nofollow noopener noreferrer",this.feedbackLinkEl.textContent="Provide Feedback",this.feedbackLinkEl.classList.add("mappedin-ctrl-attrib-inner"),this.feedbackLinkEl.classList.add("mappedin-ctrl-attrib-inner-bold"),this.attribContainerEl.appendChild(this.feedbackLinkEl)}updateAttribution(e){if(!e.style||!this.attribInnerEl||!this.attribContainerEl)return;let t=[W2],r=e.style.sourceCaches;for(let a in r){let o=r[a];if(o.used||o.usedForTerrain){let s=o.getSource();s.attribution&&t.indexOf(s.attribution)<0&&t.push(s.attribution)}}t=t.filter(a=>String(a).trim()),t.sort((a,o)=>a.length-o.length),t=t.filter((a,o)=>{for(let s=o+1;s<t.length;s++)if(t[s].indexOf(a)>=0)return!1;return!0});let n=t.join(" ");n!==this.attribHTML&&(this.attribHTML=n,t.length?(this.attribInnerEl.innerHTML=this.attribHTML,this.attribContainerEl.classList.remove("outdoor-attrib-empty")):this.attribContainerEl.classList.add("mappedin-attrib-empty"),this.resizeAttribution(e.getCanvasContainer().offsetWidth))}resizeAttribution(e){this.attribContainerEl&&(e<=T_e||this.compact?this.compact===!1?this.attribContainerEl.setAttribute("open",""):!this.attribContainerEl.classList.contains("mappedin-compact")&&!this.attribContainerEl.classList.contains("mappedin-attrib-empty")&&(this.attribContainerEl.setAttribute("open",""),this.attribContainerEl.classList.add("mappedin-compact","mappedin-compact-show")):(this.attribContainerEl.setAttribute("open",""),this.attribContainerEl.classList.contains("mappedin-compact")&&this.attribContainerEl.classList.remove("mappedin-compact","mappedin-compact-show")))}destroyAttributionControl(){this.attribButtonEl&&this.attribButtonEl.removeEventListener("click",this.toggleAttribution),this.attribContainerEl&&(this.attribContainerEl.remove(),this.attribContainerEl=void 0,this.attribInnerEl=void 0,this.attribButtonEl=void 0)}resize(e){this.resizeAttribution(e)}updateData(e){this.updateAttribution(e)}destroy(){this.destroyAttributionControl(),this.controlContainerEl.remove(),this.compact=void 0}};h(Gee,"HTMLControlsSystem");var A_e=Gee;R();var l0,Wee=class{constructor(e,t){ie(this,"mesh"),ie(this,"type","custom-geometry"),ie(this,"dirty",!0),ie(this,"feature"),ie(this,"builder"),ie(this,"outline"),ie(this,"color",new Lt),fe(this,l0,0),this.mesh=new n_,this.feature=e,this.builder=t}get visible(){return this.mesh.visible}set visible(e){this.mesh.visible=e}setOpacity(){}setColor(){}get position(){var e;return(e=this.mesh)==null?void 0:e.position}get altitude(){return M(this,l0)}set altitude(e){this.mesh&&(this.mesh.position.z=e,ke(this,l0,e))}};l0=new WeakMap,h(Wee,"CustomGeometryComponent");var X2=Wee;R();var Xee=class{constructor(e){Z(this,"state");this.state=e}update(){let e,t;for(let r of this.state.threeDEntities){let n=this.state.entity3DMap.get(r);(n==null?void 0:n.type)==="custom-geometry"&&(e=n.components[0],t=n.components[1],e.dirty&&t.visible!==!1&&(e.builder.setup(e.mesh),e.mesh.traverse(a=>{a.userData={entityId:r,type:"custom-geometry"}}),e.dirty=!1),t.visible!==!1&&e.builder.update(e.mesh))}}};h(Xee,"CustomGeometrySystem");var I_e=Xee;R();var qee=class{constructor(e){Z(this,"rendererState");Z(this,"dirty",!0);Z(this,"geometries3DDirty",!0);this.rendererState=e}update(e,t=!1){var r,n;let a=t&&e>=16&&e<=19,o;if(this.geometries3DDirty){for(let s of this.rendererState.threeDEntities)if(o=this.rendererState.entity3DMap.get(s),o&&o.type==="geometry-group"&&o.userData.modelURL===void 0&&o.userData.dirty===!1&&o.userData.outlineDirty===!0){let l=o.children[0];o.userData.outlineDirty=!1;let u=SM(o);if(u&&((r=o.parent)==null||r.remove(u),u.geometry.dispose()),!o.components[0].outline||!o.visible)continue;if(o.children.length>0){let c;if(l instanceof XQ){let d=[],m,g,b,x;for(let v of o.userData.entities3D)x=this.rendererState.entity3DMap.get(v),x instanceof Vn&&(g=x.components[0],b=x.components[1],g instanceof Ho&&b.visible&&b.outline&&(m=g==null?void 0:g.geometry,m&&d.push(m)));if(d.length===0||(c=sd(d),!c))continue}else c=l.geometry;let p=gee(c,l.material);p.userData.outlineOfEntityId=o.userData.entityId;for(let d of o.userData.entities3D.values()){let m=this.rendererState.entity3DMap.get(d);(m==null?void 0:m.type)==="geometry"&&(m.components[0].outline=p)}(n=o.parent)==null||n.add(p)}this.dirty=!0}this.geometries3DDirty=!1}if((a||this.dirty)&&this.rendererState.threeDEntities.length>0){let s=yh(e,16,19,0,1),l;for(let u of this.rendererState.threeDEntities)if(l=this.rendererState.entity3DMap.get(u),(l==null?void 0:l.type)==="geometry-group"&&l.components[0]!=null&&l.components[0].outline&&l.visible){let c=SM(l);if(c&&c.visible){let p=Array.isArray(c.material)?c.material:[c.material];for(let d of p)d.opacity=s}}}this.dirty=!1}};h(qee,"OutlineInterpolationSystem");var L_e=qee;function SM(i){var e;let t=(e=i.parent)==null?void 0:e.children.find(r=>r.userData.outlineOfEntityId===i.userData.entityId);return t instanceof Hx?t:void 0}h(SM,"findOutline");R();var yu,Zee=class extends Hr{constructor(e,t){super(),ie(this,"cameraDirty",!0),ie(this,"focusablesDirty",!0),ie(this,"state"),ie(this,"camera"),ie(this,"debugEl",null),ie(this,"raycasters",[]),ie(this,"collisions",new Map),ie(this,"focusableEntities",new Set),fe(this,yu,void 0),ie(this,"update",()=>{M(this,yu)&&cancelAnimationFrame(M(this,yu)),ke(this,yu,requestAnimationFrame(()=>{this.updateRaf()}))}),this.state=e,this.camera=t,this.buildRaycasters()}resize(){this.buildRaycasters()}buildRaycasters(){this.debugEl&&this.debugEl.remove();let e=new Oe(this.state.canvasWidth/2,this.state.canvasHeight/2),t=new Oe(e.x/1.2,e.y/1.2),r=new Oe(e.x+(e.x-t.x),t.y),n=new Oe(t.x,e.y+(e.y-t.y)),a=new Oe(r.x,n.y);this.debugEl=document.createElement("div"),Object.assign(this.debugEl.style,{position:"absolute",top:"0",left:"0",width:"100%",height:"100%",pointerEvents:"none"}),document.body.append(this.debugEl),this.raycasters=[e,t,r,n,a].map((o,s)=>{let l=o.x/this.state.canvasWidth*2-1,u=-(o.y/this.state.canvasHeight)*2+1,c=new Oe(l,u),p=new ug;return p.setFromCamera(c,this.camera),[p,c,s===0?10:s<5?2:1]})}updateFocusableEntities(){this.focusableEntities.clear();let e,t;for(let r of this.state.threeDEntities)if(t=this.state.entity3DMap.get(r),t!=null&&(e=t.components[0],e instanceof Ho&&e.focusable&&e.geometry!=null)){if(e.focusMesh==null){let n=new Wi(e.geometry);n.userData={entityId:t.id},e.focusMesh=n}this.focusableEntities.add(e.focusMesh)}this.focusablesDirty=!1}updateRaf(){if(!this.cameraDirty)return;this.focusablesDirty&&this.updateFocusableEntities(),this.collisions.clear();for(let[n,a]of this.raycasters)n.setFromCamera(a,this.camera);let e=null,t,r=-1/0;for(let[n,a,o]of this.raycasters)n.intersectObjects(Array.from(this.focusableEntities.values())).forEach(s=>{if((s==null?void 0:s.object)!=null&&"isMesh"in s.object&&s!=null&&s.object.isMesh){t=s.object.userData.entityId,this.collisions.has(t)||this.collisions.set(t,0);let l=this.collisions.get(t)+o;this.collisions.set(t,l),l>r&&(e=t,r=l)}});this.publish("geometry-in-focus",e),this.cameraDirty=!1}destroy(){M(this,yu)&&cancelAnimationFrame(M(this,yu)),this.debugEl&&this.debugEl.remove(),this.collisions.clear(),this.focusableEntities.clear(),this.raycasters=[]}};yu=new WeakMap,h(Zee,"GeometryInFocusSystem");var D_e=Zee;R();var Yee=class{constructor(e){Z(this,"dirty",!0);Z(this,"map");Z(this,"stylesheetId","");Z(this,"userHiddenLayers",new Set);Z(this,"hiddenLayersInStyle",new Set);Z(this,"centerPoint");Z(this,"handleRender",async()=>{if(!this.map||!this.dirty||!this.hiddenLayersInStyle||this.hiddenLayersInStyle.size===0)return;let e=[],t=this.map.project(this.centerPoint),r=this.map.queryRenderedFeatures(t,{layers:Array.from(this.hiddenLayersInStyle)});for(var n of r)e.push(["!=",["id"],n.id]);e.length>0&&(this.hiddenLayersInStyle.forEach(a=>{this.map.setFilter(a,["all",...e])}),this.dirty=!1)});Z(this,"handleStyleChange",e=>{var t,r;if(this.map&&e&&e.dataType==="style"&&e.type==="styledata"&&this.userHiddenLayers.size>0){let n=(r=(t=e==null?void 0:e.style)==null?void 0:t.stylesheet)==null?void 0:r.id;(!n||n!==this.stylesheetId)&&(this.stylesheetId=n,this.filterStylesInMap(),this.dirty=!0)}});e&&(this.map=e,this.map.on("styledata",this.handleStyleChange),this.map.on("render",this.handleRender))}hideLayersUnderPoint(e,t){this.centerPoint=e;for(let r of t)this.userHiddenLayers.add(r);this.dirty=!0,this.filterStylesInMap(),this.handleRender()}filterStylesInMap(){if(this.hiddenLayersInStyle=new Set,this.map)for(let e of this.userHiddenLayers)this.map.getLayer(e)&&this.hiddenLayersInStyle.add(e)}destroy(){this.map&&(this.map.off("styledata",this.handleStyleChange),this.map.off("render",this.handleRender))}};h(Yee,"OutdoorLayers");var k_e=Yee;R();R();R();var AI=`attribute float pathDistance;
attribute vec3 pathNormal;
attribute vec3 pathTangent;

uniform vec2 uvScale;
uniform float vertexes;
uniform float complete;
uniform float nearRadius;
uniform float farRadius;
uniform float nearZoom;
uniform float farZoom;
uniform float pulse;
uniform float pulseLength;
uniform bool pathIsVertical;
uniform bool displayArrowsOnPath;
uniform vec2 cameraParameters;
uniform float flattenFactor;

varying float zoomLevel;
varying float radius;
varying vec2 fragTexcoord;
varying float fragTopTextureU;
varying float fragPathDistance;

// Map the x value from the range [xMin, xMax] to the range [yMin, yMax] using
// linear interpolation/extrapolation.
//
// This performs a pure linear mapping \`y = mx + b\` where
// \`m = (yMax - yMin) / (xMax - xMin)\`,
// \`b = -xMin * (yMax - yMin) / (xMax - xMin) + yMin\`.
float remap(float x, float xMin, float xMax, float yMin, float yMax) {
	return (x - xMin) / (xMax - xMin) * (yMax - yMin) + yMin;
}

// Map the x value from [xMin, xMax] to the range [yMin, yMax] using linear
// interpolation, clamping result values outside [yMin, yMax].
float clampRemap(float x, float xMin, float xMax, float yMin, float yMax) {
	return clamp(remap(x, xMin, xMax, yMin, yMax), yMin, yMax);
}

void main() {
	fragPathDistance = pathDistance;

	// We can get an origin point for the cross-section of the path by
	// subtracting the surface normal times the radius, since the surface normal
	// points strictly away from the centre.
	vec3 origin = position - nearRadius * normal;

	// Inflate the path along its surface normal to increase its radius from
	// \`nearRadius\` to \`farRadius\` when the camera is at \`farZoom\`.
	vec3 adjustedPosition = position;
	zoomLevel = clampRemap(cameraParameters.x, nearZoom, farZoom, 0.0, 1.0);
	adjustedPosition += normal * (farRadius - nearRadius) * zoomLevel;

	// Determine how far the path extends "up" or "down" in the direction of the
	// path normal.
	float height = dot(adjustedPosition - origin, pathNormal);

	// Flatten the bottom half of the path entirely so that it's flat
	// against the floor. This makes the path look nicer when it's
	// semitransparent behind opaque geometry, so you don't see it
	// peeking through.
	float desiredHeight = max(height, 0.0);

	desiredHeight = desiredHeight * flattenFactor;

	float flattenMagnitude = height - desiredHeight;
	adjustedPosition = adjustedPosition - pathNormal * flattenMagnitude;

	// Transform the vertices into NDC.
	vec4 mvPosition = modelViewMatrix * vec4(adjustedPosition, 1.0);
	gl_Position = projectionMatrix * mvPosition;

	fragTexcoord = uv;

	// Compute a texture coordinate for mapping the arrow texture to the path.
	// We don't want to use the u-value that Three.js provides, because the
	// path may end up twisting arbitrarily -- but we want the arrow texture to
	// always be on the top of the path.
	vec3 bitangent = cross(normal, pathTangent);
	fragTopTextureU = -dot(bitangent, pathNormal) * 0.5 + 0.5;

	radius = mix(nearRadius, farRadius, zoomLevel);
}
`,II=`#define ARROW_FADING_POINT 0.15

uniform float complete;
uniform float nearRadius;
uniform float farRadius;
uniform vec2 resolution;
uniform vec2 cameraParameters;
uniform vec3 color;
uniform float pathLength;
uniform bool showPulse;
uniform vec3 pulseColor;
uniform float pulse;
uniform float pulseLength;
uniform bool pathIsVertical;
uniform bool displayArrowsOnPath;
uniform float arrowAnimationTimer;
uniform float opacityMultiplier;
uniform sampler2D arrowTexture;

varying float zoomLevel;
varying float radius;
varying vec2 fragTexcoord;
varying float fragTopTextureU;
varying float fragPathDistance;

// How long the arrow should be, as a factor of \`pathRadius\`. Since we've
// mostly flattened the top of the path, values near 2.0 (the diameter)
// will probably look best.
const float arrowLength = 2.0;

// How much of a relative margin the arrow texture should have inside the
// area laid out for it. Useful to pull the arrow away from the edges of the
// path, which slope down.
const float arrowMargin = 0.1;

// How many arrow-lengths of space should be between arrows on a short path.
const float arrowSpacingOnShortPath = 6.0;

// How many arrow-lengths of space should be between arrows on a long path.
const float arrowSpacingOnLongPath = 7.5;

// How long a path must be to be considered "long", as a factor of
// the path radius.
const float longPathLength = 200.;

// How long a path must be to be considered "short", as a factor of the
// path radius.
const float shortPathLength = 75.;

// How much of the path's length the fade-in should comprise when going from
// zero opacity to full opacity.
const float completeLength = 0.1;

// Map the x value from the range [xMin, xMax] to the range [yMin, yMax] using
// linear interpolation/extrapolation.
//
// This performs a pure linear mapping \`y = mx + b\` where
// \`m = (yMax - yMin) / (xMax - xMin)\`,
// \`b = -xMin * (yMax - yMin) / (xMax - xMin) + yMin\`.
float remap(float x, float xMin, float xMax, float yMin, float yMax) {
	return (x - xMin) / (xMax - xMin) * (yMax - yMin) + yMin;
}

// Map the x value from [xMin, xMax] to the range [yMin, yMax] using linear
// interpolation, clamping result values outside [yMin, yMax].
float clampRemap(float x, float xMin, float xMax, float yMin, float yMax) {
	return clamp(remap(x, xMin, xMax, yMin, yMax), yMin, yMax);
}

void main(void) {
	// Compute the opacity of the path based on the distance from the current
	// fragment to the \`complete\` value as it varies from 0.0 to 1.0.
	// Fragments that are at the \`complete\` value or past it will be fully
	// transparent, while fragments that are at \`complete - completeLength\`
	// or before it will be fully opaque. However, we adjust the \`complete\`
	// value here so that it overshoots by one full \`completeLength\`, so that
	// the entire path will be opaque when the \`complete\` value is at 1.0.
	float completeLocation = complete * (1.0 + completeLength);
	float completeAmount = clampRemap(
		fragPathDistance,
		completeLocation - completeLength,
		completeLocation,
		0.0,
		1.0
	);
	float opacity = 1.0 - smoothstep(0.0, 1.0, completeAmount);

	// 2020/01/09 Terence Dickson
	// When we render the background and overlay for the mapbox outdoor context
	// behind everything else in single-buffer rendering, the fact that the path
	// writes to the depth buffer means that the background and overlay will not
	// be drawn behind the path even when the path is still fading in. The effect
	// is subtle and is only visible in single-buffer rendering so this quick fix
	// prevents writes to the depth buffer for zero opacity fragments, which gets
	// rid of the most visually-offensive ghosting.
	if (opacity <= 0.0) {
		discard;
	}

	// Push in the texture coordinates so that they ramp up
	// at \`arrowMargin\` instead of at zero; this remapping looks somewhat
	// like this:
	// 1 ^        ___
	//   |       /
	//   |      /
	//   |     /
	//   |    /
	//   |___/
	// 0 +---------->
	//   0   ^      1
	//       arrowMargin
	// Making the arrows narrower on the path.
	float u = fragTopTextureU;
	u = clamp(
		u * (1. / (1. - arrowMargin * 2.)) - (1. / (1. - arrowMargin * 2.) - 1.) / 2.,
		0.0,
		1.0
	);

	float arrowSpacing = clampRemap(
		pathLength,
		shortPathLength * radius,
		longPathLength * radius,
		arrowSpacingOnShortPath,
		arrowSpacingOnLongPath
	);

	// Reduce the spacing between arrows when the camera zooms out, as increasing
	// the path radius will increase the arrow size and thus be able to fit
	// fewer arrows on in total, and this secondary movement of the arrows
	// "zooming off" the end of the path is unpleasant
	float expandAmount = mix(1.0, farRadius / nearRadius, zoomLevel);
	float effectiveArrowSpacing =
		arrowSpacing * 1.0 / expandAmount +
		arrowMargin * 2.0;

	float effectiveArrowLength = arrowLength * radius * (1. - arrowMargin * 2.0);

	// Adjust the slope of the vertical texture coordinate so that it goes
	// from 0 to 1 along the length of the arrow plus the spacing between
	// arrows, and adjust its x-intercept so that one arrow moves to the
	// exact position of the next arrow as \`arrowAnimationTimer\` goes
	// from 0 to 1
	float v = (
		fragTexcoord.x * (pathLength / effectiveArrowLength)
		- arrowAnimationTimer * (1. + effectiveArrowSpacing)
	);

	// Compute a "looping sawtooth" wave for determining the vertical texture
	// coordinates of the arrow texture, roughly as follows:
	// 3 ^              /
	//   |          ___/
	// 2 |         /
	//   |     ___/
	// 1 |    /
	//   |___/
	// 0 +--------------->
	//   0   ^ ^
	//   ^   |_|
	//   |   effectiveArrowLength
	//   |___|
	//   effectiveArrowSpacing
	//
	// This is effectively equivalent to this sort of sawtooth wave:
	//   ^
	// 1 |    /    /    /
	//   |___/ ___/ ___/
	// 0 +--------------->
	//
	// Causing the image of the arrow to repeat, with dead space (the bottom
	// edge of the texture stretched out) between the arrows at the provided
	// spacing. The reason why the "looping" design is preferred is because
	// it takes advantage of WebGL's \`GL_REPEAT\` texture wrapping behaviour
	// to avoid the discontinuity that can end up causing visual artifacts.
	if (mod(v, (1. + effectiveArrowSpacing)) < 1.) {
		v = v - effectiveArrowSpacing * floor(v / (1. + effectiveArrowSpacing));
	} else {
		v = ceil(v / (1. + effectiveArrowSpacing));
	}

	// Use the r-component of the texture to determine whether the arrow covers
	// this fragment or not
	vec2 sampleTexcoord = vec2(u, v);
	float arrowAmount = 0.0;
	vec3 secondColor = pulseColor;

	if (displayArrowsOnPath) {
		arrowAmount = texture2D(arrowTexture, sampleTexcoord).r;
		float delta = 1.0 - abs(fragPathDistance * 2.0 - 1.0);
		secondColor = mix(color, pulseColor, 1.0 - smoothstep(ARROW_FADING_POINT, 0.0, delta));
	}

	if (showPulse) {
		// Add the pulse color to the path by determining how far the current fragment
		// is from \`pulse\`
		float pulseLocation = remap(
		pulse,
		0.0,
		1.0,
		-pulseLength,
		1.0 + pulseLength
		);
		float pulseDistance = smoothstep(
		0.0,
		pulseLength,
		abs(fragPathDistance - pulseLocation)
		);

		// Blend the pulse color to the path based on how close this fragment is to
		// the \`pulse\` value and whether it's covered by an arrow -- but if it's
		// covered by *both*, then we go back to using the regular path color
		// (making arrows look like "holes" when they're overlapping the pulse.)
		float pulseLevel = abs(1.0 - pulseDistance - arrowAmount);

		gl_FragColor = vec4(mix(color, secondColor, pulseLevel), opacity * opacityMultiplier);
	} else if (displayArrowsOnPath) {
		gl_FragColor = vec4(mix(color, pulseColor, arrowAmount), opacity * opacityMultiplier);
	} else {
		gl_FragColor = vec4(color, opacity * opacityMultiplier);
	}
	#include <colorspace_fragment>
}`,R_e="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEACAAAAAB5Gfe6AAAQkHpUWHRSYXcgcHJvZmlsZSB0eXBlIGV4aWYAAHjarZpZciQ7rkT/uYpeAicQ5HI4mr0dvOX3ATOl0li3q3SVJkUqFMEBcHc4IuX2///fcf/hK7cSXRatpZXi+cott9h5U/3j63EMPt+fL1/h+fPdeff6NnJMHNPjD2U/7+qcl183aH6eH+/PO52PN7E+B3qZ+Tlgspkjb57X1edAKT7Oh+fvrj3v6/nNdp7ftd057abHnz78npVgLGG8FF3cKSTPz2oXJFaQWuocCz9D0mhnEu8Tx54k6dexc98F77vY+f48n96HwvnyvKB8iNHzfJCvY3cj9HZF4dfM7/6QZ4j+7deb2J2z6jn7sbueC5Eq7rmpl63cd1w4GCrd2wov5Vt4r/fVeFW2OMnYIpuD13ShhUi0T8hhhR5O2Pc4w2SJOe5IuGOMM6Z7rhL+FudNSrZXOFFJz3KpkqtJ1hKn4+tawp233flmqMy8AlfGwGCBOz693Fcn/+b1OtA5Bt0QfH2NFeuKFnCWYZmzn1xFQsJ5xlRufO/LvcGNf5PYRAblhrmywe7HY4gh4Re20s1z4jrx2fkHNYKu5wCEiLmFxYREBnwJSUIJXmPUEIhjJT+dlceU4yADQSSu4A65SamQnBptbu7RcK+NEh+nkRYSIZBGSQ0EIlk5C/jRXMFQlyTZiUgRlSpNekklFymlaDGN6po0q2hR1apNe001V6mlaq211d5iS0iYtNLUtdpa651JO0N37u5c0fuII408ZJSho442+gQ+M0+ZZeqss82+4koL+q+y1K262uo7bKC085Zdtu662+4HrJ108pFTjp562umvWXtm9X3WwofM/T5r4Zk1y1i+1+mvrHFa9WWIYHIiljMyFnMg42oZANDRcuZryDla5ixnvkVIIZGsBbHkrGAZI4N5hygnvObuV+Z+mzcn+Y/yFr/LnLPU/RuZc5a6Z+Y+5+2LrK1+K0q6CTIWWkx9OggbF+zaY+1Wk/766H46wF8ONFY+O8hBMEc7oc4Vdh+8JsE+PUSrVjr70Zz1+H56PH3o9sRR1ql5Ha8bUMQxpe89Tki8Sb0tE23cw3DcfEo+ugnj2G3WEmononVfoag71pVjR+EmAE53eT5tqYfEHl/7ThMusaI+St0jktFa9gKnreiQqCNpZ2mJdSkbaiK6DrovYR4/JhJfRsx5d5EVZnEIPetHnU5KynJPTSuCPuC0lOuXH7n1DNq7DpUtHbhM5lDA0c2bnDCJoOObMnyj+aPjPwx0yiDUxKKsg35VnRnBEVhonKwK5hOk5NttUrhr2+tMOXkPJb1RZ+iAelYjL2MuO3pGRQ78GdxwOOaTAcJZcewq7ilB1RJCSozUdSEdwVJVb6asiBsHH1Bqgbiv3Cmkkis6ktVnZGRRwMNJjUA3Ao2127YWdhAIblxF51hzMcZsVZc0r0dJo5Liqfn41Q+q193SGhhkMkgaLJRNnEpqBtyVvbcVffIk+LE9QPFBTMTQe0aWkMXMnx3dy5sfHreDE60Ql50E+SqRcmfK16L2p0Ol8JFATu3qASXy7SvmiGW2cdMBxsty44CvtLogfGlv7WkCSV0WId2270EaD5Ym40cs+SAwZuNjPSTywAvEfLmzQhtLDntfCnhl/fNmUNnzyA2g76Zn0SP+c+I6bCC0FONUQ4L50e95dif+DH/m9htQjBEhPPpOjYjmm2ChbfEMIUaYtAIxmWJHlilLU8ZRs9pCsHbDpFaRgZljz2QandjDIBPZDGTuoZW1KdlYh52ALzisKJRNWSQmLAWx8iv9mGttT15bBc2oxd57bZtVF98CYtK3UH22Yd/A7WaKa+ZjNTOXEzNhMJ5kmQOvfzsbxbZALJ2xwGBjX2HFQybhi7kpbA7DVpS3RxMJwFyHwGk5gs6a4lrRHVqhYT0QTJC9UZcC9Yrelkn6yXch68NKNtG7CiU3vf/zMZAYXPWdrR9XZ/ctMV1sJQ2wJEGxzaHs7LmmHIwnUwbwnNAapBY9xhE19DNJW3ua0dDk/AjwITacR0PqZxkbyJ+E5jYbxI84x1TBE+y90hwDCYZIM0tqAKPZfCzFrbH8kYCm3eqQkZ2+2GovcL8Suokyg8yyCJes6dcouSLiNSLb0ETJU+/N/WFsBBSOXBbm9Cwp4CzlOag7ro7R2vC19nSsCPmAjIEMiobFwaoVXhjTU2XMpgEsDH/L3Sx54OCTMUSXI/IIA2V4QcLQpwVz12pInI0bY56pIQ2BSGRLL+yLfZ7JkiimbK+aepsbwRStpokx5gCqe1hjdMAwcINbkk5jmedrNRAG5pUXPe0sZIoXy1h7lSDxApzheg24JeDNtDS1oBDBUC4iWZFilBPhZx0Kqx2lihpbG9q4sYidksCN4yRYhNM4nxfBbTi4E3AT6B3igbvs9Gv8ZkHsIfdlep+2HelEDbkJdNjqZQ90B7k6OIoFfkkPNoY+z0gzACa1f2qcBYxVJpT2QQgS19dKQlbC24S92xiEAFRKB5Uy1qrBgOtwIge55G0kRPfIytGx0tMOrGfrijB2FHOk/TKcMjDTMPeBo4FnXD5cQ8vtdgoAN0yuzZQHQI09wm/5vAB6RHyI9rYKiZ6YWC6rbaiLmDtoaToC1bViXQFNtgWsOfEEKCleC3GWPSfgQWRQWMgw/9FDgvOZrFAT3SmsA3DLbqlsSppQG5QeOjPXavUUkxF/qgLM05vW5o7UakuBqo2ZW8Nj0LB7imVJC9QSA+wd7RPztIUZ80xQZq0ROrc8CSVncWzkTA/RwmunldCPAQKjqVC7bhRuTIv0plbk7gOX4m5OAi2YesYZ0KBQRToG8iv9x8dgGtgECYRBeEU87OxoSc8epu+s7Mq/MN0VbBT19dii7ekO66UZwdAMtoAVQd13J5nwZe98OgGslmVqAGBkeLZNVNVlWpV18qihntXKnBZvrDIVgFpx4q5poLqREOVplMPSpTF2KvjBAzDpprkruXIaaUmUD4Xo2yrGWcYlixKIwRFjl0jPQhKznUXZAoSjlg9c/NwAI4p3Q/w5bCNfhUZS7bGfqesHqKAlyZZxZgNrhGevZXccaqBys4NEqB3Vqfptji9uUrhCL6yXFqxtm0hhLyYU3Tjd8I/HZaWD1oyVjnG5hhpCN5yHSf8BQUZlVNd00OP4M0TK+JSM7iqWi01SinFkCQXWxiZJLqqAHiEt3G3I2WYd46KU9pIJIOkoRQYCcEAAPguHo0Y4k8Hl6SW50MoW0uZU8jJOUghKo38Nl5ZSwsJNAUC2/lFZWkfMjrU8dFrTjHpJnUrLCILQIxINiYdQlDXaE/razQ4jjQluN5jW1Eh/S7yYvI5gigSjdLYU9TiFXAcHjISiLhQd9obb3OQmwY+YqVwiBMCkOGLXaK/ljBShh56c1g0uyIb2lBRKO7ZTAFncw5c5UGjGSy3CsI1Jt2mtruZkfhBZmbR+842Yu1eDiWEl0V6LZcGem6Ct+LW4Wy3oAjyNObazKBHomhJ3HMKEKHgiGksH+Ig1nTidfNMyA+oYHqVFaRGLiQreVLc9GvQgftKjW9cfUSKNYL80rqU7Um2rwqQJR1ai31Wq7vzKJEsFHDj0bAEMUKXgvfD5bWbaLPBTKz1Nk/Fg+GUZvUzFw80CLaKtPAACVAWrismh863FU4IJ0716SXBUNVb/SDMVvZgDt34CXoOq1JKvg0n08gPHTwXBNgD5W8pZZ8E9EVWcv1DZMB2NFysIwkqBSaH5QRmsAHdkHB+UANvLJvFpQKAahSmYTLEd2AFO+5rsqRRU6sVv5IP0wsSPLcWsbC1Y95mte71CUm6RJJWwkg6Q4k+xWMM0ByElJPQ6j2ED5hY42ALpZRytx9RlgQlJLijzhKi5eX5JBSIRGfo9o2xhd/0aWku8OS+4D9ZnovHDQMPaYo4qm2mlZbUnd7pR6oQj29Z2BqJ9n3LRT+MTLu3IR+ZP2TCPh3EDw8H1NHpoT7FibNYU8WHd9ESHcY12aDOQCUBddi4Ucp+4yuzz8ybcCCu1h8zvzXhDN4HYLq1R+U0xzUqg5QSA3iSBgdDouy55Ifx0DaeEhgezxBRGmoEJ6AJitVuzwtKPlUskHgU2F0LS7AFIwW5jPu0RUL7sp+fkNk0ee8P6uXYgl40WM+cdCOW21r13e0ivt0ff/mYcUfrQZWs2BiN6G+MDTGz1BKORmUTNQp9YGSHFxAeTkQrKd6FoVUogyytW25OLy3OpaO5oZCQp46aPzb5LnJiFEIwAKkmbYVYIjzVv3vj7rA6HignEeQAXTAHKDhoD7Uujh0QjtsB6fTP1NzO7T1Nzq4F1GnfHdXCG1Yxjwdtjf+PGRGTzEtEAUCz7KLfTdItLwCXuSOAzVjaZB6LvbUZhYGWmifSZlcMDnGHPd6gPeiK9erhpiw7ZP9ahTrMhFDa1J53m9ri2DloziqGETTcVSppCbTDDjExg6RrZ6cPEzB8XArEjQSB29odrUoLyoS/65RfM9fprGGjlHpbhGgbYD8MtmW1eFcAWX5dbcMHcl8sUI2k+H7GPW9VrArw3G+BefcCrCaAT/N53YLvP26Uy0kMFnDEZz0DJkmQqEOlL7SlKweYhH8gxpYeAYi0f9magqPbMYZuUI6007lSZQoyoGfYQHsNRzHXR3MMINTSMZpq1KD2A5MDJgtMLdRU6R4CEOJcKGiIJ7K6P/vAM6xpECHI8rRHsaEj6smkngAUjXTzrRoSI48ZpHOqgOY5OejKVdpnmiYUChQnVdIPa6ekGqRSRgEO119oDHOiIUQ5ciYVgaF1oG8Udo8WYtD+DEi8D/w8rAJE2k2PoyV0oMtpauxreaFjpujAvxFlwBhjuNqM9P0IfI5iD8Nh8y1kG4igjJkDNkOijnlLhItAd9lhRd670yNRTu95cR/Xuu0c5WO4DEFk5YQAPtLvU4TYPGRh4APPEDNiuuwR6SC21JoFbQBBMr+zJmT32QplNI6p16PbculN/pCX1wAyTWGTeJ774aln0gvQikw7TmkfsNbdQNs0adutYUDqNtGc0RqngUYdhUYuHSL1/eLrgvqDTC5neu++vufRkEgP9D2T64Kg/c4n+s7k3dDr3me8nOr0c72MRNmgF7D4WySPP0YAI/bI4eixwc7K13QiRiL85A8fnSsUj+mvTrsZtVUEQZ6sTpVafW8nYJZyaZS0U+0xIb6et9PhhtoObozQbjKAoDf6eiFgx1UUvpUYj1GweH0MNMrofhynfWn7+KYu7n5r83hN9aqm+6qjcH7dUlgvZVLV3xqq4fbP16qv+eofuTz43eomAqfS7GBAB9zEE31WJ37eVIPtdGN5A8nMYPvvLt8t2/V/6gM19G4g/hIL7UXf9JgbuLRZ+AoW//AzyMxTcWyz8BAruLRZ+AgX3r3y2+mT/PwfiN1DoVI+QT3CZDmvb8022JeYb6HiQPQpPPvboFB+i1MZdcqWZqthHmix6vttw0UAI1z8oEnGwVe++c7JamxslC+8xKJE41XJmug1npz+6CUAKyURd9gSxo+kWxvtZth848GBlws/0SKjYhmbZ9IiV+mcGBSdWHk8sqSr2zz5J7QME/0yD+z4Pe+JuGn1MV/vUyZwOHojWPlmPXgf9CuoeN9UAT+FGwaLg44v3dWe6QpvuL3Ln/p3k/2AgqNDcfwHgqUmIIqn+hwAAAAJiS0dEAACqjSMyAAAACXBIWXMAAAsSAAALEgHS3X78AAAAB3RJTUUH4wYRESAMujenGAAAB9FJREFUeNrtnWlsFVUUx899fS1gUoKioEY+WBRUEohGkUhAKxgEjSgGoRGB4AJCNKAIJBJZJSiyGYMKKkIoLlEUKhUraxFkKUE2kU1aCrRgW2jpg9f29R2/sBTo67v3zL2zvfP73MzM+XU6mf+5504BGIZhGIZhGIZhGIZhGMZGGq3JvSmR62++BXHH7Ylbf9ouRMT99yVq/e0PICIiHumUmPV3PooXOf5EItafXoCXOdUn8ep/pgjrUDY40ervX4JXUTEiocoXL5/FawiNEwlU/6hzeB3hqQljQIwJYT3UzEkQA2JiGOslsiAhDIgZ1RiD6NIEMBD8NIKxyQr6vv7FtdgQa31uILg0ig2zsZmv4//yePUj7rjNv/U3yUEJ/r7Xr/XfvBmlOPKwT+vfhpIUdvdj/Wm7UZpTz/mv/g4HUYGyQb5r/+SjEhXD/VV/j5OoSGisj16LRe9iVCY8xTcGxIulSKBmtk8MiKHlSMIn8ViMqkQivojHgfcuIJ0VAc/XPzmMVljrcQOBmdVojY1NvVx/8mcRtEqeh+NxypJatM6+ezxb/7Io6uBwR4/e/1moicJunvz956A2ip/1Xv3Nt6JGSgd6rf47/0KtlHssHrfZi5rxVDwWDx5C7XgoHotHC9AANbO8YqBXERohMt8bv/8X/kNDRDM9cA+IgWVojhWuNxAYXo4mWePyeBwYHUKz5Lo6HidNvICmybvVxfXPqEbz7Gvr2vrn1KAdHH7IpX//8yNoD8dcGY+TM6NoF26MxzLTL26Mx0majtM4q5ed7yhNulVsd5WAxqset/mGS6/d5CIBLXI62/7I6ZKyzjUC0rIfsP+hE3zkxt9c8vy7tPnJbiKfuyP+Xdn8ZDeuiMei+zF0juWOGyBNv+iMxw4bEBkl6CzOxmPx6ll0mryWDtb/ViU6z17H4rEYG0I3cMiheByYFEZ34Ew8Dn5UjW7BiXisY/rFDfGYmgWCCwcngXto0q08z1YBSUsy3NWgb5Qe2WSjgJRlfdy2RJPcNXm9bQIarexpsP5VdxHjcbMcm2Q3/5P64i71U8k/ELuLNsVjcct2cnST+rGg+Jo4XmhLPBZ376GOfoOkAIB5NWTHxuu/nzj9ElkA8gLgA+pLlvF43IU4/VI9G1QEAHnIPjfVaP1PnqRdVngKqAkActDMa2Hw/u9zijjjNg5UBcBr1FbD3jbG6h9QSruk8ovfyFESABnUWSNT8VgMI06/lF7aBqomAJ4n3m+G4nHgbeJfZfHljcCKAqDHcWo87m2g/gnE53LhlS+lqQqATv9S4/FL2u//qcT2T34XoAuAdvuJBspf11z/LOKbyYG6q4bqAqDVTqKByjFa21/U6ZfdaWBNADTdTDQQnqSv/pRMYjrZevVLCUUAiF+JBqpnaqv/J2I+zb3mxZwkAMTPDq8ep1A3P/1y3ZOEJABgiaPxuOnvxLN/B7oEwELq/sPl1utvSdz8VPsl6BMAn1AbBKut1t96F+3ENXOFTgFiehXRwAZL8Vi0JW5+qppW7+HIAgDGnyca2G4hHouOh2knvTARdAuAkedsj8cinTj9Ujka9AuAV87YHI/F08TNT2eHgQkB0I/aIDhGmuIU/YnnKxkAZgTAU8SGHC0eDyJufiqKfTKrAqBrPtFAiXo8HlFBO1VBA7ebZQHQifhUVo7H4p2QgQeOdQHQbp8t8Tg4idj+2dPgwJIGAdBqhw3xmDz9EuelQ4cASP3DeDwOziW+ecdbldEiACDbcDxOWkBs/8QNHpoEAPXjLNFMmfpv+IZ4+PjRU5cAWGwwHqcQNz/J2NUmAMgjavHjMfEPTGpvvz4BQH1MrzMkoHoW2CsAppEaBFskemQUA+HJYLcAeJfQINgpNVuvbiA0FuwXAG8qNwh2S07WqxqQ/saPXgEwRDGu7W8te2Q1A6XSH0HWLAD6nVa5zoPS9asZKJb/DLZuAdDzhPx1Hu2gkobkDRQq/J8w7QJAfstevuI3+WQN1F39dkAAtP9H7jpPdFVtiMgZOKC0Z9aAAEiT+mrbScLQjIyBXWngtABokRf/kKefonRF4xvYqrjmYEQApG6Md8SyvrS+eDwDG5QbzUYExL3QMxnUlZGGD5wFbhEADQ7YVwyhr401YCD6LbhHACyK3SA4N9TK6mhMA5EvwE0CYF6sBkFopLXl8exYq9/gLgHwYf3x+PxoqwMC9RoIvw9uE1D/gH3VeOsjItnSq9/OCqhvwL5qAoABA5XU28qsAHjj2tW8mukABgzEXP12WgAMvrpBEPkYwICB2KvfjguAvnUH7GvnARgwUGRhEt24gLoD9tGvAAwYKLDyySzzAqDzpQH76CIAAwYOWtqNYoMAaH9xwP57AAMG9ljbj2SHALhjJyLijwAGDGyzuCPNFgGQuhlxpfw1yR94dfAxi5cmojI/lRyx+rtaX9XDhADr2CVABc//JycWwAJYAAtgASyABbAAFsACWAALYAEsgAWwABbAAlgAC2ABLIAFsAAWwAJYAAtgASyABbAAFsACWAALYAEsgAWwABbAAlgAC2ABLIAFsAAWwAJYAAtgASyABbAAFsACWAALYAEsgAWwABbAAlgAC2ABLIAFsAAWwAJYAAtgASyABbAAFsACWIDToH8FyJUWtVWAALedDoFhGIZhGIZhGIZhGIYxyf+YwEMsIhMo/AAAAABJRU5ErkJggg==",F_e=new DE;function Jee(i,e){let{nearRadius:t,farRadius:r,color:n,accentColor:a,completeFraction:o}=e,s=0,l=1/0,u=e.displayArrowsOnPath,c=!0,p=u,d=t/2+.15,m=0;i[0].z+=d;for(let N=1;N<i.length;++N){i[N].z+=d;let J=i[N].x-i[N-1].x,Y=i[N].y-i[N-1].y,oe=i[N].z-i[N-1].z;m+=Math.sqrt(J*J+Y*Y+oe*oe)}let g=d-.1;i.push(i[i.length-1].clone().setZ(g)),i.unshift(i[0].clone().setZ(g));let b=new En;p&&(b=F_e.load(R_e),b.colorSpace=zn);let x=new Lt(n),v=new Lt(a),w={vertexes:{type:"f",value:1},resolution:{type:"v2",value:new Oe(1,1)},cameraParameters:{type:"v2",value:new Oe(s,0)},complete:{type:"f",value:0},color:{type:"c",value:x},pathLength:{type:"f",value:m},nearRadius:{type:"f",value:t},farRadius:{type:"f",value:r},nearZoom:{type:"f",value:s},farZoom:{type:"f",value:l},pulseColor:{type:"c",value:v},pulse:{type:"f",value:0},pulseLength:{type:"f",value:.075},pathIsVertical:{type:"b",value:!1},arrowAnimationTimer:{type:"f",value:0},arrowTexture:{type:"t",value:b},displayArrowsOnPath:{type:"b",value:u},flattenFactor:{type:"f",value:.05},showPulse:{type:"b",value:c},opacityMultiplier:{type:"f",value:1}},_=new Nq(i);_.curveType="catmullrom",_.tension=0;let C=30,E=8,T=C*i.length,L=new Aye(_,T,t,E,!1),D=new Float32Array(L.attributes.position.count);for(let N=i.length;N<D.length;N++)D[N]=N;L.setAttribute("vertexIndex",new Br(D,1));let B=new Float32Array(L.attributes.position.count),A=new Br(B,1);for(let N=0;N<=T;N++)for(let J=0;J<=E;++J)A.setX(N*(E+1)+J,N/T);L.setAttribute("pathDistance",A);let k=new Float32Array(L.attributes.normal.count*3),$=new Br(k,3);for(let N=0;N<T;N++){let J=L.tangents[N];for(let Y=0;Y<=E;++Y)$.setXYZ(N*(E+1)+Y,J.x,J.y,J.z)}L.setAttribute("pathTangent",$);let O=new Float32Array(L.attributes.normal.count*3),P=new Br(O,3);for(let N=0;N<T;N++){let J=L.tangents[N];var U,G,K;U=-J.x*J.z,G=-J.y*J.z,K=1-J.z*J.z;let Y=Math.sqrt(U*U+G*G+K*K);Y===0&&(Y=1);let oe=U/Y,xe=G/Y,ge=K/Y;for(let Te=0;Te<=E;++Te)P.setXYZ(N*(E+1)+Te,oe,xe,ge)}L.setAttribute("pathNormal",P);let z=new xo({uniforms:w,vertexShader:AI,fragmentShader:II});z.transparent=!0,z.alphaTest=.5,w.resolution.value.x=1,w.resolution.value.y=1,w.vertexes.value=D.length,w.arrowTexture.value.wrapS=po,w.arrowTexture.value.wrapT=po,w.arrowTexture.value.anisotropy=16,w.complete.value=o;let V=new Wi(L,z),j=V.clone(),q={...w,opacityMultiplier:{type:"f",value:.25}};q.complete.value=1,j.material=new xo({uniforms:q,vertexShader:AI,fragmentShader:II}),j.material.transparent=!0,j.material.alphaTest=.5,j.material.depthWrite=!1,j.material.depthTest=!1,j.renderOrder=1,q.resolution.value.x=1,q.resolution.value.y=1,q.vertexes.value=D.length,q.arrowTexture.value.wrapS=po,q.arrowTexture.value.wrapT=po,q.arrowTexture.value.anisotropy=16,q.complete.value=o;let ee=e.mesh;ee.add(V),ee.add(j),L.computeBoundingBox();let ae=new le;return L.boundingBox.getCenter(ae),{mesh:ee,material:z,center:ae}}h(Jee,"buildPath");var Kee=class extends Hr{constructor(t,r){super();Z(this,"rendererState");Z(this,"convertTo3DMapPosition");this.rendererState=t,this.convertTo3DMapPosition=r}update(t,r,n){let a,o=!1;for(let s of this.rendererState.threeDEntities)if(a=this.rendererState.entity3DMap.get(s),a&&a.type==="path"&&a.components[0].type==="path"){let l=a.components[0];if(l.dirty){l.mesh.parent!=null&&l.mesh.children.forEach(m=>{oo(m)});let u=l.feature.features.map(m=>m.geometry.coordinates).map(m=>this.convertTo3DMapPosition(m[1],m[0],m[2]||0)),{mesh:c,material:p,center:d}=Jee(u,l);l.mesh=c,l.material=p,l.dirty=!1,l.position=d}l.material&&(l.material.uniforms.nearZoom.value=t,l.material.uniforms.farZoom.value=r,l.material.uniforms.cameraParameters.value.x=n,l.displayArrowsOnPath&&l.animateArrowsOnPath&&(l.material.uniforms.arrowAnimationTimer.value=performance.now()/1e3,o=!0),l.material.needsUpdate=!0)}o&&this.publish("animate:path")}};h(Kee,"PathSystem");var z_e=Kee,LI=new ug,Qee=18,B_e=12,O_e=22,ete=0,tte=0,N_e=ki.radToDeg(.698132),ea,Mr,u0,Af,vu,Cc,If,h0,MM,$e,wi,Ro,sr,_s,ro,Be,c0,mr,Yi,CM,ite,EM,rte,TM,nte,Zc,p0,d0,Lf,PM,f0,m0,g0,Df,Sa,no,y0,AM,Ec,v0,Dn,kn,ate=class extends Hr{constructor(e,t={}){var r,n,a,o,s,l,u,c,p,d;super(),fe(this,h0),fe(this,CM),fe(this,EM),fe(this,TM),fe(this,Sa),fe(this,y0),ie(this,"options"),ie(this,"container"),fe(this,ea,void 0),fe(this,Mr,void 0),fe(this,u0,void 0),fe(this,Af,void 0),fe(this,vu,void 0),fe(this,Cc,void 0),fe(this,If,void 0),ie(this,"rendererDomElement"),fe(this,$e,{entity3DMap:new Map,entity2DMap:new Map,entity2DIds:new Set,threeDEntities:[],entityScene:new ca("__scene"),hoverColor:"red",insetsPadding:pee,shouldMeasureCanvas:!0,pixelRatio:Wc(),canvasWidth:0,canvasHeight:0}),ie(this,"camera"),fe(this,wi,void 0),fe(this,Ro,void 0),fe(this,sr,void 0),fe(this,_s,void 0),fe(this,ro,void 0),fe(this,Be,{}),fe(this,c0,window.matchMedia("screen and (min-resolution: 2dppx)")),ie(this,"map"),fe(this,mr,h(()=>{M(this,Be).renderSystem.twoDdirty=!0},"#invalidate2DEntities")),fe(this,Yi,h(()=>{M(this,Be).renderSystem.threeDdirty=!0},"#invalidate3DEntities")),fe(this,Zc,"standalone"),fe(this,p0,h(E=>Math.trunc(E*10)/10,"#round10")),fe(this,d0,h(()=>{M(this,Be).twoDDrawSystem.dirty=!0,Ot(this,h0,MM).call(this,Wc()),M(this,Be).watermarkSystem.dirty=!0,this.render()},"#handlePixelRatioChange")),fe(this,Lf,h(()=>{M(this,$e).canvasWidth=this.rendererDomElement.clientWidth,M(this,$e).canvasHeight=this.rendererDomElement.clientHeight,Ot(this,h0,MM).call(this,Wc()),M(this,Df).call(this),Ot(this,TM,nte).call(this),M(this,Be).cameraSystem.resize(this.canvasWidth,this.canvasHeight),M(this,Be).cameraSystem.dirty=!0,M(this,Be).watermarkSystem.resize(this.canvasWidth,this.canvasHeight),M(this,Be).htmlControlsSystem.resize(this.canvasWidth),M(this,Be).geometryInFocusSystem.resize(),this.render()},"#handleWindowResize")),fe(this,PM,h(()=>{this.renderSync()},"#renderFull")),fe(this,f0,new le),fe(this,m0,h((E,T)=>{let L=this.mode==="standalone"?M(this,Mr):this.viewCamera;if(M(this,Mr).position.z+this.camera.elevation>T.z){M(this,f0).copy(T);let D=M(this,f0).project(L),B=(D.x+1)/2*this.canvasWidth-0/2,A=(-D.y+1)/2*this.canvasHeight-0/2,k=M(this,p0).call(this,B),$=M(this,p0).call(this,A);E.x=k,E.y=$}else E.x=-1e3,E.y=-1e3},"#project")),fe(this,g0,h((E,T)=>{M(this,ro).setBufferSize(E,T),M(this,Mr).aspect=E/T,M(this,Mr).updateProjectionMatrix(),M(this,Mr).updateMatrixWorld(!0),M(this,Af).x=E,M(this,Af).y=T},"#setBufferSize")),fe(this,Df,h(()=>{var E;let T=M(this,$e).canvasWidth=this.rendererDomElement.clientWidth,L=M(this,$e).canvasHeight=this.rendererDomElement.clientHeight,D=Math.floor(T*this.resolutionScale),B=Math.floor(L*this.resolutionScale);M(this,g0).call(this,D,B),(E=this.map)==null||E.resize(),M(this,$e).shouldMeasureCanvas=!1},"#measureCanvas")),ie(this,"showCollisionBoxes",()=>{M(this,Be).collisionSystem.showCollisionBoxes(),this.render()}),ie(this,"hideCollisionBoxes",()=>{M(this,Be).collisionSystem.hideCollisionBoxes(),this.render()}),ie(this,"projectScreenXYToCoordinate",(E,T)=>{var L;let D=E/this.canvasWidth*2-1,B=-(T/this.canvasHeight)*2+1,A=new Oe(D,B);LI.setFromCamera(A,M(this,Mr).clone());let k=(L=LI.intersectObject(M(this,vu),!1)[0])==null?void 0:L.point;return k!=null?this.convert3DMapPositionToCoordinate(k):void 0}),ie(this,"projectCoordinateToScreenXY",E=>{let T=this.convertTo3DMapPosition(E[1],E[0],E[2]||0),L=new Oe;return M(this,m0).call(this,L,T),{x:L.x,y:L.y}}),ie(this,"convert3DMapPositionToCoordinate",E=>{var T,L,D,B;let{lat:A,lon:k}=JE((L=(T=M(this,$e).center)==null?void 0:T[1])!=null?L:0,(B=(D=M(this,$e).center)==null?void 0:D[0])!=null?B:0,E.x,E.y);return[k,A]}),ie(this,"setBackgroundColor",(E,T)=>{M(this,ro).setBackgroundColor(E,T)}),ie(this,"hideOutdoorLayersUnderPoint",(E,T)=>{!this.map||(T==null?void 0:T.length)===0||(M(this,Be).outdoorLayersSystem.hideLayersUnderPoint(E,T),this.render())}),fe(this,Ec,new ig),fe(this,v0,new jt),ie(this,"render",()=>{M(this,Be).renderSystem!=null&&(this.map&&(this.mode==="outdoors-interleaved"||this.mode==="outdoors-overlay")?this.map.triggerRepaint():M(this,Be).renderSystem.update())}),ie(this,"renderSync",()=>{M(this,Be).renderSystem.update(!0)}),fe(this,Dn,xp(()=>{this.publish("user-interaction-start",void 0)},0,!0)),fe(this,kn,xp(()=>{this.publish("user-interaction-end",void 0)},0,!0)),ie(this,"on",(E,T)=>{super.on(E,T),["outdoor-view-loaded","outdoor-style-loaded"].includes(E)&&this.mode==="standalone"&&hr.env.NODE_ENV!=="test"&&(Ft.warn(`"${E}" was subscribed to but outdoor view is disabled. The event has been triggered immediately. Enable outdoor view or remove the listener.`),this.publish(E))}),ie(this,"off",(E,T)=>{super.off(E,T)}),ie(this,"getCursor",()=>M(this,Be).interactionSystem.getCursor()),ie(this,"destroy",()=>{M(this,Be).cameraSystem.off("user-dolly-start",M(this,Dn)),M(this,Be).cameraSystem.off("user-pan-start",M(this,Dn)),M(this,Be).cameraSystem.off("user-rotate-start",M(this,Dn)),M(this,Be).cameraSystem.off("user-zoom-start",M(this,Dn)),M(this,Be).cameraSystem.off("user-tilt-start",M(this,Dn)),M(this,Be).cameraSystem.off("user-pedestal-start",M(this,Dn)),M(this,Be).cameraSystem.off("user-dolly-end",M(this,kn)),M(this,Be).cameraSystem.off("user-pan-end",M(this,kn)),M(this,Be).cameraSystem.off("user-rotate-end",M(this,kn)),M(this,Be).cameraSystem.off("user-zoom-end",M(this,kn)),M(this,Be).cameraSystem.off("user-tilt-end",M(this,kn)),M(this,Be).cameraSystem.off("user-pedestal-end",M(this,kn)),M(this,Be).renderSystem.off("measure-canvas",M(this,Df)),this.remove("__scene"),M(this,mr).call(this),M(this,Yi).call(this),this.renderSync(),M(this,Be).renderSystem.destroy(),M(this,Be).zoomInterpolationSystem.destroy(),M(this,Be).renderSystem.destroy(),M(this,Be).cameraSystem.off("change",this.render),M(this,Be).pathSystem.off("animate:path",this.render),M(this,Be).cameraSystem.dispose(),M(this,Be).exporterSystem.destroy(),M(this,Be).outdoorLayersSystem.destroy(),M(this,Be).drawSystem.destroy(),window.removeEventListener("resize",M(this,Lf),!1),M(this,c0).removeEventListener("change",M(this,d0)),M(this,Cc)&&M(this,Cc).disconnect(),this._subscribers={},M(this,ro).destroy(),M(this,ea).traverse(E=>{oo(E),"dispose"in E&&typeof E.dispose=="function"&&E.dispose()}),ke(this,ea,void 0),M(this,Be).htmlControlsSystem.destroy(),M(this,Be).collisionSystem.destroy(),M(this,Be).domMutationSystem.destroy(),M(this,Be).geometryInFocusSystem.destroy(),ke(this,Be,void 0),this.map&&(this.map.transform.getElevation=void 0,this.map.remove()),this.container.contains(this.rendererDomElement)&&this.container.removeChild(this.rendererDomElement),this.container.removeChild(M(this,_s)),this.container.removeChild(M(this,wi)),ke(this,ro,void 0)}),this.convertTo3DMapPosition=this.convertTo3DMapPosition.bind(this),(t.mode==="outdoors-interleaved"||t.mode==="outdoors-overlay")&&t.map&&(ke(this,Zc,t.mode),this.map=t.map),M(this,$e).entityScene.addEventListener("childadded",()=>{M(this,Yi).call(this),M(this,mr).call(this)}),M(this,$e).entityScene.addEventListener("childremoved",()=>{M(this,Yi).call(this),M(this,mr).call(this)}),M(this,$e).entity3DMap.set(M(this,$e).entityScene.userData.entityId,M(this,$e).entityScene),t.center&&(M(this,$e).center=t.center?[...t.center]:[0,0]),this.options=t,this.container=e,Ot(this,CM,ite).call(this),Ot(this,EM,rte).call(this),M(this,Be).htmlControlsSystem=new A_e(this.container),M(this,Zc)!=="outdoors-overlay"&&M(this,Be).htmlControlsSystem.addAttributionControl(this.options.attribution),window.MappedinDebug||(window.MappedinDebug={}),hr.env.NODE_ENV==="test"&&(window.MappedinDebug.mapViewCoreInstance=this),ke(this,ro,new Kve({antialias:typeof t.antialias=="boolean"?t.antialias:!0,alpha:!1,canvas:this.mode!=="standalone"?(r=t.gl)==null?void 0:r.canvas:void 0,onWebGLContextCreationError:t.onWebGLContextCreationError,onWebGLContextLost:()=>{typeof t.onWebGLContextLost=="function"&&t.onWebGLContextLost()},onWebGLContextRestored:()=>{t.onWebGLContextRestored&&t.onWebGLContextRestored(),M(this,mr).call(this),M(this,Yi).call(this),this.render()},onWebGLRendererError:t.onWebGLRendererError,backgroundColor:t.backgroundColor||"#ffffff",backgroundAlpha:(n=t.backgroundAlpha)!=null?n:1})),ke(this,ea,new lq),M(this,ea).add(M(this,$e).entityScene);let m=window.__THREE_DEVTOOLS__;hr.env.NODE_ENV==="dev"&&typeof m<"u"&&(m.dispatchEvent(new CustomEvent("observe",{detail:M(this,ea)})),m.dispatchEvent(new CustomEvent("observe",{detail:M(this,ro)}))),ke(this,Mr,new On(N_e,this.aspect,50,1e5)),ke(this,u0,new ME),M(this,Mr).renderOrder=999;let g=new rr;g.add(M(this,Mr)),ke(this,If,new rr),M(this,If).add(g),M(this,ea).add(M(this,If)),M(this,Mr).updateProjectionMatrix(),M(this,Mr).updateMatrixWorld(!0),this.referenceMap={scale:1,latitude:0,longitude:0,getNorth:()=>0,georeference:[{target:{x:0,y:0}},{target:{x:0,y:0}},{target:{x:0,y:0}},{target:{x:0,y:0}}]},this.rendererDomElement=M(this,ro).domElement(),ke(this,Af,new Oe);let b=new rg(1e6,1e6),x=new rd({color:0,visible:!1});ke(this,vu,new Wi(b,x)),M(this,ea).add(M(this,vu)),(a=t.gl)!=null&&a.canvas||e.appendChild(this.rendererDomElement),window.addEventListener("resize",M(this,Lf),!1),M(this,c0).addEventListener("change",M(this,d0)),typeof ResizeObserver=="function"&&((o=hr.env)==null?void 0:o.NODE_ENV)!=="test"&&(ke(this,Cc,new ResizeObserver(xp(()=>{M(this,Lf).call(this)},0))),(s=M(this,Cc))==null||s.observe(e)),e.classList.add("mappedin-map"),this.rendererDomElement.style.width=(l=globalThis.MappedinDebug)!=null&&l.TEST_IOS?"1080px":"100%",this.rendererDomElement.style.height=(u=globalThis.MappedinDebug)!=null&&u.TEST_IOS?"1920px":"100%",hr.env.NODE_ENV==="test"&&this.rendererDomElement.setAttribute("data-testid","mappedin-canvas"),M(this,$e).canvasWidth=this.rendererDomElement.clientWidth,M(this,$e).canvasHeight=this.rendererDomElement.clientHeight,this.rendererDomElement.style.touchAction="manipulation";let v=this.canvasWidth,w=this.canvasHeight;M(this,Be).watermarkSystem=new M_e(M(this,Mr),v,w,M(this,$e),t==null?void 0:t.watermark),M(this,Be).watermarkSystem.on("texture-loaded",this.render),M(this,$e).shouldMeasureCanvas=!0,M(this,$e).pixelRatio=this.resolutionScale,M(this,g0).call(this,Math.floor(v*this.resolutionScale),Math.floor(w*this.resolutionScale));let _=new gY(16777215,.3*Math.PI);_.position.set(-150,-150,350),M(this,ea).add(_);let C=new Uye(16777215,.741*Math.PI);M(this,ea).add(C),M(this,Be).cameraSystem=new o_e(M(this,Mr),M(this,ea),M(this,ro).renderer,M(this,$e),{mode:this.mode,canvasHeight:w,canvasWidth:v}),M(this,Be).cameraSystem.on("user-dolly-start",M(this,Dn)),M(this,Be).cameraSystem.on("user-pan-start",M(this,Dn)),M(this,Be).cameraSystem.on("user-rotate-start",M(this,Dn)),M(this,Be).cameraSystem.on("user-zoom-start",M(this,Dn)),M(this,Be).cameraSystem.on("user-tilt-start",M(this,Dn)),M(this,Be).cameraSystem.on("user-pedestal-start",M(this,Dn)),M(this,Be).cameraSystem.on("user-dolly-end",M(this,kn)),M(this,Be).cameraSystem.on("user-pan-end",M(this,kn)),M(this,Be).cameraSystem.on("user-rotate-end",M(this,kn)),M(this,Be).cameraSystem.on("user-zoom-end",M(this,kn)),M(this,Be).cameraSystem.on("user-tilt-end",M(this,kn)),M(this,Be).cameraSystem.on("user-pedestal-end",M(this,kn)),M(this,Be).cameraSystem.on("change",()=>{this.publish("camera-change",this.camera),M(this,Be).geometryInFocusSystem&&(M(this,Be).geometryInFocusSystem.cameraDirty=!0),this.render()}),M(this,Be).panBoundsSystem=new C_e(M(this,$e),M(this,Be).cameraSystem),M(this,Be).pathSystem=new z_e(M(this,$e),this.convertTo3DMapPosition),M(this,Be).pathSystem.on("animate:path",this.render),this.camera=new m_e(this,M(this,Be),M(this,$e),M(this,vu)),this.camera.setZoomLevel((c=t.zoomLevel)!=null?c:Qee),this.camera.setBearing((p=t.bearing)!=null?p:tte),this.camera.setPitch((d=t.pitch)!=null?d:ete),this.camera.setMaxZoomLevel(O_e),this.camera.setMinZoomLevel(B_e),M(this,Be).domVisiblitySystem=new Vxe(M(this,$e),M(this,_s)),M(this,Be).domMutationSystem=new h_e(M(this,$e),M(this,_s)),M(this,Be).domMutationSystem.on("dimensions-update",()=>{M(this,Be).collisionSystem.dirty=!0,this.render()}),M(this,Be).domDrawSystem=new l_e(M(this,$e)),M(this,Be).collisionSystem=new lxe(M(this,Ro),M(this,$e)),M(this,Be).twoDDrawSystem=new Yxe(M(this,$e),M(this,sr)),M(this,Be).interactionSystem=new cxe(this.rendererDomElement,M(this,$e),M(this,Mr),M(this,vu)),M(this,Be).interactionSystem.on("hover",this.render),M(this,Be).interactionSystem.on("click",E=>{var T,L,D,B,A;if(((T=E.entity2D)==null?void 0:T.id)==="watermark"&&typeof M(this,Be).watermarkSystem.options.onClick=="function"){M(this,Be).watermarkSystem.options.onClick();return}this.publish("click",{coordinate:this.convert3DMapPositionToCoordinate(E.position),geometry:E.entity3D?[(L=E.entity3D)==null?void 0:L.id]:[],markers:((D=E.entity2D)==null?void 0:D.components[0])instanceof bp?[E.entity2D.id]:[],models:((B=E.entity3D)==null?void 0:B.components[0])instanceof r0?[E.entity3D.id]:[],labels:((A=E.entity2D)==null?void 0:A.components[0])instanceof _p?[E.entity2D.id]:[],containers:Array.isArray(E.groupContainers)?E.groupContainers.map(k=>k.userData.entityId):[],pointerEvent:E.pointerEvent})}),M(this,Be).interactionSystem.on("hover",E=>{var T,L,D,B,A;E.position&&((T=E.entity2D)==null?void 0:T.id)!=="watermark"&&this.publish("hover",{coordinate:this.convert3DMapPositionToCoordinate(E.position),geometry:E.entity3D?[(L=E.entity3D)==null?void 0:L.id]:[],markers:((D=E.entity2D)==null?void 0:D.components[0])instanceof bp?[E.entity2D.id]:[],models:((B=E.entity3D)==null?void 0:B.components[0])instanceof r0?[E.entity3D.id]:[],labels:((A=E.entity2D)==null?void 0:A.components[0])instanceof _p?[E.entity2D.id]:[],containers:Array.isArray(E.groupContainers)?E.groupContainers.map(k=>k.userData.entityId):[]})}),M(this,Be).geometryInFocusSystem=new D_e(M(this,$e),M(this,Mr)),M(this,Be).geometryInFocusSystem.on("geometry-in-focus",E=>{this.publish("geometry-in-focus",E)}),M(this,Be).twoDVisiblitySystem=new Qxe(M(this,$e)),M(this,Be).drawSystem=new Kxe(M(this,$e)),M(this,Be).drawSystem.on("texture-loaded",this.render),M(this,Be).stackSystem=new i_e(M(this,$e)),M(this,Be).twoDProjectionSystem=new jxe(M(this,$e),M(this,m0)),M(this,Be).zoomInterpolationSystem=new Mxe,M(this,Be).exporterSystem=new Cxe(M(this,$e)),M(this,Be).meshOptimizationSystem=new Uxe(M(this,$e),this.convertTo3DMapPosition),M(this,Be).meshOptimizationSystem.on("model-loaded",this.render),M(this,Be).customGeometrySystem=new I_e(M(this,$e)),M(this,Be).outlineInterpolationSystem=new L_e(M(this,$e)),M(this,Be).renderSystem=new e_e(M(this,ro),M(this,$e),this.mode,M(this,ea),M(this,Mr),this.viewCamera,M(this,Be)),M(this,Be).renderSystem.on("measure-canvas",M(this,Df)),M(this,Be).outdoorLayersSystem=new k_e(this.map),M(this,PM).call(this)}get viewCamera(){return M(this,u0)}get canvasWidth(){return M(this,$e).canvasWidth}get canvasHeight(){return M(this,$e).canvasHeight}get resolutionScale(){var e,t;return(t=(e=this.map)==null?void 0:e.getPixelRatio())!=null?t:Wc()}get aspect(){return this.canvasWidth/this.canvasHeight}get mode(){return M(this,Zc)}addGroupContainer(e,t,r){var n;if(!M(this,$e).entity3DMap.has(e)&&!M(this,$e).entity2DMap.has(e)){let a=new ca(e);a.addEventListener("childadded",()=>{M(this,Yi).call(this),M(this,mr).call(this)}),a.addEventListener("childremoved",()=>{M(this,Yi).call(this),M(this,mr).call(this)}),(t==null?void 0:t.visible)!==void 0&&(a.visible=t.visible),(t==null?void 0:t.altitude)!==void 0&&a.setAltitude(t.altitude),(t==null?void 0:t.interactive)!==void 0&&Ma(a,t.interactive,M(this,$e)),M(this,$e).entity3DMap.set(e,a),(n=Ot(this,Sa,no).call(this,r))==null||n.addEntity(a),M(this,Yi).call(this),this.render()}else Ft.error(`Group container with ID '${e}' already exists. The group container cannot be added.`);return{id:e,type:"group-container"}}addStackContainer(e,t,r){var n;if(M(this,$e).entity3DMap.has(e))Ft.error(`Stack container with ID '${e}' already exists. The stack container cannot be added.`);else{let a=new ca(e);a.addEventListener("childadded",()=>{M(this,Yi).call(this),M(this,mr).call(this)}),a.addEventListener("childremoved",()=>{M(this,Yi).call(this),M(this,mr).call(this)}),a.components[0]=new u_e,(t==null?void 0:t.visible)!==void 0&&(a.visible=t.visible),M(this,$e).entity3DMap.set(e,a),(n=Ot(this,Sa,no).call(this,r))==null||n.addEntity(a)}return{id:e,type:"stack-container"}}addCustomGeometry(e,t,r,n,a){var o;if(M(this,$e).entity3DMap.has(e))Ft.error(`Custom geometry with ID '${e}' already exists. The custom geometry cannot be added.`);else{let s=new X2(t,r),l=new Vn(s,new zv(n));l.id=e,s.mesh.userData={entityId:e,type:"custom-geometry"},M(this,$e).entity3DMap.set(l.id,l),(o=Ot(this,Sa,no).call(this,a))==null||o.addEntity(l),this.render()}return{id:e,type:"custom-geometry"}}addGeometryGroup(e,t,r,n){var a,o;if(!M(this,$e).entity3DMap.has(e)&&!M(this,$e).entity2DMap.has(e)){let s=new ks(e,new qS(r));s.addEventListener("childadded",()=>{M(this,Yi).call(this),M(this,mr).call(this)}),s.addEventListener("childremoved",()=>{M(this,Yi).call(this),M(this,mr).call(this)}),s.userData.dirty=!0,M(this,$e).entity3DMap.set(e,s);for(let l of t.features){if(!["Polygon","MultiPolygon","LineString","MultiLineString"].includes(l.geometry.type))continue;let u=l.id||l.properties.id||Cr(),c=M(this,Be).meshOptimizationSystem.createEntityFromFeature(u,l,r);M(this,$e).entity3DMap.set(u,c),s.userData.entities3D.add(u)}s.setVisible((a=r==null?void 0:r.visible)!=null?a:!0),(o=Ot(this,Sa,no).call(this,n))==null||o.addEntity(s),M(this,Yi).call(this),this.render()}else Ft.error(`Geometry group with ID '${e}' already exists. The geometry group cannot be added.`);return M(this,Be).outlineInterpolationSystem.dirty=!0,{id:e,type:"geometry-group"}}addModelGroup(e,t,r,n){var a;if(!M(this,$e).entity3DMap.has(e)&&!M(this,$e).entity2DMap.has(e)){let o=new ks(e,new qS(r));o.addEventListener("childadded",()=>{M(this,Yi).call(this),M(this,mr).call(this)}),o.addEventListener("childremoved",()=>{M(this,Yi).call(this),M(this,mr).call(this)}),M(this,$e).entity3DMap.set(e,o),o.userData.dirty=!0,o.userData.modelURL=r.url;for(let s of t.features){let l=s.id||s.properties.id||Cr(),u=M(this,Be).meshOptimizationSystem.createModelFromFeature(l,s,r);s.properties.interactive!==void 0&&Ma(u,s.properties.interactive,M(this,$e)),M(this,$e).entity3DMap.set(l,u),o.userData.entities3D.add(l)}(a=Ot(this,Sa,no).call(this,n))==null||a.addEntity(o),M(this,Yi).call(this),this.render()}else Ft.error(`Model group with ID '${e}' already exists. The model group cannot be added.`);return{id:e,type:"geometry-group"}}addMarker2D(e,t,r,n){var a;let o=r==null?void 0:r.id;if(o===void 0||!M(this,$e).entity2DMap.has(o)&&!M(this,$e).entity3DMap.has(o)){let s=Ot(this,y0,AM).call(this,e,new bp(t,r));s.id=o||String(s.id),o=s.id,(r==null?void 0:r.interactive)!=null&&Ma(s,r==null?void 0:r.interactive,M(this,$e)),(a=Ot(this,Sa,no).call(this,n))==null||a.addEntity(s),this.render()}else Ft.error(`Marker2D with ID '${o}' already exists. The marker cannot be added.`);return{id:o,type:"marker"}}addLabel2D(e,t,r,n){var a;let o=r==null?void 0:r.id;if(o===void 0||!M(this,$e).entity2DMap.has(o)&&!M(this,$e).entity3DMap.has(o)){let s=Ot(this,y0,AM).call(this,e,new _p(t,r||{},M(this,$e)));s.id=o||String(s.id),o=s.id,(r==null?void 0:r.interactive)!=null&&Ma(s,r==null?void 0:r.interactive,M(this,$e)),(a=Ot(this,Sa,no).call(this,n))==null||a.addEntity(s),M(this,mr).call(this),this.render()}else Ft.error(`Label2D with ID '${o}' already exists. The label cannot be added.`);return{id:o,type:"label"}}addPath(e,t={},r){var n;let a=new t_e(e,t),o=new Vn(a,new zv);return o.id=(t==null?void 0:t.id)||Cr(),a.mesh.userData={entityId:o.id,type:"path"},M(this,$e).entity3DMap.set(o.id,o),(t==null?void 0:t.interactive)!=null&&Ma(o,t==null?void 0:t.interactive,M(this,$e)),(n=Ot(this,Sa,no).call(this,r))==null||n.addEntity(o),M(this,Yi).call(this),this.render(),{id:o.id,type:"path"}}updateWatermark(e){M(this,Be).watermarkSystem.options=e,M(this,Be).watermarkSystem.dirty=!0,this.render()}updateStackState(e,t){let r;(typeof e=="string"||typeof e=="number")&&(r=M(this,$e).entity3DMap.get(e)),r!=null&&r.components[0]&&(typeof t.activeId<"u"&&(r.components[0].activeId=t.activeId),typeof t.expandedFactor<"u"&&(r.components[0].percentExpanded=t.expandedFactor),r.components[0].dirty=!0,this.render())}remove(e){var t;let r;if(typeof e=="string"||typeof e=="number"?(r=M(this,$e).entity2DMap.get(e),r==null&&(r=M(this,$e).entity3DMap.get(e))):typeof e.id=="string"||typeof e.id=="number"?(r=M(this,$e).entity2DMap.get(e.id),r==null&&(r=M(this,$e).entity3DMap.get(e.id))):r=e,r!=null){if(r.type==="custom-geometry")M(this,$e).entity3DMap.delete(r.id),r.object3d&&oo(r.object3d);else if(r.type==="group-container"){M(this,$e).entity3DMap.delete(r.userData.entityId);for(let n of r.childrenIds.values())this.remove(n),r.userData.entities2D.delete(n);oo(r)}else if(r.type==="geometry-group"){M(this,$e).entity3DMap.delete(r.userData.entityId);for(let n of r.userData.entities3D.values())this.remove(n),r.userData.entities3D.delete(n);oo(r)}else if(r.type==="geometry"||r.type==="model"||r.type==="path"){let n=r.components[0];r.object3d&&(((t=r.parent)==null?void 0:t.type)==="geometry-group"&&r.parent.userData.entities3D.delete(r.id),oo(r.object3d)),n.outline&&oo(n.outline),"focusMesh"in n&&n.focusMesh!=null&&oo(n.focusMesh),M(this,$e).entity3DMap.delete(r.id)}else(r.type==="marker"||r.type==="label")&&(r.object3d&&oo(r.object3d),r.type==="label"&&delete M(this,Be).twoDDrawSystem.textCache[r.id],M(this,$e).entity2DMap.delete(r.id));M(this,Yi).call(this),M(this,mr).call(this),this.render()}}getScene(){return this.getState("__scene")}getCurrentSceneGLTF(e){return M(this,Be).exporterSystem.getCurrentSceneGLTF(e)}getBoundingArea(e){this.renderSync();let t=new Yr;if(e==null)t.setFromObject(M(this,$e).entityScene);else{let r=bf(M(this,$e),e);if((r==null?void 0:r.type)==="geometry"&&(r==null?void 0:r.object3d)!=null){let n=r.components[0],a=n instanceof Ho?n.geometry:void 0;n.mesh instanceof EE&&a?(a.computeBoundingBox(),a.boundingBox&&t.union(a.boundingBox)):t.setFromObject(r.object3d)}else((r==null?void 0:r.type)==="geometry-group"||(r==null?void 0:r.type)==="group-container")&&(r==null?void 0:r.userData.entityId)!=null&&t.setFromObject(r)}if(lQ(t))return eQ(t).map(this.convert3DMapPositionToCoordinate)}getState(e){var t;if(e==null)return{type:"map-view",hoverColor:M(this,$e).hoverColor};let r=bf(M(this,$e),e);if((r==null?void 0:r.type)==="custom-geometry"){let n=r.components[0],a=r.components[1];return{id:r.id,type:"custom-geometry",visible:a.visible,altitude:a.altitude,parent:(t=r.parent)==null?void 0:t.userData.entityId,position:this.convert3DMapPositionToCoordinate(n.position)}}else if((r==null?void 0:r.type)==="geometry-group"){let n=[];for(let o of r.userData.entities3D.values()){let s=this.getState(o);((s==null?void 0:s.type)==="geometry"||(s==null?void 0:s.type)==="model")&&n.push(s)}let a=r.components[0];return{id:r.userData.entityId,type:"geometry-group",visible:r.visible,opacity:a.opacity,color:a.color,topColor:a.topColor,outline:a.outline,shading:a.shading,interactive:Array.from(r.userData.entities3D.values()).map(o=>M(this,$e).entity3DMap.get(o)).every(o=>o&&o.components[2]!=null),children:Array.from(r.userData.entities3D.values()).map(o=>this.getState(o)).filter(Boolean)}}else{if((r==null?void 0:r.type)==="group-container")return{id:r.userData.entityId,type:"group-container",visible:r.visible,altitude:r.altitude,interactive:!!r.components[1],children:Array.from(r.childrenIds.values()).map(n=>this.getState(n)).filter(Boolean)};if((r==null?void 0:r.type)==="label"){let n=r.components[0],a=r.object3d.parent,o=a==null?void 0:a.userData.entityId;return{id:r.id,type:"label",text:n.text||"",parent:{id:o,type:a==null?void 0:a.type},position:this.convert3DMapPositionToCoordinate(r.position),enabled:n.enabled,initialRank:Mf(n.initialRank),options:{rank:Mf(n.rank),appearance:n.appearance,interactive:r.components[1]!=null}}}else if((r==null?void 0:r.type)==="marker"){let n=r.components[0],a=r.object3d.parent,o=a==null?void 0:a.userData.entityId;return{id:r.id,type:"marker",enabled:n.enabled,parent:{id:o,type:a==null?void 0:a.type},position:this.convert3DMapPositionToCoordinate(r.position),element:n.containerEl,initialRank:Mf(n.initialRank),options:{rank:Mf(n.rank),interactive:r.components[1]!=null||!1}}}else if((r==null?void 0:r.type)==="geometry"){let{color:n,hoverColor:a,initialColor:o,topColor:s}=r.components[1],l=r.components[0],u=r.components[1];return{id:r.id,type:"geometry",color:n,focusable:l.focusable,topColor:s,initialColor:o,hoverColor:a,visible:u.visible,outline:u.outline,position:this.convert3DMapPositionToCoordinate(l.position),interactive:r.components[2]!=null}}else if((r==null?void 0:r.type)==="model"){let n=r.components[0],a=r.components[2];return{id:r.id,type:"model",position:this.convert3DMapPositionToCoordinate(n.position),interactive:a!=null}}else if((r==null?void 0:r.type)==="path"){let n=r.components[0],a=r.components[2],o=r.components[1];return{id:r.id,type:"path",position:this.convert3DMapPositionToCoordinate(n.position),visible:o.visible,interactive:a!=null,completeFraction:n.completeFraction}}else return}}setState(e,t){var r,n,a;if(typeof e=="object"&&"hoverColor"in e&&t==null){M(this,$e).hoverColor=(r=e.hoverColor)!=null?r:M(this,$e).hoverColor;return}let o=bf(M(this,$e),e);if(o!=null){if(o.type==="custom-geometry"){let s=M(this,$e).entity3DMap.get(o.id);if(s instanceof Vn&&s.components[0]instanceof X2){let l=t;bc(o,l.visible),hM(o,l.altitude),lM(o,l.position,this.convertTo3DMapPosition),uM(o,Ot(this,Sa,no).call(this,l.parent,!1))}}else if(o.type==="model"||o.type==="path"){let s=t;Ma(o,s.interactive,M(this,$e))&&M(this,Yi).call(this),o.type==="path"&&(s=s,tee(o,s),bc(o,s.visible))}else if(o.type==="group-container"){let s=t;bc(o,s.visible)&&(M(this,Be).outlineInterpolationSystem.dirty=!0),Ma(o,s.interactive,M(this,$e))&&M(this,Yi).call(this),hM(o,s.altitude)}else if(o.type==="geometry-group"){let s=t;bc(o,s.visible)&&(M(this,Be).outlineInterpolationSystem.dirty=!0),JQ(o,M(this,$e),s)&&(M(this,Be).outlineInterpolationSystem.dirty=!0),cM(o,s.outline)&&(M(this,Be).outlineInterpolationSystem.geometries3DDirty=!0),KQ(o,s.shading),oee(o,M(this,$e),s.opacity),Ma(o,s.interactive,M(this,$e))&&(M(this,Yi).call(this),M(this,mr).call(this))}else if(o.type==="geometry"){if(o.components[0]instanceof Ho){let s=t;bc(o,s.visible)&&(M(this,Be).outlineInterpolationSystem.geometries3DDirty=!0),cM(o,s.outline)&&(M(this,Be).outlineInterpolationSystem.geometries3DDirty=!0),s.focusable!=null&&(o.components[0].focusable=s.focusable,M(this,Be).geometryInFocusSystem.focusablesDirty=!0),QQ(o,s),aee(o,s.hoverColor),Ma(o,s.interactive,M(this,$e))}M(this,Yi).call(this)}else if(o.type==="label"||o.type==="marker"){let s=t;nee(o,t),iee(o,t)&&M(this,mr).call(this),ree(o,(n=s.options)==null?void 0:n.rank)&&M(this,mr).call(this),lM(o,s.position,this.convertTo3DMapPosition),uM(o,Ot(this,Sa,no).call(this,s.parent,!1))&&(M(this,mr).call(this),M(this,Be).panBoundsSystem.dirty=!0),eee(o,s.enabled),Ma(o,(a=s.options)==null?void 0:a.interactive,M(this,$e))&&M(this,mr).call(this)}this.render()}}convertTo3DMapPosition(e,t,r=0,n){var a,o,s,l;if(Array.isArray(e))return this.convertTo3DMapPosition(e[1],e[0],0,typeof t=="function"?t:void 0);if(typeof t!="number")throw new Error("convertTo3DMapPosition failed: longitude must be a number");let{x:u,y:c}=KE((o=(a=M(this,$e).center)==null?void 0:a[1])!=null?o:0,(l=(s=M(this,$e).center)==null?void 0:s[0])!=null?l:0,e,t);return n?(n.set(u,c,r),n):new le(u,c,r)}getCenter(e){let t=Array.isArray(e)?e:this.getBoundingArea(e);return t?sQ(t):void 0}isInView(e){let t=bf(M(this,$e),e);if(M(this,v0).identity().multiply(M(this,Mr).projectionMatrix).multiply(M(this,Mr).matrixWorldInverse),M(this,Ec).setFromProjectionMatrix(M(this,v0)),t instanceof qp)return M(this,Ec).containsPoint(t.position);if(t instanceof Vn){let r=t==null?void 0:t.components[0];if(r instanceof X2||r instanceof r0)return M(this,Ec).containsPoint(this.convertTo3DMapPosition(r.feature.geometry.coordinates));if(r instanceof Ho){let n=new Yr(this.convertTo3DMapPosition(r.featureBbox[1],r.featureBbox[0],0),this.convertTo3DMapPosition(r.featureBbox[3],r.featureBbox[2],0));return M(this,Ec).intersectsBox(n)}}return!1}getSystems(){return M(this,Be)}getInternalState(){return M(this,$e)}};ea=new WeakMap,Mr=new WeakMap,u0=new WeakMap,Af=new WeakMap,vu=new WeakMap,Cc=new WeakMap,If=new WeakMap,h0=new WeakSet,MM=h(function(i){var e;M(this,Zc)!=="outdoors-overlay"&&((e=this.map)==null||e.setPixelRatio(i)),M(this,$e).pixelRatio=this.resolutionScale},"#setResolutionScale"),$e=new WeakMap,wi=new WeakMap,Ro=new WeakMap,sr=new WeakMap,_s=new WeakMap,ro=new WeakMap,Be=new WeakMap,c0=new WeakMap,mr=new WeakMap,Yi=new WeakMap,CM=new WeakSet,ite=h(function(){ke(this,wi,document.createElement("div")),M(this,wi).classList.add("mappedin__smart-collision-engine__container"),ke(this,Ro,document.createElement("canvas")),M(this,Ro).classList.add("mappedin__smart-collision-engine-debug__container"),this.container.appendChild(M(this,wi)),ke(this,sr,document.createElement("canvas")),M(this,sr).classList.add("mappedin__smart-collision-engine__container"),M(this,sr).width=M(this,wi).clientWidth*this.resolutionScale,M(this,sr).height=M(this,wi).clientHeight*this.resolutionScale,M(this,sr).style.width=M(this,wi).clientWidth+"px",M(this,sr).style.height=M(this,wi).clientHeight+"px",M(this,wi).appendChild(M(this,Ro)),M(this,wi).appendChild(M(this,sr)),M(this,Ro).width=M(this,wi).clientWidth,M(this,Ro).height=M(this,wi).clientHeight,M(this,sr).width=M(this,wi).clientWidth*this.resolutionScale,M(this,sr).height=M(this,wi).clientHeight*this.resolutionScale,M(this,sr).style.width=M(this,wi).clientWidth+"px",M(this,sr).style.height=M(this,wi).clientHeight+"px"},"#renderEntity2DContainer"),EM=new WeakSet,rte=h(function(){ke(this,_s,document.createElement("div")),M(this,_s).classList.add("mappedin-2d-entities"),Object.assign(M(this,_s).style,{position:"absolute",top:"0",left:"0",bottom:"0",right:"0",pointerEvents:"none","transform-style":"preserve-3d"}),this.container.appendChild(M(this,_s))},"#renderEntityDOMContainer"),TM=new WeakSet,nte=h(function(){M(this,sr).width=M(this,wi).clientWidth*this.resolutionScale,M(this,sr).height=M(this,wi).clientHeight*this.resolutionScale,M(this,sr).style.width=M(this,wi).clientWidth+"px",M(this,sr).style.height=M(this,wi).clientHeight+"px",M(this,Ro).width=M(this,wi).clientWidth,M(this,Ro).height=M(this,wi).clientHeight,M(this,sr).width=M(this,wi).clientWidth*this.resolutionScale,M(this,sr).height=M(this,wi).clientHeight*this.resolutionScale,M(this,sr).style.width=M(this,wi).clientWidth+"px",M(this,sr).style.height=M(this,wi).clientHeight+"px",M(this,Be).collisionSystem.dirty=!0},"#resizeCollisionCanvas"),Zc=new WeakMap,p0=new WeakMap,d0=new WeakMap,Lf=new WeakMap,PM=new WeakMap,f0=new WeakMap,m0=new WeakMap,g0=new WeakMap,Df=new WeakMap,Sa=new WeakSet,no=h(function(i,e=!0){if(!i)return e?M(this,$e).entityScene:void 0;if(typeof i=="string"||typeof i=="number"){let t=M(this,$e).entity3DMap.get(i);return t instanceof ca?t:(Ft.warn("Parent is not a valid container, adding to scene"),e?M(this,$e).entityScene:void 0)}else if(i.type==="group-container"){let t=M(this,$e).entity3DMap.get(i.id);if(t instanceof ca)return t}return e?M(this,$e).entityScene:void 0},"#getParentContainer"),y0=new WeakSet,AM=h(function(i,e,t){let r=new qp(e,this.convertTo3DMapPosition(i[1],i[0],i[2]||t||0));return M(this,$e).entity2DMap.set(r.id,r),r},"#createEntity2D"),Ec=new WeakMap,v0=new WeakMap,Dn=new WeakMap,kn=new WeakMap,h(ate,"Core");var $_e=ate,IM=$_e;R();function U_e(i,e){ote(i,e)(i.getScene(),e),ste(i,e),e.addFolder("Export").add({export:async()=>{let t=await i.getCurrentSceneGLTF({binary:!0}),r=new Blob([t],{type:"application/octet-stream"});var n=document.createElement("a");document.body.appendChild(n),n.style.display="none";let a=window.URL.createObjectURL(r);n.href=a,n.download="scene.glb",n.click(),window.URL.revokeObjectURL(a)}},"export")}h(U_e,"mountSceneGraphVisualizer");function ote(i,e){let t=e;return h(function r(n,a){let o=a.addFolder(`${[n.type]} ${n.id.slice(0,16)}`);if(a.close(),n.type==="geometry"||n.type==="model"||n.type==="path"){let s={set visible(l){let u=i.getState(n.id);((u==null?void 0:u.type)==="geometry"||(u==null?void 0:u.type)==="path")&&i.setState(n,{visible:l})},get visible(){let l=i.getState(n.id);return(l==null?void 0:l.type)==="geometry"||(l==null?void 0:l.type)==="path"?l.visible:!1},set outline(l){let u=i.getState(n.id);(u==null?void 0:u.type)==="geometry"&&i.setState(n,{outline:l})},get outline(){let l=i.getState(n.id);return(l==null?void 0:l.type)==="geometry"?l.outline:!1},get color(){let l=i.getState(n.id);return(l==null?void 0:l.type)==="geometry"&&l.color?vt(l.color).toHexString():"#ffffff"},set color(l){let u=i.getState(n.id);(u==null?void 0:u.type)==="geometry"&&i.setState(u,{color:l})},set interactive(l){let u=i.getState(n.id);((u==null?void 0:u.type)==="geometry"||(u==null?void 0:u.type)==="model"||(u==null?void 0:u.type)==="path")&&(i.setState(n,{interactive:l}),t.controllersRecursive().forEach(c=>c.updateDisplay()))},get interactive(){let l=i.getState(n.id);return(l==null?void 0:l.type)==="geometry"||(l==null?void 0:l.type)==="model"||(l==null?void 0:l.type)==="path"?l.interactive:!1},get completeFraction(){let l=i.getState(n.id);return(l==null?void 0:l.type)==="path"?l.completeFraction:1},set completeFraction(l){let u=i.getState(n.id);(u==null?void 0:u.type)==="path"&&i.setState(u,{completeFraction:l})},focus:()=>{}};o.add(s,"focus").onChange(()=>{let l=i.getState(n.id);(l==null?void 0:l.type)==="model"||(l==null?void 0:l.type)==="path"?i.camera.focusOn([l.position]):(l==null?void 0:l.type)==="geometry"&&i.camera.focusOn(i.getBoundingArea(l))}),o.add(s,"interactive"),n.type==="path"&&o.add(s,"completeFraction",0,1,.1),o.add(s,"visible"),n.type!=="model"&&(o.addColor(s,"color"),o.add(s,"outline"))}else if(n.type==="marker"){let s={get interactive(){var l;let u=i.getState(n.id);return(u==null?void 0:u.type)==="marker"?(l=u.options)==null?void 0:l.interactive:!1},set interactive(l){let u=i.getState(n.id);(u==null?void 0:u.type)==="marker"&&(i.setState(u,{options:{interactive:l}}),t.controllersRecursive().forEach(c=>c.updateDisplay()))},focus:()=>{}};o.add(s,"focus").onChange(()=>{let l=i.getState(n.id);(l==null?void 0:l.type)==="marker"&&i.camera.focusOn([l.position])}),o.add(s,"interactive")}else if(n.type==="label"){let s={get interactive(){var l;let u=i.getState(n.id);return(u==null?void 0:u.type)==="label"?(l=u.options)==null?void 0:l.interactive:!1},set interactive(l){let u=i.getState(n.id);(u==null?void 0:u.type)==="label"&&(i.setState(u,{options:{interactive:l}}),t.controllersRecursive().forEach(c=>c.updateDisplay()))},get text(){let l=i.getState(n.id);return(l==null?void 0:l.type)==="label"?l.text:""},set text(l){let u=i.getState(n.id);(u==null?void 0:u.type)==="label"&&i.setState(u,{text:l})},get"Text Color"(){var l,u;let c=i.getState(n.id);return(c==null?void 0:c.type)==="label"?(u=(l=c.options.appearance)==null?void 0:l.text)==null?void 0:u.foregroundColor:"#000000"},set"Text Color"(l){let u=i.getState(n.id);(u==null?void 0:u.type)==="label"&&i.setState(n.id,{text:s.text,options:{appearance:{text:{foregroundColor:l}}}})},get"Text Size"(){var l,u;let c=i.getState(n.id);return(c==null?void 0:c.type)==="label"?(u=(l=c.options.appearance)==null?void 0:l.text)==null?void 0:u.size:10},set"Text Size"(l){let u=i.getState(n.id);(u==null?void 0:u.type)==="label"&&i.setState(u,{text:s.text,options:{appearance:{text:{size:l}}}})},get"Icon Size"(){var l,u;let c=i.getState(n.id);return(c==null?void 0:c.type)==="label"?(u=(l=c.options.appearance)==null?void 0:l.marker)==null?void 0:u.iconSize:10},set"Icon Size"(l){let u=i.getState(n.id);(u==null?void 0:u.type)==="label"&&i.setState(u,{text:s.text,options:{appearance:{marker:{iconSize:l}}}})},get"Active Foreground Color"(){var l,u,c;let p=i.getState(n.id);return(p==null?void 0:p.type)==="label"?(c=(u=(l=p.options.appearance)==null?void 0:l.marker)==null?void 0:u.foregroundColor)==null?void 0:c.active:"#000000"},set"Active Foreground Color"(l){var u,c;let p=i.getState(n.id);(p==null?void 0:p.type)==="label"&&i.setState(p,{text:s.text,options:{appearance:{marker:{foregroundColor:{...(c=(u=p.options.appearance)==null?void 0:u.marker)==null?void 0:c.foregroundColor,active:l}}}}})},get"Inactive Foreground Color"(){var l,u,c;let p=i.getState(n.id);return(p==null?void 0:p.type)==="label"?(c=(u=(l=p.options.appearance)==null?void 0:l.marker)==null?void 0:u.foregroundColor)==null?void 0:c.inactive:"#000000"},set"Inactive Foreground Color"(l){var u,c;let p=i.getState(n.id);(p==null?void 0:p.type)==="label"&&i.setState(p,{text:s.text,options:{appearance:{marker:{foregroundColor:{...(c=(u=p.options.appearance)==null?void 0:u.marker)==null?void 0:c.foregroundColor,inactive:l}}}}})},get"Active Background Color"(){var l,u,c;let p=i.getState(n.id);return(p==null?void 0:p.type)==="label"?(c=(u=(l=p.options.appearance)==null?void 0:l.marker)==null?void 0:u.backgroundColor)==null?void 0:c.active:"#000000"},set"Active Background Color"(l){var u,c;let p=i.getState(n.id);(p==null?void 0:p.type)==="label"&&i.setState(p,{text:s.text,options:{appearance:{marker:{backgroundColor:{...(c=(u=p.options.appearance)==null?void 0:u.marker)==null?void 0:c.backgroundColor,active:l}}}}})},get"Inactive Background Color"(){var l,u,c;let p=i.getState(n.id);return(p==null?void 0:p.type)==="label"?(c=(u=(l=p.options.appearance)==null?void 0:l.marker)==null?void 0:u.backgroundColor)==null?void 0:c.inactive:"#000000"},set"Inactive Background Color"(l){var u,c;let p=i.getState(n.id);(p==null?void 0:p.type)==="label"&&i.setState(p,{text:s.text,options:{appearance:{marker:{backgroundColor:{...(c=(u=p.options.appearance)==null?void 0:u.marker)==null?void 0:c.backgroundColor,inactive:l}}}}})},focus:()=>{}};o.add(s,"focus").onChange(()=>{let l=i.getState(n.id);(l==null?void 0:l.type)==="label"&&i.camera.focusOn([l.position])}),o.add(s,"interactive"),o.add(s,"text"),o.add(s,"Text Size",10,50),o.add(s,"Icon Size",10,50),o.addColor(s,"Text Color"),o.addColor(s,"Active Background Color"),o.addColor(s,"Inactive Background Color"),o.addColor(s,"Active Foreground Color"),o.addColor(s,"Inactive Foreground Color")}else if(n.type==="geometry-group"){let s={get opacity(){let l=i.getState(n.id);return(l==null?void 0:l.type)==="geometry-group"?l.opacity:1},set opacity(l){let u=i.getState(n.id);(u==null?void 0:u.type)==="geometry-group"&&i.setState(n,{opacity:l})},set visible(l){let u=i.getState(n.id);(u==null?void 0:u.type)==="geometry-group"&&i.setState(n,{visible:l})},get visible(){let l=i.getState(n.id);return(l==null?void 0:l.type)==="geometry-group"?l.visible:!1},set outline(l){let u=i.getState(n.id);(u==null?void 0:u.type)==="geometry-group"&&i.setState(n,{outline:l})},get outline(){let l=i.getState(n.id);return(l==null?void 0:l.type)==="geometry-group"?l.outline:!1},set interactive(l){let u=i.getState(n.id);(u==null?void 0:u.type)==="geometry-group"&&(i.setState(n,{interactive:l}),t.controllersRecursive().forEach(c=>c.updateDisplay()))},get interactive(){let l=i.getState(n.id);return(l==null?void 0:l.type)==="geometry-group"?l.interactive:!1},get shadingStart(){var l,u;let c=i.getState(n.id);return(c==null?void 0:c.type)==="geometry-group"&&(u=(l=c.shading)==null?void 0:l.start)!=null?u:0},set shadingStart(l){let u=i.getState(n.id);(u==null?void 0:u.type)==="geometry-group"&&i.setState(u,{shading:{start:l}})},get shadingEnd(){var l,u;let c=i.getState(n.id);return(c==null?void 0:c.type)==="geometry-group"&&(u=(l=c.shading)==null?void 0:l.end)!=null?u:0},set shadingEnd(l){let u=i.getState(n.id);(u==null?void 0:u.type)==="geometry-group"&&i.setState(u,{shading:{end:l}})},get shadingIntensity(){var l,u;let c=i.getState(n.id);return(c==null?void 0:c.type)==="geometry-group"&&(u=(l=c.shading)==null?void 0:l.intensity)!=null?u:0},set shadingIntensity(l){let u=i.getState(n.id);(u==null?void 0:u.type)==="geometry-group"&&i.setState(u,{shading:{intensity:l}})}};o.add(s,"visible"),o.add(s,"opacity",0,1,.1),o.add(s,"interactive"),o.add(s,"outline"),o.add(s,"shadingStart",0,1,.1),o.add(s,"shadingEnd",0,1,.1),o.add(s,"shadingIntensity",0,1,.1)}else if(n.type==="group-container"){let s={set visible(l){let u=i.getState(n.id);(u==null?void 0:u.type)==="group-container"&&i.setState(n,{visible:l})},get visible(){let l=i.getState(n.id);return(l==null?void 0:l.type)==="group-container"?l.visible:!1},set interactive(l){let u=i.getState(n.id);(u==null?void 0:u.type)==="group-container"&&(i.setState(u,{interactive:l}),t.controllersRecursive().forEach(c=>c.updateDisplay()))},get interactive(){let l=i.getState(n.id);return(l==null?void 0:l.type)==="group-container"?l.interactive:!1}};o.add(s,"visible"),o.add(s,"interactive")}if(o.close(),n.children)for(let s of n.children.values())r(s,o)},"parseChild")}h(ote,"createParseChild");function ste(i,e){let t=e.addFolder("Watermark"),r={padding:16,iconOnly:!1,position:"bottom-left",color:"dark",scale:1};t.add(r,"padding",0,100,1),t.add(r,"scale",.5,1.5,.1),t.add(r,"color",["dark","light"]),t.add(r,"position",["top-left","top-right","bottom-left","bottom-right","center","top","bottom","left","right"]),t.add(r,"iconOnly"),t.onChange(()=>{i.updateWatermark(r)})}h(ste,"createWatermarkChild");var DI="https://tiles-cdn.mappedin.com/styles/mappedin/style.json",V_e="https://auth.mappedin.com/oauth2/token";async function lte(i,e){var t,r,n,a,o;if((t=e==null?void 0:e.outdoorView)!=null&&t.enabled&&(r=e==null?void 0:e.outdoorView)!=null&&r.headers){let{Map:s,MercatorCoordinate:l}=await zm(()=>import("./outdoor-context-v4-DXPG5QBY-Bza5c0e5.js"),[]),u=e.outdoorView.headers;u==null&&(u=await aQ(V_e));let c=e.center||[0,0],p=new s({container:i,style:e.outdoorView.style||DI,center:c,attributionControl:!1,zoom:(n=e.zoomLevel)!=null?n:Qee,pitch:(a=e.pitch)!=null?a:ete,bearing:(o=e.bearing)!=null?o:tte,transformRequest:C=>{var E;return{url:C,headers:(E=e.outdoorView)==null?void 0:E.headers}},trackResize:!1,pixelRatio:Wc(),antialias:typeof e.antialias=="boolean"?e.antialias:!0,boxZoom:!1,doubleClickZoom:!1,scrollZoom:!1,dragPan:!1,dragRotate:!1,keyboard:!1,touchZoomRotate:!1}),d=p.painter.context.gl,m=new IM(i,{center:c,zoomLevel:p.getZoom(),pitch:p.getPitch(),bearing:p.getBearing(),gl:d,map:p,mode:"outdoors-interleaved",watermark:e.watermark,attribution:e.attribution,antialias:e.antialias}),g={center:p.getCenter().toArray(),zoom:p.getZoom(),bearing:p.getBearing(),pitch:p.getPitch()};p.setMinZoom(m.camera.minZoomLevel),p.setMaxZoom(m.camera.maxZoomLevel),m.on("camera-change",C=>{g.center=C.center,g.zoom=C.zoomLevel,g.bearing=-C.bearing,g.pitch=C.pitch,p.jumpTo(g)});let b=l.fromLngLat(c,0),x=eT(b,m.viewCamera,m.camera,()=>{m.renderSync()});p.on("style.load",async()=>{p&&(p.addLayer(x),m.renderSync())});let v=!1,w=!1;p.on("idle",()=>{p&&(v||(m.publish("outdoor-view-loaded"),v=!0),w||(m.publish("outdoor-style-loaded"),w=!0))});let _=h(C=>{C&&(C.sourceDataType==="metadata"||C.sourceDataType==="visibility"||C.dataType==="style"||C.type==="terrain")&&m.getSystems().htmlControlsSystem.updateData(p)},"updateData");return p.on("styledata",C=>{p&&C&&C.dataType==="style"&&C.type==="styledata"&&(w=!1),_(C)}),p.on("sourcedata",_),p.on("terrain",_),p.on("error",C=>{var E;if(((E=C.error)==null?void 0:E.url)===DI){Ft.error(`Failed to load outdoor view style, possibly due to invalid token "${u["x-mappedin-tiles-key"]}"`);return}Ft.warn(C)}),m}else return new IM(i,e)}h(lte,"createRenderer");var k1=It(hg()),R1=30,j_e=1e3,kf,x0,ute=class extends Hr{constructor(e,t){super(),this.api=e,this.core=t,fe(this,kf,void 0),fe(this,x0,0),ie(this,"includedFloors",[]),ie(this,"expanded",!1),t.on("camera-change",r=>{var n;let a=Math.floor(r.elevation/R1),o=(n=this.includedFloors[a])==null?void 0:n.id;this.expanded&&o&&o!==this.api.currentFloorId&&(this.api.currentFloorId=this.includedFloors[a].id,this.api.publish("floor-change",{reason:"elevation-change",floorId:this.api.currentFloorId}))})}get percentExpanded(){return M(this,x0)}set percentExpanded(e){let t=yh(e,0,1,0,R1);this.includedFloors.forEach((r,n)=>{this.core.setState(r.containerId,{visible:!0,altitude:t*n})}),ke(this,x0,e)}animateToCurrentFloor(){let e=this.includedFloors.indexOf(this.api.currentFloor)*R1;new k1.default.Tween({elevation:this.core.camera.elevation}).to({elevation:e},1e3).easing(k1.default.Easing.Quadratic.Out).onUpdate(({elevation:t})=>{this.core.camera.setElevation(t),this.core.render()}).onComplete(()=>{this.api.publish("floor-change",{reason:"",floorId:this.api.currentFloorId})}).start(),this.core.render()}expand(e){return this.includedFloors=this.api.floors.filter(t=>!(e!=null&&e.excludeFloorIds.includes(t.id))),this.includedFloors.length<=1?Promise.resolve():this.animate("expand")}collapse(){return this.expanded===!0?this.animate("collapse"):Promise.resolve()}animate(e){M(this,kf)&&M(this,kf).stop();let t=this.includedFloors.indexOf(this.api.currentFloor)*R1;return new Promise(r=>{ke(this,kf,new k1.default.Tween({percentExpanded:this.percentExpanded}).to({percentExpanded:e==="expand"?1:"0"},j_e).easing(k1.default.Easing.Quadratic.Out).onUpdate(({percentExpanded:n})=>{this.core.camera.setElevation(t*n),this.percentExpanded=n,this.core.render()}).onComplete(()=>{this.expanded=e==="expand",this.includedFloors.forEach(n=>{this.core.setState(n.containerId,{visible:e==="collapse"?n.id===this.api.currentFloorId:!0})}),this.core.getSystems().cameraSystem.enablePedestal=e==="expand",this.core.getSystems().cameraSystem.enablePan=e==="collapse",r(),this.publish(e==="expand"?"expanded":"collapsed")}).onStart(()=>{this.includedFloors.forEach(n=>{this.core.setState(n.containerId,{visible:!0})})}).start()),this.core.render()})}};kf=new WeakMap,x0=new WeakMap,h(ute,"StackedMaps");var H_e=ute,G_e={linear:Gc.default.Easing.Linear.None,"ease-in":Gc.default.Easing.Quadratic.In,"ease-out":Gc.default.Easing.Quadratic.Out,"ease-in-out":Gc.default.Easing.Quadratic.InOut},hte=class extends Hr{constructor(t,r,n,a={},o){super();Z(this,"floors");Z(this,"currentFloorId","");Z(this,"id");Z(this,"renderer");Z(this,"mvf");Z(this,"styleMap");Z(this,"StackedMaps");Z(this,"animations",new Map);Z(this,"Models",{add:(t,r,n)=>{let{floorId:a,...o}=n,s=n!=null&&n.floorId?this.floors.find(u=>u.id===n.floorId):this.floors[0],l=this.renderer.addModelGroup(t,{type:"FeatureCollection",features:r.map(u=>{var c;return{type:"Feature",properties:{id:Cr(),rotation:(c=u.rotation)==null?void 0:c.map(p=>p*(Math.PI/180)),scale:u.scale,interactive:u.interactive},geometry:{type:"Point",coordinates:vp(u.target)}}})},{url:o.url},s.id);return this.renderer.getState(l).children},remove:(t,r)=>{this.renderer.remove(t),this.renderer.getState(r).children.length===0&&this.renderer.remove(r)}});Z(this,"Markers",{add:(t,r,n={})=>{let{floorId:a,...o}=n,s=n!=null&&n.floorId?this.floors.find(l=>l.id===n.floorId):this.floors[0];return this.renderer.addMarker2D(t,r,o,s.id)},remove:t=>{this.renderer.remove(t)},getContentEl:t=>{let r=this.renderer.getState(t);if((r==null?void 0:r.type)==="marker")return r.element},removeAll:()=>{},setPosition:(t,r,n)=>{let a=this.renderer.getState(t);if(!a){Ft.error(`Failed to retrieve state for Marker with id "${t}".`);return}if(a.type!=="marker"){Ft.error(`Geometry with id "${t}" is not of type "marker".`);return}this.renderer.setState(a,{position:r,parent:n??this.currentFloorId})},animateTo:(t,r,n,a)=>{let o=this.renderer.getState(t);if(!o)return Ft.error(`Failed to retrieve state for Marker with id "${t}".`),Promise.resolve();if(o.type!=="marker")return Ft.error(`Geometry with id "${t}" is not of type "marker".`),Promise.resolve();let s={duration:1e3,easing:"ease-in-out",...a};this.cancelAnimation(t);let l;new Gc.default.Tween({lon:o.position[0],lat:o.position[1]}).to({lon:r[0],lat:r[1]},s.duration).easing(G_e[s.easing]).onUpdate(({lon:c,lat:p})=>{this.Markers.setPosition(t,[c,p],n),this.renderer.render()}).onComplete(()=>{l()}).start();let u=new Promise(c=>{l=c});return this.renderer.render(),u}});Z(this,"Exporter",{getCurrentSceneGLTF:async t=>this.renderer.getCurrentSceneGLTF(t)});Z(this,"Shapes",{add:(t,r,n)=>{let a=n!=null&&n.floorId?this.floors.find(s=>s.id===(n==null?void 0:n.floorId)):this.floors[0],o=Cr();return this.renderer.addGeometryGroup(o,t,r,a.id),o},remove:t=>(this.renderer.remove(t.id),t.id)});Z(this,"Labels",{all:({onCreate:t})=>{let r=0;for(let n of Object.entries(this.mvf.space)){let[a,o]=n;o&&(o.features.forEach(s=>{var l,u;let c=(l=this.styleMap[s.properties.id])==null?void 0:l.showImage,p=(u=s.properties.details)==null?void 0:u.images,d;if(c&&p&&p.length>0&&(d={marker:{icon:p[0].url}}),s.properties.center&&s.properties.externalId!==""){let m=this.renderer.addLabel2D(s.properties.center,s.properties.externalId,{id:s.properties.id+"-label",appearance:d},a);t(m.id,s.properties.externalId)}}),r++)}},add:(t,r,n={})=>{let{floorId:a,...o}=n,s=n!=null&&n.floorId?this.floors.find(u=>u.id===(n==null?void 0:n.floorId)):this.floors[0],l=this.renderer.addLabel2D(t,r,o,s.containerId);if(!l)throw new Error("label creating failed");return l},remove:t=>{this.renderer.remove(t)},removeAll:()=>{}});Z(this,"Paths",{add:(t,r)=>new Promise(n=>{let a=[],o=t[0].floorId||"root",s=0;for(let u of t){let{floorId:c="root",latitude:p,longitude:d}=u;c!==o&&(s++,o=c),a[s]==null&&a.push({floorId:c,coordinates:[]}),a[s].coordinates.push([d,p])}let l=a.map(({floorId:u,coordinates:c})=>this.renderer.addPath({type:"FeatureCollection",features:c.map(p=>({type:"Feature",properties:{},geometry:{type:"Point",coordinates:p}}))},r,u));new Gc.default.Tween({fraction:0}).to({fraction:1},(r==null?void 0:r.drawDuration)||1e3).onUpdate(({fraction:u})=>{l.forEach(c=>{this.renderer.setState(c.id,{completeFraction:u})})}).onComplete(()=>{n(l)}).start()}),remove:t=>{t.forEach(r=>{this.renderer.remove(r)})}});this.renderer=o,this.id=t,this.renderer.addGroupContainer(t,{},"root"),this.StackedMaps=new H_e(this,this.renderer),this.mvf=r,this.styleMap=n,this.floors=this.mvf["map.geojson"].sort((s,l)=>s.elevation-l.elevation).map(s=>{var l,u;if(t!=="outdoors-container"&&((l=r.space[s.id])==null?void 0:l.features.length)===0&&((u=r.obstruction[s.id])==null?void 0:u.features.length)===0)return;let c=new Yve(t,s,this.renderer,a,r,n);return c.load(),c}).filter(Boolean),this.setFloor(a.initialFloor?RJ(a.initialFloor):this.floors[0].id)}get currentFloor(){return this.floors.find(t=>t.id===this.currentFloorId)}setFloor(t,r){if(this.currentFloorId!==t){if(this.publish("floor-change-start",{floorId:t}),this.currentFloorId=t,this.StackedMaps.expanded)return this.StackedMaps.animateToCurrentFloor();this.floors.forEach(n=>{n.id===t?this.renderer.setState(n.containerId,{visible:!0}):this.renderer.setState(n.containerId,{visible:!1})}),this.publish("floor-change",{reason:r,floorId:this.currentFloor.id})}}cancelAnimation(t){let r=this.animations.get(t);r&&(r.tween.stop(),r.resolver(),this.animations.delete(t))}};h(hte,"GeojsonApiMapObject");var kI=hte;R();var Do,_0,cte=class{constructor({currentMapGetter:e}){fe(this,Do,new Map),fe(this,_0,void 0),ke(this,_0,e)}get currentMap(){return M(this,_0).call(this)}getById(e){return M(this,Do).get(e)}add(e,t,r){let n=$u(e);if(!n)throw new Error("get coordinate failed");let a=this.currentMap;if(!a)throw new Error("currentMap should exist");let{id:o}=a.Markers.add(vp(n),t,{...r,floorId:n.floorId,rank:(r==null?void 0:r.rank)||"medium",dynamicResize:(r==null?void 0:r.dynamicResize)||!1}),s=a.Markers.getContentEl(o.toString());if(!s)throw new Error("marker component should exist");let l=new HJ(o.toString(),s);return M(this,Do).set(l.id,{marker:l,entityId:o.toString()}),l}remove(e){var t;let r=M(this,Do).get(e.id);r&&((t=this.currentMap)==null||t.Markers.remove(r.entityId),M(this,Do).delete(e.id.toString()))}removeAll(){let e=[];return M(this,Do).forEach(({marker:t})=>{this.remove(t),e.push(t),M(this,Do).delete(t.id.toString())}),e}setPosition(e,t){var r;let n=$u(t);if(!n){Ft.error("Cannot determine coordinate from target.");return}let a=this.currentMap;if(!a){Ft.error("Cannot determine the current map.");return}let o=M(this,Do).get(e.id);if(!o){Ft.error(`Cannot find the Marker with id "${e.id}".`);return}a.Markers.setPosition(o.entityId,vp(n),(r=n.floorId)!=null?r:a.currentFloorId)}animateTo(e,t,r){var n;let a=$u(t);if(!a)return Ft.error("Cannot determine coordinate from target."),Promise.resolve();let o=this.currentMap;if(!o)return Ft.error("Cannot determine the current map."),Promise.resolve();let s=M(this,Do).get(e.id);return s?o.Markers.animateTo(s.entityId,vp(a),(n=a.floorId)!=null?n:o.currentFloorId,r):(Ft.error(`Cannot find the Marker with id "${e.id}".`),Promise.resolve())}};Do=new WeakMap,_0=new WeakMap,h(cte,"Markers");var W_e=cte;R();var ds,b0,pte=class{constructor({currentMapGetter:e}){fe(this,ds,new Map),fe(this,b0,void 0),ke(this,b0,e)}get currentMap(){return M(this,b0).call(this)}getById(e){return M(this,ds).get(e)}add(e,t){let r=Array.isArray(e)?e:[e],n=r.reduce((s,l)=>{var u;let c=$u(l.target);return c?(s.has(c.floorId)||s.set(c.floorId,[]),(u=s.get(c.floorId))==null||u.push({...l,target:c}),s):(Ft.error("Cannot determine coordinate from options."),s)},new Map);if(!r.length)throw new Error("targets should not be empty when adding a model");let a=this.currentMap;if(!a)throw new Error("currentMap should exist");let o=[];return n.forEach((s,l)=>{let u=Cr();a.Models.add(u,s,{...t,floorId:l}).forEach(({id:c})=>{let p=new Cve(c.toString(),u);M(this,ds).set(p.id,{model:p,entityId:c.toString(),groupId:u}),o.push(p)})}),o}remove(e){var t;let r=M(this,ds).get(e.id);r&&((t=this.currentMap)==null||t.Models.remove(r.entityId,r.groupId),M(this,ds).delete(e.id.toString()))}removeAll(){let e=[];return M(this,ds).forEach(({model:t})=>{var r;let n=M(this,ds).get(t.id);n&&(e.push(t),(r=this.currentMap)==null||r.Models.remove(n.entityId,n.groupId),M(this,ds).delete(t.id.toString()))}),e}};ds=new WeakMap,b0=new WeakMap,h(pte,"Models");var X_e=pte;R();var al,w0,dte=class{constructor({currentMapGetter:e}){fe(this,al,new Map),fe(this,w0,void 0),ke(this,w0,e)}get currentMap(){return M(this,w0).call(this)}getById(e){return M(this,al).get(e)}async add(e,t){let r=this.currentMap;if(!r)throw new Error("currentMap should exist");let n=await r.Paths.add(e,t),a=new Eve(Cr());return M(this,al).set(a.id,{path:a,entityIds:n.map(o=>o.id.toString())}),a}remove(e){var t;let r=M(this,al).get(e.id);r&&((t=this.currentMap)==null||t.Paths.remove(r.entityIds),M(this,al).delete(e.id.toString()))}removeAll(){let e=[];return M(this,al).forEach(({path:t})=>{this.remove(t),e.push(t),M(this,al).delete(t.id.toString())}),e}};al=new WeakMap,w0=new WeakMap,h(dte,"Paths");var q_e=dte;R();var q2=It(hg());R();var Z_e="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAAkklEQVRoge3awQ3AIAxD0VAMYf+F0yUixbL8JshXuLSwIqJCwDc9QBeZEOy9p2doAQDTM7TQ2cg5Z3qGFjpHS2YjDiGDe+/0DC0cwkYpJKdnaIFMkY1kymzEIVQcwsYhbPDem56hhc5GHELGIWwcwsYhbJS+2R1CxSFsdH5iO4SMr97Y6FxPqxytVVV+HcTEIWx+9mcIqHSOm9QAAAAASUVORK5CYII=";R();var Y_e=h((i,e,t=0)=>{if(Math.abs(i)>=Math.PI)throw new Error("Sector angle too wide!");let r=t/Math.tan(i/2),n=t/Math.sin(i/2),a=n+e,o=10,s=new nd;s.moveTo(n*Math.cos(i/2)-r,n*Math.sin(i/2));for(let l=0;l<o;l++)s.lineTo(a*Math.cos(i/2-i/o*l)-r,a*Math.sin(i/2-i/o*l));for(let l=0;l<o;l++)s.lineTo(t*Math.cos(Math.PI/-2+Math.PI/o*l),t*Math.sin(Math.PI/-2+Math.PI/o*l));return new og(s,{depth:.1,bevelEnabled:!1,UVGenerator:J_e(e)})},"createSectorGeometry"),Z2=h((i,e,t)=>{let r=Math.sqrt(Math.pow(i,2)+Math.pow(e,2))/t;return r>1?r=1:r<0&&(r=0),new Oe(0,r)},"generateRadialUV"),J_e=h(i=>({generateTopUV:(e,t,r,n,a)=>{let o=t[r*3],s=t[r*3+1],l=t[n*3],u=t[n*3+1],c=t[a*3],p=t[a*3+1];return[Z2(o,s,i),Z2(l,u,i),Z2(c,p,i)]},generateSideWallUV:()=>[new Oe(0,1),new Oe(0,1),new Oe(0,1),new Oe(0,1)]}),"radialUVGenerator"),LM="#2266ff",K_e=.7,Q_e=.3;function fte(){let i=new Tv({color:LM,opacity:K_e,transparent:!0,depthTest:!1,depthWrite:!1}),e=Y_e(Math.PI/6,v2e,y2e);new DE().load(Z_e,r=>{i.alphaMap=r,i.needsUpdate=!0});let t=new Wi(e,i);return t.position.z=-.05,t.renderOrder=3,t}h(fte,"createBearingCone");var e2e=h(()=>{let i=new j6(.5,.5,.05,32),e=new Tv({transparent:!0,color:LM,opacity:Q_e,depthTest:!1,depthWrite:!1}),t=new Wi(i,e);t.scale.set(0,0,.05),t.renderOrder=2;let r=new j6(RI,RI,.05,32),n=new Tv({transparent:!0,color:LM,depthTest:!1,depthWrite:!1}),a=new Wi(r,n);return a.renderOrder=3,t.rotation.x=Math.PI/2,a.rotation.x=Math.PI/2,{baseMesh:t,middleMesh:a}},"createBlueDot");R();R();R();var t2e=h(function(){let i=globalThis.fetch;return{fetch(...e){if(!kJ(i))throw new Error("fetch is not available in your environment. Pass your own function into `setFetchFn` (node-fetch, etc)");return i==null?void 0:i(...e)},setFetch(e){i=e}}},"createFetchControl")(),i2e=t2e.fetch,mte=["websdk","web","webv2","kiosk-v2","mobile","iossdk","androidsdk","reactnativesdk"],r2e=mte[0],n2e="https://api-gateway.mappedin.com/track-analytics/a/",Tc,ol,S0,DM,gte=class{constructor(){fe(this,S0),fe(this,Tc,Object.freeze({})),fe(this,ol,void 0),ie(this,"sendGetDirectionsEvent",xp((e,t)=>this.sendAnalyticEvent("query-directions",{start:e,end:t,type:"location_to_location"}),2500)),ke(this,ol,Ot(this,S0,DM).call(this,M(this,Tc)))}init(e={}){this.reset(),this.updateStateWithOptions(e)}reset(){this.updateStateWithOptions({})}updateStateWithOptions(e={}){return ke(this,Tc,Object.freeze(Object.assign({},M(this,Tc),e))),ke(this,ol,Ot(this,S0,DM).call(this,e)),M(this,ol)}updateState(e){let t={...e};t.mapId&&(t.baseUrl=aT({...M(this,ol),mapId:t.mapId})),t.context&&(t.context=oT(t.context)),Object.assign(M(this,ol),t)}get authReady(){let{key:e,secret:t,accessToken:r}=this.getState();return!!(e&&t)||!!r}getState(){return M(this,ol)}getContext(){return this.getState().context||M(this,Tc).context}sendAnalyticEvent(e,t={}){let r=this.getState(),n={...t,g:r.geolocationMode};r.userPosition&&(n={...n,...r.userPosition});let a=xte(r.baseUrl,e,n);if(r.logEvents&&Ft.log("Analytics.track",a),!r.sendEvents)return Promise.resolve();let o={"mi-context":this.getContext(),"mi-session":r.mi_session,"mi-device":r.mi_uuid,"mappedin-sdk-version":r.version,"mappedin-platform-version":r.platformString};return r.accessToken?o.Authorization=`Bearer ${r.accessToken}`:r.noAuth||r.secret&&r.key&&(o["x-mappedin-key"]=btoa(r.key),o["x-mappedin-secret"]=btoa(r.secret)),i2e(a,{method:"GET",mode:"cors",headers:o})}capture(e,t){if(s2e.includes(e))return Ft.warn(`${e} event is sent internally.`),Promise.resolve();let r=o2e.includes(e)?e.slice(1):e;return this.sendAnalyticEvent(r,t)}sendGetMapDataEvent(e){return this.sendAnalyticEvent("load-mapdata",e)}sendWatchPositionDenied(){return this.sendAnalyticEvent("watch-position-denied")}sendMapViewLoadedEvent({firstRenderDuration:e,dimension:t}){return this.sendAnalyticEvent("load-mapview",{firstRenderDuration:e,url:window.location.href,width:t.width,height:t.height,devicePixelRatio:window.devicePixelRatio})}};Tc=new WeakMap,ol=new WeakMap,S0=new WeakSet,DM=h(function(i){var e,t,r;return{baseUrl:aT(i),version:((e=hr==null?void 0:hr.env)==null?void 0:e.npm_package_version)||"v6",mi_uuid:yte(),accessToken:i.accessToken,mapId:i.mapId,mi_session:vte(),platformString:i.platformString||"",context:oT(i.context)||r2e,geolocationMode:!1,sendEvents:(t=i.sendEvents)!=null?t:!1,logEvents:(r=i.logEvents)!=null?r:!1,noAuth:i.noAuth||!1,key:i.key,secret:i.secret}},"#getStateWithOption"),h(gte,"CustomerAnalytics");var a2e=gte;function aT(i){return`${n2e}${i.mapId}/`}h(aT,"getBaseUrl");function yte(){return jJ.getInstance().loadLocalData("deviceId")}h(yte,"getDeviceID");function vte(){return jJ.getInstance().loadSessionData("id")}h(vte,"getSessionID");function xte(i,e,t){let r=new URLSearchParams;for(let[n,a]of Object.entries(t))a!=null&&r.append(n,a);return i+e+"?"+r.toString()}h(xte,"buildUrl");function oT(i){return mte.find(e=>e===i)}h(oT,"getValidContext");var o2e=["$select-location","$select-category","$query-suggest","$query-search"],s2e=["load-mapview","load-mapdata","query-directions","watch-position-denied"],Go=new a2e,l2e={init(...i){return Go.init(...i)},capture(...i){return Go.capture(...i)},updateState(i){return Go.updateState(i)}},u2e={enableHighAccuracy:!0},h2e=500,c2e=150,p2e=150,d2e=0,f2e=5,m2e=5,g2e=30,y2e=.4,v2e=1.25,RI=.35,_te=class extends Hr{constructor(t,r){super();Z(this,"watcherId",null);Z(this,"geometry");Z(this,"currentGeolocation");Z(this,"positionAnimation");Z(this,"scaleAnimation");Z(this,"rotationAnimation");Z(this,"updateGeometryPerFrame",t=>{var r;let[n,a,o]=t.children,{accuracy:s,heading:l}=((r=this.currentGeolocation)==null?void 0:r.coords)||{};s!=null&&(this.scaleAnimation&&this.scaleAnimation.stop(),this.scaleAnimation=new q2.default.Tween({scale:n.scale.x}).to({scale:yh(s,m2e,g2e,d2e,f2e)},c2e).onUpdate(({scale:u})=>{n.scale.set(u,1,u)}).start()),l!=null?(o.visible=!0,this.rotationAnimation&&this.rotationAnimation.stop(),this.rotationAnimation=new q2.default.Tween({rotation:n.scale.x}).to({rotation:ki.degToRad(l)},p2e).onUpdate(({rotation:u})=>{o.rotation.z=u}).start()):o.visible=!1});Z(this,"onPositionUpdate",t=>{var r;if(this.currentGeolocation=t,Go.updateState({userPosition:{bluedotTimestamp:Date.now(),latitude:t.coords.latitude,longitude:t.coords.longitude,floorLevel:t.coords.floorLevel,accuracy:t.coords.accuracy}}),this.geometry){let n=this.core.getState(this.geometry);n.visible===!1&&this.core.setState(this.geometry,{position:[t.coords.longitude,t.coords.latitude],visible:!0}),this.positionAnimation&&this.positionAnimation.stop(),n=this.core.getState(this.geometry);let a;if(t.coords.floorLevel!==void 0){let o=(r=this.geoJSONApi.currentMap)==null?void 0:r.floors[t.coords.floorLevel];a=o==null?void 0:o.id}this.positionAnimation=new q2.default.Tween(n.position).to([t.coords.longitude,t.coords.latitude],h2e).onUpdate(o=>{if(this.geometry){let s={position:o};if(a==null&&n.parent!=="outdoors-container")s.parent="outdoors-container";else if(a!=null&&n.parent!==a){let l=a??"outdoors-container";s.parent=l,this.publish("floor-change",{reason:"blue-dot-floor-change",floorId:l})}this.core.setState(this.geometry,s)}}).start(),this.core.render()}});Z(this,"onPositionError",t=>{switch(t.code){case t.PERMISSION_DENIED:Ft.error("Geolocation permission denied by the user.",t),Go.sendWatchPositionDenied();break;case t.POSITION_UNAVAILABLE:Ft.error("Geolocation position unavailable.",t);break;case t.TIMEOUT:Ft.error("Geolocation request timed out.",t);break;default:Ft.error("An unknown geolocation error occurred.",t);break}this.disable()});this.core=t,this.geoJSONApi=r}enable(){this.watcherId&&navigator.geolocation.clearWatch(this.watcherId),this.geometry=this.core.addCustomGeometry("blue-dot",{type:"Feature",properties:{},geometry:{type:"Point",coordinates:[-79.3935,43.6532]}},{setup:t=>{let{baseMesh:r,middleMesh:n}=e2e(),a=fte();t.add(r),t.add(n),t.add(a)},update:this.updateGeometryPerFrame},{visible:!1},"outdoors-container"),this.watcherId=navigator.geolocation.watchPosition(this.onPositionUpdate,this.onPositionError,u2e)}disable(){this.watcherId&&navigator.geolocation.clearWatch(this.watcherId),this.geometry&&(this.core.remove(this.geometry.id),this.geometry=void 0),this.currentGeolocation=void 0}};h(_te,"BlueDot");var x2e=_te;R();var sl,M0,bte=class{constructor({currentMapGetter:e}){fe(this,sl,new Map),fe(this,M0,void 0),ke(this,M0,e)}get currentMap(){return M(this,M0).call(this)}getById(e){return M(this,sl).get(e)}add(e,t,r){let n=this.currentMap;if(!n)throw new Error("currentMap should exist");let a=n.Shapes.add(e,t||{},{floorId:r==null?void 0:r.id}),o=new Pve(a);return M(this,sl).set(o.id,o),o}remove(e){var t;M(this,sl).get(e.id)&&((t=this.currentMap)==null||t.Shapes.remove(e),M(this,sl).delete(e.id.toString()))}removeAll(){let e=[];return M(this,sl).forEach(t=>{this.remove(t),e.push(t.id),M(this,sl).delete(t.id.toString())}),e}};sl=new WeakMap,M0=new WeakMap,h(bte,"Shapes");var _2e=bte;R();var C0,wte=class{constructor({currentMapGetter:e}){fe(this,C0,void 0),ke(this,C0,e)}get currentMap(){return M(this,C0).call(this)}setFromStyleCollection(e){var t,r,n;for(let a in e)for(let o of((t=this.currentMap)==null?void 0:t.floors)||[])if(e[a]!=null){if(o.layers.has(a)&&"color"in e[a]){let s=o.layers.get(a);(r=this.currentMap)==null||r.renderer.setState(s,{color:e[a].color})}if(a===FJ&&!(Rv in e)){let s=o.layers.get(Rv);s&&"color"in e[a]&&((n=this.currentMap)==null||n.renderer.setState(s,{color:e[a].color}))}}}};C0=new WeakMap,h(wte,"Style");var b2e=wte;R();var fs,E0,Ste=class{constructor(e,t){fe(this,fs,void 0),fe(this,E0,void 0),ke(this,fs,e),ke(this,E0,t||[])}setStyle(e){var t,r;if(M(this,fs).map){(t=M(this,fs).map)==null||t.setStyle(e),(r=M(this,fs).map)==null||r.moveLayer(QK);for(let[n,a]of M(this,E0)||[])M(this,fs).hideOutdoorLayersUnderPoint(n,a)}}get map(){return M(this,fs).map}get enabled(){return!!M(this,fs).map}};fs=new WeakMap,E0=new WeakMap,h(Ste,"Outdoor");var w2e=Ste,F1=.05,Mte=class{constructor(e,t){Z(this,"core");Z(this,"outdoors");Z(this,"mapObjects",[]);Z(this,"id");Z(this,"mapDataExternal",{});Z(this,"mapsByFloorId",{});Z(this,"mapData");Z(this,"currentMap");Z(this,"directions");Z(this,"hiddenOutdoorGeometries",[]);Z(this,"mapView");Z(this,"Camera");Z(this,"Labels");Z(this,"Markers");Z(this,"Models");Z(this,"Paths");Z(this,"Exporter");Z(this,"Navigation");Z(this,"Outdoor");Z(this,"BlueDot");Z(this,"Shapes");Z(this,"Style");Z(this,"update",()=>{this.core.render()});Z(this,"getDirections",(e,t,r)=>{if(!this.directions)throw new Error("You have to call .addMap() before you can get directions");let n=this.getMapDataInternal();if(!n)throw new Error("getDirections failed due to missing mapData");let{accessible:a=!1,smoothing:o=!0}=r||{},s=Array.isArray(e)?e:[e],l=Array.isArray(t)?t:[t];Go.sendGetDirectionsEvent(s[0].id,l[0].id);let u=typeof o=="object"?o.enabled:o,c=typeof o=="object"?o.radius:void 0,p=(r==null?void 0:r.zones)||[],d={accessible:a,zones:p,smoothing:{enabled:u??!0,radius:c??.75}};return this.directions.getDirections(s,l,d,n)});this.core=e,this.mapView=t,this.Camera=new Uve(this.core),this.id=this.core.addGroupContainer("root").id.toString(),this.outdoors=new kI("outdoors-container",{"map.geojson":[{id:"outdoors",externalId:"outdoors",elevation:0}],"styles.json":{},space:{},entrance:{},obstruction:{}},{},{},this.core),this.mapObjects.push(this.outdoors);let r=new Tve(this.Camera);this.core.on("camera-change",()=>{this.mapView.publish("camera-change",r)});let n=h(s=>l=>{var u,c,p;let d=[],m=[],g=[];l.labels.forEach(_=>{let C=this.Labels.getById(_.toString());C&&d.push(C.label)}),l.markers.forEach(_=>{let C=this.Markers.getById(_.toString());C&&m.push(C.marker)}),l.models.forEach(_=>{let C=this.Models.getById(_.toString());C&&g.push(C.model)});let b=l.geometry[0],x;b&&(x=(u=this.getMapDataInternal())==null?void 0:u.getById("space",b)),x||(x=(c=this.getMapDataInternal())==null?void 0:c.getById("object",b));let v=l.containers.reduce((_,C)=>{var E;let T=(E=this.getMapDataInternal())==null?void 0:E.getById("floor",C);return T&&e_.is(T)&&_.push(T),_},[]),w={coordinate:new vr(l.coordinate[1],l.coordinate[0],(p=v==null?void 0:v[0])==null?void 0:p.id),spaces:x&&ih.is(x)?[x]:[],objects:x&&rh.is(x)?[x]:[],markers:m,labels:d,models:g,floors:v};"pointerEvent"in l&&(w.pointerEvent=l.pointerEvent),this.mapView.publish(s,w)},"createHandler");this.core.on("hover",n("hover")),this.core.on("click",n("click")),this.core.on("outdoor-view-loaded",()=>{this.mapView.publish("outdoor-view-loaded")}),this.core.on("outdoor-style-loaded",()=>{this.mapView.publish("outdoor-style-loaded")}),this.core.on("user-interaction-start",()=>{this.mapView.publish("user-interaction-start")}),this.core.on("user-interaction-end",()=>{this.mapView.publish("user-interaction-end")});let a=h(()=>this.currentMap,"currentMapGetter");this.Markers=new W_e({currentMapGetter:a}),this.Models=new X_e({currentMapGetter:a}),this.Labels=new Zve({currentMapGetter:a}),this.Exporter=new qve({currentMapGetter:a}),this.Paths=new q_e({currentMapGetter:a}),this.Navigation=new zve(t),this.BlueDot=new x2e(this.core,this),this.BlueDot.on("floor-change",s=>{this.setFloor(s.floorId,"blue-dot-floor-change")}),this.Outdoor=new w2e(this.core,this.hiddenOutdoorGeometries),this.Shapes=new _2e({currentMapGetter:a}),this.Style=new b2e({currentMapGetter:a});let o=new $ve(t,this.mapDataExternal);this.auto=o.auto}updateState(e,t){var r;if(e==="walls"){(r=this.currentMap)==null||r.floors.forEach(a=>{var o,s;let l=a.layers.get(FJ),u=a.layers.get(Rv);l&&((o=this.core.getState(l))==null||o.children.forEach(c=>{this.core.setState(c.id,t)})),u&&((s=this.core.getState(u))==null||s.children.forEach(c=>{this.core.setState(c.id,t)}))});return}let n=typeof e=="string"?this.getMapDataObject(e):e;if(n){if(_S.is(n))return this.core.setState(n.id,LK({...t,type:"label"},this.core.getState(n.id)));if(HJ.is(n))return this.core.setState(n.id,DK({...t,type:"marker"},this.core.getState(n.id)));(ih.is(n)||rh.is(n))&&this.core.setState(n.id,kK({...t,type:"geometry"},this.core.getState(n.id)))}}getMapDataObject(e){var t;return(t=this.getMapDataInternal())==null?void 0:t.getMapDataById(e)}getMapDataInternal(){if(this.mapData)return j3.get(this.mapData)}getMapData(){return this.mapData}expand(e){var t;return(t=this.currentMap)==null?void 0:t.StackedMaps.expand({excludeFloorIds:(e==null?void 0:e.excludeFloors.map(r=>r.id))||[]})}collapse(){var e;return(e=this.currentMap)==null?void 0:e.StackedMaps.collapse()}addMap(e,t){return new Promise(r=>{var n,a,o;let s=j3.get(e);if(!s){Ft.error("error exists"),r(e);return}this.mapDataExternal[e.mapName]=e;let{mvf:l}=s,u=l["manifest.geojson"].features[0].geometry.coordinates;this.core.mode!=="outdoors-overlay"&&this.Camera.set({center:new vr(u[1],u[0])});let c=zK(l["styles.json"]||{}),p=l["manifest.geojson"].features[0].properties.name,d=new kI(`mapObject-${p}`,l,c,t,this.core),m=this.core.getBoundingArea(d.currentFloor.id),g=(a=(n=t==null?void 0:t.outdoorView)==null?void 0:n.layersHiddenByGeometry)!=null?a:[];if(g.length>0){let b=(o=this.core.getCenter(m))!=null?o:u;this.core.hideOutdoorLayersUnderPoint(b,g),this.hiddenOutdoorGeometries.push([b,g])}this.mapObjects.push(d),l["map.geojson"].forEach(b=>{this.mapsByFloorId[b.id]=d}),d.StackedMaps.on("expanded",()=>{this.mapView.publish("expanded")}),d.StackedMaps.on("collapsed",()=>{this.mapView.publish("collapsed")}),d.on("floor-change-start",()=>{this.mapView.publish("floor-change-start",{floor:this.currentFloor})}),d.on("floor-change",b=>{this.mapView.publish("floor-change",{reason:b.reason,floor:this.currentFloor})}),this.currentMap=d,this.mapData=e,this.directions=new Xve({nodes:this.currentMap.mvf["node.geojson"],obstructions:this.currentMap.mvf.obstruction,connections:this.currentMap.mvf["connection.json"],groupBy:"map"}),(t==null?void 0:t.zoomLevel)!=null?(this.core.camera.setZoomLevel(t.zoomLevel),r(e)):this.core.mode!=="outdoors-overlay"?this.core.camera.focusOn(this.core.getBoundingArea(d.currentFloor.id),{duration:uve,padding:{top:F1*this.core.canvasHeight,left:F1*this.core.canvasWidth,right:F1*this.core.canvasWidth,bottom:F1*this.core.canvasHeight}}).then(()=>{r(e)}):r(e)})}setFloor(e,t){if(!this.currentMap)throw new Error("mappObject should exist atm");this.currentMap.setFloor(typeof e=="string"?e:e.id,t)}updateWatermark(e){this.core.updateWatermark(e)}get currentFloor(){var e,t;let r=(e=this.currentMap)==null?void 0:e.currentFloor.id;if(!r)throw new Error("Missing currentFloor object from GeoJsonApi");let n=(t=this.mapData)==null?void 0:t.getById("floor",r);if(!n)throw new Error("Missing currentFloor");return n}getState(e){var t;let r=typeof e=="string"?e:e.id,n=this.core.getState(r);if(n){if(n.type==="geometry")return{type:"geometry",interactive:n.interactive,hoverColor:n.hoverColor,color:n.color,visible:n.visible};if(n.type==="label"&&n.options.appearance&&n.options.rank!==void 0&&n.options.interactive!==void 0)return{type:"label",appearance:n.options.appearance,rank:n.options.rank,enabled:n.enabled,interactive:n.options.interactive};if(n.type==="marker"&&((t=n.options)==null?void 0:t.rank)!==void 0&&n.options.interactive!==void 0){let a=typeof n.parent=="object"?n.parent.id:n.parent;return{type:"marker",rank:n.options.rank,interactive:n.options.interactive,enabled:n.enabled,element:n.element,coordinate:new vr(n.position[1],n.position[0],a.toString())}}else if(n.type==="model")return{type:"model"}}}setHoverColor(e){this.core.setState({hoverColor:e})}getHoverColor(){let e=this.core.getState();return(e==null?void 0:e.type)==="map-view"?e.hoverColor:void 0}createCoordinate(e,t,r){return new vr(e,t,(r==null?void 0:r.id)||this.currentFloor.id)}createCoordinateFromScreenCoordinate(e,t,r){let n=this.core.projectScreenXYToCoordinate(e,t);return n?new vr(n[1],n[0],(r==null?void 0:r.id)||this.currentFloor.id):void 0}isInView(e){return this.core.isInView(typeof e=="string"?e:e.id)}auto(){this.Labels.all()}get __core(){return this.core}destroy(){this.Navigation.clear(),this.BlueDot.disable(),this.Shapes.removeAll(),this.Paths.removeAll(),this.Models.removeAll(),this.Markers.removeAll(),this.Labels.removeAll(),this.core.destroy()}};h(Mte,"GeoJsonApi");var S2e=Mte,T0,hi,Cte=class extends Hr{constructor(e){super(),fe(this,T0,{}),fe(this,hi,void 0),ie(this,"Camera"),ie(this,"Labels"),ie(this,"Markers"),ie(this,"Models"),ie(this,"Paths"),ie(this,"Exporter"),ie(this,"Navigation"),ie(this,"BlueDot"),ie(this,"Style"),ie(this,"Shapes"),ie(this,"Outdoor"),ie(this,"update",()=>{M(this,hi).core.render()}),ie(this,"getDirections",(r,n,a)=>M(this,hi).getDirections(r,n,a)),ie(this,"on",(r,n)=>{super.on(r,n)}),ie(this,"off",(r,n)=>{super.off(r,n)});let t=new S2e(e,this);ke(this,hi,t),this.Camera=M(this,hi).Camera,ke(this,T0,M(this,hi).mapDataExternal),this.Markers=M(this,hi).Markers,this.Models=M(this,hi).Models,this.Labels=M(this,hi).Labels,this.Exporter=M(this,hi).Exporter,this.Paths=M(this,hi).Paths,this.Navigation=M(this,hi).Navigation,this.BlueDot=M(this,hi).BlueDot,this.Shapes=M(this,hi).Shapes,this.Style=M(this,hi).Style,this.auto=M(this,hi).auto,this.Outdoor=M(this,hi).Outdoor}updateState(e,t){return M(this,hi).updateState(e,t)}getMapData(){return M(this,T0)}getDimensions(){return{width:this.__core.canvasWidth,height:this.__core.canvasHeight}}expand(e){return M(this,hi).expand(e)}collapse(){return M(this,hi).collapse()}addMap(e,t){return M(this,hi).addMap(e,t)}setFloor(e){M(this,hi).setFloor(e)}get currentFloor(){return M(this,hi).currentFloor}updateWatermark(e){M(this,hi).updateWatermark(e)}getState(e){return M(this,hi).getState(e)}setHoverColor(e){M(this,hi).setHoverColor(e)}getHoverColor(){return M(this,hi).getHoverColor()}isInView(e){return M(this,hi).isInView(e)}createCoordinate(e,t,r){return M(this,hi).createCoordinate(e,t,r)}createCoordinateFromScreenCoordinate(e,t,r){return M(this,hi).createCoordinateFromScreenCoordinate(e,t,r)}auto(){this.Labels.all()}get __core(){return M(this,hi).core}destroy(){M(this,hi).destroy()}async enableDebug(){let{Inspector:e}=await zm(()=>import("./inspector-QDN2FWBH-Bc8nsy3c.js"),[]);await new e(this,M(this,hi)).enable()}};T0=new WeakMap,hi=new WeakMap,h(Cte,"MapView");var Ete=Cte;R();var Tte=class extends Hr{constructor(t){super();Z(this,"gl");Z(this,"el",document.createElement("div"));Z(this,"core");Z(this,"origin");this.origin=t}onAdd(t){this.origin=this.origin||t.getCenter().toArray(),this.gl=t.painter.context.gl,this.core=new IM(t._container,{center:this.origin,zoomLevel:t.getZoom(),pitch:t.getPitch(),bearing:t.getBearing(),gl:this.gl,map:t,mode:"outdoors-overlay"}),this.core.camera.setMinZoomLevel(t.getMinZoom()),this.core.camera.setMaxZoomLevel(t.getMaxZoom()),this.core.camera.setMinPitch(t.getMinPitch()),this.core.camera.setMaxPitch(t.getMaxPitch()),t.on("error",a=>{Ft.warn(a)});let r=qr.fromLngLat(this.origin,0),n=eT(r,this.core.viewCamera,this.core.camera,()=>{this.core.renderSync()});return t.on("style.load",async()=>{t.addLayer(n),this.core.camera.setMinZoomLevel(t.getMinZoom()),this.core.camera.setMaxZoomLevel(t.getMaxZoom()),this.core.camera.setMinPitch(t.getMinPitch()),this.core.camera.setMaxPitch(t.getMaxPitch())}),t.on("move",()=>{let[a,o]=t.getCenter().toArray();this.core.getSystems().cameraSystem.setCenter(a,o),this.core.getSystems().cameraSystem.setZoomLevel(t.getZoom()),this.core.getSystems().cameraSystem.setRotation(ki.degToRad(-t.getBearing())),this.core.getSystems().cameraSystem.setTilt(ki.degToRad(t.getPitch()))}),this.el}onRemove(){}};h(Tte,"MapLibreOverlay");var M2e=Tte,C2e=h(async(i,e)=>{let t;try{if(e){let{access_token:n}=await GE(e);t=n}}catch(n){Ft.warn("Getting access token failed. Outdoor map disabled.",n)}let r=new qE(i,t);return new jE(r)},"hydrateMapDataFromMVF");function Pte(i,e,t){return fetch(i,{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({grant_type:"client_credentials",client_id:e,client_secret:t})})}h(Pte,"fetchOutdoorViewToken");var Ate=h(async i=>{let e={emitAnalyticsEvents:!0,...i},t;if("accessToken"in e)t=e.accessToken;else if("key"in e&&"secret"in e){let l=await Pte("https://auth.mappedin.com/oauth2/token",e.key,e.secret),{access_token:u}=await l.json();t=u}else throw new Error("No outdoor view token provided and key and secret missing.");let r={...e,venue:e.mapId,clientId:e.key,clientSecret:e.secret,version:"1.0.0"},n=await eJ(r),a=await Yx(n),o=Zx(a);typeof i.onMVFParsed=="function"&&i.onMVFParsed(o);let s=new qE(o,t);return new jE(s)},"getMapDataEnterprise"),Ite=!1;function Lte(i){Ite=i}h(Lte,"setUseEnterpriseAPI");var Dte=h(async i=>{if(Ite)return Ate(i);let e={emitAnalyticsEvents:!1,...i},t;if("accessToken"in e)t=e.accessToken;else{let{access_token:p}=await GE(e);t=p}Go.authReady||Go.updateState({accessToken:t});let r=performance.now(),n=await tJ(e,t),a=performance.now(),o=await Yx(n),s=Zx(o),l=performance.now();typeof i.onMVFParsed=="function"&&i.onMVFParsed(s);let u=new qE(s,t),c=new jE(u);return Go.sendGetMapDataEvent({parseDuration:(l-a).toFixed(2),downloadDuration:(a-r).toFixed(2),viewId:e.viewId}),c},"getMapData"),Pc,Rf,kM=class extends M2e{constructor(e,t,r){super(e),fe(this,Pc,void 0),fe(this,Rf,void 0),ke(this,Pc,t),ke(this,Rf,r)}onAdd(e){var t,r;super.onAdd(e);let n={...nS,...(t=M(this,Rf))!=null?t:{},outdoorView:{token:M(this,Pc).outdoorViewToken,...(r=M(this,Rf))==null?void 0:r.outdoorView}},a=new Ete(this.core);return a.addMap(M(this,Pc),n).then(()=>{this.publish("loaded",{mapView:a,mapData:M(this,Pc)})}),this.el}};Pc=new WeakMap,Rf=new WeakMap,h(kM,"MappedinMapLibreOverlay"),ie(kM,"instance");var Y2=kM,E2e=h((i,e)=>{Y2.instance!=null&&Ft.warn("Only a single map venue is supported at this time.");let t=new Y2([i.mapCenter.longitude,i.mapCenter.latitude],i,e);return Y2.instance=t,t},"createMapLibreOverlay"),kte=h(async(i,e,t)=>{var r,n,a,o,s;let l=performance.now(),u=BJ(t,e);try{t&&zJ(t)}catch(d){if(d instanceof Error&&d.name==="MissingOutdoorViewToken")Ft.error("Enable outdoor view requires a token. Provide token in `options.outdoorView.token`");else throw d}let c=await lte(i,{center:[e.mapCenter.longitude,e.mapCenter.latitude],bearing:u.bearing,pitch:u.pitch,zoomLevel:u.zoomLevel,outdoorView:(r=u.outdoorView)!=null&&r.token?{headers:{"x-mappedin-tiles-key":(n=u.outdoorView)==null?void 0:n.token},style:(a=u.outdoorView)==null?void 0:a.style,enabled:!!((o=u.outdoorView)!=null&&o.enabled)}:void 0,watermark:u.watermark,attribution:u.attribution,antialias:typeof u.antialiasing=="boolean"?u.antialiasing:!!((s=u.antialiasing)!=null&&s.enabled)}),p=new Ete(c);return await p.addMap(e,u),Go.sendMapViewLoadedEvent({firstRenderDuration:(performance.now()-l).toFixed(2),dimension:p.getDimensions()}),p},"show3dMapGeojson"),Rte=kte;R();R();R();R();var Fte=class extends Error{constructor(e){super(`${e} must be used within a MapView component.`)}};h(Fte,"MapViewNullError");var vh=Fte,zs=kt.createContext({mapData:void 0,mapView:void 0});function sT(){let{mapData:i,mapView:e}=kt.useContext(zs);if(!i||!e)throw new vh("useMap");return{mapData:i,mapView:e}}h(sT,"useMap");R();function xh(i,e){kt.useEffect(()=>{e!=null&&typeof i=="function"&&i(e)},[i,e])}h(xh,"useOnLoad");h(i=>{let{mapView:e}=kt.useContext(zs),t=kt.useRef(),[r,n]=kt.useState(null);return kt.useEffect(()=>{if(e==null)throw new vh("Marker");return t.current=e.Markers.add(i.target,"",{...i.options,dynamicResize:!0}),n(t.current),()=>{e==null||t.current==null||e.Markers.remove(t.current)}},[e,i.target,i.options]),xh(i.onLoad,r),e==null||r==null?null:X7.createPortal(i.children,r.contentEl,r.id)},"Marker");R();function RM(i){let{mapView:e}=kt.useContext(zs),t=kt.useRef(),[r,n]=kt.useState(void 0);return kt.useEffect(()=>{if(e==null)throw new vh("Label");return t.current=e.Labels.add(i.target,i.text,i.options),n(t.current),()=>{e==null||t.current==null||e.Labels.remove(t.current)}},[e,i.target,i.text,i.options]),xh(i.onLoad,r),null}h(RM,"Label");R();function zte(i,e){let{mapView:t}=kt.useContext(zs),r=kt.useCallback(n=>e(n),[e]);kt.useEffect(()=>{if(t==null)throw new vh("useEvent");return t.on(i,r),()=>{t!=null&&t.off(i,r)}},[t,i,e])}h(zte,"useEvent");R();function Bte(i){let{mapView:e}=kt.useContext(zs),t=kt.useRef(),[r,n]=kt.useState(void 0);return kt.useEffect(()=>{if(e==null)throw new vh("Path");let a=!1,o=e.Paths.add(i.coordinate,i.options);return o.then(s=>{a?e.Paths.remove(s):(t.current=s,n(s))}),()=>{a=!0,t.current?e.Paths.remove(t.current):o.then(s=>{e.Paths.remove(s)})}},[e,i.coordinate,i.options]),xh(i.onLoad,r),null}h(Bte,"Path");R();var T2e={width:"100%",height:"100%",position:"relative"};function Ote(i){let{mapData:e,options:t,style:r,fallback:n,children:a,...o}=i,s=kt.useRef(!1),[l,u]=kt.useState(void 0),[c,p]=kt.useState(!0),d=kt.useRef(null),m=kt.useMemo(()=>t,[]),g=kt.useCallback(()=>{if(e&&d!=null&&d.current){if(l)return;Rte(d.current,e,m).then(b=>{u(b)}).catch(b=>{Ft.error("Failed to render MapView",b)}).finally(()=>{p(!1)})}},[e,d.current,m]);return kt.useEffect(()=>{s.current||(s.current=!0,g())},[g]),xh(i.onLoad,l),mg.createElement(zs.Provider,{value:{mapData:e,mapView:l}},mg.createElement("div",{"data-testid":"mappedin-map",ref:d,style:{...T2e,...r},...o}),c?mg.createElement(mg.Fragment,null,n):a)}h(Ote,"MapView");R();function P2e(i){let{mapView:e}=kt.useContext(zs),[t,r]=kt.useState(!1),n=kt.useRef(Promise.resolve());return kt.useEffect(()=>{if(e==null)throw new vh("Navigation");let a=!1,o=h(()=>a?Promise.resolve():e.Navigation.draw(i.directions,i.options).then(()=>{a||r(!0)}),"navigationOperation");return n.current=n.current.then(o),()=>{a=!0,n.current=n.current.then(()=>{e.Navigation.clear()})}},[e,i.directions,i.options]),kt.useEffect(()=>{t!==!1&&typeof i.onLoad=="function"&&i.onLoad()},[i.onLoad,t]),null}h(P2e,"Navigation");R();function A2e(i){let{mapView:e}=kt.useContext(zs),t=kt.useRef(),[r,n]=kt.useState(void 0);return kt.useEffect(()=>{if(e==null)throw new Error("MapView not initialized");return t.current=e.Shapes.add(i.geometry,i.style,i.floor),n(t.current),()=>{e==null||t.current==null||e.Shapes.remove(t.current)}},[e,i.geometry,i.style,i.floor]),xh(i.onLoad,r),null}h(A2e,"Shape");R();function I2e(i){let{mapView:e}=kt.useContext(zs),t=kt.useRef(),[r,n]=kt.useState(void 0);return kt.useEffect(()=>{if(e==null)throw new vh("Model");return t.current=e.Models.add(i.models,i.options),n(t.current),()=>{if(!(e==null||t.current==null))for(let a of t.current)e.Models.remove(a)}},[e,i.models,i.options]),xh(i.onLoad,r),null}h(I2e,"Model");R();function Nte(i){let[e,t]=kt.useState(void 0),[r,n]=kt.useState(!0),[a,o]=kt.useState(void 0),s=kt.useRef(0),l=kt.useMemo(()=>i,[]),u=kt.useCallback(()=>{let c=++s.current;n(!0),o(void 0),Dte(l).then(p=>{s.current===c&&t(p)}).catch(p=>{s.current===c&&(Ft.error("Failed to fetch MapData",p),o(p))}).finally(()=>{s.current===c&&n(!1)})},[l]);return kt.useEffect(()=>{u()},[u]),{mapData:e,isLoading:r,error:a}}h(Nte,"useMapData");function L2e(){const{mapData:i,mapView:e}=sT(),t=i.getByType("space").find(a=>a.name.includes("Grocery Store")),r=i.getByType("space").find(a=>a.name.includes("Food Stall"));if(t==null||r==null)return null;const n=e.getDirections(t,r);return n?La.jsx(Bte,{coordinate:n.coordinates,options:{color:"goldenrod"}}):null}function D2e(){const{mapData:i,mapView:e}=sT();return zte("click",t=>{const{labels:r}=t;r.length>0&&r.forEach(n=>{e.Labels.remove(n)})}),La.jsxs(La.Fragment,{children:[i.getByType("space").map((t,r)=>La.jsx(RM,{target:t.center,text:t.name,options:{interactive:!0,appearance:{marker:{foregroundColor:{active:"tomato"}},text:{foregroundColor:"tomato"}}}},r)),i.getByType("point-of-interest").map((t,r)=>La.jsx(RM,{target:t.coordinate,text:t.name,options:{interactive:!0,appearance:{marker:{foregroundColor:{active:"dodgerblue"}},text:{foregroundColor:"dodgerblue"}}}},r))]})}function k2e(){const{isLoading:i,error:e,mapData:t}=Nte({key:"mik_yeBk0Vf0nNJtpesfu560e07e5",secret:"mis_2g9ST8ZcSFb5R9fPnsvYhrX3RyRwPtDGbMGweCYKEq385431022",mapId:"65c0ff7430b94e3fabd5bb8c"});return i?La.jsx("div",{children:"Loading..."}):e?La.jsx("div",{children:e.message}):t?La.jsxs(Ote,{mapData:t,children:[La.jsx(L2e,{}),La.jsx(D2e,{})]}):null}q7(document.getElementById("root")).render(La.jsx(kt.StrictMode,{children:La.jsx(k2e,{})}));export{gv as $,gY as A,rd as B,m5e as C,Gl as D,A4e as E,jt as F,Oe as G,xq as H,dh as I,D6 as J,yv as K,rr as L,Wi as M,Wx as N,$n as O,le as P,FZ as Q,Bl as R,Br as S,On as T,p5e as U,Lt as V,jCe as W,En as X,Pu as Y,Q_ as Z,DE as _,zn as a,$le as a$,bye as a0,Wl as a1,Eq as a2,ma as a3,WCe as a4,Qye as a5,Dfe as a6,ZA as a7,Hx as a8,Pq as a9,Nle as aA,NMe as aB,xpe as aC,wm as aD,qpe as aE,Jt as aF,zl as aG,cde as aH,kMe as aI,Aa as aJ,Hg as aK,Tpe as aL,pA as aM,qr as aN,FMe as aO,XMe as aP,Ole as aQ,E$ as aR,UMe as aS,Kpe as aT,sA as aU,GMe as aV,Wpe as aW,Hpe as aX,Vpe as aY,nde as aZ,Fle as a_,n4e as aa,s4e as ab,m1 as ac,oW as ad,ZCe as ae,H4e as af,gye as ag,Yr as ah,Xn as ai,Si as aj,HCe as ak,Av as al,Pv as am,sg as an,qMe as ao,RC as ap,hde as aq,Lpe as ar,Ule as as,ade as at,Qpe as au,ide as av,rde as aw,ype as ax,hn as ay,jMe as az,lq as b,Nne as b0,A3e as b1,Rle as b2,vo as b3,zde as b4,Dde as b5,kde as b6,Rde as b7,Ode as b8,$de as b9,kle as ba,$ne as bb,Bde as bc,Lde as bd,Fde as be,Nde as bf,vr as bg,Go as bh,l2e as bi,U_e as bj,nq as c,u4e as d,pl as e,Da as f,Xr as g,_A as h,c4e as i,Ed as j,Fn as k,ho as l,po as m,lr as n,g3 as o,lg as p,R as q,h as r,rG as s,xo as t,rg as u,Z4e as v,h5e as w,i5e as x,ki as y,a5e as z};
